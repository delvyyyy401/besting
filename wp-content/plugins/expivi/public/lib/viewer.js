// Production steps of ECMA-262, Edition 6, 22.1.2.1
if (!Array.from) {
    Array.from = (function () {
        var symbolIterator;
        try {
            symbolIterator = Symbol.iterator
                ? Symbol.iterator
                : 'Symbol(Symbol.iterator)';
        } catch (e) {
            symbolIterator = 'Symbol(Symbol.iterator)';
        }

        var toStr = Object.prototype.toString;
        var isCallable = function (fn) {
            return (
                typeof fn === 'function' ||
                toStr.call(fn) === '[object Function]'
            );
        };
        var toInteger = function (value) {
            var number = Number(value);
            if (isNaN(number)) return 0;
            if (number === 0 || !isFinite(number)) return number;
            return (number > 0 ? 1 : -1) * Math.floor(Math.abs(number));
        };
        var maxSafeInteger = Math.pow(2, 53) - 1;
        var toLength = function (value) {
            var len = toInteger(value);
            return Math.min(Math.max(len, 0), maxSafeInteger);
        };

        var setGetItemHandler = function setGetItemHandler(isIterator, items) {
            var iterator = isIterator && items[symbolIterator]();
            return function getItem(k) {
                return isIterator ? iterator.next() : items[k];
            };
        };

        var getArray = function getArray(
            T,
            A,
            len,
            getItem,
            isIterator,
            mapFn
        ) {
            // 16. Let k be 0.
            var k = 0;

            // 17. Repeat, while k < len… or while iterator is done (also steps a - h)
            while (k < len || isIterator) {
                var item = getItem(k);
                var kValue = isIterator ? item.value : item;

                if (isIterator && item.done) {
                    return A;
                } else {
                    if (mapFn) {
                        A[k] =
                            typeof T === 'undefined'
                                ? mapFn(kValue, k)
                                : mapFn.call(T, kValue, k);
                    } else {
                        A[k] = kValue;
                    }
                }
                k += 1;
            }

            if (isIterator) {
                throw new TypeError(
                    'Array.from: provided arrayLike or iterator has length more then 2 ** 52 - 1'
                );
            } else {
                A.length = len;
            }

            return A;
        };

        // The length property of the from method is 1.
        return function from(arrayLikeOrIterator /*, mapFn, thisArg */) {
            // 1. Let C be the this value.
            var C = this;

            // 2. Let items be ToObject(arrayLikeOrIterator).
            var items = Object(arrayLikeOrIterator);
            var isIterator = isCallable(items[symbolIterator]);

            // 3. ReturnIfAbrupt(items).
            if (arrayLikeOrIterator == null && !isIterator) {
                throw new TypeError(
                    'Array.from requires an array-like object or iterator - not null or undefined'
                );
            }

            // 4. If mapfn is undefined, then let mapping be false.
            var mapFn = arguments.length > 1 ? arguments[1] : void undefined;
            var T;
            if (typeof mapFn !== 'undefined') {
                // 5. else
                // 5. a If IsCallable(mapfn) is false, throw a TypeError exception.
                if (!isCallable(mapFn)) {
                    throw new TypeError(
                        'Array.from: when provided, the second argument must be a function'
                    );
                }

                // 5. b. If thisArg was supplied, let T be thisArg; else let T be undefined.
                if (arguments.length > 2) {
                    T = arguments[2];
                }
            }

            // 10. Let lenValue be Get(items, "length").
            // 11. Let len be ToLength(lenValue).
            var len = toLength(items.length);

            // 13. If IsConstructor(C) is true, then
            // 13. a. Let A be the result of calling the [[Construct]] internal method
            // of C with an argument list containing the single item len.
            // 14. a. Else, Let A be ArrayCreate(len).
            var A = isCallable(C) ? Object(new C(len)) : new Array(len);

            return getArray(
                T,
                A,
                len,
                setGetItemHandler(isIterator, items),
                isIterator,
                mapFn
            );
        };
    })();
}

if (!Element.prototype.matches) {
    Element.prototype.matches = Element.prototype.msMatchesSelector || Element.prototype.webkitMatchesSelector;
}

if (!Element.prototype.closest) {
    Element.prototype.closest = function (s) {
        var el = this;

        do {
            if (el.matches(s)) return el;
            el = el.parentElement || el.parentNode;
        } while (el !== null && el.nodeType === 1);
        return null;
    };
}

// REQUIRED FOR:
// draco_decoder.js (loaded async from DRACOLoader.js)
if (!Math.clz32) Math.clz32 = (function(log, LN2){
    return function(x) {
      // Let n be ToUint32(x).
      // Let p be the number of leading zero bits in
      // the 32-bit binary representation of n.
      // Return p.
      var asUint = x >>> 0;
      if (asUint === 0) {
        return 32;
      }
      return 31 - (log(asUint) / LN2 | 0) |0; // the "| 0" acts like math.floor
    };
})(Math.log, Math.LN2);

// REQUIRED FOR:
// draco_decoder.js (loaded async from DRACOLoader.js)
Math.fround = Math.fround || (function (array) {
    return function(x) {
      return array[0] = x, array[0];
    };
})(new Float32Array(1));

// REQUIRED FOR:
// draco_decoder.js (loaded async from DRACOLoader.js)
if (!Math.imul) Math.imul = function(opA, opB) {
    opB |= 0; // ensure that opB is an integer. opA will automatically be coerced.
    // floating points give us 53 bits of precision to work with plus 1 sign bit
    // automatically handled for our convienence:
    // 1. 0x003fffff /*opA & 0x000fffff*/ * 0x7fffffff /*opB*/ = 0x1fffff7fc00001
    //    0x1fffff7fc00001 < Number.MAX_SAFE_INTEGER /*0x1fffffffffffff*/
    var result = (opA & 0x003fffff) * opB;
    // 2. We can remove an integer coersion from the statement above because:
    //    0x1fffff7fc00001 + 0xffc00000 = 0x1fffffff800001
    //    0x1fffffff800001 < Number.MAX_SAFE_INTEGER /*0x1fffffffffffff*/
    if (opA & 0xffc00000 /*!== 0*/) result += (opA & 0xffc00000) * opB |0;
    return result |0;
};

if (!Object.entries) {
    Object.entries = function( obj ){
        var ownProps = Object.keys( obj ),
            i = ownProps.length,
            resArray = new Array(i); // preallocate the Array
        while (i--)
            resArray[i] = [ownProps[i], obj[ownProps[i]]];

        return resArray;
    };
}

if (!Object.fromEntries) {
    Object.fromEntries = function(iterable){
        var result = {};
        var array = Array.from(iterable);
        array.forEach(function(value){
            result[value[0]] = value[1];
        });
        return result;
    }
}

(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :
  typeof define === 'function' && define.amd ? define(['exports'], factory) :
  (factory((global.WHATWGFetch = {})));
}(this, (function (exports) { 'use strict';

  var global =
    (typeof globalThis !== 'undefined' && globalThis) ||
    (typeof self !== 'undefined' && self) ||
    (typeof global !== 'undefined' && global);

  var support = {
    searchParams: 'URLSearchParams' in global,
    iterable: 'Symbol' in global && 'iterator' in Symbol,
    blob:
      'FileReader' in global &&
      'Blob' in global &&
      (function() {
        try {
          new Blob();
          return true
        } catch (e) {
          return false
        }
      })(),
    formData: 'FormData' in global,
    arrayBuffer: 'ArrayBuffer' in global
  };

  function isDataView(obj) {
    return obj && DataView.prototype.isPrototypeOf(obj)
  }

  if (support.arrayBuffer) {
    var viewClasses = [
      '[object Int8Array]',
      '[object Uint8Array]',
      '[object Uint8ClampedArray]',
      '[object Int16Array]',
      '[object Uint16Array]',
      '[object Int32Array]',
      '[object Uint32Array]',
      '[object Float32Array]',
      '[object Float64Array]'
    ];

    var isArrayBufferView =
      ArrayBuffer.isView ||
      function(obj) {
        return obj && viewClasses.indexOf(Object.prototype.toString.call(obj)) > -1
      };
  }

  function normalizeName(name) {
    if (typeof name !== 'string') {
      name = String(name);
    }
    if (/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(name) || name === '') {
      throw new TypeError('Invalid character in header field name: "' + name + '"')
    }
    return name.toLowerCase()
  }

  function normalizeValue(value) {
    if (typeof value !== 'string') {
      value = String(value);
    }
    return value
  }

  // Build a destructive iterator for the value list
  function iteratorFor(items) {
    var iterator = {
      next: function() {
        var value = items.shift();
        return {done: value === undefined, value: value}
      }
    };

    if (support.iterable) {
      iterator[Symbol.iterator] = function() {
        return iterator
      };
    }

    return iterator
  }

  function Headers(headers) {
    this.map = {};

    if (headers instanceof Headers) {
      headers.forEach(function(value, name) {
        this.append(name, value);
      }, this);
    } else if (Array.isArray(headers)) {
      headers.forEach(function(header) {
        this.append(header[0], header[1]);
      }, this);
    } else if (headers) {
      Object.getOwnPropertyNames(headers).forEach(function(name) {
        this.append(name, headers[name]);
      }, this);
    }
  }

  Headers.prototype.append = function(name, value) {
    name = normalizeName(name);
    value = normalizeValue(value);
    var oldValue = this.map[name];
    this.map[name] = oldValue ? oldValue + ', ' + value : value;
  };

  Headers.prototype['delete'] = function(name) {
    delete this.map[normalizeName(name)];
  };

  Headers.prototype.get = function(name) {
    name = normalizeName(name);
    return this.has(name) ? this.map[name] : null
  };

  Headers.prototype.has = function(name) {
    return this.map.hasOwnProperty(normalizeName(name))
  };

  Headers.prototype.set = function(name, value) {
    this.map[normalizeName(name)] = normalizeValue(value);
  };

  Headers.prototype.forEach = function(callback, thisArg) {
    for (var name in this.map) {
      if (this.map.hasOwnProperty(name)) {
        callback.call(thisArg, this.map[name], name, this);
      }
    }
  };

  Headers.prototype.keys = function() {
    var items = [];
    this.forEach(function(value, name) {
      items.push(name);
    });
    return iteratorFor(items)
  };

  Headers.prototype.values = function() {
    var items = [];
    this.forEach(function(value) {
      items.push(value);
    });
    return iteratorFor(items)
  };

  Headers.prototype.entries = function() {
    var items = [];
    this.forEach(function(value, name) {
      items.push([name, value]);
    });
    return iteratorFor(items)
  };

  if (support.iterable) {
    Headers.prototype[Symbol.iterator] = Headers.prototype.entries;
  }

  function consumed(body) {
    if (body.bodyUsed) {
      return Promise.reject(new TypeError('Already read'))
    }
    body.bodyUsed = true;
  }

  function fileReaderReady(reader) {
    return new Promise(function(resolve, reject) {
      reader.onload = function() {
        resolve(reader.result);
      };
      reader.onerror = function() {
        reject(reader.error);
      };
    })
  }

  function readBlobAsArrayBuffer(blob) {
    var reader = new FileReader();
    var promise = fileReaderReady(reader);
    reader.readAsArrayBuffer(blob);
    return promise
  }

  function readBlobAsText(blob) {
    var reader = new FileReader();
    var promise = fileReaderReady(reader);
    reader.readAsText(blob);
    return promise
  }

  function readArrayBufferAsText(buf) {
    var view = new Uint8Array(buf);
    var chars = new Array(view.length);

    for (var i = 0; i < view.length; i++) {
      chars[i] = String.fromCharCode(view[i]);
    }
    return chars.join('')
  }

  function bufferClone(buf) {
    if (buf.slice) {
      return buf.slice(0)
    } else {
      var view = new Uint8Array(buf.byteLength);
      view.set(new Uint8Array(buf));
      return view.buffer
    }
  }

  function Body() {
    this.bodyUsed = false;

    this._initBody = function(body) {
      /*
        fetch-mock wraps the Response object in an ES6 Proxy to
        provide useful test harness features such as flush. However, on
        ES5 browsers without fetch or Proxy support pollyfills must be used;
        the proxy-pollyfill is unable to proxy an attribute unless it exists
        on the object before the Proxy is created. This change ensures
        Response.bodyUsed exists on the instance, while maintaining the
        semantic of setting Request.bodyUsed in the constructor before
        _initBody is called.
      */
      this.bodyUsed = this.bodyUsed;
      this._bodyInit = body;
      if (!body) {
        this._bodyText = '';
      } else if (typeof body === 'string') {
        this._bodyText = body;
      } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {
        this._bodyBlob = body;
      } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {
        this._bodyFormData = body;
      } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {
        this._bodyText = body.toString();
      } else if (support.arrayBuffer && support.blob && isDataView(body)) {
        this._bodyArrayBuffer = bufferClone(body.buffer);
        // IE 10-11 can't handle a DataView body.
        this._bodyInit = new Blob([this._bodyArrayBuffer]);
      } else if (support.arrayBuffer && (ArrayBuffer.prototype.isPrototypeOf(body) || isArrayBufferView(body))) {
        this._bodyArrayBuffer = bufferClone(body);
      } else {
        this._bodyText = body = Object.prototype.toString.call(body);
      }

      if (!this.headers.get('content-type')) {
        if (typeof body === 'string') {
          this.headers.set('content-type', 'text/plain;charset=UTF-8');
        } else if (this._bodyBlob && this._bodyBlob.type) {
          this.headers.set('content-type', this._bodyBlob.type);
        } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {
          this.headers.set('content-type', 'application/x-www-form-urlencoded;charset=UTF-8');
        }
      }
    };

    if (support.blob) {
      this.blob = function() {
        var rejected = consumed(this);
        if (rejected) {
          return rejected
        }

        if (this._bodyBlob) {
          return Promise.resolve(this._bodyBlob)
        } else if (this._bodyArrayBuffer) {
          return Promise.resolve(new Blob([this._bodyArrayBuffer]))
        } else if (this._bodyFormData) {
          throw new Error('could not read FormData body as blob')
        } else {
          return Promise.resolve(new Blob([this._bodyText]))
        }
      };

      this.arrayBuffer = function() {
        if (this._bodyArrayBuffer) {
          var isConsumed = consumed(this);
          if (isConsumed) {
            return isConsumed
          }
          if (ArrayBuffer.isView(this._bodyArrayBuffer)) {
            return Promise.resolve(
              this._bodyArrayBuffer.buffer.slice(
                this._bodyArrayBuffer.byteOffset,
                this._bodyArrayBuffer.byteOffset + this._bodyArrayBuffer.byteLength
              )
            )
          } else {
            return Promise.resolve(this._bodyArrayBuffer)
          }
        } else {
          return this.blob().then(readBlobAsArrayBuffer)
        }
      };
    }

    this.text = function() {
      var rejected = consumed(this);
      if (rejected) {
        return rejected
      }

      if (this._bodyBlob) {
        return readBlobAsText(this._bodyBlob)
      } else if (this._bodyArrayBuffer) {
        return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer))
      } else if (this._bodyFormData) {
        throw new Error('could not read FormData body as text')
      } else {
        return Promise.resolve(this._bodyText)
      }
    };

    if (support.formData) {
      this.formData = function() {
        return this.text().then(decode)
      };
    }

    this.json = function() {
      return this.text().then(JSON.parse)
    };

    return this
  }

  // HTTP methods whose capitalization should be normalized
  var methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT'];

  function normalizeMethod(method) {
    var upcased = method.toUpperCase();
    return methods.indexOf(upcased) > -1 ? upcased : method
  }

  function Request(input, options) {
    if (!(this instanceof Request)) {
      throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.')
    }

    options = options || {};
    var body = options.body;

    if (input instanceof Request) {
      if (input.bodyUsed) {
        throw new TypeError('Already read')
      }
      this.url = input.url;
      this.credentials = input.credentials;
      if (!options.headers) {
        this.headers = new Headers(input.headers);
      }
      this.method = input.method;
      this.mode = input.mode;
      this.signal = input.signal;
      if (!body && input._bodyInit != null) {
        body = input._bodyInit;
        input.bodyUsed = true;
      }
    } else {
      this.url = String(input);
    }

    this.credentials = options.credentials || this.credentials || 'same-origin';
    if (options.headers || !this.headers) {
      this.headers = new Headers(options.headers);
    }
    this.method = normalizeMethod(options.method || this.method || 'GET');
    this.mode = options.mode || this.mode || null;
    this.signal = options.signal || this.signal;
    this.referrer = null;

    if ((this.method === 'GET' || this.method === 'HEAD') && body) {
      throw new TypeError('Body not allowed for GET or HEAD requests')
    }
    this._initBody(body);

    if (this.method === 'GET' || this.method === 'HEAD') {
      if (options.cache === 'no-store' || options.cache === 'no-cache') {
        // Search for a '_' parameter in the query string
        var reParamSearch = /([?&])_=[^&]*/;
        if (reParamSearch.test(this.url)) {
          // If it already exists then set the value with the current time
          this.url = this.url.replace(reParamSearch, '$1_=' + new Date().getTime());
        } else {
          // Otherwise add a new '_' parameter to the end with the current time
          var reQueryString = /\?/;
          this.url += (reQueryString.test(this.url) ? '&' : '?') + '_=' + new Date().getTime();
        }
      }
    }
  }

  Request.prototype.clone = function() {
    return new Request(this, {body: this._bodyInit})
  };

  function decode(body) {
    var form = new FormData();
    body
      .trim()
      .split('&')
      .forEach(function(bytes) {
        if (bytes) {
          var split = bytes.split('=');
          var name = split.shift().replace(/\+/g, ' ');
          var value = split.join('=').replace(/\+/g, ' ');
          form.append(decodeURIComponent(name), decodeURIComponent(value));
        }
      });
    return form
  }

  function parseHeaders(rawHeaders) {
    var headers = new Headers();
    // Replace instances of \r\n and \n followed by at least one space or horizontal tab with a space
    // https://tools.ietf.org/html/rfc7230#section-3.2
    var preProcessedHeaders = rawHeaders.replace(/\r?\n[\t ]+/g, ' ');
    // Avoiding split via regex to work around a common IE11 bug with the core-js 3.6.0 regex polyfill
    // https://github.com/github/fetch/issues/748
    // https://github.com/zloirock/core-js/issues/751
    preProcessedHeaders
      .split('\r')
      .map(function(header) {
        return header.indexOf('\n') === 0 ? header.substr(1, header.length) : header
      })
      .forEach(function(line) {
        var parts = line.split(':');
        var key = parts.shift().trim();
        if (key) {
          var value = parts.join(':').trim();
          headers.append(key, value);
        }
      });
    return headers
  }

  Body.call(Request.prototype);

  function Response(bodyInit, options) {
    if (!(this instanceof Response)) {
      throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.')
    }
    if (!options) {
      options = {};
    }

    this.type = 'default';
    this.status = options.status === undefined ? 200 : options.status;
    this.ok = this.status >= 200 && this.status < 300;
    this.statusText = options.statusText === undefined ? '' : '' + options.statusText;
    this.headers = new Headers(options.headers);
    this.url = options.url || '';
    this._initBody(bodyInit);
  }

  Body.call(Response.prototype);

  Response.prototype.clone = function() {
    return new Response(this._bodyInit, {
      status: this.status,
      statusText: this.statusText,
      headers: new Headers(this.headers),
      url: this.url
    })
  };

  Response.error = function() {
    var response = new Response(null, {status: 0, statusText: ''});
    response.type = 'error';
    return response
  };

  var redirectStatuses = [301, 302, 303, 307, 308];

  Response.redirect = function(url, status) {
    if (redirectStatuses.indexOf(status) === -1) {
      throw new RangeError('Invalid status code')
    }

    return new Response(null, {status: status, headers: {location: url}})
  };

  exports.DOMException = global.DOMException;
  try {
    new exports.DOMException();
  } catch (err) {
    exports.DOMException = function(message, name) {
      this.message = message;
      this.name = name;
      var error = Error(message);
      this.stack = error.stack;
    };
    exports.DOMException.prototype = Object.create(Error.prototype);
    exports.DOMException.prototype.constructor = exports.DOMException;
  }

  function fetch(input, init) {
    return new Promise(function(resolve, reject) {
      var request = new Request(input, init);

      if (request.signal && request.signal.aborted) {
        return reject(new exports.DOMException('Aborted', 'AbortError'))
      }

      var xhr = new XMLHttpRequest();

      function abortXhr() {
        xhr.abort();
      }

      xhr.onload = function() {
        var options = {
          status: xhr.status,
          statusText: xhr.statusText,
          headers: parseHeaders(xhr.getAllResponseHeaders() || '')
        };
        options.url = 'responseURL' in xhr ? xhr.responseURL : options.headers.get('X-Request-URL');
        var body = 'response' in xhr ? xhr.response : xhr.responseText;
        setTimeout(function() {
          resolve(new Response(body, options));
        }, 0);
      };

      xhr.onerror = function() {
        setTimeout(function() {
          reject(new TypeError('Network request failed'));
        }, 0);
      };

      xhr.ontimeout = function() {
        setTimeout(function() {
          reject(new TypeError('Network request failed'));
        }, 0);
      };

      xhr.onabort = function() {
        setTimeout(function() {
          reject(new exports.DOMException('Aborted', 'AbortError'));
        }, 0);
      };

      function fixUrl(url) {
        try {
          return url === '' && global.location.href ? global.location.href : url
        } catch (e) {
          return url
        }
      }

      xhr.open(request.method, fixUrl(request.url), true);

      if (request.credentials === 'include') {
        xhr.withCredentials = true;
      } else if (request.credentials === 'omit') {
        xhr.withCredentials = false;
      }

      if ('responseType' in xhr) {
        if (support.blob) {
          xhr.responseType = 'blob';
        } else if (
          support.arrayBuffer &&
          request.headers.get('Content-Type') &&
          request.headers.get('Content-Type').indexOf('application/octet-stream') !== -1
        ) {
          xhr.responseType = 'arraybuffer';
        }
      }

      if (init && typeof init.headers === 'object' && !(init.headers instanceof Headers)) {
        Object.getOwnPropertyNames(init.headers).forEach(function(name) {
          xhr.setRequestHeader(name, normalizeValue(init.headers[name]));
        });
      } else {
        request.headers.forEach(function(value, name) {
          xhr.setRequestHeader(name, value);
        });
      }

      if (request.signal) {
        request.signal.addEventListener('abort', abortXhr);

        xhr.onreadystatechange = function() {
          // DONE (success or failure)
          if (xhr.readyState === 4) {
            request.signal.removeEventListener('abort', abortXhr);
          }
        };
      }

      xhr.send(typeof request._bodyInit === 'undefined' ? null : request._bodyInit);
    })
  }

  fetch.polyfill = true;

  if (!global.fetch) {
    global.fetch = fetch;
    global.Headers = Headers;
    global.Request = Request;
    global.Response = Response;
  }

  exports.Headers = Headers;
  exports.Request = Request;
  exports.Response = Response;
  exports.fetch = fetch;

  Object.defineProperty(exports, '__esModule', { value: true });

})));

/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */
!function(a,b,c,d){"use strict";function e(a,b,c){return setTimeout(j(a,c),b)}function f(a,b,c){return Array.isArray(a)?(g(a,c[b],c),!0):!1}function g(a,b,c){var e;if(a)if(a.forEach)a.forEach(b,c);else if(a.length!==d)for(e=0;e<a.length;)b.call(c,a[e],e,a),e++;else for(e in a)a.hasOwnProperty(e)&&b.call(c,a[e],e,a)}function h(b,c,d){var e="DEPRECATED METHOD: "+c+"\n"+d+" AT \n";return function(){var c=new Error("get-stack-trace"),d=c&&c.stack?c.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",f=a.console&&(a.console.warn||a.console.log);return f&&f.call(a.console,e,d),b.apply(this,arguments)}}function i(a,b,c){var d,e=b.prototype;d=a.prototype=Object.create(e),d.constructor=a,d._super=e,c&&la(d,c)}function j(a,b){return function(){return a.apply(b,arguments)}}function k(a,b){return typeof a==oa?a.apply(b?b[0]||d:d,b):a}function l(a,b){return a===d?b:a}function m(a,b,c){g(q(b),function(b){a.addEventListener(b,c,!1)})}function n(a,b,c){g(q(b),function(b){a.removeEventListener(b,c,!1)})}function o(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1}function p(a,b){return a.indexOf(b)>-1}function q(a){return a.trim().split(/\s+/g)}function r(a,b,c){if(a.indexOf&&!c)return a.indexOf(b);for(var d=0;d<a.length;){if(c&&a[d][c]==b||!c&&a[d]===b)return d;d++}return-1}function s(a){return Array.prototype.slice.call(a,0)}function t(a,b,c){for(var d=[],e=[],f=0;f<a.length;){var g=b?a[f][b]:a[f];r(e,g)<0&&d.push(a[f]),e[f]=g,f++}return c&&(d=b?d.sort(function(a,c){return a[b]>c[b]}):d.sort()),d}function u(a,b){for(var c,e,f=b[0].toUpperCase()+b.slice(1),g=0;g<ma.length;){if(c=ma[g],e=c?c+f:b,e in a)return e;g++}return d}function v(){return ua++}function w(b){var c=b.ownerDocument||b;return c.defaultView||c.parentWindow||a}function x(a,b){var c=this;this.manager=a,this.callback=b,this.element=a.element,this.target=a.options.inputTarget,this.domHandler=function(b){k(a.options.enable,[a])&&c.handler(b)},this.init()}function y(a){var b,c=a.options.inputClass;return new(b=c?c:xa?M:ya?P:wa?R:L)(a,z)}function z(a,b,c){var d=c.pointers.length,e=c.changedPointers.length,f=b&Ea&&d-e===0,g=b&(Ga|Ha)&&d-e===0;c.isFirst=!!f,c.isFinal=!!g,f&&(a.session={}),c.eventType=b,A(a,c),a.emit("hammer.input",c),a.recognize(c),a.session.prevInput=c}function A(a,b){var c=a.session,d=b.pointers,e=d.length;c.firstInput||(c.firstInput=D(b)),e>1&&!c.firstMultiple?c.firstMultiple=D(b):1===e&&(c.firstMultiple=!1);var f=c.firstInput,g=c.firstMultiple,h=g?g.center:f.center,i=b.center=E(d);b.timeStamp=ra(),b.deltaTime=b.timeStamp-f.timeStamp,b.angle=I(h,i),b.distance=H(h,i),B(c,b),b.offsetDirection=G(b.deltaX,b.deltaY);var j=F(b.deltaTime,b.deltaX,b.deltaY);b.overallVelocityX=j.x,b.overallVelocityY=j.y,b.overallVelocity=qa(j.x)>qa(j.y)?j.x:j.y,b.scale=g?K(g.pointers,d):1,b.rotation=g?J(g.pointers,d):0,b.maxPointers=c.prevInput?b.pointers.length>c.prevInput.maxPointers?b.pointers.length:c.prevInput.maxPointers:b.pointers.length,C(c,b);var k=a.element;o(b.srcEvent.target,k)&&(k=b.srcEvent.target),b.target=k}function B(a,b){var c=b.center,d=a.offsetDelta||{},e=a.prevDelta||{},f=a.prevInput||{};b.eventType!==Ea&&f.eventType!==Ga||(e=a.prevDelta={x:f.deltaX||0,y:f.deltaY||0},d=a.offsetDelta={x:c.x,y:c.y}),b.deltaX=e.x+(c.x-d.x),b.deltaY=e.y+(c.y-d.y)}function C(a,b){var c,e,f,g,h=a.lastInterval||b,i=b.timeStamp-h.timeStamp;if(b.eventType!=Ha&&(i>Da||h.velocity===d)){var j=b.deltaX-h.deltaX,k=b.deltaY-h.deltaY,l=F(i,j,k);e=l.x,f=l.y,c=qa(l.x)>qa(l.y)?l.x:l.y,g=G(j,k),a.lastInterval=b}else c=h.velocity,e=h.velocityX,f=h.velocityY,g=h.direction;b.velocity=c,b.velocityX=e,b.velocityY=f,b.direction=g}function D(a){for(var b=[],c=0;c<a.pointers.length;)b[c]={clientX:pa(a.pointers[c].clientX),clientY:pa(a.pointers[c].clientY)},c++;return{timeStamp:ra(),pointers:b,center:E(b),deltaX:a.deltaX,deltaY:a.deltaY}}function E(a){var b=a.length;if(1===b)return{x:pa(a[0].clientX),y:pa(a[0].clientY)};for(var c=0,d=0,e=0;b>e;)c+=a[e].clientX,d+=a[e].clientY,e++;return{x:pa(c/b),y:pa(d/b)}}function F(a,b,c){return{x:b/a||0,y:c/a||0}}function G(a,b){return a===b?Ia:qa(a)>=qa(b)?0>a?Ja:Ka:0>b?La:Ma}function H(a,b,c){c||(c=Qa);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return Math.sqrt(d*d+e*e)}function I(a,b,c){c||(c=Qa);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return 180*Math.atan2(e,d)/Math.PI}function J(a,b){return I(b[1],b[0],Ra)+I(a[1],a[0],Ra)}function K(a,b){return H(b[0],b[1],Ra)/H(a[0],a[1],Ra)}function L(){this.evEl=Ta,this.evWin=Ua,this.pressed=!1,x.apply(this,arguments)}function M(){this.evEl=Xa,this.evWin=Ya,x.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function N(){this.evTarget=$a,this.evWin=_a,this.started=!1,x.apply(this,arguments)}function O(a,b){var c=s(a.touches),d=s(a.changedTouches);return b&(Ga|Ha)&&(c=t(c.concat(d),"identifier",!0)),[c,d]}function P(){this.evTarget=bb,this.targetIds={},x.apply(this,arguments)}function Q(a,b){var c=s(a.touches),d=this.targetIds;if(b&(Ea|Fa)&&1===c.length)return d[c[0].identifier]=!0,[c,c];var e,f,g=s(a.changedTouches),h=[],i=this.target;if(f=c.filter(function(a){return o(a.target,i)}),b===Ea)for(e=0;e<f.length;)d[f[e].identifier]=!0,e++;for(e=0;e<g.length;)d[g[e].identifier]&&h.push(g[e]),b&(Ga|Ha)&&delete d[g[e].identifier],e++;return h.length?[t(f.concat(h),"identifier",!0),h]:void 0}function R(){x.apply(this,arguments);var a=j(this.handler,this);this.touch=new P(this.manager,a),this.mouse=new L(this.manager,a),this.primaryTouch=null,this.lastTouches=[]}function S(a,b){a&Ea?(this.primaryTouch=b.changedPointers[0].identifier,T.call(this,b)):a&(Ga|Ha)&&T.call(this,b)}function T(a){var b=a.changedPointers[0];if(b.identifier===this.primaryTouch){var c={x:b.clientX,y:b.clientY};this.lastTouches.push(c);var d=this.lastTouches,e=function(){var a=d.indexOf(c);a>-1&&d.splice(a,1)};setTimeout(e,cb)}}function U(a){for(var b=a.srcEvent.clientX,c=a.srcEvent.clientY,d=0;d<this.lastTouches.length;d++){var e=this.lastTouches[d],f=Math.abs(b-e.x),g=Math.abs(c-e.y);if(db>=f&&db>=g)return!0}return!1}function V(a,b){this.manager=a,this.set(b)}function W(a){if(p(a,jb))return jb;var b=p(a,kb),c=p(a,lb);return b&&c?jb:b||c?b?kb:lb:p(a,ib)?ib:hb}function X(){if(!fb)return!1;var b={},c=a.CSS&&a.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(d){b[d]=c?a.CSS.supports("touch-action",d):!0}),b}function Y(a){this.options=la({},this.defaults,a||{}),this.id=v(),this.manager=null,this.options.enable=l(this.options.enable,!0),this.state=nb,this.simultaneous={},this.requireFail=[]}function Z(a){return a&sb?"cancel":a&qb?"end":a&pb?"move":a&ob?"start":""}function $(a){return a==Ma?"down":a==La?"up":a==Ja?"left":a==Ka?"right":""}function _(a,b){var c=b.manager;return c?c.get(a):a}function aa(){Y.apply(this,arguments)}function ba(){aa.apply(this,arguments),this.pX=null,this.pY=null}function ca(){aa.apply(this,arguments)}function da(){Y.apply(this,arguments),this._timer=null,this._input=null}function ea(){aa.apply(this,arguments)}function fa(){aa.apply(this,arguments)}function ga(){Y.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function ha(a,b){return b=b||{},b.recognizers=l(b.recognizers,ha.defaults.preset),new ia(a,b)}function ia(a,b){this.options=la({},ha.defaults,b||{}),this.options.inputTarget=this.options.inputTarget||a,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=a,this.input=y(this),this.touchAction=new V(this,this.options.touchAction),ja(this,!0),g(this.options.recognizers,function(a){var b=this.add(new a[0](a[1]));a[2]&&b.recognizeWith(a[2]),a[3]&&b.requireFailure(a[3])},this)}function ja(a,b){var c=a.element;if(c.style){var d;g(a.options.cssProps,function(e,f){d=u(c.style,f),b?(a.oldCssProps[d]=c.style[d],c.style[d]=e):c.style[d]=a.oldCssProps[d]||""}),b||(a.oldCssProps={})}}function ka(a,c){var d=b.createEvent("Event");d.initEvent(a,!0,!0),d.gesture=c,c.target.dispatchEvent(d)}var la,ma=["","webkit","Moz","MS","ms","o"],na=b.createElement("div"),oa="function",pa=Math.round,qa=Math.abs,ra=Date.now;la="function"!=typeof Object.assign?function(a){if(a===d||null===a)throw new TypeError("Cannot convert undefined or null to object");for(var b=Object(a),c=1;c<arguments.length;c++){var e=arguments[c];if(e!==d&&null!==e)for(var f in e)e.hasOwnProperty(f)&&(b[f]=e[f])}return b}:Object.assign;var sa=h(function(a,b,c){for(var e=Object.keys(b),f=0;f<e.length;)(!c||c&&a[e[f]]===d)&&(a[e[f]]=b[e[f]]),f++;return a},"extend","Use `assign`."),ta=h(function(a,b){return sa(a,b,!0)},"merge","Use `assign`."),ua=1,va=/mobile|tablet|ip(ad|hone|od)|android/i,wa="ontouchstart"in a,xa=u(a,"PointerEvent")!==d,ya=wa&&va.test(navigator.userAgent),za="touch",Aa="pen",Ba="mouse",Ca="kinect",Da=25,Ea=1,Fa=2,Ga=4,Ha=8,Ia=1,Ja=2,Ka=4,La=8,Ma=16,Na=Ja|Ka,Oa=La|Ma,Pa=Na|Oa,Qa=["x","y"],Ra=["clientX","clientY"];x.prototype={handler:function(){},init:function(){this.evEl&&m(this.element,this.evEl,this.domHandler),this.evTarget&&m(this.target,this.evTarget,this.domHandler),this.evWin&&m(w(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&n(this.element,this.evEl,this.domHandler),this.evTarget&&n(this.target,this.evTarget,this.domHandler),this.evWin&&n(w(this.element),this.evWin,this.domHandler)}};var Sa={mousedown:Ea,mousemove:Fa,mouseup:Ga},Ta="mousedown",Ua="mousemove mouseup";i(L,x,{handler:function(a){var b=Sa[a.type];b&Ea&&0===a.button&&(this.pressed=!0),b&Fa&&1!==a.which&&(b=Ga),this.pressed&&(b&Ga&&(this.pressed=!1),this.callback(this.manager,b,{pointers:[a],changedPointers:[a],pointerType:Ba,srcEvent:a}))}});var Va={pointerdown:Ea,pointermove:Fa,pointerup:Ga,pointercancel:Ha,pointerout:Ha},Wa={2:za,3:Aa,4:Ba,5:Ca},Xa="pointerdown",Ya="pointermove pointerup pointercancel";a.MSPointerEvent&&!a.PointerEvent&&(Xa="MSPointerDown",Ya="MSPointerMove MSPointerUp MSPointerCancel"),i(M,x,{handler:function(a){var b=this.store,c=!1,d=a.type.toLowerCase().replace("ms",""),e=Va[d],f=Wa[a.pointerType]||a.pointerType,g=f==za,h=r(b,a.pointerId,"pointerId");e&Ea&&(0===a.button||g)?0>h&&(b.push(a),h=b.length-1):e&(Ga|Ha)&&(c=!0),0>h||(b[h]=a,this.callback(this.manager,e,{pointers:b,changedPointers:[a],pointerType:f,srcEvent:a}),c&&b.splice(h,1))}});var Za={touchstart:Ea,touchmove:Fa,touchend:Ga,touchcancel:Ha},$a="touchstart",_a="touchstart touchmove touchend touchcancel";i(N,x,{handler:function(a){var b=Za[a.type];if(b===Ea&&(this.started=!0),this.started){var c=O.call(this,a,b);b&(Ga|Ha)&&c[0].length-c[1].length===0&&(this.started=!1),this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:za,srcEvent:a})}}});var ab={touchstart:Ea,touchmove:Fa,touchend:Ga,touchcancel:Ha},bb="touchstart touchmove touchend touchcancel";i(P,x,{handler:function(a){var b=ab[a.type],c=Q.call(this,a,b);c&&this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:za,srcEvent:a})}});var cb=2500,db=25;i(R,x,{handler:function(a,b,c){var d=c.pointerType==za,e=c.pointerType==Ba;if(!(e&&c.sourceCapabilities&&c.sourceCapabilities.firesTouchEvents)){if(d)S.call(this,b,c);else if(e&&U.call(this,c))return;this.callback(a,b,c)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var eb=u(na.style,"touchAction"),fb=eb!==d,gb="compute",hb="auto",ib="manipulation",jb="none",kb="pan-x",lb="pan-y",mb=X();V.prototype={set:function(a){a==gb&&(a=this.compute()),fb&&this.manager.element.style&&mb[a]&&(this.manager.element.style[eb]=a),this.actions=a.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var a=[];return g(this.manager.recognizers,function(b){k(b.options.enable,[b])&&(a=a.concat(b.getTouchAction()))}),W(a.join(" "))},preventDefaults:function(a){var b=a.srcEvent,c=a.offsetDirection;if(this.manager.session.prevented)return void b.preventDefault();var d=this.actions,e=p(d,jb)&&!mb[jb],f=p(d,lb)&&!mb[lb],g=p(d,kb)&&!mb[kb];if(e){var h=1===a.pointers.length,i=a.distance<2,j=a.deltaTime<250;if(h&&i&&j)return}return g&&f?void 0:e||f&&c&Na||g&&c&Oa?this.preventSrc(b):void 0},preventSrc:function(a){this.manager.session.prevented=!0,a.preventDefault()}};var nb=1,ob=2,pb=4,qb=8,rb=qb,sb=16,tb=32;Y.prototype={defaults:{},set:function(a){return la(this.options,a),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(a){if(f(a,"recognizeWith",this))return this;var b=this.simultaneous;return a=_(a,this),b[a.id]||(b[a.id]=a,a.recognizeWith(this)),this},dropRecognizeWith:function(a){return f(a,"dropRecognizeWith",this)?this:(a=_(a,this),delete this.simultaneous[a.id],this)},requireFailure:function(a){if(f(a,"requireFailure",this))return this;var b=this.requireFail;return a=_(a,this),-1===r(b,a)&&(b.push(a),a.requireFailure(this)),this},dropRequireFailure:function(a){if(f(a,"dropRequireFailure",this))return this;a=_(a,this);var b=r(this.requireFail,a);return b>-1&&this.requireFail.splice(b,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(a){return!!this.simultaneous[a.id]},emit:function(a){function b(b){c.manager.emit(b,a)}var c=this,d=this.state;qb>d&&b(c.options.event+Z(d)),b(c.options.event),a.additionalEvent&&b(a.additionalEvent),d>=qb&&b(c.options.event+Z(d))},tryEmit:function(a){return this.canEmit()?this.emit(a):void(this.state=tb)},canEmit:function(){for(var a=0;a<this.requireFail.length;){if(!(this.requireFail[a].state&(tb|nb)))return!1;a++}return!0},recognize:function(a){var b=la({},a);return k(this.options.enable,[this,b])?(this.state&(rb|sb|tb)&&(this.state=nb),this.state=this.process(b),void(this.state&(ob|pb|qb|sb)&&this.tryEmit(b))):(this.reset(),void(this.state=tb))},process:function(a){},getTouchAction:function(){},reset:function(){}},i(aa,Y,{defaults:{pointers:1},attrTest:function(a){var b=this.options.pointers;return 0===b||a.pointers.length===b},process:function(a){var b=this.state,c=a.eventType,d=b&(ob|pb),e=this.attrTest(a);return d&&(c&Ha||!e)?b|sb:d||e?c&Ga?b|qb:b&ob?b|pb:ob:tb}}),i(ba,aa,{defaults:{event:"pan",threshold:10,pointers:1,direction:Pa},getTouchAction:function(){var a=this.options.direction,b=[];return a&Na&&b.push(lb),a&Oa&&b.push(kb),b},directionTest:function(a){var b=this.options,c=!0,d=a.distance,e=a.direction,f=a.deltaX,g=a.deltaY;return e&b.direction||(b.direction&Na?(e=0===f?Ia:0>f?Ja:Ka,c=f!=this.pX,d=Math.abs(a.deltaX)):(e=0===g?Ia:0>g?La:Ma,c=g!=this.pY,d=Math.abs(a.deltaY))),a.direction=e,c&&d>b.threshold&&e&b.direction},attrTest:function(a){return aa.prototype.attrTest.call(this,a)&&(this.state&ob||!(this.state&ob)&&this.directionTest(a))},emit:function(a){this.pX=a.deltaX,this.pY=a.deltaY;var b=$(a.direction);b&&(a.additionalEvent=this.options.event+b),this._super.emit.call(this,a)}}),i(ca,aa,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[jb]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.scale-1)>this.options.threshold||this.state&ob)},emit:function(a){if(1!==a.scale){var b=a.scale<1?"in":"out";a.additionalEvent=this.options.event+b}this._super.emit.call(this,a)}}),i(da,Y,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[hb]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime>b.time;if(this._input=a,!d||!c||a.eventType&(Ga|Ha)&&!f)this.reset();else if(a.eventType&Ea)this.reset(),this._timer=e(function(){this.state=rb,this.tryEmit()},b.time,this);else if(a.eventType&Ga)return rb;return tb},reset:function(){clearTimeout(this._timer)},emit:function(a){this.state===rb&&(a&&a.eventType&Ga?this.manager.emit(this.options.event+"up",a):(this._input.timeStamp=ra(),this.manager.emit(this.options.event,this._input)))}}),i(ea,aa,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[jb]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.rotation)>this.options.threshold||this.state&ob)}}),i(fa,aa,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Na|Oa,pointers:1},getTouchAction:function(){return ba.prototype.getTouchAction.call(this)},attrTest:function(a){var b,c=this.options.direction;return c&(Na|Oa)?b=a.overallVelocity:c&Na?b=a.overallVelocityX:c&Oa&&(b=a.overallVelocityY),this._super.attrTest.call(this,a)&&c&a.offsetDirection&&a.distance>this.options.threshold&&a.maxPointers==this.options.pointers&&qa(b)>this.options.velocity&&a.eventType&Ga},emit:function(a){var b=$(a.offsetDirection);b&&this.manager.emit(this.options.event+b,a),this.manager.emit(this.options.event,a)}}),i(ga,Y,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[ib]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime<b.time;if(this.reset(),a.eventType&Ea&&0===this.count)return this.failTimeout();if(d&&f&&c){if(a.eventType!=Ga)return this.failTimeout();var g=this.pTime?a.timeStamp-this.pTime<b.interval:!0,h=!this.pCenter||H(this.pCenter,a.center)<b.posThreshold;this.pTime=a.timeStamp,this.pCenter=a.center,h&&g?this.count+=1:this.count=1,this._input=a;var i=this.count%b.taps;if(0===i)return this.hasRequireFailures()?(this._timer=e(function(){this.state=rb,this.tryEmit()},b.interval,this),ob):rb}return tb},failTimeout:function(){return this._timer=e(function(){this.state=tb},this.options.interval,this),tb},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==rb&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),ha.VERSION="2.0.7",ha.defaults={domEvents:!1,touchAction:gb,enable:!0,inputTarget:null,inputClass:null,preset:[[ea,{enable:!1}],[ca,{enable:!1},["rotate"]],[fa,{direction:Na}],[ba,{direction:Na},["swipe"]],[ga],[ga,{event:"doubletap",taps:2},["tap"]],[da]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var ub=1,vb=2;ia.prototype={set:function(a){return la(this.options,a),a.touchAction&&this.touchAction.update(),a.inputTarget&&(this.input.destroy(),this.input.target=a.inputTarget,this.input.init()),this},stop:function(a){this.session.stopped=a?vb:ub},recognize:function(a){var b=this.session;if(!b.stopped){this.touchAction.preventDefaults(a);var c,d=this.recognizers,e=b.curRecognizer;(!e||e&&e.state&rb)&&(e=b.curRecognizer=null);for(var f=0;f<d.length;)c=d[f],b.stopped===vb||e&&c!=e&&!c.canRecognizeWith(e)?c.reset():c.recognize(a),!e&&c.state&(ob|pb|qb)&&(e=b.curRecognizer=c),f++}},get:function(a){if(a instanceof Y)return a;for(var b=this.recognizers,c=0;c<b.length;c++)if(b[c].options.event==a)return b[c];return null},add:function(a){if(f(a,"add",this))return this;var b=this.get(a.options.event);return b&&this.remove(b),this.recognizers.push(a),a.manager=this,this.touchAction.update(),a},remove:function(a){if(f(a,"remove",this))return this;if(a=this.get(a)){var b=this.recognizers,c=r(b,a);-1!==c&&(b.splice(c,1),this.touchAction.update())}return this},on:function(a,b){if(a!==d&&b!==d){var c=this.handlers;return g(q(a),function(a){c[a]=c[a]||[],c[a].push(b)}),this}},off:function(a,b){if(a!==d){var c=this.handlers;return g(q(a),function(a){b?c[a]&&c[a].splice(r(c[a],b),1):delete c[a]}),this}},emit:function(a,b){this.options.domEvents&&ka(a,b);var c=this.handlers[a]&&this.handlers[a].slice();if(c&&c.length){b.type=a,b.preventDefault=function(){b.srcEvent.preventDefault()};for(var d=0;d<c.length;)c[d](b),d++}},destroy:function(){this.element&&ja(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},la(ha,{INPUT_START:Ea,INPUT_MOVE:Fa,INPUT_END:Ga,INPUT_CANCEL:Ha,STATE_POSSIBLE:nb,STATE_BEGAN:ob,STATE_CHANGED:pb,STATE_ENDED:qb,STATE_RECOGNIZED:rb,STATE_CANCELLED:sb,STATE_FAILED:tb,DIRECTION_NONE:Ia,DIRECTION_LEFT:Ja,DIRECTION_RIGHT:Ka,DIRECTION_UP:La,DIRECTION_DOWN:Ma,DIRECTION_HORIZONTAL:Na,DIRECTION_VERTICAL:Oa,DIRECTION_ALL:Pa,Manager:ia,Input:x,TouchAction:V,TouchInput:P,MouseInput:L,PointerEventInput:M,TouchMouseInput:R,SingleTouchInput:N,Recognizer:Y,AttrRecognizer:aa,Tap:ga,Pan:ba,Swipe:fa,Pinch:ca,Rotate:ea,Press:da,on:m,off:n,each:g,merge:ta,extend:sa,assign:la,inherit:i,bindFn:j,prefixed:u});var wb="undefined"!=typeof a?a:"undefined"!=typeof self?self:{};wb.Hammer=ha,"function"==typeof define&&define.amd?define(function(){return ha}):"undefined"!=typeof module&&module.exports?module.exports=ha:a[c]=ha}(window,document,"Hammer");
//# sourceMappingURL=hammer.min.js.map
!function(){"use strict";function n(n,i){for(var e=0;e<i.length;e++){var t=i[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(n,t.key,t)}}function i(n,i,e){return i in n?Object.defineProperty(n,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[i]=e,n}var e=function(){function e(){!function(n,i){if(!(n instanceof i))throw new TypeError("Cannot call a class as a function")}(this,e),i(this,"mPlugins",void 0),i(this,"mEvents",void 0),this.mPlugins={},this.mEvents={}}var t,u;return t=e,(u=[{key:"registerPlugin",value:function(n,i){return void 0===this.mPlugins[n]&&(this.mPlugins[n]=i,this[n]=function(){var i;return(i=this.mPlugins)[n].apply(i,arguments)},!0)}},{key:"unregisterPlugin",value:function(n){return void 0!==this.mPlugins[n]&&(delete this.mPlugins[n],delete this[n],!0)}},{key:"subscribe",value:function(n,i){return void 0===this.mEvents[n]&&(this.mEvents[n]=[]),this.mEvents[n].push(i)}},{key:"unsubscribe",value:function(n,i){void 0!==this.mEvents[n]&&(this.mEvents[n][i]=void 0)}},{key:"emit",value:function(n,i){void 0!==this.mEvents[n]&&this.mEvents[n].forEach((function(n){void 0!==n&&setTimeout((function(){n(i)}),0)}))}}])&&n(t.prototype,u),e}();window.expivi=window.expivi||{interact:null};var t=null;window.expivi.interact=function(){return null===t&&(t=new e),t}}();
!function(){"use strict";function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i=function(){function i(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),n(this,"mOptions",void 0),n(this,"mOriginalItem",void 0),n(this,"mDimensions",void 0),n(this,"mDomObserver",void 0),this.mOptions=function(t){for(var i=1;i<arguments.length;i++){var r=null!=arguments[i]?arguments[i]:{};i%2?e(Object(r),!0).forEach((function(e){n(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):e(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},t),this.mOriginalItem=this.mOptions.element,this.mDimensions={width:0,height:0};var r=window.MutationObserver||window.WebKitMutationObserver;this.mDomObserver=new r(this.onDomChanged.bind(this)),this.mDomObserver.observe(this.mOriginalItem,{attributes:!1,childList:!0,subtree:!0}),this.update()}var r,o;return r=i,(o=[{key:"destroy",value:function(){this.mDomObserver&&this.mDomObserver.disconnect()}},{key:"update",value:function(){var e=this.mOriginalItem.getBoundingClientRect();this.mDimensions.width=e.width,this.mDimensions.height=e.height}},{key:"onDropped",value:function(e,t){return!!this.isInRect(e,t)}},{key:"onDomChanged",value:function(){this.update()}},{key:"isInRect",value:function(e,t){var n=this.mOriginalItem.getBoundingClientRect(),i=document.body.getBoundingClientRect(),r=n.left-i.left,o=n.top-i.top,s=r+n.width,u=o+n.height;return e>r&&t>o&&e<s&&t<u}},{key:"width",get:function(){return this.mDimensions.width}},{key:"height",get:function(){return this.mDimensions.height}},{key:"element",get:function(){return this.mOptions.element}}])&&t(r.prototype,o),i}();function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),s(this,"mOptions",void 0),s(this,"mItems",[]),s(this,"mSubscriptions",[]),s(this,"mListeners",[]),this.mOptions=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({ondropped:function(){}},t);var n=this.parseElements(this.mOptions.droppable);this.mItems=n.map((function(e){return new i({element:e})})),this.registerListeners()}var t,n;return t=e,(n=[{key:"destroy",value:function(){this.unregisterListeners(),this.mItems.splice(0).forEach((function(e){return e.destroy()}))}},{key:"registerListeners",value:function(){var e=this;this.addEventListener({name:"resize",el:document,fn:this.onWindowResize.bind(this),options:!1}),this.mSubscriptions.push(window.expivi.interact().subscribe("draggable:dragend",(function(t){var n=t.position.x,i=t.position.y;e.mItems.forEach((function(r){r.onDropped(n,i)&&e.mOptions.ondropped({type:"droppped",originalSource:t.originalSource,event:t.event,position:{x:n,y:i},clientX:n-window.pageXOffset,clientY:i-window.pageYOffset,width:r.width,height:r.height})}))})))}},{key:"unregisterListeners",value:function(){this.mListeners.splice(0).forEach((function(e){e.el.removeEventListener(e.name,e.fn,e.options)})),this.mSubscriptions.splice(0).forEach((function(e){return window.expivi.interact().unsubscribe("draggable:dragend",e)}))}},{key:"onWindowResize",value:function(e){this.mItems.forEach((function(e){e.update()}))}},{key:"parseElements",value:function(e){if(null==e||null==e)return[];if(e&&e.nodeName)return[e];if("string"==typeof e){for(var t=[],n=document.querySelectorAll(e),i=0;i<n.length;i++)t.push(n[i]);return t}return Array.isArray(e)?e:[]}},{key:"addEventListener",value:function(e){e.el.addEventListener(e.name,e.fn,e.options),this.mListeners.push(e)}}])&&o(t.prototype,n),e}();if(void 0===window.expivi.interact)throw"Implement expivi-interact before dropzone.";window.expivi.interact().registerPlugin("dropzone",(function(e){return new u(e)}))}();
// threejs.org/license
(function(l,ta){"object"===typeof exports&&"undefined"!==typeof module?ta(exports):"function"===typeof define&&define.amd?define(["exports"],ta):(l=l||self,ta(l.THREE={}))})(this,function(l){function ta(){}function B(a,b){this.x=a||0;this.y=b||0}function aa(a,b,c,d){this._x=a||0;this._y=b||0;this._z=c||0;this._w=void 0!==d?d:1}function n(a,b,c){this.x=a||0;this.y=b||0;this.z=c||0}function ba(){this.elements=[1,0,0,0,1,0,0,0,1];0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}
function W(a,b,c,d,e,f,g,h,k,m){Object.defineProperty(this,"id",{value:Uf++});this.uuid=K.generateUUID();this.name="";this.image=void 0!==a?a:W.DEFAULT_IMAGE;this.mipmaps=[];this.mapping=void 0!==b?b:W.DEFAULT_MAPPING;this.wrapS=void 0!==c?c:1001;this.wrapT=void 0!==d?d:1001;this.magFilter=void 0!==e?e:1006;this.minFilter=void 0!==f?f:1008;this.anisotropy=void 0!==k?k:1;this.format=void 0!==g?g:1023;this.type=void 0!==h?h:1009;this.offset=new B(0,0);this.repeat=new B(1,1);this.center=new B(0,0);this.rotation=
0;this.matrixAutoUpdate=!0;this.matrix=new ba;this.generateMipmaps=!0;this.premultiplyAlpha=!1;this.flipY=!0;this.unpackAlignment=4;this.encoding=void 0!==m?m:3E3;this.version=0;this.onUpdate=null}function Y(a,b,c,d){this.x=a||0;this.y=b||0;this.z=c||0;this.w=void 0!==d?d:1}function Ta(a,b,c){this.width=a;this.height=b;this.scissor=new Y(0,0,a,b);this.scissorTest=!1;this.viewport=new Y(0,0,a,b);c=c||{};this.texture=new W(void 0,void 0,c.wrapS,c.wrapT,c.magFilter,c.minFilter,c.format,c.type,c.anisotropy,
c.encoding);this.texture.generateMipmaps=void 0!==c.generateMipmaps?c.generateMipmaps:!1;this.texture.minFilter=void 0!==c.minFilter?c.minFilter:1006;this.depthBuffer=void 0!==c.depthBuffer?c.depthBuffer:!0;this.stencilBuffer=void 0!==c.stencilBuffer?c.stencilBuffer:!0;this.depthTexture=void 0!==c.depthTexture?c.depthTexture:null}function $d(a,b,c){Ta.call(this,a,b,c);this.samples=4}function pb(a,b,c){Ta.call(this,a,b,c)}function qb(a,b,c,d,e,f,g,h,k,m,p,q){W.call(this,null,f,g,h,k,m,d,e,p,q);this.image=
{data:a,width:b,height:c};this.magFilter=void 0!==k?k:1003;this.minFilter=void 0!==m?m:1003;this.flipY=this.generateMipmaps=!1;this.unpackAlignment=1}function Ja(a,b){this.min=void 0!==a?a:new n(Infinity,Infinity,Infinity);this.max=void 0!==b?b:new n(-Infinity,-Infinity,-Infinity)}function Ua(a,b){this.center=void 0!==a?a:new n;this.radius=void 0!==b?b:0}function Va(a,b){this.normal=void 0!==a?a:new n(1,0,0);this.constant=void 0!==b?b:0}function vd(a,b,c,d,e,f){this.planes=[void 0!==a?a:new Va,void 0!==
b?b:new Va,void 0!==c?c:new Va,void 0!==d?d:new Va,void 0!==e?e:new Va,void 0!==f?f:new Va]}function P(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function Pb(a){var b={},c;for(c in a){b[c]={};for(var d in a[c]){var e=a[c][d];e&&(e.isColor||e.isMatrix3||e.isMatrix4||e.isVector2||e.isVector3||e.isVector4||e.isTexture)?b[c][d]=e.clone():Array.isArray(e)?b[c][d]=e.slice():b[c][d]=
e}}return b}function ia(a){for(var b={},c=0;c<a.length;c++){var d=Pb(a[c]),e;for(e in d)b[e]=d[e]}return b}function M(a,b,c){return void 0===b&&void 0===c?this.set(a):this.setRGB(a,b,c)}function ae(){function a(e,f){!1!==c&&(d(e,f),b.requestAnimationFrame(a))}var b=null,c=!1,d=null;return{start:function(){!0!==c&&null!==d&&(b.requestAnimationFrame(a),c=!0)},stop:function(){c=!1},setAnimationLoop:function(a){d=a},setContext:function(a){b=a}}}function Vf(a){function b(b,c){var d=b.array,e=b.dynamic?
35048:35044,h=a.createBuffer();a.bindBuffer(c,h);a.bufferData(c,d,e);b.onUploadCallback();c=5126;d instanceof Float32Array?c=5126:d instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):d instanceof Uint16Array?c=5123:d instanceof Int16Array?c=5122:d instanceof Uint32Array?c=5125:d instanceof Int32Array?c=5124:d instanceof Int8Array?c=5120:d instanceof Uint8Array&&(c=5121);return{buffer:h,type:c,bytesPerElement:d.BYTES_PER_ELEMENT,version:b.version}}
var c=new WeakMap;return{get:function(a){a.isInterleavedBufferAttribute&&(a=a.data);return c.get(a)},remove:function(b){b.isInterleavedBufferAttribute&&(b=b.data);var d=c.get(b);d&&(a.deleteBuffer(d.buffer),c.delete(b))},update:function(d,e){d.isInterleavedBufferAttribute&&(d=d.data);var f=c.get(d);if(void 0===f)c.set(d,b(d,e));else if(f.version<d.version){var g=d,h=g.array,k=g.updateRange;a.bindBuffer(e,f.buffer);!1===g.dynamic?a.bufferData(e,h,35044):-1===k.count?a.bufferSubData(e,0,h):0===k.count?
console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(a.bufferSubData(e,k.offset*h.BYTES_PER_ELEMENT,h.subarray(k.offset,k.offset+k.count)),k.count=-1);f.version=d.version}}}}function Qb(a,b,c,d,e,f){this.a=a;this.b=b;this.c=c;this.normal=d&&d.isVector3?d:new n;this.vertexNormals=Array.isArray(d)?d:[];this.color=e&&e.isColor?e:new M;this.vertexColors=Array.isArray(e)?
e:[];this.materialIndex=void 0!==f?f:0}function rb(a,b,c,d){this._x=a||0;this._y=b||0;this._z=c||0;this._order=d||rb.DefaultOrder}function be(){this.mask=1}function C(){Object.defineProperty(this,"id",{value:Wf++});this.uuid=K.generateUUID();this.name="";this.type="Object3D";this.parent=null;this.children=[];this.up=C.DefaultUp.clone();var a=new n,b=new rb,c=new aa,d=new n(1,1,1);b.onChange(function(){c.setFromEuler(b,!1)});c.onChange(function(){b.setFromQuaternion(c,void 0,!1)});Object.defineProperties(this,
{position:{configurable:!0,enumerable:!0,value:a},rotation:{configurable:!0,enumerable:!0,value:b},quaternion:{configurable:!0,enumerable:!0,value:c},scale:{configurable:!0,enumerable:!0,value:d},modelViewMatrix:{value:new P},normalMatrix:{value:new ba}});this.matrix=new P;this.matrixWorld=new P;this.matrixAutoUpdate=C.DefaultMatrixAutoUpdate;this.matrixWorldNeedsUpdate=!1;this.layers=new be;this.visible=!0;this.receiveShadow=this.castShadow=!1;this.frustumCulled=!0;this.renderOrder=0;this.userData=
{}}function N(){Object.defineProperty(this,"id",{value:Xf+=2});this.uuid=K.generateUUID();this.name="";this.type="Geometry";this.vertices=[];this.colors=[];this.faces=[];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingSphere=this.boundingBox=null;this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.verticesNeedUpdate=this.elementsNeedUpdate=
!1}function S(a,b,c){if(Array.isArray(a))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="";this.array=a;this.itemSize=b;this.count=void 0!==a?a.length/b:0;this.normalized=!0===c;this.dynamic=!1;this.updateRange={offset:0,count:-1};this.version=0}function xc(a,b,c){S.call(this,new Int8Array(a),b,c)}function yc(a,b,c){S.call(this,new Uint8Array(a),b,c)}function zc(a,b,c){S.call(this,new Uint8ClampedArray(a),b,c)}function Ac(a,b,c){S.call(this,new Int16Array(a),
b,c)}function sb(a,b,c){S.call(this,new Uint16Array(a),b,c)}function Bc(a,b,c){S.call(this,new Int32Array(a),b,c)}function tb(a,b,c){S.call(this,new Uint32Array(a),b,c)}function E(a,b,c){S.call(this,new Float32Array(a),b,c)}function Cc(a,b,c){S.call(this,new Float64Array(a),b,c)}function Qe(){this.vertices=[];this.normals=[];this.colors=[];this.uvs=[];this.uvs2=[];this.groups=[];this.morphTargets={};this.skinWeights=[];this.skinIndices=[];this.boundingSphere=this.boundingBox=null;this.groupsNeedUpdate=
this.uvsNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.verticesNeedUpdate=!1}function Re(a){if(0===a.length)return-Infinity;for(var b=a[0],c=1,d=a.length;c<d;++c)a[c]>b&&(b=a[c]);return b}function z(){Object.defineProperty(this,"id",{value:Yf+=2});this.uuid=K.generateUUID();this.name="";this.type="BufferGeometry";this.index=null;this.attributes={};this.morphAttributes={};this.groups=[];this.boundingSphere=this.boundingBox=null;this.drawRange={start:0,count:Infinity};this.userData={}}
function Rb(a,b,c,d,e,f){N.call(this);this.type="BoxGeometry";this.parameters={width:a,height:b,depth:c,widthSegments:d,heightSegments:e,depthSegments:f};this.fromBufferGeometry(new ub(a,b,c,d,e,f));this.mergeVertices()}function ub(a,b,c,d,e,f){function g(a,b,c,d,e,f,g,l,ua,F,Zf){var r=f/ua,u=g/F,x=f/2,w=g/2,A=l/2;g=ua+1;var y=F+1,X=f=0,Q,J,D=new n;for(J=0;J<y;J++){var B=J*u-w;for(Q=0;Q<g;Q++)D[a]=(Q*r-x)*d,D[b]=B*e,D[c]=A,m.push(D.x,D.y,D.z),D[a]=0,D[b]=0,D[c]=0<l?1:-1,p.push(D.x,D.y,D.z),q.push(Q/
ua),q.push(1-J/F),f+=1}for(J=0;J<F;J++)for(Q=0;Q<ua;Q++)a=v+Q+g*(J+1),b=v+(Q+1)+g*(J+1),c=v+(Q+1)+g*J,k.push(v+Q+g*J,a,c),k.push(a,b,c),X+=6;h.addGroup(t,X,Zf);t+=X;v+=f}z.call(this);this.type="BoxBufferGeometry";this.parameters={width:a,height:b,depth:c,widthSegments:d,heightSegments:e,depthSegments:f};var h=this;a=a||1;b=b||1;c=c||1;d=Math.floor(d)||1;e=Math.floor(e)||1;f=Math.floor(f)||1;var k=[],m=[],p=[],q=[],v=0,t=0;g("z","y","x",-1,-1,c,b,a,f,e,0);g("z","y","x",1,-1,c,b,-a,f,e,1);g("x","z",
"y",1,1,a,c,b,d,f,2);g("x","z","y",1,-1,a,c,-b,d,f,3);g("x","y","z",1,-1,a,b,c,d,e,4);g("x","y","z",-1,-1,a,b,-c,d,e,5);this.setIndex(k);this.addAttribute("position",new E(m,3));this.addAttribute("normal",new E(p,3));this.addAttribute("uv",new E(q,2))}function Dc(a,b,c,d){N.call(this);this.type="PlaneGeometry";this.parameters={width:a,height:b,widthSegments:c,heightSegments:d};this.fromBufferGeometry(new vb(a,b,c,d));this.mergeVertices()}function vb(a,b,c,d){z.call(this);this.type="PlaneBufferGeometry";
this.parameters={width:a,height:b,widthSegments:c,heightSegments:d};a=a||1;b=b||1;var e=a/2,f=b/2;c=Math.floor(c)||1;d=Math.floor(d)||1;var g=c+1,h=d+1,k=a/c,m=b/d,p=[],q=[],v=[],t=[];for(a=0;a<h;a++){var l=a*m-f;for(b=0;b<g;b++)q.push(b*k-e,-l,0),v.push(0,0,1),t.push(b/c),t.push(1-a/d)}for(a=0;a<d;a++)for(b=0;b<c;b++)e=b+g*(a+1),f=b+1+g*(a+1),h=b+1+g*a,p.push(b+g*a,e,h),p.push(e,f,h);this.setIndex(p);this.addAttribute("position",new E(q,3));this.addAttribute("normal",new E(v,3));this.addAttribute("uv",
new E(t,2))}function O(){Object.defineProperty(this,"id",{value:$f++});this.uuid=K.generateUUID();this.name="";this.type="Material";this.lights=this.fog=!0;this.blending=1;this.side=0;this.vertexTangents=this.flatShading=!1;this.vertexColors=0;this.opacity=1;this.transparent=!1;this.blendSrc=204;this.blendDst=205;this.blendEquation=100;this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null;this.depthFunc=3;this.depthWrite=this.depthTest=!0;this.clippingPlanes=null;this.clipShadows=this.clipIntersection=
!1;this.shadowSide=null;this.colorWrite=!0;this.precision=null;this.polygonOffset=!1;this.polygonOffsetUnits=this.polygonOffsetFactor=0;this.dithering=!1;this.alphaTest=0;this.premultipliedAlpha=!1;this.visible=!0;this.userData={};this.needsUpdate=!0}function Ca(a){O.call(this);this.type="ShaderMaterial";this.defines={};this.uniforms={};this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}";this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";
this.linewidth=1;this.wireframe=!1;this.wireframeLinewidth=1;this.morphNormals=this.morphTargets=this.skinning=this.clipping=this.lights=this.fog=!1;this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1};this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]};this.index0AttributeName=void 0;this.uniformsNeedUpdate=!1;void 0!==a&&(void 0!==a.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(a))}
function wb(a,b){this.origin=void 0!==a?a:new n;this.direction=void 0!==b?b:new n}function ra(a,b,c){this.a=void 0!==a?a:new n;this.b=void 0!==b?b:new n;this.c=void 0!==c?c:new n}function Da(a){O.call(this);this.type="MeshBasicMaterial";this.color=new M(16777215);this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.envMap=this.alphaMap=this.specularMap=null;this.combine=0;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=!1;this.wireframeLinewidth=
1;this.wireframeLinejoin=this.wireframeLinecap="round";this.lights=this.morphTargets=this.skinning=!1;this.setValues(a)}function va(a,b){C.call(this);this.type="Mesh";this.geometry=void 0!==a?a:new z;this.material=void 0!==b?b:new Da({color:16777215*Math.random()});this.drawMode=0;this.updateMorphTargets()}function ag(a,b,c,d){function e(a,c){b.buffers.color.setClear(a.r,a.g,a.b,c,d)}var f=new M(0),g=0,h,k,m=null,p=0;return{getClearColor:function(){return f},setClearColor:function(a,b){f.set(a);g=
void 0!==b?b:1;e(f,g)},getClearAlpha:function(){return g},setClearAlpha:function(a){g=a;e(f,g)},render:function(b,d,t,l){d=d.background;t=a.vr;(t=t.getSession&&t.getSession())&&"additive"===t.environmentBlendMode&&(d=null);null===d?(e(f,g),m=null,p=0):d&&d.isColor&&(e(d,1),l=!0,m=null,p=0);(a.autoClear||l)&&a.clear(a.autoClearColor,a.autoClearDepth,a.autoClearStencil);if(d&&(d.isCubeTexture||d.isWebGLRenderTargetCube)){void 0===k&&(k=new va(new ub(1,1,1),new Ca({type:"BackgroundCubeMaterial",uniforms:Pb(Wa.cube.uniforms),
vertexShader:Wa.cube.vertexShader,fragmentShader:Wa.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),k.geometry.removeAttribute("normal"),k.geometry.removeAttribute("uv"),k.onBeforeRender=function(a,b,c){this.matrixWorld.copyPosition(c.matrixWorld)},Object.defineProperty(k.material,"map",{get:function(){return this.uniforms.tCube.value}}),c.update(k));l=d.isWebGLRenderTargetCube?d.texture:d;k.material.uniforms.tCube.value=l;k.material.uniforms.tFlip.value=d.isWebGLRenderTargetCube?
1:-1;if(m!==d||p!==l.version)k.material.needsUpdate=!0,m=d,p=l.version;b.unshift(k,k.geometry,k.material,0,0,null)}else if(d&&d.isTexture){void 0===h&&(h=new va(new vb(2,2),new Ca({type:"BackgroundMaterial",uniforms:Pb(Wa.background.uniforms),vertexShader:Wa.background.vertexShader,fragmentShader:Wa.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.removeAttribute("normal"),Object.defineProperty(h.material,"map",{get:function(){return this.uniforms.t2D.value}}),c.update(h));
h.material.uniforms.t2D.value=d;!0===d.matrixAutoUpdate&&d.updateMatrix();h.material.uniforms.uvTransform.value.copy(d.matrix);if(m!==d||p!==d.version)h.material.needsUpdate=!0,m=d,p=d.version;b.unshift(h,h.geometry,h.material,0,0,null)}}}}function bg(a,b,c,d){var e;this.setMode=function(a){e=a};this.render=function(b,d){a.drawArrays(e,b,d);c.update(d,e)};this.renderInstances=function(f,g,h){if(d.isWebGL2)var k=a;else if(k=b.get("ANGLE_instanced_arrays"),null===k){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");
return}k[d.isWebGL2?"drawArraysInstanced":"drawArraysInstancedANGLE"](e,g,h,f.maxInstancedCount);c.update(h,e,f.maxInstancedCount)}}function cg(a,b,c){function d(b){if("highp"===b){if(0<a.getShaderPrecisionFormat(35633,36338).precision&&0<a.getShaderPrecisionFormat(35632,36338).precision)return"highp";b="mediump"}return"mediump"===b&&0<a.getShaderPrecisionFormat(35633,36337).precision&&0<a.getShaderPrecisionFormat(35632,36337).precision?"mediump":"lowp"}var e,f="undefined"!==typeof WebGL2RenderingContext&&
a instanceof WebGL2RenderingContext,g=void 0!==c.precision?c.precision:"highp",h=d(g);h!==g&&(console.warn("THREE.WebGLRenderer:",g,"not supported, using",h,"instead."),g=h);c=!0===c.logarithmicDepthBuffer;h=a.getParameter(34930);var k=a.getParameter(35660),m=a.getParameter(3379),p=a.getParameter(34076),q=a.getParameter(34921),v=a.getParameter(36347),t=a.getParameter(36348),l=a.getParameter(36349),u=0<k,x=f||!!b.get("OES_texture_float"),n=u&&x,w=f?a.getParameter(36183):0;return{isWebGL2:f,getMaxAnisotropy:function(){if(void 0!==
e)return e;var c=b.get("EXT_texture_filter_anisotropic");return e=null!==c?a.getParameter(c.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:d,precision:g,logarithmicDepthBuffer:c,maxTextures:h,maxVertexTextures:k,maxTextureSize:m,maxCubemapSize:p,maxAttributes:q,maxVertexUniforms:v,maxVaryings:t,maxFragmentUniforms:l,vertexTextures:u,floatFragmentTextures:x,floatVertexTextures:n,maxSamples:w}}function dg(){function a(){m.value!==d&&(m.value=d,m.needsUpdate=0<e);c.numPlanes=e;c.numIntersection=
0}function b(a,b,d,e){var f=null!==a?a.length:0,g=null;if(0!==f){g=m.value;if(!0!==e||null===g){e=d+4*f;b=b.matrixWorldInverse;k.getNormalMatrix(b);if(null===g||g.length<e)g=new Float32Array(e);for(e=0;e!==f;++e,d+=4)h.copy(a[e]).applyMatrix4(b,k),h.normal.toArray(g,d),g[d+3]=h.constant}m.value=g;m.needsUpdate=!0}c.numPlanes=f;return g}var c=this,d=null,e=0,f=!1,g=!1,h=new Va,k=new ba,m={value:null,needsUpdate:!1};this.uniform=m;this.numIntersection=this.numPlanes=0;this.init=function(a,c,g){var h=
0!==a.length||c||0!==e||f;f=c;d=b(a,g,0);e=a.length;return h};this.beginShadows=function(){g=!0;b(null)};this.endShadows=function(){g=!1;a()};this.setState=function(c,h,k,t,l,u){if(!f||null===c||0===c.length||g&&!k)g?b(null):a();else{k=g?0:e;var p=4*k,q=l.clippingState||null;m.value=q;q=b(c,t,p,u);for(c=0;c!==p;++c)q[c]=d[c];l.clippingState=q;this.numIntersection=h?this.numPlanes:0;this.numPlanes+=k}}}function eg(a){var b={};return{get:function(c){if(void 0!==b[c])return b[c];switch(c){case "WEBGL_depth_texture":var d=
a.getExtension("WEBGL_depth_texture")||a.getExtension("MOZ_WEBGL_depth_texture")||a.getExtension("WEBKIT_WEBGL_depth_texture");break;case "EXT_texture_filter_anisotropic":d=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case "WEBGL_compressed_texture_s3tc":d=a.getExtension("WEBGL_compressed_texture_s3tc")||a.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");
break;case "WEBGL_compressed_texture_pvrtc":d=a.getExtension("WEBGL_compressed_texture_pvrtc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:d=a.getExtension(c)}null===d&&console.warn("THREE.WebGLRenderer: "+c+" extension not supported.");return b[c]=d}}}function fg(a,b,c){function d(a){var g=a.target;a=e[g.id];null!==a.index&&b.remove(a.index);for(var k in a.attributes)b.remove(a.attributes[k]);g.removeEventListener("dispose",d);delete e[g.id];if(k=f[a.id])b.remove(k),delete f[a.id];
c.memory.geometries--}var e={},f={};return{get:function(a,b){var f=e[b.id];if(f)return f;b.addEventListener("dispose",d);b.isBufferGeometry?f=b:b.isGeometry&&(void 0===b._bufferGeometry&&(b._bufferGeometry=(new z).setFromObject(a)),f=b._bufferGeometry);e[b.id]=f;c.memory.geometries++;return f},update:function(a){var c=a.index,d=a.attributes;null!==c&&b.update(c,34963);for(var e in d)b.update(d[e],34962);a=a.morphAttributes;for(e in a){c=a[e];d=0;for(var f=c.length;d<f;d++)b.update(c[d],34962)}},getWireframeAttribute:function(a){var c=
f[a.id];if(c)return c;c=[];var d=a.index,e=a.attributes;if(null!==d){d=d.array;e=0;for(var g=d.length;e<g;e+=3){var q=d[e+0],v=d[e+1],l=d[e+2];c.push(q,v,v,l,l,q)}}else for(d=e.position.array,e=0,g=d.length/3-1;e<g;e+=3)q=e+0,v=e+1,l=e+2,c.push(q,v,v,l,l,q);c=new (65535<Re(c)?tb:sb)(c,1);b.update(c,34963);return f[a.id]=c}}}function gg(a,b,c,d){var e,f,g;this.setMode=function(a){e=a};this.setIndex=function(a){f=a.type;g=a.bytesPerElement};this.render=function(b,d){a.drawElements(e,d,f,b*g);c.update(d,
e)};this.renderInstances=function(h,k,m){if(d.isWebGL2)var p=a;else if(p=b.get("ANGLE_instanced_arrays"),null===p){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}p[d.isWebGL2?"drawElementsInstanced":"drawElementsInstancedANGLE"](e,m,f,k*g,h.maxInstancedCount);c.update(m,e,h.maxInstancedCount)}}function hg(a){var b={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,
textures:0},render:b,programs:null,autoReset:!0,reset:function(){b.frame++;b.calls=0;b.triangles=0;b.points=0;b.lines=0},update:function(a,d,e){e=e||1;b.calls++;switch(d){case 4:b.triangles+=a/3*e;break;case 5:case 6:b.triangles+=e*(a-2);break;case 1:b.lines+=a/2*e;break;case 3:b.lines+=e*(a-1);break;case 2:b.lines+=e*a;break;case 0:b.points+=e*a;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",d)}}}}function ig(a,b){return Math.abs(b[1])-Math.abs(a[1])}function jg(a){var b={},c=
new Float32Array(8);return{update:function(d,e,f,g){var h=d.morphTargetInfluences,k=h.length;d=b[e.id];if(void 0===d){d=[];for(var m=0;m<k;m++)d[m]=[m,0];b[e.id]=d}var p=f.morphTargets&&e.morphAttributes.position;f=f.morphNormals&&e.morphAttributes.normal;for(m=0;m<k;m++){var q=d[m];0!==q[1]&&(p&&e.removeAttribute("morphTarget"+m),f&&e.removeAttribute("morphNormal"+m))}for(m=0;m<k;m++)q=d[m],q[0]=m,q[1]=h[m];d.sort(ig);for(m=0;8>m;m++){if(q=d[m])if(h=q[0],k=q[1]){p&&e.addAttribute("morphTarget"+m,
p[h]);f&&e.addAttribute("morphNormal"+m,f[h]);c[m]=k;continue}c[m]=0}g.getUniforms().setValue(a,"morphTargetInfluences",c)}}}function kg(a,b){var c={};return{update:function(d){var e=b.render.frame,f=d.geometry,g=a.get(d,f);c[g.id]!==e&&(f.isGeometry&&g.updateFromObject(d),a.update(g),c[g.id]=e);return g},dispose:function(){c={}}}}function bb(a,b,c,d,e,f,g,h,k,m){a=void 0!==a?a:[];W.call(this,a,void 0!==b?b:301,c,d,e,f,void 0!==g?g:1022,h,k,m);this.flipY=!1}function Sb(a,b,c,d){W.call(this,null);
this.image={data:a,width:b,height:c,depth:d};this.minFilter=this.magFilter=1003;this.wrapR=1001;this.flipY=this.generateMipmaps=!1}function Tb(a,b,c,d){W.call(this,null);this.image={data:a,width:b,height:c,depth:d};this.minFilter=this.magFilter=1003;this.wrapR=1001;this.flipY=this.generateMipmaps=!1}function Ub(a,b,c){var d=a[0];if(0>=d||0<d)return a;var e=b*c,f=Te[e];void 0===f&&(f=new Float32Array(e),Te[e]=f);if(0!==b)for(d.toArray(f,0),d=1,e=0;d!==b;++d)e+=c,a[d].toArray(f,e);return f}function U(a,
b){if(a.length!==b.length)return!1;for(var c=0,d=a.length;c<d;c++)if(a[c]!==b[c])return!1;return!0}function sa(a,b){for(var c=0,d=b.length;c<d;c++)a[c]=b[c]}function Ue(a,b){var c=Ve[b];void 0===c&&(c=new Int32Array(b),Ve[b]=c);for(var d=0;d!==b;++d)c[d]=a.allocateTextureUnit();return c}function lg(a,b){var c=this.cache;c[0]!==b&&(a.uniform1f(this.addr,b),c[0]=b)}function mg(a,b){var c=this.cache;c[0]!==b&&(a.uniform1i(this.addr,b),c[0]=b)}function ng(a,b){var c=this.cache;if(void 0!==b.x){if(c[0]!==
b.x||c[1]!==b.y)a.uniform2f(this.addr,b.x,b.y),c[0]=b.x,c[1]=b.y}else U(c,b)||(a.uniform2fv(this.addr,b),sa(c,b))}function og(a,b){var c=this.cache;if(void 0!==b.x){if(c[0]!==b.x||c[1]!==b.y||c[2]!==b.z)a.uniform3f(this.addr,b.x,b.y,b.z),c[0]=b.x,c[1]=b.y,c[2]=b.z}else if(void 0!==b.r){if(c[0]!==b.r||c[1]!==b.g||c[2]!==b.b)a.uniform3f(this.addr,b.r,b.g,b.b),c[0]=b.r,c[1]=b.g,c[2]=b.b}else U(c,b)||(a.uniform3fv(this.addr,b),sa(c,b))}function pg(a,b){var c=this.cache;if(void 0!==b.x){if(c[0]!==b.x||
c[1]!==b.y||c[2]!==b.z||c[3]!==b.w)a.uniform4f(this.addr,b.x,b.y,b.z,b.w),c[0]=b.x,c[1]=b.y,c[2]=b.z,c[3]=b.w}else U(c,b)||(a.uniform4fv(this.addr,b),sa(c,b))}function qg(a,b){var c=this.cache,d=b.elements;void 0===d?U(c,b)||(a.uniformMatrix2fv(this.addr,!1,b),sa(c,b)):U(c,d)||(We.set(d),a.uniformMatrix2fv(this.addr,!1,We),sa(c,d))}function rg(a,b){var c=this.cache,d=b.elements;void 0===d?U(c,b)||(a.uniformMatrix3fv(this.addr,!1,b),sa(c,b)):U(c,d)||(Xe.set(d),a.uniformMatrix3fv(this.addr,!1,Xe),sa(c,
d))}function sg(a,b){var c=this.cache,d=b.elements;void 0===d?U(c,b)||(a.uniformMatrix4fv(this.addr,!1,b),sa(c,b)):U(c,d)||(Ye.set(d),a.uniformMatrix4fv(this.addr,!1,Ye),sa(c,d))}function tg(a,b,c){var d=this.cache,e=c.allocateTextureUnit();d[0]!==e&&(a.uniform1i(this.addr,e),d[0]=e);c.safeSetTexture2D(b||Ze,e)}function ug(a,b,c){var d=this.cache,e=c.allocateTextureUnit();d[0]!==e&&(a.uniform1i(this.addr,e),d[0]=e);c.setTexture2DArray(b||vg,e)}function wg(a,b,c){var d=this.cache,e=c.allocateTextureUnit();
d[0]!==e&&(a.uniform1i(this.addr,e),d[0]=e);c.setTexture3D(b||xg,e)}function yg(a,b,c){var d=this.cache,e=c.allocateTextureUnit();d[0]!==e&&(a.uniform1i(this.addr,e),d[0]=e);c.safeSetTextureCube(b||$e,e)}function af(a,b){var c=this.cache;U(c,b)||(a.uniform2iv(this.addr,b),sa(c,b))}function bf(a,b){var c=this.cache;U(c,b)||(a.uniform3iv(this.addr,b),sa(c,b))}function cf(a,b){var c=this.cache;U(c,b)||(a.uniform4iv(this.addr,b),sa(c,b))}function zg(a){switch(a){case 5126:return lg;case 35664:return ng;
case 35665:return og;case 35666:return pg;case 35674:return qg;case 35675:return rg;case 35676:return sg;case 35678:case 36198:return tg;case 35679:return wg;case 35680:return yg;case 36289:return ug;case 5124:case 35670:return mg;case 35667:case 35671:return af;case 35668:case 35672:return bf;case 35669:case 35673:return cf}}function Ag(a,b){var c=this.cache;U(c,b)||(a.uniform1fv(this.addr,b),sa(c,b))}function Bg(a,b){var c=this.cache;U(c,b)||(a.uniform1iv(this.addr,b),sa(c,b))}function Cg(a,b){var c=
this.cache;b=Ub(b,this.size,2);U(c,b)||(a.uniform2fv(this.addr,b),this.updateCache(b))}function Dg(a,b){var c=this.cache;b=Ub(b,this.size,3);U(c,b)||(a.uniform3fv(this.addr,b),this.updateCache(b))}function Eg(a,b){var c=this.cache;b=Ub(b,this.size,4);U(c,b)||(a.uniform4fv(this.addr,b),this.updateCache(b))}function Fg(a,b){var c=this.cache;b=Ub(b,this.size,4);U(c,b)||(a.uniformMatrix2fv(this.addr,!1,b),this.updateCache(b))}function Gg(a,b){var c=this.cache;b=Ub(b,this.size,9);U(c,b)||(a.uniformMatrix3fv(this.addr,
!1,b),this.updateCache(b))}function Hg(a,b){var c=this.cache;b=Ub(b,this.size,16);U(c,b)||(a.uniformMatrix4fv(this.addr,!1,b),this.updateCache(b))}function Ig(a,b,c){var d=this.cache,e=b.length,f=Ue(c,e);!1===U(d,f)&&(a.uniform1iv(this.addr,f),sa(d,f));for(a=0;a!==e;++a)c.safeSetTexture2D(b[a]||Ze,f[a])}function Jg(a,b,c){var d=this.cache,e=b.length,f=Ue(c,e);!1===U(d,f)&&(a.uniform1iv(this.addr,f),sa(d,f));for(a=0;a!==e;++a)c.safeSetTextureCube(b[a]||$e,f[a])}function Kg(a){switch(a){case 5126:return Ag;
case 35664:return Cg;case 35665:return Dg;case 35666:return Eg;case 35674:return Fg;case 35675:return Gg;case 35676:return Hg;case 35678:return Ig;case 35680:return Jg;case 5124:case 35670:return Bg;case 35667:case 35671:return af;case 35668:case 35672:return bf;case 35669:case 35673:return cf}}function Lg(a,b,c){this.id=a;this.addr=c;this.cache=[];this.setValue=zg(b.type)}function df(a,b,c){this.id=a;this.addr=c;this.cache=[];this.size=b.size;this.setValue=Kg(b.type)}function ef(a){this.id=a;this.seq=
[];this.map={}}function hb(a,b){this.seq=[];this.map={};for(var c=a.getProgramParameter(b,35718),d=0;d<c;++d){var e=a.getActiveUniform(b,d),f=a.getUniformLocation(b,e.name),g=this,h=e.name,k=h.length;for(de.lastIndex=0;;){var m=de.exec(h),p=de.lastIndex,q=m[1],v=m[3];"]"===m[2]&&(q|=0);if(void 0===v||"["===v&&p+2===k){h=g;e=void 0===v?new Lg(q,e,f):new df(q,e,f);h.seq.push(e);h.map[e.id]=e;break}else v=g.map[q],void 0===v&&(v=new ef(q),q=g,g=v,q.seq.push(g),q.map[g.id]=g),g=v}}}function Mg(a){a=a.split("\n");
for(var b=0;b<a.length;b++)a[b]=b+1+": "+a[b];return a.join("\n")}function ff(a,b,c){var d=a.createShader(b);a.shaderSource(d,c);a.compileShader(d);!1===a.getShaderParameter(d,35713)&&console.error("THREE.WebGLShader: Shader couldn't compile.");""!==a.getShaderInfoLog(d)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",35633===b?"vertex":"fragment",a.getShaderInfoLog(d),Mg(c));return d}function gf(a){switch(a){case 3E3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE",
"( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw Error("unsupported encoding: "+a);}}function xd(a,b){b=gf(b);return"vec4 "+a+"( vec4 value ) { return "+b[0]+"ToLinear"+b[1]+"; }"}function Ng(a,b){b=gf(b);return"vec4 "+a+"( vec4 value ) { return LinearTo"+b[0]+b[1]+"; }"}function Og(a,b){switch(b){case 1:b="Linear";break;case 2:b="Reinhard";
break;case 3:b="Uncharted2";break;case 4:b="OptimizedCineon";break;case 5:b="ACESFilmic";break;default:throw Error("unsupported toneMapping: "+b);}return"vec3 "+a+"( vec3 color ) { return "+b+"ToneMapping( color ); }"}function Pg(a,b,c){a=a||{};return[a.derivatives||b.envMapCubeUV||b.bumpMap||b.normalMap&&!b.objectSpaceNormalMap||b.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(a.fragDepth||b.logarithmicDepthBuffer)&&c.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":
"",a.drawBuffers&&c.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(a.shaderTextureLOD||b.envMap)&&c.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Ec).join("\n")}function Qg(a){var b=[],c;for(c in a){var d=a[c];!1!==d&&b.push("#define "+c+" "+d)}return b.join("\n")}function Ec(a){return""!==a}function hf(a,b){return a.replace(/NUM_DIR_LIGHTS/g,b.numDirLights).replace(/NUM_SPOT_LIGHTS/g,b.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,
b.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,b.numPointLights).replace(/NUM_HEMI_LIGHTS/g,b.numHemiLights)}function jf(a,b){return a.replace(/NUM_CLIPPING_PLANES/g,b.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,b.numClippingPlanes-b.numClipIntersection)}function ee(a){return a.replace(/^[ \t]*#include +<([\w\d./]+)>/gm,function(a,c){a=T[c];if(void 0===a)throw Error("Can not resolve #include <"+c+">");return ee(a)})}function kf(a){return a.replace(/#pragma unroll_loop[\s]+?for \( int i = (\d+); i < (\d+); i \+\+ \) \{([\s\S]+?)(?=\})\}/g,
function(a,c,d,e){a="";for(c=parseInt(c);c<parseInt(d);c++)a+=e.replace(/\[ i \]/g,"[ "+c+" ]");return a})}function Rg(a,b,c,d,e,f,g,h){var k=a.context,m=d.defines,p=e.vertexShader,q=e.fragmentShader,v="SHADOWMAP_TYPE_BASIC";1===f.shadowMapType?v="SHADOWMAP_TYPE_PCF":2===f.shadowMapType&&(v="SHADOWMAP_TYPE_PCF_SOFT");var l="ENVMAP_TYPE_CUBE",r="ENVMAP_MODE_REFLECTION",u="ENVMAP_BLENDING_MULTIPLY";if(f.envMap){switch(d.envMap.mapping){case 301:case 302:l="ENVMAP_TYPE_CUBE";break;case 306:case 307:l=
"ENVMAP_TYPE_CUBE_UV";break;case 303:case 304:l="ENVMAP_TYPE_EQUIREC";break;case 305:l="ENVMAP_TYPE_SPHERE"}switch(d.envMap.mapping){case 302:case 304:r="ENVMAP_MODE_REFRACTION"}switch(d.combine){case 0:u="ENVMAP_BLENDING_MULTIPLY";break;case 1:u="ENVMAP_BLENDING_MIX";break;case 2:u="ENVMAP_BLENDING_ADD"}}a=0<a.gammaFactor?a.gammaFactor:1;var x=g.isWebGL2?"":Pg(d.extensions,f,b),n=Qg(m),w=k.createProgram();d.isRawShaderMaterial?(m=[n].filter(Ec).join("\n"),0<m.length&&(m+="\n"),b=[x,n].filter(Ec).join("\n"),
0<b.length&&(b+="\n")):(m=["precision "+f.precision+" float;","precision "+f.precision+" int;","#define SHADER_NAME "+e.name,n,f.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+a,"#define MAX_BONES "+f.maxBones,f.useFog&&f.fog?"#define USE_FOG":"",f.useFog&&f.fogExp?"#define FOG_EXP2":"",f.map?"#define USE_MAP":"",f.envMap?"#define USE_ENVMAP":"",f.envMap?"#define "+r:"",f.lightMap?"#define USE_LIGHTMAP":"",f.aoMap?"#define USE_AOMAP":"",f.emissiveMap?"#define USE_EMISSIVEMAP":
"",f.bumpMap?"#define USE_BUMPMAP":"",f.normalMap?"#define USE_NORMALMAP":"",f.normalMap&&f.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",f.displacementMap&&f.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",f.specularMap?"#define USE_SPECULARMAP":"",f.roughnessMap?"#define USE_ROUGHNESSMAP":"",f.metalnessMap?"#define USE_METALNESSMAP":"",f.alphaMap?"#define USE_ALPHAMAP":"",f.vertexTangents?"#define USE_TANGENT":"",f.vertexColors?"#define USE_COLOR":"",f.flatShading?"#define FLAT_SHADED":
"",f.skinning?"#define USE_SKINNING":"",f.useVertexTexture?"#define BONE_TEXTURE":"",f.morphTargets?"#define USE_MORPHTARGETS":"",f.morphNormals&&!1===f.flatShading?"#define USE_MORPHNORMALS":"",f.doubleSided?"#define DOUBLE_SIDED":"",f.flipSided?"#define FLIP_SIDED":"",f.shadowMapEnabled?"#define USE_SHADOWMAP":"",f.shadowMapEnabled?"#define "+v:"",f.sizeAttenuation?"#define USE_SIZEATTENUATION":"",f.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",f.logarithmicDepthBuffer&&(g.isWebGL2||b.get("EXT_frag_depth"))?
"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;",
"\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Ec).join("\n"),b=[x,"precision "+
f.precision+" float;","precision "+f.precision+" int;","#define SHADER_NAME "+e.name,n,f.alphaTest?"#define ALPHATEST "+f.alphaTest+(f.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+a,f.useFog&&f.fog?"#define USE_FOG":"",f.useFog&&f.fogExp?"#define FOG_EXP2":"",f.map?"#define USE_MAP":"",f.matcap?"#define USE_MATCAP":"",f.envMap?"#define USE_ENVMAP":"",f.envMap?"#define "+l:"",f.envMap?"#define "+r:"",f.envMap?"#define "+u:"",f.lightMap?"#define USE_LIGHTMAP":"",f.aoMap?"#define USE_AOMAP":"",f.emissiveMap?
"#define USE_EMISSIVEMAP":"",f.bumpMap?"#define USE_BUMPMAP":"",f.normalMap?"#define USE_NORMALMAP":"",f.normalMap&&f.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",f.specularMap?"#define USE_SPECULARMAP":"",f.roughnessMap?"#define USE_ROUGHNESSMAP":"",f.metalnessMap?"#define USE_METALNESSMAP":"",f.alphaMap?"#define USE_ALPHAMAP":"",f.vertexTangents?"#define USE_TANGENT":"",f.vertexColors?"#define USE_COLOR":"",f.gradientMap?"#define USE_GRADIENTMAP":"",f.flatShading?"#define FLAT_SHADED":
"",f.doubleSided?"#define DOUBLE_SIDED":"",f.flipSided?"#define FLIP_SIDED":"",f.shadowMapEnabled?"#define USE_SHADOWMAP":"",f.shadowMapEnabled?"#define "+v:"",f.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",f.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",f.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",f.logarithmicDepthBuffer&&(g.isWebGL2||b.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"",f.envMap&&(g.isWebGL2||b.get("EXT_shader_texture_lod"))?"#define TEXTURE_LOD_EXT":
"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",0!==f.toneMapping?"#define TONE_MAPPING":"",0!==f.toneMapping?T.tonemapping_pars_fragment:"",0!==f.toneMapping?Og("toneMapping",f.toneMapping):"",f.dithering?"#define DITHERING":"",f.outputEncoding||f.mapEncoding||f.matcapEncoding||f.envMapEncoding||f.emissiveMapEncoding?T.encodings_pars_fragment:"",f.mapEncoding?xd("mapTexelToLinear",f.mapEncoding):"",f.matcapEncoding?xd("matcapTexelToLinear",f.matcapEncoding):"",f.envMapEncoding?xd("envMapTexelToLinear",
f.envMapEncoding):"",f.emissiveMapEncoding?xd("emissiveMapTexelToLinear",f.emissiveMapEncoding):"",f.outputEncoding?Ng("linearToOutputTexel",f.outputEncoding):"",f.depthPacking?"#define DEPTH_PACKING "+d.depthPacking:"","\n"].filter(Ec).join("\n"));p=ee(p);p=hf(p,f);p=jf(p,f);q=ee(q);q=hf(q,f);q=jf(q,f);p=kf(p);q=kf(q);g.isWebGL2&&!d.isRawShaderMaterial&&(g=!1,v=/^\s*#version\s+300\s+es\s*\n/,d.isShaderMaterial&&null!==p.match(v)&&null!==q.match(v)&&(g=!0,p=p.replace(v,""),q=q.replace(v,"")),m="#version 300 es\n\n#define attribute in\n#define varying out\n#define texture2D texture\n"+
m,b=["#version 300 es\n\n#define varying in",g?"":"out highp vec4 pc_fragColor;",g?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth\n#define texture2D texture\n#define textureCube texture\n#define texture2DProj textureProj\n#define texture2DLodEXT textureLod\n#define texture2DProjLodEXT textureProjLod\n#define textureCubeLodEXT textureLod\n#define texture2DGradEXT textureGrad\n#define texture2DProjGradEXT textureProjGrad\n#define textureCubeGradEXT textureGrad"].join("\n")+
"\n"+b);q=b+q;p=ff(k,35633,m+p);q=ff(k,35632,q);k.attachShader(w,p);k.attachShader(w,q);void 0!==d.index0AttributeName?k.bindAttribLocation(w,0,d.index0AttributeName):!0===f.morphTargets&&k.bindAttribLocation(w,0,"position");k.linkProgram(w);f=k.getProgramInfoLog(w).trim();g=k.getShaderInfoLog(p).trim();v=k.getShaderInfoLog(q).trim();r=l=!0;if(!1===k.getProgramParameter(w,35714))l=!1,console.error("THREE.WebGLProgram: shader error: ",k.getError(),"35715",k.getProgramParameter(w,35715),"gl.getProgramInfoLog",
f,g,v);else if(""!==f)console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",f);else if(""===g||""===v)r=!1;r&&(this.diagnostics={runnable:l,material:d,programLog:f,vertexShader:{log:g,prefix:m},fragmentShader:{log:v,prefix:b}});k.deleteShader(p);k.deleteShader(q);var y;this.getUniforms=function(){void 0===y&&(y=new hb(k,w,h));return y};var D;this.getAttributes=function(){if(void 0===D){for(var a={},b=k.getProgramParameter(w,35721),c=0;c<b;c++){var d=k.getActiveAttrib(w,c).name;a[d]=k.getAttribLocation(w,
d)}D=a}return D};this.destroy=function(){k.deleteProgram(w);this.program=void 0};Object.defineProperties(this,{uniforms:{get:function(){console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms().");return this.getUniforms()}},attributes:{get:function(){console.warn("THREE.WebGLProgram: .attributes is now .getAttributes().");return this.getAttributes()}}});this.name=e.name;this.id=Sg++;this.code=c;this.usedTimes=1;this.program=w;this.vertexShader=p;this.fragmentShader=q;return this}function Tg(a,
b,c,d){function e(a,b){if(a)a.isTexture?c=a.encoding:a.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),c=a.texture.encoding);else var c=3E3;3E3===c&&b&&(c=3007);return c}var f=[],g={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",
MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},h="precision supportsVertexTextures map mapEncoding matcap matcapEncoding envMap envMapMode envMapEncoding lightMap aoMap emissiveMap emissiveMapEncoding bumpMap normalMap objectSpaceNormalMap displacementMap specularMap roughnessMap metalnessMap gradientMap alphaMap combine vertexColors vertexTangents fog useFog fogExp flatShading sizeAttenuation logarithmicDepthBuffer skinning maxBones useVertexTexture morphTargets morphNormals maxMorphTargets maxMorphNormals premultipliedAlpha numDirLights numPointLights numSpotLights numHemiLights numRectAreaLights shadowMapEnabled shadowMapType toneMapping physicallyCorrectLights alphaTest doubleSided flipSided numClippingPlanes numClipIntersection depthPacking dithering".split(" ");
this.getParameters=function(b,d,f,h,v,l,r){var k=g[b.type];if(r.isSkinnedMesh){var m=r.skeleton.bones;if(c.floatVertexTextures)m=1024;else{var p=Math.min(Math.floor((c.maxVertexUniforms-20)/4),m.length);p<m.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+m.length+" bones. This GPU supports "+p+"."),m=0):m=p}}else m=0;p=c.precision;null!==b.precision&&(p=c.getMaxPrecision(b.precision),p!==b.precision&&console.warn("THREE.WebGLProgram.getParameters:",b.precision,"not supported, using",p,"instead."));
var q=a.getRenderTarget();return{shaderID:k,precision:p,supportsVertexTextures:c.vertexTextures,outputEncoding:e(q?q.texture:null,a.gammaOutput),map:!!b.map,mapEncoding:e(b.map,a.gammaInput),matcap:!!b.matcap,matcapEncoding:e(b.matcap,a.gammaInput),envMap:!!b.envMap,envMapMode:b.envMap&&b.envMap.mapping,envMapEncoding:e(b.envMap,a.gammaInput),envMapCubeUV:!!b.envMap&&(306===b.envMap.mapping||307===b.envMap.mapping),lightMap:!!b.lightMap,aoMap:!!b.aoMap,emissiveMap:!!b.emissiveMap,emissiveMapEncoding:e(b.emissiveMap,
a.gammaInput),bumpMap:!!b.bumpMap,normalMap:!!b.normalMap,objectSpaceNormalMap:1===b.normalMapType,displacementMap:!!b.displacementMap,roughnessMap:!!b.roughnessMap,metalnessMap:!!b.metalnessMap,specularMap:!!b.specularMap,alphaMap:!!b.alphaMap,gradientMap:!!b.gradientMap,combine:b.combine,vertexTangents:b.normalMap&&b.vertexTangents,vertexColors:b.vertexColors,fog:!!h,useFog:b.fog,fogExp:h&&h.isFogExp2,flatShading:b.flatShading,sizeAttenuation:b.sizeAttenuation,logarithmicDepthBuffer:c.logarithmicDepthBuffer,
skinning:b.skinning&&0<m,maxBones:m,useVertexTexture:c.floatVertexTextures,morphTargets:b.morphTargets,morphNormals:b.morphNormals,maxMorphTargets:a.maxMorphTargets,maxMorphNormals:a.maxMorphNormals,numDirLights:d.directional.length,numPointLights:d.point.length,numSpotLights:d.spot.length,numRectAreaLights:d.rectArea.length,numHemiLights:d.hemi.length,numClippingPlanes:v,numClipIntersection:l,dithering:b.dithering,shadowMapEnabled:a.shadowMap.enabled&&r.receiveShadow&&0<f.length,shadowMapType:a.shadowMap.type,
toneMapping:a.toneMapping,physicallyCorrectLights:a.physicallyCorrectLights,premultipliedAlpha:b.premultipliedAlpha,alphaTest:b.alphaTest,doubleSided:2===b.side,flipSided:1===b.side,depthPacking:void 0!==b.depthPacking?b.depthPacking:!1}};this.getProgramCode=function(b,c){var d=[];c.shaderID?d.push(c.shaderID):(d.push(b.fragmentShader),d.push(b.vertexShader));if(void 0!==b.defines)for(var e in b.defines)d.push(e),d.push(b.defines[e]);for(e=0;e<h.length;e++)d.push(c[h[e]]);d.push(b.onBeforeCompile.toString());
d.push(a.gammaOutput);d.push(a.gammaFactor);return d.join()};this.acquireProgram=function(e,g,h,q){for(var k,m=0,p=f.length;m<p;m++){var l=f[m];if(l.code===q){k=l;++k.usedTimes;break}}void 0===k&&(k=new Rg(a,b,q,e,g,h,c,d),f.push(k));return k};this.releaseProgram=function(a){if(0===--a.usedTimes){var b=f.indexOf(a);f[b]=f[f.length-1];f.pop();a.destroy()}};this.programs=f}function Ug(){var a=new WeakMap;return{get:function(b){var c=a.get(b);void 0===c&&(c={},a.set(b,c));return c},remove:function(b){a.delete(b)},
update:function(b,c,d){a.get(b)[c]=d},dispose:function(){a=new WeakMap}}}function Vg(a,b){return a.groupOrder!==b.groupOrder?a.groupOrder-b.groupOrder:a.renderOrder!==b.renderOrder?a.renderOrder-b.renderOrder:a.program!==b.program?a.program.id-b.program.id:a.material.id!==b.material.id?a.material.id-b.material.id:a.z!==b.z?a.z-b.z:a.id-b.id}function Wg(a,b){return a.groupOrder!==b.groupOrder?a.groupOrder-b.groupOrder:a.renderOrder!==b.renderOrder?a.renderOrder-b.renderOrder:a.z!==b.z?b.z-a.z:a.id-
b.id}function lf(){function a(a,d,e,m,p,q){var g=b[c];void 0===g?(g={id:a.id,object:a,geometry:d,material:e,program:e.program||f,groupOrder:m,renderOrder:a.renderOrder,z:p,group:q},b[c]=g):(g.id=a.id,g.object=a,g.geometry=d,g.material=e,g.program=e.program||f,g.groupOrder=m,g.renderOrder=a.renderOrder,g.z=p,g.group=q);c++;return g}var b=[],c=0,d=[],e=[],f={id:-1};return{opaque:d,transparent:e,init:function(){c=0;d.length=0;e.length=0},push:function(b,c,f,m,p,q){b=a(b,c,f,m,p,q);(!0===f.transparent?
e:d).push(b)},unshift:function(b,c,f,m,p,q){b=a(b,c,f,m,p,q);(!0===f.transparent?e:d).unshift(b)},sort:function(){1<d.length&&d.sort(Vg);1<e.length&&e.sort(Wg)}}}function Xg(){function a(c){c=c.target;c.removeEventListener("dispose",a);delete b[c.id]}var b={};return{get:function(c,d){var e=b[c.id];if(void 0===e){var f=new lf;b[c.id]={};b[c.id][d.id]=f;c.addEventListener("dispose",a)}else f=e[d.id],void 0===f&&(f=new lf,e[d.id]=f);return f},dispose:function(){b={}}}}function Yg(){var a={};return{get:function(b){if(void 0!==
a[b.id])return a[b.id];switch(b.type){case "DirectionalLight":var c={direction:new n,color:new M,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new B};break;case "SpotLight":c={position:new n,direction:new n,color:new M,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new B};break;case "PointLight":c={position:new n,color:new M,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new B,shadowCameraNear:1,shadowCameraFar:1E3};break;
case "HemisphereLight":c={direction:new n,skyColor:new M,groundColor:new M};break;case "RectAreaLight":c={color:new M,position:new n,halfWidth:new n,halfHeight:new n}}return a[b.id]=c}}}function Zg(){var a=new Yg,b={id:$g++,hash:{stateID:-1,directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,shadowsLength:-1},ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],
pointShadowMatrix:[],hemi:[]},c=new n,d=new P,e=new P;return{setup:function(f,g,h){var k=0,m=0,p=0,q=0,v=0,l=0,r=0,u=0;h=h.matrixWorldInverse;for(var n=0,A=f.length;n<A;n++){var w=f[n],y=w.color,D=w.intensity,J=w.distance,ua=w.shadow&&w.shadow.map?w.shadow.map.texture:null;if(w.isAmbientLight)k+=y.r*D,m+=y.g*D,p+=y.b*D;else if(w.isDirectionalLight){var F=a.get(w);F.color.copy(w.color).multiplyScalar(w.intensity);F.direction.setFromMatrixPosition(w.matrixWorld);c.setFromMatrixPosition(w.target.matrixWorld);
F.direction.sub(c);F.direction.transformDirection(h);if(F.shadow=w.castShadow)y=w.shadow,F.shadowBias=y.bias,F.shadowRadius=y.radius,F.shadowMapSize=y.mapSize;b.directionalShadowMap[q]=ua;b.directionalShadowMatrix[q]=w.shadow.matrix;b.directional[q]=F;q++}else if(w.isSpotLight){F=a.get(w);F.position.setFromMatrixPosition(w.matrixWorld);F.position.applyMatrix4(h);F.color.copy(y).multiplyScalar(D);F.distance=J;F.direction.setFromMatrixPosition(w.matrixWorld);c.setFromMatrixPosition(w.target.matrixWorld);
F.direction.sub(c);F.direction.transformDirection(h);F.coneCos=Math.cos(w.angle);F.penumbraCos=Math.cos(w.angle*(1-w.penumbra));F.decay=w.decay;if(F.shadow=w.castShadow)y=w.shadow,F.shadowBias=y.bias,F.shadowRadius=y.radius,F.shadowMapSize=y.mapSize;b.spotShadowMap[l]=ua;b.spotShadowMatrix[l]=w.shadow.matrix;b.spot[l]=F;l++}else if(w.isRectAreaLight)F=a.get(w),F.color.copy(y).multiplyScalar(D),F.position.setFromMatrixPosition(w.matrixWorld),F.position.applyMatrix4(h),e.identity(),d.copy(w.matrixWorld),
d.premultiply(h),e.extractRotation(d),F.halfWidth.set(.5*w.width,0,0),F.halfHeight.set(0,.5*w.height,0),F.halfWidth.applyMatrix4(e),F.halfHeight.applyMatrix4(e),b.rectArea[r]=F,r++;else if(w.isPointLight){F=a.get(w);F.position.setFromMatrixPosition(w.matrixWorld);F.position.applyMatrix4(h);F.color.copy(w.color).multiplyScalar(w.intensity);F.distance=w.distance;F.decay=w.decay;if(F.shadow=w.castShadow)y=w.shadow,F.shadowBias=y.bias,F.shadowRadius=y.radius,F.shadowMapSize=y.mapSize,F.shadowCameraNear=
y.camera.near,F.shadowCameraFar=y.camera.far;b.pointShadowMap[v]=ua;b.pointShadowMatrix[v]=w.shadow.matrix;b.point[v]=F;v++}else w.isHemisphereLight&&(F=a.get(w),F.direction.setFromMatrixPosition(w.matrixWorld),F.direction.transformDirection(h),F.direction.normalize(),F.skyColor.copy(w.color).multiplyScalar(D),F.groundColor.copy(w.groundColor).multiplyScalar(D),b.hemi[u]=F,u++)}b.ambient[0]=k;b.ambient[1]=m;b.ambient[2]=p;b.directional.length=q;b.spot.length=l;b.rectArea.length=r;b.point.length=v;
b.hemi.length=u;b.hash.stateID=b.id;b.hash.directionalLength=q;b.hash.pointLength=v;b.hash.spotLength=l;b.hash.rectAreaLength=r;b.hash.hemiLength=u;b.hash.shadowsLength=g.length},state:b}}function mf(){var a=new Zg,b=[],c=[];return{init:function(){b.length=0;c.length=0},state:{lightsArray:b,shadowsArray:c,lights:a},setupLights:function(d){a.setup(b,c,d)},pushLight:function(a){b.push(a)},pushShadow:function(a){c.push(a)}}}function ah(){function a(c){c=c.target;c.removeEventListener("dispose",a);delete b[c.id]}
var b={};return{get:function(c,d){if(void 0===b[c.id]){var e=new mf;b[c.id]={};b[c.id][d.id]=e;c.addEventListener("dispose",a)}else void 0===b[c.id][d.id]?(e=new mf,b[c.id][d.id]=e):e=b[c.id][d.id];return e},dispose:function(){b={}}}}function ib(a){O.call(this);this.type="MeshDepthMaterial";this.depthPacking=3200;this.morphTargets=this.skinning=!1;this.displacementMap=this.alphaMap=this.map=null;this.displacementScale=1;this.displacementBias=0;this.wireframe=!1;this.wireframeLinewidth=1;this.lights=
this.fog=!1;this.setValues(a)}function jb(a){O.call(this);this.type="MeshDistanceMaterial";this.referencePosition=new n;this.nearDistance=1;this.farDistance=1E3;this.morphTargets=this.skinning=!1;this.displacementMap=this.alphaMap=this.map=null;this.displacementScale=1;this.displacementBias=0;this.lights=this.fog=!1;this.setValues(a)}function nf(a,b,c){function d(b,c,d,e,f,g){var h=b.geometry;var k=q;var m=b.customDepthMaterial;d&&(k=v,m=b.customDistanceMaterial);m?k=m:(m=!1,c.morphTargets&&(h&&h.isBufferGeometry?
m=h.morphAttributes&&h.morphAttributes.position&&0<h.morphAttributes.position.length:h&&h.isGeometry&&(m=h.morphTargets&&0<h.morphTargets.length)),b.isSkinnedMesh&&!1===c.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",b),b=b.isSkinnedMesh&&c.skinning,h=0,m&&(h|=1),b&&(h|=2),k=k[h]);a.localClippingEnabled&&!0===c.clipShadows&&0!==c.clippingPlanes.length&&(h=k.uuid,m=c.uuid,b=l[h],void 0===b&&(b={},l[h]=b),h=b[m],void 0===h&&(h=k.clone(),b[m]=h),
k=h);k.visible=c.visible;k.wireframe=c.wireframe;k.side=null!=c.shadowSide?c.shadowSide:r[c.side];k.clipShadows=c.clipShadows;k.clippingPlanes=c.clippingPlanes;k.clipIntersection=c.clipIntersection;k.wireframeLinewidth=c.wireframeLinewidth;k.linewidth=c.linewidth;d&&k.isMeshDistanceMaterial&&(k.referencePosition.copy(e),k.nearDistance=f,k.farDistance=g);return k}function e(c,g,h,k){if(!1!==c.visible){if(c.layers.test(g.layers)&&(c.isMesh||c.isLine||c.isPoints)&&c.castShadow&&(!c.frustumCulled||f.intersectsObject(c))){c.modelViewMatrix.multiplyMatrices(h.matrixWorldInverse,
c.matrixWorld);var m=b.update(c),q=c.material;if(Array.isArray(q))for(var v=m.groups,l=0,t=v.length;l<t;l++){var r=v[l],u=q[r.materialIndex];u&&u.visible&&(u=d(c,u,k,p,h.near,h.far),a.renderBufferDirect(h,null,m,u,c,r))}else q.visible&&(u=d(c,q,k,p,h.near,h.far),a.renderBufferDirect(h,null,m,u,c,null))}c=c.children;m=0;for(q=c.length;m<q;m++)e(c[m],g,h,k)}}var f=new vd,g=new P,h=new B,k=new B(c,c),m=new n,p=new n,q=Array(4),v=Array(4),l={},r={0:1,1:0,2:2},u=[new n(1,0,0),new n(-1,0,0),new n(0,0,1),
new n(0,0,-1),new n(0,1,0),new n(0,-1,0)],x=[new n(0,1,0),new n(0,1,0),new n(0,1,0),new n(0,1,0),new n(0,0,1),new n(0,0,-1)],A=[new Y,new Y,new Y,new Y,new Y,new Y];for(c=0;4!==c;++c){var w=0!==(c&1),y=0!==(c&2),D=new ib({depthPacking:3201,morphTargets:w,skinning:y});q[c]=D;w=new jb({morphTargets:w,skinning:y});v[c]=w}var J=this;this.enabled=!1;this.autoUpdate=!0;this.needsUpdate=!1;this.type=1;this.render=function(b,c,d){if(!1!==J.enabled&&(!1!==J.autoUpdate||!1!==J.needsUpdate)&&0!==b.length){var q=
a.getRenderTarget(),v=a.state;v.setBlending(0);v.buffers.color.setClear(1,1,1,1);v.buffers.depth.setTest(!0);v.setScissorTest(!1);for(var l,t=0,r=b.length;t<r;t++){var n=b[t];l=n.shadow;var X=n&&n.isPointLight;if(void 0===l)console.warn("THREE.WebGLShadowMap:",n,"has no shadow.");else{var Q=l.camera;h.copy(l.mapSize);h.min(k);if(X){var w=h.x,y=h.y;A[0].set(2*w,y,w,y);A[1].set(0,y,w,y);A[2].set(3*w,y,w,y);A[3].set(w,y,w,y);A[4].set(3*w,0,w,y);A[5].set(w,0,w,y);h.x*=4;h.y*=2}null===l.map&&(l.map=new Ta(h.x,
h.y,{minFilter:1003,magFilter:1003,format:1023}),l.map.texture.name=n.name+".shadowMap",Q.updateProjectionMatrix());l.isSpotLightShadow&&l.update(n);w=l.map;y=l.matrix;p.setFromMatrixPosition(n.matrixWorld);Q.position.copy(p);X?(l=6,y.makeTranslation(-p.x,-p.y,-p.z)):(l=1,m.setFromMatrixPosition(n.target.matrixWorld),Q.lookAt(m),Q.updateMatrixWorld(),y.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),y.multiply(Q.projectionMatrix),y.multiply(Q.matrixWorldInverse));a.setRenderTarget(w);a.clear();for(n=0;n<
l;n++)X&&(m.copy(Q.position),m.add(u[n]),Q.up.copy(x[n]),Q.lookAt(m),Q.updateMatrixWorld(),v.viewport(A[n])),g.multiplyMatrices(Q.projectionMatrix,Q.matrixWorldInverse),f.setFromMatrix(g),e(c,d,Q,X)}}J.needsUpdate=!1;a.setRenderTarget(q)}}}function bh(a,b,c,d){function e(b,c,d){var e=new Uint8Array(4),f=a.createTexture();a.bindTexture(b,f);a.texParameteri(b,10241,9728);a.texParameteri(b,10240,9728);for(b=0;b<d;b++)a.texImage2D(c+b,0,6408,1,1,0,6408,5121,e);return f}function f(c,e){A[c]=1;0===w[c]&&
(a.enableVertexAttribArray(c),w[c]=1);y[c]!==e&&((d.isWebGL2?a:b.get("ANGLE_instanced_arrays"))[d.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](c,e),y[c]=e)}function g(b){!0!==D[b]&&(a.enable(b),D[b]=!0)}function h(b){!1!==D[b]&&(a.disable(b),D[b]=!1)}function k(b,d,e,f,k,m,p,q){if(0===b)F&&(h(3042),F=!1);else if(F||(g(3042),F=!0),5!==b){if(b!==B||q!==X){if(100!==wd||100!==C)a.blendEquation(32774),C=wd=100;if(q)switch(b){case 1:a.blendFuncSeparate(1,771,1,771);break;case 2:a.blendFunc(1,
1);break;case 3:a.blendFuncSeparate(0,0,769,771);break;case 4:a.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",b)}else switch(b){case 1:a.blendFuncSeparate(770,771,1,771);break;case 2:a.blendFunc(770,1);break;case 3:a.blendFunc(0,769);break;case 4:a.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",b)}G=z=fa=E=null;B=b;X=q}}else{k=k||d;m=m||e;p=p||f;if(d!==wd||k!==C)a.blendEquationSeparate(c.convert(d),c.convert(k)),
wd=d,C=k;if(e!==E||f!==fa||m!==z||p!==G)a.blendFuncSeparate(c.convert(e),c.convert(f),c.convert(m),c.convert(p)),E=e,fa=f,z=m,G=p;B=b;X=null}}function m(b){Q!==b&&(b?a.frontFace(2304):a.frontFace(2305),Q=b)}function p(b){0!==b?(g(2884),b!==ce&&(1===b?a.cullFace(1029):2===b?a.cullFace(1028):a.cullFace(1032))):h(2884);ce=b}function q(b,c,d){if(b){if(g(32823),Se!==c||of!==d)a.polygonOffset(c,d),Se=c,of=d}else h(32823)}function v(b){void 0===b&&(b=33984+M-1);P!==b&&(a.activeTexture(b),P=b)}var l=new function(){var b=
!1,c=new Y,d=null,e=new Y(0,0,0,0);return{setMask:function(c){d===c||b||(a.colorMask(c,c,c,c),d=c)},setLocked:function(a){b=a},setClear:function(b,d,f,g,h){!0===h&&(b*=g,d*=g,f*=g);c.set(b,d,f,g);!1===e.equals(c)&&(a.clearColor(b,d,f,g),e.copy(c))},reset:function(){b=!1;d=null;e.set(-1,0,0,0)}}},r=new function(){var b=!1,c=null,d=null,e=null;return{setTest:function(a){a?g(2929):h(2929)},setMask:function(d){c===d||b||(a.depthMask(d),c=d)},setFunc:function(b){if(d!==b){if(b)switch(b){case 0:a.depthFunc(512);
break;case 1:a.depthFunc(519);break;case 2:a.depthFunc(513);break;case 3:a.depthFunc(515);break;case 4:a.depthFunc(514);break;case 5:a.depthFunc(518);break;case 6:a.depthFunc(516);break;case 7:a.depthFunc(517);break;default:a.depthFunc(515)}else a.depthFunc(515);d=b}},setLocked:function(a){b=a},setClear:function(b){e!==b&&(a.clearDepth(b),e=b)},reset:function(){b=!1;e=d=c=null}}},u=new function(){var b=!1,c=null,d=null,e=null,f=null,k=null,m=null,p=null,q=null;return{setTest:function(a){a?g(2960):
h(2960)},setMask:function(d){c===d||b||(a.stencilMask(d),c=d)},setFunc:function(b,c,g){if(d!==b||e!==c||f!==g)a.stencilFunc(b,c,g),d=b,e=c,f=g},setOp:function(b,c,d){if(k!==b||m!==c||p!==d)a.stencilOp(b,c,d),k=b,m=c,p=d},setLocked:function(a){b=a},setClear:function(b){q!==b&&(a.clearStencil(b),q=b)},reset:function(){b=!1;q=p=m=k=f=e=d=c=null}}},n=a.getParameter(34921),A=new Uint8Array(n),w=new Uint8Array(n),y=new Uint8Array(n),D={},J=null,ua=null,F=null,B=null,wd=null,E=null,fa=null,C=null,z=null,
G=null,X=!1,Q=null,ce=null,da=null,Se=null,of=null,M=a.getParameter(35661),I=!1;n=0;n=a.getParameter(7938);-1!==n.indexOf("WebGL")?(n=parseFloat(/^WebGL ([0-9])/.exec(n)[1]),I=1<=n):-1!==n.indexOf("OpenGL ES")&&(n=parseFloat(/^OpenGL ES ([0-9])/.exec(n)[1]),I=2<=n);var P=null,Ea={},N=new Y,H=new Y,K={};K[3553]=e(3553,3553,1);K[34067]=e(34067,34069,6);l.setClear(0,0,0,1);r.setClear(1);u.setClear(0);g(2929);r.setFunc(3);m(!1);p(1);g(2884);k(0);return{buffers:{color:l,depth:r,stencil:u},initAttributes:function(){for(var a=
0,b=A.length;a<b;a++)A[a]=0},enableAttribute:function(a){f(a,0)},enableAttributeAndDivisor:f,disableUnusedAttributes:function(){for(var b=0,c=w.length;b!==c;++b)w[b]!==A[b]&&(a.disableVertexAttribArray(b),w[b]=0)},enable:g,disable:h,getCompressedTextureFormats:function(){if(null===J&&(J=[],b.get("WEBGL_compressed_texture_pvrtc")||b.get("WEBGL_compressed_texture_s3tc")||b.get("WEBGL_compressed_texture_etc1")||b.get("WEBGL_compressed_texture_astc")))for(var c=a.getParameter(34467),d=0;d<c.length;d++)J.push(c[d]);
return J},useProgram:function(b){return ua!==b?(a.useProgram(b),ua=b,!0):!1},setBlending:k,setMaterial:function(a,b){2===a.side?h(2884):g(2884);var c=1===a.side;b&&(c=!c);m(c);1===a.blending&&!1===a.transparent?k(0):k(a.blending,a.blendEquation,a.blendSrc,a.blendDst,a.blendEquationAlpha,a.blendSrcAlpha,a.blendDstAlpha,a.premultipliedAlpha);r.setFunc(a.depthFunc);r.setTest(a.depthTest);r.setMask(a.depthWrite);l.setMask(a.colorWrite);q(a.polygonOffset,a.polygonOffsetFactor,a.polygonOffsetUnits)},setFlipSided:m,
setCullFace:p,setLineWidth:function(b){b!==da&&(I&&a.lineWidth(b),da=b)},setPolygonOffset:q,setScissorTest:function(a){a?g(3089):h(3089)},activeTexture:v,bindTexture:function(b,c){null===P&&v();var d=Ea[P];void 0===d&&(d={type:void 0,texture:void 0},Ea[P]=d);if(d.type!==b||d.texture!==c)a.bindTexture(b,c||K[b]),d.type=b,d.texture=c},compressedTexImage2D:function(){try{a.compressedTexImage2D.apply(a,arguments)}catch(Ha){console.error("THREE.WebGLState:",Ha)}},texImage2D:function(){try{a.texImage2D.apply(a,
arguments)}catch(Ha){console.error("THREE.WebGLState:",Ha)}},texImage3D:function(){try{a.texImage3D.apply(a,arguments)}catch(Ha){console.error("THREE.WebGLState:",Ha)}},scissor:function(b){!1===N.equals(b)&&(a.scissor(b.x,b.y,b.z,b.w),N.copy(b))},viewport:function(b){!1===H.equals(b)&&(a.viewport(b.x,b.y,b.z,b.w),H.copy(b))},reset:function(){for(var b=0;b<w.length;b++)1===w[b]&&(a.disableVertexAttribArray(b),w[b]=0);D={};P=J=null;Ea={};ce=Q=B=ua=null;l.reset();r.reset();u.reset()}}}function ch(a,
b,c,d,e,f,g){function h(a,b){return fa?new OffscreenCanvas(a,b):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function k(a,b,c,d){var e=1;if(a.width>d||a.height>d)e=d/Math.max(a.width,a.height);if(1>e||!0===b){if("undefined"!==typeof HTMLImageElement&&a instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&a instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&a instanceof ImageBitmap)return d=b?K.floorPowerOfTwo:Math.floor,b=d(e*a.width),e=d(e*a.height),
void 0===C&&(C=h(b,e)),c=c?h(b,e):C,c.width=b,c.height=e,c.getContext("2d").drawImage(a,0,0,b,e),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+a.width+"x"+a.height+") to ("+b+"x"+e+")."),c;"data"in a&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+a.width+"x"+a.height+").")}return a}function m(a){return K.isPowerOfTwo(a.width)&&K.isPowerOfTwo(a.height)}function p(a,b){return a.generateMipmaps&&b&&1003!==a.minFilter&&1006!==a.minFilter}function q(b,c,e,
f){a.generateMipmap(b);d.get(c).__maxMipLevel=Math.log(Math.max(e,f))*Math.LOG2E}function v(a,c){if(!e.isWebGL2)return a;var d=a;6403===a&&(5126===c&&(d=33326),5131===c&&(d=33325),5121===c&&(d=33321));6407===a&&(5126===c&&(d=34837),5131===c&&(d=34843),5121===c&&(d=32849));6408===a&&(5126===c&&(d=34836),5131===c&&(d=34842),5121===c&&(d=32856));33325===d||33326===d||34842===d||34836===d?b.get("EXT_color_buffer_float"):(34843===d||34837===d)&&console.warn("THREE.WebGLRenderer: Floating point textures with RGB format not supported. Please use RGBA instead.");
return d}function l(a){return 1003===a||1004===a||1005===a?9728:9729}function r(b){b=b.target;b.removeEventListener("dispose",r);var c=d.get(b);void 0!==c.__webglInit&&(a.deleteTexture(c.__webglTexture),d.remove(b));b.isVideoTexture&&delete E[b.id];g.memory.textures--}function u(b){b=b.target;b.removeEventListener("dispose",u);var c=d.get(b),e=d.get(b.texture);if(b){void 0!==e.__webglTexture&&a.deleteTexture(e.__webglTexture);b.depthTexture&&b.depthTexture.dispose();if(b.isWebGLRenderTargetCube)for(e=
0;6>e;e++)a.deleteFramebuffer(c.__webglFramebuffer[e]),c.__webglDepthbuffer&&a.deleteRenderbuffer(c.__webglDepthbuffer[e]);else a.deleteFramebuffer(c.__webglFramebuffer),c.__webglDepthbuffer&&a.deleteRenderbuffer(c.__webglDepthbuffer);d.remove(b.texture);d.remove(b)}g.memory.textures--}function n(a,b){var e=d.get(a);if(a.isVideoTexture){var f=a.id,h=g.render.frame;E[f]!==h&&(E[f]=h,a.update())}if(0<a.version&&e.__version!==a.version)if(f=a.image,void 0===f)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");
else if(!1===f.complete)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{J(e,a,b);return}c.activeTexture(33984+b);c.bindTexture(3553,e.__webglTexture)}function A(b,g){var h=d.get(b);if(6===b.image.length)if(0<b.version&&h.__version!==b.version){D(h,b);c.activeTexture(33984+g);c.bindTexture(34067,h.__webglTexture);a.pixelStorei(37440,b.flipY);g=b&&b.isCompressedTexture;for(var l=b.image[0]&&b.image[0].isDataTexture,t=[],r=0;6>r;r++)t[r]=g||l?l?b.image[r].image:
b.image[r]:k(b.image[r],!1,!0,e.maxCubemapSize);var u=t[0],n=m(u)||e.isWebGL2,x=f.convert(b.format),w=f.convert(b.type),Q=v(x,w);y(34067,b,n);for(r=0;6>r;r++)if(g)for(var X,J=t[r].mipmaps,A=0,F=J.length;A<F;A++)X=J[A],1023!==b.format&&1022!==b.format?-1<c.getCompressedTextureFormats().indexOf(x)?c.compressedTexImage2D(34069+r,A,Q,X.width,X.height,0,X.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):c.texImage2D(34069+r,A,Q,X.width,
X.height,0,x,w,X.data);else l?c.texImage2D(34069+r,0,Q,t[r].width,t[r].height,0,x,w,t[r].data):c.texImage2D(34069+r,0,Q,x,w,t[r]);h.__maxMipLevel=g?J.length-1:0;p(b,n)&&q(34067,b,u.width,u.height);h.__version=b.version;if(b.onUpdate)b.onUpdate(b)}else c.activeTexture(33984+g),c.bindTexture(34067,h.__webglTexture)}function w(a,b){c.activeTexture(33984+b);c.bindTexture(34067,d.get(a).__webglTexture)}function y(c,g,h){h?(a.texParameteri(c,10242,f.convert(g.wrapS)),a.texParameteri(c,10243,f.convert(g.wrapT)),
32879!==c&&35866!==c||a.texParameteri(c,32882,f.convert(g.wrapR)),a.texParameteri(c,10240,f.convert(g.magFilter)),a.texParameteri(c,10241,f.convert(g.minFilter))):(a.texParameteri(c,10242,33071),a.texParameteri(c,10243,33071),32879!==c&&35866!==c||a.texParameteri(c,32882,33071),1001===g.wrapS&&1001===g.wrapT||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),a.texParameteri(c,10240,l(g.magFilter)),a.texParameteri(c,
10241,l(g.minFilter)),1003!==g.minFilter&&1006!==g.minFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));!(h=b.get("EXT_texture_filter_anisotropic"))||1015===g.type&&null===b.get("OES_texture_float_linear")||1016===g.type&&null===(e.isWebGL2||b.get("OES_texture_half_float_linear"))||!(1<g.anisotropy||d.get(g).__currentAnisotropy)||(a.texParameterf(c,h.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(g.anisotropy,
e.getMaxAnisotropy())),d.get(g).__currentAnisotropy=g.anisotropy)}function D(b,c){void 0===b.__webglInit&&(b.__webglInit=!0,c.addEventListener("dispose",r),b.__webglTexture=a.createTexture(),g.memory.textures++)}function J(b,d,g){var h=3553;d.isDataTexture2DArray&&(h=35866);d.isDataTexture3D&&(h=32879);D(b,d);c.activeTexture(33984+g);c.bindTexture(h,b.__webglTexture);a.pixelStorei(37440,d.flipY);a.pixelStorei(37441,d.premultiplyAlpha);a.pixelStorei(3317,d.unpackAlignment);g=e.isWebGL2?!1:1001!==d.wrapS||
1001!==d.wrapT||1003!==d.minFilter&&1006!==d.minFilter;g=g&&!1===m(d.image);g=k(d.image,g,!1,e.maxTextureSize);var l=m(g)||e.isWebGL2,r=f.convert(d.format),t=f.convert(d.type),u=v(r,t);y(h,d,l);var n=d.mipmaps;if(d.isDepthTexture){u=6402;if(1015===d.type){if(!e.isWebGL2)throw Error("Float Depth Texture only supported in WebGL2.0");u=36012}else e.isWebGL2&&(u=33189);1026===d.format&&6402===u&&1012!==d.type&&1014!==d.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),
d.type=1012,t=f.convert(d.type));1027===d.format&&(u=34041,1020!==d.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),d.type=1020,t=f.convert(d.type)));c.texImage2D(3553,0,u,g.width,g.height,0,r,t,null)}else if(d.isDataTexture)if(0<n.length&&l){for(var x=0,w=n.length;x<w;x++)h=n[x],c.texImage2D(3553,x,u,h.width,h.height,0,r,t,h.data);d.generateMipmaps=!1;b.__maxMipLevel=n.length-1}else c.texImage2D(3553,0,u,g.width,g.height,0,r,t,g.data),b.__maxMipLevel=
0;else if(d.isCompressedTexture){x=0;for(w=n.length;x<w;x++)h=n[x],1023!==d.format&&1022!==d.format?-1<c.getCompressedTextureFormats().indexOf(r)?c.compressedTexImage2D(3553,x,u,h.width,h.height,0,h.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):c.texImage2D(3553,x,u,h.width,h.height,0,r,t,h.data);b.__maxMipLevel=n.length-1}else if(d.isDataTexture2DArray)c.texImage3D(35866,0,u,g.width,g.height,g.depth,0,r,t,g.data),b.__maxMipLevel=
0;else if(d.isDataTexture3D)c.texImage3D(32879,0,u,g.width,g.height,g.depth,0,r,t,g.data),b.__maxMipLevel=0;else if(0<n.length&&l){x=0;for(w=n.length;x<w;x++)h=n[x],c.texImage2D(3553,x,u,r,t,h);d.generateMipmaps=!1;b.__maxMipLevel=n.length-1}else c.texImage2D(3553,0,u,r,t,g),b.__maxMipLevel=0;p(d,l)&&q(3553,d,g.width,g.height);b.__version=d.version;if(d.onUpdate)d.onUpdate(d)}function ua(b,e,g,h){var k=f.convert(e.texture.format),m=f.convert(e.texture.type),p=v(k,m);c.texImage2D(h,0,p,e.width,e.height,
0,k,m,null);a.bindFramebuffer(36160,b);a.framebufferTexture2D(36160,g,h,d.get(e.texture).__webglTexture,0);a.bindFramebuffer(36160,null)}function F(b,c,d){a.bindRenderbuffer(36161,b);if(c.depthBuffer&&!c.stencilBuffer)d?(d=B(c),a.renderbufferStorageMultisample(36161,d,33189,c.width,c.height)):a.renderbufferStorage(36161,33189,c.width,c.height),a.framebufferRenderbuffer(36160,36096,36161,b);else if(c.depthBuffer&&c.stencilBuffer)d?(d=B(c),a.renderbufferStorageMultisample(36161,d,34041,c.width,c.height)):
a.renderbufferStorage(36161,34041,c.width,c.height),a.framebufferRenderbuffer(36160,33306,36161,b);else{b=f.convert(c.texture.format);var e=f.convert(c.texture.type);b=v(b,e);d?(d=B(c),a.renderbufferStorageMultisample(36161,d,b,c.width,c.height)):a.renderbufferStorage(36161,b,c.width,c.height)}a.bindRenderbuffer(36161,null)}function B(a){return e.isWebGL2&&a.isWebGLMultisampleRenderTarget?Math.min(e.maxSamples,a.samples):0}var E={},C,fa="undefined"!==typeof OffscreenCanvas,z=0,G=!1,I=!1;this.allocateTextureUnit=
function(){var a=z;a>=e.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+a+" texture units while this GPU supports only "+e.maxTextures);z+=1;return a};this.resetTextureUnits=function(){z=0};this.setTexture2D=n;this.setTexture2DArray=function(a,b){var e=d.get(a);0<a.version&&e.__version!==a.version?J(e,a,b):(c.activeTexture(33984+b),c.bindTexture(35866,e.__webglTexture))};this.setTexture3D=function(a,b){var e=d.get(a);0<a.version&&e.__version!==a.version?J(e,a,b):(c.activeTexture(33984+
b),c.bindTexture(32879,e.__webglTexture))};this.setTextureCube=A;this.setTextureCubeDynamic=w;this.setupRenderTarget=function(b){var h=d.get(b),k=d.get(b.texture);b.addEventListener("dispose",u);k.__webglTexture=a.createTexture();g.memory.textures++;var l=!0===b.isWebGLRenderTargetCube,r=!0===b.isWebGLMultisampleRenderTarget,t=m(b)||e.isWebGL2;if(l)for(h.__webglFramebuffer=[],r=0;6>r;r++)h.__webglFramebuffer[r]=a.createFramebuffer();else if(h.__webglFramebuffer=a.createFramebuffer(),r)if(e.isWebGL2){h.__webglMultisampledFramebuffer=
a.createFramebuffer();h.__webglColorRenderbuffer=a.createRenderbuffer();a.bindRenderbuffer(36161,h.__webglColorRenderbuffer);r=f.convert(b.texture.format);var x=f.convert(b.texture.type);r=v(r,x);x=B(b);a.renderbufferStorageMultisample(36161,x,r,b.width,b.height);a.bindFramebuffer(36160,h.__webglMultisampledFramebuffer);a.framebufferRenderbuffer(36160,36064,36161,h.__webglColorRenderbuffer);a.bindRenderbuffer(36161,null);b.depthBuffer&&(h.__webglDepthRenderbuffer=a.createRenderbuffer(),F(h.__webglDepthRenderbuffer,
b,!0));a.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(l){c.bindTexture(34067,k.__webglTexture);y(34067,b.texture,t);for(r=0;6>r;r++)ua(h.__webglFramebuffer[r],b,36064,34069+r);p(b.texture,t)&&q(34067,b.texture,b.width,b.height);c.bindTexture(34067,null)}else c.bindTexture(3553,k.__webglTexture),y(3553,b.texture,t),ua(h.__webglFramebuffer,b,36064,3553),p(b.texture,t)&&q(3553,b.texture,b.width,b.height),c.bindTexture(3553,
null);if(b.depthBuffer){h=d.get(b);k=!0===b.isWebGLRenderTargetCube;if(b.depthTexture){if(k)throw Error("target.depthTexture not supported in Cube render targets");if(b&&b.isWebGLRenderTargetCube)throw Error("Depth Texture with cube render targets is not supported");a.bindFramebuffer(36160,h.__webglFramebuffer);if(!b.depthTexture||!b.depthTexture.isDepthTexture)throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");d.get(b.depthTexture).__webglTexture&&b.depthTexture.image.width===
b.width&&b.depthTexture.image.height===b.height||(b.depthTexture.image.width=b.width,b.depthTexture.image.height=b.height,b.depthTexture.needsUpdate=!0);n(b.depthTexture,0);h=d.get(b.depthTexture).__webglTexture;if(1026===b.depthTexture.format)a.framebufferTexture2D(36160,36096,3553,h,0);else if(1027===b.depthTexture.format)a.framebufferTexture2D(36160,33306,3553,h,0);else throw Error("Unknown depthTexture format");}else if(k)for(h.__webglDepthbuffer=[],k=0;6>k;k++)a.bindFramebuffer(36160,h.__webglFramebuffer[k]),
h.__webglDepthbuffer[k]=a.createRenderbuffer(),F(h.__webglDepthbuffer[k],b);else a.bindFramebuffer(36160,h.__webglFramebuffer),h.__webglDepthbuffer=a.createRenderbuffer(),F(h.__webglDepthbuffer,b);a.bindFramebuffer(36160,null)}};this.updateRenderTargetMipmap=function(a){var b=a.texture,f=m(a)||e.isWebGL2;if(p(b,f)){f=a.isWebGLRenderTargetCube?34067:3553;var g=d.get(b).__webglTexture;c.bindTexture(f,g);q(f,b,a.width,a.height);c.bindTexture(f,null)}};this.updateMultisampleRenderTarget=function(b){if(b.isWebGLMultisampleRenderTarget)if(e.isWebGL2){var c=
d.get(b);a.bindFramebuffer(36008,c.__webglMultisampledFramebuffer);a.bindFramebuffer(36009,c.__webglFramebuffer);c=b.width;var f=b.height,g=16384;b.depthBuffer&&(g|=256);b.stencilBuffer&&(g|=1024);a.blitFramebuffer(0,0,c,f,0,0,c,f,g,9728)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")};this.safeSetTexture2D=function(a,b){a&&a.isWebGLRenderTarget&&(!1===G&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),
G=!0),a=a.texture);n(a,b)};this.safeSetTextureCube=function(a,b){a&&a.isWebGLRenderTargetCube&&(!1===I&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),I=!0),a=a.texture);a&&a.isCubeTexture||Array.isArray(a.image)&&6===a.image.length?A(a,b):w(a,b)}}function pf(a,b,c){return{convert:function(a){if(1E3===a)return 10497;if(1001===a)return 33071;if(1002===a)return 33648;if(1003===a)return 9728;if(1004===a)return 9984;
if(1005===a)return 9986;if(1006===a)return 9729;if(1007===a)return 9985;if(1008===a)return 9987;if(1009===a)return 5121;if(1017===a)return 32819;if(1018===a)return 32820;if(1019===a)return 33635;if(1010===a)return 5120;if(1011===a)return 5122;if(1012===a)return 5123;if(1013===a)return 5124;if(1014===a)return 5125;if(1015===a)return 5126;if(1016===a){if(c.isWebGL2)return 5131;var d=b.get("OES_texture_half_float");if(null!==d)return d.HALF_FLOAT_OES}if(1021===a)return 6406;if(1022===a)return 6407;if(1023===
a)return 6408;if(1024===a)return 6409;if(1025===a)return 6410;if(1026===a)return 6402;if(1027===a)return 34041;if(1028===a)return 6403;if(100===a)return 32774;if(101===a)return 32778;if(102===a)return 32779;if(200===a)return 0;if(201===a)return 1;if(202===a)return 768;if(203===a)return 769;if(204===a)return 770;if(205===a)return 771;if(206===a)return 772;if(207===a)return 773;if(208===a)return 774;if(209===a)return 775;if(210===a)return 776;if(33776===a||33777===a||33778===a||33779===a)if(d=b.get("WEBGL_compressed_texture_s3tc"),
null!==d){if(33776===a)return d.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===a)return d.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===a)return d.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===a)return d.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===a||35841===a||35842===a||35843===a)if(d=b.get("WEBGL_compressed_texture_pvrtc"),null!==d){if(35840===a)return d.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===a)return d.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===a)return d.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===a)return d.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===
a&&(d=b.get("WEBGL_compressed_texture_etc1"),null!==d))return d.COMPRESSED_RGB_ETC1_WEBGL;if(37808===a||37809===a||37810===a||37811===a||37812===a||37813===a||37814===a||37815===a||37816===a||37817===a||37818===a||37819===a||37820===a||37821===a)if(d=b.get("WEBGL_compressed_texture_astc"),null!==d)return a;if(103===a||104===a){if(c.isWebGL2){if(103===a)return 32775;if(104===a)return 32776}d=b.get("EXT_blend_minmax");if(null!==d){if(103===a)return d.MIN_EXT;if(104===a)return d.MAX_EXT}}if(1020===a){if(c.isWebGL2)return 34042;
d=b.get("WEBGL_depth_texture");if(null!==d)return d.UNSIGNED_INT_24_8_WEBGL}return 0}}}function Vb(){C.call(this);this.type="Group"}function Xa(){C.call(this);this.type="Camera";this.matrixWorldInverse=new P;this.projectionMatrix=new P;this.projectionMatrixInverse=new P}function ja(a,b,c,d){Xa.call(this);this.type="PerspectiveCamera";this.fov=void 0!==a?a:50;this.zoom=1;this.near=void 0!==c?c:.1;this.far=void 0!==d?d:2E3;this.focus=10;this.aspect=void 0!==b?b:1;this.view=null;this.filmGauge=35;this.filmOffset=
0;this.updateProjectionMatrix()}function Gc(a){ja.call(this);this.cameras=a||[]}function qf(a,b,c){rf.setFromMatrixPosition(b.matrixWorld);sf.setFromMatrixPosition(c.matrixWorld);var d=rf.distanceTo(sf),e=b.projectionMatrix.elements,f=c.projectionMatrix.elements,g=e[14]/(e[10]-1);c=e[14]/(e[10]+1);var h=(e[9]+1)/e[5],k=(e[9]-1)/e[5],m=(e[8]-1)/e[0],p=(f[8]+1)/f[0];e=g*m;f=g*p;p=d/(-m+p);m=p*-m;b.matrixWorld.decompose(a.position,a.quaternion,a.scale);a.translateX(m);a.translateZ(p);a.matrixWorld.compose(a.position,
a.quaternion,a.scale);a.matrixWorldInverse.getInverse(a.matrixWorld);b=g+p;g=c+p;a.projectionMatrix.makePerspective(e-m,f+(d-m),h*c/g*b,k*c/g*b,b,g)}function tf(a){function b(){return null!==e&&!0===e.isPresenting}function c(){if(b()){var c=e.getEyeParameters("left"),f=c.renderWidth*p;c=c.renderHeight*p;y=a.getPixelRatio();a.getSize(w);a.setDrawingBufferSize(2*f,c,1);J.start()}else d.enabled&&a.setDrawingBufferSize(w.width,w.height,y),J.stop()}var d=this,e=null,f=null,g=null,h=[],k=new P,m=new P,
p=1,q="stage";"undefined"!==typeof window&&"VRFrameData"in window&&(f=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",c,!1));var v=new P,l=new aa,r=new n,u=new ja;u.bounds=new Y(0,0,.5,1);u.layers.enable(1);var x=new ja;x.bounds=new Y(.5,0,.5,1);x.layers.enable(2);var A=new Gc([u,x]);A.layers.enable(1);A.layers.enable(2);var w=new B,y,D=[];this.enabled=!1;this.getController=function(a){var b=h[a];void 0===b&&(b=new Vb,b.matrixAutoUpdate=!1,b.visible=!1,h[a]=b);return b};this.getDevice=
function(){return e};this.setDevice=function(a){void 0!==a&&(e=a);J.setContext(a)};this.setFramebufferScaleFactor=function(a){p=a};this.setFrameOfReferenceType=function(a){q=a};this.setPoseTarget=function(a){void 0!==a&&(g=a)};this.getCamera=function(a){var c="stage"===q?1.6:0;if(!1===b())return a.position.set(0,c,0),a.rotation.set(0,0,0),a;e.depthNear=a.near;e.depthFar=a.far;e.getFrameData(f);if("stage"===q){var d=e.stageParameters;d?k.fromArray(d.sittingToStandingTransform):k.makeTranslation(0,
c,0)}c=f.pose;d=null!==g?g:a;d.matrix.copy(k);d.matrix.decompose(d.position,d.quaternion,d.scale);null!==c.orientation&&(l.fromArray(c.orientation),d.quaternion.multiply(l));null!==c.position&&(l.setFromRotationMatrix(k),r.fromArray(c.position),r.applyQuaternion(l),d.position.add(r));d.updateMatrixWorld();u.near=a.near;x.near=a.near;u.far=a.far;x.far=a.far;u.matrixWorldInverse.fromArray(f.leftViewMatrix);x.matrixWorldInverse.fromArray(f.rightViewMatrix);m.getInverse(k);"stage"===q&&(u.matrixWorldInverse.multiply(m),
x.matrixWorldInverse.multiply(m));a=d.parent;null!==a&&(v.getInverse(a.matrixWorld),u.matrixWorldInverse.multiply(v),x.matrixWorldInverse.multiply(v));u.matrixWorld.getInverse(u.matrixWorldInverse);x.matrixWorld.getInverse(x.matrixWorldInverse);u.projectionMatrix.fromArray(f.leftProjectionMatrix);x.projectionMatrix.fromArray(f.rightProjectionMatrix);qf(A,u,x);a=e.getLayers();a.length&&(a=a[0],null!==a.leftBounds&&4===a.leftBounds.length&&u.bounds.fromArray(a.leftBounds),null!==a.rightBounds&&4===
a.rightBounds.length&&x.bounds.fromArray(a.rightBounds));a:for(a=0;a<h.length;a++){c=h[a];b:{d=a;for(var p=navigator.getGamepads&&navigator.getGamepads(),t=0,n=0,w=p.length;t<w;t++){var y=p[t];if(y&&("Daydream Controller"===y.id||"Gear VR Controller"===y.id||"Oculus Go Controller"===y.id||"OpenVR Gamepad"===y.id||y.id.startsWith("Oculus Touch")||y.id.startsWith("Spatial Controller"))){if(n===d){d=y;break b}n++}}d=void 0}if(void 0!==d&&void 0!==d.pose){if(null===d.pose)break a;p=d.pose;!1===p.hasPosition&&
c.position.set(.2,-.6,-.05);null!==p.position&&c.position.fromArray(p.position);null!==p.orientation&&c.quaternion.fromArray(p.orientation);c.matrix.compose(c.position,c.quaternion,c.scale);c.matrix.premultiply(k);c.matrix.decompose(c.position,c.quaternion,c.scale);c.matrixWorldNeedsUpdate=!0;c.visible=!0;p="Daydream Controller"===d.id?0:1;D[a]!==d.buttons[p].pressed&&(D[a]=d.buttons[p].pressed,!0===D[a]?c.dispatchEvent({type:"selectstart"}):(c.dispatchEvent({type:"selectend"}),c.dispatchEvent({type:"select"})))}else c.visible=
!1}return A};this.getStandingMatrix=function(){return k};this.isPresenting=b;var J=new ae;this.setAnimationLoop=function(a){J.setAnimationLoop(a);b()&&J.start()};this.submitFrame=function(){b()&&e.submitFrame()};this.dispose=function(){"undefined"!==typeof window&&window.removeEventListener("vrdisplaypresentchange",c)}}function dh(a){function b(){return null!==h&&null!==m}function c(a){var b=l[t.indexOf(a.inputSource)];b&&b.dispatchEvent({type:a.type})}function d(){a.setFramebuffer(null);a.setRenderTarget(a.getRenderTarget());
w.stop()}function e(a,b){null===b?a.matrixWorld.copy(a.matrix):a.matrixWorld.multiplyMatrices(b.matrixWorld,a.matrix);a.matrixWorldInverse.getInverse(a.matrixWorld)}var f=a.context,g=null,h=null,k=1,m=null,p="stage",q=null,l=[],t=[],r=new ja;r.layers.enable(1);r.viewport=new Y;var u=new ja;u.layers.enable(2);u.viewport=new Y;var n=new Gc([r,u]);n.layers.enable(1);n.layers.enable(2);this.enabled=!1;this.getController=function(a){var b=l[a];void 0===b&&(b=new Vb,b.matrixAutoUpdate=!1,b.visible=!1,l[a]=
b);return b};this.getDevice=function(){return g};this.setDevice=function(a){void 0!==a&&(g=a);a instanceof XRDevice&&f.setCompatibleXRDevice(a)};this.setFramebufferScaleFactor=function(a){k=a};this.setFrameOfReferenceType=function(a){p=a};this.setSession=function(b){h=b;null!==h&&(h.addEventListener("select",c),h.addEventListener("selectstart",c),h.addEventListener("selectend",c),h.addEventListener("end",d),h.baseLayer=new XRWebGLLayer(h,f,{framebufferScaleFactor:k}),h.requestFrameOfReference(p).then(function(b){m=
b;a.setFramebuffer(h.baseLayer.framebuffer);w.setContext(h);w.start()}),t=h.getInputSources(),h.addEventListener("inputsourceschange",function(){t=h.getInputSources();console.log(t);for(var a=0;a<l.length;a++)l[a].userData.inputSource=t[a]}))};this.getCamera=function(a){if(b()){var c=a.parent,d=n.cameras;e(n,c);for(var f=0;f<d.length;f++)e(d[f],c);a.matrixWorld.copy(n.matrixWorld);a=a.children;f=0;for(c=a.length;f<c;f++)a[f].updateMatrixWorld(!0);qf(n,r,u);return n}return a};this.isPresenting=b;var A=
null,w=new ae;w.setAnimationLoop(function(a,b){q=b.getDevicePose(m);if(null!==q)for(var c=h.baseLayer,d=b.views,e=0;e<d.length;e++){var f=d[e],g=c.getViewport(f),k=q.getViewMatrix(f),p=n.cameras[e];p.matrix.fromArray(k).getInverse(p.matrix);p.projectionMatrix.fromArray(f.projectionMatrix);p.viewport.set(g.x,g.y,g.width,g.height);0===e&&n.matrix.copy(p.matrix)}for(e=0;e<l.length;e++){c=l[e];if(d=t[e])if(d=b.getInputPose(d,m),null!==d){"targetRay"in d?c.matrix.elements=d.targetRay.transformMatrix:"pointerMatrix"in
d&&(c.matrix.elements=d.pointerMatrix);c.matrix.decompose(c.position,c.rotation,c.scale);c.visible=!0;continue}c.visible=!1}A&&A(a)});this.setAnimationLoop=function(a){A=a};this.dispose=function(){};this.getStandingMatrix=function(){console.warn("THREE.WebXRManager: getStandingMatrix() is no longer needed.");return new P};this.submitFrame=function(){}}function ge(a){var b;function c(){na=new eg(L);Aa=new cg(L,na,a);Aa.isWebGL2||(na.get("WEBGL_depth_texture"),na.get("OES_texture_float"),na.get("OES_texture_half_float"),
na.get("OES_texture_half_float_linear"),na.get("OES_standard_derivatives"),na.get("OES_element_index_uint"),na.get("ANGLE_instanced_arrays"));na.get("OES_texture_float_linear");ia=new pf(L,na,Aa);ca=new bh(L,na,ia,Aa);ca.scissor(W.copy(Ha).multiplyScalar(H));ca.viewport(R.copy(Z).multiplyScalar(H));lb=new hg(L);Ba=new Ug;ba=new ch(L,na,ca,Ba,Aa,ia,lb);pa=new Vf(L);sa=new fg(L,pa,lb);oa=new kg(sa,lb);va=new jg(L);la=new Tg(fa,na,Aa,ba);ra=new Xg;qa=new ah;ma=new ag(fa,ca,oa,ua);wa=new bg(L,na,lb,Aa);
ya=new gg(L,na,lb,Aa);lb.programs=la.programs;fa.context=L;fa.capabilities=Aa;fa.extensions=na;fa.properties=Ba;fa.renderLists=ra;fa.state=ca;fa.info=lb}function d(a){a.preventDefault();console.log("THREE.WebGLRenderer: Context Lost.");I=!0}function e(){console.log("THREE.WebGLRenderer: Context Restored.");I=!1;c()}function f(a){a=a.target;a.removeEventListener("dispose",f);g(a);Ba.remove(a)}function g(a){var b=Ba.get(a).program;a.program=void 0;void 0!==b&&la.releaseProgram(b)}function h(a,b){a.render(function(a){fa.renderBufferImmediate(a,
b)})}function k(a,b,c,d){if(!1!==a.visible){if(a.layers.test(b.layers))if(a.isGroup)c=a.renderOrder;else if(a.isLight)z.pushLight(a),a.castShadow&&z.pushShadow(a);else if(a.isSprite){if(!a.frustumCulled||ja.intersectsSprite(a)){d&&kb.setFromMatrixPosition(a.matrixWorld).applyMatrix4(Fc);var e=oa.update(a),f=a.material;f.visible&&C.push(a,e,f,c,kb.z,null)}}else if(a.isImmediateRenderObject)d&&kb.setFromMatrixPosition(a.matrixWorld).applyMatrix4(Fc),C.push(a,null,a.material,c,kb.z,null);else if(a.isMesh||
a.isLine||a.isPoints)if(a.isSkinnedMesh&&a.skeleton.update(),!a.frustumCulled||ja.intersectsObject(a))if(d&&kb.setFromMatrixPosition(a.matrixWorld).applyMatrix4(Fc),e=oa.update(a),f=a.material,Array.isArray(f))for(var g=e.groups,h=0,m=g.length;h<m;h++){var p=g[h],q=f[p.materialIndex];q&&q.visible&&C.push(a,e,q,c,kb.z,p)}else f.visible&&C.push(a,e,f,c,kb.z,null);a=a.children;h=0;for(m=a.length;h<m;h++)k(a[h],b,c,d)}}function m(a,b,c,d){for(var e=0,f=a.length;e<f;e++){var g=a[e],h=g.object,k=g.geometry,
m=void 0===d?g.material:d;g=g.group;if(c.isArrayCamera){T=c;for(var q=c.cameras,l=0,v=q.length;l<v;l++){var r=q[l];if(h.layers.test(r.layers)){if("viewport"in r)ca.viewport(R.copy(r.viewport));else{var t=r.bounds;ca.viewport(R.set(t.x*Ea,t.y*U,t.z*Ea,t.w*U).multiplyScalar(H))}z.setupLights(r);p(h,b,r,k,m,g)}}}else T=null,p(h,b,c,k,m,g)}}function p(a,c,d,e,f,g){a.onBeforeRender(fa,c,d,e,f,g);z=qa.get(c,T||d);a.modelViewMatrix.multiplyMatrices(d.matrixWorldInverse,a.matrixWorld);a.normalMatrix.getNormalMatrix(a.modelViewMatrix);
if(a.isImmediateRenderObject){ca.setMaterial(f);var k=l(d,c.fog,f,a);O=b=null;da=!1;h(a,k)}else fa.renderBufferDirect(d,c.fog,e,f,a,g);a.onAfterRender(fa,c,d,e,f,g);z=qa.get(c,T||d)}function q(a,b,c){var d=Ba.get(a),e=z.state.lights,h=d.lightsHash,k=e.state.hash;c=la.getParameters(a,e.state,z.state.shadowsArray,b,aa.numPlanes,aa.numIntersection,c);var m=la.getProgramCode(a,c),p=d.program,q=!0;if(void 0===p)a.addEventListener("dispose",f);else if(p.code!==m)g(a);else{if(h.stateID!==k.stateID||h.directionalLength!==
k.directionalLength||h.pointLength!==k.pointLength||h.spotLength!==k.spotLength||h.rectAreaLength!==k.rectAreaLength||h.hemiLength!==k.hemiLength||h.shadowsLength!==k.shadowsLength)h.stateID=k.stateID,h.directionalLength=k.directionalLength,h.pointLength=k.pointLength,h.spotLength=k.spotLength,h.rectAreaLength=k.rectAreaLength,h.hemiLength=k.hemiLength,h.shadowsLength=k.shadowsLength;else if(void 0!==c.shaderID)return;q=!1}q&&(c.shaderID?(m=Wa[c.shaderID],d.shader={name:a.type,uniforms:Pb(m.uniforms),
vertexShader:m.vertexShader,fragmentShader:m.fragmentShader}):d.shader={name:a.type,uniforms:a.uniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader},a.onBeforeCompile(d.shader,fa),m=la.getProgramCode(a,c),p=la.acquireProgram(a,d.shader,c,m),d.program=p,a.program=p);c=p.getAttributes();if(a.morphTargets)for(m=a.numSupportedMorphTargets=0;m<fa.maxMorphTargets;m++)0<=c["morphTarget"+m]&&a.numSupportedMorphTargets++;if(a.morphNormals)for(m=a.numSupportedMorphNormals=0;m<fa.maxMorphNormals;m++)0<=
c["morphNormal"+m]&&a.numSupportedMorphNormals++;c=d.shader.uniforms;if(!a.isShaderMaterial&&!a.isRawShaderMaterial||!0===a.clipping)d.numClippingPlanes=aa.numPlanes,d.numIntersection=aa.numIntersection,c.clippingPlanes=aa.uniform;d.fog=b;void 0===h&&(d.lightsHash=h={});h.stateID=k.stateID;h.directionalLength=k.directionalLength;h.pointLength=k.pointLength;h.spotLength=k.spotLength;h.rectAreaLength=k.rectAreaLength;h.hemiLength=k.hemiLength;h.shadowsLength=k.shadowsLength;a.lights&&(c.ambientLightColor.value=
e.state.ambient,c.directionalLights.value=e.state.directional,c.spotLights.value=e.state.spot,c.rectAreaLights.value=e.state.rectArea,c.pointLights.value=e.state.point,c.hemisphereLights.value=e.state.hemi,c.directionalShadowMap.value=e.state.directionalShadowMap,c.directionalShadowMatrix.value=e.state.directionalShadowMatrix,c.spotShadowMap.value=e.state.spotShadowMap,c.spotShadowMatrix.value=e.state.spotShadowMatrix,c.pointShadowMap.value=e.state.pointShadowMap,c.pointShadowMatrix.value=e.state.pointShadowMatrix);
a=d.program.getUniforms();a=hb.seqWithValue(a.seq,c);d.uniformsList=a}function l(a,b,c,d){ba.resetTextureUnits();var e=Ba.get(c),f=e.lightsHash,g=z.state.lights.state.hash;ha&&(fe||a!==S)&&aa.setState(c.clippingPlanes,c.clipIntersection,c.clipShadows,a,e,a===S&&c.id===Q);!1===c.needsUpdate&&(void 0===e.program?c.needsUpdate=!0:c.fog&&e.fog!==b?c.needsUpdate=!0:!c.lights||f.stateID===g.stateID&&f.directionalLength===g.directionalLength&&f.pointLength===g.pointLength&&f.spotLength===g.spotLength&&f.rectAreaLength===
g.rectAreaLength&&f.hemiLength===g.hemiLength&&f.shadowsLength===g.shadowsLength?void 0===e.numClippingPlanes||e.numClippingPlanes===aa.numPlanes&&e.numIntersection===aa.numIntersection||(c.needsUpdate=!0):c.needsUpdate=!0);c.needsUpdate&&(q(c,b,d),c.needsUpdate=!1);var h=!1,k=!1,m=!1;f=e.program;g=f.getUniforms();var p=e.shader.uniforms;ca.useProgram(f.program)&&(m=k=h=!0);c.id!==Q&&(Q=c.id,k=!0);if(h||S!==a){g.setValue(L,"projectionMatrix",a.projectionMatrix);Aa.logarithmicDepthBuffer&&g.setValue(L,
"logDepthBufFC",2/(Math.log(a.far+1)/Math.LN2));S!==a&&(S=a,m=k=!0);if(c.isShaderMaterial||c.isMeshPhongMaterial||c.isMeshStandardMaterial||c.envMap)h=g.map.cameraPosition,void 0!==h&&h.setValue(L,kb.setFromMatrixPosition(a.matrixWorld));(c.isMeshPhongMaterial||c.isMeshLambertMaterial||c.isMeshBasicMaterial||c.isMeshStandardMaterial||c.isShaderMaterial||c.skinning)&&g.setValue(L,"viewMatrix",a.matrixWorldInverse)}if(c.skinning&&(g.setOptional(L,d,"bindMatrix"),g.setOptional(L,d,"bindMatrixInverse"),
a=d.skeleton))if(h=a.bones,Aa.floatVertexTextures){if(void 0===a.boneTexture){h=Math.sqrt(4*h.length);h=K.ceilPowerOfTwo(h);h=Math.max(h,4);var l=new Float32Array(h*h*4);l.set(a.boneMatrices);var v=new qb(l,h,h,1023,1015);v.needsUpdate=!0;a.boneMatrices=l;a.boneTexture=v;a.boneTextureSize=h}g.setValue(L,"boneTexture",a.boneTexture,ba);g.setValue(L,"boneTextureSize",a.boneTextureSize)}else g.setOptional(L,a,"boneMatrices");k&&(g.setValue(L,"toneMappingExposure",fa.toneMappingExposure),g.setValue(L,
"toneMappingWhitePoint",fa.toneMappingWhitePoint),c.lights&&(k=m,p.ambientLightColor.needsUpdate=k,p.directionalLights.needsUpdate=k,p.pointLights.needsUpdate=k,p.spotLights.needsUpdate=k,p.rectAreaLights.needsUpdate=k,p.hemisphereLights.needsUpdate=k),b&&c.fog&&(p.fogColor.value=b.color,b.isFog?(p.fogNear.value=b.near,p.fogFar.value=b.far):b.isFogExp2&&(p.fogDensity.value=b.density)),c.isMeshBasicMaterial?t(p,c):c.isMeshLambertMaterial?(t(p,c),c.emissiveMap&&(p.emissiveMap.value=c.emissiveMap)):
c.isMeshPhongMaterial?(t(p,c),c.isMeshToonMaterial?(r(p,c),c.gradientMap&&(p.gradientMap.value=c.gradientMap)):r(p,c)):c.isMeshStandardMaterial?(t(p,c),c.isMeshPhysicalMaterial?(u(p,c),p.reflectivity.value=c.reflectivity,p.clearCoat.value=c.clearCoat,p.clearCoatRoughness.value=c.clearCoatRoughness):u(p,c)):c.isMeshMatcapMaterial?(t(p,c),c.matcap&&(p.matcap.value=c.matcap),c.bumpMap&&(p.bumpMap.value=c.bumpMap,p.bumpScale.value=c.bumpScale,1===c.side&&(p.bumpScale.value*=-1)),c.normalMap&&(p.normalMap.value=
c.normalMap,p.normalScale.value.copy(c.normalScale),1===c.side&&p.normalScale.value.negate()),c.displacementMap&&(p.displacementMap.value=c.displacementMap,p.displacementScale.value=c.displacementScale,p.displacementBias.value=c.displacementBias)):c.isMeshDepthMaterial?(t(p,c),c.displacementMap&&(p.displacementMap.value=c.displacementMap,p.displacementScale.value=c.displacementScale,p.displacementBias.value=c.displacementBias)):c.isMeshDistanceMaterial?(t(p,c),c.displacementMap&&(p.displacementMap.value=
c.displacementMap,p.displacementScale.value=c.displacementScale,p.displacementBias.value=c.displacementBias),p.referencePosition.value.copy(c.referencePosition),p.nearDistance.value=c.nearDistance,p.farDistance.value=c.farDistance):c.isMeshNormalMaterial?(t(p,c),c.bumpMap&&(p.bumpMap.value=c.bumpMap,p.bumpScale.value=c.bumpScale,1===c.side&&(p.bumpScale.value*=-1)),c.normalMap&&(p.normalMap.value=c.normalMap,p.normalScale.value.copy(c.normalScale),1===c.side&&p.normalScale.value.negate()),c.displacementMap&&
(p.displacementMap.value=c.displacementMap,p.displacementScale.value=c.displacementScale,p.displacementBias.value=c.displacementBias)):c.isLineBasicMaterial?(p.diffuse.value=c.color,p.opacity.value=c.opacity,c.isLineDashedMaterial&&(p.dashSize.value=c.dashSize,p.totalSize.value=c.dashSize+c.gapSize,p.scale.value=c.scale)):c.isPointsMaterial?(p.diffuse.value=c.color,p.opacity.value=c.opacity,p.size.value=c.size*H,p.scale.value=.5*U,p.map.value=c.map,null!==c.map&&(!0===c.map.matrixAutoUpdate&&c.map.updateMatrix(),
p.uvTransform.value.copy(c.map.matrix))):c.isSpriteMaterial?(p.diffuse.value=c.color,p.opacity.value=c.opacity,p.rotation.value=c.rotation,p.map.value=c.map,null!==c.map&&(!0===c.map.matrixAutoUpdate&&c.map.updateMatrix(),p.uvTransform.value.copy(c.map.matrix))):c.isShadowMaterial&&(p.color.value=c.color,p.opacity.value=c.opacity),void 0!==p.ltc_1&&(p.ltc_1.value=G.LTC_1),void 0!==p.ltc_2&&(p.ltc_2.value=G.LTC_2),hb.upload(L,e.uniformsList,p,ba));c.isShaderMaterial&&!0===c.uniformsNeedUpdate&&(hb.upload(L,
e.uniformsList,p,ba),c.uniformsNeedUpdate=!1);c.isSpriteMaterial&&g.setValue(L,"center",d.center);g.setValue(L,"modelViewMatrix",d.modelViewMatrix);g.setValue(L,"normalMatrix",d.normalMatrix);g.setValue(L,"modelMatrix",d.matrixWorld);return f}function t(a,b){a.opacity.value=b.opacity;b.color&&(a.diffuse.value=b.color);b.emissive&&a.emissive.value.copy(b.emissive).multiplyScalar(b.emissiveIntensity);b.map&&(a.map.value=b.map);b.alphaMap&&(a.alphaMap.value=b.alphaMap);b.specularMap&&(a.specularMap.value=
b.specularMap);b.envMap&&(a.envMap.value=b.envMap,a.flipEnvMap.value=b.envMap.isCubeTexture?-1:1,a.reflectivity.value=b.reflectivity,a.refractionRatio.value=b.refractionRatio,a.maxMipLevel.value=Ba.get(b.envMap).__maxMipLevel);b.lightMap&&(a.lightMap.value=b.lightMap,a.lightMapIntensity.value=b.lightMapIntensity);b.aoMap&&(a.aoMap.value=b.aoMap,a.aoMapIntensity.value=b.aoMapIntensity);if(b.map)var c=b.map;else b.specularMap?c=b.specularMap:b.displacementMap?c=b.displacementMap:b.normalMap?c=b.normalMap:
b.bumpMap?c=b.bumpMap:b.roughnessMap?c=b.roughnessMap:b.metalnessMap?c=b.metalnessMap:b.alphaMap?c=b.alphaMap:b.emissiveMap&&(c=b.emissiveMap);void 0!==c&&(c.isWebGLRenderTarget&&(c=c.texture),!0===c.matrixAutoUpdate&&c.updateMatrix(),a.uvTransform.value.copy(c.matrix))}function r(a,b){a.specular.value=b.specular;a.shininess.value=Math.max(b.shininess,1E-4);b.emissiveMap&&(a.emissiveMap.value=b.emissiveMap);b.bumpMap&&(a.bumpMap.value=b.bumpMap,a.bumpScale.value=b.bumpScale,1===b.side&&(a.bumpScale.value*=
-1));b.normalMap&&(a.normalMap.value=b.normalMap,a.normalScale.value.copy(b.normalScale),1===b.side&&a.normalScale.value.negate());b.displacementMap&&(a.displacementMap.value=b.displacementMap,a.displacementScale.value=b.displacementScale,a.displacementBias.value=b.displacementBias)}function u(a,b){a.roughness.value=b.roughness;a.metalness.value=b.metalness;b.roughnessMap&&(a.roughnessMap.value=b.roughnessMap);b.metalnessMap&&(a.metalnessMap.value=b.metalnessMap);b.emissiveMap&&(a.emissiveMap.value=
b.emissiveMap);b.bumpMap&&(a.bumpMap.value=b.bumpMap,a.bumpScale.value=b.bumpScale,1===b.side&&(a.bumpScale.value*=-1));b.normalMap&&(a.normalMap.value=b.normalMap,a.normalScale.value.copy(b.normalScale),1===b.side&&a.normalScale.value.negate());b.displacementMap&&(a.displacementMap.value=b.displacementMap,a.displacementScale.value=b.displacementScale,a.displacementBias.value=b.displacementBias);b.envMap&&(a.envMapIntensity.value=b.envMapIntensity)}console.log("THREE.WebGLRenderer","103");a=a||{};
var x=void 0!==a.canvas?a.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),A=void 0!==a.context?a.context:null,w=void 0!==a.alpha?a.alpha:!1,y=void 0!==a.depth?a.depth:!0,D=void 0!==a.stencil?a.stencil:!0,J=void 0!==a.antialias?a.antialias:!1,ua=void 0!==a.premultipliedAlpha?a.premultipliedAlpha:!0,F=void 0!==a.preserveDrawingBuffer?a.preserveDrawingBuffer:!1,E=void 0!==a.powerPreference?a.powerPreference:"default",C=null,z=null;this.domElement=x;this.context=null;this.sortObjects=
this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0;this.clippingPlanes=[];this.localClippingEnabled=!1;this.gammaFactor=2;this.physicallyCorrectLights=this.gammaOutput=this.gammaInput=!1;this.toneMappingWhitePoint=this.toneMappingExposure=this.toneMapping=1;this.maxMorphTargets=8;this.maxMorphNormals=4;var fa=this,I=!1,M=null,N=null,X=null,Q=-1;var O=b=null;var da=!1;var S=null,T=null,R=new Y,W=new Y,V=null,Ea=x.width,U=x.height,H=1,Z=new Y(0,0,Ea,U),Ha=new Y(0,0,Ea,U),
ea=!1,ja=new vd,aa=new dg,ha=!1,fe=!1,Fc=new P,kb=new n;try{w={alpha:w,depth:y,stencil:D,antialias:J,premultipliedAlpha:ua,preserveDrawingBuffer:F,powerPreference:E};x.addEventListener("webglcontextlost",d,!1);x.addEventListener("webglcontextrestored",e,!1);var L=A||x.getContext("webgl",w)||x.getContext("experimental-webgl",w);if(null===L){if(null!==x.getContext("webgl"))throw Error("Error creating WebGL context with your selected attributes.");throw Error("Error creating WebGL context.");}void 0===
L.getShaderPrecisionFormat&&(L.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(uf){throw console.error("THREE.WebGLRenderer: "+uf.message),uf;}var na,Aa,ca,lb,Ba,ba,pa,sa,oa,la,ra,qa,ma,va,wa,ya,ia;c();var ka=null;"undefined"!==typeof navigator&&(ka="xr"in navigator?new dh(fa):new tf(fa));this.vr=ka;var za=new nf(fa,oa,Aa.maxTextureSize);this.shadowMap=za;this.getContext=function(){return L};this.getContextAttributes=function(){return L.getContextAttributes()};
this.forceContextLoss=function(){var a=na.get("WEBGL_lose_context");a&&a.loseContext()};this.forceContextRestore=function(){var a=na.get("WEBGL_lose_context");a&&a.restoreContext()};this.getPixelRatio=function(){return H};this.setPixelRatio=function(a){void 0!==a&&(H=a,this.setSize(Ea,U,!1))};this.getSize=function(a){void 0===a&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),a=new B);return a.set(Ea,U)};this.setSize=function(a,b,c){ka.isPresenting()?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):
(Ea=a,U=b,x.width=a*H,x.height=b*H,!1!==c&&(x.style.width=a+"px",x.style.height=b+"px"),this.setViewport(0,0,a,b))};this.getDrawingBufferSize=function(a){void 0===a&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),a=new B);return a.set(Ea*H,U*H)};this.setDrawingBufferSize=function(a,b,c){Ea=a;U=b;H=c;x.width=a*c;x.height=b*c;this.setViewport(0,0,a,b)};this.getCurrentViewport=function(a){void 0===a&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),
a=new Y);return a.copy(R)};this.getViewport=function(a){return a.copy(Z)};this.setViewport=function(a,b,c,d){a.isVector4?Z.set(a.x,a.y,a.z,a.w):Z.set(a,b,c,d);ca.viewport(R.copy(Z).multiplyScalar(H))};this.getScissor=function(a){return a.copy(Ha)};this.setScissor=function(a,b,c,d){a.isVector4?Ha.set(a.x,a.y,a.z,a.w):Ha.set(a,b,c,d);ca.scissor(W.copy(Ha).multiplyScalar(H))};this.getScissorTest=function(){return ea};this.setScissorTest=function(a){ca.setScissorTest(ea=a)};this.getClearColor=function(){return ma.getClearColor()};
this.setClearColor=function(){ma.setClearColor.apply(ma,arguments)};this.getClearAlpha=function(){return ma.getClearAlpha()};this.setClearAlpha=function(){ma.setClearAlpha.apply(ma,arguments)};this.clear=function(a,b,c){var d=0;if(void 0===a||a)d|=16384;if(void 0===b||b)d|=256;if(void 0===c||c)d|=1024;L.clear(d)};this.clearColor=function(){this.clear(!0,!1,!1)};this.clearDepth=function(){this.clear(!1,!0,!1)};this.clearStencil=function(){this.clear(!1,!1,!0)};this.dispose=function(){x.removeEventListener("webglcontextlost",
d,!1);x.removeEventListener("webglcontextrestored",e,!1);ra.dispose();qa.dispose();Ba.dispose();oa.dispose();ka.dispose();ta.stop()};this.renderBufferImmediate=function(a,b){ca.initAttributes();var c=Ba.get(a);a.hasPositions&&!c.position&&(c.position=L.createBuffer());a.hasNormals&&!c.normal&&(c.normal=L.createBuffer());a.hasUvs&&!c.uv&&(c.uv=L.createBuffer());a.hasColors&&!c.color&&(c.color=L.createBuffer());b=b.getAttributes();a.hasPositions&&(L.bindBuffer(34962,c.position),L.bufferData(34962,a.positionArray,
35048),ca.enableAttribute(b.position),L.vertexAttribPointer(b.position,3,5126,!1,0,0));a.hasNormals&&(L.bindBuffer(34962,c.normal),L.bufferData(34962,a.normalArray,35048),ca.enableAttribute(b.normal),L.vertexAttribPointer(b.normal,3,5126,!1,0,0));a.hasUvs&&(L.bindBuffer(34962,c.uv),L.bufferData(34962,a.uvArray,35048),ca.enableAttribute(b.uv),L.vertexAttribPointer(b.uv,2,5126,!1,0,0));a.hasColors&&(L.bindBuffer(34962,c.color),L.bufferData(34962,a.colorArray,35048),ca.enableAttribute(b.color),L.vertexAttribPointer(b.color,
3,5126,!1,0,0));ca.disableUnusedAttributes();L.drawArrays(4,0,a.count);a.count=0};this.renderBufferDirect=function(a,c,d,e,f,g){var h=f.isMesh&&0>f.matrixWorld.determinant();ca.setMaterial(e,h);var k=l(a,c,e,f),m=!1;if(b!==d.id||O!==k.id||da!==(!0===e.wireframe))b=d.id,O=k.id,da=!0===e.wireframe,m=!0;f.morphTargetInfluences&&(va.update(f,d,e,k),m=!0);h=d.index;var p=d.attributes.position;c=1;!0===e.wireframe&&(h=sa.getWireframeAttribute(d),c=2);a=wa;if(null!==h){var q=pa.get(h);a=ya;a.setIndex(q)}if(m){if(d&&
d.isInstancedBufferGeometry&&!Aa.isWebGL2&&null===na.get("ANGLE_instanced_arrays"))console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{ca.initAttributes();m=d.attributes;k=k.getAttributes();var v=e.defaultAttributeValues;for(D in k){var r=k[D];if(0<=r){var t=m[D];if(void 0!==t){var n=t.normalized,u=t.itemSize,x=pa.get(t);if(void 0!==x){var w=x.buffer,A=x.type;x=x.bytesPerElement;if(t.isInterleavedBufferAttribute){var y=
t.data,J=y.stride;t=t.offset;y&&y.isInstancedInterleavedBuffer?(ca.enableAttributeAndDivisor(r,y.meshPerAttribute),void 0===d.maxInstancedCount&&(d.maxInstancedCount=y.meshPerAttribute*y.count)):ca.enableAttribute(r);L.bindBuffer(34962,w);L.vertexAttribPointer(r,u,A,n,J*x,t*x)}else t.isInstancedBufferAttribute?(ca.enableAttributeAndDivisor(r,t.meshPerAttribute),void 0===d.maxInstancedCount&&(d.maxInstancedCount=t.meshPerAttribute*t.count)):ca.enableAttribute(r),L.bindBuffer(34962,w),L.vertexAttribPointer(r,
u,A,n,0,0)}}else if(void 0!==v&&(n=v[D],void 0!==n))switch(n.length){case 2:L.vertexAttrib2fv(r,n);break;case 3:L.vertexAttrib3fv(r,n);break;case 4:L.vertexAttrib4fv(r,n);break;default:L.vertexAttrib1fv(r,n)}}}ca.disableUnusedAttributes()}null!==h&&L.bindBuffer(34963,q.buffer)}q=Infinity;null!==h?q=h.count:void 0!==p&&(q=p.count);h=d.drawRange.start*c;p=null!==g?g.start*c:0;var D=Math.max(h,p);g=Math.max(0,Math.min(q,h+d.drawRange.count*c,p+(null!==g?g.count*c:Infinity))-1-D+1);if(0!==g){if(f.isMesh)if(!0===
e.wireframe)ca.setLineWidth(e.wireframeLinewidth*(null===N?H:1)),a.setMode(1);else switch(f.drawMode){case 0:a.setMode(4);break;case 1:a.setMode(5);break;case 2:a.setMode(6)}else f.isLine?(e=e.linewidth,void 0===e&&(e=1),ca.setLineWidth(e*(null===N?H:1)),f.isLineSegments?a.setMode(1):f.isLineLoop?a.setMode(2):a.setMode(3)):f.isPoints?a.setMode(0):f.isSprite&&a.setMode(4);d&&d.isInstancedBufferGeometry?0<d.maxInstancedCount&&a.renderInstances(d,D,g):a.render(D,g)}};this.compile=function(a,b){z=qa.get(a,
b);z.init();a.traverse(function(a){a.isLight&&(z.pushLight(a),a.castShadow&&z.pushShadow(a))});z.setupLights(b);a.traverse(function(b){if(b.material)if(Array.isArray(b.material))for(var c=0;c<b.material.length;c++)q(b.material[c],a.fog,b);else q(b.material,a.fog,b)})};var xa=null,ta=new ae;ta.setAnimationLoop(function(a){ka.isPresenting()||xa&&xa(a)});"undefined"!==typeof window&&ta.setContext(window);this.setAnimationLoop=function(a){xa=a;ka.setAnimationLoop(a);ta.start()};this.render=function(a,
c,d,e){if(void 0!==d){console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead.");var f=d}if(void 0!==e){console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead.");var g=e}c&&c.isCamera?I||(O=b=null,da=!1,Q=-1,S=null,!0===a.autoUpdate&&a.updateMatrixWorld(),null===c.parent&&c.updateMatrixWorld(),ka.enabled&&(c=ka.getCamera(c)),z=qa.get(a,c),z.init(),a.onBeforeRender(fa,a,c,f||N),Fc.multiplyMatrices(c.projectionMatrix,
c.matrixWorldInverse),ja.setFromMatrix(Fc),fe=this.localClippingEnabled,ha=aa.init(this.clippingPlanes,fe,c),C=ra.get(a,c),C.init(),k(a,c,0,fa.sortObjects),!0===fa.sortObjects&&C.sort(),ha&&aa.beginShadows(),za.render(z.state.shadowsArray,a,c),z.setupLights(c),ha&&aa.endShadows(),this.info.autoReset&&this.info.reset(),void 0!==f&&this.setRenderTarget(f),ma.render(C,a,c,g),d=C.opaque,e=C.transparent,a.overrideMaterial?(f=a.overrideMaterial,d.length&&m(d,a,c,f),e.length&&m(e,a,c,f)):(d.length&&m(d,
a,c),e.length&&m(e,a,c)),a.onAfterRender(fa,a,c),null!==N&&(ba.updateRenderTargetMipmap(N),ba.updateMultisampleRenderTarget(N)),ca.buffers.depth.setTest(!0),ca.buffers.depth.setMask(!0),ca.buffers.color.setMask(!0),ca.setPolygonOffset(!1),ka.enabled&&ka.submitFrame(),z=C=null):console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")};this.setFramebuffer=function(a){M=a};this.getRenderTarget=function(){return N};this.setRenderTarget=function(a,b,c){(N=a)&&void 0===Ba.get(a).__webglFramebuffer&&
ba.setupRenderTarget(a);var d=M,e=!1;a?(d=Ba.get(a).__webglFramebuffer,a.isWebGLRenderTargetCube?(d=d[b||0],e=!0):d=a.isWebGLMultisampleRenderTarget?Ba.get(a).__webglMultisampledFramebuffer:d,R.copy(a.viewport),W.copy(a.scissor),V=a.scissorTest):(R.copy(Z).multiplyScalar(H),W.copy(Ha).multiplyScalar(H),V=ea);X!==d&&(L.bindFramebuffer(36160,d),X=d);ca.viewport(R);ca.scissor(W);ca.setScissorTest(V);e&&(a=Ba.get(a.texture),L.framebufferTexture2D(36160,36064,34069+(b||0),a.__webglTexture,c||0))};this.readRenderTargetPixels=
function(a,b,c,d,e,f){if(a&&a.isWebGLRenderTarget){var g=Ba.get(a).__webglFramebuffer;if(g){var h=!1;g!==X&&(L.bindFramebuffer(36160,g),h=!0);try{var k=a.texture,m=k.format,p=k.type;1023!==m&&ia.convert(m)!==L.getParameter(35739)?console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format."):1009===p||ia.convert(p)===L.getParameter(35738)||1015===p&&(Aa.isWebGL2||na.get("OES_texture_float")||na.get("WEBGL_color_buffer_float"))||1016===p&&
(Aa.isWebGL2?na.get("EXT_color_buffer_float"):na.get("EXT_color_buffer_half_float"))?36053===L.checkFramebufferStatus(36160)?0<=b&&b<=a.width-d&&0<=c&&c<=a.height-e&&L.readPixels(b,c,d,e,ia.convert(m),ia.convert(p),f):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.")}finally{h&&L.bindFramebuffer(36160,
X)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")};this.copyFramebufferToTexture=function(a,b,c){var d=b.image.width,e=b.image.height,f=ia.convert(b.format);ba.setTexture2D(b,0);L.copyTexImage2D(3553,c||0,f,a.x,a.y,d,e,0)};this.copyTextureToTexture=function(a,b,c,d){var e=b.image.width,f=b.image.height,g=ia.convert(c.format),h=ia.convert(c.type);ba.setTexture2D(c,0);b.isDataTexture?L.texSubImage2D(3553,d||0,a.x,a.y,e,f,g,h,b.image.data):
L.texSubImage2D(3553,d||0,a.x,a.y,g,h,b.image)}}function yd(a,b){this.name="";this.color=new M(a);this.density=void 0!==b?b:2.5E-4}function zd(a,b,c){this.name="";this.color=new M(a);this.near=void 0!==b?b:1;this.far=void 0!==c?c:1E3}function Ad(){C.call(this);this.type="Scene";this.overrideMaterial=this.fog=this.background=null;this.autoUpdate=!0}function xb(a,b){this.array=a;this.stride=b;this.count=void 0!==a?a.length/b:0;this.dynamic=!1;this.updateRange={offset:0,count:-1};this.version=0}function Hc(a,
b,c,d){this.data=a;this.itemSize=b;this.offset=c;this.normalized=!0===d}function mb(a){O.call(this);this.type="SpriteMaterial";this.color=new M(16777215);this.map=null;this.rotation=0;this.sizeAttenuation=!0;this.lights=!1;this.transparent=!0;this.setValues(a)}function Ic(a){C.call(this);this.type="Sprite";if(void 0===Wb){Wb=new z;var b=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]);b=new xb(b,5);Wb.setIndex([0,1,2,0,2,3]);Wb.addAttribute("position",new Hc(b,3,0,!1));Wb.addAttribute("uv",
new Hc(b,2,3,!1))}this.geometry=Wb;this.material=void 0!==a?a:new mb;this.center=new B(.5,.5)}function Jc(){C.call(this);this.type="LOD";Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function Kc(a,b){a&&a.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");va.call(this,a,b);this.type="SkinnedMesh";this.bindMode="attached";this.bindMatrix=new P;this.bindMatrixInverse=new P}function Bd(a,b){a=a||[];this.bones=a.slice(0);
this.boneMatrices=new Float32Array(16*this.bones.length);if(void 0===b)this.calculateInverses();else if(this.bones.length===b.length)this.boneInverses=b.slice(0);else for(console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[],a=0,b=this.bones.length;a<b;a++)this.boneInverses.push(new P)}function he(){C.call(this);this.type="Bone"}function R(a){O.call(this);this.type="LineBasicMaterial";this.color=new M(16777215);this.linewidth=1;this.linejoin=this.linecap="round";this.lights=
!1;this.setValues(a)}function oa(a,b,c){1===c&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead.");C.call(this);this.type="Line";this.geometry=void 0!==a?a:new z;this.material=void 0!==b?b:new R({color:16777215*Math.random()})}function V(a,b){oa.call(this,a,b);this.type="LineSegments"}function Cd(a,b){oa.call(this,a,b);this.type="LineLoop"}function Ka(a){O.call(this);this.type="PointsMaterial";this.color=new M(16777215);this.map=null;this.size=
1;this.sizeAttenuation=!0;this.lights=this.morphTargets=!1;this.setValues(a)}function Xb(a,b){C.call(this);this.type="Points";this.geometry=void 0!==a?a:new z;this.material=void 0!==b?b:new Ka({color:16777215*Math.random()})}function ie(a,b,c,d,e,f,g,h,k){W.call(this,a,b,c,d,e,f,g,h,k);this.format=void 0!==g?g:1022;this.minFilter=void 0!==f?f:1006;this.magFilter=void 0!==e?e:1006;this.generateMipmaps=!1}function Yb(a,b,c,d,e,f,g,h,k,m,p,q){W.call(this,null,f,g,h,k,m,d,e,p,q);this.image={width:b,height:c};
this.mipmaps=a;this.generateMipmaps=this.flipY=!1}function Lc(a,b,c,d,e,f,g,h,k){W.call(this,a,b,c,d,e,f,g,h,k);this.needsUpdate=!0}function Mc(a,b,c,d,e,f,g,h,k,m){m=void 0!==m?m:1026;if(1026!==m&&1027!==m)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===c&&1026===m&&(c=1012);void 0===c&&1027===m&&(c=1020);W.call(this,null,d,e,f,g,h,m,c,k);this.image={width:a,height:b};this.magFilter=void 0!==g?g:1003;this.minFilter=void 0!==h?h:1003;this.generateMipmaps=
this.flipY=!1}function Zb(a){z.call(this);this.type="WireframeGeometry";var b=[],c,d,e,f=[0,0],g={},h=["a","b","c"];if(a&&a.isGeometry){var k=a.faces;var m=0;for(d=k.length;m<d;m++){var p=k[m];for(c=0;3>c;c++){var q=p[h[c]];var l=p[h[(c+1)%3]];f[0]=Math.min(q,l);f[1]=Math.max(q,l);q=f[0]+","+f[1];void 0===g[q]&&(g[q]={index1:f[0],index2:f[1]})}}for(q in g)m=g[q],h=a.vertices[m.index1],b.push(h.x,h.y,h.z),h=a.vertices[m.index2],b.push(h.x,h.y,h.z)}else if(a&&a.isBufferGeometry)if(h=new n,null!==a.index){k=
a.attributes.position;p=a.index;var t=a.groups;0===t.length&&(t=[{start:0,count:p.count,materialIndex:0}]);a=0;for(e=t.length;a<e;++a)for(m=t[a],c=m.start,d=m.count,m=c,d=c+d;m<d;m+=3)for(c=0;3>c;c++)q=p.getX(m+c),l=p.getX(m+(c+1)%3),f[0]=Math.min(q,l),f[1]=Math.max(q,l),q=f[0]+","+f[1],void 0===g[q]&&(g[q]={index1:f[0],index2:f[1]});for(q in g)m=g[q],h.fromBufferAttribute(k,m.index1),b.push(h.x,h.y,h.z),h.fromBufferAttribute(k,m.index2),b.push(h.x,h.y,h.z)}else for(k=a.attributes.position,m=0,d=
k.count/3;m<d;m++)for(c=0;3>c;c++)g=3*m+c,h.fromBufferAttribute(k,g),b.push(h.x,h.y,h.z),g=3*m+(c+1)%3,h.fromBufferAttribute(k,g),b.push(h.x,h.y,h.z);this.addAttribute("position",new E(b,3))}function Nc(a,b,c){N.call(this);this.type="ParametricGeometry";this.parameters={func:a,slices:b,stacks:c};this.fromBufferGeometry(new $b(a,b,c));this.mergeVertices()}function $b(a,b,c){z.call(this);this.type="ParametricBufferGeometry";this.parameters={func:a,slices:b,stacks:c};var d=[],e=[],f=[],g=[],h=new n,
k=new n,m=new n,p=new n,q=new n,l,t;3>a.length&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var r=b+1;for(l=0;l<=c;l++){var u=l/c;for(t=0;t<=b;t++){var x=t/b;a(x,u,k);e.push(k.x,k.y,k.z);0<=x-1E-5?(a(x-1E-5,u,m),p.subVectors(k,m)):(a(x+1E-5,u,m),p.subVectors(m,k));0<=u-1E-5?(a(x,u-1E-5,m),q.subVectors(k,m)):(a(x,u+1E-5,m),q.subVectors(m,k));h.crossVectors(p,q).normalize();f.push(h.x,h.y,h.z);g.push(x,u)}}for(l=0;l<c;l++)for(t=0;t<b;t++)a=l*r+t+
1,h=(l+1)*r+t+1,k=(l+1)*r+t,d.push(l*r+t,a,k),d.push(a,h,k);this.setIndex(d);this.addAttribute("position",new E(e,3));this.addAttribute("normal",new E(f,3));this.addAttribute("uv",new E(g,2))}function Oc(a,b,c,d){N.call(this);this.type="PolyhedronGeometry";this.parameters={vertices:a,indices:b,radius:c,detail:d};this.fromBufferGeometry(new ka(a,b,c,d));this.mergeVertices()}function ka(a,b,c,d){function e(a){h.push(a.x,a.y,a.z)}function f(b,c){b*=3;c.x=a[b+0];c.y=a[b+1];c.z=a[b+2]}function g(a,b,c,
d){0>d&&1===a.x&&(k[b]=a.x-1);0===c.x&&0===c.z&&(k[b]=d/2/Math.PI+.5)}z.call(this);this.type="PolyhedronBufferGeometry";this.parameters={vertices:a,indices:b,radius:c,detail:d};c=c||1;d=d||0;var h=[],k=[];(function(a){for(var c=new n,d=new n,g=new n,h=0;h<b.length;h+=3){f(b[h+0],c);f(b[h+1],d);f(b[h+2],g);var k,m,l=c,A=d,w=g,y=Math.pow(2,a),D=[];for(m=0;m<=y;m++){D[m]=[];var J=l.clone().lerp(w,m/y),B=A.clone().lerp(w,m/y),F=y-m;for(k=0;k<=F;k++)D[m][k]=0===k&&m===y?J:J.clone().lerp(B,k/F)}for(m=0;m<
y;m++)for(k=0;k<2*(y-m)-1;k++)l=Math.floor(k/2),0===k%2?(e(D[m][l+1]),e(D[m+1][l]),e(D[m][l])):(e(D[m][l+1]),e(D[m+1][l+1]),e(D[m+1][l]))}})(d);(function(a){for(var b=new n,c=0;c<h.length;c+=3)b.x=h[c+0],b.y=h[c+1],b.z=h[c+2],b.normalize().multiplyScalar(a),h[c+0]=b.x,h[c+1]=b.y,h[c+2]=b.z})(c);(function(){for(var a=new n,b=0;b<h.length;b+=3)a.x=h[b+0],a.y=h[b+1],a.z=h[b+2],k.push(Math.atan2(a.z,-a.x)/2/Math.PI+.5,1-(Math.atan2(-a.y,Math.sqrt(a.x*a.x+a.z*a.z))/Math.PI+.5));a=new n;b=new n;for(var c=
new n,d=new n,e=new B,f=new B,l=new B,x=0,A=0;x<h.length;x+=9,A+=6){a.set(h[x+0],h[x+1],h[x+2]);b.set(h[x+3],h[x+4],h[x+5]);c.set(h[x+6],h[x+7],h[x+8]);e.set(k[A+0],k[A+1]);f.set(k[A+2],k[A+3]);l.set(k[A+4],k[A+5]);d.copy(a).add(b).add(c).divideScalar(3);var w=Math.atan2(d.z,-d.x);g(e,A+0,a,w);g(f,A+2,b,w);g(l,A+4,c,w)}for(a=0;a<k.length;a+=6)b=k[a+0],c=k[a+2],d=k[a+4],e=Math.min(b,c,d),.9<Math.max(b,c,d)&&.1>e&&(.2>b&&(k[a+0]+=1),.2>c&&(k[a+2]+=1),.2>d&&(k[a+4]+=1))})();this.addAttribute("position",
new E(h,3));this.addAttribute("normal",new E(h.slice(),3));this.addAttribute("uv",new E(k,2));0===d?this.computeVertexNormals():this.normalizeNormals()}function Pc(a,b){N.call(this);this.type="TetrahedronGeometry";this.parameters={radius:a,detail:b};this.fromBufferGeometry(new ac(a,b));this.mergeVertices()}function ac(a,b){ka.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],a,b);this.type="TetrahedronBufferGeometry";this.parameters={radius:a,detail:b}}function Qc(a,b){N.call(this);
this.type="OctahedronGeometry";this.parameters={radius:a,detail:b};this.fromBufferGeometry(new yb(a,b));this.mergeVertices()}function yb(a,b){ka.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],a,b);this.type="OctahedronBufferGeometry";this.parameters={radius:a,detail:b}}function Rc(a,b){N.call(this);this.type="IcosahedronGeometry";this.parameters={radius:a,detail:b};this.fromBufferGeometry(new bc(a,b));this.mergeVertices()}function bc(a,b){var c=
(1+Math.sqrt(5))/2;ka.call(this,[-1,c,0,1,c,0,-1,-c,0,1,-c,0,0,-1,c,0,1,c,0,-1,-c,0,1,-c,c,0,-1,c,0,1,-c,0,-1,-c,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],a,b);this.type="IcosahedronBufferGeometry";this.parameters={radius:a,detail:b}}function Sc(a,b){N.call(this);this.type="DodecahedronGeometry";this.parameters={radius:a,detail:b};this.fromBufferGeometry(new cc(a,b));this.mergeVertices()}function cc(a,b){var c=
(1+Math.sqrt(5))/2,d=1/c;ka.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-d,-c,0,-d,c,0,d,-c,0,d,c,-d,-c,0,-d,c,0,d,-c,0,d,c,0,-c,0,-d,c,0,-d,-c,0,d,c,0,d],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],a,b);this.type="DodecahedronBufferGeometry";this.parameters=
{radius:a,detail:b}}function Tc(a,b,c,d,e,f){N.call(this);this.type="TubeGeometry";this.parameters={path:a,tubularSegments:b,radius:c,radialSegments:d,closed:e};void 0!==f&&console.warn("THREE.TubeGeometry: taper has been removed.");a=new zb(a,b,c,d,e);this.tangents=a.tangents;this.normals=a.normals;this.binormals=a.binormals;this.fromBufferGeometry(a);this.mergeVertices()}function zb(a,b,c,d,e){function f(e){p=a.getPointAt(e/b,p);var f=g.normals[e];e=g.binormals[e];for(l=0;l<=d;l++){var m=l/d*Math.PI*
2,q=Math.sin(m);m=-Math.cos(m);k.x=m*f.x+q*e.x;k.y=m*f.y+q*e.y;k.z=m*f.z+q*e.z;k.normalize();r.push(k.x,k.y,k.z);h.x=p.x+c*k.x;h.y=p.y+c*k.y;h.z=p.z+c*k.z;t.push(h.x,h.y,h.z)}}z.call(this);this.type="TubeBufferGeometry";this.parameters={path:a,tubularSegments:b,radius:c,radialSegments:d,closed:e};b=b||64;c=c||1;d=d||8;e=e||!1;var g=a.computeFrenetFrames(b,e);this.tangents=g.tangents;this.normals=g.normals;this.binormals=g.binormals;var h=new n,k=new n,m=new B,p=new n,q,l,t=[],r=[],u=[],x=[];for(q=
0;q<b;q++)f(q);f(!1===e?b:0);for(q=0;q<=b;q++)for(l=0;l<=d;l++)m.x=q/b,m.y=l/d,u.push(m.x,m.y);(function(){for(l=1;l<=b;l++)for(q=1;q<=d;q++){var a=(d+1)*l+(q-1),c=(d+1)*l+q,e=(d+1)*(l-1)+q;x.push((d+1)*(l-1)+(q-1),a,e);x.push(a,c,e)}})();this.setIndex(x);this.addAttribute("position",new E(t,3));this.addAttribute("normal",new E(r,3));this.addAttribute("uv",new E(u,2))}function Uc(a,b,c,d,e,f,g){N.call(this);this.type="TorusKnotGeometry";this.parameters={radius:a,tube:b,tubularSegments:c,radialSegments:d,
p:e,q:f};void 0!==g&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead.");this.fromBufferGeometry(new dc(a,b,c,d,e,f));this.mergeVertices()}function dc(a,b,c,d,e,f){function g(a,b,c,d,e){var f=Math.sin(a);b=c/b*a;c=Math.cos(b);e.x=d*(2+c)*.5*Math.cos(a);e.y=d*(2+c)*f*.5;e.z=d*Math.sin(b)*.5}z.call(this);this.type="TorusKnotBufferGeometry";this.parameters={radius:a,tube:b,tubularSegments:c,radialSegments:d,p:e,q:f};a=a||1;b=b||.4;c=Math.floor(c)||
64;d=Math.floor(d)||8;e=e||2;f=f||3;var h=[],k=[],m=[],p=[],q,l=new n,t=new n,r=new n,u=new n,x=new n,A=new n,w=new n;for(q=0;q<=c;++q){var y=q/c*e*Math.PI*2;g(y,e,f,a,r);g(y+.01,e,f,a,u);A.subVectors(u,r);w.addVectors(u,r);x.crossVectors(A,w);w.crossVectors(x,A);x.normalize();w.normalize();for(y=0;y<=d;++y){var D=y/d*Math.PI*2,J=-b*Math.cos(D);D=b*Math.sin(D);l.x=r.x+(J*w.x+D*x.x);l.y=r.y+(J*w.y+D*x.y);l.z=r.z+(J*w.z+D*x.z);k.push(l.x,l.y,l.z);t.subVectors(l,r).normalize();m.push(t.x,t.y,t.z);p.push(q/
c);p.push(y/d)}}for(y=1;y<=c;y++)for(q=1;q<=d;q++)a=(d+1)*y+(q-1),b=(d+1)*y+q,e=(d+1)*(y-1)+q,h.push((d+1)*(y-1)+(q-1),a,e),h.push(a,b,e);this.setIndex(h);this.addAttribute("position",new E(k,3));this.addAttribute("normal",new E(m,3));this.addAttribute("uv",new E(p,2))}function Vc(a,b,c,d,e){N.call(this);this.type="TorusGeometry";this.parameters={radius:a,tube:b,radialSegments:c,tubularSegments:d,arc:e};this.fromBufferGeometry(new ec(a,b,c,d,e));this.mergeVertices()}function ec(a,b,c,d,e){z.call(this);
this.type="TorusBufferGeometry";this.parameters={radius:a,tube:b,radialSegments:c,tubularSegments:d,arc:e};a=a||1;b=b||.4;c=Math.floor(c)||8;d=Math.floor(d)||6;e=e||2*Math.PI;var f=[],g=[],h=[],k=[],m=new n,p=new n,q=new n,l,t;for(l=0;l<=c;l++)for(t=0;t<=d;t++){var r=t/d*e,u=l/c*Math.PI*2;p.x=(a+b*Math.cos(u))*Math.cos(r);p.y=(a+b*Math.cos(u))*Math.sin(r);p.z=b*Math.sin(u);g.push(p.x,p.y,p.z);m.x=a*Math.cos(r);m.y=a*Math.sin(r);q.subVectors(p,m).normalize();h.push(q.x,q.y,q.z);k.push(t/d);k.push(l/
c)}for(l=1;l<=c;l++)for(t=1;t<=d;t++)a=(d+1)*(l-1)+t-1,b=(d+1)*(l-1)+t,e=(d+1)*l+t,f.push((d+1)*l+t-1,a,e),f.push(a,b,e);this.setIndex(f);this.addAttribute("position",new E(g,3));this.addAttribute("normal",new E(h,3));this.addAttribute("uv",new E(k,2))}function vf(a,b,c,d,e){for(var f,g=0,h=b,k=c-d;h<c;h+=d)g+=(a[k]-a[h])*(a[h+1]+a[k+1]),k=h;if(e===0<g)for(e=b;e<c;e+=d)f=wf(e,a[e],a[e+1],f);else for(e=c-d;e>=b;e-=d)f=wf(e,a[e],a[e+1],f);f&&Ab(f,f.next)&&(Wc(f),f=f.next);return f}function Xc(a,b){if(!a)return a;
b||(b=a);do{var c=!1;if(a.steiner||!Ab(a,a.next)&&0!==wa(a.prev,a,a.next))a=a.next;else{Wc(a);a=b=a.prev;if(a===a.next)break;c=!0}}while(c||a!==b);return b}function Yc(a,b,c,d,e,f,g){if(a){if(!g&&f){var h=a,k=h;do null===k.z&&(k.z=je(k.x,k.y,d,e,f)),k.prevZ=k.prev,k=k.nextZ=k.next;while(k!==h);k.prevZ.nextZ=null;k.prevZ=null;h=k;var m,p,q,l,t=1;do{k=h;var r=h=null;for(p=0;k;){p++;var n=k;for(m=q=0;m<t&&(q++,n=n.nextZ,n);m++);for(l=t;0<q||0<l&&n;)0!==q&&(0===l||!n||k.z<=n.z)?(m=k,k=k.nextZ,q--):(m=
n,n=n.nextZ,l--),r?r.nextZ=m:h=m,m.prevZ=r,r=m;k=n}r.nextZ=null;t*=2}while(1<p)}for(h=a;a.prev!==a.next;){k=a.prev;n=a.next;if(f)a:{r=a;l=d;var x=e,A=f;p=r.prev;q=r;t=r.next;if(0<=wa(p,q,t))r=!1;else{var w=p.x>q.x?p.x>t.x?p.x:t.x:q.x>t.x?q.x:t.x,y=p.y>q.y?p.y>t.y?p.y:t.y:q.y>t.y?q.y:t.y;m=je(p.x<q.x?p.x<t.x?p.x:t.x:q.x<t.x?q.x:t.x,p.y<q.y?p.y<t.y?p.y:t.y:q.y<t.y?q.y:t.y,l,x,A);l=je(w,y,l,x,A);for(x=r.nextZ;x&&x.z<=l;){if(x!==r.prev&&x!==r.next&&Dd(p.x,p.y,q.x,q.y,t.x,t.y,x.x,x.y)&&0<=wa(x.prev,x,
x.next)){r=!1;break a}x=x.nextZ}for(x=r.prevZ;x&&x.z>=m;){if(x!==r.prev&&x!==r.next&&Dd(p.x,p.y,q.x,q.y,t.x,t.y,x.x,x.y)&&0<=wa(x.prev,x,x.next)){r=!1;break a}x=x.prevZ}r=!0}}else a:if(r=a,p=r.prev,q=r,t=r.next,0<=wa(p,q,t))r=!1;else{for(m=r.next.next;m!==r.prev;){if(Dd(p.x,p.y,q.x,q.y,t.x,t.y,m.x,m.y)&&0<=wa(m.prev,m,m.next)){r=!1;break a}m=m.next}r=!0}if(r)b.push(k.i/c),b.push(a.i/c),b.push(n.i/c),Wc(a),h=a=n.next;else if(a=n,a===h){if(!g)Yc(Xc(a),b,c,d,e,f,1);else if(1===g){g=b;h=c;k=a;do n=k.prev,
r=k.next.next,!Ab(n,r)&&xf(n,k,k.next,r)&&Zc(n,r)&&Zc(r,n)&&(g.push(n.i/h),g.push(k.i/h),g.push(r.i/h),Wc(k),Wc(k.next),k=a=r),k=k.next;while(k!==a);a=k;Yc(a,b,c,d,e,f,2)}else if(2===g)a:{g=a;do{for(h=g.next.next;h!==g.prev;){if(k=g.i!==h.i){k=g;n=h;if(r=k.next.i!==n.i&&k.prev.i!==n.i){b:{r=k;do{if(r.i!==k.i&&r.next.i!==k.i&&r.i!==n.i&&r.next.i!==n.i&&xf(r,r.next,k,n)){r=!0;break b}r=r.next}while(r!==k);r=!1}r=!r}if(r=r&&Zc(k,n)&&Zc(n,k)){r=k;p=!1;q=(k.x+n.x)/2;n=(k.y+n.y)/2;do r.y>n!==r.next.y>n&&
r.next.y!==r.y&&q<(r.next.x-r.x)*(n-r.y)/(r.next.y-r.y)+r.x&&(p=!p),r=r.next;while(r!==k);r=p}k=r}if(k){a=yf(g,h);g=Xc(g,g.next);a=Xc(a,a.next);Yc(g,b,c,d,e,f);Yc(a,b,c,d,e,f);break a}h=h.next}g=g.next}while(g!==a)}break}}}}function eh(a,b){return a.x-b.x}function fh(a,b){var c=b,d=a.x,e=a.y,f=-Infinity;do{if(e<=c.y&&e>=c.next.y&&c.next.y!==c.y){var g=c.x+(e-c.y)*(c.next.x-c.x)/(c.next.y-c.y);if(g<=d&&g>f){f=g;if(g===d){if(e===c.y)return c;if(e===c.next.y)return c.next}var h=c.x<c.next.x?c:c.next}}c=
c.next}while(c!==b);if(!h)return null;if(d===f)return h.prev;b=h;g=h.x;var k=h.y,m=Infinity;for(c=h.next;c!==b;){if(d>=c.x&&c.x>=g&&d!==c.x&&Dd(e<k?d:f,e,g,k,e<k?f:d,e,c.x,c.y)){var p=Math.abs(e-c.y)/(d-c.x);(p<m||p===m&&c.x>h.x)&&Zc(c,a)&&(h=c,m=p)}c=c.next}return h}function je(a,b,c,d,e){a=32767*(a-c)*e;b=32767*(b-d)*e;a=(a|a<<8)&16711935;a=(a|a<<4)&252645135;a=(a|a<<2)&858993459;b=(b|b<<8)&16711935;b=(b|b<<4)&252645135;b=(b|b<<2)&858993459;return(a|a<<1)&1431655765|((b|b<<1)&1431655765)<<1}function gh(a){var b=
a,c=a;do b.x<c.x&&(c=b),b=b.next;while(b!==a);return c}function Dd(a,b,c,d,e,f,g,h){return 0<=(e-g)*(b-h)-(a-g)*(f-h)&&0<=(a-g)*(d-h)-(c-g)*(b-h)&&0<=(c-g)*(f-h)-(e-g)*(d-h)}function wa(a,b,c){return(b.y-a.y)*(c.x-b.x)-(b.x-a.x)*(c.y-b.y)}function Ab(a,b){return a.x===b.x&&a.y===b.y}function xf(a,b,c,d){return Ab(a,b)&&Ab(c,d)||Ab(a,d)&&Ab(c,b)?!0:0<wa(a,b,c)!==0<wa(a,b,d)&&0<wa(c,d,a)!==0<wa(c,d,b)}function Zc(a,b){return 0>wa(a.prev,a,a.next)?0<=wa(a,b,a.next)&&0<=wa(a,a.prev,b):0>wa(a,b,a.prev)||
0>wa(a,a.next,b)}function yf(a,b){var c=new ke(a.i,a.x,a.y),d=new ke(b.i,b.x,b.y),e=a.next,f=b.prev;a.next=b;b.prev=a;c.next=e;e.prev=c;d.next=c;c.prev=d;f.next=d;d.prev=f;return d}function wf(a,b,c,d){a=new ke(a,b,c);d?(a.next=d.next,a.prev=d,d.next.prev=a,d.next=a):(a.prev=a,a.next=a);return a}function Wc(a){a.next.prev=a.prev;a.prev.next=a.next;a.prevZ&&(a.prevZ.nextZ=a.nextZ);a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function ke(a,b,c){this.i=a;this.x=b;this.y=c;this.nextZ=this.prevZ=this.z=this.next=
this.prev=null;this.steiner=!1}function zf(a){var b=a.length;2<b&&a[b-1].equals(a[0])&&a.pop()}function Af(a,b){for(var c=0;c<b.length;c++)a.push(b[c].x),a.push(b[c].y)}function Bb(a,b){N.call(this);this.type="ExtrudeGeometry";this.parameters={shapes:a,options:b};this.fromBufferGeometry(new Ya(a,b));this.mergeVertices()}function Ya(a,b){function c(a){function c(a,b,c){b||console.error("THREE.ExtrudeGeometry: vec does not exist");return b.clone().multiplyScalar(c).add(a)}function g(a,b,c){var d=a.x-
b.x;var e=a.y-b.y;var f=c.x-a.x;var g=c.y-a.y,h=d*d+e*e;if(Math.abs(d*g-e*f)>Number.EPSILON){var k=Math.sqrt(h),m=Math.sqrt(f*f+g*g);h=b.x-e/k;b=b.y+d/k;g=((c.x-g/m-h)*g-(c.y+f/m-b)*f)/(d*g-e*f);f=h+d*g-a.x;d=b+e*g-a.y;e=f*f+d*d;if(2>=e)return new B(f,d);e=Math.sqrt(e/2)}else a=!1,d>Number.EPSILON?f>Number.EPSILON&&(a=!0):d<-Number.EPSILON?f<-Number.EPSILON&&(a=!0):Math.sign(e)===Math.sign(g)&&(a=!0),a?(f=-e,e=Math.sqrt(h)):(f=d,d=e,e=Math.sqrt(h/2));return new B(f/e,d/e)}function h(a,b){for(H=a.length;0<=
--H;){var c=H;var f=H-1;0>f&&(f=a.length-1);var g,h=w+2*F;for(g=0;g<h;g++){var k=W*g,m=W*(g+1),p=b+f+k,q=b+f+m;m=b+c+m;r(b+c+k);r(p);r(m);r(p);r(q);r(m);k=e.length/3;k=E.generateSideWallUV(d,e,k-6,k-3,k-2,k-1);u(k[0]);u(k[1]);u(k[3]);u(k[1]);u(k[2]);u(k[3])}}}function k(a,b,c){x.push(a);x.push(b);x.push(c)}function l(a,b,c){r(a);r(b);r(c);a=e.length/3;a=E.generateTopUV(d,e,a-3,a-2,a-1);u(a[0]);u(a[1]);u(a[2])}function r(a){e.push(x[3*a]);e.push(x[3*a+1]);e.push(x[3*a+2])}function u(a){f.push(a.x);
f.push(a.y)}var x=[],A=void 0!==b.curveSegments?b.curveSegments:12,w=void 0!==b.steps?b.steps:1,y=void 0!==b.depth?b.depth:100,D=void 0!==b.bevelEnabled?b.bevelEnabled:!0,J=void 0!==b.bevelThickness?b.bevelThickness:6,z=void 0!==b.bevelSize?b.bevelSize:J-2,F=void 0!==b.bevelSegments?b.bevelSegments:3,C=b.extrudePath,E=void 0!==b.UVGenerator?b.UVGenerator:hh;void 0!==b.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),y=b.amount);var G=!1;if(C){var I=C.getSpacedPoints(w);
G=!0;D=!1;var M=C.computeFrenetFrames(w,!1);var N=new n;var P=new n;var X=new n}D||(z=J=F=0);var Q;A=a.extractPoints(A);a=A.shape;var O=A.holes;if(!cb.isClockWise(a)){a=a.reverse();var da=0;for(Q=O.length;da<Q;da++){var K=O[da];cb.isClockWise(K)&&(O[da]=K.reverse())}}var S=cb.triangulateShape(a,O),T=a;da=0;for(Q=O.length;da<Q;da++)K=O[da],a=a.concat(K);var R,W=a.length,U,aa=S.length;A=[];var H=0;var Z=T.length;var V=Z-1;for(R=H+1;H<Z;H++,V++,R++)V===Z&&(V=0),R===Z&&(R=0),A[H]=g(T[H],T[V],T[R]);C=
[];var ba=A.concat();da=0;for(Q=O.length;da<Q;da++){K=O[da];var Y=[];H=0;Z=K.length;V=Z-1;for(R=H+1;H<Z;H++,V++,R++)V===Z&&(V=0),R===Z&&(R=0),Y[H]=g(K[H],K[V],K[R]);C.push(Y);ba=ba.concat(Y)}for(V=0;V<F;V++){Z=V/F;var ea=J*Math.cos(Z*Math.PI/2);R=z*Math.sin(Z*Math.PI/2);H=0;for(Z=T.length;H<Z;H++){var ha=c(T[H],A[H],R);k(ha.x,ha.y,-ea)}da=0;for(Q=O.length;da<Q;da++)for(K=O[da],Y=C[da],H=0,Z=K.length;H<Z;H++)ha=c(K[H],Y[H],R),k(ha.x,ha.y,-ea)}R=z;for(H=0;H<W;H++)ha=D?c(a[H],ba[H],R):a[H],G?(P.copy(M.normals[0]).multiplyScalar(ha.x),
N.copy(M.binormals[0]).multiplyScalar(ha.y),X.copy(I[0]).add(P).add(N),k(X.x,X.y,X.z)):k(ha.x,ha.y,0);for(Z=1;Z<=w;Z++)for(H=0;H<W;H++)ha=D?c(a[H],ba[H],R):a[H],G?(P.copy(M.normals[Z]).multiplyScalar(ha.x),N.copy(M.binormals[Z]).multiplyScalar(ha.y),X.copy(I[Z]).add(P).add(N),k(X.x,X.y,X.z)):k(ha.x,ha.y,y/w*Z);for(V=F-1;0<=V;V--){Z=V/F;ea=J*Math.cos(Z*Math.PI/2);R=z*Math.sin(Z*Math.PI/2);H=0;for(Z=T.length;H<Z;H++)ha=c(T[H],A[H],R),k(ha.x,ha.y,y+ea);da=0;for(Q=O.length;da<Q;da++)for(K=O[da],Y=C[da],
H=0,Z=K.length;H<Z;H++)ha=c(K[H],Y[H],R),G?k(ha.x,ha.y+I[w-1].y,I[w-1].x+ea):k(ha.x,ha.y,y+ea)}(function(){var a=e.length/3;if(D){var b=0*W;for(H=0;H<aa;H++)U=S[H],l(U[2]+b,U[1]+b,U[0]+b);b=W*(w+2*F);for(H=0;H<aa;H++)U=S[H],l(U[0]+b,U[1]+b,U[2]+b)}else{for(H=0;H<aa;H++)U=S[H],l(U[2],U[1],U[0]);for(H=0;H<aa;H++)U=S[H],l(U[0]+W*w,U[1]+W*w,U[2]+W*w)}d.addGroup(a,e.length/3-a,0)})();(function(){var a=e.length/3,b=0;h(T,b);b+=T.length;da=0;for(Q=O.length;da<Q;da++)K=O[da],h(K,b),b+=K.length;d.addGroup(a,
e.length/3-a,1)})()}z.call(this);this.type="ExtrudeBufferGeometry";this.parameters={shapes:a,options:b};a=Array.isArray(a)?a:[a];for(var d=this,e=[],f=[],g=0,h=a.length;g<h;g++)c(a[g]);this.addAttribute("position",new E(e,3));this.addAttribute("uv",new E(f,2));this.computeVertexNormals()}function Bf(a,b,c){c.shapes=[];if(Array.isArray(a))for(var d=0,e=a.length;d<e;d++)c.shapes.push(a[d].uuid);else c.shapes.push(a.uuid);void 0!==b.extrudePath&&(c.options.extrudePath=b.extrudePath.toJSON());return c}
function $c(a,b){N.call(this);this.type="TextGeometry";this.parameters={text:a,parameters:b};this.fromBufferGeometry(new fc(a,b));this.mergeVertices()}function fc(a,b){b=b||{};var c=b.font;if(!c||!c.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new N;a=c.generateShapes(a,b.size);b.depth=void 0!==b.height?b.height:50;void 0===b.bevelThickness&&(b.bevelThickness=10);void 0===b.bevelSize&&(b.bevelSize=8);void 0===b.bevelEnabled&&(b.bevelEnabled=!1);
Ya.call(this,a,b);this.type="TextBufferGeometry"}function ad(a,b,c,d,e,f,g){N.call(this);this.type="SphereGeometry";this.parameters={radius:a,widthSegments:b,heightSegments:c,phiStart:d,phiLength:e,thetaStart:f,thetaLength:g};this.fromBufferGeometry(new Cb(a,b,c,d,e,f,g));this.mergeVertices()}function Cb(a,b,c,d,e,f,g){z.call(this);this.type="SphereBufferGeometry";this.parameters={radius:a,widthSegments:b,heightSegments:c,phiStart:d,phiLength:e,thetaStart:f,thetaLength:g};a=a||1;b=Math.max(3,Math.floor(b)||
8);c=Math.max(2,Math.floor(c)||6);d=void 0!==d?d:0;e=void 0!==e?e:2*Math.PI;f=void 0!==f?f:0;g=void 0!==g?g:Math.PI;var h=f+g,k,m,p=0,q=[],l=new n,t=new n,r=[],u=[],x=[],A=[];for(m=0;m<=c;m++){var w=[],y=m/c,D=0==m?.5/b:m==c?-.5/b:0;for(k=0;k<=b;k++){var J=k/b;l.x=-a*Math.cos(d+J*e)*Math.sin(f+y*g);l.y=a*Math.cos(f+y*g);l.z=a*Math.sin(d+J*e)*Math.sin(f+y*g);u.push(l.x,l.y,l.z);t.copy(l).normalize();x.push(t.x,t.y,t.z);A.push(J+D,1-y);w.push(p++)}q.push(w)}for(m=0;m<c;m++)for(k=0;k<b;k++)a=q[m][k+
1],d=q[m][k],e=q[m+1][k],g=q[m+1][k+1],(0!==m||0<f)&&r.push(a,d,g),(m!==c-1||h<Math.PI)&&r.push(d,e,g);this.setIndex(r);this.addAttribute("position",new E(u,3));this.addAttribute("normal",new E(x,3));this.addAttribute("uv",new E(A,2))}function bd(a,b,c,d,e,f){N.call(this);this.type="RingGeometry";this.parameters={innerRadius:a,outerRadius:b,thetaSegments:c,phiSegments:d,thetaStart:e,thetaLength:f};this.fromBufferGeometry(new gc(a,b,c,d,e,f));this.mergeVertices()}function gc(a,b,c,d,e,f){z.call(this);
this.type="RingBufferGeometry";this.parameters={innerRadius:a,outerRadius:b,thetaSegments:c,phiSegments:d,thetaStart:e,thetaLength:f};a=a||.5;b=b||1;e=void 0!==e?e:0;f=void 0!==f?f:2*Math.PI;c=void 0!==c?Math.max(3,c):8;d=void 0!==d?Math.max(1,d):1;var g=[],h=[],k=[],m=[],p=a,q=(b-a)/d,l=new n,t=new B,r,u;for(r=0;r<=d;r++){for(u=0;u<=c;u++)a=e+u/c*f,l.x=p*Math.cos(a),l.y=p*Math.sin(a),h.push(l.x,l.y,l.z),k.push(0,0,1),t.x=(l.x/b+1)/2,t.y=(l.y/b+1)/2,m.push(t.x,t.y);p+=q}for(r=0;r<d;r++)for(b=r*(c+
1),u=0;u<c;u++)a=u+b,e=a+c+1,f=a+c+2,p=a+1,g.push(a,e,p),g.push(e,f,p);this.setIndex(g);this.addAttribute("position",new E(h,3));this.addAttribute("normal",new E(k,3));this.addAttribute("uv",new E(m,2))}function cd(a,b,c,d){N.call(this);this.type="LatheGeometry";this.parameters={points:a,segments:b,phiStart:c,phiLength:d};this.fromBufferGeometry(new hc(a,b,c,d));this.mergeVertices()}function hc(a,b,c,d){z.call(this);this.type="LatheBufferGeometry";this.parameters={points:a,segments:b,phiStart:c,phiLength:d};
b=Math.floor(b)||12;c=c||0;d=d||2*Math.PI;d=K.clamp(d,0,2*Math.PI);var e=[],f=[],g=[],h=1/b,k=new n,m=new B,p;for(p=0;p<=b;p++){var q=c+p*h*d;var l=Math.sin(q),t=Math.cos(q);for(q=0;q<=a.length-1;q++)k.x=a[q].x*l,k.y=a[q].y,k.z=a[q].x*t,f.push(k.x,k.y,k.z),m.x=p/b,m.y=q/(a.length-1),g.push(m.x,m.y)}for(p=0;p<b;p++)for(q=0;q<a.length-1;q++)c=q+p*a.length,h=c+a.length,k=c+a.length+1,m=c+1,e.push(c,h,m),e.push(h,k,m);this.setIndex(e);this.addAttribute("position",new E(f,3));this.addAttribute("uv",new E(g,
2));this.computeVertexNormals();if(d===2*Math.PI)for(d=this.attributes.normal.array,e=new n,f=new n,g=new n,c=b*a.length*3,q=p=0;p<a.length;p++,q+=3)e.x=d[q+0],e.y=d[q+1],e.z=d[q+2],f.x=d[c+q+0],f.y=d[c+q+1],f.z=d[c+q+2],g.addVectors(e,f).normalize(),d[q+0]=d[c+q+0]=g.x,d[q+1]=d[c+q+1]=g.y,d[q+2]=d[c+q+2]=g.z}function Db(a,b){N.call(this);this.type="ShapeGeometry";"object"===typeof b&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),b=b.curveSegments);this.parameters={shapes:a,
curveSegments:b};this.fromBufferGeometry(new Eb(a,b));this.mergeVertices()}function Eb(a,b){function c(a){var c,h=e.length/3;a=a.extractPoints(b);var m=a.shape,p=a.holes;!1===cb.isClockWise(m)&&(m=m.reverse());a=0;for(c=p.length;a<c;a++){var l=p[a];!0===cb.isClockWise(l)&&(p[a]=l.reverse())}var n=cb.triangulateShape(m,p);a=0;for(c=p.length;a<c;a++)l=p[a],m=m.concat(l);a=0;for(c=m.length;a<c;a++)l=m[a],e.push(l.x,l.y,0),f.push(0,0,1),g.push(l.x,l.y);a=0;for(c=n.length;a<c;a++)m=n[a],d.push(m[0]+h,
m[1]+h,m[2]+h),k+=3}z.call(this);this.type="ShapeBufferGeometry";this.parameters={shapes:a,curveSegments:b};b=b||12;var d=[],e=[],f=[],g=[],h=0,k=0;if(!1===Array.isArray(a))c(a);else for(var m=0;m<a.length;m++)c(a[m]),this.addGroup(h,k,m),h+=k,k=0;this.setIndex(d);this.addAttribute("position",new E(e,3));this.addAttribute("normal",new E(f,3));this.addAttribute("uv",new E(g,2))}function Cf(a,b){b.shapes=[];if(Array.isArray(a))for(var c=0,d=a.length;c<d;c++)b.shapes.push(a[c].uuid);else b.shapes.push(a.uuid);
return b}function ic(a,b){z.call(this);this.type="EdgesGeometry";this.parameters={thresholdAngle:b};var c=[];b=Math.cos(K.DEG2RAD*(void 0!==b?b:1));var d=[0,0],e={},f=["a","b","c"];if(a.isBufferGeometry){var g=new N;g.fromBufferGeometry(a)}else g=a.clone();g.mergeVertices();g.computeFaceNormals();a=g.vertices;g=g.faces;for(var h=0,k=g.length;h<k;h++)for(var m=g[h],p=0;3>p;p++){var l=m[f[p]];var n=m[f[(p+1)%3]];d[0]=Math.min(l,n);d[1]=Math.max(l,n);l=d[0]+","+d[1];void 0===e[l]?e[l]={index1:d[0],index2:d[1],
face1:h,face2:void 0}:e[l].face2=h}for(l in e)if(d=e[l],void 0===d.face2||g[d.face1].normal.dot(g[d.face2].normal)<=b)f=a[d.index1],c.push(f.x,f.y,f.z),f=a[d.index2],c.push(f.x,f.y,f.z);this.addAttribute("position",new E(c,3))}function Fb(a,b,c,d,e,f,g,h){N.call(this);this.type="CylinderGeometry";this.parameters={radiusTop:a,radiusBottom:b,height:c,radialSegments:d,heightSegments:e,openEnded:f,thetaStart:g,thetaLength:h};this.fromBufferGeometry(new db(a,b,c,d,e,f,g,h));this.mergeVertices()}function db(a,
b,c,d,e,f,g,h){function k(c){var e,f=new B,k=new n,q=0,u=!0===c?a:b,w=!0===c?1:-1;var z=r;for(e=1;e<=d;e++)l.push(0,x*w,0),v.push(0,w,0),t.push(.5,.5),r++;var C=r;for(e=0;e<=d;e++){var E=e/d*h+g,G=Math.cos(E);E=Math.sin(E);k.x=u*E;k.y=x*w;k.z=u*G;l.push(k.x,k.y,k.z);v.push(0,w,0);f.x=.5*G+.5;f.y=.5*E*w+.5;t.push(f.x,f.y);r++}for(e=0;e<d;e++)f=z+e,k=C+e,!0===c?p.push(k,k+1,f):p.push(k+1,k,f),q+=3;m.addGroup(A,q,!0===c?1:2);A+=q}z.call(this);this.type="CylinderBufferGeometry";this.parameters={radiusTop:a,
radiusBottom:b,height:c,radialSegments:d,heightSegments:e,openEnded:f,thetaStart:g,thetaLength:h};var m=this;a=void 0!==a?a:1;b=void 0!==b?b:1;c=c||1;d=Math.floor(d)||8;e=Math.floor(e)||1;f=void 0!==f?f:!1;g=void 0!==g?g:0;h=void 0!==h?h:2*Math.PI;var p=[],l=[],v=[],t=[],r=0,u=[],x=c/2,A=0;(function(){var f,k,q=new n,J=new n,B=0,F=(b-a)/c;for(k=0;k<=e;k++){var z=[],C=k/e,E=C*(b-a)+a;for(f=0;f<=d;f++){var G=f/d,I=G*h+g,K=Math.sin(I);I=Math.cos(I);J.x=E*K;J.y=-C*c+x;J.z=E*I;l.push(J.x,J.y,J.z);q.set(K,
F,I).normalize();v.push(q.x,q.y,q.z);t.push(G,1-C);z.push(r++)}u.push(z)}for(f=0;f<d;f++)for(k=0;k<e;k++)q=u[k+1][f],J=u[k+1][f+1],F=u[k][f+1],p.push(u[k][f],q,F),p.push(q,J,F),B+=6;m.addGroup(A,B,0);A+=B})();!1===f&&(0<a&&k(!0),0<b&&k(!1));this.setIndex(p);this.addAttribute("position",new E(l,3));this.addAttribute("normal",new E(v,3));this.addAttribute("uv",new E(t,2))}function dd(a,b,c,d,e,f,g){Fb.call(this,0,a,b,c,d,e,f,g);this.type="ConeGeometry";this.parameters={radius:a,height:b,radialSegments:c,
heightSegments:d,openEnded:e,thetaStart:f,thetaLength:g}}function ed(a,b,c,d,e,f,g){db.call(this,0,a,b,c,d,e,f,g);this.type="ConeBufferGeometry";this.parameters={radius:a,height:b,radialSegments:c,heightSegments:d,openEnded:e,thetaStart:f,thetaLength:g}}function fd(a,b,c,d){N.call(this);this.type="CircleGeometry";this.parameters={radius:a,segments:b,thetaStart:c,thetaLength:d};this.fromBufferGeometry(new jc(a,b,c,d));this.mergeVertices()}function jc(a,b,c,d){z.call(this);this.type="CircleBufferGeometry";
this.parameters={radius:a,segments:b,thetaStart:c,thetaLength:d};a=a||1;b=void 0!==b?Math.max(3,b):8;c=void 0!==c?c:0;d=void 0!==d?d:2*Math.PI;var e=[],f=[],g=[],h=[],k,m=new n,p=new B;f.push(0,0,0);g.push(0,0,1);h.push(.5,.5);var l=0;for(k=3;l<=b;l++,k+=3){var v=c+l/b*d;m.x=a*Math.cos(v);m.y=a*Math.sin(v);f.push(m.x,m.y,m.z);g.push(0,0,1);p.x=(f[k]/a+1)/2;p.y=(f[k+1]/a+1)/2;h.push(p.x,p.y)}for(k=1;k<=b;k++)e.push(k,k+1,0);this.setIndex(e);this.addAttribute("position",new E(f,3));this.addAttribute("normal",
new E(g,3));this.addAttribute("uv",new E(h,2))}function Gb(a){O.call(this);this.type="ShadowMaterial";this.color=new M(0);this.transparent=!0;this.setValues(a)}function kc(a){Ca.call(this,a);this.type="RawShaderMaterial"}function Za(a){O.call(this);this.defines={STANDARD:""};this.type="MeshStandardMaterial";this.color=new M(16777215);this.metalness=this.roughness=.5;this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new M(0);this.emissiveIntensity=
1;this.bumpMap=this.emissiveMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=0;this.normalScale=new B(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.envMap=this.alphaMap=this.metalnessMap=this.roughnessMap=null;this.envMapIntensity=1;this.refractionRatio=.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)}function Hb(a){Za.call(this);
this.defines={PHYSICAL:""};this.type="MeshPhysicalMaterial";this.reflectivity=.5;this.clearCoatRoughness=this.clearCoat=0;this.setValues(a)}function La(a){O.call(this);this.type="MeshPhongMaterial";this.color=new M(16777215);this.specular=new M(1118481);this.shininess=30;this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new M(0);this.emissiveIntensity=1;this.bumpMap=this.emissiveMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=
0;this.normalScale=new B(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.envMap=this.alphaMap=this.specularMap=null;this.combine=0;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)}function Ib(a){La.call(this);this.defines={TOON:""};this.type="MeshToonMaterial";this.gradientMap=null;this.setValues(a)}
function Jb(a){O.call(this);this.type="MeshNormalMaterial";this.bumpMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=0;this.normalScale=new B(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.wireframe=!1;this.wireframeLinewidth=1;this.morphNormals=this.morphTargets=this.skinning=this.lights=this.fog=!1;this.setValues(a)}function Kb(a){O.call(this);this.type="MeshLambertMaterial";this.color=new M(16777215);this.lightMap=this.map=null;this.lightMapIntensity=
1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new M(0);this.emissiveIntensity=1;this.envMap=this.alphaMap=this.specularMap=this.emissiveMap=null;this.combine=0;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)}function Lb(a){O.call(this);this.defines={MATCAP:""};this.type="MeshMatcapMaterial";this.color=new M(16777215);this.bumpMap=
this.map=this.matcap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=0;this.normalScale=new B(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.alphaMap=null;this.lights=this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)}function Mb(a){R.call(this);this.type="LineDashedMaterial";this.scale=1;this.dashSize=3;this.gapSize=1;this.setValues(a)}function Fa(a,b,c,d){this.parameterPositions=a;this._cachedIndex=0;this.resultBuffer=void 0!==
d?d:new b.constructor(c);this.sampleValues=b;this.valueSize=c}function Ed(a,b,c,d){Fa.call(this,a,b,c,d);this._offsetNext=this._weightNext=this._offsetPrev=this._weightPrev=-0}function gd(a,b,c,d){Fa.call(this,a,b,c,d)}function Fd(a,b,c,d){Fa.call(this,a,b,c,d)}function la(a,b,c,d){if(void 0===a)throw Error("THREE.KeyframeTrack: track name is undefined");if(void 0===b||0===b.length)throw Error("THREE.KeyframeTrack: no keyframes in track named "+a);this.name=a;this.times=pa.convertArray(b,this.TimeBufferType);
this.values=pa.convertArray(c,this.ValueBufferType);this.setInterpolation(d||this.DefaultInterpolation)}function Gd(a,b,c){la.call(this,a,b,c)}function Hd(a,b,c,d){la.call(this,a,b,c,d)}function lc(a,b,c,d){la.call(this,a,b,c,d)}function Id(a,b,c,d){Fa.call(this,a,b,c,d)}function hd(a,b,c,d){la.call(this,a,b,c,d)}function Jd(a,b,c,d){la.call(this,a,b,c,d)}function mc(a,b,c,d){la.call(this,a,b,c,d)}function Ia(a,b,c){this.name=a;this.tracks=c;this.duration=void 0!==b?b:-1;this.uuid=K.generateUUID();
0>this.duration&&this.resetDuration()}function ih(a){switch(a.toLowerCase()){case "scalar":case "double":case "float":case "number":case "integer":return lc;case "vector":case "vector2":case "vector3":case "vector4":return mc;case "color":return Hd;case "quaternion":return hd;case "bool":case "boolean":return Gd;case "string":return Jd}throw Error("THREE.KeyframeTrack: Unsupported typeName: "+a);}function jh(a){if(void 0===a.type)throw Error("THREE.KeyframeTrack: track type undefined, can not parse");
var b=ih(a.type);if(void 0===a.times){var c=[],d=[];pa.flattenJSON(a.keys,c,d,"value");a.times=c;a.values=d}return void 0!==b.parse?b.parse(a):new b(a.name,a.times,a.values,a.interpolation)}function le(a,b,c){var d=this,e=!1,f=0,g=0,h=void 0;this.onStart=void 0;this.onLoad=a;this.onProgress=b;this.onError=c;this.itemStart=function(a){g++;if(!1===e&&void 0!==d.onStart)d.onStart(a,f,g);e=!0};this.itemEnd=function(a){f++;if(void 0!==d.onProgress)d.onProgress(a,f,g);if(f===g&&(e=!1,void 0!==d.onLoad))d.onLoad()};
this.itemError=function(a){if(void 0!==d.onError)d.onError(a)};this.resolveURL=function(a){return h?h(a):a};this.setURLModifier=function(a){h=a;return this}}function Ma(a){this.manager=void 0!==a?a:za}function Df(a){this.manager=void 0!==a?a:za}function Ef(a){this.manager=void 0!==a?a:za;this._parser=null}function me(a){this.manager=void 0!==a?a:za;this._parser=null}function id(a){this.manager=void 0!==a?a:za}function ne(a){this.manager=void 0!==a?a:za}function Kd(a){this.manager=void 0!==a?a:za}
function I(){this.type="Curve";this.arcLengthDivisions=200}function Ga(a,b,c,d,e,f,g,h){I.call(this);this.type="EllipseCurve";this.aX=a||0;this.aY=b||0;this.xRadius=c||1;this.yRadius=d||1;this.aStartAngle=e||0;this.aEndAngle=f||2*Math.PI;this.aClockwise=g||!1;this.aRotation=h||0}function nc(a,b,c,d,e,f){Ga.call(this,a,b,c,c,d,e,f);this.type="ArcCurve"}function oe(){var a=0,b=0,c=0,d=0;return{initCatmullRom:function(e,f,g,h,k){e=k*(g-e);h=k*(h-f);a=f;b=e;c=-3*f+3*g-2*e-h;d=2*f-2*g+e+h},initNonuniformCatmullRom:function(e,
f,g,h,k,m,p){e=((f-e)/k-(g-e)/(k+m)+(g-f)/m)*m;h=((g-f)/m-(h-f)/(m+p)+(h-g)/p)*m;a=f;b=e;c=-3*f+3*g-2*e-h;d=2*f-2*g+e+h},calc:function(e){var f=e*e;return a+b*e+c*f+d*f*e}}}function qa(a,b,c,d){I.call(this);this.type="CatmullRomCurve3";this.points=a||[];this.closed=b||!1;this.curveType=c||"centripetal";this.tension=d||.5}function Ff(a,b,c,d,e){b=.5*(d-b);e=.5*(e-c);var f=a*a;return(2*c-2*d+b+e)*a*f+(-3*c+3*d-2*b-e)*f+b*a+c}function jd(a,b,c,d){var e=1-a;return e*e*b+2*(1-a)*a*c+a*a*d}function kd(a,
b,c,d,e){var f=1-a,g=1-a;return f*f*f*b+3*g*g*a*c+3*(1-a)*a*a*d+a*a*a*e}function Na(a,b,c,d){I.call(this);this.type="CubicBezierCurve";this.v0=a||new B;this.v1=b||new B;this.v2=c||new B;this.v3=d||new B}function $a(a,b,c,d){I.call(this);this.type="CubicBezierCurve3";this.v0=a||new n;this.v1=b||new n;this.v2=c||new n;this.v3=d||new n}function xa(a,b){I.call(this);this.type="LineCurve";this.v1=a||new B;this.v2=b||new B}function Oa(a,b){I.call(this);this.type="LineCurve3";this.v1=a||new n;this.v2=b||
new n}function Pa(a,b,c){I.call(this);this.type="QuadraticBezierCurve";this.v0=a||new B;this.v1=b||new B;this.v2=c||new B}function ab(a,b,c){I.call(this);this.type="QuadraticBezierCurve3";this.v0=a||new n;this.v1=b||new n;this.v2=c||new n}function Qa(a){I.call(this);this.type="SplineCurve";this.points=a||[]}function eb(){I.call(this);this.type="CurvePath";this.curves=[];this.autoClose=!1}function Ra(a){eb.call(this);this.type="Path";this.currentPoint=new B;a&&this.setFromPoints(a)}function nb(a){Ra.call(this,
a);this.uuid=K.generateUUID();this.type="Shape";this.holes=[]}function ea(a,b){C.call(this);this.type="Light";this.color=new M(a);this.intensity=void 0!==b?b:1;this.receiveShadow=void 0}function Ld(a,b,c){ea.call(this,a,c);this.type="HemisphereLight";this.castShadow=void 0;this.position.copy(C.DefaultUp);this.updateMatrix();this.groundColor=new M(b)}function Nb(a){this.camera=a;this.bias=0;this.radius=1;this.mapSize=new B(512,512);this.map=null;this.matrix=new P}function Md(){Nb.call(this,new ja(50,
1,.5,500))}function Nd(a,b,c,d,e,f){ea.call(this,a,b);this.type="SpotLight";this.position.copy(C.DefaultUp);this.updateMatrix();this.target=new C;Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(a){this.intensity=a/Math.PI}});this.distance=void 0!==c?c:0;this.angle=void 0!==d?d:Math.PI/3;this.penumbra=void 0!==e?e:0;this.decay=void 0!==f?f:1;this.shadow=new Md}function Od(a,b,c,d){ea.call(this,a,b);this.type="PointLight";Object.defineProperty(this,"power",
{get:function(){return 4*this.intensity*Math.PI},set:function(a){this.intensity=a/(4*Math.PI)}});this.distance=void 0!==c?c:0;this.decay=void 0!==d?d:1;this.shadow=new Nb(new ja(90,1,.5,500))}function ld(a,b,c,d,e,f){Xa.call(this);this.type="OrthographicCamera";this.zoom=1;this.view=null;this.left=void 0!==a?a:-1;this.right=void 0!==b?b:1;this.top=void 0!==c?c:1;this.bottom=void 0!==d?d:-1;this.near=void 0!==e?e:.1;this.far=void 0!==f?f:2E3;this.updateProjectionMatrix()}function Pd(){Nb.call(this,
new ld(-5,5,5,-5,.5,500))}function Qd(a,b){ea.call(this,a,b);this.type="DirectionalLight";this.position.copy(C.DefaultUp);this.updateMatrix();this.target=new C;this.shadow=new Pd}function Rd(a,b){ea.call(this,a,b);this.type="AmbientLight";this.castShadow=void 0}function Sd(a,b,c,d){ea.call(this,a,b);this.type="RectAreaLight";this.width=void 0!==c?c:10;this.height=void 0!==d?d:10}function Td(a){this.manager=void 0!==a?a:za;this.textures={}}function pe(a){this.manager=void 0!==a?a:za}function qe(a){this.manager=
void 0!==a?a:za;this.resourcePath=""}function re(a){"undefined"===typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported.");"undefined"===typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported.");this.manager=void 0!==a?a:za;this.options=void 0}function se(){this.type="ShapePath";this.color=new M;this.subPaths=[];this.currentPath=null}function te(a){this.type="Font";this.data=a}function Gf(a){this.manager=void 0!==a?a:za}function md(){}
function ue(a){this.manager=void 0!==a?a:za}function Hf(){this.type="StereoCamera";this.aspect=1;this.eyeSep=.064;this.cameraL=new ja;this.cameraL.layers.enable(1);this.cameraL.matrixAutoUpdate=!1;this.cameraR=new ja;this.cameraR.layers.enable(2);this.cameraR.matrixAutoUpdate=!1}function nd(a,b,c,d){C.call(this);this.type="CubeCamera";var e=new ja(90,1,a,b);e.up.set(0,-1,0);e.lookAt(new n(1,0,0));this.add(e);var f=new ja(90,1,a,b);f.up.set(0,-1,0);f.lookAt(new n(-1,0,0));this.add(f);var g=new ja(90,
1,a,b);g.up.set(0,0,1);g.lookAt(new n(0,1,0));this.add(g);var h=new ja(90,1,a,b);h.up.set(0,0,-1);h.lookAt(new n(0,-1,0));this.add(h);var k=new ja(90,1,a,b);k.up.set(0,-1,0);k.lookAt(new n(0,0,1));this.add(k);var m=new ja(90,1,a,b);m.up.set(0,-1,0);m.lookAt(new n(0,0,-1));this.add(m);d=d||{format:1022,magFilter:1006,minFilter:1006};this.renderTarget=new pb(c,c,d);this.renderTarget.texture.name="CubeCamera";this.update=function(a,b){null===this.parent&&this.updateMatrixWorld();var c=a.getRenderTarget(),
d=this.renderTarget,p=d.texture.generateMipmaps;d.texture.generateMipmaps=!1;a.setRenderTarget(d,0);a.render(b,e);a.setRenderTarget(d,1);a.render(b,f);a.setRenderTarget(d,2);a.render(b,g);a.setRenderTarget(d,3);a.render(b,h);a.setRenderTarget(d,4);a.render(b,k);d.texture.generateMipmaps=p;a.setRenderTarget(d,5);a.render(b,m);a.setRenderTarget(c)};this.clear=function(a,b,c,d){for(var e=a.getRenderTarget(),f=this.renderTarget,g=0;6>g;g++)a.setRenderTarget(f,g),a.clear(b,c,d);a.setRenderTarget(e)}}function ve(a){this.autoStart=
void 0!==a?a:!0;this.elapsedTime=this.oldTime=this.startTime=0;this.running=!1}function we(){C.call(this);this.type="AudioListener";this.context=xe.getContext();this.gain=this.context.createGain();this.gain.connect(this.context.destination);this.filter=null;this.timeDelta=0}function oc(a){C.call(this);this.type="Audio";this.listener=a;this.context=a.context;this.gain=this.context.createGain();this.gain.connect(a.getInput());this.autoplay=!1;this.buffer=null;this.detune=0;this.loop=!1;this.offset=
this.startTime=0;this.playbackRate=1;this.isPlaying=!1;this.hasPlaybackControl=!0;this.sourceType="empty";this.filters=[]}function ye(a){oc.call(this,a);this.panner=this.context.createPanner();this.panner.connect(this.gain)}function ze(a,b){this.analyser=a.context.createAnalyser();this.analyser.fftSize=void 0!==b?b:2048;this.data=new Uint8Array(this.analyser.frequencyBinCount);a.getOutput().connect(this.analyser)}function Ae(a,b,c){this.binding=a;this.valueSize=c;a=Float64Array;switch(b){case "quaternion":b=
this._slerp;break;case "string":case "bool":a=Array;b=this._select;break;default:b=this._lerp}this.buffer=new a(4*c);this._mixBufferRegion=b;this.referenceCount=this.useCount=this.cumulativeWeight=0}function If(a,b,c){c=c||ma.parseTrackName(b);this._targetGroup=a;this._bindings=a.subscribe_(b,c)}function ma(a,b,c){this.path=b;this.parsedPath=c||ma.parseTrackName(b);this.node=ma.findNode(a,this.parsedPath.nodeName)||a;this.rootNode=a}function Jf(){this.uuid=K.generateUUID();this._objects=Array.prototype.slice.call(arguments);
this.nCachedObjects_=0;var a={};this._indicesByUUID=a;for(var b=0,c=arguments.length;b!==c;++b)a[arguments[b].uuid]=b;this._paths=[];this._parsedPaths=[];this._bindings=[];this._bindingsIndicesByPath={};var d=this;this.stats={objects:{get total(){return d._objects.length},get inUse(){return this.total-d.nCachedObjects_}},get bindingsPerObject(){return d._bindings.length}}}function Kf(a,b,c){this._mixer=a;this._clip=b;this._localRoot=c||null;a=b.tracks;b=a.length;c=Array(b);for(var d={endingStart:2400,
endingEnd:2400},e=0;e!==b;++e){var f=a[e].createInterpolant(null);c[e]=f;f.settings=d}this._interpolantSettings=d;this._interpolants=c;this._propertyBindings=Array(b);this._weightInterpolant=this._timeScaleInterpolant=this._byClipCacheIndex=this._cacheIndex=null;this.loop=2201;this._loopCount=-1;this._startTime=null;this.time=0;this._effectiveWeight=this.weight=this._effectiveTimeScale=this.timeScale=1;this.repetitions=Infinity;this.paused=!1;this.enabled=!0;this.clampWhenFinished=!1;this.zeroSlopeAtEnd=
this.zeroSlopeAtStart=!0}function Be(a){this._root=a;this._initMemoryManager();this.time=this._accuIndex=0;this.timeScale=1}function Ud(a,b){"string"===typeof a&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),a=b);this.value=a}function Ce(){z.call(this);this.type="InstancedBufferGeometry";this.maxInstancedCount=void 0}function De(a,b,c){xb.call(this,a,b);this.meshPerAttribute=c||1}function Ee(a,b,c,d){"number"===typeof c&&(d=c,c=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument."));
S.call(this,a,b,c);this.meshPerAttribute=d||1}function Lf(a,b,c,d){this.ray=new wb(a,b);this.near=c||0;this.far=d||Infinity;this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}};Object.defineProperties(this.params,{PointCloud:{get:function(){console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points.");return this.Points}}})}function Mf(a,b){return a.distance-b.distance}function Fe(a,b,c,d){if(!1!==a.visible&&(a.raycast(b,c),!0===d)){a=a.children;d=0;for(var e=
a.length;d<e;d++)Fe(a[d],b,c,!0)}}function Nf(a,b,c){this.radius=void 0!==a?a:1;this.phi=void 0!==b?b:0;this.theta=void 0!==c?c:0;return this}function Of(a,b,c){this.radius=void 0!==a?a:1;this.theta=void 0!==b?b:0;this.y=void 0!==c?c:0;return this}function Ge(a,b){this.min=void 0!==a?a:new B(Infinity,Infinity);this.max=void 0!==b?b:new B(-Infinity,-Infinity)}function He(a,b){this.start=void 0!==a?a:new n;this.end=void 0!==b?b:new n}function od(a){C.call(this);this.material=a;this.render=function(){}}
function pd(a,b,c,d){this.object=a;this.size=void 0!==b?b:1;a=void 0!==c?c:16711680;d=void 0!==d?d:1;b=0;(c=this.object.geometry)&&c.isGeometry?b=3*c.faces.length:c&&c.isBufferGeometry&&(b=c.attributes.normal.count);c=new z;b=new E(6*b,3);c.addAttribute("position",b);V.call(this,c,new R({color:a,linewidth:d}));this.matrixAutoUpdate=!1;this.update()}function pc(a,b){C.call(this);this.light=a;this.light.updateMatrixWorld();this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.color=b;a=new z;b=[0,
0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(var c=0,d=1;32>c;c++,d++){var e=c/32*Math.PI*2,f=d/32*Math.PI*2;b.push(Math.cos(e),Math.sin(e),1,Math.cos(f),Math.sin(f),1)}a.addAttribute("position",new E(b,3));b=new R({fog:!1});this.cone=new V(a,b);this.add(this.cone);this.update()}function Pf(a){var b=[];a&&a.isBone&&b.push(a);for(var c=0;c<a.children.length;c++)b.push.apply(b,Pf(a.children[c]));return b}function qc(a){for(var b=Pf(a),c=new z,d=[],e=[],f=new M(0,0,1),g=new M(0,1,
0),h=0;h<b.length;h++){var k=b[h];k.parent&&k.parent.isBone&&(d.push(0,0,0),d.push(0,0,0),e.push(f.r,f.g,f.b),e.push(g.r,g.g,g.b))}c.addAttribute("position",new E(d,3));c.addAttribute("color",new E(e,3));d=new R({vertexColors:2,depthTest:!1,depthWrite:!1,transparent:!0});V.call(this,c,d);this.root=a;this.bones=b;this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1}function rc(a,b,c){this.light=a;this.light.updateMatrixWorld();this.color=c;a=new Cb(b,4,2);b=new Da({wireframe:!0,fog:!1});va.call(this,
a,b);this.matrix=this.light.matrixWorld;this.matrixAutoUpdate=!1;this.update()}function sc(a,b){this.type="RectAreaLightHelper";this.light=a;this.color=b;a=new z;a.addAttribute("position",new E([1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3));a.computeBoundingSphere();b=new R({fog:!1});oa.call(this,a,b);a=new z;a.addAttribute("position",new E([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3));a.computeBoundingSphere();this.add(new va(a,new Da({side:1,fog:!1})));this.update()}function tc(a,b,c){C.call(this);this.light=
a;this.light.updateMatrixWorld();this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.color=c;a=new yb(b);a.rotateY(.5*Math.PI);this.material=new Da({wireframe:!0,fog:!1});void 0===this.color&&(this.material.vertexColors=2);b=a.getAttribute("position");b=new Float32Array(3*b.count);a.addAttribute("color",new S(b,3));this.add(new va(a,this.material));this.update()}function Vd(a,b,c,d){a=a||10;b=b||10;c=new M(void 0!==c?c:4473924);d=new M(void 0!==d?d:8947848);var e=b/2,f=a/b,g=a/2;a=[];for(var h=
[],k=0,m=0,p=-g;k<=b;k++,p+=f){a.push(-g,0,p,g,0,p);a.push(p,0,-g,p,0,g);var l=k===e?c:d;l.toArray(h,m);m+=3;l.toArray(h,m);m+=3;l.toArray(h,m);m+=3;l.toArray(h,m);m+=3}b=new z;b.addAttribute("position",new E(a,3));b.addAttribute("color",new E(h,3));c=new R({vertexColors:2});V.call(this,b,c)}function Wd(a,b,c,d,e,f){a=a||10;b=b||16;c=c||8;d=d||64;e=new M(void 0!==e?e:4473924);f=new M(void 0!==f?f:8947848);var g=[],h=[],k;for(k=0;k<=b;k++){var m=k/b*2*Math.PI;var p=Math.sin(m)*a;m=Math.cos(m)*a;g.push(0,
0,0);g.push(p,0,m);var l=k&1?e:f;h.push(l.r,l.g,l.b);h.push(l.r,l.g,l.b)}for(k=0;k<=c;k++){l=k&1?e:f;var n=a-a/c*k;for(b=0;b<d;b++)m=b/d*2*Math.PI,p=Math.sin(m)*n,m=Math.cos(m)*n,g.push(p,0,m),h.push(l.r,l.g,l.b),m=(b+1)/d*2*Math.PI,p=Math.sin(m)*n,m=Math.cos(m)*n,g.push(p,0,m),h.push(l.r,l.g,l.b)}a=new z;a.addAttribute("position",new E(g,3));a.addAttribute("color",new E(h,3));g=new R({vertexColors:2});V.call(this,a,g)}function uc(a,b,c,d){this.audio=a;this.range=b||1;this.divisionsInnerAngle=c||
16;this.divisionsOuterAngle=d||2;a=new z;b=new Float32Array(3*(3*(this.divisionsInnerAngle+2*this.divisionsOuterAngle)+3));a.addAttribute("position",new S(b,3));b=new R({color:65280});c=new R({color:16776960});oa.call(this,a,[c,b]);this.update()}function qd(a,b,c,d){this.object=a;this.size=void 0!==b?b:1;a=void 0!==c?c:16776960;d=void 0!==d?d:1;b=0;(c=this.object.geometry)&&c.isGeometry?b=c.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");
c=new z;b=new E(6*b,3);c.addAttribute("position",b);V.call(this,c,new R({color:a,linewidth:d}));this.matrixAutoUpdate=!1;this.update()}function vc(a,b,c){C.call(this);this.light=a;this.light.updateMatrixWorld();this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.color=c;void 0===b&&(b=1);a=new z;a.addAttribute("position",new E([-b,b,0,b,b,0,b,-b,0,-b,-b,0,-b,b,0],3));b=new R({fog:!1});this.lightPlane=new oa(a,b);this.add(this.lightPlane);a=new z;a.addAttribute("position",new E([0,0,0,0,0,1],3));
this.targetLine=new oa(a,b);this.add(this.targetLine);this.update()}function rd(a){function b(a,b,d){c(a,d);c(b,d)}function c(a,b){f.push(0,0,0);g.push(b.r,b.g,b.b);void 0===h[a]&&(h[a]=[]);h[a].push(f.length/3-1)}var d=new z,e=new R({color:16777215,vertexColors:1}),f=[],g=[],h={},k=new M(16755200),m=new M(16711680),p=new M(43775),l=new M(16777215),n=new M(3355443);b("n1","n2",k);b("n2","n4",k);b("n4","n3",k);b("n3","n1",k);b("f1","f2",k);b("f2","f4",k);b("f4","f3",k);b("f3","f1",k);b("n1","f1",k);
b("n2","f2",k);b("n3","f3",k);b("n4","f4",k);b("p","n1",m);b("p","n2",m);b("p","n3",m);b("p","n4",m);b("u1","u2",p);b("u2","u3",p);b("u3","u1",p);b("c","t",l);b("p","c",n);b("cn1","cn2",n);b("cn3","cn4",n);b("cf1","cf2",n);b("cf3","cf4",n);d.addAttribute("position",new E(f,3));d.addAttribute("color",new E(g,3));V.call(this,d,e);this.camera=a;this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix();this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.pointMap=h;this.update()}function fb(a,
b){this.object=a;void 0===b&&(b=16776960);a=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var c=new Float32Array(24),d=new z;d.setIndex(new S(a,1));d.addAttribute("position",new S(c,3));V.call(this,d,new R({color:b}));this.matrixAutoUpdate=!1;this.update()}function sd(a,b){this.type="Box3Helper";this.box=a;a=void 0!==b?b:16776960;b=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var c=new z;c.setIndex(new S(b,1));c.addAttribute("position",new E([1,1,1,-1,1,
1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3));V.call(this,c,new R({color:a}));this.geometry.computeBoundingSphere()}function td(a,b,c){this.type="PlaneHelper";this.plane=a;this.size=void 0===b?1:b;a=void 0!==c?c:16776960;b=new z;b.addAttribute("position",new E([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3));b.computeBoundingSphere();oa.call(this,b,new R({color:a}));b=new z;b.addAttribute("position",new E([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3));b.computeBoundingSphere();
this.add(new va(b,new Da({color:a,opacity:.2,transparent:!0,depthWrite:!1})))}function gb(a,b,c,d,e,f){C.call(this);void 0===a&&(a=new n(0,0,1));void 0===b&&(b=new n(0,0,0));void 0===c&&(c=1);void 0===d&&(d=16776960);void 0===e&&(e=.2*c);void 0===f&&(f=.2*e);void 0===Xd&&(Xd=new z,Xd.addAttribute("position",new E([0,0,0,0,1,0],3)),Ie=new db(0,.5,1,5,1),Ie.translate(0,-.5,0));this.position.copy(b);this.line=new oa(Xd,new R({color:d}));this.line.matrixAutoUpdate=!1;this.add(this.line);this.cone=new va(Ie,
new Da({color:d}));this.cone.matrixAutoUpdate=!1;this.add(this.cone);this.setDirection(a);this.setLength(c,e,f)}function ud(a){a=a||1;var b=[0,0,0,a,0,0,0,0,0,0,a,0,0,0,0,0,0,a];a=new z;a.addAttribute("position",new E(b,3));a.addAttribute("color",new E([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));b=new R({vertexColors:2});V.call(this,a,b)}function Qf(a){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead.");qa.call(this,a);this.type="catmullrom";this.closed=
!0}function Rf(a){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead.");qa.call(this,a);this.type="catmullrom"}function Je(a){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead.");qa.call(this,a);this.type="catmullrom"}void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52));void 0===Number.isInteger&&(Number.isInteger=function(a){return"number"===typeof a&&isFinite(a)&&Math.floor(a)===a});void 0===Math.sign&&(Math.sign=function(a){return 0>
a?-1:0<a?1:+a});!1==="name"in Function.prototype&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}});void 0===Object.assign&&function(){Object.assign=function(a){if(void 0===a||null===a)throw new TypeError("Cannot convert undefined or null to object");for(var b=Object(a),c=1;c<arguments.length;c++){var d=arguments[c];if(void 0!==d&&null!==d)for(var e in d)Object.prototype.hasOwnProperty.call(d,e)&&(b[e]=d[e])}return b}}();
Object.assign(ta.prototype,{addEventListener:function(a,b){void 0===this._listeners&&(this._listeners={});var c=this._listeners;void 0===c[a]&&(c[a]=[]);-1===c[a].indexOf(b)&&c[a].push(b)},hasEventListener:function(a,b){if(void 0===this._listeners)return!1;var c=this._listeners;return void 0!==c[a]&&-1!==c[a].indexOf(b)},removeEventListener:function(a,b){void 0!==this._listeners&&(a=this._listeners[a],void 0!==a&&(b=a.indexOf(b),-1!==b&&a.splice(b,1)))},dispatchEvent:function(a){if(void 0!==this._listeners){var b=
this._listeners[a.type];if(void 0!==b){a.target=this;b=b.slice(0);for(var c=0,d=b.length;c<d;c++)b[c].call(this,a)}}}});var K={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var a=[],b=0;256>b;b++)a[b]=(16>b?"0":"")+b.toString(16);return function(){var b=4294967295*Math.random()|0,d=4294967295*Math.random()|0,e=4294967295*Math.random()|0,f=4294967295*Math.random()|0;return(a[b&255]+a[b>>8&255]+a[b>>16&255]+a[b>>24&255]+"-"+a[d&255]+a[d>>8&255]+"-"+a[d>>16&15|64]+a[d>>24&255]+
"-"+a[e&63|128]+a[e>>8&255]+"-"+a[e>>16&255]+a[e>>24&255]+a[f&255]+a[f>>8&255]+a[f>>16&255]+a[f>>24&255]).toUpperCase()}}(),clamp:function(a,b,c){return Math.max(b,Math.min(c,a))},euclideanModulo:function(a,b){return(a%b+b)%b},mapLinear:function(a,b,c,d,e){return d+(a-b)*(e-d)/(c-b)},lerp:function(a,b,c){return(1-c)*a+c*b},smoothstep:function(a,b,c){if(a<=b)return 0;if(a>=c)return 1;a=(a-b)/(c-b);return a*a*(3-2*a)},smootherstep:function(a,b,c){if(a<=b)return 0;if(a>=c)return 1;a=(a-b)/(c-b);return a*
a*a*(a*(6*a-15)+10)},randInt:function(a,b){return a+Math.floor(Math.random()*(b-a+1))},randFloat:function(a,b){return a+Math.random()*(b-a)},randFloatSpread:function(a){return a*(.5-Math.random())},degToRad:function(a){return a*K.DEG2RAD},radToDeg:function(a){return a*K.RAD2DEG},isPowerOfTwo:function(a){return 0===(a&a-1)&&0!==a},ceilPowerOfTwo:function(a){return Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},floorPowerOfTwo:function(a){return Math.pow(2,Math.floor(Math.log(a)/Math.LN2))}};Object.defineProperties(B.prototype,
{width:{get:function(){return this.x},set:function(a){this.x=a}},height:{get:function(){return this.y},set:function(a){this.y=a}}});Object.assign(B.prototype,{isVector2:!0,set:function(a,b){this.x=a;this.y=b;return this},setScalar:function(a){this.y=this.x=a;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;default:throw Error("index is out of range: "+a);}return this},getComponent:function(a){switch(a){case 0:return this.x;
case 1:return this.y;default:throw Error("index is out of range: "+a);}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(a){this.x=a.x;this.y=a.y;return this},add:function(a,b){if(void 0!==b)return console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;return this},addScalar:function(a){this.x+=a;this.y+=a;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;return this},
addScaledVector:function(a,b){this.x+=a.x*b;this.y+=a.y*b;return this},sub:function(a,b){if(void 0!==b)return console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=a.y;return this},subScalar:function(a){this.x-=a;this.y-=a;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;return this},multiply:function(a){this.x*=a.x;this.y*=a.y;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;return this},
divide:function(a){this.x/=a.x;this.y/=a.y;return this},divideScalar:function(a){return this.multiplyScalar(1/a)},applyMatrix3:function(a){var b=this.x,c=this.y;a=a.elements;this.x=a[0]*b+a[3]*c+a[6];this.y=a[1]*b+a[4]*c+a[7];return this},min:function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);return this},max:function(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);return this},clamp:function(a,b){this.x=Math.max(a.x,Math.min(b.x,this.x));this.y=Math.max(a.y,Math.min(b.y,
this.y));return this},clampScalar:function(){var a=new B,b=new B;return function(c,d){a.set(c,c);b.set(d,d);return this.clamp(a,b)}}(),clampLength:function(a,b){var c=this.length();return this.divideScalar(c||1).multiplyScalar(Math.max(a,Math.min(b,c)))},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this},roundToZero:function(){this.x=
0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);return this},negate:function(){this.x=-this.x;this.y=-this.y;return this},dot:function(a){return this.x*a.x+this.y*a.y},cross:function(a){return this.x*a.y-this.y*a.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||
1)},angle:function(){var a=Math.atan2(this.y,this.x);0>a&&(a+=2*Math.PI);return a},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x;a=this.y-a.y;return b*b+a*a},manhattanDistanceTo:function(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)},setLength:function(a){return this.normalize().multiplyScalar(a)},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;return this},lerpVectors:function(a,b,c){return this.subVectors(b,
a).multiplyScalar(c).add(a)},equals:function(a){return a.x===this.x&&a.y===this.y},fromArray:function(a,b){void 0===b&&(b=0);this.x=a[b];this.y=a[b+1];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this.x;a[b+1]=this.y;return a},fromBufferAttribute:function(a,b,c){void 0!==c&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute().");this.x=a.getX(b);this.y=a.getY(b);return this},rotateAround:function(a,b){var c=Math.cos(b);b=Math.sin(b);var d=
this.x-a.x,e=this.y-a.y;this.x=d*c-e*b+a.x;this.y=d*b+e*c+a.y;return this}});Object.assign(aa,{slerp:function(a,b,c,d){return c.copy(a).slerp(b,d)},slerpFlat:function(a,b,c,d,e,f,g){var h=c[d+0],k=c[d+1],m=c[d+2];c=c[d+3];d=e[f+0];var p=e[f+1],l=e[f+2];e=e[f+3];if(c!==e||h!==d||k!==p||m!==l){f=1-g;var n=h*d+k*p+m*l+c*e,t=0<=n?1:-1,r=1-n*n;r>Number.EPSILON&&(r=Math.sqrt(r),n=Math.atan2(r,n*t),f=Math.sin(f*n)/r,g=Math.sin(g*n)/r);t*=g;h=h*f+d*t;k=k*f+p*t;m=m*f+l*t;c=c*f+e*t;f===1-g&&(g=1/Math.sqrt(h*
h+k*k+m*m+c*c),h*=g,k*=g,m*=g,c*=g)}a[b]=h;a[b+1]=k;a[b+2]=m;a[b+3]=c}});Object.defineProperties(aa.prototype,{x:{get:function(){return this._x},set:function(a){this._x=a;this.onChangeCallback()}},y:{get:function(){return this._y},set:function(a){this._y=a;this.onChangeCallback()}},z:{get:function(){return this._z},set:function(a){this._z=a;this.onChangeCallback()}},w:{get:function(){return this._w},set:function(a){this._w=a;this.onChangeCallback()}}});Object.assign(aa.prototype,{isQuaternion:!0,
set:function(a,b,c,d){this._x=a;this._y=b;this._z=c;this._w=d;this.onChangeCallback();return this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(a){this._x=a.x;this._y=a.y;this._z=a.z;this._w=a.w;this.onChangeCallback();return this},setFromEuler:function(a,b){if(!a||!a.isEuler)throw Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var c=a._x,d=a._y,e=a._z;a=a.order;var f=Math.cos,g=Math.sin,h=f(c/
2),k=f(d/2);f=f(e/2);c=g(c/2);d=g(d/2);e=g(e/2);"XYZ"===a?(this._x=c*k*f+h*d*e,this._y=h*d*f-c*k*e,this._z=h*k*e+c*d*f,this._w=h*k*f-c*d*e):"YXZ"===a?(this._x=c*k*f+h*d*e,this._y=h*d*f-c*k*e,this._z=h*k*e-c*d*f,this._w=h*k*f+c*d*e):"ZXY"===a?(this._x=c*k*f-h*d*e,this._y=h*d*f+c*k*e,this._z=h*k*e+c*d*f,this._w=h*k*f-c*d*e):"ZYX"===a?(this._x=c*k*f-h*d*e,this._y=h*d*f+c*k*e,this._z=h*k*e-c*d*f,this._w=h*k*f+c*d*e):"YZX"===a?(this._x=c*k*f+h*d*e,this._y=h*d*f+c*k*e,this._z=h*k*e-c*d*f,this._w=h*k*f-
c*d*e):"XZY"===a&&(this._x=c*k*f-h*d*e,this._y=h*d*f-c*k*e,this._z=h*k*e+c*d*f,this._w=h*k*f+c*d*e);if(!1!==b)this.onChangeCallback();return this},setFromAxisAngle:function(a,b){b/=2;var c=Math.sin(b);this._x=a.x*c;this._y=a.y*c;this._z=a.z*c;this._w=Math.cos(b);this.onChangeCallback();return this},setFromRotationMatrix:function(a){var b=a.elements,c=b[0];a=b[4];var d=b[8],e=b[1],f=b[5],g=b[9],h=b[2],k=b[6];b=b[10];var m=c+f+b;0<m?(c=.5/Math.sqrt(m+1),this._w=.25/c,this._x=(k-g)*c,this._y=(d-h)*c,
this._z=(e-a)*c):c>f&&c>b?(c=2*Math.sqrt(1+c-f-b),this._w=(k-g)/c,this._x=.25*c,this._y=(a+e)/c,this._z=(d+h)/c):f>b?(c=2*Math.sqrt(1+f-c-b),this._w=(d-h)/c,this._x=(a+e)/c,this._y=.25*c,this._z=(g+k)/c):(c=2*Math.sqrt(1+b-c-f),this._w=(e-a)/c,this._x=(d+h)/c,this._y=(g+k)/c,this._z=.25*c);this.onChangeCallback();return this},setFromUnitVectors:function(a,b){var c=a.dot(b)+1;1E-6>c?(c=0,Math.abs(a.x)>Math.abs(a.z)?(this._x=-a.y,this._y=a.x,this._z=0):(this._x=0,this._y=-a.z,this._z=a.y)):(this._x=
a.y*b.z-a.z*b.y,this._y=a.z*b.x-a.x*b.z,this._z=a.x*b.y-a.y*b.x);this._w=c;return this.normalize()},angleTo:function(a){return 2*Math.acos(Math.abs(K.clamp(this.dot(a),-1,1)))},rotateTowards:function(a,b){var c=this.angleTo(a);if(0===c)return this;this.slerp(a,Math.min(1,b/c));return this},inverse:function(){return this.conjugate()},conjugate:function(){this._x*=-1;this._y*=-1;this._z*=-1;this.onChangeCallback();return this},dot:function(a){return this._x*a._x+this._y*a._y+this._z*a._z+this._w*a._w},
lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var a=this.length();0===a?(this._z=this._y=this._x=0,this._w=1):(a=1/a,this._x*=a,this._y*=a,this._z*=a,this._w*=a);this.onChangeCallback();return this},multiply:function(a,b){return void 0!==b?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),
this.multiplyQuaternions(a,b)):this.multiplyQuaternions(this,a)},premultiply:function(a){return this.multiplyQuaternions(a,this)},multiplyQuaternions:function(a,b){var c=a._x,d=a._y,e=a._z;a=a._w;var f=b._x,g=b._y,h=b._z;b=b._w;this._x=c*b+a*f+d*h-e*g;this._y=d*b+a*g+e*f-c*h;this._z=e*b+a*h+c*g-d*f;this._w=a*b-c*f-d*g-e*h;this.onChangeCallback();return this},slerp:function(a,b){if(0===b)return this;if(1===b)return this.copy(a);var c=this._x,d=this._y,e=this._z,f=this._w,g=f*a._w+c*a._x+d*a._y+e*a._z;
0>g?(this._w=-a._w,this._x=-a._x,this._y=-a._y,this._z=-a._z,g=-g):this.copy(a);if(1<=g)return this._w=f,this._x=c,this._y=d,this._z=e,this;a=1-g*g;if(a<=Number.EPSILON)return g=1-b,this._w=g*f+b*this._w,this._x=g*c+b*this._x,this._y=g*d+b*this._y,this._z=g*e+b*this._z,this.normalize();a=Math.sqrt(a);var h=Math.atan2(a,g);g=Math.sin((1-b)*h)/a;b=Math.sin(b*h)/a;this._w=f*g+this._w*b;this._x=c*g+this._x*b;this._y=d*g+this._y*b;this._z=e*g+this._z*b;this.onChangeCallback();return this},equals:function(a){return a._x===
this._x&&a._y===this._y&&a._z===this._z&&a._w===this._w},fromArray:function(a,b){void 0===b&&(b=0);this._x=a[b];this._y=a[b+1];this._z=a[b+2];this._w=a[b+3];this.onChangeCallback();return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this._x;a[b+1]=this._y;a[b+2]=this._z;a[b+3]=this._w;return a},onChange:function(a){this.onChangeCallback=a;return this},onChangeCallback:function(){}});Object.assign(n.prototype,{isVector3:!0,set:function(a,b,c){this.x=a;this.y=b;this.z=c;return this},
setScalar:function(a){this.z=this.y=this.x=a;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;default:throw Error("index is out of range: "+a);}return this},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+a);}},clone:function(){return new this.constructor(this.x,
this.y,this.z)},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this},add:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;return this},addScaledVector:function(a,b){this.x+=a.x*b;this.y+=a.y*b;this.z+=
a.z*b;return this},sub:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;return this},subScalar:function(a){this.x-=a;this.y-=a;this.z-=a;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;return this},multiply:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),
this.multiplyVectors(a,b);this.x*=a.x;this.y*=a.y;this.z*=a.z;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=a;return this},multiplyVectors:function(a,b){this.x=a.x*b.x;this.y=a.y*b.y;this.z=a.z*b.z;return this},applyEuler:function(){var a=new aa;return function(b){b&&b.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order.");return this.applyQuaternion(a.setFromEuler(b))}}(),applyAxisAngle:function(){var a=new aa;return function(b,
c){return this.applyQuaternion(a.setFromAxisAngle(b,c))}}(),applyMatrix3:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;this.x=a[0]*b+a[3]*c+a[6]*d;this.y=a[1]*b+a[4]*c+a[7]*d;this.z=a[2]*b+a[5]*c+a[8]*d;return this},applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;var e=1/(a[3]*b+a[7]*c+a[11]*d+a[15]);this.x=(a[0]*b+a[4]*c+a[8]*d+a[12])*e;this.y=(a[1]*b+a[5]*c+a[9]*d+a[13])*e;this.z=(a[2]*b+a[6]*c+a[10]*d+a[14])*e;return this},applyQuaternion:function(a){var b=this.x,
c=this.y,d=this.z,e=a.x,f=a.y,g=a.z;a=a.w;var h=a*b+f*d-g*c,k=a*c+g*b-e*d,m=a*d+e*c-f*b;b=-e*b-f*c-g*d;this.x=h*a+b*-e+k*-g-m*-f;this.y=k*a+b*-f+m*-e-h*-g;this.z=m*a+b*-g+h*-f-k*-e;return this},project:function(a){return this.applyMatrix4(a.matrixWorldInverse).applyMatrix4(a.projectionMatrix)},unproject:function(a){return this.applyMatrix4(a.projectionMatrixInverse).applyMatrix4(a.matrixWorld)},transformDirection:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d;
this.y=a[1]*b+a[5]*c+a[9]*d;this.z=a[2]*b+a[6]*c+a[10]*d;return this.normalize()},divide:function(a){this.x/=a.x;this.y/=a.y;this.z/=a.z;return this},divideScalar:function(a){return this.multiplyScalar(1/a)},min:function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);this.z=Math.min(this.z,a.z);return this},max:function(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);this.z=Math.max(this.z,a.z);return this},clamp:function(a,b){this.x=Math.max(a.x,Math.min(b.x,this.x));this.y=
Math.max(a.y,Math.min(b.y,this.y));this.z=Math.max(a.z,Math.min(b.z,this.z));return this},clampScalar:function(){var a=new n,b=new n;return function(c,d){a.set(c,c,c);b.set(d,d,d);return this.clamp(a,b)}}(),clampLength:function(a,b){var c=this.length();return this.divideScalar(c||1).multiplyScalar(Math.max(a,Math.min(b,c)))},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);
this.z=Math.ceil(this.z);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;return this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},lengthSq:function(){return this.x*
this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(a){return this.normalize().multiplyScalar(a)},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;return this},lerpVectors:function(a,b,c){return this.subVectors(b,a).multiplyScalar(c).add(a)},
cross:function(a,b){return void 0!==b?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(a,b)):this.crossVectors(this,a)},crossVectors:function(a,b){var c=a.x,d=a.y;a=a.z;var e=b.x,f=b.y;b=b.z;this.x=d*b-a*f;this.y=a*e-c*b;this.z=c*f-d*e;return this},projectOnVector:function(a){var b=a.dot(this)/a.lengthSq();return this.copy(a).multiplyScalar(b)},projectOnPlane:function(){var a=new n;return function(b){a.copy(this).projectOnVector(b);
return this.sub(a)}}(),reflect:function(){var a=new n;return function(b){return this.sub(a.copy(b).multiplyScalar(2*this.dot(b)))}}(),angleTo:function(a){a=this.dot(a)/Math.sqrt(this.lengthSq()*a.lengthSq());return Math.acos(K.clamp(a,-1,1))},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,c=this.y-a.y;a=this.z-a.z;return b*b+c*c+a*a},manhattanDistanceTo:function(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)+Math.abs(this.z-
a.z)},setFromSpherical:function(a){return this.setFromSphericalCoords(a.radius,a.phi,a.theta)},setFromSphericalCoords:function(a,b,c){var d=Math.sin(b)*a;this.x=d*Math.sin(c);this.y=Math.cos(b)*a;this.z=d*Math.cos(c);return this},setFromCylindrical:function(a){return this.setFromCylindricalCoords(a.radius,a.theta,a.y)},setFromCylindricalCoords:function(a,b,c){this.x=a*Math.sin(b);this.y=c;this.z=a*Math.cos(b);return this},setFromMatrixPosition:function(a){a=a.elements;this.x=a[12];this.y=a[13];this.z=
a[14];return this},setFromMatrixScale:function(a){var b=this.setFromMatrixColumn(a,0).length(),c=this.setFromMatrixColumn(a,1).length();a=this.setFromMatrixColumn(a,2).length();this.x=b;this.y=c;this.z=a;return this},setFromMatrixColumn:function(a,b){return this.fromArray(a.elements,4*b)},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},fromArray:function(a,b){void 0===b&&(b=0);this.x=a[b];this.y=a[b+1];this.z=a[b+2];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===
b&&(b=0);a[b]=this.x;a[b+1]=this.y;a[b+2]=this.z;return a},fromBufferAttribute:function(a,b,c){void 0!==c&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute().");this.x=a.getX(b);this.y=a.getY(b);this.z=a.getZ(b);return this}});Object.assign(ba.prototype,{isMatrix3:!0,set:function(a,b,c,d,e,f,g,h,k){var m=this.elements;m[0]=a;m[1]=d;m[2]=g;m[3]=b;m[4]=e;m[5]=h;m[6]=c;m[7]=f;m[8]=k;return this},identity:function(){this.set(1,0,0,0,1,0,0,0,1);return this},clone:function(){return(new this.constructor).fromArray(this.elements)},
copy:function(a){var b=this.elements;a=a.elements;b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return this},setFromMatrix4:function(a){a=a.elements;this.set(a[0],a[4],a[8],a[1],a[5],a[9],a[2],a[6],a[10]);return this},applyToBufferAttribute:function(){var a=new n;return function(b){for(var c=0,d=b.count;c<d;c++)a.x=b.getX(c),a.y=b.getY(c),a.z=b.getZ(c),a.applyMatrix3(this),b.setXYZ(c,a.x,a.y,a.z);return b}}(),multiply:function(a){return this.multiplyMatrices(this,
a)},premultiply:function(a){return this.multiplyMatrices(a,this)},multiplyMatrices:function(a,b){var c=a.elements,d=b.elements;b=this.elements;a=c[0];var e=c[3],f=c[6],g=c[1],h=c[4],k=c[7],m=c[2],p=c[5];c=c[8];var l=d[0],n=d[3],t=d[6],r=d[1],u=d[4],x=d[7],A=d[2],w=d[5];d=d[8];b[0]=a*l+e*r+f*A;b[3]=a*n+e*u+f*w;b[6]=a*t+e*x+f*d;b[1]=g*l+h*r+k*A;b[4]=g*n+h*u+k*w;b[7]=g*t+h*x+k*d;b[2]=m*l+p*r+c*A;b[5]=m*n+p*u+c*w;b[8]=m*t+p*x+c*d;return this},multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[3]*=
a;b[6]*=a;b[1]*=a;b[4]*=a;b[7]*=a;b[2]*=a;b[5]*=a;b[8]*=a;return this},determinant:function(){var a=this.elements,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],k=a[7];a=a[8];return b*f*a-b*g*k-c*e*a+c*g*h+d*e*k-d*f*h},getInverse:function(a,b){a&&a.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var c=a.elements;a=this.elements;var d=c[0],e=c[1],f=c[2],g=c[3],h=c[4],k=c[5],m=c[6],p=c[7];c=c[8];var l=c*h-k*p,n=k*m-c*g,t=p*g-h*m,r=d*l+e*n+f*t;if(0===r){if(!0===
b)throw Error("THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0");console.warn("THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0");return this.identity()}b=1/r;a[0]=l*b;a[1]=(f*p-c*e)*b;a[2]=(k*e-f*h)*b;a[3]=n*b;a[4]=(c*d-f*m)*b;a[5]=(f*g-k*d)*b;a[6]=t*b;a[7]=(e*m-p*d)*b;a[8]=(h*d-e*g)*b;return this},transpose:function(){var a=this.elements;var b=a[1];a[1]=a[3];a[3]=b;b=a[2];a[2]=a[6];a[6]=b;b=a[5];a[5]=a[7];a[7]=b;return this},getNormalMatrix:function(a){return this.setFromMatrix4(a).getInverse(this).transpose()},
transposeIntoArray:function(a){var b=this.elements;a[0]=b[0];a[1]=b[3];a[2]=b[6];a[3]=b[1];a[4]=b[4];a[5]=b[7];a[6]=b[2];a[7]=b[5];a[8]=b[8];return this},setUvTransform:function(a,b,c,d,e,f,g){var h=Math.cos(e);e=Math.sin(e);this.set(c*h,c*e,-c*(h*f+e*g)+f+a,-d*e,d*h,-d*(-e*f+h*g)+g+b,0,0,1)},scale:function(a,b){var c=this.elements;c[0]*=a;c[3]*=a;c[6]*=a;c[1]*=b;c[4]*=b;c[7]*=b;return this},rotate:function(a){var b=Math.cos(a);a=Math.sin(a);var c=this.elements,d=c[0],e=c[3],f=c[6],g=c[1],h=c[4],
k=c[7];c[0]=b*d+a*g;c[3]=b*e+a*h;c[6]=b*f+a*k;c[1]=-a*d+b*g;c[4]=-a*e+b*h;c[7]=-a*f+b*k;return this},translate:function(a,b){var c=this.elements;c[0]+=a*c[2];c[3]+=a*c[5];c[6]+=a*c[8];c[1]+=b*c[2];c[4]+=b*c[5];c[7]+=b*c[8];return this},equals:function(a){var b=this.elements;a=a.elements;for(var c=0;9>c;c++)if(b[c]!==a[c])return!1;return!0},fromArray:function(a,b){void 0===b&&(b=0);for(var c=0;9>c;c++)this.elements[c]=a[c+b];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);var c=
this.elements;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];a[b+5]=c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];return a}});var wc,ob={getDataURL:function(a){if("undefined"==typeof HTMLCanvasElement)return a.src;if(!(a instanceof HTMLCanvasElement)){void 0===wc&&(wc=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"));wc.width=a.width;wc.height=a.height;var b=wc.getContext("2d");a instanceof ImageData?b.putImageData(a,0,0):b.drawImage(a,0,0,a.width,a.height);a=wc}return 2048<
a.width||2048<a.height?a.toDataURL("image/jpeg",.6):a.toDataURL("image/png")}},Uf=0;W.DEFAULT_IMAGE=void 0;W.DEFAULT_MAPPING=300;W.prototype=Object.assign(Object.create(ta.prototype),{constructor:W,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.name=a.name;this.image=a.image;this.mipmaps=a.mipmaps.slice(0);
this.mapping=a.mapping;this.wrapS=a.wrapS;this.wrapT=a.wrapT;this.magFilter=a.magFilter;this.minFilter=a.minFilter;this.anisotropy=a.anisotropy;this.format=a.format;this.type=a.type;this.offset.copy(a.offset);this.repeat.copy(a.repeat);this.center.copy(a.center);this.rotation=a.rotation;this.matrixAutoUpdate=a.matrixAutoUpdate;this.matrix.copy(a.matrix);this.generateMipmaps=a.generateMipmaps;this.premultiplyAlpha=a.premultiplyAlpha;this.flipY=a.flipY;this.unpackAlignment=a.unpackAlignment;this.encoding=
a.encoding;return this},toJSON:function(a){var b=void 0===a||"string"===typeof a;if(!b&&void 0!==a.textures[this.uuid])return a.textures[this.uuid];var c={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,
magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var d=this.image;void 0===d.uuid&&(d.uuid=K.generateUUID());if(!b&&void 0===a.images[d.uuid]){if(Array.isArray(d)){var e=[];for(var f=0,g=d.length;f<g;f++)e.push(ob.getDataURL(d[f]))}else e=ob.getDataURL(d);a.images[d.uuid]={uuid:d.uuid,url:e}}c.image=d.uuid}b||(a.textures[this.uuid]=c);return c},dispose:function(){this.dispatchEvent({type:"dispose"})},
transformUv:function(a){if(300!==this.mapping)return a;a.applyMatrix3(this.matrix);if(0>a.x||1<a.x)switch(this.wrapS){case 1E3:a.x-=Math.floor(a.x);break;case 1001:a.x=0>a.x?0:1;break;case 1002:a.x=1===Math.abs(Math.floor(a.x)%2)?Math.ceil(a.x)-a.x:a.x-Math.floor(a.x)}if(0>a.y||1<a.y)switch(this.wrapT){case 1E3:a.y-=Math.floor(a.y);break;case 1001:a.y=0>a.y?0:1;break;case 1002:a.y=1===Math.abs(Math.floor(a.y)%2)?Math.ceil(a.y)-a.y:a.y-Math.floor(a.y)}this.flipY&&(a.y=1-a.y);return a}});Object.defineProperty(W.prototype,
"needsUpdate",{set:function(a){!0===a&&this.version++}});Object.assign(Y.prototype,{isVector4:!0,set:function(a,b,c,d){this.x=a;this.y=b;this.z=c;this.w=d;return this},setScalar:function(a){this.w=this.z=this.y=this.x=a;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setW:function(a){this.w=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;case 3:this.w=
b;break;default:throw Error("index is out of range: "+a);}return this},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+a);}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=void 0!==a.w?a.w:1;return this},add:function(a,b){if(void 0!==b)return console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),
this.addVectors(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;this.w+=a.w;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;this.w+=a;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;this.w=a.w+b.w;return this},addScaledVector:function(a,b){this.x+=a.x*b;this.y+=a.y*b;this.z+=a.z*b;this.w+=a.w*b;return this},sub:function(a,b){if(void 0!==b)return console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,
b);this.x-=a.x;this.y-=a.y;this.z-=a.z;this.w-=a.w;return this},subScalar:function(a){this.x-=a;this.y-=a;this.z-=a;this.w-=a;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;this.w=a.w-b.w;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=a;this.w*=a;return this},applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z,e=this.w;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d+a[12]*e;this.y=a[1]*b+a[5]*c+a[9]*d+a[13]*e;this.z=a[2]*b+a[6]*c+a[10]*d+a[14]*
e;this.w=a[3]*b+a[7]*c+a[11]*d+a[15]*e;return this},divideScalar:function(a){return this.multiplyScalar(1/a)},setAxisAngleFromQuaternion:function(a){this.w=2*Math.acos(a.w);var b=Math.sqrt(1-a.w*a.w);1E-4>b?(this.x=1,this.z=this.y=0):(this.x=a.x/b,this.y=a.y/b,this.z=a.z/b);return this},setAxisAngleFromRotationMatrix:function(a){a=a.elements;var b=a[0];var c=a[4];var d=a[8],e=a[1],f=a[5],g=a[9];var h=a[2];var k=a[6];var m=a[10];if(.01>Math.abs(c-e)&&.01>Math.abs(d-h)&&.01>Math.abs(g-k)){if(.1>Math.abs(c+
e)&&.1>Math.abs(d+h)&&.1>Math.abs(g+k)&&.1>Math.abs(b+f+m-3))return this.set(1,0,0,0),this;a=Math.PI;b=(b+1)/2;f=(f+1)/2;m=(m+1)/2;c=(c+e)/4;d=(d+h)/4;g=(g+k)/4;b>f&&b>m?.01>b?(k=0,c=h=.707106781):(k=Math.sqrt(b),h=c/k,c=d/k):f>m?.01>f?(k=.707106781,h=0,c=.707106781):(h=Math.sqrt(f),k=c/h,c=g/h):.01>m?(h=k=.707106781,c=0):(c=Math.sqrt(m),k=d/c,h=g/c);this.set(k,h,c,a);return this}a=Math.sqrt((k-g)*(k-g)+(d-h)*(d-h)+(e-c)*(e-c));.001>Math.abs(a)&&(a=1);this.x=(k-g)/a;this.y=(d-h)/a;this.z=(e-c)/a;
this.w=Math.acos((b+f+m-1)/2);return this},min:function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);this.z=Math.min(this.z,a.z);this.w=Math.min(this.w,a.w);return this},max:function(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);this.z=Math.max(this.z,a.z);this.w=Math.max(this.w,a.w);return this},clamp:function(a,b){this.x=Math.max(a.x,Math.min(b.x,this.x));this.y=Math.max(a.y,Math.min(b.y,this.y));this.z=Math.max(a.z,Math.min(b.z,this.z));this.w=Math.max(a.w,Math.min(b.w,
this.w));return this},clampScalar:function(){var a,b;return function(c,d){void 0===a&&(a=new Y,b=new Y);a.set(c,c,c,c);b.set(d,d,d,d);return this.clamp(a,b)}}(),clampLength:function(a,b){var c=this.length();return this.divideScalar(c||1).multiplyScalar(Math.max(a,Math.min(b,c)))},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);this.w=Math.floor(this.w);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);
this.w=Math.ceil(this.w);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);this.w=Math.round(this.w);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z);this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;this.w=-this.w;return this},
dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(a){return this.normalize().multiplyScalar(a)},lerp:function(a,b){this.x+=
(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;this.w+=(a.w-this.w)*b;return this},lerpVectors:function(a,b,c){return this.subVectors(b,a).multiplyScalar(c).add(a)},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&a.w===this.w},fromArray:function(a,b){void 0===b&&(b=0);this.x=a[b];this.y=a[b+1];this.z=a[b+2];this.w=a[b+3];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this.x;a[b+1]=this.y;a[b+2]=this.z;a[b+3]=this.w;return a},fromBufferAttribute:function(a,
b,c){void 0!==c&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute().");this.x=a.getX(b);this.y=a.getY(b);this.z=a.getZ(b);this.w=a.getW(b);return this}});Ta.prototype=Object.assign(Object.create(ta.prototype),{constructor:Ta,isWebGLRenderTarget:!0,setSize:function(a,b){if(this.width!==a||this.height!==b)this.width=a,this.height=b,this.dispose();this.viewport.set(0,0,a,b);this.scissor.set(0,0,a,b)},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.width=
a.width;this.height=a.height;this.viewport.copy(a.viewport);this.texture=a.texture.clone();this.depthBuffer=a.depthBuffer;this.stencilBuffer=a.stencilBuffer;this.depthTexture=a.depthTexture;return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});$d.prototype=Object.assign(Object.create(Ta.prototype),{constructor:$d,isWebGLMultisampleRenderTarget:!0,copy:function(a){Ta.prototype.copy.call(this,a);this.samples=a.samples;return this}});pb.prototype=Object.create(Ta.prototype);pb.prototype.constructor=
pb;pb.prototype.isWebGLRenderTargetCube=!0;qb.prototype=Object.create(W.prototype);qb.prototype.constructor=qb;qb.prototype.isDataTexture=!0;Object.assign(Ja.prototype,{isBox3:!0,set:function(a,b){this.min.copy(a);this.max.copy(b);return this},setFromArray:function(a){for(var b=Infinity,c=Infinity,d=Infinity,e=-Infinity,f=-Infinity,g=-Infinity,h=0,k=a.length;h<k;h+=3){var m=a[h],p=a[h+1],l=a[h+2];m<b&&(b=m);p<c&&(c=p);l<d&&(d=l);m>e&&(e=m);p>f&&(f=p);l>g&&(g=l)}this.min.set(b,c,d);this.max.set(e,
f,g);return this},setFromBufferAttribute:function(a){for(var b=Infinity,c=Infinity,d=Infinity,e=-Infinity,f=-Infinity,g=-Infinity,h=0,k=a.count;h<k;h++){var m=a.getX(h),p=a.getY(h),l=a.getZ(h);m<b&&(b=m);p<c&&(c=p);l<d&&(d=l);m>e&&(e=m);p>f&&(f=p);l>g&&(g=l)}this.min.set(b,c,d);this.max.set(e,f,g);return this},setFromPoints:function(a){this.makeEmpty();for(var b=0,c=a.length;b<c;b++)this.expandByPoint(a[b]);return this},setFromCenterAndSize:function(){var a=new n;return function(b,c){c=a.copy(c).multiplyScalar(.5);
this.min.copy(b).sub(c);this.max.copy(b).add(c);return this}}(),setFromObject:function(a){this.makeEmpty();return this.expandByObject(a)},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.min.copy(a.min);this.max.copy(a.max);return this},makeEmpty:function(){this.min.x=this.min.y=this.min.z=Infinity;this.max.x=this.max.y=this.max.z=-Infinity;return this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(a){void 0===
a&&(console.warn("THREE.Box3: .getCenter() target is now required"),a=new n);return this.isEmpty()?a.set(0,0,0):a.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(a){void 0===a&&(console.warn("THREE.Box3: .getSize() target is now required"),a=new n);return this.isEmpty()?a.set(0,0,0):a.subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);this.max.max(a);return this},expandByVector:function(a){this.min.sub(a);this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);
this.max.addScalar(a);return this},expandByObject:function(){function a(a){var f=a.geometry;if(void 0!==f)if(f.isGeometry)for(f=f.vertices,c=0,d=f.length;c<d;c++)e.copy(f[c]),e.applyMatrix4(a.matrixWorld),b.expandByPoint(e);else if(f.isBufferGeometry&&(f=f.attributes.position,void 0!==f))for(c=0,d=f.count;c<d;c++)e.fromBufferAttribute(f,c).applyMatrix4(a.matrixWorld),b.expandByPoint(e)}var b,c,d,e=new n;return function(c){b=this;c.updateMatrixWorld(!0);c.traverse(a);return this}}(),containsPoint:function(a){return a.x<
this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||a.z<this.min.z||a.z>this.max.z?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z&&a.max.z<=this.max.z},getParameter:function(a,b){void 0===b&&(console.warn("THREE.Box3: .getParameter() target is now required"),b=new n);return b.set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))},
intersectsBox:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y||a.max.z<this.min.z||a.min.z>this.max.z?!1:!0},intersectsSphere:function(){var a=new n;return function(b){this.clampPoint(b.center,a);return a.distanceToSquared(b.center)<=b.radius*b.radius}}(),intersectsPlane:function(a){if(0<a.normal.x){var b=a.normal.x*this.min.x;var c=a.normal.x*this.max.x}else b=a.normal.x*this.max.x,c=a.normal.x*this.min.x;0<a.normal.y?(b+=a.normal.y*this.min.y,c+=
a.normal.y*this.max.y):(b+=a.normal.y*this.max.y,c+=a.normal.y*this.min.y);0<a.normal.z?(b+=a.normal.z*this.min.z,c+=a.normal.z*this.max.z):(b+=a.normal.z*this.max.z,c+=a.normal.z*this.min.z);return b<=-a.constant&&c>=-a.constant},intersectsTriangle:function(){function a(a){var e;var f=0;for(e=a.length-3;f<=e;f+=3){h.fromArray(a,f);var g=m.x*Math.abs(h.x)+m.y*Math.abs(h.y)+m.z*Math.abs(h.z),k=b.dot(h),p=c.dot(h),l=d.dot(h);if(Math.max(-Math.max(k,p,l),Math.min(k,p,l))>g)return!1}return!0}var b=new n,
c=new n,d=new n,e=new n,f=new n,g=new n,h=new n,k=new n,m=new n,p=new n;return function(h){if(this.isEmpty())return!1;this.getCenter(k);m.subVectors(this.max,k);b.subVectors(h.a,k);c.subVectors(h.b,k);d.subVectors(h.c,k);e.subVectors(c,b);f.subVectors(d,c);g.subVectors(b,d);h=[0,-e.z,e.y,0,-f.z,f.y,0,-g.z,g.y,e.z,0,-e.x,f.z,0,-f.x,g.z,0,-g.x,-e.y,e.x,0,-f.y,f.x,0,-g.y,g.x,0];if(!a(h))return!1;h=[1,0,0,0,1,0,0,0,1];if(!a(h))return!1;p.crossVectors(e,f);h=[p.x,p.y,p.z];return a(h)}}(),clampPoint:function(a,
b){void 0===b&&(console.warn("THREE.Box3: .clampPoint() target is now required"),b=new n);return b.copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new n;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),getBoundingSphere:function(){var a=new n;return function(b){void 0===b&&console.error("THREE.Box3: .getBoundingSphere() target is now required");this.getCenter(b.center);b.radius=.5*this.getSize(a).length();return b}}(),intersect:function(a){this.min.max(a.min);
this.max.min(a.max);this.isEmpty()&&this.makeEmpty();return this},union:function(a){this.min.min(a.min);this.max.max(a.max);return this},applyMatrix4:function(){var a=[new n,new n,new n,new n,new n,new n,new n,new n];return function(b){if(this.isEmpty())return this;a[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(b);a[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(b);a[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(b);a[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(b);
a[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(b);a[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(b);a[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(b);a[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(b);this.setFromPoints(a);return this}}(),translate:function(a){this.min.add(a);this.max.add(a);return this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)}});Object.assign(Ua.prototype,{set:function(a,b){this.center.copy(a);this.radius=b;return this},
setFromPoints:function(){var a=new Ja;return function(b,c){var d=this.center;void 0!==c?d.copy(c):a.setFromPoints(b).getCenter(d);for(var e=c=0,f=b.length;e<f;e++)c=Math.max(c,d.distanceToSquared(b[e]));this.radius=Math.sqrt(c);return this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.center.copy(a.center);this.radius=a.radius;return this},empty:function(){return 0>=this.radius},containsPoint:function(a){return a.distanceToSquared(this.center)<=this.radius*this.radius},
distanceToPoint:function(a){return a.distanceTo(this.center)-this.radius},intersectsSphere:function(a){var b=this.radius+a.radius;return a.center.distanceToSquared(this.center)<=b*b},intersectsBox:function(a){return a.intersectsSphere(this)},intersectsPlane:function(a){return Math.abs(a.distanceToPoint(this.center))<=this.radius},clampPoint:function(a,b){var c=this.center.distanceToSquared(a);void 0===b&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),b=new n);b.copy(a);c>this.radius*
this.radius&&(b.sub(this.center).normalize(),b.multiplyScalar(this.radius).add(this.center));return b},getBoundingBox:function(a){void 0===a&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),a=new Ja);a.set(this.center,this.center);a.expandByScalar(this.radius);return a},applyMatrix4:function(a){this.center.applyMatrix4(a);this.radius*=a.getMaxScaleOnAxis();return this},translate:function(a){this.center.add(a);return this},equals:function(a){return a.center.equals(this.center)&&
a.radius===this.radius}});Object.assign(Va.prototype,{set:function(a,b){this.normal.copy(a);this.constant=b;return this},setComponents:function(a,b,c,d){this.normal.set(a,b,c);this.constant=d;return this},setFromNormalAndCoplanarPoint:function(a,b){this.normal.copy(a);this.constant=-b.dot(this.normal);return this},setFromCoplanarPoints:function(){var a=new n,b=new n;return function(c,d,e){d=a.subVectors(e,d).cross(b.subVectors(c,d)).normalize();this.setFromNormalAndCoplanarPoint(d,c);return this}}(),
clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.normal.copy(a.normal);this.constant=a.constant;return this},normalize:function(){var a=1/this.normal.length();this.normal.multiplyScalar(a);this.constant*=a;return this},negate:function(){this.constant*=-1;this.normal.negate();return this},distanceToPoint:function(a){return this.normal.dot(a)+this.constant},distanceToSphere:function(a){return this.distanceToPoint(a.center)-a.radius},projectPoint:function(a,b){void 0===
b&&(console.warn("THREE.Plane: .projectPoint() target is now required"),b=new n);return b.copy(this.normal).multiplyScalar(-this.distanceToPoint(a)).add(a)},intersectLine:function(){var a=new n;return function(b,c){void 0===c&&(console.warn("THREE.Plane: .intersectLine() target is now required"),c=new n);var d=b.delta(a),e=this.normal.dot(d);if(0===e){if(0===this.distanceToPoint(b.start))return c.copy(b.start)}else if(e=-(b.start.dot(this.normal)+this.constant)/e,!(0>e||1<e))return c.copy(d).multiplyScalar(e).add(b.start)}}(),
intersectsLine:function(a){var b=this.distanceToPoint(a.start);a=this.distanceToPoint(a.end);return 0>b&&0<a||0>a&&0<b},intersectsBox:function(a){return a.intersectsPlane(this)},intersectsSphere:function(a){return a.intersectsPlane(this)},coplanarPoint:function(a){void 0===a&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),a=new n);return a.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var a=new n,b=new ba;return function(c,d){d=d||b.getNormalMatrix(c);
c=this.coplanarPoint(a).applyMatrix4(c);d=this.normal.applyMatrix3(d).normalize();this.constant=-c.dot(d);return this}}(),translate:function(a){this.constant-=a.dot(this.normal);return this},equals:function(a){return a.normal.equals(this.normal)&&a.constant===this.constant}});Object.assign(vd.prototype,{set:function(a,b,c,d,e,f){var g=this.planes;g[0].copy(a);g[1].copy(b);g[2].copy(c);g[3].copy(d);g[4].copy(e);g[5].copy(f);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){for(var b=
this.planes,c=0;6>c;c++)b[c].copy(a.planes[c]);return this},setFromMatrix:function(a){var b=this.planes,c=a.elements;a=c[0];var d=c[1],e=c[2],f=c[3],g=c[4],h=c[5],k=c[6],m=c[7],p=c[8],l=c[9],n=c[10],t=c[11],r=c[12],u=c[13],x=c[14];c=c[15];b[0].setComponents(f-a,m-g,t-p,c-r).normalize();b[1].setComponents(f+a,m+g,t+p,c+r).normalize();b[2].setComponents(f+d,m+h,t+l,c+u).normalize();b[3].setComponents(f-d,m-h,t-l,c-u).normalize();b[4].setComponents(f-e,m-k,t-n,c-x).normalize();b[5].setComponents(f+e,
m+k,t+n,c+x).normalize();return this},intersectsObject:function(){var a=new Ua;return function(b){var c=b.geometry;null===c.boundingSphere&&c.computeBoundingSphere();a.copy(c.boundingSphere).applyMatrix4(b.matrixWorld);return this.intersectsSphere(a)}}(),intersectsSprite:function(){var a=new Ua;return function(b){a.center.set(0,0,0);a.radius=.7071067811865476;a.applyMatrix4(b.matrixWorld);return this.intersectsSphere(a)}}(),intersectsSphere:function(a){var b=this.planes,c=a.center;a=-a.radius;for(var d=
0;6>d;d++)if(b[d].distanceToPoint(c)<a)return!1;return!0},intersectsBox:function(){var a=new n;return function(b){for(var c=this.planes,d=0;6>d;d++){var e=c[d];a.x=0<e.normal.x?b.max.x:b.min.x;a.y=0<e.normal.y?b.max.y:b.min.y;a.z=0<e.normal.z?b.max.z:b.min.z;if(0>e.distanceToPoint(a))return!1}return!0}}(),containsPoint:function(a){for(var b=this.planes,c=0;6>c;c++)if(0>b[c].distanceToPoint(a))return!1;return!0}});Object.assign(P.prototype,{isMatrix4:!0,set:function(a,b,c,d,e,f,g,h,k,m,l,q,n,t,r,u){var p=
this.elements;p[0]=a;p[4]=b;p[8]=c;p[12]=d;p[1]=e;p[5]=f;p[9]=g;p[13]=h;p[2]=k;p[6]=m;p[10]=l;p[14]=q;p[3]=n;p[7]=t;p[11]=r;p[15]=u;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},clone:function(){return(new P).fromArray(this.elements)},copy:function(a){var b=this.elements;a=a.elements;b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return this},
copyPosition:function(a){var b=this.elements;a=a.elements;b[12]=a[12];b[13]=a[13];b[14]=a[14];return this},extractBasis:function(a,b,c){a.setFromMatrixColumn(this,0);b.setFromMatrixColumn(this,1);c.setFromMatrixColumn(this,2);return this},makeBasis:function(a,b,c){this.set(a.x,b.x,c.x,0,a.y,b.y,c.y,0,a.z,b.z,c.z,0,0,0,0,1);return this},extractRotation:function(){var a=new n;return function(b){var c=this.elements,d=b.elements,e=1/a.setFromMatrixColumn(b,0).length(),f=1/a.setFromMatrixColumn(b,1).length();
b=1/a.setFromMatrixColumn(b,2).length();c[0]=d[0]*e;c[1]=d[1]*e;c[2]=d[2]*e;c[3]=0;c[4]=d[4]*f;c[5]=d[5]*f;c[6]=d[6]*f;c[7]=0;c[8]=d[8]*b;c[9]=d[9]*b;c[10]=d[10]*b;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return this}}(),makeRotationFromEuler:function(a){a&&a.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var b=this.elements,c=a.x,d=a.y,e=a.z,f=Math.cos(c);c=Math.sin(c);var g=Math.cos(d);d=Math.sin(d);var h=Math.cos(e);
e=Math.sin(e);if("XYZ"===a.order){a=f*h;var k=f*e,m=c*h,p=c*e;b[0]=g*h;b[4]=-g*e;b[8]=d;b[1]=k+m*d;b[5]=a-p*d;b[9]=-c*g;b[2]=p-a*d;b[6]=m+k*d;b[10]=f*g}else"YXZ"===a.order?(a=g*h,k=g*e,m=d*h,p=d*e,b[0]=a+p*c,b[4]=m*c-k,b[8]=f*d,b[1]=f*e,b[5]=f*h,b[9]=-c,b[2]=k*c-m,b[6]=p+a*c,b[10]=f*g):"ZXY"===a.order?(a=g*h,k=g*e,m=d*h,p=d*e,b[0]=a-p*c,b[4]=-f*e,b[8]=m+k*c,b[1]=k+m*c,b[5]=f*h,b[9]=p-a*c,b[2]=-f*d,b[6]=c,b[10]=f*g):"ZYX"===a.order?(a=f*h,k=f*e,m=c*h,p=c*e,b[0]=g*h,b[4]=m*d-k,b[8]=a*d+p,b[1]=g*e,b[5]=
p*d+a,b[9]=k*d-m,b[2]=-d,b[6]=c*g,b[10]=f*g):"YZX"===a.order?(a=f*g,k=f*d,m=c*g,p=c*d,b[0]=g*h,b[4]=p-a*e,b[8]=m*e+k,b[1]=e,b[5]=f*h,b[9]=-c*h,b[2]=-d*h,b[6]=k*e+m,b[10]=a-p*e):"XZY"===a.order&&(a=f*g,k=f*d,m=c*g,p=c*d,b[0]=g*h,b[4]=-e,b[8]=d*h,b[1]=a*e+p,b[5]=f*h,b[9]=k*e-m,b[2]=m*e-k,b[6]=c*h,b[10]=p*e+a);b[3]=0;b[7]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this},makeRotationFromQuaternion:function(){var a=new n(0,0,0),b=new n(1,1,1);return function(c){return this.compose(a,c,b)}}(),lookAt:function(){var a=
new n,b=new n,c=new n;return function(d,e,f){var g=this.elements;c.subVectors(d,e);0===c.lengthSq()&&(c.z=1);c.normalize();a.crossVectors(f,c);0===a.lengthSq()&&(1===Math.abs(f.z)?c.x+=1E-4:c.z+=1E-4,c.normalize(),a.crossVectors(f,c));a.normalize();b.crossVectors(c,a);g[0]=a.x;g[4]=b.x;g[8]=c.x;g[1]=a.y;g[5]=b.y;g[9]=c.y;g[2]=a.z;g[6]=b.z;g[10]=c.z;return this}}(),multiply:function(a,b){return void 0!==b?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),
this.multiplyMatrices(a,b)):this.multiplyMatrices(this,a)},premultiply:function(a){return this.multiplyMatrices(a,this)},multiplyMatrices:function(a,b){var c=a.elements,d=b.elements;b=this.elements;a=c[0];var e=c[4],f=c[8],g=c[12],h=c[1],k=c[5],m=c[9],p=c[13],l=c[2],n=c[6],t=c[10],r=c[14],u=c[3],x=c[7],A=c[11];c=c[15];var w=d[0],y=d[4],D=d[8],J=d[12],B=d[1],F=d[5],C=d[9],z=d[13],E=d[2],G=d[6],I=d[10],K=d[14],M=d[3],X=d[7],Q=d[11];d=d[15];b[0]=a*w+e*B+f*E+g*M;b[4]=a*y+e*F+f*G+g*X;b[8]=a*D+e*C+f*I+
g*Q;b[12]=a*J+e*z+f*K+g*d;b[1]=h*w+k*B+m*E+p*M;b[5]=h*y+k*F+m*G+p*X;b[9]=h*D+k*C+m*I+p*Q;b[13]=h*J+k*z+m*K+p*d;b[2]=l*w+n*B+t*E+r*M;b[6]=l*y+n*F+t*G+r*X;b[10]=l*D+n*C+t*I+r*Q;b[14]=l*J+n*z+t*K+r*d;b[3]=u*w+x*B+A*E+c*M;b[7]=u*y+x*F+A*G+c*X;b[11]=u*D+x*C+A*I+c*Q;b[15]=u*J+x*z+A*K+c*d;return this},multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[4]*=a;b[8]*=a;b[12]*=a;b[1]*=a;b[5]*=a;b[9]*=a;b[13]*=a;b[2]*=a;b[6]*=a;b[10]*=a;b[14]*=a;b[3]*=a;b[7]*=a;b[11]*=a;b[15]*=a;return this},applyToBufferAttribute:function(){var a=
new n;return function(b){for(var c=0,d=b.count;c<d;c++)a.x=b.getX(c),a.y=b.getY(c),a.z=b.getZ(c),a.applyMatrix4(this),b.setXYZ(c,a.x,a.y,a.z);return b}}(),determinant:function(){var a=this.elements,b=a[0],c=a[4],d=a[8],e=a[12],f=a[1],g=a[5],h=a[9],k=a[13],m=a[2],p=a[6],l=a[10],n=a[14];return a[3]*(+e*h*p-d*k*p-e*g*l+c*k*l+d*g*n-c*h*n)+a[7]*(+b*h*n-b*k*l+e*f*l-d*f*n+d*k*m-e*h*m)+a[11]*(+b*k*p-b*g*n-e*f*p+c*f*n+e*g*m-c*k*m)+a[15]*(-d*g*m-b*h*p+b*g*l+d*f*p-c*f*l+c*h*m)},transpose:function(){var a=this.elements;
var b=a[1];a[1]=a[4];a[4]=b;b=a[2];a[2]=a[8];a[8]=b;b=a[6];a[6]=a[9];a[9]=b;b=a[3];a[3]=a[12];a[12]=b;b=a[7];a[7]=a[13];a[13]=b;b=a[11];a[11]=a[14];a[14]=b;return this},setPosition:function(a){var b=this.elements;b[12]=a.x;b[13]=a.y;b[14]=a.z;return this},getInverse:function(a,b){var c=this.elements,d=a.elements;a=d[0];var e=d[1],f=d[2],g=d[3],h=d[4],k=d[5],m=d[6],p=d[7],l=d[8],n=d[9],t=d[10],r=d[11],u=d[12],x=d[13],A=d[14];d=d[15];var w=n*A*p-x*t*p+x*m*r-k*A*r-n*m*d+k*t*d,y=u*t*p-l*A*p-u*m*r+h*A*
r+l*m*d-h*t*d,D=l*x*p-u*n*p+u*k*r-h*x*r-l*k*d+h*n*d,J=u*n*m-l*x*m-u*k*t+h*x*t+l*k*A-h*n*A,B=a*w+e*y+f*D+g*J;if(0===B){if(!0===b)throw Error("THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0");console.warn("THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0");return this.identity()}b=1/B;c[0]=w*b;c[1]=(x*t*g-n*A*g-x*f*r+e*A*r+n*f*d-e*t*d)*b;c[2]=(k*A*g-x*m*g+x*f*p-e*A*p-k*f*d+e*m*d)*b;c[3]=(n*m*g-k*t*g-n*f*p+e*t*p+k*f*r-e*m*r)*b;c[4]=y*b;c[5]=(l*A*g-u*t*g+u*f*r-a*
A*r-l*f*d+a*t*d)*b;c[6]=(u*m*g-h*A*g-u*f*p+a*A*p+h*f*d-a*m*d)*b;c[7]=(h*t*g-l*m*g+l*f*p-a*t*p-h*f*r+a*m*r)*b;c[8]=D*b;c[9]=(u*n*g-l*x*g-u*e*r+a*x*r+l*e*d-a*n*d)*b;c[10]=(h*x*g-u*k*g+u*e*p-a*x*p-h*e*d+a*k*d)*b;c[11]=(l*k*g-h*n*g-l*e*p+a*n*p+h*e*r-a*k*r)*b;c[12]=J*b;c[13]=(l*x*f-u*n*f+u*e*t-a*x*t-l*e*A+a*n*A)*b;c[14]=(u*k*f-h*x*f-u*e*m+a*x*m+h*e*A-a*k*A)*b;c[15]=(h*n*f-l*k*f+l*e*m-a*n*m-h*e*t+a*k*t)*b;return this},scale:function(a){var b=this.elements,c=a.x,d=a.y;a=a.z;b[0]*=c;b[4]*=d;b[8]*=a;b[1]*=
c;b[5]*=d;b[9]*=a;b[2]*=c;b[6]*=d;b[10]*=a;b[3]*=c;b[7]*=d;b[11]*=a;return this},getMaxScaleOnAxis:function(){var a=this.elements;return Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1]+a[2]*a[2],a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10]))},makeTranslation:function(a,b,c){this.set(1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1);return this},makeRotationX:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(1,0,0,0,0,b,-a,0,0,a,b,0,0,0,0,1);return this},makeRotationY:function(a){var b=Math.cos(a);a=Math.sin(a);
this.set(b,0,a,0,0,1,0,0,-a,0,b,0,0,0,0,1);return this},makeRotationZ:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(b,-a,0,0,a,b,0,0,0,0,1,0,0,0,0,1);return this},makeRotationAxis:function(a,b){var c=Math.cos(b);b=Math.sin(b);var d=1-c,e=a.x,f=a.y;a=a.z;var g=d*e,h=d*f;this.set(g*e+c,g*f-b*a,g*a+b*f,0,g*f+b*a,h*f+c,h*a-b*e,0,g*a-b*f,h*a+b*e,d*a*a+c,0,0,0,0,1);return this},makeScale:function(a,b,c){this.set(a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1);return this},makeShear:function(a,b,c){this.set(1,b,
c,0,a,1,c,0,a,b,1,0,0,0,0,1);return this},compose:function(a,b,c){var d=this.elements,e=b._x,f=b._y,g=b._z,h=b._w,k=e+e,m=f+f,l=g+g;b=e*k;var q=e*m;e*=l;var n=f*m;f*=l;g*=l;k*=h;m*=h;h*=l;l=c.x;var t=c.y;c=c.z;d[0]=(1-(n+g))*l;d[1]=(q+h)*l;d[2]=(e-m)*l;d[3]=0;d[4]=(q-h)*t;d[5]=(1-(b+g))*t;d[6]=(f+k)*t;d[7]=0;d[8]=(e+m)*c;d[9]=(f-k)*c;d[10]=(1-(b+n))*c;d[11]=0;d[12]=a.x;d[13]=a.y;d[14]=a.z;d[15]=1;return this},decompose:function(){var a=new n,b=new P;return function(c,d,e){var f=this.elements,g=a.set(f[0],
f[1],f[2]).length(),h=a.set(f[4],f[5],f[6]).length(),k=a.set(f[8],f[9],f[10]).length();0>this.determinant()&&(g=-g);c.x=f[12];c.y=f[13];c.z=f[14];b.copy(this);c=1/g;f=1/h;var m=1/k;b.elements[0]*=c;b.elements[1]*=c;b.elements[2]*=c;b.elements[4]*=f;b.elements[5]*=f;b.elements[6]*=f;b.elements[8]*=m;b.elements[9]*=m;b.elements[10]*=m;d.setFromRotationMatrix(b);e.x=g;e.y=h;e.z=k;return this}}(),makePerspective:function(a,b,c,d,e,f){void 0===f&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");
var g=this.elements;g[0]=2*e/(b-a);g[4]=0;g[8]=(b+a)/(b-a);g[12]=0;g[1]=0;g[5]=2*e/(c-d);g[9]=(c+d)/(c-d);g[13]=0;g[2]=0;g[6]=0;g[10]=-(f+e)/(f-e);g[14]=-2*f*e/(f-e);g[3]=0;g[7]=0;g[11]=-1;g[15]=0;return this},makeOrthographic:function(a,b,c,d,e,f){var g=this.elements,h=1/(b-a),k=1/(c-d),m=1/(f-e);g[0]=2*h;g[4]=0;g[8]=0;g[12]=-((b+a)*h);g[1]=0;g[5]=2*k;g[9]=0;g[13]=-((c+d)*k);g[2]=0;g[6]=0;g[10]=-2*m;g[14]=-((f+e)*m);g[3]=0;g[7]=0;g[11]=0;g[15]=1;return this},equals:function(a){var b=this.elements;
a=a.elements;for(var c=0;16>c;c++)if(b[c]!==a[c])return!1;return!0},fromArray:function(a,b){void 0===b&&(b=0);for(var c=0;16>c;c++)this.elements[c]=a[c+b];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);var c=this.elements;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];a[b+5]=c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];a[b+9]=c[9];a[b+10]=c[10];a[b+11]=c[11];a[b+12]=c[12];a[b+13]=c[13];a[b+14]=c[14];a[b+15]=c[15];return a}});var T={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",
alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",
aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick( specularColor, dotNV );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}",
bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",
clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",
clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvarying vec3 vViewPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif",
color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}",
cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV( sampler2D envMap, vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif",
defaultnormal_vertex:"vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = normalMatrix * objectTangent;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif",
emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",
envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",
envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",
envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent ));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",
envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",
fog_vertex:"#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",
gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif",
lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif",
lights_pars_begin:"uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",
lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",
lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif",
lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#endif\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\tfloat clearCoatInv = 1.0 - clearCoatDHR;\n\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec3 singleScattering = vec3( 0.0 );\n\t\tvec3 multiScattering = vec3( 0.0 );\n\t\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\t\tvec3 diffuse = material.diffuseColor;\n\t\treflectedLight.indirectSpecular += clearCoatInv * radiance * singleScattering;\n\t\treflectedLight.indirectDiffuse += multiScattering * cosineWeightedIrradiance;\n\t\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n\t#else\n\t\treflectedLight.indirectSpecular += clearCoatInv * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#endif\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",
lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearCoatRadiance = vec3( 0.0 );\n#endif",
lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\t#ifndef STANDARD\n\t\tclearCoatRadiance += getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t#endif\n#endif",
lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, irradiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n#endif",
logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",
map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",
metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",
morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",
normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t#endif\n#endif",
normal_fragment_maps:"#ifdef USE_NORMALMAP\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t#ifdef FLIP_SIDED\n\t\t\tnormal = - normal;\n\t\t#endif\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\tnormal = normalize( normalMatrix * normal );\n\t#else\n\t\t#ifdef USE_TANGENT\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t\tmapN.xy = normalScale * mapN.xy;\n\t\t\tnormal = normalize( vTBN * mapN );\n\t\t#else\n\t\t\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n\t\t#endif\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",
normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tuniform mat3 normalMatrix;\n\t#else\n\t\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\t\tvec2 st0 = dFdx( vUv.st );\n\t\t\tvec2 st1 = dFdy( vUv.st );\n\t\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\t\tvec3 N = normalize( surf_norm );\n\t\t\tmat3 tsn = mat3( S, T, N );\n\t\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t\tmapN.xy *= normalScale;\n\t\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\treturn normalize( tsn * mapN );\n\t\t}\n\t#endif\n#endif",
packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",
premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#if defined( DITHERING )\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",
roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",
shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif",
shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif",
shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}",
skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",
skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",
specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );\n}",
uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif",
uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",
uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",
cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",
depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}",
depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}",
distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",
distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",
equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",
equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",
linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",
meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",
meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",
meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",
meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",
meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",
meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",
meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",
meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",
meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",
meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",
normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",
normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",
points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",
points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",
shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",
sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",
sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},
kh={clone:Pb,merge:ia},lh={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,
darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,
grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,
lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,
palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,
teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Object.assign(M.prototype,{isColor:!0,r:1,g:1,b:1,set:function(a){a&&a.isColor?this.copy(a):"number"===typeof a?this.setHex(a):"string"===typeof a&&this.setStyle(a);return this},setScalar:function(a){this.b=this.g=this.r=a;return this},setHex:function(a){a=Math.floor(a);this.r=(a>>16&255)/255;this.g=(a>>8&255)/255;this.b=(a&255)/255;
return this},setRGB:function(a,b,c){this.r=a;this.g=b;this.b=c;return this},setHSL:function(){function a(a,c,d){0>d&&(d+=1);1<d&&--d;return d<1/6?a+6*(c-a)*d:.5>d?c:d<2/3?a+6*(c-a)*(2/3-d):a}return function(b,c,d){b=K.euclideanModulo(b,1);c=K.clamp(c,0,1);d=K.clamp(d,0,1);0===c?this.r=this.g=this.b=d:(c=.5>=d?d*(1+c):d+c-d*c,d=2*d-c,this.r=a(d,c,b+1/3),this.g=a(d,c,b),this.b=a(d,c,b-1/3));return this}}(),setStyle:function(a){function b(b){void 0!==b&&1>parseFloat(b)&&console.warn("THREE.Color: Alpha component of "+
a+" will be ignored.")}var c;if(c=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(a)){var d=c[2];switch(c[1]){case "rgb":case "rgba":if(c=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(d))return this.r=Math.min(255,parseInt(c[1],10))/255,this.g=Math.min(255,parseInt(c[2],10))/255,this.b=Math.min(255,parseInt(c[3],10))/255,b(c[5]),this;if(c=/^(\d+)%\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(d))return this.r=Math.min(100,parseInt(c[1],10))/100,this.g=Math.min(100,parseInt(c[2],
10))/100,this.b=Math.min(100,parseInt(c[3],10))/100,b(c[5]),this;break;case "hsl":case "hsla":if(c=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(d)){d=parseFloat(c[1])/360;var e=parseInt(c[2],10)/100,f=parseInt(c[3],10)/100;b(c[5]);return this.setHSL(d,e,f)}}}else if(c=/^#([A-Fa-f0-9]+)$/.exec(a)){c=c[1];d=c.length;if(3===d)return this.r=parseInt(c.charAt(0)+c.charAt(0),16)/255,this.g=parseInt(c.charAt(1)+c.charAt(1),16)/255,this.b=parseInt(c.charAt(2)+c.charAt(2),
16)/255,this;if(6===d)return this.r=parseInt(c.charAt(0)+c.charAt(1),16)/255,this.g=parseInt(c.charAt(2)+c.charAt(3),16)/255,this.b=parseInt(c.charAt(4)+c.charAt(5),16)/255,this}a&&0<a.length&&(c=lh[a],void 0!==c?this.setHex(c):console.warn("THREE.Color: Unknown color "+a));return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(a){this.r=a.r;this.g=a.g;this.b=a.b;return this},copyGammaToLinear:function(a,b){void 0===b&&(b=2);this.r=Math.pow(a.r,b);this.g=Math.pow(a.g,
b);this.b=Math.pow(a.b,b);return this},copyLinearToGamma:function(a,b){void 0===b&&(b=2);b=0<b?1/b:1;this.r=Math.pow(a.r,b);this.g=Math.pow(a.g,b);this.b=Math.pow(a.b,b);return this},convertGammaToLinear:function(a){this.copyGammaToLinear(this,a);return this},convertLinearToGamma:function(a){this.copyLinearToGamma(this,a);return this},copySRGBToLinear:function(){function a(a){return.04045>a?.0773993808*a:Math.pow(.9478672986*a+.0521327014,2.4)}return function(b){this.r=a(b.r);this.g=a(b.g);this.b=
a(b.b);return this}}(),copyLinearToSRGB:function(){function a(a){return.0031308>a?12.92*a:1.055*Math.pow(a,.41666)-.055}return function(b){this.r=a(b.r);this.g=a(b.g);this.b=a(b.b);return this}}(),convertSRGBToLinear:function(){this.copySRGBToLinear(this);return this},convertLinearToSRGB:function(){this.copyLinearToSRGB(this);return this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(a){void 0===
a&&(console.warn("THREE.Color: .getHSL() target is now required"),a={h:0,s:0,l:0});var b=this.r,c=this.g,d=this.b,e=Math.max(b,c,d),f=Math.min(b,c,d),g,h=(f+e)/2;if(f===e)f=g=0;else{var k=e-f;f=.5>=h?k/(e+f):k/(2-e-f);switch(e){case b:g=(c-d)/k+(c<d?6:0);break;case c:g=(d-b)/k+2;break;case d:g=(b-c)/k+4}g/=6}a.h=g;a.s=f;a.l=h;return a},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(){var a={};return function(b,c,d){this.getHSL(a);a.h+=
b;a.s+=c;a.l+=d;this.setHSL(a.h,a.s,a.l);return this}}(),add:function(a){this.r+=a.r;this.g+=a.g;this.b+=a.b;return this},addColors:function(a,b){this.r=a.r+b.r;this.g=a.g+b.g;this.b=a.b+b.b;return this},addScalar:function(a){this.r+=a;this.g+=a;this.b+=a;return this},sub:function(a){this.r=Math.max(0,this.r-a.r);this.g=Math.max(0,this.g-a.g);this.b=Math.max(0,this.b-a.b);return this},multiply:function(a){this.r*=a.r;this.g*=a.g;this.b*=a.b;return this},multiplyScalar:function(a){this.r*=a;this.g*=
a;this.b*=a;return this},lerp:function(a,b){this.r+=(a.r-this.r)*b;this.g+=(a.g-this.g)*b;this.b+=(a.b-this.b)*b;return this},lerpHSL:function(){var a={h:0,s:0,l:0},b={h:0,s:0,l:0};return function(c,d){this.getHSL(a);c.getHSL(b);c=K.lerp(a.h,b.h,d);var e=K.lerp(a.s,b.s,d);d=K.lerp(a.l,b.l,d);this.setHSL(c,e,d);return this}}(),equals:function(a){return a.r===this.r&&a.g===this.g&&a.b===this.b},fromArray:function(a,b){void 0===b&&(b=0);this.r=a[b];this.g=a[b+1];this.b=a[b+2];return this},toArray:function(a,
b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this.r;a[b+1]=this.g;a[b+2]=this.b;return a},toJSON:function(){return this.getHex()}});var G={common:{diffuse:{value:new M(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new ba},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},
lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new B(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:2.5E-4},fogNear:{value:1},fogFar:{value:2E3},fogColor:{value:new M(16777215)}},
lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},
decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new M(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new ba}},sprite:{diffuse:{value:new M(15658734)},
opacity:{value:1},center:{value:new B(.5,.5)},rotation:{value:0},map:{value:null},uvTransform:{value:new ba}}},Wa={basic:{uniforms:ia([G.common,G.specularmap,G.envmap,G.aomap,G.lightmap,G.fog]),vertexShader:T.meshbasic_vert,fragmentShader:T.meshbasic_frag},lambert:{uniforms:ia([G.common,G.specularmap,G.envmap,G.aomap,G.lightmap,G.emissivemap,G.fog,G.lights,{emissive:{value:new M(0)}}]),vertexShader:T.meshlambert_vert,fragmentShader:T.meshlambert_frag},phong:{uniforms:ia([G.common,G.specularmap,G.envmap,
G.aomap,G.lightmap,G.emissivemap,G.bumpmap,G.normalmap,G.displacementmap,G.gradientmap,G.fog,G.lights,{emissive:{value:new M(0)},specular:{value:new M(1118481)},shininess:{value:30}}]),vertexShader:T.meshphong_vert,fragmentShader:T.meshphong_frag},standard:{uniforms:ia([G.common,G.envmap,G.aomap,G.lightmap,G.emissivemap,G.bumpmap,G.normalmap,G.displacementmap,G.roughnessmap,G.metalnessmap,G.fog,G.lights,{emissive:{value:new M(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),
vertexShader:T.meshphysical_vert,fragmentShader:T.meshphysical_frag},matcap:{uniforms:ia([G.common,G.bumpmap,G.normalmap,G.displacementmap,G.fog,{matcap:{value:null}}]),vertexShader:T.meshmatcap_vert,fragmentShader:T.meshmatcap_frag},points:{uniforms:ia([G.points,G.fog]),vertexShader:T.points_vert,fragmentShader:T.points_frag},dashed:{uniforms:ia([G.common,G.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:T.linedashed_vert,fragmentShader:T.linedashed_frag},depth:{uniforms:ia([G.common,
G.displacementmap]),vertexShader:T.depth_vert,fragmentShader:T.depth_frag},normal:{uniforms:ia([G.common,G.bumpmap,G.normalmap,G.displacementmap,{opacity:{value:1}}]),vertexShader:T.normal_vert,fragmentShader:T.normal_frag},sprite:{uniforms:ia([G.sprite,G.fog]),vertexShader:T.sprite_vert,fragmentShader:T.sprite_frag},background:{uniforms:{uvTransform:{value:new ba},t2D:{value:null}},vertexShader:T.background_vert,fragmentShader:T.background_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},
opacity:{value:1}},vertexShader:T.cube_vert,fragmentShader:T.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:T.equirect_vert,fragmentShader:T.equirect_frag},distanceRGBA:{uniforms:ia([G.common,G.displacementmap,{referencePosition:{value:new n},nearDistance:{value:1},farDistance:{value:1E3}}]),vertexShader:T.distanceRGBA_vert,fragmentShader:T.distanceRGBA_frag},shadow:{uniforms:ia([G.lights,G.fog,{color:{value:new M(0)},opacity:{value:1}}]),vertexShader:T.shadow_vert,fragmentShader:T.shadow_frag}};
Wa.physical={uniforms:ia([Wa.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:T.meshphysical_vert,fragmentShader:T.meshphysical_frag};Object.assign(Qb.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.a=a.a;this.b=a.b;this.c=a.c;this.normal.copy(a.normal);this.color.copy(a.color);this.materialIndex=a.materialIndex;for(var b=0,c=a.vertexNormals.length;b<c;b++)this.vertexNormals[b]=a.vertexNormals[b].clone();b=0;for(c=a.vertexColors.length;b<
c;b++)this.vertexColors[b]=a.vertexColors[b].clone();return this}});rb.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" ");rb.DefaultOrder="XYZ";Object.defineProperties(rb.prototype,{x:{get:function(){return this._x},set:function(a){this._x=a;this.onChangeCallback()}},y:{get:function(){return this._y},set:function(a){this._y=a;this.onChangeCallback()}},z:{get:function(){return this._z},set:function(a){this._z=a;this.onChangeCallback()}},order:{get:function(){return this._order},set:function(a){this._order=
a;this.onChangeCallback()}}});Object.assign(rb.prototype,{isEuler:!0,set:function(a,b,c,d){this._x=a;this._y=b;this._z=c;this._order=d||this._order;this.onChangeCallback();return this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(a){this._x=a._x;this._y=a._y;this._z=a._z;this._order=a._order;this.onChangeCallback();return this},setFromRotationMatrix:function(a,b,c){var d=K.clamp,e=a.elements;a=e[0];var f=e[4],g=e[8],h=e[1],k=e[5],m=e[9],l=e[2],q=
e[6];e=e[10];b=b||this._order;"XYZ"===b?(this._y=Math.asin(d(g,-1,1)),.99999>Math.abs(g)?(this._x=Math.atan2(-m,e),this._z=Math.atan2(-f,a)):(this._x=Math.atan2(q,k),this._z=0)):"YXZ"===b?(this._x=Math.asin(-d(m,-1,1)),.99999>Math.abs(m)?(this._y=Math.atan2(g,e),this._z=Math.atan2(h,k)):(this._y=Math.atan2(-l,a),this._z=0)):"ZXY"===b?(this._x=Math.asin(d(q,-1,1)),.99999>Math.abs(q)?(this._y=Math.atan2(-l,e),this._z=Math.atan2(-f,k)):(this._y=0,this._z=Math.atan2(h,a))):"ZYX"===b?(this._y=Math.asin(-d(l,
-1,1)),.99999>Math.abs(l)?(this._x=Math.atan2(q,e),this._z=Math.atan2(h,a)):(this._x=0,this._z=Math.atan2(-f,k))):"YZX"===b?(this._z=Math.asin(d(h,-1,1)),.99999>Math.abs(h)?(this._x=Math.atan2(-m,k),this._y=Math.atan2(-l,a)):(this._x=0,this._y=Math.atan2(g,e))):"XZY"===b?(this._z=Math.asin(-d(f,-1,1)),.99999>Math.abs(f)?(this._x=Math.atan2(q,k),this._y=Math.atan2(g,a)):(this._x=Math.atan2(-m,e),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+b);this._order=
b;if(!1!==c)this.onChangeCallback();return this},setFromQuaternion:function(){var a=new P;return function(b,c,d){a.makeRotationFromQuaternion(b);return this.setFromRotationMatrix(a,c,d)}}(),setFromVector3:function(a,b){return this.set(a.x,a.y,a.z,b||this._order)},reorder:function(){var a=new aa;return function(b){a.setFromEuler(this);return this.setFromQuaternion(a,b)}}(),equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._order===this._order},fromArray:function(a){this._x=
a[0];this._y=a[1];this._z=a[2];void 0!==a[3]&&(this._order=a[3]);this.onChangeCallback();return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this._x;a[b+1]=this._y;a[b+2]=this._z;a[b+3]=this._order;return a},toVector3:function(a){return a?a.set(this._x,this._y,this._z):new n(this._x,this._y,this._z)},onChange:function(a){this.onChangeCallback=a;return this},onChangeCallback:function(){}});Object.assign(be.prototype,{set:function(a){this.mask=1<<a|0},enable:function(a){this.mask=
this.mask|1<<a|0},toggle:function(a){this.mask^=1<<a|0},disable:function(a){this.mask&=~(1<<a|0)},test:function(a){return 0!==(this.mask&a.mask)}});var Wf=0;C.DefaultUp=new n(0,1,0);C.DefaultMatrixAutoUpdate=!0;C.prototype=Object.assign(Object.create(ta.prototype),{constructor:C,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(a){this.matrix.multiplyMatrices(a,this.matrix);this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(a){this.quaternion.premultiply(a);
return this},setRotationFromAxisAngle:function(a,b){this.quaternion.setFromAxisAngle(a,b)},setRotationFromEuler:function(a){this.quaternion.setFromEuler(a,!0)},setRotationFromMatrix:function(a){this.quaternion.setFromRotationMatrix(a)},setRotationFromQuaternion:function(a){this.quaternion.copy(a)},rotateOnAxis:function(){var a=new aa;return function(b,c){a.setFromAxisAngle(b,c);this.quaternion.multiply(a);return this}}(),rotateOnWorldAxis:function(){var a=new aa;return function(b,c){a.setFromAxisAngle(b,
c);this.quaternion.premultiply(a);return this}}(),rotateX:function(){var a=new n(1,0,0);return function(b){return this.rotateOnAxis(a,b)}}(),rotateY:function(){var a=new n(0,1,0);return function(b){return this.rotateOnAxis(a,b)}}(),rotateZ:function(){var a=new n(0,0,1);return function(b){return this.rotateOnAxis(a,b)}}(),translateOnAxis:function(){var a=new n;return function(b,c){a.copy(b).applyQuaternion(this.quaternion);this.position.add(a.multiplyScalar(c));return this}}(),translateX:function(){var a=
new n(1,0,0);return function(b){return this.translateOnAxis(a,b)}}(),translateY:function(){var a=new n(0,1,0);return function(b){return this.translateOnAxis(a,b)}}(),translateZ:function(){var a=new n(0,0,1);return function(b){return this.translateOnAxis(a,b)}}(),localToWorld:function(a){return a.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var a=new P;return function(b){return b.applyMatrix4(a.getInverse(this.matrixWorld))}}(),lookAt:function(){var a=new aa,b=new P,c=new n,d=new n;return function(e,
f,g){e.isVector3?c.copy(e):c.set(e,f,g);e=this.parent;this.updateWorldMatrix(!0,!1);d.setFromMatrixPosition(this.matrixWorld);this.isCamera||this.isLight?b.lookAt(d,c,this.up):b.lookAt(c,d,this.up);this.quaternion.setFromRotationMatrix(b);e&&(b.extractRotation(e.matrixWorld),a.setFromRotationMatrix(b),this.quaternion.premultiply(a.inverse()))}}(),add:function(a){if(1<arguments.length){for(var b=0;b<arguments.length;b++)this.add(arguments[b]);return this}if(a===this)return console.error("THREE.Object3D.add: object can't be added as a child of itself.",
a),this;a&&a.isObject3D?(null!==a.parent&&a.parent.remove(a),a.parent=this,a.dispatchEvent({type:"added"}),this.children.push(a)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",a);return this},remove:function(a){if(1<arguments.length){for(var b=0;b<arguments.length;b++)this.remove(arguments[b]);return this}b=this.children.indexOf(a);-1!==b&&(a.parent=null,a.dispatchEvent({type:"removed"}),this.children.splice(b,1));return this},getObjectById:function(a){return this.getObjectByProperty("id",
a)},getObjectByName:function(a){return this.getObjectByProperty("name",a)},getObjectByProperty:function(a,b){if(this[a]===b)return this;for(var c=0,d=this.children.length;c<d;c++){var e=this.children[c].getObjectByProperty(a,b);if(void 0!==e)return e}},getWorldPosition:function(a){void 0===a&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),a=new n);this.updateMatrixWorld(!0);return a.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var a=new n,b=new n;
return function(c){void 0===c&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),c=new aa);this.updateMatrixWorld(!0);this.matrixWorld.decompose(a,c,b);return c}}(),getWorldScale:function(){var a=new n,b=new aa;return function(c){void 0===c&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),c=new n);this.updateMatrixWorld(!0);this.matrixWorld.decompose(a,b,c);return c}}(),getWorldDirection:function(a){void 0===a&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),
a=new n);this.updateMatrixWorld(!0);var b=this.matrixWorld.elements;return a.set(b[8],b[9],b[10]).normalize()},raycast:function(){},traverse:function(a){a(this);for(var b=this.children,c=0,d=b.length;c<d;c++)b[c].traverse(a)},traverseVisible:function(a){if(!1!==this.visible){a(this);for(var b=this.children,c=0,d=b.length;c<d;c++)b[c].traverseVisible(a)}},traverseAncestors:function(a){var b=this.parent;null!==b&&(a(b),b.traverseAncestors(a))},updateMatrix:function(){this.matrix.compose(this.position,
this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(a){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||a)null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,a=!0;for(var b=this.children,c=0,d=b.length;c<d;c++)b[c].updateMatrixWorld(a)},updateWorldMatrix:function(a,b){var c=this.parent;!0===a&&null!==c&&c.updateWorldMatrix(!0,!1);this.matrixAutoUpdate&&
this.updateMatrix();null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix);if(!0===b)for(a=this.children,b=0,c=a.length;b<c;b++)a[b].updateWorldMatrix(!1,!0)},toJSON:function(a){function b(b,c){void 0===b[c.uuid]&&(b[c.uuid]=c.toJSON(a));return c.uuid}function c(a){var b=[],c;for(c in a){var d=a[c];delete d.metadata;b.push(d)}return b}var d=void 0===a||"string"===typeof a,e={};d&&(a={geometries:{},materials:{},textures:{},images:{},
shapes:{}},e.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var f={};f.uuid=this.uuid;f.type=this.type;""!==this.name&&(f.name=this.name);!0===this.castShadow&&(f.castShadow=!0);!0===this.receiveShadow&&(f.receiveShadow=!0);!1===this.visible&&(f.visible=!1);!1===this.frustumCulled&&(f.frustumCulled=!1);0!==this.renderOrder&&(f.renderOrder=this.renderOrder);"{}"!==JSON.stringify(this.userData)&&(f.userData=this.userData);f.layers=this.layers.mask;f.matrix=this.matrix.toArray();!1===
this.matrixAutoUpdate&&(f.matrixAutoUpdate=!1);this.isMesh&&0!==this.drawMode&&(f.drawMode=this.drawMode);if(this.isMesh||this.isLine||this.isPoints){f.geometry=b(a.geometries,this.geometry);var g=this.geometry.parameters;if(void 0!==g&&void 0!==g.shapes)if(g=g.shapes,Array.isArray(g))for(var h=0,k=g.length;h<k;h++)b(a.shapes,g[h]);else b(a.shapes,g)}if(void 0!==this.material)if(Array.isArray(this.material)){g=[];h=0;for(k=this.material.length;h<k;h++)g.push(b(a.materials,this.material[h]));f.material=
g}else f.material=b(a.materials,this.material);if(0<this.children.length)for(f.children=[],h=0;h<this.children.length;h++)f.children.push(this.children[h].toJSON(a).object);if(d){d=c(a.geometries);h=c(a.materials);k=c(a.textures);var m=c(a.images);g=c(a.shapes);0<d.length&&(e.geometries=d);0<h.length&&(e.materials=h);0<k.length&&(e.textures=k);0<m.length&&(e.images=m);0<g.length&&(e.shapes=g)}e.object=f;return e},clone:function(a){return(new this.constructor).copy(this,a)},copy:function(a,b){void 0===
b&&(b=!0);this.name=a.name;this.up.copy(a.up);this.position.copy(a.position);this.quaternion.copy(a.quaternion);this.scale.copy(a.scale);this.matrix.copy(a.matrix);this.matrixWorld.copy(a.matrixWorld);this.matrixAutoUpdate=a.matrixAutoUpdate;this.matrixWorldNeedsUpdate=a.matrixWorldNeedsUpdate;this.layers.mask=a.layers.mask;this.visible=a.visible;this.castShadow=a.castShadow;this.receiveShadow=a.receiveShadow;this.frustumCulled=a.frustumCulled;this.renderOrder=a.renderOrder;this.userData=JSON.parse(JSON.stringify(a.userData));
if(!0===b)for(b=0;b<a.children.length;b++)this.add(a.children[b].clone());return this}});var Xf=0;N.prototype=Object.assign(Object.create(ta.prototype),{constructor:N,isGeometry:!0,applyMatrix:function(a){for(var b=(new ba).getNormalMatrix(a),c=0,d=this.vertices.length;c<d;c++)this.vertices[c].applyMatrix4(a);c=0;for(d=this.faces.length;c<d;c++){a=this.faces[c];a.normal.applyMatrix3(b).normalize();for(var e=0,f=a.vertexNormals.length;e<f;e++)a.vertexNormals[e].applyMatrix3(b).normalize()}null!==this.boundingBox&&
this.computeBoundingBox();null!==this.boundingSphere&&this.computeBoundingSphere();this.normalsNeedUpdate=this.verticesNeedUpdate=!0;return this},rotateX:function(){var a=new P;return function(b){a.makeRotationX(b);this.applyMatrix(a);return this}}(),rotateY:function(){var a=new P;return function(b){a.makeRotationY(b);this.applyMatrix(a);return this}}(),rotateZ:function(){var a=new P;return function(b){a.makeRotationZ(b);this.applyMatrix(a);return this}}(),translate:function(){var a=new P;return function(b,
c,d){a.makeTranslation(b,c,d);this.applyMatrix(a);return this}}(),scale:function(){var a=new P;return function(b,c,d){a.makeScale(b,c,d);this.applyMatrix(a);return this}}(),lookAt:function(){var a=new C;return function(b){a.lookAt(b);a.updateMatrix();this.applyMatrix(a.matrix)}}(),fromBufferGeometry:function(a){function b(a,b,d,e){var f=void 0===h?[]:[c.colors[a].clone(),c.colors[b].clone(),c.colors[d].clone()],l=void 0===g?[]:[(new n).fromArray(g,3*a),(new n).fromArray(g,3*b),(new n).fromArray(g,
3*d)];e=new Qb(a,b,d,l,f,e);c.faces.push(e);void 0!==k&&c.faceVertexUvs[0].push([(new B).fromArray(k,2*a),(new B).fromArray(k,2*b),(new B).fromArray(k,2*d)]);void 0!==m&&c.faceVertexUvs[1].push([(new B).fromArray(m,2*a),(new B).fromArray(m,2*b),(new B).fromArray(m,2*d)])}var c=this,d=null!==a.index?a.index.array:void 0,e=a.attributes,f=e.position.array,g=void 0!==e.normal?e.normal.array:void 0,h=void 0!==e.color?e.color.array:void 0,k=void 0!==e.uv?e.uv.array:void 0,m=void 0!==e.uv2?e.uv2.array:void 0;
void 0!==m&&(this.faceVertexUvs[1]=[]);for(var l=e=0;e<f.length;e+=3,l+=2)c.vertices.push((new n).fromArray(f,e)),void 0!==h&&c.colors.push((new M).fromArray(h,e));var q=a.groups;if(0<q.length)for(e=0;e<q.length;e++){f=q[e];var v=f.start,t=f.count;l=v;for(v+=t;l<v;l+=3)void 0!==d?b(d[l],d[l+1],d[l+2],f.materialIndex):b(l,l+1,l+2,f.materialIndex)}else if(void 0!==d)for(e=0;e<d.length;e+=3)b(d[e],d[e+1],d[e+2]);else for(e=0;e<f.length/3;e+=3)b(e,e+1,e+2);this.computeFaceNormals();null!==a.boundingBox&&
(this.boundingBox=a.boundingBox.clone());null!==a.boundingSphere&&(this.boundingSphere=a.boundingSphere.clone());return this},center:function(){var a=new n;return function(){this.computeBoundingBox();this.boundingBox.getCenter(a).negate();this.translate(a.x,a.y,a.z);return this}}(),normalize:function(){this.computeBoundingSphere();var a=this.boundingSphere.center,b=this.boundingSphere.radius;b=0===b?1:1/b;var c=new P;c.set(b,0,0,-b*a.x,0,b,0,-b*a.y,0,0,b,-b*a.z,0,0,0,1);this.applyMatrix(c);return this},
computeFaceNormals:function(){for(var a=new n,b=new n,c=0,d=this.faces.length;c<d;c++){var e=this.faces[c],f=this.vertices[e.a],g=this.vertices[e.b];a.subVectors(this.vertices[e.c],g);b.subVectors(f,g);a.cross(b);a.normalize();e.normal.copy(a)}},computeVertexNormals:function(a){void 0===a&&(a=!0);var b;var c=Array(this.vertices.length);var d=0;for(b=this.vertices.length;d<b;d++)c[d]=new n;if(a){var e=new n,f=new n;a=0;for(d=this.faces.length;a<d;a++){b=this.faces[a];var g=this.vertices[b.a];var h=
this.vertices[b.b];var k=this.vertices[b.c];e.subVectors(k,h);f.subVectors(g,h);e.cross(f);c[b.a].add(e);c[b.b].add(e);c[b.c].add(e)}}else for(this.computeFaceNormals(),a=0,d=this.faces.length;a<d;a++)b=this.faces[a],c[b.a].add(b.normal),c[b.b].add(b.normal),c[b.c].add(b.normal);d=0;for(b=this.vertices.length;d<b;d++)c[d].normalize();a=0;for(d=this.faces.length;a<d;a++)b=this.faces[a],g=b.vertexNormals,3===g.length?(g[0].copy(c[b.a]),g[1].copy(c[b.b]),g[2].copy(c[b.c])):(g[0]=c[b.a].clone(),g[1]=
c[b.b].clone(),g[2]=c[b.c].clone());0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var a;this.computeFaceNormals();var b=0;for(a=this.faces.length;b<a;b++){var c=this.faces[b];var d=c.vertexNormals;3===d.length?(d[0].copy(c.normal),d[1].copy(c.normal),d[2].copy(c.normal)):(d[0]=c.normal.clone(),d[1]=c.normal.clone(),d[2]=c.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var a,b;var c=0;for(b=this.faces.length;c<
b;c++){var d=this.faces[c];d.__originalFaceNormal?d.__originalFaceNormal.copy(d.normal):d.__originalFaceNormal=d.normal.clone();d.__originalVertexNormals||(d.__originalVertexNormals=[]);var e=0;for(a=d.vertexNormals.length;e<a;e++)d.__originalVertexNormals[e]?d.__originalVertexNormals[e].copy(d.vertexNormals[e]):d.__originalVertexNormals[e]=d.vertexNormals[e].clone()}var f=new N;f.faces=this.faces;e=0;for(a=this.morphTargets.length;e<a;e++){if(!this.morphNormals[e]){this.morphNormals[e]={};this.morphNormals[e].faceNormals=
[];this.morphNormals[e].vertexNormals=[];d=this.morphNormals[e].faceNormals;var g=this.morphNormals[e].vertexNormals;c=0;for(b=this.faces.length;c<b;c++){var h=new n;var k={a:new n,b:new n,c:new n};d.push(h);g.push(k)}}g=this.morphNormals[e];f.vertices=this.morphTargets[e].vertices;f.computeFaceNormals();f.computeVertexNormals();c=0;for(b=this.faces.length;c<b;c++)d=this.faces[c],h=g.faceNormals[c],k=g.vertexNormals[c],h.copy(d.normal),k.a.copy(d.vertexNormals[0]),k.b.copy(d.vertexNormals[1]),k.c.copy(d.vertexNormals[2])}c=
0;for(b=this.faces.length;c<b;c++)d=this.faces[c],d.normal=d.__originalFaceNormal,d.vertexNormals=d.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Ja);this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Ua);this.boundingSphere.setFromPoints(this.vertices)},merge:function(a,b,c){if(a&&a.isGeometry){var d,e=this.vertices.length,f=this.vertices,g=a.vertices,h=this.faces,
k=a.faces,m=this.faceVertexUvs[0],l=a.faceVertexUvs[0],q=this.colors,n=a.colors;void 0===c&&(c=0);void 0!==b&&(d=(new ba).getNormalMatrix(b));a=0;for(var t=g.length;a<t;a++){var r=g[a].clone();void 0!==b&&r.applyMatrix4(b);f.push(r)}a=0;for(t=n.length;a<t;a++)q.push(n[a].clone());a=0;for(t=k.length;a<t;a++){g=k[a];var u=g.vertexNormals;n=g.vertexColors;q=new Qb(g.a+e,g.b+e,g.c+e);q.normal.copy(g.normal);void 0!==d&&q.normal.applyMatrix3(d).normalize();b=0;for(f=u.length;b<f;b++)r=u[b].clone(),void 0!==
d&&r.applyMatrix3(d).normalize(),q.vertexNormals.push(r);q.color.copy(g.color);b=0;for(f=n.length;b<f;b++)r=n[b],q.vertexColors.push(r.clone());q.materialIndex=g.materialIndex+c;h.push(q)}a=0;for(t=l.length;a<t;a++)if(c=l[a],d=[],void 0!==c){b=0;for(f=c.length;b<f;b++)d.push(c[b].clone());m.push(d)}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",a)},mergeMesh:function(a){a&&a.isMesh?(a.matrixAutoUpdate&&a.updateMatrix(),this.merge(a.geometry,a.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",
a)},mergeVertices:function(){var a={},b=[],c=[],d=Math.pow(10,4),e;var f=0;for(e=this.vertices.length;f<e;f++){var g=this.vertices[f];g=Math.round(g.x*d)+"_"+Math.round(g.y*d)+"_"+Math.round(g.z*d);void 0===a[g]?(a[g]=f,b.push(this.vertices[f]),c[f]=b.length-1):c[f]=c[a[g]]}a=[];f=0;for(e=this.faces.length;f<e;f++)for(d=this.faces[f],d.a=c[d.a],d.b=c[d.b],d.c=c[d.c],d=[d.a,d.b,d.c],g=0;3>g;g++)if(d[g]===d[(g+1)%3]){a.push(f);break}for(f=a.length-1;0<=f;f--)for(d=a[f],this.faces.splice(d,1),c=0,e=
this.faceVertexUvs.length;c<e;c++)this.faceVertexUvs[c].splice(d,1);f=this.vertices.length-b.length;this.vertices=b;return f},setFromPoints:function(a){this.vertices=[];for(var b=0,c=a.length;b<c;b++){var d=a[b];this.vertices.push(new n(d.x,d.y,d.z||0))}return this},sortFacesByMaterialIndex:function(){for(var a=this.faces,b=a.length,c=0;c<b;c++)a[c]._id=c;a.sort(function(a,b){return a.materialIndex-b.materialIndex});var d=this.faceVertexUvs[0],e=this.faceVertexUvs[1],f,g;d&&d.length===b&&(f=[]);e&&
e.length===b&&(g=[]);for(c=0;c<b;c++){var h=a[c]._id;f&&f.push(d[h]);g&&g.push(e[h])}f&&(this.faceVertexUvs[0]=f);g&&(this.faceVertexUvs[1]=g)},toJSON:function(){function a(a,b,c){return c?a|1<<b:a&~(1<<b)}function b(a){var b=a.x.toString()+a.y.toString()+a.z.toString();if(void 0!==m[b])return m[b];m[b]=k.length/3;k.push(a.x,a.y,a.z);return m[b]}function c(a){var b=a.r.toString()+a.g.toString()+a.b.toString();if(void 0!==q[b])return q[b];q[b]=l.length;l.push(a.getHex());return q[b]}function d(a){var b=
a.x.toString()+a.y.toString();if(void 0!==t[b])return t[b];t[b]=n.length/2;n.push(a.x,a.y);return t[b]}var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};e.uuid=this.uuid;e.type=this.type;""!==this.name&&(e.name=this.name);if(void 0!==this.parameters){var f=this.parameters,g;for(g in f)void 0!==f[g]&&(e[g]=f[g]);return e}f=[];for(g=0;g<this.vertices.length;g++){var h=this.vertices[g];f.push(h.x,h.y,h.z)}h=[];var k=[],m={},l=[],q={},n=[],t={};for(g=0;g<this.faces.length;g++){var r=
this.faces[g],u=void 0!==this.faceVertexUvs[0][g],x=0<r.normal.length(),A=0<r.vertexNormals.length,w=1!==r.color.r||1!==r.color.g||1!==r.color.b,y=0<r.vertexColors.length,D=0;D=a(D,0,0);D=a(D,1,!0);D=a(D,2,!1);D=a(D,3,u);D=a(D,4,x);D=a(D,5,A);D=a(D,6,w);D=a(D,7,y);h.push(D);h.push(r.a,r.b,r.c);h.push(r.materialIndex);u&&(u=this.faceVertexUvs[0][g],h.push(d(u[0]),d(u[1]),d(u[2])));x&&h.push(b(r.normal));A&&(x=r.vertexNormals,h.push(b(x[0]),b(x[1]),b(x[2])));w&&h.push(c(r.color));y&&(r=r.vertexColors,
h.push(c(r[0]),c(r[1]),c(r[2])))}e.data={};e.data.vertices=f;e.data.normals=k;0<l.length&&(e.data.colors=l);0<n.length&&(e.data.uvs=[n]);e.data.faces=h;return e},clone:function(){return(new N).copy(this)},copy:function(a){var b,c,d;this.vertices=[];this.colors=[];this.faces=[];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingSphere=this.boundingBox=null;this.name=a.name;var e=a.vertices;var f=0;for(b=e.length;f<
b;f++)this.vertices.push(e[f].clone());e=a.colors;f=0;for(b=e.length;f<b;f++)this.colors.push(e[f].clone());e=a.faces;f=0;for(b=e.length;f<b;f++)this.faces.push(e[f].clone());f=0;for(b=a.faceVertexUvs.length;f<b;f++){var g=a.faceVertexUvs[f];void 0===this.faceVertexUvs[f]&&(this.faceVertexUvs[f]=[]);e=0;for(c=g.length;e<c;e++){var h=g[e],k=[];var m=0;for(d=h.length;m<d;m++)k.push(h[m].clone());this.faceVertexUvs[f].push(k)}}m=a.morphTargets;f=0;for(b=m.length;f<b;f++){d={};d.name=m[f].name;if(void 0!==
m[f].vertices)for(d.vertices=[],e=0,c=m[f].vertices.length;e<c;e++)d.vertices.push(m[f].vertices[e].clone());if(void 0!==m[f].normals)for(d.normals=[],e=0,c=m[f].normals.length;e<c;e++)d.normals.push(m[f].normals[e].clone());this.morphTargets.push(d)}m=a.morphNormals;f=0;for(b=m.length;f<b;f++){d={};if(void 0!==m[f].vertexNormals)for(d.vertexNormals=[],e=0,c=m[f].vertexNormals.length;e<c;e++)g=m[f].vertexNormals[e],h={},h.a=g.a.clone(),h.b=g.b.clone(),h.c=g.c.clone(),d.vertexNormals.push(h);if(void 0!==
m[f].faceNormals)for(d.faceNormals=[],e=0,c=m[f].faceNormals.length;e<c;e++)d.faceNormals.push(m[f].faceNormals[e].clone());this.morphNormals.push(d)}e=a.skinWeights;f=0;for(b=e.length;f<b;f++)this.skinWeights.push(e[f].clone());e=a.skinIndices;f=0;for(b=e.length;f<b;f++)this.skinIndices.push(e[f].clone());e=a.lineDistances;f=0;for(b=e.length;f<b;f++)this.lineDistances.push(e[f]);f=a.boundingBox;null!==f&&(this.boundingBox=f.clone());f=a.boundingSphere;null!==f&&(this.boundingSphere=f.clone());this.elementsNeedUpdate=
a.elementsNeedUpdate;this.verticesNeedUpdate=a.verticesNeedUpdate;this.uvsNeedUpdate=a.uvsNeedUpdate;this.normalsNeedUpdate=a.normalsNeedUpdate;this.colorsNeedUpdate=a.colorsNeedUpdate;this.lineDistancesNeedUpdate=a.lineDistancesNeedUpdate;this.groupsNeedUpdate=a.groupsNeedUpdate;return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});Object.defineProperty(S.prototype,"needsUpdate",{set:function(a){!0===a&&this.version++}});Object.assign(S.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},
setArray:function(a){if(Array.isArray(a))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==a?a.length/this.itemSize:0;this.array=a;return this},setDynamic:function(a){this.dynamic=a;return this},copy:function(a){this.name=a.name;this.array=new a.array.constructor(a.array);this.itemSize=a.itemSize;this.count=a.count;this.normalized=a.normalized;this.dynamic=a.dynamic;return this},copyAt:function(a,b,c){a*=this.itemSize;c*=b.itemSize;for(var d=0,e=this.itemSize;d<
e;d++)this.array[a+d]=b.array[c+d];return this},copyArray:function(a){this.array.set(a);return this},copyColorsArray:function(a){for(var b=this.array,c=0,d=0,e=a.length;d<e;d++){var f=a[d];void 0===f&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",d),f=new M);b[c++]=f.r;b[c++]=f.g;b[c++]=f.b}return this},copyVector2sArray:function(a){for(var b=this.array,c=0,d=0,e=a.length;d<e;d++){var f=a[d];void 0===f&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",
d),f=new B);b[c++]=f.x;b[c++]=f.y}return this},copyVector3sArray:function(a){for(var b=this.array,c=0,d=0,e=a.length;d<e;d++){var f=a[d];void 0===f&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",d),f=new n);b[c++]=f.x;b[c++]=f.y;b[c++]=f.z}return this},copyVector4sArray:function(a){for(var b=this.array,c=0,d=0,e=a.length;d<e;d++){var f=a[d];void 0===f&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",d),f=new Y);b[c++]=f.x;b[c++]=f.y;
b[c++]=f.z;b[c++]=f.w}return this},set:function(a,b){void 0===b&&(b=0);this.array.set(a,b);return this},getX:function(a){return this.array[a*this.itemSize]},setX:function(a,b){this.array[a*this.itemSize]=b;return this},getY:function(a){return this.array[a*this.itemSize+1]},setY:function(a,b){this.array[a*this.itemSize+1]=b;return this},getZ:function(a){return this.array[a*this.itemSize+2]},setZ:function(a,b){this.array[a*this.itemSize+2]=b;return this},getW:function(a){return this.array[a*this.itemSize+
3]},setW:function(a,b){this.array[a*this.itemSize+3]=b;return this},setXY:function(a,b,c){a*=this.itemSize;this.array[a+0]=b;this.array[a+1]=c;return this},setXYZ:function(a,b,c,d){a*=this.itemSize;this.array[a+0]=b;this.array[a+1]=c;this.array[a+2]=d;return this},setXYZW:function(a,b,c,d,e){a*=this.itemSize;this.array[a+0]=b;this.array[a+1]=c;this.array[a+2]=d;this.array[a+3]=e;return this},onUpload:function(a){this.onUploadCallback=a;return this},clone:function(){return(new this.constructor(this.array,
this.itemSize)).copy(this)}});xc.prototype=Object.create(S.prototype);xc.prototype.constructor=xc;yc.prototype=Object.create(S.prototype);yc.prototype.constructor=yc;zc.prototype=Object.create(S.prototype);zc.prototype.constructor=zc;Ac.prototype=Object.create(S.prototype);Ac.prototype.constructor=Ac;sb.prototype=Object.create(S.prototype);sb.prototype.constructor=sb;Bc.prototype=Object.create(S.prototype);Bc.prototype.constructor=Bc;tb.prototype=Object.create(S.prototype);tb.prototype.constructor=
tb;E.prototype=Object.create(S.prototype);E.prototype.constructor=E;Cc.prototype=Object.create(S.prototype);Cc.prototype.constructor=Cc;Object.assign(Qe.prototype,{computeGroups:function(a){var b=[],c=void 0;a=a.faces;for(var d=0;d<a.length;d++){var e=a[d];if(e.materialIndex!==c){c=e.materialIndex;void 0!==f&&(f.count=3*d-f.start,b.push(f));var f={start:3*d,materialIndex:c}}}void 0!==f&&(f.count=3*d-f.start,b.push(f));this.groups=b},fromGeometry:function(a){var b=a.faces,c=a.vertices,d=a.faceVertexUvs,
e=d[0]&&0<d[0].length,f=d[1]&&0<d[1].length,g=a.morphTargets,h=g.length;if(0<h){var k=[];for(var m=0;m<h;m++)k[m]={name:g[m].name,data:[]};this.morphTargets.position=k}var l=a.morphNormals,q=l.length;if(0<q){var n=[];for(m=0;m<q;m++)n[m]={name:l[m].name,data:[]};this.morphTargets.normal=n}var t=a.skinIndices,r=a.skinWeights,u=t.length===c.length,x=r.length===c.length;0<c.length&&0===b.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(m=0;m<b.length;m++){var A=
b[m];this.vertices.push(c[A.a],c[A.b],c[A.c]);var w=A.vertexNormals;3===w.length?this.normals.push(w[0],w[1],w[2]):(w=A.normal,this.normals.push(w,w,w));w=A.vertexColors;3===w.length?this.colors.push(w[0],w[1],w[2]):(w=A.color,this.colors.push(w,w,w));!0===e&&(w=d[0][m],void 0!==w?this.uvs.push(w[0],w[1],w[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",m),this.uvs.push(new B,new B,new B)));!0===f&&(w=d[1][m],void 0!==w?this.uvs2.push(w[0],w[1],w[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",
m),this.uvs2.push(new B,new B,new B)));for(w=0;w<h;w++){var y=g[w].vertices;k[w].data.push(y[A.a],y[A.b],y[A.c])}for(w=0;w<q;w++)y=l[w].vertexNormals[m],n[w].data.push(y.a,y.b,y.c);u&&this.skinIndices.push(t[A.a],t[A.b],t[A.c]);x&&this.skinWeights.push(r[A.a],r[A.b],r[A.c])}this.computeGroups(a);this.verticesNeedUpdate=a.verticesNeedUpdate;this.normalsNeedUpdate=a.normalsNeedUpdate;this.colorsNeedUpdate=a.colorsNeedUpdate;this.uvsNeedUpdate=a.uvsNeedUpdate;this.groupsNeedUpdate=a.groupsNeedUpdate;
return this}});var Yf=1;z.prototype=Object.assign(Object.create(ta.prototype),{constructor:z,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(a){Array.isArray(a)?this.index=new (65535<Re(a)?tb:sb)(a,1):this.index=a},addAttribute:function(a,b,c){if(!(b&&b.isBufferAttribute||b&&b.isInterleavedBufferAttribute))return console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(a,new S(b,c));if("index"===a)return console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),
this.setIndex(b),this;this.attributes[a]=b;return this},getAttribute:function(a){return this.attributes[a]},removeAttribute:function(a){delete this.attributes[a];return this},addGroup:function(a,b,c){this.groups.push({start:a,count:b,materialIndex:void 0!==c?c:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(a,b){this.drawRange.start=a;this.drawRange.count=b},applyMatrix:function(a){var b=this.attributes.position;void 0!==b&&(a.applyToBufferAttribute(b),b.needsUpdate=!0);var c=this.attributes.normal;
void 0!==c&&(b=(new ba).getNormalMatrix(a),b.applyToBufferAttribute(c),c.needsUpdate=!0);c=this.attributes.tangent;void 0!==c&&(b=(new ba).getNormalMatrix(a),b.applyToBufferAttribute(c),c.needsUpdate=!0);null!==this.boundingBox&&this.computeBoundingBox();null!==this.boundingSphere&&this.computeBoundingSphere();return this},rotateX:function(){var a=new P;return function(b){a.makeRotationX(b);this.applyMatrix(a);return this}}(),rotateY:function(){var a=new P;return function(b){a.makeRotationY(b);this.applyMatrix(a);
return this}}(),rotateZ:function(){var a=new P;return function(b){a.makeRotationZ(b);this.applyMatrix(a);return this}}(),translate:function(){var a=new P;return function(b,c,d){a.makeTranslation(b,c,d);this.applyMatrix(a);return this}}(),scale:function(){var a=new P;return function(b,c,d){a.makeScale(b,c,d);this.applyMatrix(a);return this}}(),lookAt:function(){var a=new C;return function(b){a.lookAt(b);a.updateMatrix();this.applyMatrix(a.matrix)}}(),center:function(){var a=new n;return function(){this.computeBoundingBox();
this.boundingBox.getCenter(a).negate();this.translate(a.x,a.y,a.z);return this}}(),setFromObject:function(a){var b=a.geometry;if(a.isPoints||a.isLine){a=new E(3*b.vertices.length,3);var c=new E(3*b.colors.length,3);this.addAttribute("position",a.copyVector3sArray(b.vertices));this.addAttribute("color",c.copyColorsArray(b.colors));b.lineDistances&&b.lineDistances.length===b.vertices.length&&(a=new E(b.lineDistances.length,1),this.addAttribute("lineDistance",a.copyArray(b.lineDistances)));null!==b.boundingSphere&&
(this.boundingSphere=b.boundingSphere.clone());null!==b.boundingBox&&(this.boundingBox=b.boundingBox.clone())}else a.isMesh&&b&&b.isGeometry&&this.fromGeometry(b);return this},setFromPoints:function(a){for(var b=[],c=0,d=a.length;c<d;c++){var e=a[c];b.push(e.x,e.y,e.z||0)}this.addAttribute("position",new E(b,3));return this},updateFromObject:function(a){var b=a.geometry;if(a.isMesh){var c=b.__directGeometry;!0===b.elementsNeedUpdate&&(c=void 0,b.elementsNeedUpdate=!1);if(void 0===c)return this.fromGeometry(b);
c.verticesNeedUpdate=b.verticesNeedUpdate;c.normalsNeedUpdate=b.normalsNeedUpdate;c.colorsNeedUpdate=b.colorsNeedUpdate;c.uvsNeedUpdate=b.uvsNeedUpdate;c.groupsNeedUpdate=b.groupsNeedUpdate;b.verticesNeedUpdate=!1;b.normalsNeedUpdate=!1;b.colorsNeedUpdate=!1;b.uvsNeedUpdate=!1;b.groupsNeedUpdate=!1;b=c}!0===b.verticesNeedUpdate&&(c=this.attributes.position,void 0!==c&&(c.copyVector3sArray(b.vertices),c.needsUpdate=!0),b.verticesNeedUpdate=!1);!0===b.normalsNeedUpdate&&(c=this.attributes.normal,void 0!==
c&&(c.copyVector3sArray(b.normals),c.needsUpdate=!0),b.normalsNeedUpdate=!1);!0===b.colorsNeedUpdate&&(c=this.attributes.color,void 0!==c&&(c.copyColorsArray(b.colors),c.needsUpdate=!0),b.colorsNeedUpdate=!1);b.uvsNeedUpdate&&(c=this.attributes.uv,void 0!==c&&(c.copyVector2sArray(b.uvs),c.needsUpdate=!0),b.uvsNeedUpdate=!1);b.lineDistancesNeedUpdate&&(c=this.attributes.lineDistance,void 0!==c&&(c.copyArray(b.lineDistances),c.needsUpdate=!0),b.lineDistancesNeedUpdate=!1);b.groupsNeedUpdate&&(b.computeGroups(a.geometry),
this.groups=b.groups,b.groupsNeedUpdate=!1);return this},fromGeometry:function(a){a.__directGeometry=(new Qe).fromGeometry(a);return this.fromDirectGeometry(a.__directGeometry)},fromDirectGeometry:function(a){var b=new Float32Array(3*a.vertices.length);this.addAttribute("position",(new S(b,3)).copyVector3sArray(a.vertices));0<a.normals.length&&(b=new Float32Array(3*a.normals.length),this.addAttribute("normal",(new S(b,3)).copyVector3sArray(a.normals)));0<a.colors.length&&(b=new Float32Array(3*a.colors.length),
this.addAttribute("color",(new S(b,3)).copyColorsArray(a.colors)));0<a.uvs.length&&(b=new Float32Array(2*a.uvs.length),this.addAttribute("uv",(new S(b,2)).copyVector2sArray(a.uvs)));0<a.uvs2.length&&(b=new Float32Array(2*a.uvs2.length),this.addAttribute("uv2",(new S(b,2)).copyVector2sArray(a.uvs2)));this.groups=a.groups;for(var c in a.morphTargets){b=[];for(var d=a.morphTargets[c],e=0,f=d.length;e<f;e++){var g=d[e],h=new E(3*g.data.length,3);h.name=g.name;b.push(h.copyVector3sArray(g.data))}this.morphAttributes[c]=
b}0<a.skinIndices.length&&(c=new E(4*a.skinIndices.length,4),this.addAttribute("skinIndex",c.copyVector4sArray(a.skinIndices)));0<a.skinWeights.length&&(c=new E(4*a.skinWeights.length,4),this.addAttribute("skinWeight",c.copyVector4sArray(a.skinWeights)));null!==a.boundingSphere&&(this.boundingSphere=a.boundingSphere.clone());null!==a.boundingBox&&(this.boundingBox=a.boundingBox.clone());return this},computeBoundingBox:function(){var a=new Ja;return function(){null===this.boundingBox&&(this.boundingBox=
new Ja);var b=this.attributes.position,c=this.morphAttributes.position;if(void 0!==b){if(this.boundingBox.setFromBufferAttribute(b),c){b=0;for(var d=c.length;b<d;b++)a.setFromBufferAttribute(c[b]),this.boundingBox.expandByPoint(a.min),this.boundingBox.expandByPoint(a.max)}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',
this)}}(),computeBoundingSphere:function(){var a=new Ja,b=new Ja,c=new n;return function(){null===this.boundingSphere&&(this.boundingSphere=new Ua);var d=this.attributes.position,e=this.morphAttributes.position;if(d){var f=this.boundingSphere.center;a.setFromBufferAttribute(d);if(e)for(var g=0,h=e.length;g<h;g++){var k=e[g];b.setFromBufferAttribute(k);a.expandByPoint(b.min);a.expandByPoint(b.max)}a.getCenter(f);var m=0;g=0;for(h=d.count;g<h;g++)c.fromBufferAttribute(d,g),m=Math.max(m,f.distanceToSquared(c));
if(e)for(g=0,h=e.length;g<h;g++){k=e[g];d=0;for(var l=k.count;d<l;d++)c.fromBufferAttribute(k,g),m=Math.max(m,f.distanceToSquared(c))}this.boundingSphere.radius=Math.sqrt(m);isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var a=this.index,b=this.attributes;if(b.position){var c=b.position.array;if(void 0===
b.normal)this.addAttribute("normal",new S(new Float32Array(c.length),3));else for(var d=b.normal.array,e=0,f=d.length;e<f;e++)d[e]=0;d=b.normal.array;var g=new n,h=new n,k=new n,m=new n,l=new n;if(a){var q=a.array;e=0;for(f=a.count;e<f;e+=3){a=3*q[e+0];var v=3*q[e+1];var t=3*q[e+2];g.fromArray(c,a);h.fromArray(c,v);k.fromArray(c,t);m.subVectors(k,h);l.subVectors(g,h);m.cross(l);d[a]+=m.x;d[a+1]+=m.y;d[a+2]+=m.z;d[v]+=m.x;d[v+1]+=m.y;d[v+2]+=m.z;d[t]+=m.x;d[t+1]+=m.y;d[t+2]+=m.z}}else for(e=0,f=c.length;e<
f;e+=9)g.fromArray(c,e),h.fromArray(c,e+3),k.fromArray(c,e+6),m.subVectors(k,h),l.subVectors(g,h),m.cross(l),d[e]=m.x,d[e+1]=m.y,d[e+2]=m.z,d[e+3]=m.x,d[e+4]=m.y,d[e+5]=m.z,d[e+6]=m.x,d[e+7]=m.y,d[e+8]=m.z;this.normalizeNormals();b.normal.needsUpdate=!0}},merge:function(a,b){if(a&&a.isBufferGeometry){void 0===b&&(b=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var c=this.attributes,
d;for(d in c)if(void 0!==a.attributes[d]){var e=c[d].array,f=a.attributes[d],g=f.array,h=0;for(f=f.itemSize*b;h<g.length;h++,f++)e[f]=g[h]}return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",a)},normalizeNormals:function(){var a=new n;return function(){for(var b=this.attributes.normal,c=0,d=b.count;c<d;c++)a.x=b.getX(c),a.y=b.getY(c),a.z=b.getZ(c),a.normalize(),b.setXYZ(c,a.x,a.y,a.z)}}(),toNonIndexed:function(){function a(a,b){var c=a.array;
a=a.itemSize;for(var d=new c.constructor(b.length*a),e,f=0,g=0,h=b.length;g<h;g++){e=b[g]*a;for(var k=0;k<a;k++)d[f++]=c[e++]}return new S(d,a)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var b=new z,c=this.index.array,d=this.attributes,e;for(e in d){var f=d[e];f=a(f,c);b.addAttribute(e,f)}var g=this.morphAttributes;for(e in g){var h=[],k=g[e];d=0;for(var m=k.length;d<m;d++)f=k[d],f=a(f,c),h.push(f);b.morphAttributes[e]=h}c=
this.groups;d=0;for(e=c.length;d<e;d++)f=c[d],b.addGroup(f.start,f.count,f.materialIndex);return b},toJSON:function(){var a={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};a.uuid=this.uuid;a.type=this.type;""!==this.name&&(a.name=this.name);0<Object.keys(this.userData).length&&(a.userData=this.userData);if(void 0!==this.parameters){var b=this.parameters;for(m in b)void 0!==b[m]&&(a[m]=b[m]);return a}a.data={attributes:{}};b=this.index;null!==b&&(a.data.index={type:b.array.constructor.name,
array:Array.prototype.slice.call(b.array)});var c=this.attributes;for(m in c){b=c[m];var d={itemSize:b.itemSize,type:b.array.constructor.name,array:Array.prototype.slice.call(b.array),normalized:b.normalized};""!==b.name&&(d.name=b.name);a.data.attributes[m]=d}c={};var e=!1;for(m in this.morphAttributes){for(var f=this.morphAttributes[m],g=[],h=0,k=f.length;h<k;h++)b=f[h],d={itemSize:b.itemSize,type:b.array.constructor.name,array:Array.prototype.slice.call(b.array),normalized:b.normalized},""!==b.name&&
(d.name=b.name),g.push(d);0<g.length&&(c[m]=g,e=!0)}e&&(a.data.morphAttributes=c);var m=this.groups;0<m.length&&(a.data.groups=JSON.parse(JSON.stringify(m)));m=this.boundingSphere;null!==m&&(a.data.boundingSphere={center:m.center.toArray(),radius:m.radius});return a},clone:function(){return(new z).copy(this)},copy:function(a){var b;this.index=null;this.attributes={};this.morphAttributes={};this.groups=[];this.boundingSphere=this.boundingBox=null;this.name=a.name;var c=a.index;null!==c&&this.setIndex(c.clone());
c=a.attributes;for(g in c)this.addAttribute(g,c[g].clone());var d=a.morphAttributes;for(g in d){var e=[],f=d[g];c=0;for(b=f.length;c<b;c++)e.push(f[c].clone());this.morphAttributes[g]=e}var g=a.groups;c=0;for(b=g.length;c<b;c++)d=g[c],this.addGroup(d.start,d.count,d.materialIndex);g=a.boundingBox;null!==g&&(this.boundingBox=g.clone());g=a.boundingSphere;null!==g&&(this.boundingSphere=g.clone());this.drawRange.start=a.drawRange.start;this.drawRange.count=a.drawRange.count;this.userData=a.userData;
return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});Rb.prototype=Object.create(N.prototype);Rb.prototype.constructor=Rb;ub.prototype=Object.create(z.prototype);ub.prototype.constructor=ub;Dc.prototype=Object.create(N.prototype);Dc.prototype.constructor=Dc;vb.prototype=Object.create(z.prototype);vb.prototype.constructor=vb;var $f=0;O.prototype=Object.assign(Object.create(ta.prototype),{constructor:O,isMaterial:!0,onBeforeCompile:function(){},setValues:function(a){if(void 0!==a)for(var b in a){var c=
a[b];if(void 0===c)console.warn("THREE.Material: '"+b+"' parameter is undefined.");else if("shading"===b)console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===c?!0:!1;else{var d=this[b];void 0===d?console.warn("THREE."+this.type+": '"+b+"' is not a property of this material."):d&&d.isColor?d.set(c):d&&d.isVector3&&c&&c.isVector3?d.copy(c):this[b]=c}}},toJSON:function(a){function b(a){var b=[],c;for(c in a){var d=a[c];delete d.metadata;
b.push(d)}return b}var c=void 0===a||"string"===typeof a;c&&(a={textures:{},images:{}});var d={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};d.uuid=this.uuid;d.type=this.type;""!==this.name&&(d.name=this.name);this.color&&this.color.isColor&&(d.color=this.color.getHex());void 0!==this.roughness&&(d.roughness=this.roughness);void 0!==this.metalness&&(d.metalness=this.metalness);this.emissive&&this.emissive.isColor&&(d.emissive=this.emissive.getHex());1!==this.emissiveIntensity&&
(d.emissiveIntensity=this.emissiveIntensity);this.specular&&this.specular.isColor&&(d.specular=this.specular.getHex());void 0!==this.shininess&&(d.shininess=this.shininess);void 0!==this.clearCoat&&(d.clearCoat=this.clearCoat);void 0!==this.clearCoatRoughness&&(d.clearCoatRoughness=this.clearCoatRoughness);this.map&&this.map.isTexture&&(d.map=this.map.toJSON(a).uuid);this.alphaMap&&this.alphaMap.isTexture&&(d.alphaMap=this.alphaMap.toJSON(a).uuid);this.lightMap&&this.lightMap.isTexture&&(d.lightMap=
this.lightMap.toJSON(a).uuid);this.aoMap&&this.aoMap.isTexture&&(d.aoMap=this.aoMap.toJSON(a).uuid,d.aoMapIntensity=this.aoMapIntensity);this.bumpMap&&this.bumpMap.isTexture&&(d.bumpMap=this.bumpMap.toJSON(a).uuid,d.bumpScale=this.bumpScale);this.normalMap&&this.normalMap.isTexture&&(d.normalMap=this.normalMap.toJSON(a).uuid,d.normalMapType=this.normalMapType,d.normalScale=this.normalScale.toArray());this.displacementMap&&this.displacementMap.isTexture&&(d.displacementMap=this.displacementMap.toJSON(a).uuid,
d.displacementScale=this.displacementScale,d.displacementBias=this.displacementBias);this.roughnessMap&&this.roughnessMap.isTexture&&(d.roughnessMap=this.roughnessMap.toJSON(a).uuid);this.metalnessMap&&this.metalnessMap.isTexture&&(d.metalnessMap=this.metalnessMap.toJSON(a).uuid);this.emissiveMap&&this.emissiveMap.isTexture&&(d.emissiveMap=this.emissiveMap.toJSON(a).uuid);this.specularMap&&this.specularMap.isTexture&&(d.specularMap=this.specularMap.toJSON(a).uuid);this.envMap&&this.envMap.isTexture&&
(d.envMap=this.envMap.toJSON(a).uuid,d.reflectivity=this.reflectivity,void 0!==this.combine&&(d.combine=this.combine),void 0!==this.envMapIntensity&&(d.envMapIntensity=this.envMapIntensity));this.gradientMap&&this.gradientMap.isTexture&&(d.gradientMap=this.gradientMap.toJSON(a).uuid);void 0!==this.size&&(d.size=this.size);void 0!==this.sizeAttenuation&&(d.sizeAttenuation=this.sizeAttenuation);1!==this.blending&&(d.blending=this.blending);!0===this.flatShading&&(d.flatShading=this.flatShading);0!==
this.side&&(d.side=this.side);0!==this.vertexColors&&(d.vertexColors=this.vertexColors);1>this.opacity&&(d.opacity=this.opacity);!0===this.transparent&&(d.transparent=this.transparent);d.depthFunc=this.depthFunc;d.depthTest=this.depthTest;d.depthWrite=this.depthWrite;0!==this.rotation&&(d.rotation=this.rotation);!0===this.polygonOffset&&(d.polygonOffset=!0);0!==this.polygonOffsetFactor&&(d.polygonOffsetFactor=this.polygonOffsetFactor);0!==this.polygonOffsetUnits&&(d.polygonOffsetUnits=this.polygonOffsetUnits);
1!==this.linewidth&&(d.linewidth=this.linewidth);void 0!==this.dashSize&&(d.dashSize=this.dashSize);void 0!==this.gapSize&&(d.gapSize=this.gapSize);void 0!==this.scale&&(d.scale=this.scale);!0===this.dithering&&(d.dithering=!0);0<this.alphaTest&&(d.alphaTest=this.alphaTest);!0===this.premultipliedAlpha&&(d.premultipliedAlpha=this.premultipliedAlpha);!0===this.wireframe&&(d.wireframe=this.wireframe);1<this.wireframeLinewidth&&(d.wireframeLinewidth=this.wireframeLinewidth);"round"!==this.wireframeLinecap&&
(d.wireframeLinecap=this.wireframeLinecap);"round"!==this.wireframeLinejoin&&(d.wireframeLinejoin=this.wireframeLinejoin);!0===this.morphTargets&&(d.morphTargets=!0);!0===this.skinning&&(d.skinning=!0);!1===this.visible&&(d.visible=!1);"{}"!==JSON.stringify(this.userData)&&(d.userData=this.userData);c&&(c=b(a.textures),a=b(a.images),0<c.length&&(d.textures=c),0<a.length&&(d.images=a));return d},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.name=a.name;this.fog=a.fog;
this.lights=a.lights;this.blending=a.blending;this.side=a.side;this.flatShading=a.flatShading;this.vertexColors=a.vertexColors;this.opacity=a.opacity;this.transparent=a.transparent;this.blendSrc=a.blendSrc;this.blendDst=a.blendDst;this.blendEquation=a.blendEquation;this.blendSrcAlpha=a.blendSrcAlpha;this.blendDstAlpha=a.blendDstAlpha;this.blendEquationAlpha=a.blendEquationAlpha;this.depthFunc=a.depthFunc;this.depthTest=a.depthTest;this.depthWrite=a.depthWrite;this.colorWrite=a.colorWrite;this.precision=
a.precision;this.polygonOffset=a.polygonOffset;this.polygonOffsetFactor=a.polygonOffsetFactor;this.polygonOffsetUnits=a.polygonOffsetUnits;this.dithering=a.dithering;this.alphaTest=a.alphaTest;this.premultipliedAlpha=a.premultipliedAlpha;this.visible=a.visible;this.userData=JSON.parse(JSON.stringify(a.userData));this.clipShadows=a.clipShadows;this.clipIntersection=a.clipIntersection;var b=a.clippingPlanes,c=null;if(null!==b){var d=b.length;c=Array(d);for(var e=0;e!==d;++e)c[e]=b[e].clone()}this.clippingPlanes=
c;this.shadowSide=a.shadowSide;return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});Ca.prototype=Object.create(O.prototype);Ca.prototype.constructor=Ca;Ca.prototype.isShaderMaterial=!0;Ca.prototype.copy=function(a){O.prototype.copy.call(this,a);this.fragmentShader=a.fragmentShader;this.vertexShader=a.vertexShader;this.uniforms=Pb(a.uniforms);this.defines=Object.assign({},a.defines);this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.lights=a.lights;this.clipping=
a.clipping;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.morphNormals=a.morphNormals;this.extensions=a.extensions;return this};Ca.prototype.toJSON=function(a){var b=O.prototype.toJSON.call(this,a);b.uniforms={};for(var c in this.uniforms){var d=this.uniforms[c].value;b.uniforms[c]=d&&d.isTexture?{type:"t",value:d.toJSON(a).uuid}:d&&d.isColor?{type:"c",value:d.getHex()}:d&&d.isVector2?{type:"v2",value:d.toArray()}:d&&d.isVector3?{type:"v3",value:d.toArray()}:d&&d.isVector4?{type:"v4",
value:d.toArray()}:d&&d.isMatrix3?{type:"m3",value:d.toArray()}:d&&d.isMatrix4?{type:"m4",value:d.toArray()}:{value:d}}0<Object.keys(this.defines).length&&(b.defines=this.defines);b.vertexShader=this.vertexShader;b.fragmentShader=this.fragmentShader;a={};for(var e in this.extensions)!0===this.extensions[e]&&(a[e]=!0);0<Object.keys(a).length&&(b.extensions=a);return b};Object.assign(wb.prototype,{set:function(a,b){this.origin.copy(a);this.direction.copy(b);return this},clone:function(){return(new this.constructor).copy(this)},
copy:function(a){this.origin.copy(a.origin);this.direction.copy(a.direction);return this},at:function(a,b){void 0===b&&(console.warn("THREE.Ray: .at() target is now required"),b=new n);return b.copy(this.direction).multiplyScalar(a).add(this.origin)},lookAt:function(a){this.direction.copy(a).sub(this.origin).normalize();return this},recast:function(){var a=new n;return function(b){this.origin.copy(this.at(b,a));return this}}(),closestPointToPoint:function(a,b){void 0===b&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),
b=new n);b.subVectors(a,this.origin);a=b.dot(this.direction);return 0>a?b.copy(this.origin):b.copy(this.direction).multiplyScalar(a).add(this.origin)},distanceToPoint:function(a){return Math.sqrt(this.distanceSqToPoint(a))},distanceSqToPoint:function(){var a=new n;return function(b){var c=a.subVectors(b,this.origin).dot(this.direction);if(0>c)return this.origin.distanceToSquared(b);a.copy(this.direction).multiplyScalar(c).add(this.origin);return a.distanceToSquared(b)}}(),distanceSqToSegment:function(){var a=
new n,b=new n,c=new n;return function(d,e,f,g){a.copy(d).add(e).multiplyScalar(.5);b.copy(e).sub(d).normalize();c.copy(this.origin).sub(a);var h=.5*d.distanceTo(e),k=-this.direction.dot(b),m=c.dot(this.direction),l=-c.dot(b),n=c.lengthSq(),v=Math.abs(1-k*k);if(0<v){d=k*l-m;e=k*m-l;var t=h*v;0<=d?e>=-t?e<=t?(h=1/v,d*=h,e*=h,k=d*(d+k*e+2*m)+e*(k*d+e+2*l)+n):(e=h,d=Math.max(0,-(k*e+m)),k=-d*d+e*(e+2*l)+n):(e=-h,d=Math.max(0,-(k*e+m)),k=-d*d+e*(e+2*l)+n):e<=-t?(d=Math.max(0,-(-k*h+m)),e=0<d?-h:Math.min(Math.max(-h,
-l),h),k=-d*d+e*(e+2*l)+n):e<=t?(d=0,e=Math.min(Math.max(-h,-l),h),k=e*(e+2*l)+n):(d=Math.max(0,-(k*h+m)),e=0<d?h:Math.min(Math.max(-h,-l),h),k=-d*d+e*(e+2*l)+n)}else e=0<k?-h:h,d=Math.max(0,-(k*e+m)),k=-d*d+e*(e+2*l)+n;f&&f.copy(this.direction).multiplyScalar(d).add(this.origin);g&&g.copy(b).multiplyScalar(e).add(a);return k}}(),intersectSphere:function(){var a=new n;return function(b,c){a.subVectors(b.center,this.origin);var d=a.dot(this.direction),e=a.dot(a)-d*d;b=b.radius*b.radius;if(e>b)return null;
b=Math.sqrt(b-e);e=d-b;d+=b;return 0>e&&0>d?null:0>e?this.at(d,c):this.at(e,c)}}(),intersectsSphere:function(a){return this.distanceSqToPoint(a.center)<=a.radius*a.radius},distanceToPlane:function(a){var b=a.normal.dot(this.direction);if(0===b)return 0===a.distanceToPoint(this.origin)?0:null;a=-(this.origin.dot(a.normal)+a.constant)/b;return 0<=a?a:null},intersectPlane:function(a,b){a=this.distanceToPlane(a);return null===a?null:this.at(a,b)},intersectsPlane:function(a){var b=a.distanceToPoint(this.origin);
return 0===b||0>a.normal.dot(this.direction)*b?!0:!1},intersectBox:function(a,b){var c=1/this.direction.x;var d=1/this.direction.y;var e=1/this.direction.z,f=this.origin;if(0<=c){var g=(a.min.x-f.x)*c;c*=a.max.x-f.x}else g=(a.max.x-f.x)*c,c*=a.min.x-f.x;if(0<=d){var h=(a.min.y-f.y)*d;d*=a.max.y-f.y}else h=(a.max.y-f.y)*d,d*=a.min.y-f.y;if(g>d||h>c)return null;if(h>g||g!==g)g=h;if(d<c||c!==c)c=d;0<=e?(h=(a.min.z-f.z)*e,a=(a.max.z-f.z)*e):(h=(a.max.z-f.z)*e,a=(a.min.z-f.z)*e);if(g>a||h>c)return null;
if(h>g||g!==g)g=h;if(a<c||c!==c)c=a;return 0>c?null:this.at(0<=g?g:c,b)},intersectsBox:function(){var a=new n;return function(b){return null!==this.intersectBox(b,a)}}(),intersectTriangle:function(){var a=new n,b=new n,c=new n,d=new n;return function(e,f,g,h,k){b.subVectors(f,e);c.subVectors(g,e);d.crossVectors(b,c);f=this.direction.dot(d);if(0<f){if(h)return null;h=1}else if(0>f)h=-1,f=-f;else return null;a.subVectors(this.origin,e);e=h*this.direction.dot(c.crossVectors(a,c));if(0>e)return null;
g=h*this.direction.dot(b.cross(a));if(0>g||e+g>f)return null;e=-h*a.dot(d);return 0>e?null:this.at(e/f,k)}}(),applyMatrix4:function(a){this.origin.applyMatrix4(a);this.direction.transformDirection(a);return this},equals:function(a){return a.origin.equals(this.origin)&&a.direction.equals(this.direction)}});Object.assign(ra,{getNormal:function(){var a=new n;return function(b,c,d,e){void 0===e&&(console.warn("THREE.Triangle: .getNormal() target is now required"),e=new n);e.subVectors(d,c);a.subVectors(b,
c);e.cross(a);b=e.lengthSq();return 0<b?e.multiplyScalar(1/Math.sqrt(b)):e.set(0,0,0)}}(),getBarycoord:function(){var a=new n,b=new n,c=new n;return function(d,e,f,g,h){a.subVectors(g,e);b.subVectors(f,e);c.subVectors(d,e);d=a.dot(a);e=a.dot(b);f=a.dot(c);var k=b.dot(b);g=b.dot(c);var m=d*k-e*e;void 0===h&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),h=new n);if(0===m)return h.set(-2,-1,-1);m=1/m;k=(k*f-e*g)*m;d=(d*g-e*f)*m;return h.set(1-k-d,d,k)}}(),containsPoint:function(){var a=
new n;return function(b,c,d,e){ra.getBarycoord(b,c,d,e,a);return 0<=a.x&&0<=a.y&&1>=a.x+a.y}}(),getUV:function(){var a=new n;return function(b,c,d,e,f,g,h,k){this.getBarycoord(b,c,d,e,a);k.set(0,0);k.addScaledVector(f,a.x);k.addScaledVector(g,a.y);k.addScaledVector(h,a.z);return k}}()});Object.assign(ra.prototype,{set:function(a,b,c){this.a.copy(a);this.b.copy(b);this.c.copy(c);return this},setFromPointsAndIndices:function(a,b,c,d){this.a.copy(a[b]);this.b.copy(a[c]);this.c.copy(a[d]);return this},
clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.a.copy(a.a);this.b.copy(a.b);this.c.copy(a.c);return this},getArea:function(){var a=new n,b=new n;return function(){a.subVectors(this.c,this.b);b.subVectors(this.a,this.b);return.5*a.cross(b).length()}}(),getMidpoint:function(a){void 0===a&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),a=new n);return a.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(a){return ra.getNormal(this.a,
this.b,this.c,a)},getPlane:function(a){void 0===a&&(console.warn("THREE.Triangle: .getPlane() target is now required"),a=new n);return a.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(a,b){return ra.getBarycoord(a,this.a,this.b,this.c,b)},containsPoint:function(a){return ra.containsPoint(a,this.a,this.b,this.c)},getUV:function(a,b,c,d,e){return ra.getUV(a,this.a,this.b,this.c,b,c,d,e)},intersectsBox:function(a){return a.intersectsTriangle(this)},closestPointToPoint:function(){var a=
new n,b=new n,c=new n,d=new n,e=new n,f=new n;return function(g,h){void 0===h&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),h=new n);var k=this.a,m=this.b,l=this.c;a.subVectors(m,k);b.subVectors(l,k);d.subVectors(g,k);var q=a.dot(d),v=b.dot(d);if(0>=q&&0>=v)return h.copy(k);e.subVectors(g,m);var t=a.dot(e),r=b.dot(e);if(0<=t&&r<=t)return h.copy(m);var u=q*r-t*v;if(0>=u&&0<=q&&0>=t)return m=q/(q-t),h.copy(k).addScaledVector(a,m);f.subVectors(g,l);g=a.dot(f);var x=
b.dot(f);if(0<=x&&g<=x)return h.copy(l);q=g*v-q*x;if(0>=q&&0<=v&&0>=x)return u=v/(v-x),h.copy(k).addScaledVector(b,u);v=t*x-g*r;if(0>=v&&0<=r-t&&0<=g-x)return c.subVectors(l,m),u=(r-t)/(r-t+(g-x)),h.copy(m).addScaledVector(c,u);l=1/(v+q+u);m=q*l;u*=l;return h.copy(k).addScaledVector(a,m).addScaledVector(b,u)}}(),equals:function(a){return a.a.equals(this.a)&&a.b.equals(this.b)&&a.c.equals(this.c)}});Da.prototype=Object.create(O.prototype);Da.prototype.constructor=Da;Da.prototype.isMeshBasicMaterial=
!0;Da.prototype.copy=function(a){O.prototype.copy.call(this,a);this.color.copy(a.color);this.map=a.map;this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.specularMap=a.specularMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.combine=a.combine;this.reflectivity=a.reflectivity;this.refractionRatio=a.refractionRatio;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;
this.wireframeLinejoin=a.wireframeLinejoin;this.skinning=a.skinning;this.morphTargets=a.morphTargets;return this};va.prototype=Object.assign(Object.create(C.prototype),{constructor:va,isMesh:!0,setDrawMode:function(a){this.drawMode=a},copy:function(a){C.prototype.copy.call(this,a);this.drawMode=a.drawMode;void 0!==a.morphTargetInfluences&&(this.morphTargetInfluences=a.morphTargetInfluences.slice());void 0!==a.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},a.morphTargetDictionary));
return this},updateMorphTargets:function(){var a=this.geometry;if(a.isBufferGeometry){a=a.morphAttributes;var b=Object.keys(a);if(0<b.length){var c=a[b[0]];if(void 0!==c)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},a=0,b=c.length;a<b;a++){var d=c[a].name||String(a);this.morphTargetInfluences.push(0);this.morphTargetDictionary[d]=a}}}else a=a.morphTargets,void 0!==a&&0<a.length&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")},
raycast:function(){function a(a,b,c,d,e,f,g,h){if(null===(1===b.side?d.intersectTriangle(g,f,e,!0,h):d.intersectTriangle(e,f,g,2!==b.side,h)))return null;w.copy(h);w.applyMatrix4(a.matrixWorld);b=c.ray.origin.distanceTo(w);return b<c.near||b>c.far?null:{distance:b,point:w.clone(),object:a}}function b(b,c,d,e,p,n,w,C,z,E){f.fromBufferAttribute(p,C);g.fromBufferAttribute(p,z);h.fromBufferAttribute(p,E);p=b.morphTargetInfluences;if(c.morphTargets&&n&&p){q.set(0,0,0);v.set(0,0,0);t.set(0,0,0);for(var y=
0,J=n.length;y<J;y++){var D=p[y],F=n[y];0!==D&&(k.fromBufferAttribute(F,C),m.fromBufferAttribute(F,z),l.fromBufferAttribute(F,E),q.addScaledVector(k.sub(f),D),v.addScaledVector(m.sub(g),D),t.addScaledVector(l.sub(h),D))}f.add(q);g.add(v);h.add(t)}if(b=a(b,c,d,e,f,g,h,A))w&&(r.fromBufferAttribute(w,C),u.fromBufferAttribute(w,z),x.fromBufferAttribute(w,E),b.uv=ra.getUV(A,f,g,h,r,u,x,new B)),w=new Qb(C,z,E),ra.getNormal(f,g,h,w.normal),b.face=w;return b}var c=new P,d=new wb,e=new Ua,f=new n,g=new n,
h=new n,k=new n,m=new n,l=new n,q=new n,v=new n,t=new n,r=new B,u=new B,x=new B,A=new n,w=new n;return function(f,g){var h=this.geometry,k=this.material,m=this.matrixWorld;if(void 0!==k&&(null===h.boundingSphere&&h.computeBoundingSphere(),e.copy(h.boundingSphere),e.applyMatrix4(m),!1!==f.ray.intersectsSphere(e)&&(c.getInverse(m),d.copy(f.ray).applyMatrix4(c),null===h.boundingBox||!1!==d.intersectsBox(h.boundingBox))))if(h.isBufferGeometry){var l=h.index;m=h.attributes.position;var p=h.morphAttributes.position,
n=h.attributes.uv,q=h.groups,t=h.drawRange,v,w;if(null!==l)if(Array.isArray(k)){var y=0;for(v=q.length;y<v;y++){var D=q[y];var C=k[D.materialIndex];var z=Math.max(D.start,t.start);for(w=h=Math.min(D.start+D.count,t.start+t.count);z<w;z+=3){h=l.getX(z);var E=l.getX(z+1);var G=l.getX(z+2);if(h=b(this,C,f,d,m,p,n,h,E,G))h.faceIndex=Math.floor(z/3),h.face.materialIndex=D.materialIndex,g.push(h)}}}else for(z=Math.max(0,t.start),h=Math.min(l.count,t.start+t.count),y=z,v=h;y<v;y+=3){if(h=l.getX(y),E=l.getX(y+
1),G=l.getX(y+2),h=b(this,k,f,d,m,p,n,h,E,G))h.faceIndex=Math.floor(y/3),g.push(h)}else if(void 0!==m)if(Array.isArray(k))for(y=0,v=q.length;y<v;y++)for(D=q[y],C=k[D.materialIndex],z=Math.max(D.start,t.start),w=h=Math.min(D.start+D.count,t.start+t.count);z<w;z+=3){if(h=z,E=z+1,G=z+2,h=b(this,C,f,d,m,p,n,h,E,G))h.faceIndex=Math.floor(z/3),h.face.materialIndex=D.materialIndex,g.push(h)}else for(z=Math.max(0,t.start),h=Math.min(m.count,t.start+t.count),y=z,v=h;y<v;y+=3)if(h=y,E=y+1,G=y+2,h=b(this,k,
f,d,m,p,n,h,E,G))h.faceIndex=Math.floor(y/3),g.push(h)}else if(h.isGeometry)for(m=Array.isArray(k),p=h.vertices,n=h.faces,h=h.faceVertexUvs[0],0<h.length&&(l=h),v=0,D=n.length;v<D;v++)if(C=n[v],h=m?k[C.materialIndex]:k,void 0!==h&&(q=p[C.a],t=p[C.b],y=p[C.c],h=a(this,h,f,d,q,t,y,A)))l&&l[v]&&(z=l[v],r.copy(z[0]),u.copy(z[1]),x.copy(z[2]),h.uv=ra.getUV(A,q,t,y,r,u,x,new B)),h.face=C,h.faceIndex=v,g.push(h)}}(),clone:function(){return(new this.constructor(this.geometry,this.material)).copy(this)}});
bb.prototype=Object.create(W.prototype);bb.prototype.constructor=bb;bb.prototype.isCubeTexture=!0;Object.defineProperty(bb.prototype,"images",{get:function(){return this.image},set:function(a){this.image=a}});Sb.prototype=Object.create(W.prototype);Sb.prototype.constructor=Sb;Sb.prototype.isDataTexture2DArray=!0;Tb.prototype=Object.create(W.prototype);Tb.prototype.constructor=Tb;Tb.prototype.isDataTexture3D=!0;var Ze=new W,vg=new Sb,xg=new Tb,$e=new bb,Te=[],Ve=[],Ye=new Float32Array(16),Xe=new Float32Array(9),
We=new Float32Array(4);df.prototype.updateCache=function(a){var b=this.cache;a instanceof Float32Array&&b.length!==a.length&&(this.cache=new Float32Array(a.length));sa(b,a)};ef.prototype.setValue=function(a,b,c){for(var d=this.seq,e=0,f=d.length;e!==f;++e){var g=d[e];g.setValue(a,b[g.id],c)}};var de=/([\w\d_]+)(\])?(\[|\.)?/g;hb.prototype.setValue=function(a,b,c,d){b=this.map[b];void 0!==b&&b.setValue(a,c,d)};hb.prototype.setOptional=function(a,b,c){b=b[c];void 0!==b&&this.setValue(a,c,b)};hb.upload=
function(a,b,c,d){for(var e=0,f=b.length;e!==f;++e){var g=b[e],h=c[g.id];!1!==h.needsUpdate&&g.setValue(a,h.value,d)}};hb.seqWithValue=function(a,b){for(var c=[],d=0,e=a.length;d!==e;++d){var f=a[d];f.id in b&&c.push(f)}return c};var Sg=0,$g=0;ib.prototype=Object.create(O.prototype);ib.prototype.constructor=ib;ib.prototype.isMeshDepthMaterial=!0;ib.prototype.copy=function(a){O.prototype.copy.call(this,a);this.depthPacking=a.depthPacking;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.map=
a.map;this.alphaMap=a.alphaMap;this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;return this};jb.prototype=Object.create(O.prototype);jb.prototype.constructor=jb;jb.prototype.isMeshDistanceMaterial=!0;jb.prototype.copy=function(a){O.prototype.copy.call(this,a);this.referencePosition.copy(a.referencePosition);this.nearDistance=a.nearDistance;this.farDistance=
a.farDistance;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.map=a.map;this.alphaMap=a.alphaMap;this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;return this};Vb.prototype=Object.assign(Object.create(C.prototype),{constructor:Vb,isGroup:!0});Xa.prototype=Object.assign(Object.create(C.prototype),{constructor:Xa,isCamera:!0,copy:function(a,b){C.prototype.copy.call(this,a,b);this.matrixWorldInverse.copy(a.matrixWorldInverse);
this.projectionMatrix.copy(a.projectionMatrix);this.projectionMatrixInverse.copy(a.projectionMatrixInverse);return this},getWorldDirection:function(a){void 0===a&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),a=new n);this.updateMatrixWorld(!0);var b=this.matrixWorld.elements;return a.set(-b[8],-b[9],-b[10]).normalize()},updateMatrixWorld:function(a){C.prototype.updateMatrixWorld.call(this,a);this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}});
ja.prototype=Object.assign(Object.create(Xa.prototype),{constructor:ja,isPerspectiveCamera:!0,copy:function(a,b){Xa.prototype.copy.call(this,a,b);this.fov=a.fov;this.zoom=a.zoom;this.near=a.near;this.far=a.far;this.focus=a.focus;this.aspect=a.aspect;this.view=null===a.view?null:Object.assign({},a.view);this.filmGauge=a.filmGauge;this.filmOffset=a.filmOffset;return this},setFocalLength:function(a){a=.5*this.getFilmHeight()/a;this.fov=2*K.RAD2DEG*Math.atan(a);this.updateProjectionMatrix()},getFocalLength:function(){var a=
Math.tan(.5*K.DEG2RAD*this.fov);return.5*this.getFilmHeight()/a},getEffectiveFOV:function(){return 2*K.RAD2DEG*Math.atan(Math.tan(.5*K.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(a,b,c,d,e,f){this.aspect=a/b;null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1});this.view.enabled=!0;this.view.fullWidth=
a;this.view.fullHeight=b;this.view.offsetX=c;this.view.offsetY=d;this.view.width=e;this.view.height=f;this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1);this.updateProjectionMatrix()},updateProjectionMatrix:function(){var a=this.near,b=a*Math.tan(.5*K.DEG2RAD*this.fov)/this.zoom,c=2*b,d=this.aspect*c,e=-.5*d,f=this.view;if(null!==this.view&&this.view.enabled){var g=f.fullWidth,h=f.fullHeight;e+=f.offsetX*d/g;b-=f.offsetY*c/h;d*=f.width/g;c*=f.height/
h}f=this.filmOffset;0!==f&&(e+=a*f/this.getFilmWidth());this.projectionMatrix.makePerspective(e,e+d,b,b-c,a,this.far);this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(a){a=C.prototype.toJSON.call(this,a);a.object.fov=this.fov;a.object.zoom=this.zoom;a.object.near=this.near;a.object.far=this.far;a.object.focus=this.focus;a.object.aspect=this.aspect;null!==this.view&&(a.object.view=Object.assign({},this.view));a.object.filmGauge=this.filmGauge;a.object.filmOffset=this.filmOffset;
return a}});Gc.prototype=Object.assign(Object.create(ja.prototype),{constructor:Gc,isArrayCamera:!0});var rf=new n,sf=new n;Object.assign(yd.prototype,{isFogExp2:!0,clone:function(){return new yd(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}});Object.assign(zd.prototype,{isFog:!0,clone:function(){return new zd(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}});
Ad.prototype=Object.assign(Object.create(C.prototype),{constructor:Ad,isScene:!0,copy:function(a,b){C.prototype.copy.call(this,a,b);null!==a.background&&(this.background=a.background.clone());null!==a.fog&&(this.fog=a.fog.clone());null!==a.overrideMaterial&&(this.overrideMaterial=a.overrideMaterial.clone());this.autoUpdate=a.autoUpdate;this.matrixAutoUpdate=a.matrixAutoUpdate;return this},toJSON:function(a){var b=C.prototype.toJSON.call(this,a);null!==this.background&&(b.object.background=this.background.toJSON(a));
null!==this.fog&&(b.object.fog=this.fog.toJSON());return b},dispose:function(){this.dispatchEvent({type:"dispose"})}});Object.defineProperty(xb.prototype,"needsUpdate",{set:function(a){!0===a&&this.version++}});Object.assign(xb.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setArray:function(a){if(Array.isArray(a))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==a?a.length/this.stride:0;this.array=a;return this},setDynamic:function(a){this.dynamic=
a;return this},copy:function(a){this.array=new a.array.constructor(a.array);this.count=a.count;this.stride=a.stride;this.dynamic=a.dynamic;return this},copyAt:function(a,b,c){a*=this.stride;c*=b.stride;for(var d=0,e=this.stride;d<e;d++)this.array[a+d]=b.array[c+d];return this},set:function(a,b){void 0===b&&(b=0);this.array.set(a,b);return this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(a){this.onUploadCallback=a;return this}});Object.defineProperties(Hc.prototype,
{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}});Object.assign(Hc.prototype,{isInterleavedBufferAttribute:!0,setX:function(a,b){this.data.array[a*this.data.stride+this.offset]=b;return this},setY:function(a,b){this.data.array[a*this.data.stride+this.offset+1]=b;return this},setZ:function(a,b){this.data.array[a*this.data.stride+this.offset+2]=b;return this},setW:function(a,b){this.data.array[a*this.data.stride+this.offset+3]=b;return this},getX:function(a){return this.data.array[a*
this.data.stride+this.offset]},getY:function(a){return this.data.array[a*this.data.stride+this.offset+1]},getZ:function(a){return this.data.array[a*this.data.stride+this.offset+2]},getW:function(a){return this.data.array[a*this.data.stride+this.offset+3]},setXY:function(a,b,c){a=a*this.data.stride+this.offset;this.data.array[a+0]=b;this.data.array[a+1]=c;return this},setXYZ:function(a,b,c,d){a=a*this.data.stride+this.offset;this.data.array[a+0]=b;this.data.array[a+1]=c;this.data.array[a+2]=d;return this},
setXYZW:function(a,b,c,d,e){a=a*this.data.stride+this.offset;this.data.array[a+0]=b;this.data.array[a+1]=c;this.data.array[a+2]=d;this.data.array[a+3]=e;return this}});mb.prototype=Object.create(O.prototype);mb.prototype.constructor=mb;mb.prototype.isSpriteMaterial=!0;mb.prototype.copy=function(a){O.prototype.copy.call(this,a);this.color.copy(a.color);this.map=a.map;this.rotation=a.rotation;this.sizeAttenuation=a.sizeAttenuation;return this};var Wb;Ic.prototype=Object.assign(Object.create(C.prototype),
{constructor:Ic,isSprite:!0,raycast:function(){function a(a,b,c,d,h,k){e.subVectors(a,c).addScalar(.5).multiply(d);void 0!==h?(f.x=k*e.x-h*e.y,f.y=h*e.x+k*e.y):f.copy(e);a.copy(b);a.x+=f.x;a.y+=f.y;a.applyMatrix4(g)}var b=new n,c=new n,d=new n,e=new B,f=new B,g=new P,h=new n,k=new n,m=new n,l=new B,q=new B,v=new B;return function(e,f){c.setFromMatrixScale(this.matrixWorld);g.getInverse(this.modelViewMatrix).premultiply(this.matrixWorld);d.setFromMatrixPosition(this.modelViewMatrix);var p=this.material.rotation;
if(0!==p){var n=Math.cos(p);var r=Math.sin(p)}p=this.center;a(h.set(-.5,-.5,0),d,p,c,r,n);a(k.set(.5,-.5,0),d,p,c,r,n);a(m.set(.5,.5,0),d,p,c,r,n);l.set(0,0);q.set(1,0);v.set(1,1);var t=e.ray.intersectTriangle(h,k,m,!1,b);if(null===t&&(a(k.set(-.5,.5,0),d,p,c,r,n),q.set(0,1),t=e.ray.intersectTriangle(h,m,k,!1,b),null===t))return;r=e.ray.origin.distanceTo(b);r<e.near||r>e.far||f.push({distance:r,point:b.clone(),uv:ra.getUV(b,h,k,m,l,q,v,new B),face:null,object:this})}}(),clone:function(){return(new this.constructor(this.material)).copy(this)},
copy:function(a){C.prototype.copy.call(this,a);void 0!==a.center&&this.center.copy(a.center);return this}});Jc.prototype=Object.assign(Object.create(C.prototype),{constructor:Jc,copy:function(a){C.prototype.copy.call(this,a,!1);a=a.levels;for(var b=0,c=a.length;b<c;b++){var d=a[b];this.addLevel(d.object.clone(),d.distance)}return this},addLevel:function(a,b){void 0===b&&(b=0);b=Math.abs(b);for(var c=this.levels,d=0;d<c.length&&!(b<c[d].distance);d++);c.splice(d,0,{distance:b,object:a});this.add(a)},
getObjectForDistance:function(a){for(var b=this.levels,c=1,d=b.length;c<d&&!(a<b[c].distance);c++);return b[c-1].object},raycast:function(){var a=new n;return function(b,c){a.setFromMatrixPosition(this.matrixWorld);var d=b.ray.origin.distanceTo(a);this.getObjectForDistance(d).raycast(b,c)}}(),update:function(){var a=new n,b=new n;return function(c){var d=this.levels;if(1<d.length){a.setFromMatrixPosition(c.matrixWorld);b.setFromMatrixPosition(this.matrixWorld);c=a.distanceTo(b);d[0].object.visible=
!0;for(var e=1,f=d.length;e<f;e++)if(c>=d[e].distance)d[e-1].object.visible=!1,d[e].object.visible=!0;else break;for(;e<f;e++)d[e].object.visible=!1}}}(),toJSON:function(a){a=C.prototype.toJSON.call(this,a);a.object.levels=[];for(var b=this.levels,c=0,d=b.length;c<d;c++){var e=b[c];a.object.levels.push({object:e.object.uuid,distance:e.distance})}return a}});Kc.prototype=Object.assign(Object.create(va.prototype),{constructor:Kc,isSkinnedMesh:!0,bind:function(a,b){this.skeleton=a;void 0===b&&(this.updateMatrixWorld(!0),
this.skeleton.calculateInverses(),b=this.matrixWorld);this.bindMatrix.copy(b);this.bindMatrixInverse.getInverse(b)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var a=new Y,b=this.geometry.attributes.skinWeight,c=0,d=b.count;c<d;c++){a.x=b.getX(c);a.y=b.getY(c);a.z=b.getZ(c);a.w=b.getW(c);var e=1/a.manhattanLength();Infinity!==e?a.multiplyScalar(e):a.set(1,0,0,0);b.setXYZW(c,a.x,a.y,a.z,a.w)}},updateMatrixWorld:function(a){va.prototype.updateMatrixWorld.call(this,a);"attached"===
this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return(new this.constructor(this.geometry,this.material)).copy(this)}});Object.assign(Bd.prototype,{calculateInverses:function(){this.boneInverses=[];for(var a=0,b=this.bones.length;a<b;a++){var c=new P;this.bones[a]&&c.getInverse(this.bones[a].matrixWorld);this.boneInverses.push(c)}},
pose:function(){var a,b;var c=0;for(b=this.bones.length;c<b;c++)(a=this.bones[c])&&a.matrixWorld.getInverse(this.boneInverses[c]);c=0;for(b=this.bones.length;c<b;c++)if(a=this.bones[c])a.parent&&a.parent.isBone?(a.matrix.getInverse(a.parent.matrixWorld),a.matrix.multiply(a.matrixWorld)):a.matrix.copy(a.matrixWorld),a.matrix.decompose(a.position,a.quaternion,a.scale)},update:function(){var a=new P,b=new P;return function(){for(var c=this.bones,d=this.boneInverses,e=this.boneMatrices,f=this.boneTexture,
g=0,h=c.length;g<h;g++)a.multiplyMatrices(c[g]?c[g].matrixWorld:b,d[g]),a.toArray(e,16*g);void 0!==f&&(f.needsUpdate=!0)}}(),clone:function(){return new Bd(this.bones,this.boneInverses)},getBoneByName:function(a){for(var b=0,c=this.bones.length;b<c;b++){var d=this.bones[b];if(d.name===a)return d}}});he.prototype=Object.assign(Object.create(C.prototype),{constructor:he,isBone:!0});R.prototype=Object.create(O.prototype);R.prototype.constructor=R;R.prototype.isLineBasicMaterial=!0;R.prototype.copy=function(a){O.prototype.copy.call(this,
a);this.color.copy(a.color);this.linewidth=a.linewidth;this.linecap=a.linecap;this.linejoin=a.linejoin;return this};oa.prototype=Object.assign(Object.create(C.prototype),{constructor:oa,isLine:!0,computeLineDistances:function(){var a=new n,b=new n;return function(){var c=this.geometry;if(c.isBufferGeometry)if(null===c.index){for(var d=c.attributes.position,e=[0],f=1,g=d.count;f<g;f++)a.fromBufferAttribute(d,f-1),b.fromBufferAttribute(d,f),e[f]=e[f-1],e[f]+=a.distanceTo(b);c.addAttribute("lineDistance",
new E(e,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(c.isGeometry)for(d=c.vertices,e=c.lineDistances,e[0]=0,f=1,g=d.length;f<g;f++)e[f]=e[f-1],e[f]+=d[f-1].distanceTo(d[f]);return this}}(),raycast:function(){var a=new P,b=new wb,c=new Ua;return function(d,e){var f=d.linePrecision,g=this.geometry,h=this.matrixWorld;null===g.boundingSphere&&g.computeBoundingSphere();c.copy(g.boundingSphere);c.applyMatrix4(h);c.radius+=
f;if(!1!==d.ray.intersectsSphere(c)){a.getInverse(h);b.copy(d.ray).applyMatrix4(a);f/=(this.scale.x+this.scale.y+this.scale.z)/3;f*=f;var k=new n,m=new n;h=new n;var l=new n,q=this&&this.isLineSegments?2:1;if(g.isBufferGeometry){var v=g.index,t=g.attributes.position.array;if(null!==v){v=v.array;g=0;for(var r=v.length-1;g<r;g+=q){var u=v[g+1];k.fromArray(t,3*v[g]);m.fromArray(t,3*u);u=b.distanceSqToSegment(k,m,l,h);u>f||(l.applyMatrix4(this.matrixWorld),u=d.ray.origin.distanceTo(l),u<d.near||u>d.far||
e.push({distance:u,point:h.clone().applyMatrix4(this.matrixWorld),index:g,face:null,faceIndex:null,object:this}))}}else for(g=0,r=t.length/3-1;g<r;g+=q)k.fromArray(t,3*g),m.fromArray(t,3*g+3),u=b.distanceSqToSegment(k,m,l,h),u>f||(l.applyMatrix4(this.matrixWorld),u=d.ray.origin.distanceTo(l),u<d.near||u>d.far||e.push({distance:u,point:h.clone().applyMatrix4(this.matrixWorld),index:g,face:null,faceIndex:null,object:this}))}else if(g.isGeometry)for(k=g.vertices,m=k.length,g=0;g<m-1;g+=q)u=b.distanceSqToSegment(k[g],
k[g+1],l,h),u>f||(l.applyMatrix4(this.matrixWorld),u=d.ray.origin.distanceTo(l),u<d.near||u>d.far||e.push({distance:u,point:h.clone().applyMatrix4(this.matrixWorld),index:g,face:null,faceIndex:null,object:this}))}}}(),clone:function(){return(new this.constructor(this.geometry,this.material)).copy(this)}});V.prototype=Object.assign(Object.create(oa.prototype),{constructor:V,isLineSegments:!0,computeLineDistances:function(){var a=new n,b=new n;return function(){var c=this.geometry;if(c.isBufferGeometry)if(null===
c.index){for(var d=c.attributes.position,e=[],f=0,g=d.count;f<g;f+=2)a.fromBufferAttribute(d,f),b.fromBufferAttribute(d,f+1),e[f]=0===f?0:e[f-1],e[f+1]=e[f]+a.distanceTo(b);c.addAttribute("lineDistance",new E(e,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(c.isGeometry)for(d=c.vertices,e=c.lineDistances,f=0,g=d.length;f<g;f+=2)a.copy(d[f]),b.copy(d[f+1]),e[f]=0===f?0:e[f-1],e[f+1]=e[f]+a.distanceTo(b);return this}}()});
Cd.prototype=Object.assign(Object.create(oa.prototype),{constructor:Cd,isLineLoop:!0});Ka.prototype=Object.create(O.prototype);Ka.prototype.constructor=Ka;Ka.prototype.isPointsMaterial=!0;Ka.prototype.copy=function(a){O.prototype.copy.call(this,a);this.color.copy(a.color);this.map=a.map;this.size=a.size;this.sizeAttenuation=a.sizeAttenuation;this.morphTargets=a.morphTargets;return this};Xb.prototype=Object.assign(Object.create(C.prototype),{constructor:Xb,isPoints:!0,raycast:function(){var a=new P,
b=new wb,c=new Ua;return function(d,e){function f(a,c){var f=b.distanceSqToPoint(a);f<l&&(b.closestPointToPoint(a,q),q.applyMatrix4(k),a=d.ray.origin.distanceTo(q),a<d.near||a>d.far||e.push({distance:a,distanceToRay:Math.sqrt(f),point:q.clone(),index:c,face:null,object:g}))}var g=this,h=this.geometry,k=this.matrixWorld,m=d.params.Points.threshold;null===h.boundingSphere&&h.computeBoundingSphere();c.copy(h.boundingSphere);c.applyMatrix4(k);c.radius+=m;if(!1!==d.ray.intersectsSphere(c)){a.getInverse(k);
b.copy(d.ray).applyMatrix4(a);m/=(this.scale.x+this.scale.y+this.scale.z)/3;var l=m*m;m=new n;var q=new n;if(h.isBufferGeometry){var v=h.index;h=h.attributes.position.array;if(null!==v){var t=v.array;v=0;for(var r=t.length;v<r;v++){var u=t[v];m.fromArray(h,3*u);f(m,u)}}else for(v=0,t=h.length/3;v<t;v++)m.fromArray(h,3*v),f(m,v)}else for(m=h.vertices,v=0,t=m.length;v<t;v++)f(m[v],v)}}}(),clone:function(){return(new this.constructor(this.geometry,this.material)).copy(this)}});ie.prototype=Object.assign(Object.create(W.prototype),
{constructor:ie,isVideoTexture:!0,update:function(){var a=this.image;a.readyState>=a.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}});Yb.prototype=Object.create(W.prototype);Yb.prototype.constructor=Yb;Yb.prototype.isCompressedTexture=!0;Lc.prototype=Object.create(W.prototype);Lc.prototype.constructor=Lc;Lc.prototype.isCanvasTexture=!0;Mc.prototype=Object.create(W.prototype);Mc.prototype.constructor=Mc;Mc.prototype.isDepthTexture=!0;Zb.prototype=Object.create(z.prototype);Zb.prototype.constructor=Zb;Nc.prototype=
Object.create(N.prototype);Nc.prototype.constructor=Nc;$b.prototype=Object.create(z.prototype);$b.prototype.constructor=$b;Oc.prototype=Object.create(N.prototype);Oc.prototype.constructor=Oc;ka.prototype=Object.create(z.prototype);ka.prototype.constructor=ka;Pc.prototype=Object.create(N.prototype);Pc.prototype.constructor=Pc;ac.prototype=Object.create(ka.prototype);ac.prototype.constructor=ac;Qc.prototype=Object.create(N.prototype);Qc.prototype.constructor=Qc;yb.prototype=Object.create(ka.prototype);
yb.prototype.constructor=yb;Rc.prototype=Object.create(N.prototype);Rc.prototype.constructor=Rc;bc.prototype=Object.create(ka.prototype);bc.prototype.constructor=bc;Sc.prototype=Object.create(N.prototype);Sc.prototype.constructor=Sc;cc.prototype=Object.create(ka.prototype);cc.prototype.constructor=cc;Tc.prototype=Object.create(N.prototype);Tc.prototype.constructor=Tc;zb.prototype=Object.create(z.prototype);zb.prototype.constructor=zb;zb.prototype.toJSON=function(){var a=z.prototype.toJSON.call(this);
a.path=this.parameters.path.toJSON();return a};Uc.prototype=Object.create(N.prototype);Uc.prototype.constructor=Uc;dc.prototype=Object.create(z.prototype);dc.prototype.constructor=dc;Vc.prototype=Object.create(N.prototype);Vc.prototype.constructor=Vc;ec.prototype=Object.create(z.prototype);ec.prototype.constructor=ec;var mh={triangulate:function(a,b,c){c=c||2;var d=b&&b.length,e=d?b[0]*c:a.length,f=vf(a,0,e,c,!0),g=[];if(!f)return g;var h;if(d){var k=c;d=[];var m;var l=0;for(m=b.length;l<m;l++){var n=
b[l]*k;var v=l<m-1?b[l+1]*k:a.length;n=vf(a,n,v,k,!1);n===n.next&&(n.steiner=!0);d.push(gh(n))}d.sort(eh);for(l=0;l<d.length;l++){b=d[l];k=f;if(k=fh(b,k))b=yf(k,b),Xc(b,b.next);f=Xc(f,f.next)}}if(a.length>80*c){var t=h=a[0];var r=d=a[1];for(k=c;k<e;k+=c)l=a[k],b=a[k+1],l<t&&(t=l),b<r&&(r=b),l>h&&(h=l),b>d&&(d=b);h=Math.max(h-t,d-r);h=0!==h?1/h:0}Yc(f,g,c,t,r,h);return g}},cb={area:function(a){for(var b=a.length,c=0,d=b-1,e=0;e<b;d=e++)c+=a[d].x*a[e].y-a[e].x*a[d].y;return.5*c},isClockWise:function(a){return 0>
cb.area(a)},triangulateShape:function(a,b){var c=[],d=[],e=[];zf(a);Af(c,a);var f=a.length;b.forEach(zf);for(a=0;a<b.length;a++)d.push(f),f+=b[a].length,Af(c,b[a]);b=mh.triangulate(c,d);for(a=0;a<b.length;a+=3)e.push(b.slice(a,a+3));return e}};Bb.prototype=Object.create(N.prototype);Bb.prototype.constructor=Bb;Bb.prototype.toJSON=function(){var a=N.prototype.toJSON.call(this);return Bf(this.parameters.shapes,this.parameters.options,a)};Ya.prototype=Object.create(z.prototype);Ya.prototype.constructor=
Ya;Ya.prototype.toJSON=function(){var a=z.prototype.toJSON.call(this);return Bf(this.parameters.shapes,this.parameters.options,a)};var hh={generateTopUV:function(a,b,c,d,e){a=b[3*d];d=b[3*d+1];var f=b[3*e];e=b[3*e+1];return[new B(b[3*c],b[3*c+1]),new B(a,d),new B(f,e)]},generateSideWallUV:function(a,b,c,d,e,f){a=b[3*c];var g=b[3*c+1];c=b[3*c+2];var h=b[3*d],k=b[3*d+1];d=b[3*d+2];var m=b[3*e],l=b[3*e+1];e=b[3*e+2];var n=b[3*f],v=b[3*f+1];b=b[3*f+2];return.01>Math.abs(g-k)?[new B(a,1-c),new B(h,1-d),
new B(m,1-e),new B(n,1-b)]:[new B(g,1-c),new B(k,1-d),new B(l,1-e),new B(v,1-b)]}};$c.prototype=Object.create(N.prototype);$c.prototype.constructor=$c;fc.prototype=Object.create(Ya.prototype);fc.prototype.constructor=fc;ad.prototype=Object.create(N.prototype);ad.prototype.constructor=ad;Cb.prototype=Object.create(z.prototype);Cb.prototype.constructor=Cb;bd.prototype=Object.create(N.prototype);bd.prototype.constructor=bd;gc.prototype=Object.create(z.prototype);gc.prototype.constructor=gc;cd.prototype=
Object.create(N.prototype);cd.prototype.constructor=cd;hc.prototype=Object.create(z.prototype);hc.prototype.constructor=hc;Db.prototype=Object.create(N.prototype);Db.prototype.constructor=Db;Db.prototype.toJSON=function(){var a=N.prototype.toJSON.call(this);return Cf(this.parameters.shapes,a)};Eb.prototype=Object.create(z.prototype);Eb.prototype.constructor=Eb;Eb.prototype.toJSON=function(){var a=z.prototype.toJSON.call(this);return Cf(this.parameters.shapes,a)};ic.prototype=Object.create(z.prototype);
ic.prototype.constructor=ic;Fb.prototype=Object.create(N.prototype);Fb.prototype.constructor=Fb;db.prototype=Object.create(z.prototype);db.prototype.constructor=db;dd.prototype=Object.create(Fb.prototype);dd.prototype.constructor=dd;ed.prototype=Object.create(db.prototype);ed.prototype.constructor=ed;fd.prototype=Object.create(N.prototype);fd.prototype.constructor=fd;jc.prototype=Object.create(z.prototype);jc.prototype.constructor=jc;var ya=Object.freeze({WireframeGeometry:Zb,ParametricGeometry:Nc,
ParametricBufferGeometry:$b,TetrahedronGeometry:Pc,TetrahedronBufferGeometry:ac,OctahedronGeometry:Qc,OctahedronBufferGeometry:yb,IcosahedronGeometry:Rc,IcosahedronBufferGeometry:bc,DodecahedronGeometry:Sc,DodecahedronBufferGeometry:cc,PolyhedronGeometry:Oc,PolyhedronBufferGeometry:ka,TubeGeometry:Tc,TubeBufferGeometry:zb,TorusKnotGeometry:Uc,TorusKnotBufferGeometry:dc,TorusGeometry:Vc,TorusBufferGeometry:ec,TextGeometry:$c,TextBufferGeometry:fc,SphereGeometry:ad,SphereBufferGeometry:Cb,RingGeometry:bd,
RingBufferGeometry:gc,PlaneGeometry:Dc,PlaneBufferGeometry:vb,LatheGeometry:cd,LatheBufferGeometry:hc,ShapeGeometry:Db,ShapeBufferGeometry:Eb,ExtrudeGeometry:Bb,ExtrudeBufferGeometry:Ya,EdgesGeometry:ic,ConeGeometry:dd,ConeBufferGeometry:ed,CylinderGeometry:Fb,CylinderBufferGeometry:db,CircleGeometry:fd,CircleBufferGeometry:jc,BoxGeometry:Rb,BoxBufferGeometry:ub});Gb.prototype=Object.create(O.prototype);Gb.prototype.constructor=Gb;Gb.prototype.isShadowMaterial=!0;Gb.prototype.copy=function(a){O.prototype.copy.call(this,
a);this.color.copy(a.color);return this};kc.prototype=Object.create(Ca.prototype);kc.prototype.constructor=kc;kc.prototype.isRawShaderMaterial=!0;Za.prototype=Object.create(O.prototype);Za.prototype.constructor=Za;Za.prototype.isMeshStandardMaterial=!0;Za.prototype.copy=function(a){O.prototype.copy.call(this,a);this.defines={STANDARD:""};this.color.copy(a.color);this.roughness=a.roughness;this.metalness=a.metalness;this.map=a.map;this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;
this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.emissive.copy(a.emissive);this.emissiveMap=a.emissiveMap;this.emissiveIntensity=a.emissiveIntensity;this.bumpMap=a.bumpMap;this.bumpScale=a.bumpScale;this.normalMap=a.normalMap;this.normalMapType=a.normalMapType;this.normalScale.copy(a.normalScale);this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.roughnessMap=a.roughnessMap;this.metalnessMap=a.metalnessMap;this.alphaMap=
a.alphaMap;this.envMap=a.envMap;this.envMapIntensity=a.envMapIntensity;this.refractionRatio=a.refractionRatio;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.morphNormals=a.morphNormals;return this};Hb.prototype=Object.create(Za.prototype);Hb.prototype.constructor=Hb;Hb.prototype.isMeshPhysicalMaterial=!0;Hb.prototype.copy=function(a){Za.prototype.copy.call(this,
a);this.defines={PHYSICAL:""};this.reflectivity=a.reflectivity;this.clearCoat=a.clearCoat;this.clearCoatRoughness=a.clearCoatRoughness;return this};La.prototype=Object.create(O.prototype);La.prototype.constructor=La;La.prototype.isMeshPhongMaterial=!0;La.prototype.copy=function(a){O.prototype.copy.call(this,a);this.color.copy(a.color);this.specular.copy(a.specular);this.shininess=a.shininess;this.map=a.map;this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=
a.aoMapIntensity;this.emissive.copy(a.emissive);this.emissiveMap=a.emissiveMap;this.emissiveIntensity=a.emissiveIntensity;this.bumpMap=a.bumpMap;this.bumpScale=a.bumpScale;this.normalMap=a.normalMap;this.normalMapType=a.normalMapType;this.normalScale.copy(a.normalScale);this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.specularMap=a.specularMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.combine=a.combine;this.reflectivity=
a.reflectivity;this.refractionRatio=a.refractionRatio;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.morphNormals=a.morphNormals;return this};Ib.prototype=Object.create(La.prototype);Ib.prototype.constructor=Ib;Ib.prototype.isMeshToonMaterial=!0;Ib.prototype.copy=function(a){La.prototype.copy.call(this,a);this.gradientMap=a.gradientMap;
return this};Jb.prototype=Object.create(O.prototype);Jb.prototype.constructor=Jb;Jb.prototype.isMeshNormalMaterial=!0;Jb.prototype.copy=function(a){O.prototype.copy.call(this,a);this.bumpMap=a.bumpMap;this.bumpScale=a.bumpScale;this.normalMap=a.normalMap;this.normalMapType=a.normalMapType;this.normalScale.copy(a.normalScale);this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.wireframe=a.wireframe;this.wireframeLinewidth=
a.wireframeLinewidth;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.morphNormals=a.morphNormals;return this};Kb.prototype=Object.create(O.prototype);Kb.prototype.constructor=Kb;Kb.prototype.isMeshLambertMaterial=!0;Kb.prototype.copy=function(a){O.prototype.copy.call(this,a);this.color.copy(a.color);this.map=a.map;this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.emissive.copy(a.emissive);this.emissiveMap=
a.emissiveMap;this.emissiveIntensity=a.emissiveIntensity;this.specularMap=a.specularMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.combine=a.combine;this.reflectivity=a.reflectivity;this.refractionRatio=a.refractionRatio;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.morphNormals=a.morphNormals;return this};Lb.prototype=
Object.create(O.prototype);Lb.prototype.constructor=Lb;Lb.prototype.isMeshMatcapMaterial=!0;Lb.prototype.copy=function(a){O.prototype.copy.call(this,a);this.defines={MATCAP:""};this.color.copy(a.color);this.matcap=a.matcap;this.map=a.map;this.bumpMap=a.bumpMap;this.bumpScale=a.bumpScale;this.normalMap=a.normalMap;this.normalMapType=a.normalMapType;this.normalScale.copy(a.normalScale);this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;
this.alphaMap=a.alphaMap;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.morphNormals=a.morphNormals;return this};Mb.prototype=Object.create(R.prototype);Mb.prototype.constructor=Mb;Mb.prototype.isLineDashedMaterial=!0;Mb.prototype.copy=function(a){R.prototype.copy.call(this,a);this.scale=a.scale;this.dashSize=a.dashSize;this.gapSize=a.gapSize;return this};var nh=Object.freeze({ShadowMaterial:Gb,SpriteMaterial:mb,RawShaderMaterial:kc,ShaderMaterial:Ca,PointsMaterial:Ka,MeshPhysicalMaterial:Hb,
MeshStandardMaterial:Za,MeshPhongMaterial:La,MeshToonMaterial:Ib,MeshNormalMaterial:Jb,MeshLambertMaterial:Kb,MeshDepthMaterial:ib,MeshDistanceMaterial:jb,MeshBasicMaterial:Da,MeshMatcapMaterial:Lb,LineDashedMaterial:Mb,LineBasicMaterial:R,Material:O}),pa={arraySlice:function(a,b,c){return pa.isTypedArray(a)?new a.constructor(a.subarray(b,void 0!==c?c:a.length)):a.slice(b,c)},convertArray:function(a,b,c){return!a||!c&&a.constructor===b?a:"number"===typeof b.BYTES_PER_ELEMENT?new b(a):Array.prototype.slice.call(a)},
isTypedArray:function(a){return ArrayBuffer.isView(a)&&!(a instanceof DataView)},getKeyframeOrder:function(a){for(var b=a.length,c=Array(b),d=0;d!==b;++d)c[d]=d;c.sort(function(b,c){return a[b]-a[c]});return c},sortedArray:function(a,b,c){for(var d=a.length,e=new a.constructor(d),f=0,g=0;g!==d;++f)for(var h=c[f]*b,k=0;k!==b;++k)e[g++]=a[h+k];return e},flattenJSON:function(a,b,c,d){for(var e=1,f=a[0];void 0!==f&&void 0===f[d];)f=a[e++];if(void 0!==f){var g=f[d];if(void 0!==g)if(Array.isArray(g)){do g=
f[d],void 0!==g&&(b.push(f.time),c.push.apply(c,g)),f=a[e++];while(void 0!==f)}else if(void 0!==g.toArray){do g=f[d],void 0!==g&&(b.push(f.time),g.toArray(c,c.length)),f=a[e++];while(void 0!==f)}else{do g=f[d],void 0!==g&&(b.push(f.time),c.push(g)),f=a[e++];while(void 0!==f)}}}};Object.assign(Fa.prototype,{evaluate:function(a){var b=this.parameterPositions,c=this._cachedIndex,d=b[c],e=b[c-1];a:{b:{c:{d:if(!(a<d)){for(var f=c+2;;){if(void 0===d){if(a<e)break d;this._cachedIndex=c=b.length;return this.afterEnd_(c-
1,a,e)}if(c===f)break;e=d;d=b[++c];if(a<d)break b}d=b.length;break c}if(a>=e)break a;else{f=b[1];a<f&&(c=2,e=f);for(f=c-2;;){if(void 0===e)return this._cachedIndex=0,this.beforeStart_(0,a,d);if(c===f)break;d=e;e=b[--c-1];if(a>=e)break b}d=c;c=0}}for(;c<d;)e=c+d>>>1,a<b[e]?d=e:c=e+1;d=b[c];e=b[c-1];if(void 0===e)return this._cachedIndex=0,this.beforeStart_(0,a,d);if(void 0===d)return this._cachedIndex=c=b.length,this.afterEnd_(c-1,e,a)}this._cachedIndex=c;this.intervalChanged_(c,e,d)}return this.interpolate_(c,
e,a,d)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(a){var b=this.resultBuffer,c=this.sampleValues,d=this.valueSize;a*=d;for(var e=0;e!==d;++e)b[e]=c[a+e];return b},interpolate_:function(){throw Error("call to abstract method");},intervalChanged_:function(){}});Object.assign(Fa.prototype,{beforeStart_:Fa.prototype.copySampleValue_,afterEnd_:Fa.prototype.copySampleValue_});Ed.prototype=Object.assign(Object.create(Fa.prototype),
{constructor:Ed,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(a,b,c){var d=this.parameterPositions,e=a-2,f=a+1,g=d[e],h=d[f];if(void 0===g)switch(this.getSettings_().endingStart){case 2401:e=a;g=2*b-c;break;case 2402:e=d.length-2;g=b+d[e]-d[e+1];break;default:e=a,g=c}if(void 0===h)switch(this.getSettings_().endingEnd){case 2401:f=a;h=2*c-b;break;case 2402:f=1;h=c+d[1]-d[0];break;default:f=a-1,h=b}a=.5*(c-b);d=this.valueSize;this._weightPrev=a/(b-g);this._weightNext=
a/(h-c);this._offsetPrev=e*d;this._offsetNext=f*d},interpolate_:function(a,b,c,d){var e=this.resultBuffer,f=this.sampleValues,g=this.valueSize;a*=g;var h=a-g,k=this._offsetPrev,m=this._offsetNext,l=this._weightPrev,n=this._weightNext,v=(c-b)/(d-b);c=v*v;d=c*v;b=-l*d+2*l*c-l*v;l=(1+l)*d+(-1.5-2*l)*c+(-.5+l)*v+1;v=(-1-n)*d+(1.5+n)*c+.5*v;n=n*d-n*c;for(c=0;c!==g;++c)e[c]=b*f[k+c]+l*f[h+c]+v*f[a+c]+n*f[m+c];return e}});gd.prototype=Object.assign(Object.create(Fa.prototype),{constructor:gd,interpolate_:function(a,
b,c,d){var e=this.resultBuffer,f=this.sampleValues,g=this.valueSize;a*=g;var h=a-g;b=(c-b)/(d-b);c=1-b;for(d=0;d!==g;++d)e[d]=f[h+d]*c+f[a+d]*b;return e}});Fd.prototype=Object.assign(Object.create(Fa.prototype),{constructor:Fd,interpolate_:function(a){return this.copySampleValue_(a-1)}});Object.assign(la,{toJSON:function(a){var b=a.constructor;if(void 0!==b.toJSON)b=b.toJSON(a);else{b={name:a.name,times:pa.convertArray(a.times,Array),values:pa.convertArray(a.values,Array)};var c=a.getInterpolation();
c!==a.DefaultInterpolation&&(b.interpolation=c)}b.type=a.ValueTypeName;return b}});Object.assign(la.prototype,{constructor:la,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(a){return new Fd(this.times,this.values,this.getValueSize(),a)},InterpolantFactoryMethodLinear:function(a){return new gd(this.times,this.values,this.getValueSize(),a)},InterpolantFactoryMethodSmooth:function(a){return new Ed(this.times,this.values,this.getValueSize(),
a)},setInterpolation:function(a){switch(a){case 2300:var b=this.InterpolantFactoryMethodDiscrete;break;case 2301:b=this.InterpolantFactoryMethodLinear;break;case 2302:b=this.InterpolantFactoryMethodSmooth}if(void 0===b){b="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant)if(a!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw Error(b);console.warn("THREE.KeyframeTrack:",b);return this}this.createInterpolant=
b;return this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(a){if(0!==a)for(var b=this.times,c=0,d=b.length;c!==d;++c)b[c]+=a;return this},scale:function(a){if(1!==a)for(var b=this.times,c=0,d=b.length;c!==d;++c)b[c]*=a;return this},trim:function(a,
b){for(var c=this.times,d=c.length,e=0,f=d-1;e!==d&&c[e]<a;)++e;for(;-1!==f&&c[f]>b;)--f;++f;if(0!==e||f!==d)e>=f&&(f=Math.max(f,1),e=f-1),a=this.getValueSize(),this.times=pa.arraySlice(c,e,f),this.values=pa.arraySlice(this.values,e*a,f*a);return this},validate:function(){var a=!0,b=this.getValueSize();0!==b-Math.floor(b)&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),a=!1);var c=this.times;b=this.values;var d=c.length;0===d&&(console.error("THREE.KeyframeTrack: Track is empty.",
this),a=!1);for(var e=null,f=0;f!==d;f++){var g=c[f];if("number"===typeof g&&isNaN(g)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,f,g);a=!1;break}if(null!==e&&e>g){console.error("THREE.KeyframeTrack: Out of order keys.",this,f,g,e);a=!1;break}e=g}if(void 0!==b&&pa.isTypedArray(b))for(f=0,c=b.length;f!==c;++f)if(d=b[f],isNaN(d)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,f,d);a=!1;break}return a},optimize:function(){for(var a=this.times,b=this.values,
c=this.getValueSize(),d=2302===this.getInterpolation(),e=1,f=a.length-1,g=1;g<f;++g){var h=!1,k=a[g];if(k!==a[g+1]&&(1!==g||k!==k[0]))if(d)h=!0;else{var m=g*c,l=m-c,n=m+c;for(k=0;k!==c;++k){var v=b[m+k];if(v!==b[l+k]||v!==b[n+k]){h=!0;break}}}if(h){if(g!==e)for(a[e]=a[g],h=g*c,m=e*c,k=0;k!==c;++k)b[m+k]=b[h+k];++e}}if(0<f){a[e]=a[f];h=f*c;m=e*c;for(k=0;k!==c;++k)b[m+k]=b[h+k];++e}e!==a.length&&(this.times=pa.arraySlice(a,0,e),this.values=pa.arraySlice(b,0,e*c));return this},clone:function(){var a=
pa.arraySlice(this.times,0),b=pa.arraySlice(this.values,0);a=new this.constructor(this.name,a,b);a.createInterpolant=this.createInterpolant;return a}});Gd.prototype=Object.assign(Object.create(la.prototype),{constructor:Gd,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});Hd.prototype=Object.assign(Object.create(la.prototype),{constructor:Hd,ValueTypeName:"color"});lc.prototype=Object.assign(Object.create(la.prototype),
{constructor:lc,ValueTypeName:"number"});Id.prototype=Object.assign(Object.create(Fa.prototype),{constructor:Id,interpolate_:function(a,b,c,d){var e=this.resultBuffer,f=this.sampleValues,g=this.valueSize;a*=g;b=(c-b)/(d-b);for(c=a+g;a!==c;a+=4)aa.slerpFlat(e,0,f,a-g,f,a,b);return e}});hd.prototype=Object.assign(Object.create(la.prototype),{constructor:hd,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(a){return new Id(this.times,this.values,this.getValueSize(),
a)},InterpolantFactoryMethodSmooth:void 0});Jd.prototype=Object.assign(Object.create(la.prototype),{constructor:Jd,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});mc.prototype=Object.assign(Object.create(la.prototype),{constructor:mc,ValueTypeName:"vector"});Object.assign(Ia,{parse:function(a){for(var b=[],c=a.tracks,d=1/(a.fps||1),e=0,f=c.length;e!==f;++e)b.push(jh(c[e]).scale(d));return new Ia(a.name,
a.duration,b)},toJSON:function(a){var b=[],c=a.tracks;a={name:a.name,duration:a.duration,tracks:b,uuid:a.uuid};for(var d=0,e=c.length;d!==e;++d)b.push(la.toJSON(c[d]));return a},CreateFromMorphTargetSequence:function(a,b,c,d){for(var e=b.length,f=[],g=0;g<e;g++){var h=[],k=[];h.push((g+e-1)%e,g,(g+1)%e);k.push(0,1,0);var m=pa.getKeyframeOrder(h);h=pa.sortedArray(h,1,m);k=pa.sortedArray(k,1,m);d||0!==h[0]||(h.push(e),k.push(k[0]));f.push((new lc(".morphTargetInfluences["+b[g].name+"]",h,k)).scale(1/
c))}return new Ia(a,-1,f)},findByName:function(a,b){var c=a;Array.isArray(a)||(c=a.geometry&&a.geometry.animations||a.animations);for(a=0;a<c.length;a++)if(c[a].name===b)return c[a];return null},CreateClipsFromMorphTargetSequences:function(a,b,c){for(var d={},e=/^([\w-]*?)([\d]+)$/,f=0,g=a.length;f<g;f++){var h=a[f],k=h.name.match(e);if(k&&1<k.length){var m=k[1];(k=d[m])||(d[m]=k=[]);k.push(h)}}a=[];for(m in d)a.push(Ia.CreateFromMorphTargetSequence(m,d[m],b,c));return a},parseAnimation:function(a,
b){if(!a)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;var c=function(a,b,c,d,e){if(0!==c.length){var f=[],g=[];pa.flattenJSON(c,f,g,d);0!==f.length&&e.push(new a(b,f,g))}},d=[],e=a.name||"default",f=a.length||-1,g=a.fps||30;a=a.hierarchy||[];for(var h=0;h<a.length;h++){var k=a[h].keys;if(k&&0!==k.length)if(k[0].morphTargets){f={};for(var m=0;m<k.length;m++)if(k[m].morphTargets)for(var l=0;l<k[m].morphTargets.length;l++)f[k[m].morphTargets[l]]=-1;for(var n in f){var v=
[],t=[];for(l=0;l!==k[m].morphTargets.length;++l){var r=k[m];v.push(r.time);t.push(r.morphTarget===n?1:0)}d.push(new lc(".morphTargetInfluence["+n+"]",v,t))}f=f.length*(g||1)}else m=".bones["+b[h].name+"]",c(mc,m+".position",k,"pos",d),c(hd,m+".quaternion",k,"rot",d),c(mc,m+".scale",k,"scl",d)}return 0===d.length?null:new Ia(e,f,d)}});Object.assign(Ia.prototype,{resetDuration:function(){for(var a=0,b=0,c=this.tracks.length;b!==c;++b){var d=this.tracks[b];a=Math.max(a,d.times[d.times.length-1])}this.duration=
a;return this},trim:function(){for(var a=0;a<this.tracks.length;a++)this.tracks[a].trim(0,this.duration);return this},validate:function(){for(var a=!0,b=0;b<this.tracks.length;b++)a=a&&this.tracks[b].validate();return a},optimize:function(){for(var a=0;a<this.tracks.length;a++)this.tracks[a].optimize();return this},clone:function(){for(var a=[],b=0;b<this.tracks.length;b++)a.push(this.tracks[b].clone());return new Ia(this.name,this.duration,a)}});var Ob={enabled:!1,files:{},add:function(a,b){!1!==
this.enabled&&(this.files[a]=b)},get:function(a){if(!1!==this.enabled)return this.files[a]},remove:function(a){delete this.files[a]},clear:function(){this.files={}}},za=new le,Sa={};Object.assign(Ma.prototype,{load:function(a,b,c,d){void 0===a&&(a="");void 0!==this.path&&(a=this.path+a);a=this.manager.resolveURL(a);var e=this,f=Ob.get(a);if(void 0!==f)return e.manager.itemStart(a),setTimeout(function(){b&&b(f);e.manager.itemEnd(a)},0),f;if(void 0!==Sa[a])Sa[a].push({onLoad:b,onProgress:c,onError:d});
else{var g=a.match(/^data:(.*?)(;base64)?,(.*)$/);if(g){c=g[1];var h=!!g[2];g=g[3];g=decodeURIComponent(g);h&&(g=atob(g));try{var k=(this.responseType||"").toLowerCase();switch(k){case "arraybuffer":case "blob":var m=new Uint8Array(g.length);for(h=0;h<g.length;h++)m[h]=g.charCodeAt(h);var l="blob"===k?new Blob([m.buffer],{type:c}):m.buffer;break;case "document":l=(new DOMParser).parseFromString(g,c);break;case "json":l=JSON.parse(g);break;default:l=g}setTimeout(function(){b&&b(l);e.manager.itemEnd(a)},
0)}catch(v){setTimeout(function(){d&&d(v);e.manager.itemError(a);e.manager.itemEnd(a)},0)}}else{Sa[a]=[];Sa[a].push({onLoad:b,onProgress:c,onError:d});var n=new XMLHttpRequest;n.open("GET",a,!0);n.addEventListener("load",function(b){var c=this.response;Ob.add(a,c);var d=Sa[a];delete Sa[a];if(200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received.");for(var f=0,g=d.length;f<g;f++){var h=d[f];if(h.onLoad)h.onLoad(c)}}else{f=0;for(g=d.length;f<g;f++)if(h=
d[f],h.onError)h.onError(b);e.manager.itemError(a)}e.manager.itemEnd(a)},!1);n.addEventListener("progress",function(b){for(var c=Sa[a],d=0,e=c.length;d<e;d++){var f=c[d];if(f.onProgress)f.onProgress(b)}},!1);n.addEventListener("error",function(b){var c=Sa[a];delete Sa[a];for(var d=0,f=c.length;d<f;d++){var g=c[d];if(g.onError)g.onError(b)}e.manager.itemError(a);e.manager.itemEnd(a)},!1);n.addEventListener("abort",function(b){var c=Sa[a];delete Sa[a];for(var d=0,f=c.length;d<f;d++){var g=c[d];if(g.onError)g.onError(b)}e.manager.itemError(a);
e.manager.itemEnd(a)},!1);void 0!==this.responseType&&(n.responseType=this.responseType);void 0!==this.withCredentials&&(n.withCredentials=this.withCredentials);n.overrideMimeType&&n.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(h in this.requestHeader)n.setRequestHeader(h,this.requestHeader[h]);n.send(null)}e.manager.itemStart(a);return n}},setPath:function(a){this.path=a;return this},setResponseType:function(a){this.responseType=a;return this},setWithCredentials:function(a){this.withCredentials=
a;return this},setMimeType:function(a){this.mimeType=a;return this},setRequestHeader:function(a){this.requestHeader=a;return this}});Object.assign(Df.prototype,{load:function(a,b,c,d){var e=this,f=new Ma(e.manager);f.setPath(e.path);f.load(a,function(a){b(e.parse(JSON.parse(a)))},c,d)},parse:function(a){for(var b=[],c=0;c<a.length;c++){var d=Ia.parse(a[c]);b.push(d)}return b},setPath:function(a){this.path=a;return this}});Object.assign(Ef.prototype,{load:function(a,b,c,d){function e(e){k.load(a[e],
function(a){a=f._parser(a,!0);g[e]={width:a.width,height:a.height,format:a.format,mipmaps:a.mipmaps};m+=1;6===m&&(1===a.mipmapCount&&(h.minFilter=1006),h.format=a.format,h.needsUpdate=!0,b&&b(h))},c,d)}var f=this,g=[],h=new Yb;h.image=g;var k=new Ma(this.manager);k.setPath(this.path);k.setResponseType("arraybuffer");if(Array.isArray(a))for(var m=0,l=0,n=a.length;l<n;++l)e(l);else k.load(a,function(a){a=f._parser(a,!0);if(a.isCubemap)for(var c=a.mipmaps.length/a.mipmapCount,d=0;d<c;d++){g[d]={mipmaps:[]};
for(var e=0;e<a.mipmapCount;e++)g[d].mipmaps.push(a.mipmaps[d*a.mipmapCount+e]),g[d].format=a.format,g[d].width=a.width,g[d].height=a.height}else h.image.width=a.width,h.image.height=a.height,h.mipmaps=a.mipmaps;1===a.mipmapCount&&(h.minFilter=1006);h.format=a.format;h.needsUpdate=!0;b&&b(h)},c,d);return h},setPath:function(a){this.path=a;return this}});Object.assign(me.prototype,{load:function(a,b,c,d){var e=this,f=new qb,g=new Ma(this.manager);g.setResponseType("arraybuffer");g.setPath(this.path);
g.load(a,function(a){if(a=e._parser(a))void 0!==a.image?f.image=a.image:void 0!==a.data&&(f.image.width=a.width,f.image.height=a.height,f.image.data=a.data),f.wrapS=void 0!==a.wrapS?a.wrapS:1001,f.wrapT=void 0!==a.wrapT?a.wrapT:1001,f.magFilter=void 0!==a.magFilter?a.magFilter:1006,f.minFilter=void 0!==a.minFilter?a.minFilter:1008,f.anisotropy=void 0!==a.anisotropy?a.anisotropy:1,void 0!==a.format&&(f.format=a.format),void 0!==a.type&&(f.type=a.type),void 0!==a.mipmaps&&(f.mipmaps=a.mipmaps),1===
a.mipmapCount&&(f.minFilter=1006),f.needsUpdate=!0,b&&b(f,a)},c,d);return f},setPath:function(a){this.path=a;return this}});Object.assign(id.prototype,{crossOrigin:"anonymous",load:function(a,b,c,d){function e(){k.removeEventListener("load",e,!1);k.removeEventListener("error",f,!1);Ob.add(a,this);b&&b(this);g.manager.itemEnd(a)}function f(b){k.removeEventListener("load",e,!1);k.removeEventListener("error",f,!1);d&&d(b);g.manager.itemError(a);g.manager.itemEnd(a)}void 0===a&&(a="");void 0!==this.path&&
(a=this.path+a);a=this.manager.resolveURL(a);var g=this,h=Ob.get(a);if(void 0!==h)return g.manager.itemStart(a),setTimeout(function(){b&&b(h);g.manager.itemEnd(a)},0),h;var k=document.createElementNS("http://www.w3.org/1999/xhtml","img");k.addEventListener("load",e,!1);k.addEventListener("error",f,!1);"data:"!==a.substr(0,5)&&void 0!==this.crossOrigin&&(k.crossOrigin=this.crossOrigin);g.manager.itemStart(a);k.src=a;return k},setCrossOrigin:function(a){this.crossOrigin=a;return this},setPath:function(a){this.path=
a;return this}});Object.assign(ne.prototype,{crossOrigin:"anonymous",load:function(a,b,c,d){function e(c){g.load(a[c],function(a){f.images[c]=a;h++;6===h&&(f.needsUpdate=!0,b&&b(f))},void 0,d)}var f=new bb,g=new id(this.manager);g.setCrossOrigin(this.crossOrigin);g.setPath(this.path);var h=0;for(c=0;c<a.length;++c)e(c);return f},setCrossOrigin:function(a){this.crossOrigin=a;return this},setPath:function(a){this.path=a;return this}});Object.assign(Kd.prototype,{crossOrigin:"anonymous",load:function(a,
b,c,d){var e=new W,f=new id(this.manager);f.setCrossOrigin(this.crossOrigin);f.setPath(this.path);f.load(a,function(c){e.image=c;c=0<a.search(/\.jpe?g($|\?)/i)||0===a.search(/^data:image\/jpeg/);e.format=c?1022:1023;e.needsUpdate=!0;void 0!==b&&b(e)},c,d);return e},setCrossOrigin:function(a){this.crossOrigin=a;return this},setPath:function(a){this.path=a;return this}});Object.assign(I.prototype,{getPoint:function(){console.warn("THREE.Curve: .getPoint() not implemented.");return null},getPointAt:function(a,
b){a=this.getUtoTmapping(a);return this.getPoint(a,b)},getPoints:function(a){void 0===a&&(a=5);for(var b=[],c=0;c<=a;c++)b.push(this.getPoint(c/a));return b},getSpacedPoints:function(a){void 0===a&&(a=5);for(var b=[],c=0;c<=a;c++)b.push(this.getPointAt(c/a));return b},getLength:function(){var a=this.getLengths();return a[a.length-1]},getLengths:function(a){void 0===a&&(a=this.arcLengthDivisions);if(this.cacheArcLengths&&this.cacheArcLengths.length===a+1&&!this.needsUpdate)return this.cacheArcLengths;
this.needsUpdate=!1;var b=[],c=this.getPoint(0),d,e=0;b.push(0);for(d=1;d<=a;d++){var f=this.getPoint(d/a);e+=f.distanceTo(c);b.push(e);c=f}return this.cacheArcLengths=b},updateArcLengths:function(){this.needsUpdate=!0;this.getLengths()},getUtoTmapping:function(a,b){var c=this.getLengths(),d=c.length;b=b?b:a*c[d-1];for(var e=0,f=d-1,g;e<=f;)if(a=Math.floor(e+(f-e)/2),g=c[a]-b,0>g)e=a+1;else if(0<g)f=a-1;else{f=a;break}a=f;if(c[a]===b)return a/(d-1);e=c[a];return(a+(b-e)/(c[a+1]-e))/(d-1)},getTangent:function(a){var b=
a-1E-4;a+=1E-4;0>b&&(b=0);1<a&&(a=1);b=this.getPoint(b);return this.getPoint(a).clone().sub(b).normalize()},getTangentAt:function(a){a=this.getUtoTmapping(a);return this.getTangent(a)},computeFrenetFrames:function(a,b){var c=new n,d=[],e=[],f=[],g=new n,h=new P,k;for(k=0;k<=a;k++){var m=k/a;d[k]=this.getTangentAt(m);d[k].normalize()}e[0]=new n;f[0]=new n;k=Number.MAX_VALUE;m=Math.abs(d[0].x);var l=Math.abs(d[0].y),q=Math.abs(d[0].z);m<=k&&(k=m,c.set(1,0,0));l<=k&&(k=l,c.set(0,1,0));q<=k&&c.set(0,
0,1);g.crossVectors(d[0],c).normalize();e[0].crossVectors(d[0],g);f[0].crossVectors(d[0],e[0]);for(k=1;k<=a;k++)e[k]=e[k-1].clone(),f[k]=f[k-1].clone(),g.crossVectors(d[k-1],d[k]),g.length()>Number.EPSILON&&(g.normalize(),c=Math.acos(K.clamp(d[k-1].dot(d[k]),-1,1)),e[k].applyMatrix4(h.makeRotationAxis(g,c))),f[k].crossVectors(d[k],e[k]);if(!0===b)for(c=Math.acos(K.clamp(e[0].dot(e[a]),-1,1)),c/=a,0<d[0].dot(g.crossVectors(e[0],e[a]))&&(c=-c),k=1;k<=a;k++)e[k].applyMatrix4(h.makeRotationAxis(d[k],
c*k)),f[k].crossVectors(d[k],e[k]);return{tangents:d,normals:e,binormals:f}},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.arcLengthDivisions=a.arcLengthDivisions;return this},toJSON:function(){var a={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};a.arcLengthDivisions=this.arcLengthDivisions;a.type=this.type;return a},fromJSON:function(a){this.arcLengthDivisions=a.arcLengthDivisions;return this}});Ga.prototype=Object.create(I.prototype);Ga.prototype.constructor=
Ga;Ga.prototype.isEllipseCurve=!0;Ga.prototype.getPoint=function(a,b){b=b||new B;for(var c=2*Math.PI,d=this.aEndAngle-this.aStartAngle,e=Math.abs(d)<Number.EPSILON;0>d;)d+=c;for(;d>c;)d-=c;d<Number.EPSILON&&(d=e?0:c);!0!==this.aClockwise||e||(d=d===c?-c:d-c);c=this.aStartAngle+a*d;a=this.aX+this.xRadius*Math.cos(c);var f=this.aY+this.yRadius*Math.sin(c);0!==this.aRotation&&(c=Math.cos(this.aRotation),d=Math.sin(this.aRotation),e=a-this.aX,f-=this.aY,a=e*c-f*d+this.aX,f=e*d+f*c+this.aY);return b.set(a,
f)};Ga.prototype.copy=function(a){I.prototype.copy.call(this,a);this.aX=a.aX;this.aY=a.aY;this.xRadius=a.xRadius;this.yRadius=a.yRadius;this.aStartAngle=a.aStartAngle;this.aEndAngle=a.aEndAngle;this.aClockwise=a.aClockwise;this.aRotation=a.aRotation;return this};Ga.prototype.toJSON=function(){var a=I.prototype.toJSON.call(this);a.aX=this.aX;a.aY=this.aY;a.xRadius=this.xRadius;a.yRadius=this.yRadius;a.aStartAngle=this.aStartAngle;a.aEndAngle=this.aEndAngle;a.aClockwise=this.aClockwise;a.aRotation=
this.aRotation;return a};Ga.prototype.fromJSON=function(a){I.prototype.fromJSON.call(this,a);this.aX=a.aX;this.aY=a.aY;this.xRadius=a.xRadius;this.yRadius=a.yRadius;this.aStartAngle=a.aStartAngle;this.aEndAngle=a.aEndAngle;this.aClockwise=a.aClockwise;this.aRotation=a.aRotation;return this};nc.prototype=Object.create(Ga.prototype);nc.prototype.constructor=nc;nc.prototype.isArcCurve=!0;var Yd=new n,Ke=new oe,Le=new oe,Me=new oe;qa.prototype=Object.create(I.prototype);qa.prototype.constructor=qa;qa.prototype.isCatmullRomCurve3=
!0;qa.prototype.getPoint=function(a,b){b=b||new n;var c=this.points,d=c.length;a*=d-(this.closed?0:1);var e=Math.floor(a);a-=e;this.closed?e+=0<e?0:(Math.floor(Math.abs(e)/d)+1)*d:0===a&&e===d-1&&(e=d-2,a=1);if(this.closed||0<e)var f=c[(e-1)%d];else Yd.subVectors(c[0],c[1]).add(c[0]),f=Yd;var g=c[e%d];var h=c[(e+1)%d];this.closed||e+2<d?c=c[(e+2)%d]:(Yd.subVectors(c[d-1],c[d-2]).add(c[d-1]),c=Yd);if("centripetal"===this.curveType||"chordal"===this.curveType){var k="chordal"===this.curveType?.5:.25;
d=Math.pow(f.distanceToSquared(g),k);e=Math.pow(g.distanceToSquared(h),k);k=Math.pow(h.distanceToSquared(c),k);1E-4>e&&(e=1);1E-4>d&&(d=e);1E-4>k&&(k=e);Ke.initNonuniformCatmullRom(f.x,g.x,h.x,c.x,d,e,k);Le.initNonuniformCatmullRom(f.y,g.y,h.y,c.y,d,e,k);Me.initNonuniformCatmullRom(f.z,g.z,h.z,c.z,d,e,k)}else"catmullrom"===this.curveType&&(Ke.initCatmullRom(f.x,g.x,h.x,c.x,this.tension),Le.initCatmullRom(f.y,g.y,h.y,c.y,this.tension),Me.initCatmullRom(f.z,g.z,h.z,c.z,this.tension));b.set(Ke.calc(a),
Le.calc(a),Me.calc(a));return b};qa.prototype.copy=function(a){I.prototype.copy.call(this,a);this.points=[];for(var b=0,c=a.points.length;b<c;b++)this.points.push(a.points[b].clone());this.closed=a.closed;this.curveType=a.curveType;this.tension=a.tension;return this};qa.prototype.toJSON=function(){var a=I.prototype.toJSON.call(this);a.points=[];for(var b=0,c=this.points.length;b<c;b++)a.points.push(this.points[b].toArray());a.closed=this.closed;a.curveType=this.curveType;a.tension=this.tension;return a};
qa.prototype.fromJSON=function(a){I.prototype.fromJSON.call(this,a);this.points=[];for(var b=0,c=a.points.length;b<c;b++){var d=a.points[b];this.points.push((new n).fromArray(d))}this.closed=a.closed;this.curveType=a.curveType;this.tension=a.tension;return this};Na.prototype=Object.create(I.prototype);Na.prototype.constructor=Na;Na.prototype.isCubicBezierCurve=!0;Na.prototype.getPoint=function(a,b){b=b||new B;var c=this.v0,d=this.v1,e=this.v2,f=this.v3;b.set(kd(a,c.x,d.x,e.x,f.x),kd(a,c.y,d.y,e.y,
f.y));return b};Na.prototype.copy=function(a){I.prototype.copy.call(this,a);this.v0.copy(a.v0);this.v1.copy(a.v1);this.v2.copy(a.v2);this.v3.copy(a.v3);return this};Na.prototype.toJSON=function(){var a=I.prototype.toJSON.call(this);a.v0=this.v0.toArray();a.v1=this.v1.toArray();a.v2=this.v2.toArray();a.v3=this.v3.toArray();return a};Na.prototype.fromJSON=function(a){I.prototype.fromJSON.call(this,a);this.v0.fromArray(a.v0);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);this.v3.fromArray(a.v3);return this};
$a.prototype=Object.create(I.prototype);$a.prototype.constructor=$a;$a.prototype.isCubicBezierCurve3=!0;$a.prototype.getPoint=function(a,b){b=b||new n;var c=this.v0,d=this.v1,e=this.v2,f=this.v3;b.set(kd(a,c.x,d.x,e.x,f.x),kd(a,c.y,d.y,e.y,f.y),kd(a,c.z,d.z,e.z,f.z));return b};$a.prototype.copy=function(a){I.prototype.copy.call(this,a);this.v0.copy(a.v0);this.v1.copy(a.v1);this.v2.copy(a.v2);this.v3.copy(a.v3);return this};$a.prototype.toJSON=function(){var a=I.prototype.toJSON.call(this);a.v0=this.v0.toArray();
a.v1=this.v1.toArray();a.v2=this.v2.toArray();a.v3=this.v3.toArray();return a};$a.prototype.fromJSON=function(a){I.prototype.fromJSON.call(this,a);this.v0.fromArray(a.v0);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);this.v3.fromArray(a.v3);return this};xa.prototype=Object.create(I.prototype);xa.prototype.constructor=xa;xa.prototype.isLineCurve=!0;xa.prototype.getPoint=function(a,b){b=b||new B;1===a?b.copy(this.v2):(b.copy(this.v2).sub(this.v1),b.multiplyScalar(a).add(this.v1));return b};xa.prototype.getPointAt=
function(a,b){return this.getPoint(a,b)};xa.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()};xa.prototype.copy=function(a){I.prototype.copy.call(this,a);this.v1.copy(a.v1);this.v2.copy(a.v2);return this};xa.prototype.toJSON=function(){var a=I.prototype.toJSON.call(this);a.v1=this.v1.toArray();a.v2=this.v2.toArray();return a};xa.prototype.fromJSON=function(a){I.prototype.fromJSON.call(this,a);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);return this};Oa.prototype=
Object.create(I.prototype);Oa.prototype.constructor=Oa;Oa.prototype.isLineCurve3=!0;Oa.prototype.getPoint=function(a,b){b=b||new n;1===a?b.copy(this.v2):(b.copy(this.v2).sub(this.v1),b.multiplyScalar(a).add(this.v1));return b};Oa.prototype.getPointAt=function(a,b){return this.getPoint(a,b)};Oa.prototype.copy=function(a){I.prototype.copy.call(this,a);this.v1.copy(a.v1);this.v2.copy(a.v2);return this};Oa.prototype.toJSON=function(){var a=I.prototype.toJSON.call(this);a.v1=this.v1.toArray();a.v2=this.v2.toArray();
return a};Oa.prototype.fromJSON=function(a){I.prototype.fromJSON.call(this,a);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);return this};Pa.prototype=Object.create(I.prototype);Pa.prototype.constructor=Pa;Pa.prototype.isQuadraticBezierCurve=!0;Pa.prototype.getPoint=function(a,b){b=b||new B;var c=this.v0,d=this.v1,e=this.v2;b.set(jd(a,c.x,d.x,e.x),jd(a,c.y,d.y,e.y));return b};Pa.prototype.copy=function(a){I.prototype.copy.call(this,a);this.v0.copy(a.v0);this.v1.copy(a.v1);this.v2.copy(a.v2);return this};
Pa.prototype.toJSON=function(){var a=I.prototype.toJSON.call(this);a.v0=this.v0.toArray();a.v1=this.v1.toArray();a.v2=this.v2.toArray();return a};Pa.prototype.fromJSON=function(a){I.prototype.fromJSON.call(this,a);this.v0.fromArray(a.v0);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);return this};ab.prototype=Object.create(I.prototype);ab.prototype.constructor=ab;ab.prototype.isQuadraticBezierCurve3=!0;ab.prototype.getPoint=function(a,b){b=b||new n;var c=this.v0,d=this.v1,e=this.v2;b.set(jd(a,c.x,
d.x,e.x),jd(a,c.y,d.y,e.y),jd(a,c.z,d.z,e.z));return b};ab.prototype.copy=function(a){I.prototype.copy.call(this,a);this.v0.copy(a.v0);this.v1.copy(a.v1);this.v2.copy(a.v2);return this};ab.prototype.toJSON=function(){var a=I.prototype.toJSON.call(this);a.v0=this.v0.toArray();a.v1=this.v1.toArray();a.v2=this.v2.toArray();return a};ab.prototype.fromJSON=function(a){I.prototype.fromJSON.call(this,a);this.v0.fromArray(a.v0);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);return this};Qa.prototype=Object.create(I.prototype);
Qa.prototype.constructor=Qa;Qa.prototype.isSplineCurve=!0;Qa.prototype.getPoint=function(a,b){b=b||new B;var c=this.points,d=(c.length-1)*a;a=Math.floor(d);d-=a;var e=c[0===a?a:a-1],f=c[a],g=c[a>c.length-2?c.length-1:a+1];c=c[a>c.length-3?c.length-1:a+2];b.set(Ff(d,e.x,f.x,g.x,c.x),Ff(d,e.y,f.y,g.y,c.y));return b};Qa.prototype.copy=function(a){I.prototype.copy.call(this,a);this.points=[];for(var b=0,c=a.points.length;b<c;b++)this.points.push(a.points[b].clone());return this};Qa.prototype.toJSON=function(){var a=
I.prototype.toJSON.call(this);a.points=[];for(var b=0,c=this.points.length;b<c;b++)a.points.push(this.points[b].toArray());return a};Qa.prototype.fromJSON=function(a){I.prototype.fromJSON.call(this,a);this.points=[];for(var b=0,c=a.points.length;b<c;b++){var d=a.points[b];this.points.push((new B).fromArray(d))}return this};var Ne=Object.freeze({ArcCurve:nc,CatmullRomCurve3:qa,CubicBezierCurve:Na,CubicBezierCurve3:$a,EllipseCurve:Ga,LineCurve:xa,LineCurve3:Oa,QuadraticBezierCurve:Pa,QuadraticBezierCurve3:ab,
SplineCurve:Qa});eb.prototype=Object.assign(Object.create(I.prototype),{constructor:eb,add:function(a){this.curves.push(a)},closePath:function(){var a=this.curves[0].getPoint(0),b=this.curves[this.curves.length-1].getPoint(1);a.equals(b)||this.curves.push(new xa(b,a))},getPoint:function(a){var b=a*this.getLength(),c=this.getCurveLengths();for(a=0;a<c.length;){if(c[a]>=b)return b=c[a]-b,a=this.curves[a],c=a.getLength(),a.getPointAt(0===c?0:1-b/c);a++}return null},getLength:function(){var a=this.getCurveLengths();
return a[a.length-1]},updateArcLengths:function(){this.needsUpdate=!0;this.cacheLengths=null;this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var a=[],b=0,c=0,d=this.curves.length;c<d;c++)b+=this.curves[c].getLength(),a.push(b);return this.cacheLengths=a},getSpacedPoints:function(a){void 0===a&&(a=40);for(var b=[],c=0;c<=a;c++)b.push(this.getPoint(c/a));this.autoClose&&b.push(b[0]);return b},getPoints:function(a){a=
a||12;for(var b=[],c,d=0,e=this.curves;d<e.length;d++){var f=e[d];f=f.getPoints(f&&f.isEllipseCurve?2*a:f&&(f.isLineCurve||f.isLineCurve3)?1:f&&f.isSplineCurve?a*f.points.length:a);for(var g=0;g<f.length;g++){var h=f[g];c&&c.equals(h)||(b.push(h),c=h)}}this.autoClose&&1<b.length&&!b[b.length-1].equals(b[0])&&b.push(b[0]);return b},copy:function(a){I.prototype.copy.call(this,a);this.curves=[];for(var b=0,c=a.curves.length;b<c;b++)this.curves.push(a.curves[b].clone());this.autoClose=a.autoClose;return this},
toJSON:function(){var a=I.prototype.toJSON.call(this);a.autoClose=this.autoClose;a.curves=[];for(var b=0,c=this.curves.length;b<c;b++)a.curves.push(this.curves[b].toJSON());return a},fromJSON:function(a){I.prototype.fromJSON.call(this,a);this.autoClose=a.autoClose;this.curves=[];for(var b=0,c=a.curves.length;b<c;b++){var d=a.curves[b];this.curves.push((new Ne[d.type]).fromJSON(d))}return this}});Ra.prototype=Object.assign(Object.create(eb.prototype),{constructor:Ra,setFromPoints:function(a){this.moveTo(a[0].x,
a[0].y);for(var b=1,c=a.length;b<c;b++)this.lineTo(a[b].x,a[b].y)},moveTo:function(a,b){this.currentPoint.set(a,b)},lineTo:function(a,b){var c=new xa(this.currentPoint.clone(),new B(a,b));this.curves.push(c);this.currentPoint.set(a,b)},quadraticCurveTo:function(a,b,c,d){a=new Pa(this.currentPoint.clone(),new B(a,b),new B(c,d));this.curves.push(a);this.currentPoint.set(c,d)},bezierCurveTo:function(a,b,c,d,e,f){a=new Na(this.currentPoint.clone(),new B(a,b),new B(c,d),new B(e,f));this.curves.push(a);
this.currentPoint.set(e,f)},splineThru:function(a){var b=[this.currentPoint.clone()].concat(a);b=new Qa(b);this.curves.push(b);this.currentPoint.copy(a[a.length-1])},arc:function(a,b,c,d,e,f){this.absarc(a+this.currentPoint.x,b+this.currentPoint.y,c,d,e,f)},absarc:function(a,b,c,d,e,f){this.absellipse(a,b,c,c,d,e,f)},ellipse:function(a,b,c,d,e,f,g,h){this.absellipse(a+this.currentPoint.x,b+this.currentPoint.y,c,d,e,f,g,h)},absellipse:function(a,b,c,d,e,f,g,h){a=new Ga(a,b,c,d,e,f,g,h);0<this.curves.length&&
(b=a.getPoint(0),b.equals(this.currentPoint)||this.lineTo(b.x,b.y));this.curves.push(a);a=a.getPoint(1);this.currentPoint.copy(a)},copy:function(a){eb.prototype.copy.call(this,a);this.currentPoint.copy(a.currentPoint);return this},toJSON:function(){var a=eb.prototype.toJSON.call(this);a.currentPoint=this.currentPoint.toArray();return a},fromJSON:function(a){eb.prototype.fromJSON.call(this,a);this.currentPoint.fromArray(a.currentPoint);return this}});nb.prototype=Object.assign(Object.create(Ra.prototype),
{constructor:nb,getPointsHoles:function(a){for(var b=[],c=0,d=this.holes.length;c<d;c++)b[c]=this.holes[c].getPoints(a);return b},extractPoints:function(a){return{shape:this.getPoints(a),holes:this.getPointsHoles(a)}},copy:function(a){Ra.prototype.copy.call(this,a);this.holes=[];for(var b=0,c=a.holes.length;b<c;b++)this.holes.push(a.holes[b].clone());return this},toJSON:function(){var a=Ra.prototype.toJSON.call(this);a.uuid=this.uuid;a.holes=[];for(var b=0,c=this.holes.length;b<c;b++)a.holes.push(this.holes[b].toJSON());
return a},fromJSON:function(a){Ra.prototype.fromJSON.call(this,a);this.uuid=a.uuid;this.holes=[];for(var b=0,c=a.holes.length;b<c;b++){var d=a.holes[b];this.holes.push((new Ra).fromJSON(d))}return this}});ea.prototype=Object.assign(Object.create(C.prototype),{constructor:ea,isLight:!0,copy:function(a){C.prototype.copy.call(this,a);this.color.copy(a.color);this.intensity=a.intensity;return this},toJSON:function(a){a=C.prototype.toJSON.call(this,a);a.object.color=this.color.getHex();a.object.intensity=
this.intensity;void 0!==this.groundColor&&(a.object.groundColor=this.groundColor.getHex());void 0!==this.distance&&(a.object.distance=this.distance);void 0!==this.angle&&(a.object.angle=this.angle);void 0!==this.decay&&(a.object.decay=this.decay);void 0!==this.penumbra&&(a.object.penumbra=this.penumbra);void 0!==this.shadow&&(a.object.shadow=this.shadow.toJSON());return a}});Ld.prototype=Object.assign(Object.create(ea.prototype),{constructor:Ld,isHemisphereLight:!0,copy:function(a){ea.prototype.copy.call(this,
a);this.groundColor.copy(a.groundColor);return this}});Object.assign(Nb.prototype,{copy:function(a){this.camera=a.camera.clone();this.bias=a.bias;this.radius=a.radius;this.mapSize.copy(a.mapSize);return this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var a={};0!==this.bias&&(a.bias=this.bias);1!==this.radius&&(a.radius=this.radius);if(512!==this.mapSize.x||512!==this.mapSize.y)a.mapSize=this.mapSize.toArray();a.camera=this.camera.toJSON(!1).object;delete a.camera.matrix;
return a}});Md.prototype=Object.assign(Object.create(Nb.prototype),{constructor:Md,isSpotLightShadow:!0,update:function(a){var b=this.camera,c=2*K.RAD2DEG*a.angle,d=this.mapSize.width/this.mapSize.height;a=a.distance||b.far;if(c!==b.fov||d!==b.aspect||a!==b.far)b.fov=c,b.aspect=d,b.far=a,b.updateProjectionMatrix()}});Nd.prototype=Object.assign(Object.create(ea.prototype),{constructor:Nd,isSpotLight:!0,copy:function(a){ea.prototype.copy.call(this,a);this.distance=a.distance;this.angle=a.angle;this.penumbra=
a.penumbra;this.decay=a.decay;this.target=a.target.clone();this.shadow=a.shadow.clone();return this}});Od.prototype=Object.assign(Object.create(ea.prototype),{constructor:Od,isPointLight:!0,copy:function(a){ea.prototype.copy.call(this,a);this.distance=a.distance;this.decay=a.decay;this.shadow=a.shadow.clone();return this}});ld.prototype=Object.assign(Object.create(Xa.prototype),{constructor:ld,isOrthographicCamera:!0,copy:function(a,b){Xa.prototype.copy.call(this,a,b);this.left=a.left;this.right=
a.right;this.top=a.top;this.bottom=a.bottom;this.near=a.near;this.far=a.far;this.zoom=a.zoom;this.view=null===a.view?null:Object.assign({},a.view);return this},setViewOffset:function(a,b,c,d,e,f){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1});this.view.enabled=!0;this.view.fullWidth=a;this.view.fullHeight=b;this.view.offsetX=c;this.view.offsetY=d;this.view.width=e;this.view.height=f;this.updateProjectionMatrix()},clearViewOffset:function(){null!==
this.view&&(this.view.enabled=!1);this.updateProjectionMatrix()},updateProjectionMatrix:function(){var a=(this.right-this.left)/(2*this.zoom),b=(this.top-this.bottom)/(2*this.zoom),c=(this.right+this.left)/2,d=(this.top+this.bottom)/2,e=c-a;c+=a;a=d+b;b=d-b;if(null!==this.view&&this.view.enabled){c=this.zoom/(this.view.width/this.view.fullWidth);b=this.zoom/(this.view.height/this.view.fullHeight);var f=(this.right-this.left)/this.view.width;d=(this.top-this.bottom)/this.view.height;e+=this.view.offsetX/
c*f;c=e+this.view.width/c*f;a-=this.view.offsetY/b*d;b=a-this.view.height/b*d}this.projectionMatrix.makeOrthographic(e,c,a,b,this.near,this.far);this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(a){a=C.prototype.toJSON.call(this,a);a.object.zoom=this.zoom;a.object.left=this.left;a.object.right=this.right;a.object.top=this.top;a.object.bottom=this.bottom;a.object.near=this.near;a.object.far=this.far;null!==this.view&&(a.object.view=Object.assign({},this.view));return a}});
Pd.prototype=Object.assign(Object.create(Nb.prototype),{constructor:Pd});Qd.prototype=Object.assign(Object.create(ea.prototype),{constructor:Qd,isDirectionalLight:!0,copy:function(a){ea.prototype.copy.call(this,a);this.target=a.target.clone();this.shadow=a.shadow.clone();return this}});Rd.prototype=Object.assign(Object.create(ea.prototype),{constructor:Rd,isAmbientLight:!0});Sd.prototype=Object.assign(Object.create(ea.prototype),{constructor:Sd,isRectAreaLight:!0,copy:function(a){ea.prototype.copy.call(this,
a);this.width=a.width;this.height=a.height;return this},toJSON:function(a){a=ea.prototype.toJSON.call(this,a);a.object.width=this.width;a.object.height=this.height;return a}});Object.assign(Td.prototype,{load:function(a,b,c,d){var e=this,f=new Ma(e.manager);f.setPath(e.path);f.load(a,function(a){b(e.parse(JSON.parse(a)))},c,d)},parse:function(a){function b(a){void 0===c[a]&&console.warn("THREE.MaterialLoader: Undefined texture",a);return c[a]}var c=this.textures,d=new nh[a.type];void 0!==a.uuid&&
(d.uuid=a.uuid);void 0!==a.name&&(d.name=a.name);void 0!==a.color&&d.color.setHex(a.color);void 0!==a.roughness&&(d.roughness=a.roughness);void 0!==a.metalness&&(d.metalness=a.metalness);void 0!==a.emissive&&d.emissive.setHex(a.emissive);void 0!==a.specular&&d.specular.setHex(a.specular);void 0!==a.shininess&&(d.shininess=a.shininess);void 0!==a.clearCoat&&(d.clearCoat=a.clearCoat);void 0!==a.clearCoatRoughness&&(d.clearCoatRoughness=a.clearCoatRoughness);void 0!==a.vertexColors&&(d.vertexColors=
a.vertexColors);void 0!==a.fog&&(d.fog=a.fog);void 0!==a.flatShading&&(d.flatShading=a.flatShading);void 0!==a.blending&&(d.blending=a.blending);void 0!==a.combine&&(d.combine=a.combine);void 0!==a.side&&(d.side=a.side);void 0!==a.opacity&&(d.opacity=a.opacity);void 0!==a.transparent&&(d.transparent=a.transparent);void 0!==a.alphaTest&&(d.alphaTest=a.alphaTest);void 0!==a.depthTest&&(d.depthTest=a.depthTest);void 0!==a.depthWrite&&(d.depthWrite=a.depthWrite);void 0!==a.colorWrite&&(d.colorWrite=a.colorWrite);
void 0!==a.wireframe&&(d.wireframe=a.wireframe);void 0!==a.wireframeLinewidth&&(d.wireframeLinewidth=a.wireframeLinewidth);void 0!==a.wireframeLinecap&&(d.wireframeLinecap=a.wireframeLinecap);void 0!==a.wireframeLinejoin&&(d.wireframeLinejoin=a.wireframeLinejoin);void 0!==a.rotation&&(d.rotation=a.rotation);1!==a.linewidth&&(d.linewidth=a.linewidth);void 0!==a.dashSize&&(d.dashSize=a.dashSize);void 0!==a.gapSize&&(d.gapSize=a.gapSize);void 0!==a.scale&&(d.scale=a.scale);void 0!==a.polygonOffset&&
(d.polygonOffset=a.polygonOffset);void 0!==a.polygonOffsetFactor&&(d.polygonOffsetFactor=a.polygonOffsetFactor);void 0!==a.polygonOffsetUnits&&(d.polygonOffsetUnits=a.polygonOffsetUnits);void 0!==a.skinning&&(d.skinning=a.skinning);void 0!==a.morphTargets&&(d.morphTargets=a.morphTargets);void 0!==a.dithering&&(d.dithering=a.dithering);void 0!==a.visible&&(d.visible=a.visible);void 0!==a.userData&&(d.userData=a.userData);if(void 0!==a.uniforms)for(var e in a.uniforms){var f=a.uniforms[e];d.uniforms[e]=
{};switch(f.type){case "t":d.uniforms[e].value=b(f.value);break;case "c":d.uniforms[e].value=(new M).setHex(f.value);break;case "v2":d.uniforms[e].value=(new B).fromArray(f.value);break;case "v3":d.uniforms[e].value=(new n).fromArray(f.value);break;case "v4":d.uniforms[e].value=(new Y).fromArray(f.value);break;case "m3":d.uniforms[e].value=(new ba).fromArray(f.value);case "m4":d.uniforms[e].value=(new P).fromArray(f.value);break;default:d.uniforms[e].value=f.value}}void 0!==a.defines&&(d.defines=
a.defines);void 0!==a.vertexShader&&(d.vertexShader=a.vertexShader);void 0!==a.fragmentShader&&(d.fragmentShader=a.fragmentShader);if(void 0!==a.extensions)for(var g in a.extensions)d.extensions[g]=a.extensions[g];void 0!==a.shading&&(d.flatShading=1===a.shading);void 0!==a.size&&(d.size=a.size);void 0!==a.sizeAttenuation&&(d.sizeAttenuation=a.sizeAttenuation);void 0!==a.map&&(d.map=b(a.map));void 0!==a.alphaMap&&(d.alphaMap=b(a.alphaMap),d.transparent=!0);void 0!==a.bumpMap&&(d.bumpMap=b(a.bumpMap));
void 0!==a.bumpScale&&(d.bumpScale=a.bumpScale);void 0!==a.normalMap&&(d.normalMap=b(a.normalMap));void 0!==a.normalMapType&&(d.normalMapType=a.normalMapType);void 0!==a.normalScale&&(e=a.normalScale,!1===Array.isArray(e)&&(e=[e,e]),d.normalScale=(new B).fromArray(e));void 0!==a.displacementMap&&(d.displacementMap=b(a.displacementMap));void 0!==a.displacementScale&&(d.displacementScale=a.displacementScale);void 0!==a.displacementBias&&(d.displacementBias=a.displacementBias);void 0!==a.roughnessMap&&
(d.roughnessMap=b(a.roughnessMap));void 0!==a.metalnessMap&&(d.metalnessMap=b(a.metalnessMap));void 0!==a.emissiveMap&&(d.emissiveMap=b(a.emissiveMap));void 0!==a.emissiveIntensity&&(d.emissiveIntensity=a.emissiveIntensity);void 0!==a.specularMap&&(d.specularMap=b(a.specularMap));void 0!==a.envMap&&(d.envMap=b(a.envMap));void 0!==a.envMapIntensity&&(d.envMapIntensity=a.envMapIntensity);void 0!==a.reflectivity&&(d.reflectivity=a.reflectivity);void 0!==a.lightMap&&(d.lightMap=b(a.lightMap));void 0!==
a.lightMapIntensity&&(d.lightMapIntensity=a.lightMapIntensity);void 0!==a.aoMap&&(d.aoMap=b(a.aoMap));void 0!==a.aoMapIntensity&&(d.aoMapIntensity=a.aoMapIntensity);void 0!==a.gradientMap&&(d.gradientMap=b(a.gradientMap));return d},setPath:function(a){this.path=a;return this},setTextures:function(a){this.textures=a;return this}});var Oe={decodeText:function(a){if("undefined"!==typeof TextDecoder)return(new TextDecoder).decode(a);for(var b="",c=0,d=a.length;c<d;c++)b+=String.fromCharCode(a[c]);return decodeURIComponent(escape(b))},
extractUrlBase:function(a){var b=a.lastIndexOf("/");return-1===b?"./":a.substr(0,b+1)}};Object.assign(pe.prototype,{load:function(a,b,c,d){var e=this,f=new Ma(e.manager);f.setPath(e.path);f.load(a,function(a){b(e.parse(JSON.parse(a)))},c,d)},parse:function(a){var b=new z,c=a.data.index;if(void 0!==c){var d=new Pe[c.type](c.array);b.setIndex(new S(d,1))}c=a.data.attributes;for(var e in c){var f=c[e];d=new Pe[f.type](f.array);d=new S(d,f.itemSize,f.normalized);void 0!==f.name&&(d.name=f.name);b.addAttribute(e,
d)}var g=a.data.morphAttributes;if(g)for(e in g){var h=g[e],k=[];c=0;for(var m=h.length;c<m;c++)f=h[c],d=new Pe[f.type](f.array),d=new S(d,f.itemSize,f.normalized),void 0!==f.name&&(d.name=f.name),k.push(d);b.morphAttributes[e]=k}e=a.data.groups||a.data.drawcalls||a.data.offsets;if(void 0!==e)for(c=0,f=e.length;c!==f;++c)d=e[c],b.addGroup(d.start,d.count,d.materialIndex);c=a.data.boundingSphere;void 0!==c&&(e=new n,void 0!==c.center&&e.fromArray(c.center),b.boundingSphere=new Ua(e,c.radius));a.name&&
(b.name=a.name);a.userData&&(b.userData=a.userData);return b},setPath:function(a){this.path=a;return this}});var Pe={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!==typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};Object.assign(qe.prototype,{crossOrigin:"anonymous",load:function(a,b,c,d){var e=this,f=void 0===this.path?Oe.extractUrlBase(a):
this.path;this.resourcePath=this.resourcePath||f;f=new Ma(e.manager);f.setPath(this.path);f.load(a,function(c){var f=null;try{f=JSON.parse(c)}catch(k){void 0!==d&&d(k);console.error("THREE:ObjectLoader: Can't parse "+a+".",k.message);return}c=f.metadata;void 0===c||void 0===c.type||"geometry"===c.type.toLowerCase()?console.error("THREE.ObjectLoader: Can't load "+a):e.parse(f,b)},c,d)},setPath:function(a){this.path=a;return this},setResourcePath:function(a){this.resourcePath=a;return this},setCrossOrigin:function(a){this.crossOrigin=
a;return this},parse:function(a,b){var c=this.parseShape(a.shapes);c=this.parseGeometries(a.geometries,c);var d=this.parseImages(a.images,function(){void 0!==b&&b(e)});d=this.parseTextures(a.textures,d);d=this.parseMaterials(a.materials,d);var e=this.parseObject(a.object,c,d);a.animations&&(e.animations=this.parseAnimations(a.animations));void 0!==a.images&&0!==a.images.length||void 0===b||b(e);return e},parseShape:function(a){var b={};if(void 0!==a)for(var c=0,d=a.length;c<d;c++){var e=(new nb).fromJSON(a[c]);
b[e.uuid]=e}return b},parseGeometries:function(a,b){var c={};if(void 0!==a)for(var d=new pe,e=0,f=a.length;e<f;e++){var g=a[e];switch(g.type){case "PlaneGeometry":case "PlaneBufferGeometry":var h=new ya[g.type](g.width,g.height,g.widthSegments,g.heightSegments);break;case "BoxGeometry":case "BoxBufferGeometry":case "CubeGeometry":h=new ya[g.type](g.width,g.height,g.depth,g.widthSegments,g.heightSegments,g.depthSegments);break;case "CircleGeometry":case "CircleBufferGeometry":h=new ya[g.type](g.radius,
g.segments,g.thetaStart,g.thetaLength);break;case "CylinderGeometry":case "CylinderBufferGeometry":h=new ya[g.type](g.radiusTop,g.radiusBottom,g.height,g.radialSegments,g.heightSegments,g.openEnded,g.thetaStart,g.thetaLength);break;case "ConeGeometry":case "ConeBufferGeometry":h=new ya[g.type](g.radius,g.height,g.radialSegments,g.heightSegments,g.openEnded,g.thetaStart,g.thetaLength);break;case "SphereGeometry":case "SphereBufferGeometry":h=new ya[g.type](g.radius,g.widthSegments,g.heightSegments,
g.phiStart,g.phiLength,g.thetaStart,g.thetaLength);break;case "DodecahedronGeometry":case "DodecahedronBufferGeometry":case "IcosahedronGeometry":case "IcosahedronBufferGeometry":case "OctahedronGeometry":case "OctahedronBufferGeometry":case "TetrahedronGeometry":case "TetrahedronBufferGeometry":h=new ya[g.type](g.radius,g.detail);break;case "RingGeometry":case "RingBufferGeometry":h=new ya[g.type](g.innerRadius,g.outerRadius,g.thetaSegments,g.phiSegments,g.thetaStart,g.thetaLength);break;case "TorusGeometry":case "TorusBufferGeometry":h=
new ya[g.type](g.radius,g.tube,g.radialSegments,g.tubularSegments,g.arc);break;case "TorusKnotGeometry":case "TorusKnotBufferGeometry":h=new ya[g.type](g.radius,g.tube,g.tubularSegments,g.radialSegments,g.p,g.q);break;case "TubeGeometry":case "TubeBufferGeometry":h=new ya[g.type]((new Ne[g.path.type]).fromJSON(g.path),g.tubularSegments,g.radius,g.radialSegments,g.closed);break;case "LatheGeometry":case "LatheBufferGeometry":h=new ya[g.type](g.points,g.segments,g.phiStart,g.phiLength);break;case "PolyhedronGeometry":case "PolyhedronBufferGeometry":h=
new ya[g.type](g.vertices,g.indices,g.radius,g.details);break;case "ShapeGeometry":case "ShapeBufferGeometry":h=[];for(var k=0,m=g.shapes.length;k<m;k++){var l=b[g.shapes[k]];h.push(l)}h=new ya[g.type](h,g.curveSegments);break;case "ExtrudeGeometry":case "ExtrudeBufferGeometry":h=[];k=0;for(m=g.shapes.length;k<m;k++)l=b[g.shapes[k]],h.push(l);k=g.options.extrudePath;void 0!==k&&(g.options.extrudePath=(new Ne[k.type]).fromJSON(k));h=new ya[g.type](h,g.options);break;case "BufferGeometry":h=d.parse(g);
break;case "Geometry":"THREE"in window&&"LegacyJSONLoader"in THREE?h=(new THREE.LegacyJSONLoader).parse(g,this.resourcePath).geometry:console.error('THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+g.type+'"');continue}h.uuid=g.uuid;void 0!==g.name&&(h.name=g.name);!0===h.isBufferGeometry&&void 0!==g.userData&&(h.userData=g.userData);c[g.uuid]=h}return c},parseMaterials:function(a,
b){var c={},d={};if(void 0!==a){var e=new Td;e.setTextures(b);b=0;for(var f=a.length;b<f;b++){var g=a[b];if("MultiMaterial"===g.type){for(var h=[],k=0;k<g.materials.length;k++){var m=g.materials[k];void 0===c[m.uuid]&&(c[m.uuid]=e.parse(m));h.push(c[m.uuid])}d[g.uuid]=h}else void 0===c[g.uuid]&&(c[g.uuid]=e.parse(g)),d[g.uuid]=c[g.uuid]}}return d},parseAnimations:function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c],e=Ia.parse(d);void 0!==d.uuid&&(e.uuid=d.uuid);b.push(e)}return b},parseImages:function(a,
b){function c(a){d.manager.itemStart(a);return f.load(a,function(){d.manager.itemEnd(a)},void 0,function(){d.manager.itemError(a);d.manager.itemEnd(a)})}var d=this,e={};if(void 0!==a&&0<a.length){b=new le(b);var f=new id(b);f.setCrossOrigin(this.crossOrigin);b=0;for(var g=a.length;b<g;b++){var h=a[b],k=h.url;if(Array.isArray(k)){e[h.uuid]=[];for(var m=0,l=k.length;m<l;m++){var n=k[m];n=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(n)?n:d.resourcePath+n;e[h.uuid].push(c(n))}}else n=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(h.url)?
h.url:d.resourcePath+h.url,e[h.uuid]=c(n)}}return e},parseTextures:function(a,b){function c(a,b){if("number"===typeof a)return a;console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",a);return b[a]}var d={};if(void 0!==a)for(var e=0,f=a.length;e<f;e++){var g=a[e];void 0===g.image&&console.warn('THREE.ObjectLoader: No "image" specified for',g.uuid);void 0===b[g.image]&&console.warn("THREE.ObjectLoader: Undefined image",g.image);var h=Array.isArray(b[g.image])?new bb(b[g.image]):
new W(b[g.image]);h.needsUpdate=!0;h.uuid=g.uuid;void 0!==g.name&&(h.name=g.name);void 0!==g.mapping&&(h.mapping=c(g.mapping,oh));void 0!==g.offset&&h.offset.fromArray(g.offset);void 0!==g.repeat&&h.repeat.fromArray(g.repeat);void 0!==g.center&&h.center.fromArray(g.center);void 0!==g.rotation&&(h.rotation=g.rotation);void 0!==g.wrap&&(h.wrapS=c(g.wrap[0],Sf),h.wrapT=c(g.wrap[1],Sf));void 0!==g.format&&(h.format=g.format);void 0!==g.type&&(h.type=g.type);void 0!==g.encoding&&(h.encoding=g.encoding);
void 0!==g.minFilter&&(h.minFilter=c(g.minFilter,Tf));void 0!==g.magFilter&&(h.magFilter=c(g.magFilter,Tf));void 0!==g.anisotropy&&(h.anisotropy=g.anisotropy);void 0!==g.flipY&&(h.flipY=g.flipY);void 0!==g.premultiplyAlpha&&(h.premultiplyAlpha=g.premultiplyAlpha);void 0!==g.unpackAlignment&&(h.unpackAlignment=g.unpackAlignment);d[g.uuid]=h}return d},parseObject:function(a,b,c){function d(a){void 0===b[a]&&console.warn("THREE.ObjectLoader: Undefined geometry",a);return b[a]}function e(a){if(void 0!==
a){if(Array.isArray(a)){for(var b=[],d=0,e=a.length;d<e;d++){var f=a[d];void 0===c[f]&&console.warn("THREE.ObjectLoader: Undefined material",f);b.push(c[f])}return b}void 0===c[a]&&console.warn("THREE.ObjectLoader: Undefined material",a);return c[a]}}switch(a.type){case "Scene":var f=new Ad;void 0!==a.background&&Number.isInteger(a.background)&&(f.background=new M(a.background));void 0!==a.fog&&("Fog"===a.fog.type?f.fog=new zd(a.fog.color,a.fog.near,a.fog.far):"FogExp2"===a.fog.type&&(f.fog=new yd(a.fog.color,
a.fog.density)));break;case "PerspectiveCamera":f=new ja(a.fov,a.aspect,a.near,a.far);void 0!==a.focus&&(f.focus=a.focus);void 0!==a.zoom&&(f.zoom=a.zoom);void 0!==a.filmGauge&&(f.filmGauge=a.filmGauge);void 0!==a.filmOffset&&(f.filmOffset=a.filmOffset);void 0!==a.view&&(f.view=Object.assign({},a.view));break;case "OrthographicCamera":f=new ld(a.left,a.right,a.top,a.bottom,a.near,a.far);void 0!==a.zoom&&(f.zoom=a.zoom);void 0!==a.view&&(f.view=Object.assign({},a.view));break;case "AmbientLight":f=
new Rd(a.color,a.intensity);break;case "DirectionalLight":f=new Qd(a.color,a.intensity);break;case "PointLight":f=new Od(a.color,a.intensity,a.distance,a.decay);break;case "RectAreaLight":f=new Sd(a.color,a.intensity,a.width,a.height);break;case "SpotLight":f=new Nd(a.color,a.intensity,a.distance,a.angle,a.penumbra,a.decay);break;case "HemisphereLight":f=new Ld(a.color,a.groundColor,a.intensity);break;case "SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");
case "Mesh":f=d(a.geometry);var g=e(a.material);f=f.bones&&0<f.bones.length?new Kc(f,g):new va(f,g);void 0!==a.drawMode&&f.setDrawMode(a.drawMode);break;case "LOD":f=new Jc;break;case "Line":f=new oa(d(a.geometry),e(a.material),a.mode);break;case "LineLoop":f=new Cd(d(a.geometry),e(a.material));break;case "LineSegments":f=new V(d(a.geometry),e(a.material));break;case "PointCloud":case "Points":f=new Xb(d(a.geometry),e(a.material));break;case "Sprite":f=new Ic(e(a.material));break;case "Group":f=new Vb;
break;default:f=new C}f.uuid=a.uuid;void 0!==a.name&&(f.name=a.name);void 0!==a.matrix?(f.matrix.fromArray(a.matrix),void 0!==a.matrixAutoUpdate&&(f.matrixAutoUpdate=a.matrixAutoUpdate),f.matrixAutoUpdate&&f.matrix.decompose(f.position,f.quaternion,f.scale)):(void 0!==a.position&&f.position.fromArray(a.position),void 0!==a.rotation&&f.rotation.fromArray(a.rotation),void 0!==a.quaternion&&f.quaternion.fromArray(a.quaternion),void 0!==a.scale&&f.scale.fromArray(a.scale));void 0!==a.castShadow&&(f.castShadow=
a.castShadow);void 0!==a.receiveShadow&&(f.receiveShadow=a.receiveShadow);a.shadow&&(void 0!==a.shadow.bias&&(f.shadow.bias=a.shadow.bias),void 0!==a.shadow.radius&&(f.shadow.radius=a.shadow.radius),void 0!==a.shadow.mapSize&&f.shadow.mapSize.fromArray(a.shadow.mapSize),void 0!==a.shadow.camera&&(f.shadow.camera=this.parseObject(a.shadow.camera)));void 0!==a.visible&&(f.visible=a.visible);void 0!==a.frustumCulled&&(f.frustumCulled=a.frustumCulled);void 0!==a.renderOrder&&(f.renderOrder=a.renderOrder);
void 0!==a.userData&&(f.userData=a.userData);void 0!==a.layers&&(f.layers.mask=a.layers);if(void 0!==a.children){g=a.children;for(var h=0;h<g.length;h++)f.add(this.parseObject(g[h],b,c))}if("LOD"===a.type)for(a=a.levels,g=0;g<a.length;g++){h=a[g];var k=f.getObjectByProperty("uuid",h.object);void 0!==k&&f.addLevel(k,h.distance)}return f}});var oh={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,SphericalReflectionMapping:305,
CubeUVReflectionMapping:306,CubeUVRefractionMapping:307},Sf={RepeatWrapping:1E3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},Tf={NearestFilter:1003,NearestMipMapNearestFilter:1004,NearestMipMapLinearFilter:1005,LinearFilter:1006,LinearMipMapNearestFilter:1007,LinearMipMapLinearFilter:1008};re.prototype={constructor:re,setOptions:function(a){this.options=a;return this},load:function(a,b,c,d){void 0===a&&(a="");void 0!==this.path&&(a=this.path+a);a=this.manager.resolveURL(a);var e=this,f=Ob.get(a);
if(void 0!==f)return e.manager.itemStart(a),setTimeout(function(){b&&b(f);e.manager.itemEnd(a)},0),f;fetch(a).then(function(a){return a.blob()}).then(function(a){return void 0===e.options?createImageBitmap(a):createImageBitmap(a,e.options)}).then(function(c){Ob.add(a,c);b&&b(c);e.manager.itemEnd(a)}).catch(function(b){d&&d(b);e.manager.itemError(a);e.manager.itemEnd(a)});e.manager.itemStart(a)},setCrossOrigin:function(){return this},setPath:function(a){this.path=a;return this}};Object.assign(se.prototype,
{moveTo:function(a,b){this.currentPath=new Ra;this.subPaths.push(this.currentPath);this.currentPath.moveTo(a,b)},lineTo:function(a,b){this.currentPath.lineTo(a,b)},quadraticCurveTo:function(a,b,c,d){this.currentPath.quadraticCurveTo(a,b,c,d)},bezierCurveTo:function(a,b,c,d,e,f){this.currentPath.bezierCurveTo(a,b,c,d,e,f)},splineThru:function(a){this.currentPath.splineThru(a)},toShapes:function(a,b){function c(a){for(var b=[],c=0,d=a.length;c<d;c++){var e=a[c],f=new nb;f.curves=e.curves;b.push(f)}return b}
function d(a,b){for(var c=b.length,d=!1,e=c-1,f=0;f<c;e=f++){var g=b[e],h=b[f],k=h.x-g.x,m=h.y-g.y;if(Math.abs(m)>Number.EPSILON){if(0>m&&(g=b[f],k=-k,h=b[e],m=-m),!(a.y<g.y||a.y>h.y))if(a.y===g.y){if(a.x===g.x)return!0}else{e=m*(a.x-g.x)-k*(a.y-g.y);if(0===e)return!0;0>e||(d=!d)}}else if(a.y===g.y&&(h.x<=a.x&&a.x<=g.x||g.x<=a.x&&a.x<=h.x))return!0}return d}var e=cb.isClockWise,f=this.subPaths;if(0===f.length)return[];if(!0===b)return c(f);b=[];if(1===f.length){var g=f[0];var h=new nb;h.curves=g.curves;
b.push(h);return b}var k=!e(f[0].getPoints());k=a?!k:k;h=[];var m=[],l=[],n=0;m[n]=void 0;l[n]=[];for(var v=0,t=f.length;v<t;v++){g=f[v];var r=g.getPoints();var u=e(r);(u=a?!u:u)?(!k&&m[n]&&n++,m[n]={s:new nb,p:r},m[n].s.curves=g.curves,k&&n++,l[n]=[]):l[n].push({h:g,p:r[0]})}if(!m[0])return c(f);if(1<m.length){v=!1;a=[];e=0;for(f=m.length;e<f;e++)h[e]=[];e=0;for(f=m.length;e<f;e++)for(g=l[e],u=0;u<g.length;u++){k=g[u];n=!0;for(r=0;r<m.length;r++)d(k.p,m[r].p)&&(e!==r&&a.push({froms:e,tos:r,hole:u}),
n?(n=!1,h[r].push(k)):v=!0);n&&h[e].push(k)}0<a.length&&(v||(l=h))}v=0;for(e=m.length;v<e;v++)for(h=m[v].s,b.push(h),a=l[v],f=0,g=a.length;f<g;f++)h.holes.push(a[f].h);return b}});Object.assign(te.prototype,{isFont:!0,generateShapes:function(a,b){void 0===b&&(b=100);var c=[],d=b;b=this.data;var e=Array.from?Array.from(a):String(a).split("");d/=b.resolution;var f=(b.boundingBox.yMax-b.boundingBox.yMin+b.underlineThickness)*d;a=[];for(var g=0,h=0,k=0;k<e.length;k++){var m=e[k];if("\n"===m)g=0,h-=f;
else{var l=d;var n=g,v=h;if(m=b.glyphs[m]||b.glyphs["?"]){var t=new se;if(m.o)for(var r=m._cachedOutline||(m._cachedOutline=m.o.split(" ")),u=0,x=r.length;u<x;)switch(r[u++]){case "m":var A=r[u++]*l+n;var w=r[u++]*l+v;t.moveTo(A,w);break;case "l":A=r[u++]*l+n;w=r[u++]*l+v;t.lineTo(A,w);break;case "q":var y=r[u++]*l+n;var z=r[u++]*l+v;var B=r[u++]*l+n;var C=r[u++]*l+v;t.quadraticCurveTo(B,C,y,z);break;case "b":y=r[u++]*l+n,z=r[u++]*l+v,B=r[u++]*l+n,C=r[u++]*l+v,A=r[u++]*l+n,w=r[u++]*l+v,t.bezierCurveTo(B,
C,A,w,y,z)}l={offsetX:m.ha*l,path:t}}else l=void 0;g+=l.offsetX;a.push(l.path)}}b=0;for(e=a.length;b<e;b++)Array.prototype.push.apply(c,a[b].toShapes());return c}});Object.assign(Gf.prototype,{load:function(a,b,c,d){var e=this,f=new Ma(this.manager);f.setPath(this.path);f.load(a,function(a){try{var c=JSON.parse(a)}catch(k){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),c=JSON.parse(a.substring(65,a.length-2))}a=e.parse(c);b&&b(a)},c,d)},parse:function(a){return new te(a)},
setPath:function(a){this.path=a;return this}});md.Handlers={handlers:[],add:function(a,b){this.handlers.push(a,b)},get:function(a){for(var b=this.handlers,c=0,d=b.length;c<d;c+=2){var e=b[c+1];if(b[c].test(a))return e}return null}};Object.assign(md.prototype,{crossOrigin:"anonymous",onLoadStart:function(){},onLoadProgress:function(){},onLoadComplete:function(){},initMaterials:function(a,b,c){for(var d=[],e=0;e<a.length;++e)d[e]=this.createMaterial(a[e],b,c);return d},createMaterial:function(){var a=
{NoBlending:0,NormalBlending:1,AdditiveBlending:2,SubtractiveBlending:3,MultiplyBlending:4,CustomBlending:5},b=new M,c=new Kd,d=new Td;return function(e,f,g){function h(a,b,d,e,h){a=f+a;var l=md.Handlers.get(a);null!==l?a=l.load(a):(c.setCrossOrigin(g),a=c.load(a));void 0!==b&&(a.repeat.fromArray(b),1!==b[0]&&(a.wrapS=1E3),1!==b[1]&&(a.wrapT=1E3));void 0!==d&&a.offset.fromArray(d);void 0!==e&&("repeat"===e[0]&&(a.wrapS=1E3),"mirror"===e[0]&&(a.wrapS=1002),"repeat"===e[1]&&(a.wrapT=1E3),"mirror"===
e[1]&&(a.wrapT=1002));void 0!==h&&(a.anisotropy=h);b=K.generateUUID();k[b]=a;return b}var k={},l={uuid:K.generateUUID(),type:"MeshLambertMaterial"},n;for(n in e){var q=e[n];switch(n){case "DbgColor":case "DbgIndex":case "opticalDensity":case "illumination":break;case "DbgName":l.name=q;break;case "blending":l.blending=a[q];break;case "colorAmbient":case "mapAmbient":console.warn("THREE.Loader.createMaterial:",n,"is no longer supported.");break;case "colorDiffuse":l.color=b.fromArray(q).getHex();break;
case "colorSpecular":l.specular=b.fromArray(q).getHex();break;case "colorEmissive":l.emissive=b.fromArray(q).getHex();break;case "specularCoef":l.shininess=q;break;case "shading":"basic"===q.toLowerCase()&&(l.type="MeshBasicMaterial");"phong"===q.toLowerCase()&&(l.type="MeshPhongMaterial");"standard"===q.toLowerCase()&&(l.type="MeshStandardMaterial");break;case "mapDiffuse":l.map=h(q,e.mapDiffuseRepeat,e.mapDiffuseOffset,e.mapDiffuseWrap,e.mapDiffuseAnisotropy);break;case "mapDiffuseRepeat":case "mapDiffuseOffset":case "mapDiffuseWrap":case "mapDiffuseAnisotropy":break;
case "mapEmissive":l.emissiveMap=h(q,e.mapEmissiveRepeat,e.mapEmissiveOffset,e.mapEmissiveWrap,e.mapEmissiveAnisotropy);break;case "mapEmissiveRepeat":case "mapEmissiveOffset":case "mapEmissiveWrap":case "mapEmissiveAnisotropy":break;case "mapLight":l.lightMap=h(q,e.mapLightRepeat,e.mapLightOffset,e.mapLightWrap,e.mapLightAnisotropy);break;case "mapLightRepeat":case "mapLightOffset":case "mapLightWrap":case "mapLightAnisotropy":break;case "mapAO":l.aoMap=h(q,e.mapAORepeat,e.mapAOOffset,e.mapAOWrap,
e.mapAOAnisotropy);break;case "mapAORepeat":case "mapAOOffset":case "mapAOWrap":case "mapAOAnisotropy":break;case "mapBump":l.bumpMap=h(q,e.mapBumpRepeat,e.mapBumpOffset,e.mapBumpWrap,e.mapBumpAnisotropy);break;case "mapBumpScale":l.bumpScale=q;break;case "mapBumpRepeat":case "mapBumpOffset":case "mapBumpWrap":case "mapBumpAnisotropy":break;case "mapNormal":l.normalMap=h(q,e.mapNormalRepeat,e.mapNormalOffset,e.mapNormalWrap,e.mapNormalAnisotropy);break;case "mapNormalFactor":l.normalScale=q;break;
case "mapNormalRepeat":case "mapNormalOffset":case "mapNormalWrap":case "mapNormalAnisotropy":break;case "mapSpecular":l.specularMap=h(q,e.mapSpecularRepeat,e.mapSpecularOffset,e.mapSpecularWrap,e.mapSpecularAnisotropy);break;case "mapSpecularRepeat":case "mapSpecularOffset":case "mapSpecularWrap":case "mapSpecularAnisotropy":break;case "mapMetalness":l.metalnessMap=h(q,e.mapMetalnessRepeat,e.mapMetalnessOffset,e.mapMetalnessWrap,e.mapMetalnessAnisotropy);break;case "mapMetalnessRepeat":case "mapMetalnessOffset":case "mapMetalnessWrap":case "mapMetalnessAnisotropy":break;
case "mapRoughness":l.roughnessMap=h(q,e.mapRoughnessRepeat,e.mapRoughnessOffset,e.mapRoughnessWrap,e.mapRoughnessAnisotropy);break;case "mapRoughnessRepeat":case "mapRoughnessOffset":case "mapRoughnessWrap":case "mapRoughnessAnisotropy":break;case "mapAlpha":l.alphaMap=h(q,e.mapAlphaRepeat,e.mapAlphaOffset,e.mapAlphaWrap,e.mapAlphaAnisotropy);break;case "mapAlphaRepeat":case "mapAlphaOffset":case "mapAlphaWrap":case "mapAlphaAnisotropy":break;case "flipSided":l.side=1;break;case "doubleSided":l.side=
2;break;case "transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity");l.opacity=q;break;case "depthTest":case "depthWrite":case "colorWrite":case "opacity":case "reflectivity":case "transparent":case "visible":case "wireframe":l[n]=q;break;case "vertexColors":!0===q&&(l.vertexColors=2);"face"===q&&(l.vertexColors=1);break;default:console.error("THREE.Loader.createMaterial: Unsupported",n,q)}}"MeshBasicMaterial"===l.type&&delete l.emissive;"MeshPhongMaterial"!==
l.type&&delete l.specular;1>l.opacity&&(l.transparent=!0);d.setTextures(k);return d.parse(l)}}()});var Zd,xe={getContext:function(){void 0===Zd&&(Zd=new (window.AudioContext||window.webkitAudioContext));return Zd},setContext:function(a){Zd=a}};Object.assign(ue.prototype,{load:function(a,b,c,d){var e=new Ma(this.manager);e.setResponseType("arraybuffer");e.setPath(this.path);e.load(a,function(a){a=a.slice(0);xe.getContext().decodeAudioData(a,function(a){b(a)})},c,d)},setPath:function(a){this.path=a;
return this}});Object.assign(Hf.prototype,{update:function(){var a,b,c,d,e,f,g,h,k=new P,l=new P;return function(m){if(a!==this||b!==m.focus||c!==m.fov||d!==m.aspect*this.aspect||e!==m.near||f!==m.far||g!==m.zoom||h!==this.eyeSep){a=this;b=m.focus;c=m.fov;d=m.aspect*this.aspect;e=m.near;f=m.far;g=m.zoom;var n=m.projectionMatrix.clone();h=this.eyeSep/2;var p=h*e/b,t=e*Math.tan(K.DEG2RAD*c*.5)/g;l.elements[12]=-h;k.elements[12]=h;var r=-t*d+p;var u=t*d+p;n.elements[0]=2*e/(u-r);n.elements[8]=(u+r)/
(u-r);this.cameraL.projectionMatrix.copy(n);r=-t*d-p;u=t*d-p;n.elements[0]=2*e/(u-r);n.elements[8]=(u+r)/(u-r);this.cameraR.projectionMatrix.copy(n)}this.cameraL.matrixWorld.copy(m.matrixWorld).multiply(l);this.cameraR.matrixWorld.copy(m.matrixWorld).multiply(k)}}()});nd.prototype=Object.create(C.prototype);nd.prototype.constructor=nd;Object.assign(ve.prototype,{start:function(){this.oldTime=this.startTime=("undefined"===typeof performance?Date:performance).now();this.elapsedTime=0;this.running=!0},
stop:function(){this.getElapsedTime();this.autoStart=this.running=!1},getElapsedTime:function(){this.getDelta();return this.elapsedTime},getDelta:function(){var a=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var b=("undefined"===typeof performance?Date:performance).now();a=(b-this.oldTime)/1E3;this.oldTime=b;this.elapsedTime+=a}return a}});we.prototype=Object.assign(Object.create(C.prototype),{constructor:we,getInput:function(){return this.gain},removeFilter:function(){null!==
this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null);return this},getFilter:function(){return this.filter},setFilter:function(a){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination);this.filter=a;this.gain.connect(this.filter);this.filter.connect(this.context.destination);return this},getMasterVolume:function(){return this.gain.gain.value},
setMasterVolume:function(a){this.gain.gain.setTargetAtTime(a,this.context.currentTime,.01);return this},updateMatrixWorld:function(){var a=new n,b=new aa,c=new n,d=new n,e=new ve;return function(f){C.prototype.updateMatrixWorld.call(this,f);f=this.context.listener;var g=this.up;this.timeDelta=e.getDelta();this.matrixWorld.decompose(a,b,c);d.set(0,0,-1).applyQuaternion(b);if(f.positionX){var h=this.context.currentTime+this.timeDelta;f.positionX.linearRampToValueAtTime(a.x,h);f.positionY.linearRampToValueAtTime(a.y,
h);f.positionZ.linearRampToValueAtTime(a.z,h);f.forwardX.linearRampToValueAtTime(d.x,h);f.forwardY.linearRampToValueAtTime(d.y,h);f.forwardZ.linearRampToValueAtTime(d.z,h);f.upX.linearRampToValueAtTime(g.x,h);f.upY.linearRampToValueAtTime(g.y,h);f.upZ.linearRampToValueAtTime(g.z,h)}else f.setPosition(a.x,a.y,a.z),f.setOrientation(d.x,d.y,d.z,g.x,g.y,g.z)}}()});oc.prototype=Object.assign(Object.create(C.prototype),{constructor:oc,getOutput:function(){return this.gain},setNodeSource:function(a){this.hasPlaybackControl=
!1;this.sourceType="audioNode";this.source=a;this.connect();return this},setMediaElementSource:function(a){this.hasPlaybackControl=!1;this.sourceType="mediaNode";this.source=this.context.createMediaElementSource(a);this.connect();return this},setBuffer:function(a){this.buffer=a;this.sourceType="buffer";this.autoplay&&this.play();return this},play:function(){if(!0===this.isPlaying)console.warn("THREE.Audio: Audio is already playing.");else if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");
else{var a=this.context.createBufferSource();a.buffer=this.buffer;a.loop=this.loop;a.onended=this.onEnded.bind(this);this.startTime=this.context.currentTime;a.start(this.startTime,this.offset);this.isPlaying=!0;this.source=a;this.setDetune(this.detune);this.setPlaybackRate(this.playbackRate);return this.connect()}},pause:function(){if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else return!0===this.isPlaying&&(this.source.stop(),this.source.onended=
null,this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this},stop:function(){if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else return this.source.stop(),this.source.onended=null,this.offset=0,this.isPlaying=!1,this},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var a=1,b=this.filters.length;a<b;a++)this.filters[a-1].connect(this.filters[a]);this.filters[this.filters.length-
1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var a=1,b=this.filters.length;a<b;a++)this.filters[a-1].disconnect(this.filters[a]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(a){a||(a=[]);!0===this.isPlaying?(this.disconnect(),this.filters=
a,this.connect()):this.filters=a;return this},setDetune:function(a){this.detune=a;if(void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(a){return this.setFilters(a?[a]:[])},setPlaybackRate:function(a){if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else return this.playbackRate=
a,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(a){if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else return this.loop=a,!0===this.isPlaying&&
(this.source.loop=this.loop),this},getVolume:function(){return this.gain.gain.value},setVolume:function(a){this.gain.gain.setTargetAtTime(a,this.context.currentTime,.01);return this}});ye.prototype=Object.assign(Object.create(oc.prototype),{constructor:ye,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(a){this.panner.refDistance=a;return this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(a){this.panner.rolloffFactor=
a;return this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(a){this.panner.distanceModel=a;return this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(a){this.panner.maxDistance=a;return this},setDirectionalCone:function(a,b,c){this.panner.coneInnerAngle=a;this.panner.coneOuterAngle=b;this.panner.coneOuterGain=c;return this},updateMatrixWorld:function(){var a=new n,b=new aa,c=new n,d=new n;return function(e){C.prototype.updateMatrixWorld.call(this,
e);if(!0!==this.hasPlaybackControl||!1!==this.isPlaying)if(this.matrixWorld.decompose(a,b,c),d.set(0,0,1).applyQuaternion(b),e=this.panner,e.positionX){var f=this.context.currentTime+this.listener.timeDelta;e.positionX.linearRampToValueAtTime(a.x,f);e.positionY.linearRampToValueAtTime(a.y,f);e.positionZ.linearRampToValueAtTime(a.z,f);e.orientationX.linearRampToValueAtTime(d.x,f);e.orientationY.linearRampToValueAtTime(d.y,f);e.orientationZ.linearRampToValueAtTime(d.z,f)}else e.setPosition(a.x,a.y,
a.z),e.setOrientation(d.x,d.y,d.z)}}()});Object.assign(ze.prototype,{getFrequencyData:function(){this.analyser.getByteFrequencyData(this.data);return this.data},getAverageFrequency:function(){for(var a=0,b=this.getFrequencyData(),c=0;c<b.length;c++)a+=b[c];return a/b.length}});Object.assign(Ae.prototype,{accumulate:function(a,b){var c=this.buffer,d=this.valueSize;a=a*d+d;var e=this.cumulativeWeight;if(0===e){for(e=0;e!==d;++e)c[a+e]=c[e];e=b}else e+=b,this._mixBufferRegion(c,a,0,b/e,d);this.cumulativeWeight=
e},apply:function(a){var b=this.valueSize,c=this.buffer;a=a*b+b;var d=this.cumulativeWeight,e=this.binding;this.cumulativeWeight=0;1>d&&this._mixBufferRegion(c,a,3*b,1-d,b);d=b;for(var f=b+b;d!==f;++d)if(c[d]!==c[d+b]){e.setValue(c,a);break}},saveOriginalState:function(){var a=this.buffer,b=this.valueSize,c=3*b;this.binding.getValue(a,c);for(var d=b;d!==c;++d)a[d]=a[c+d%b];this.cumulativeWeight=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,3*this.valueSize)},_select:function(a,
b,c,d,e){if(.5<=d)for(d=0;d!==e;++d)a[b+d]=a[c+d]},_slerp:function(a,b,c,d){aa.slerpFlat(a,b,a,b,a,c,d)},_lerp:function(a,b,c,d,e){for(var f=1-d,g=0;g!==e;++g){var h=b+g;a[h]=a[h]*f+a[c+g]*d}}});Object.assign(If.prototype,{getValue:function(a,b){this.bind();var c=this._bindings[this._targetGroup.nCachedObjects_];void 0!==c&&c.getValue(a,b)},setValue:function(a,b){for(var c=this._bindings,d=this._targetGroup.nCachedObjects_,e=c.length;d!==e;++d)c[d].setValue(a,b)},bind:function(){for(var a=this._bindings,
b=this._targetGroup.nCachedObjects_,c=a.length;b!==c;++b)a[b].bind()},unbind:function(){for(var a=this._bindings,b=this._targetGroup.nCachedObjects_,c=a.length;b!==c;++b)a[b].unbind()}});Object.assign(ma,{Composite:If,create:function(a,b,c){return a&&a.isAnimationObjectGroup?new ma.Composite(a,b,c):new ma(a,b,c)},sanitizeNodeName:function(){var a=/[\[\]\.:\/]/g;return function(b){return b.replace(/\s/g,"_").replace(a,"")}}(),parseTrackName:function(){var a="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",
b=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]");a=/(WCOD+)?/.source.replace("WCOD",a);var c=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),d=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),e=new RegExp("^"+b+a+c+d+"$"),f=["material","materials","bones"];return function(a){var b=e.exec(a);if(!b)throw Error("PropertyBinding: Cannot parse trackName: "+a);b={nodeName:b[2],objectName:b[3],objectIndex:b[4],propertyName:b[5],propertyIndex:b[6]};var c=b.nodeName&&
b.nodeName.lastIndexOf(".");if(void 0!==c&&-1!==c){var d=b.nodeName.substring(c+1);-1!==f.indexOf(d)&&(b.nodeName=b.nodeName.substring(0,c),b.objectName=d)}if(null===b.propertyName||0===b.propertyName.length)throw Error("PropertyBinding: can not parse propertyName from trackName: "+a);return b}}(),findNode:function(a,b){if(!b||""===b||"root"===b||"."===b||-1===b||b===a.name||b===a.uuid)return a;if(a.skeleton){var c=a.skeleton.getBoneByName(b);if(void 0!==c)return c}if(a.children){var d=function(a){for(var c=
0;c<a.length;c++){var e=a[c];if(e.name===b||e.uuid===b||(e=d(e.children)))return e}return null};if(a=d(a.children))return a}return null}});Object.assign(ma.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(a,b){a[b]=this.node[this.propertyName]},function(a,b){for(var c=this.resolvedProperty,d=0,e=c.length;d!==e;++d)a[b++]=
c[d]},function(a,b){a[b]=this.resolvedProperty[this.propertyIndex]},function(a,b){this.resolvedProperty.toArray(a,b)}],SetterByBindingTypeAndVersioning:[[function(a,b){this.targetObject[this.propertyName]=a[b]},function(a,b){this.targetObject[this.propertyName]=a[b];this.targetObject.needsUpdate=!0},function(a,b){this.targetObject[this.propertyName]=a[b];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(a,b){for(var c=this.resolvedProperty,d=0,e=c.length;d!==e;++d)c[d]=a[b++]},function(a,b){for(var c=
this.resolvedProperty,d=0,e=c.length;d!==e;++d)c[d]=a[b++];this.targetObject.needsUpdate=!0},function(a,b){for(var c=this.resolvedProperty,d=0,e=c.length;d!==e;++d)c[d]=a[b++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(a,b){this.resolvedProperty[this.propertyIndex]=a[b]},function(a,b){this.resolvedProperty[this.propertyIndex]=a[b];this.targetObject.needsUpdate=!0},function(a,b){this.resolvedProperty[this.propertyIndex]=a[b];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(a,b){this.resolvedProperty.fromArray(a,
b)},function(a,b){this.resolvedProperty.fromArray(a,b);this.targetObject.needsUpdate=!0},function(a,b){this.resolvedProperty.fromArray(a,b);this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(a,b){this.bind();this.getValue(a,b)},setValue:function(a,b){this.bind();this.setValue(a,b)},bind:function(){var a=this.node,b=this.parsedPath,c=b.objectName,d=b.propertyName,e=b.propertyIndex;a||(this.node=a=ma.findNode(this.rootNode,b.nodeName)||this.rootNode);this.getValue=this._getValue_unavailable;
this.setValue=this._setValue_unavailable;if(a){if(c){var f=b.objectIndex;switch(c){case "materials":if(!a.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!a.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}a=a.material.materials;break;case "bones":if(!a.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",
this);return}a=a.skeleton.bones;for(c=0;c<a.length;c++)if(a[c].name===f){f=c;break}break;default:if(void 0===a[c]){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}a=a[c]}if(void 0!==f){if(void 0===a[f]){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,a);return}a=a[f]}}f=a[d];if(void 0===f)console.error("THREE.PropertyBinding: Trying to update property for track: "+b.nodeName+"."+d+" but it wasn't found.",
a);else{b=this.Versioning.None;this.targetObject=a;void 0!==a.needsUpdate?b=this.Versioning.NeedsUpdate:void 0!==a.matrixWorldNeedsUpdate&&(b=this.Versioning.MatrixWorldNeedsUpdate);c=this.BindingType.Direct;if(void 0!==e){if("morphTargetInfluences"===d){if(!a.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(a.geometry.isBufferGeometry){if(!a.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",
this);return}for(c=0;c<this.node.geometry.morphAttributes.position.length;c++)if(a.geometry.morphAttributes.position[c].name===e){e=c;break}}else{if(!a.geometry.morphTargets){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);return}for(c=0;c<this.node.geometry.morphTargets.length;c++)if(a.geometry.morphTargets[c].name===e){e=c;break}}}c=this.BindingType.ArrayElement;this.resolvedProperty=f;this.propertyIndex=e}else void 0!==
f.fromArray&&void 0!==f.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=f):Array.isArray(f)?(c=this.BindingType.EntireArray,this.resolvedProperty=f):this.propertyName=d;this.getValue=this.GetterByBindingType[c];this.setValue=this.SetterByBindingTypeAndVersioning[c][b]}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null;this.getValue=this._getValue_unbound;this.setValue=this._setValue_unbound}});
Object.assign(ma.prototype,{_getValue_unbound:ma.prototype.getValue,_setValue_unbound:ma.prototype.setValue});Object.assign(Jf.prototype,{isAnimationObjectGroup:!0,add:function(){for(var a=this._objects,b=a.length,c=this.nCachedObjects_,d=this._indicesByUUID,e=this._paths,f=this._parsedPaths,g=this._bindings,h=g.length,k=void 0,l=0,n=arguments.length;l!==n;++l){var q=arguments[l],v=q.uuid,t=d[v];if(void 0===t){t=b++;d[v]=t;a.push(q);v=0;for(var r=h;v!==r;++v)g[v].push(new ma(q,e[v],f[v]))}else if(t<
c){k=a[t];var u=--c;r=a[u];d[r.uuid]=t;a[t]=r;d[v]=u;a[u]=q;v=0;for(r=h;v!==r;++v){var x=g[v],z=x[t];x[t]=x[u];void 0===z&&(z=new ma(q,e[v],f[v]));x[u]=z}}else a[t]!==k&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c},remove:function(){for(var a=this._objects,b=this.nCachedObjects_,c=this._indicesByUUID,d=this._bindings,e=d.length,f=0,g=arguments.length;f!==g;++f){var h=
arguments[f],k=h.uuid,l=c[k];if(void 0!==l&&l>=b){var n=b++,q=a[n];c[q.uuid]=l;a[l]=q;c[k]=n;a[n]=h;h=0;for(k=e;h!==k;++h){q=d[h];var v=q[l];q[l]=q[n];q[n]=v}}}this.nCachedObjects_=b},uncache:function(){for(var a=this._objects,b=a.length,c=this.nCachedObjects_,d=this._indicesByUUID,e=this._bindings,f=e.length,g=0,h=arguments.length;g!==h;++g){var k=arguments[g].uuid,l=d[k];if(void 0!==l)if(delete d[k],l<c){k=--c;var n=a[k],q=--b,v=a[q];d[n.uuid]=l;a[l]=n;d[v.uuid]=k;a[k]=v;a.pop();n=0;for(v=f;n!==
v;++n){var t=e[n],r=t[q];t[l]=t[k];t[k]=r;t.pop()}}else for(q=--b,v=a[q],d[v.uuid]=l,a[l]=v,a.pop(),n=0,v=f;n!==v;++n)t=e[n],t[l]=t[q],t.pop()}this.nCachedObjects_=c},subscribe_:function(a,b){var c=this._bindingsIndicesByPath,d=c[a],e=this._bindings;if(void 0!==d)return e[d];var f=this._paths,g=this._parsedPaths,h=this._objects,k=this.nCachedObjects_,l=Array(h.length);d=e.length;c[a]=d;f.push(a);g.push(b);e.push(l);c=k;for(d=h.length;c!==d;++c)l[c]=new ma(h[c],a,b);return l},unsubscribe_:function(a){var b=
this._bindingsIndicesByPath,c=b[a];if(void 0!==c){var d=this._paths,e=this._parsedPaths,f=this._bindings,g=f.length-1,h=f[g];b[a[g]]=c;f[c]=h;f.pop();e[c]=e[g];e.pop();d[c]=d[g];d.pop()}}});Object.assign(Kf.prototype,{play:function(){this._mixer._activateAction(this);return this},stop:function(){this._mixer._deactivateAction(this);return this.reset()},reset:function(){this.paused=!1;this.enabled=!0;this.time=0;this._loopCount=-1;this._startTime=null;return this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&
!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(a){this._startTime=a;return this},setLoop:function(a,b){this.loop=a;this.repetitions=b;return this},setEffectiveWeight:function(a){this.weight=a;this._effectiveWeight=this.enabled?a:0;return this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(a){return this._scheduleFading(a,0,1)},fadeOut:function(a){return this._scheduleFading(a,
1,0)},crossFadeFrom:function(a,b,c){a.fadeOut(b);this.fadeIn(b);if(c){c=this._clip.duration;var d=a._clip.duration,e=c/d;a.warp(1,d/c,b);this.warp(e,1,b)}return this},crossFadeTo:function(a,b,c){return a.crossFadeFrom(this,b,c)},stopFading:function(){var a=this._weightInterpolant;null!==a&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(a));return this},setEffectiveTimeScale:function(a){this.timeScale=a;this._effectiveTimeScale=this.paused?0:a;return this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},
setDuration:function(a){this.timeScale=this._clip.duration/a;return this.stopWarping()},syncWith:function(a){this.time=a.time;this.timeScale=a.timeScale;return this.stopWarping()},halt:function(a){return this.warp(this._effectiveTimeScale,0,a)},warp:function(a,b,c){var d=this._mixer,e=d.time,f=this._timeScaleInterpolant,g=this.timeScale;null===f&&(this._timeScaleInterpolant=f=d._lendControlInterpolant());d=f.parameterPositions;f=f.sampleValues;d[0]=e;d[1]=e+c;f[0]=a/g;f[1]=b/g;return this},stopWarping:function(){var a=
this._timeScaleInterpolant;null!==a&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(a));return this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(a,b,c,d){if(this.enabled){var e=this._startTime;if(null!==e){b=(a-e)*c;if(0>b||0===c)return;this._startTime=null;b*=c}b*=this._updateTimeScale(a);c=this._updateTime(b);a=this._updateWeight(a);if(0<a){b=this._interpolants;
e=this._propertyBindings;for(var f=0,g=b.length;f!==g;++f)b[f].evaluate(c),e[f].accumulate(d,a)}}else this._updateWeight(a)},_updateWeight:function(a){var b=0;if(this.enabled){b=this.weight;var c=this._weightInterpolant;if(null!==c){var d=c.evaluate(a)[0];b*=d;a>c.parameterPositions[1]&&(this.stopFading(),0===d&&(this.enabled=!1))}}return this._effectiveWeight=b},_updateTimeScale:function(a){var b=0;if(!this.paused){b=this.timeScale;var c=this._timeScaleInterpolant;if(null!==c){var d=c.evaluate(a)[0];
b*=d;a>c.parameterPositions[1]&&(this.stopWarping(),0===b?this.paused=!0:this.timeScale=b)}}return this._effectiveTimeScale=b},_updateTime:function(a){var b=this.time+a,c=this._clip.duration,d=this.loop,e=this._loopCount,f=2202===d;if(0===a)return-1===e?b:f&&1===(e&1)?c-b:b;if(2200===d)a:{if(-1===e&&(this._loopCount=0,this._setEndings(!0,!0,!1)),b>=c)b=c;else if(0>b)b=0;else break a;this.clampWhenFinished?this.paused=!0:this.enabled=!1;this._mixer.dispatchEvent({type:"finished",action:this,direction:0>
a?-1:1})}else{-1===e&&(0<=a?(e=0,this._setEndings(!0,0===this.repetitions,f)):this._setEndings(0===this.repetitions,!0,f));if(b>=c||0>b){d=Math.floor(b/c);b-=c*d;e+=Math.abs(d);var g=this.repetitions-e;0>=g?(this.clampWhenFinished?this.paused=!0:this.enabled=!1,b=0<a?c:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<a?1:-1})):(1===g?(a=0>a,this._setEndings(a,!a,f)):this._setEndings(!1,!1,f),this._loopCount=e,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:d}))}if(f&&
1===(e&1))return this.time=b,c-b}return this.time=b},_setEndings:function(a,b,c){var d=this._interpolantSettings;c?(d.endingStart=2401,d.endingEnd=2401):(d.endingStart=a?this.zeroSlopeAtStart?2401:2400:2402,d.endingEnd=b?this.zeroSlopeAtEnd?2401:2400:2402)},_scheduleFading:function(a,b,c){var d=this._mixer,e=d.time,f=this._weightInterpolant;null===f&&(this._weightInterpolant=f=d._lendControlInterpolant());d=f.parameterPositions;f=f.sampleValues;d[0]=e;f[0]=b;d[1]=e+a;f[1]=c;return this}});Be.prototype=
Object.assign(Object.create(ta.prototype),{constructor:Be,_bindAction:function(a,b){var c=a._localRoot||this._root,d=a._clip.tracks,e=d.length,f=a._propertyBindings;a=a._interpolants;var g=c.uuid,h=this._bindingsByRootAndName,k=h[g];void 0===k&&(k={},h[g]=k);for(h=0;h!==e;++h){var l=d[h],n=l.name,q=k[n];if(void 0===q){q=f[h];if(void 0!==q){null===q._cacheIndex&&(++q.referenceCount,this._addInactiveBinding(q,g,n));continue}q=new Ae(ma.create(c,n,b&&b._propertyBindings[h].binding.parsedPath),l.ValueTypeName,
l.getValueSize());++q.referenceCount;this._addInactiveBinding(q,g,n)}f[h]=q;a[h].resultBuffer=q.buffer}},_activateAction:function(a){if(!this._isActiveAction(a)){if(null===a._cacheIndex){var b=(a._localRoot||this._root).uuid,c=a._clip.uuid,d=this._actionsByClip[c];this._bindAction(a,d&&d.knownActions[0]);this._addInactiveAction(a,c,b)}b=a._propertyBindings;c=0;for(d=b.length;c!==d;++c){var e=b[c];0===e.useCount++&&(this._lendBinding(e),e.saveOriginalState())}this._lendAction(a)}},_deactivateAction:function(a){if(this._isActiveAction(a)){for(var b=
a._propertyBindings,c=0,d=b.length;c!==d;++c){var e=b[c];0===--e.useCount&&(e.restoreOriginalState(),this._takeBackBinding(e))}this._takeBackAction(a)}},_initMemoryManager:function(){this._actions=[];this._nActiveActions=0;this._actionsByClip={};this._bindings=[];this._nActiveBindings=0;this._bindingsByRootAndName={};this._controlInterpolants=[];this._nActiveControlInterpolants=0;var a=this;this.stats={actions:{get total(){return a._actions.length},get inUse(){return a._nActiveActions}},bindings:{get total(){return a._bindings.length},
get inUse(){return a._nActiveBindings}},controlInterpolants:{get total(){return a._controlInterpolants.length},get inUse(){return a._nActiveControlInterpolants}}}},_isActiveAction:function(a){a=a._cacheIndex;return null!==a&&a<this._nActiveActions},_addInactiveAction:function(a,b,c){var d=this._actions,e=this._actionsByClip,f=e[b];void 0===f?(f={knownActions:[a],actionByRoot:{}},a._byClipCacheIndex=0,e[b]=f):(b=f.knownActions,a._byClipCacheIndex=b.length,b.push(a));a._cacheIndex=d.length;d.push(a);
f.actionByRoot[c]=a},_removeInactiveAction:function(a){var b=this._actions,c=b[b.length-1],d=a._cacheIndex;c._cacheIndex=d;b[d]=c;b.pop();a._cacheIndex=null;b=a._clip.uuid;c=this._actionsByClip;d=c[b];var e=d.knownActions,f=e[e.length-1],g=a._byClipCacheIndex;f._byClipCacheIndex=g;e[g]=f;e.pop();a._byClipCacheIndex=null;delete d.actionByRoot[(a._localRoot||this._root).uuid];0===e.length&&delete c[b];this._removeInactiveBindingsForAction(a)},_removeInactiveBindingsForAction:function(a){a=a._propertyBindings;
for(var b=0,c=a.length;b!==c;++b){var d=a[b];0===--d.referenceCount&&this._removeInactiveBinding(d)}},_lendAction:function(a){var b=this._actions,c=a._cacheIndex,d=this._nActiveActions++,e=b[d];a._cacheIndex=d;b[d]=a;e._cacheIndex=c;b[c]=e},_takeBackAction:function(a){var b=this._actions,c=a._cacheIndex,d=--this._nActiveActions,e=b[d];a._cacheIndex=d;b[d]=a;e._cacheIndex=c;b[c]=e},_addInactiveBinding:function(a,b,c){var d=this._bindingsByRootAndName,e=d[b],f=this._bindings;void 0===e&&(e={},d[b]=
e);e[c]=a;a._cacheIndex=f.length;f.push(a)},_removeInactiveBinding:function(a){var b=this._bindings,c=a.binding,d=c.rootNode.uuid;c=c.path;var e=this._bindingsByRootAndName,f=e[d],g=b[b.length-1];a=a._cacheIndex;g._cacheIndex=a;b[a]=g;b.pop();delete f[c];a:{for(var h in f)break a;delete e[d]}},_lendBinding:function(a){var b=this._bindings,c=a._cacheIndex,d=this._nActiveBindings++,e=b[d];a._cacheIndex=d;b[d]=a;e._cacheIndex=c;b[c]=e},_takeBackBinding:function(a){var b=this._bindings,c=a._cacheIndex,
d=--this._nActiveBindings,e=b[d];a._cacheIndex=d;b[d]=a;e._cacheIndex=c;b[c]=e},_lendControlInterpolant:function(){var a=this._controlInterpolants,b=this._nActiveControlInterpolants++,c=a[b];void 0===c&&(c=new gd(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),c.__cacheIndex=b,a[b]=c);return c},_takeBackControlInterpolant:function(a){var b=this._controlInterpolants,c=a.__cacheIndex,d=--this._nActiveControlInterpolants,e=b[d];a.__cacheIndex=d;b[d]=a;e.__cacheIndex=
c;b[c]=e},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(a,b){var c=b||this._root,d=c.uuid;c="string"===typeof a?Ia.findByName(c,a):a;a=null!==c?c.uuid:a;var e=this._actionsByClip[a],f=null;if(void 0!==e){f=e.actionByRoot[d];if(void 0!==f)return f;f=e.knownActions[0];null===c&&(c=f._clip)}if(null===c)return null;b=new Kf(this,c,b);this._bindAction(b,f);this._addInactiveAction(b,a,d);return b},existingAction:function(a,b){var c=b||this._root;b=c.uuid;c="string"===typeof a?
Ia.findByName(c,a):a;a=this._actionsByClip[c?c.uuid:a];return void 0!==a?a.actionByRoot[b]||null:null},stopAllAction:function(){for(var a=this._actions,b=this._nActiveActions,c=this._bindings,d=this._nActiveBindings,e=this._nActiveBindings=this._nActiveActions=0;e!==b;++e)a[e].reset();for(e=0;e!==d;++e)c[e].useCount=0;return this},update:function(a){a*=this.timeScale;for(var b=this._actions,c=this._nActiveActions,d=this.time+=a,e=Math.sign(a),f=this._accuIndex^=1,g=0;g!==c;++g)b[g]._update(d,a,e,
f);a=this._bindings;b=this._nActiveBindings;for(g=0;g!==b;++g)a[g].apply(f);return this},getRoot:function(){return this._root},uncacheClip:function(a){var b=this._actions;a=a.uuid;var c=this._actionsByClip,d=c[a];if(void 0!==d){d=d.knownActions;for(var e=0,f=d.length;e!==f;++e){var g=d[e];this._deactivateAction(g);var h=g._cacheIndex,k=b[b.length-1];g._cacheIndex=null;g._byClipCacheIndex=null;k._cacheIndex=h;b[h]=k;b.pop();this._removeInactiveBindingsForAction(g)}delete c[a]}},uncacheRoot:function(a){a=
a.uuid;var b=this._actionsByClip;for(d in b){var c=b[d].actionByRoot[a];void 0!==c&&(this._deactivateAction(c),this._removeInactiveAction(c))}var d=this._bindingsByRootAndName[a];if(void 0!==d)for(var e in d)a=d[e],a.restoreOriginalState(),this._removeInactiveBinding(a)},uncacheAction:function(a,b){a=this.existingAction(a,b);null!==a&&(this._deactivateAction(a),this._removeInactiveAction(a))}});Ud.prototype.clone=function(){return new Ud(void 0===this.value.clone?this.value:this.value.clone())};Ce.prototype=
Object.assign(Object.create(z.prototype),{constructor:Ce,isInstancedBufferGeometry:!0,copy:function(a){z.prototype.copy.call(this,a);this.maxInstancedCount=a.maxInstancedCount;return this},clone:function(){return(new this.constructor).copy(this)}});De.prototype=Object.assign(Object.create(xb.prototype),{constructor:De,isInstancedInterleavedBuffer:!0,copy:function(a){xb.prototype.copy.call(this,a);this.meshPerAttribute=a.meshPerAttribute;return this}});Ee.prototype=Object.assign(Object.create(S.prototype),
{constructor:Ee,isInstancedBufferAttribute:!0,copy:function(a){S.prototype.copy.call(this,a);this.meshPerAttribute=a.meshPerAttribute;return this}});Object.assign(Lf.prototype,{linePrecision:1,set:function(a,b){this.ray.set(a,b)},setFromCamera:function(a,b){b&&b.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(b.matrixWorld),this.ray.direction.set(a.x,a.y,.5).unproject(b).sub(this.ray.origin).normalize()):b&&b.isOrthographicCamera?(this.ray.origin.set(a.x,a.y,(b.near+b.far)/(b.near-b.far)).unproject(b),
this.ray.direction.set(0,0,-1).transformDirection(b.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(a,b,c){c=c||[];Fe(a,this,c,b);c.sort(Mf);return c},intersectObjects:function(a,b,c){c=c||[];if(!1===Array.isArray(a))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),c;for(var d=0,e=a.length;d<e;d++)Fe(a[d],this,c,b);c.sort(Mf);return c}});Object.assign(Nf.prototype,{set:function(a,b,c){this.radius=a;this.phi=b;this.theta=
c;return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.radius=a.radius;this.phi=a.phi;this.theta=a.theta;return this},makeSafe:function(){this.phi=Math.max(1E-6,Math.min(Math.PI-1E-6,this.phi));return this},setFromVector3:function(a){return this.setFromCartesianCoords(a.x,a.y,a.z)},setFromCartesianCoords:function(a,b,c){this.radius=Math.sqrt(a*a+b*b+c*c);0===this.radius?this.phi=this.theta=0:(this.theta=Math.atan2(a,c),this.phi=Math.acos(K.clamp(b/this.radius,
-1,1)));return this}});Object.assign(Of.prototype,{set:function(a,b,c){this.radius=a;this.theta=b;this.y=c;return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.radius=a.radius;this.theta=a.theta;this.y=a.y;return this},setFromVector3:function(a){return this.setFromCartesianCoords(a.x,a.y,a.z)},setFromCartesianCoords:function(a,b,c){this.radius=Math.sqrt(a*a+c*c);this.theta=Math.atan2(a,c);this.y=b;return this}});Object.assign(Ge.prototype,{set:function(a,b){this.min.copy(a);
this.max.copy(b);return this},setFromPoints:function(a){this.makeEmpty();for(var b=0,c=a.length;b<c;b++)this.expandByPoint(a[b]);return this},setFromCenterAndSize:function(){var a=new B;return function(b,c){c=a.copy(c).multiplyScalar(.5);this.min.copy(b).sub(c);this.max.copy(b).add(c);return this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.min.copy(a.min);this.max.copy(a.max);return this},makeEmpty:function(){this.min.x=this.min.y=Infinity;this.max.x=this.max.y=
-Infinity;return this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(a){void 0===a&&(console.warn("THREE.Box2: .getCenter() target is now required"),a=new B);return this.isEmpty()?a.set(0,0):a.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(a){void 0===a&&(console.warn("THREE.Box2: .getSize() target is now required"),a=new B);return this.isEmpty()?a.set(0,0):a.subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);this.max.max(a);
return this},expandByVector:function(a){this.min.sub(a);this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);this.max.addScalar(a);return this},containsPoint:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y},getParameter:function(a,b){void 0===b&&(console.warn("THREE.Box2: .getParameter() target is now required"),b=new B);
return b.set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y?!1:!0},clampPoint:function(a,b){void 0===b&&(console.warn("THREE.Box2: .clampPoint() target is now required"),b=new B);return b.copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new B;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),intersect:function(a){this.min.max(a.min);
this.max.min(a.max);return this},union:function(a){this.min.min(a.min);this.max.max(a.max);return this},translate:function(a){this.min.add(a);this.max.add(a);return this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)}});Object.assign(He.prototype,{set:function(a,b){this.start.copy(a);this.end.copy(b);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.start.copy(a.start);this.end.copy(a.end);return this},getCenter:function(a){void 0===
a&&(console.warn("THREE.Line3: .getCenter() target is now required"),a=new n);return a.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(a){void 0===a&&(console.warn("THREE.Line3: .delta() target is now required"),a=new n);return a.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(a,b){void 0===b&&(console.warn("THREE.Line3: .at() target is now required"),b=
new n);return this.delta(b).multiplyScalar(a).add(this.start)},closestPointToPointParameter:function(){var a=new n,b=new n;return function(c,d){a.subVectors(c,this.start);b.subVectors(this.end,this.start);c=b.dot(b);c=b.dot(a)/c;d&&(c=K.clamp(c,0,1));return c}}(),closestPointToPoint:function(a,b,c){a=this.closestPointToPointParameter(a,b);void 0===c&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),c=new n);return this.delta(c).multiplyScalar(a).add(this.start)},applyMatrix4:function(a){this.start.applyMatrix4(a);
this.end.applyMatrix4(a);return this},equals:function(a){return a.start.equals(this.start)&&a.end.equals(this.end)}});od.prototype=Object.create(C.prototype);od.prototype.constructor=od;od.prototype.isImmediateRenderObject=!0;pd.prototype=Object.create(V.prototype);pd.prototype.constructor=pd;pd.prototype.update=function(){var a=new n,b=new n,c=new ba;return function(){var d=["a","b","c"];this.object.updateMatrixWorld(!0);c.getNormalMatrix(this.object.matrixWorld);var e=this.object.matrixWorld,f=
this.geometry.attributes.position,g=this.object.geometry;if(g&&g.isGeometry)for(var h=g.vertices,k=g.faces,l=g=0,n=k.length;l<n;l++)for(var q=k[l],v=0,t=q.vertexNormals.length;v<t;v++){var r=q.vertexNormals[v];a.copy(h[q[d[v]]]).applyMatrix4(e);b.copy(r).applyMatrix3(c).normalize().multiplyScalar(this.size).add(a);f.setXYZ(g,a.x,a.y,a.z);g+=1;f.setXYZ(g,b.x,b.y,b.z);g+=1}else if(g&&g.isBufferGeometry)for(d=g.attributes.position,h=g.attributes.normal,v=g=0,t=d.count;v<t;v++)a.set(d.getX(v),d.getY(v),
d.getZ(v)).applyMatrix4(e),b.set(h.getX(v),h.getY(v),h.getZ(v)),b.applyMatrix3(c).normalize().multiplyScalar(this.size).add(a),f.setXYZ(g,a.x,a.y,a.z),g+=1,f.setXYZ(g,b.x,b.y,b.z),g+=1;f.needsUpdate=!0}}();pc.prototype=Object.create(C.prototype);pc.prototype.constructor=pc;pc.prototype.dispose=function(){this.cone.geometry.dispose();this.cone.material.dispose()};pc.prototype.update=function(){var a=new n;return function(){this.light.updateMatrixWorld();var b=this.light.distance?this.light.distance:
1E3,c=b*Math.tan(this.light.angle);this.cone.scale.set(c,c,b);a.setFromMatrixPosition(this.light.target.matrixWorld);this.cone.lookAt(a);void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}();qc.prototype=Object.create(V.prototype);qc.prototype.constructor=qc;qc.prototype.updateMatrixWorld=function(){var a=new n,b=new P,c=new P;return function(d){var e=this.bones,f=this.geometry,g=f.getAttribute("position");c.getInverse(this.root.matrixWorld);
for(var h=0,k=0;h<e.length;h++){var l=e[h];l.parent&&l.parent.isBone&&(b.multiplyMatrices(c,l.matrixWorld),a.setFromMatrixPosition(b),g.setXYZ(k,a.x,a.y,a.z),b.multiplyMatrices(c,l.parent.matrixWorld),a.setFromMatrixPosition(b),g.setXYZ(k+1,a.x,a.y,a.z),k+=2)}f.getAttribute("position").needsUpdate=!0;C.prototype.updateMatrixWorld.call(this,d)}}();rc.prototype=Object.create(va.prototype);rc.prototype.constructor=rc;rc.prototype.dispose=function(){this.geometry.dispose();this.material.dispose()};rc.prototype.update=
function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)};sc.prototype=Object.create(oa.prototype);sc.prototype.constructor=sc;sc.prototype.update=function(){this.scale.set(.5*this.light.width,.5*this.light.height,1);if(void 0!==this.color)this.material.color.set(this.color),this.children[0].material.color.set(this.color);else{this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);var a=this.material.color,b=Math.max(a.r,
a.g,a.b);1<b&&a.multiplyScalar(1/b);this.children[0].material.color.copy(this.material.color)}};sc.prototype.dispose=function(){this.geometry.dispose();this.material.dispose();this.children[0].geometry.dispose();this.children[0].material.dispose()};tc.prototype=Object.create(C.prototype);tc.prototype.constructor=tc;tc.prototype.dispose=function(){this.children[0].geometry.dispose();this.children[0].material.dispose()};tc.prototype.update=function(){var a=new n,b=new M,c=new M;return function(){var d=
this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var e=d.geometry.getAttribute("color");b.copy(this.light.color);c.copy(this.light.groundColor);for(var f=0,g=e.count;f<g;f++){var h=f<g/2?b:c;e.setXYZ(f,h.r,h.g,h.b)}e.needsUpdate=!0}d.lookAt(a.setFromMatrixPosition(this.light.matrixWorld).negate())}}();Vd.prototype=Object.assign(Object.create(V.prototype),{constructor:Vd,copy:function(a){V.prototype.copy.call(this,a);this.geometry.copy(a.geometry);this.material.copy(a.material);
return this},clone:function(){return(new this.constructor).copy(this)}});Wd.prototype=Object.create(V.prototype);Wd.prototype.constructor=Wd;uc.prototype=Object.create(oa.prototype);uc.prototype.constructor=uc;uc.prototype.update=function(){function a(a,b,d,e){d=(b-a)/d;t.setXYZ(k,0,0,0);l++;for(n=a;n<b;n+=d)q=k+l,t.setXYZ(q,Math.sin(n)*c,0,Math.cos(n)*c),t.setXYZ(q+1,Math.sin(Math.min(n+d,b))*c,0,Math.cos(Math.min(n+d,b))*c),t.setXYZ(q+2,0,0,0),l+=3;v.addGroup(k,l,e);k+=l;l=0}var b=this.audio,c=
this.range,d=this.divisionsInnerAngle,e=this.divisionsOuterAngle,f=K.degToRad(b.panner.coneInnerAngle);b=K.degToRad(b.panner.coneOuterAngle);var g=f/2,h=b/2,k=0,l=0,n,q,v=this.geometry,t=v.attributes.position;v.clearGroups();a(-h,-g,e,0);a(-g,g,d,1);a(g,h,e,0);t.needsUpdate=!0;f===b&&(this.material[0].visible=!1)};uc.prototype.dispose=function(){this.geometry.dispose();this.material[0].dispose();this.material[1].dispose()};qd.prototype=Object.create(V.prototype);qd.prototype.constructor=qd;qd.prototype.update=
function(){var a=new n,b=new n,c=new ba;return function(){this.object.updateMatrixWorld(!0);c.getNormalMatrix(this.object.matrixWorld);var d=this.object.matrixWorld,e=this.geometry.attributes.position,f=this.object.geometry,g=f.vertices;f=f.faces;for(var h=0,k=0,l=f.length;k<l;k++){var n=f[k],q=n.normal;a.copy(g[n.a]).add(g[n.b]).add(g[n.c]).divideScalar(3).applyMatrix4(d);b.copy(q).applyMatrix3(c).normalize().multiplyScalar(this.size).add(a);e.setXYZ(h,a.x,a.y,a.z);h+=1;e.setXYZ(h,b.x,b.y,b.z);h+=
1}e.needsUpdate=!0}}();vc.prototype=Object.create(C.prototype);vc.prototype.constructor=vc;vc.prototype.dispose=function(){this.lightPlane.geometry.dispose();this.lightPlane.material.dispose();this.targetLine.geometry.dispose();this.targetLine.material.dispose()};vc.prototype.update=function(){var a=new n,b=new n,c=new n;return function(){a.setFromMatrixPosition(this.light.matrixWorld);b.setFromMatrixPosition(this.light.target.matrixWorld);c.subVectors(b,a);this.lightPlane.lookAt(b);void 0!==this.color?
(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color));this.targetLine.lookAt(b);this.targetLine.scale.z=c.length()}}();rd.prototype=Object.create(V.prototype);rd.prototype.constructor=rd;rd.prototype.update=function(){function a(a,g,h,k){d.set(g,h,k).unproject(e);a=c[a];if(void 0!==a)for(g=b.getAttribute("position"),h=0,k=a.length;h<k;h++)g.setXYZ(a[h],
d.x,d.y,d.z)}var b,c,d=new n,e=new Xa;return function(){b=this.geometry;c=this.pointMap;e.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse);a("c",0,0,-1);a("t",0,0,1);a("n1",-1,-1,-1);a("n2",1,-1,-1);a("n3",-1,1,-1);a("n4",1,1,-1);a("f1",-1,-1,1);a("f2",1,-1,1);a("f3",-1,1,1);a("f4",1,1,1);a("u1",.7,1.1,-1);a("u2",-.7,1.1,-1);a("u3",0,2,-1);a("cf1",-1,0,1);a("cf2",1,0,1);a("cf3",0,-1,1);a("cf4",0,1,1);a("cn1",-1,0,-1);a("cn2",1,0,-1);a("cn3",0,-1,-1);a("cn4",0,1,-1);b.getAttribute("position").needsUpdate=
!0}}();fb.prototype=Object.create(V.prototype);fb.prototype.constructor=fb;fb.prototype.update=function(){var a=new Ja;return function(b){void 0!==b&&console.warn("THREE.BoxHelper: .update() has no longer arguments.");void 0!==this.object&&a.setFromObject(this.object);if(!a.isEmpty()){b=a.min;var c=a.max,d=this.geometry.attributes.position,e=d.array;e[0]=c.x;e[1]=c.y;e[2]=c.z;e[3]=b.x;e[4]=c.y;e[5]=c.z;e[6]=b.x;e[7]=b.y;e[8]=c.z;e[9]=c.x;e[10]=b.y;e[11]=c.z;e[12]=c.x;e[13]=c.y;e[14]=b.z;e[15]=b.x;
e[16]=c.y;e[17]=b.z;e[18]=b.x;e[19]=b.y;e[20]=b.z;e[21]=c.x;e[22]=b.y;e[23]=b.z;d.needsUpdate=!0;this.geometry.computeBoundingSphere()}}}();fb.prototype.setFromObject=function(a){this.object=a;this.update();return this};fb.prototype.copy=function(a){V.prototype.copy.call(this,a);this.object=a.object;return this};fb.prototype.clone=function(){return(new this.constructor).copy(this)};sd.prototype=Object.create(V.prototype);sd.prototype.constructor=sd;sd.prototype.updateMatrixWorld=function(a){var b=
this.box;b.isEmpty()||(b.getCenter(this.position),b.getSize(this.scale),this.scale.multiplyScalar(.5),C.prototype.updateMatrixWorld.call(this,a))};td.prototype=Object.create(oa.prototype);td.prototype.constructor=td;td.prototype.updateMatrixWorld=function(a){var b=-this.plane.constant;1E-8>Math.abs(b)&&(b=1E-8);this.scale.set(.5*this.size,.5*this.size,b);this.children[0].material.side=0>b?1:0;this.lookAt(this.plane.normal);C.prototype.updateMatrixWorld.call(this,a)};var Xd,Ie;gb.prototype=Object.create(C.prototype);
gb.prototype.constructor=gb;gb.prototype.setDirection=function(){var a=new n,b;return function(c){.99999<c.y?this.quaternion.set(0,0,0,1):-.99999>c.y?this.quaternion.set(1,0,0,0):(a.set(c.z,0,-c.x).normalize(),b=Math.acos(c.y),this.quaternion.setFromAxisAngle(a,b))}}();gb.prototype.setLength=function(a,b,c){void 0===b&&(b=.2*a);void 0===c&&(c=.2*b);this.line.scale.set(1,Math.max(0,a-b),1);this.line.updateMatrix();this.cone.scale.set(c,b,c);this.cone.position.y=a;this.cone.updateMatrix()};gb.prototype.setColor=
function(a){this.line.material.color.copy(a);this.cone.material.color.copy(a)};gb.prototype.copy=function(a){C.prototype.copy.call(this,a,!1);this.line.copy(a.line);this.cone.copy(a.cone);return this};gb.prototype.clone=function(){return(new this.constructor).copy(this)};ud.prototype=Object.create(V.prototype);ud.prototype.constructor=ud;I.create=function(a,b){console.log("THREE.Curve.create() has been deprecated");a.prototype=Object.create(I.prototype);a.prototype.constructor=a;a.prototype.getPoint=
b;return a};Object.assign(eb.prototype,{createPointsGeometry:function(a){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");a=this.getPoints(a);return this.createGeometry(a)},createSpacedPointsGeometry:function(a){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");a=this.getSpacedPoints(a);return this.createGeometry(a)},createGeometry:function(a){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");
for(var b=new N,c=0,d=a.length;c<d;c++){var e=a[c];b.vertices.push(new n(e.x,e.y,e.z||0))}return b}});Object.assign(Ra.prototype,{fromPoints:function(a){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints().");this.setFromPoints(a)}});Qf.prototype=Object.create(qa.prototype);Rf.prototype=Object.create(qa.prototype);Je.prototype=Object.create(qa.prototype);Object.assign(Je.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},
getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}});Vd.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")};qc.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")};Object.assign(md.prototype,
{extractUrlBase:function(a){console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead.");return Oe.extractUrlBase(a)}});Object.assign(qe.prototype,{setTexturePath:function(a){console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath().");return this.setResourcePath(a)}});Object.assign(Ge.prototype,{center:function(a){console.warn("THREE.Box2: .center() has been renamed to .getCenter().");return this.getCenter(a)},
empty:function(){console.warn("THREE.Box2: .empty() has been renamed to .isEmpty().");return this.isEmpty()},isIntersectionBox:function(a){console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox().");return this.intersectsBox(a)},size:function(a){console.warn("THREE.Box2: .size() has been renamed to .getSize().");return this.getSize(a)}});Object.assign(Ja.prototype,{center:function(a){console.warn("THREE.Box3: .center() has been renamed to .getCenter().");return this.getCenter(a)},
empty:function(){console.warn("THREE.Box3: .empty() has been renamed to .isEmpty().");return this.isEmpty()},isIntersectionBox:function(a){console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox().");return this.intersectsBox(a)},isIntersectionSphere:function(a){console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere().");return this.intersectsSphere(a)},size:function(a){console.warn("THREE.Box3: .size() has been renamed to .getSize().");return this.getSize(a)}});
He.prototype.center=function(a){console.warn("THREE.Line3: .center() has been renamed to .getCenter().");return this.getCenter(a)};Object.assign(K,{random16:function(){console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead.");return Math.random()},nearestPowerOfTwo:function(a){console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo().");return K.floorPowerOfTwo(a)},nextPowerOfTwo:function(a){console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo().");
return K.ceilPowerOfTwo(a)}});Object.assign(ba.prototype,{flattenToArrayOffset:function(a,b){console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.");return this.toArray(a,b)},multiplyVector3:function(a){console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.");return a.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(a){console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead.");
return this.applyToBufferAttribute(a)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}});Object.assign(P.prototype,{extractPosition:function(a){console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().");return this.copyPosition(a)},flattenToArrayOffset:function(a,b){console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.");return this.toArray(a,b)},getPosition:function(){var a;
return function(){void 0===a&&(a=new n);console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");return a.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(a){console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().");return this.makeRotationFromQuaternion(a)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(a){console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead.");
return a.applyMatrix4(this)},multiplyVector4:function(a){console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.");return a.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(a){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.");a.transformDirection(this)},crossVector:function(a){console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.");
return a.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(a){console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead.");
return this.applyToBufferAttribute(a)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(a,b,c,d,e,f){console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead.");return this.makePerspective(a,b,d,c,e,f)}});Va.prototype.isIntersectionLine=function(a){console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine().");return this.intersectsLine(a)};
aa.prototype.multiplyVector3=function(a){console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.");return a.applyQuaternion(this)};Object.assign(wb.prototype,{isIntersectionBox:function(a){console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox().");return this.intersectsBox(a)},isIntersectionPlane:function(a){console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane().");return this.intersectsPlane(a)},
isIntersectionSphere:function(a){console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere().");return this.intersectsSphere(a)}});Object.assign(ra.prototype,{area:function(){console.warn("THREE.Triangle: .area() has been renamed to .getArea().");return this.getArea()},barycoordFromPoint:function(a,b){console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord().");return this.getBarycoord(a,b)},midpoint:function(a){console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint().");
return this.getMidpoint(a)},normal:function(a){console.warn("THREE.Triangle: .normal() has been renamed to .getNormal().");return this.getNormal(a)},plane:function(a){console.warn("THREE.Triangle: .plane() has been renamed to .getPlane().");return this.getPlane(a)}});Object.assign(ra,{barycoordFromPoint:function(a,b,c,d,e){console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord().");return ra.getBarycoord(a,b,c,d,e)},normal:function(a,b,c,d){console.warn("THREE.Triangle: .normal() has been renamed to .getNormal().");
return ra.getNormal(a,b,c,d)}});Object.assign(nb.prototype,{extractAllPoints:function(a){console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead.");return this.extractPoints(a)},extrude:function(a){console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead.");return new Bb(this,a)},makeGeometry:function(a){console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead.");return new Db(this,a)}});Object.assign(B.prototype,
{fromAttribute:function(a,b,c){console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute().");return this.fromBufferAttribute(a,b,c)},distanceToManhattan:function(a){console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo().");return this.manhattanDistanceTo(a)},lengthManhattan:function(){console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength().");return this.manhattanLength()}});Object.assign(n.prototype,
{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(a){console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().");return this.setFromMatrixPosition(a)},getScaleFromMatrix:function(a){console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().");
return this.setFromMatrixScale(a)},getColumnFromMatrix:function(a,b){console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().");return this.setFromMatrixColumn(b,a)},applyProjection:function(a){console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead.");return this.applyMatrix4(a)},fromAttribute:function(a,b,c){console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute().");return this.fromBufferAttribute(a,
b,c)},distanceToManhattan:function(a){console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo().");return this.manhattanDistanceTo(a)},lengthManhattan:function(){console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength().");return this.manhattanLength()}});Object.assign(Y.prototype,{fromAttribute:function(a,b,c){console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute().");return this.fromBufferAttribute(a,
b,c)},lengthManhattan:function(){console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength().");return this.manhattanLength()}});Object.assign(N.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}});Object.assign(C.prototype,{getChildByName:function(a){console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().");
return this.getObjectByName(a)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(a,b){console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.");return this.translateOnAxis(b,a)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")}});Object.defineProperties(C.prototype,
{eulerOrder:{get:function(){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order.");return this.rotation.order},set:function(a){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order.");this.rotation.order=a}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}});
Object.defineProperties(Jc.prototype,{objects:{get:function(){console.warn("THREE.LOD: .objects has been renamed to .levels.");return this.levels}}});Object.defineProperty(Bd.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}});Kc.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")};Object.defineProperty(I.prototype,
"__arcLengthDivisions",{get:function(){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions.");return this.arcLengthDivisions},set:function(a){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions.");this.arcLengthDivisions=a}});ja.prototype.setLens=function(a,b){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup.");void 0!==b&&(this.filmGauge=b);this.setFocalLength(a)};Object.defineProperties(ea.prototype,
{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(a){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov.");this.shadow.camera.fov=a}},shadowCameraLeft:{set:function(a){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left.");this.shadow.camera.left=a}},shadowCameraRight:{set:function(a){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right.");this.shadow.camera.right=a}},shadowCameraTop:{set:function(a){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top.");
this.shadow.camera.top=a}},shadowCameraBottom:{set:function(a){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom.");this.shadow.camera.bottom=a}},shadowCameraNear:{set:function(a){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near.");this.shadow.camera.near=a}},shadowCameraFar:{set:function(a){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far.");this.shadow.camera.far=a}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},
shadowBias:{set:function(a){console.warn("THREE.Light: .shadowBias is now .shadow.bias.");this.shadow.bias=a}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(a){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width.");this.shadow.mapSize.width=a}},shadowMapHeight:{set:function(a){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height.");this.shadow.mapSize.height=a}}});Object.defineProperties(S.prototype,
{length:{get:function(){console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead.");return this.array.length}},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")}});Object.assign(z.prototype,{addIndex:function(a){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex().");this.setIndex(a)},addDrawCall:function(a,b,c){void 0!==c&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset.");
console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup().");this.addGroup(a,b)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups().");this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}});Object.defineProperties(z.prototype,{drawcalls:{get:function(){console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups.");
return this.groups}},offsets:{get:function(){console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups.");return this.groups}}});Object.assign(Ya.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}});Object.defineProperties(Ud.prototype,
{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead.");return this}}});Object.defineProperties(O.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},
set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){console.warn("THREE.Material: .wrapRGB has been removed.");return new M}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(a){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.");this.flatShading=1===a}}});Object.defineProperties(La.prototype,{metal:{get:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead.");
return!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}});Object.defineProperties(Ca.prototype,{derivatives:{get:function(){console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives.");return this.extensions.derivatives},set:function(a){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives.");this.extensions.derivatives=a}}});Object.assign(ge.prototype,
{clearTarget:function(a,b,c,d){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead.");this.setRenderTarget(a);this.clear(b,c,d)},animate:function(a){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop().");this.setAnimationLoop(a)},getCurrentRenderTarget:function(){console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget().");return this.getRenderTarget()},getMaxAnisotropy:function(){console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy().");
return this.capabilities.getMaxAnisotropy()},getPrecision:function(){console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision.");return this.capabilities.precision},resetGLState:function(){console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset().");return this.state.reset()},supportsFloatTextures:function(){console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' ).");return this.extensions.get("OES_texture_float")},
supportsHalfFloatTextures:function(){console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' ).");return this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' ).");return this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' ).");
return this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' ).");return this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' ).");return this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures.");
return this.capabilities.vertexTextures},supportsInstancedArrays:function(){console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' ).");return this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(a){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest().");this.setScissorTest(a)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},
addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},
setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")}});Object.defineProperties(ge.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(a){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled.");this.shadowMap.enabled=a}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(a){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type.");this.shadowMap.type=a}},
shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}}});Object.defineProperties(nf.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},
renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}});
Object.defineProperties(pb.prototype,{activeCubeFace:{set:function(){console.warn("THREE.WebGLRenderTargetCube: .activeCubeFace has been removed. It is now the second parameter of WebGLRenderer.setRenderTarget().")}},activeMipMapLevel:{set:function(){console.warn("THREE.WebGLRenderTargetCube: .activeMipMapLevel has been removed. It is now the third parameter of WebGLRenderer.setRenderTarget().")}}});Object.defineProperties(Ta.prototype,{wrapS:{get:function(){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.");
return this.texture.wrapS},set:function(a){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.");this.texture.wrapS=a}},wrapT:{get:function(){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.");return this.texture.wrapT},set:function(a){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.");this.texture.wrapT=a}},magFilter:{get:function(){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.");return this.texture.magFilter},
set:function(a){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.");this.texture.magFilter=a}},minFilter:{get:function(){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.");return this.texture.minFilter},set:function(a){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.");this.texture.minFilter=a}},anisotropy:{get:function(){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.");return this.texture.anisotropy},
set:function(a){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.");this.texture.anisotropy=a}},offset:{get:function(){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset.");return this.texture.offset},set:function(a){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset.");this.texture.offset=a}},repeat:{get:function(){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat.");return this.texture.repeat},set:function(a){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat.");
this.texture.repeat=a}},format:{get:function(){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format.");return this.texture.format},set:function(a){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format.");this.texture.format=a}},type:{get:function(){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type.");return this.texture.type},set:function(a){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type.");this.texture.type=a}},generateMipmaps:{get:function(){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.");
return this.texture.generateMipmaps},set:function(a){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.");this.texture.generateMipmaps=a}}});Object.defineProperties(tf.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}},userHeight:{set:function(){console.warn("THREE.WebVRManager: .userHeight has been removed.")}}});oc.prototype.load=function(a){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");
var b=this;(new ue).load(a,function(a){b.setBuffer(a)});return this};ze.prototype.getData=function(){console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData().");return this.getFrequencyData()};nd.prototype.updateCubeMap=function(a,b){console.warn("THREE.CubeCamera: .updateCubeMap() is now .update().");return this.update(a,b)};ob.crossOrigin=void 0;ob.loadTexture=function(a,b,c,d){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var e=
new Kd;e.setCrossOrigin(this.crossOrigin);a=e.load(a,c,void 0,d);b&&(a.mapping=b);return a};ob.loadTextureCube=function(a,b,c,d){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var e=new ne;e.setCrossOrigin(this.crossOrigin);a=e.load(a,c,void 0,d);b&&(a.mapping=b);return a};ob.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")};ob.loadCompressedTextureCube=
function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};l.WebGLMultisampleRenderTarget=$d;l.WebGLRenderTargetCube=pb;l.WebGLRenderTarget=Ta;l.WebGLRenderer=ge;l.ShaderLib=Wa;l.UniformsLib=G;l.UniformsUtils=kh;l.ShaderChunk=T;l.FogExp2=yd;l.Fog=zd;l.Scene=Ad;l.Sprite=Ic;l.LOD=Jc;l.SkinnedMesh=Kc;l.Skeleton=Bd;l.Bone=he;l.Mesh=va;l.LineSegments=V;l.LineLoop=Cd;l.Line=oa;l.Points=Xb;l.Group=Vb;l.VideoTexture=ie;l.DataTexture=qb;l.DataTexture2DArray=
Sb;l.DataTexture3D=Tb;l.CompressedTexture=Yb;l.CubeTexture=bb;l.CanvasTexture=Lc;l.DepthTexture=Mc;l.Texture=W;l.AnimationLoader=Df;l.CompressedTextureLoader=Ef;l.DataTextureLoader=me;l.CubeTextureLoader=ne;l.TextureLoader=Kd;l.ObjectLoader=qe;l.MaterialLoader=Td;l.BufferGeometryLoader=pe;l.DefaultLoadingManager=za;l.LoadingManager=le;l.ImageLoader=id;l.ImageBitmapLoader=re;l.FontLoader=Gf;l.FileLoader=Ma;l.Loader=md;l.LoaderUtils=Oe;l.Cache=Ob;l.AudioLoader=ue;l.SpotLightShadow=Md;l.SpotLight=Nd;
l.PointLight=Od;l.RectAreaLight=Sd;l.HemisphereLight=Ld;l.DirectionalLightShadow=Pd;l.DirectionalLight=Qd;l.AmbientLight=Rd;l.LightShadow=Nb;l.Light=ea;l.StereoCamera=Hf;l.PerspectiveCamera=ja;l.OrthographicCamera=ld;l.CubeCamera=nd;l.ArrayCamera=Gc;l.Camera=Xa;l.AudioListener=we;l.PositionalAudio=ye;l.AudioContext=xe;l.AudioAnalyser=ze;l.Audio=oc;l.VectorKeyframeTrack=mc;l.StringKeyframeTrack=Jd;l.QuaternionKeyframeTrack=hd;l.NumberKeyframeTrack=lc;l.ColorKeyframeTrack=Hd;l.BooleanKeyframeTrack=
Gd;l.PropertyMixer=Ae;l.PropertyBinding=ma;l.KeyframeTrack=la;l.AnimationUtils=pa;l.AnimationObjectGroup=Jf;l.AnimationMixer=Be;l.AnimationClip=Ia;l.Uniform=Ud;l.InstancedBufferGeometry=Ce;l.BufferGeometry=z;l.Geometry=N;l.InterleavedBufferAttribute=Hc;l.InstancedInterleavedBuffer=De;l.InterleavedBuffer=xb;l.InstancedBufferAttribute=Ee;l.Face3=Qb;l.Object3D=C;l.Raycaster=Lf;l.Layers=be;l.EventDispatcher=ta;l.Clock=ve;l.QuaternionLinearInterpolant=Id;l.LinearInterpolant=gd;l.DiscreteInterpolant=Fd;
l.CubicInterpolant=Ed;l.Interpolant=Fa;l.Triangle=ra;l.Math=K;l.Spherical=Nf;l.Cylindrical=Of;l.Plane=Va;l.Frustum=vd;l.Sphere=Ua;l.Ray=wb;l.Matrix4=P;l.Matrix3=ba;l.Box3=Ja;l.Box2=Ge;l.Line3=He;l.Euler=rb;l.Vector4=Y;l.Vector3=n;l.Vector2=B;l.Quaternion=aa;l.Color=M;l.ImmediateRenderObject=od;l.VertexNormalsHelper=pd;l.SpotLightHelper=pc;l.SkeletonHelper=qc;l.PointLightHelper=rc;l.RectAreaLightHelper=sc;l.HemisphereLightHelper=tc;l.GridHelper=Vd;l.PolarGridHelper=Wd;l.PositionalAudioHelper=uc;l.FaceNormalsHelper=
qd;l.DirectionalLightHelper=vc;l.CameraHelper=rd;l.BoxHelper=fb;l.Box3Helper=sd;l.PlaneHelper=td;l.ArrowHelper=gb;l.AxesHelper=ud;l.Shape=nb;l.Path=Ra;l.ShapePath=se;l.Font=te;l.CurvePath=eb;l.Curve=I;l.ImageUtils=ob;l.ShapeUtils=cb;l.WebGLUtils=pf;l.WireframeGeometry=Zb;l.ParametricGeometry=Nc;l.ParametricBufferGeometry=$b;l.TetrahedronGeometry=Pc;l.TetrahedronBufferGeometry=ac;l.OctahedronGeometry=Qc;l.OctahedronBufferGeometry=yb;l.IcosahedronGeometry=Rc;l.IcosahedronBufferGeometry=bc;l.DodecahedronGeometry=
Sc;l.DodecahedronBufferGeometry=cc;l.PolyhedronGeometry=Oc;l.PolyhedronBufferGeometry=ka;l.TubeGeometry=Tc;l.TubeBufferGeometry=zb;l.TorusKnotGeometry=Uc;l.TorusKnotBufferGeometry=dc;l.TorusGeometry=Vc;l.TorusBufferGeometry=ec;l.TextGeometry=$c;l.TextBufferGeometry=fc;l.SphereGeometry=ad;l.SphereBufferGeometry=Cb;l.RingGeometry=bd;l.RingBufferGeometry=gc;l.PlaneGeometry=Dc;l.PlaneBufferGeometry=vb;l.LatheGeometry=cd;l.LatheBufferGeometry=hc;l.ShapeGeometry=Db;l.ShapeBufferGeometry=Eb;l.ExtrudeGeometry=
Bb;l.ExtrudeBufferGeometry=Ya;l.EdgesGeometry=ic;l.ConeGeometry=dd;l.ConeBufferGeometry=ed;l.CylinderGeometry=Fb;l.CylinderBufferGeometry=db;l.CircleGeometry=fd;l.CircleBufferGeometry=jc;l.BoxGeometry=Rb;l.CubeGeometry=Rb;l.BoxBufferGeometry=ub;l.ShadowMaterial=Gb;l.SpriteMaterial=mb;l.RawShaderMaterial=kc;l.ShaderMaterial=Ca;l.PointsMaterial=Ka;l.MeshPhysicalMaterial=Hb;l.MeshStandardMaterial=Za;l.MeshPhongMaterial=La;l.MeshToonMaterial=Ib;l.MeshNormalMaterial=Jb;l.MeshLambertMaterial=Kb;l.MeshDepthMaterial=
ib;l.MeshDistanceMaterial=jb;l.MeshBasicMaterial=Da;l.MeshMatcapMaterial=Lb;l.LineDashedMaterial=Mb;l.LineBasicMaterial=R;l.Material=O;l.Float64BufferAttribute=Cc;l.Float32BufferAttribute=E;l.Uint32BufferAttribute=tb;l.Int32BufferAttribute=Bc;l.Uint16BufferAttribute=sb;l.Int16BufferAttribute=Ac;l.Uint8ClampedBufferAttribute=zc;l.Uint8BufferAttribute=yc;l.Int8BufferAttribute=xc;l.BufferAttribute=S;l.ArcCurve=nc;l.CatmullRomCurve3=qa;l.CubicBezierCurve=Na;l.CubicBezierCurve3=$a;l.EllipseCurve=Ga;l.LineCurve=
xa;l.LineCurve3=Oa;l.QuadraticBezierCurve=Pa;l.QuadraticBezierCurve3=ab;l.SplineCurve=Qa;l.REVISION="103";l.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2};l.CullFaceNone=0;l.CullFaceBack=1;l.CullFaceFront=2;l.CullFaceFrontBack=3;l.FrontFaceDirectionCW=0;l.FrontFaceDirectionCCW=1;l.BasicShadowMap=0;l.PCFShadowMap=1;l.PCFSoftShadowMap=2;l.FrontSide=0;l.BackSide=1;l.DoubleSide=2;l.FlatShading=1;l.SmoothShading=2;l.NoColors=0;l.FaceColors=1;l.VertexColors=2;l.NoBlending=0;l.NormalBlending=1;l.AdditiveBlending=2;l.SubtractiveBlending=
3;l.MultiplyBlending=4;l.CustomBlending=5;l.AddEquation=100;l.SubtractEquation=101;l.ReverseSubtractEquation=102;l.MinEquation=103;l.MaxEquation=104;l.ZeroFactor=200;l.OneFactor=201;l.SrcColorFactor=202;l.OneMinusSrcColorFactor=203;l.SrcAlphaFactor=204;l.OneMinusSrcAlphaFactor=205;l.DstAlphaFactor=206;l.OneMinusDstAlphaFactor=207;l.DstColorFactor=208;l.OneMinusDstColorFactor=209;l.SrcAlphaSaturateFactor=210;l.NeverDepth=0;l.AlwaysDepth=1;l.LessDepth=2;l.LessEqualDepth=3;l.EqualDepth=4;l.GreaterEqualDepth=
5;l.GreaterDepth=6;l.NotEqualDepth=7;l.MultiplyOperation=0;l.MixOperation=1;l.AddOperation=2;l.NoToneMapping=0;l.LinearToneMapping=1;l.ReinhardToneMapping=2;l.Uncharted2ToneMapping=3;l.CineonToneMapping=4;l.ACESFilmicToneMapping=5;l.UVMapping=300;l.CubeReflectionMapping=301;l.CubeRefractionMapping=302;l.EquirectangularReflectionMapping=303;l.EquirectangularRefractionMapping=304;l.SphericalReflectionMapping=305;l.CubeUVReflectionMapping=306;l.CubeUVRefractionMapping=307;l.RepeatWrapping=1E3;l.ClampToEdgeWrapping=
1001;l.MirroredRepeatWrapping=1002;l.NearestFilter=1003;l.NearestMipMapNearestFilter=1004;l.NearestMipMapLinearFilter=1005;l.LinearFilter=1006;l.LinearMipMapNearestFilter=1007;l.LinearMipMapLinearFilter=1008;l.UnsignedByteType=1009;l.ByteType=1010;l.ShortType=1011;l.UnsignedShortType=1012;l.IntType=1013;l.UnsignedIntType=1014;l.FloatType=1015;l.HalfFloatType=1016;l.UnsignedShort4444Type=1017;l.UnsignedShort5551Type=1018;l.UnsignedShort565Type=1019;l.UnsignedInt248Type=1020;l.AlphaFormat=1021;l.RGBFormat=
1022;l.RGBAFormat=1023;l.LuminanceFormat=1024;l.LuminanceAlphaFormat=1025;l.RGBEFormat=1023;l.DepthFormat=1026;l.DepthStencilFormat=1027;l.RedFormat=1028;l.RGB_S3TC_DXT1_Format=33776;l.RGBA_S3TC_DXT1_Format=33777;l.RGBA_S3TC_DXT3_Format=33778;l.RGBA_S3TC_DXT5_Format=33779;l.RGB_PVRTC_4BPPV1_Format=35840;l.RGB_PVRTC_2BPPV1_Format=35841;l.RGBA_PVRTC_4BPPV1_Format=35842;l.RGBA_PVRTC_2BPPV1_Format=35843;l.RGB_ETC1_Format=36196;l.RGBA_ASTC_4x4_Format=37808;l.RGBA_ASTC_5x4_Format=37809;l.RGBA_ASTC_5x5_Format=
37810;l.RGBA_ASTC_6x5_Format=37811;l.RGBA_ASTC_6x6_Format=37812;l.RGBA_ASTC_8x5_Format=37813;l.RGBA_ASTC_8x6_Format=37814;l.RGBA_ASTC_8x8_Format=37815;l.RGBA_ASTC_10x5_Format=37816;l.RGBA_ASTC_10x6_Format=37817;l.RGBA_ASTC_10x8_Format=37818;l.RGBA_ASTC_10x10_Format=37819;l.RGBA_ASTC_12x10_Format=37820;l.RGBA_ASTC_12x12_Format=37821;l.LoopOnce=2200;l.LoopRepeat=2201;l.LoopPingPong=2202;l.InterpolateDiscrete=2300;l.InterpolateLinear=2301;l.InterpolateSmooth=2302;l.ZeroCurvatureEnding=2400;l.ZeroSlopeEnding=
2401;l.WrapAroundEnding=2402;l.TrianglesDrawMode=0;l.TriangleStripDrawMode=1;l.TriangleFanDrawMode=2;l.LinearEncoding=3E3;l.sRGBEncoding=3001;l.GammaEncoding=3007;l.RGBEEncoding=3002;l.LogLuvEncoding=3003;l.RGBM7Encoding=3004;l.RGBM16Encoding=3005;l.RGBDEncoding=3006;l.BasicDepthPacking=3200;l.RGBADepthPacking=3201;l.TangentSpaceNormalMap=0;l.ObjectSpaceNormalMap=1;l.Face4=function(a,b,c,d,e,f,g){console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead.");return new Qb(a,
b,c,e,f,g)};l.LineStrip=0;l.LinePieces=1;l.MeshFaceMaterial=function(a){console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead.");return a};l.MultiMaterial=function(a){void 0===a&&(a=[]);console.warn("THREE.MultiMaterial has been removed. Use an Array instead.");a.isMultiMaterial=!0;a.materials=a;a.clone=function(){return a.slice()};return a};l.PointCloud=function(a,b){console.warn("THREE.PointCloud has been renamed to THREE.Points.");return new Xb(a,b)};l.Particle=function(a){console.warn("THREE.Particle has been renamed to THREE.Sprite.");
return new Ic(a)};l.ParticleSystem=function(a,b){console.warn("THREE.ParticleSystem has been renamed to THREE.Points.");return new Xb(a,b)};l.PointCloudMaterial=function(a){console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial.");return new Ka(a)};l.ParticleBasicMaterial=function(a){console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial.");return new Ka(a)};l.ParticleSystemMaterial=function(a){console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial.");
return new Ka(a)};l.Vertex=function(a,b,c){console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead.");return new n(a,b,c)};l.DynamicBufferAttribute=function(a,b){console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead.");return(new S(a,b)).setDynamic(!0)};l.Int8Attribute=function(a,b){console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead.");return new xc(a,b)};l.Uint8Attribute=
function(a,b){console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead.");return new yc(a,b)};l.Uint8ClampedAttribute=function(a,b){console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead.");return new zc(a,b)};l.Int16Attribute=function(a,b){console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead.");return new Ac(a,b)};l.Uint16Attribute=function(a,b){console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead.");
return new sb(a,b)};l.Int32Attribute=function(a,b){console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead.");return new Bc(a,b)};l.Uint32Attribute=function(a,b){console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead.");return new tb(a,b)};l.Float32Attribute=function(a,b){console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead.");return new E(a,b)};l.Float64Attribute=
function(a,b){console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead.");return new Cc(a,b)};l.ClosedSplineCurve3=Qf;l.SplineCurve3=Rf;l.Spline=Je;l.AxisHelper=function(a){console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper.");return new ud(a)};l.BoundingBoxHelper=function(a,b){console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead.");return new fb(a,b)};l.EdgesHelper=function(a,b){console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead.");
return new V(new ic(a.geometry),new R({color:void 0!==b?b:16777215}))};l.WireframeHelper=function(a,b){console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead.");return new V(new Zb(a.geometry),new R({color:void 0!==b?b:16777215}))};l.XHRLoader=function(a){console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader.");return new Ma(a)};l.BinaryTextureLoader=function(a){console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader.");return new me(a)};
l.GeometryUtils={merge:function(a,b,c){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");if(b.isMesh){b.matrixAutoUpdate&&b.updateMatrix();var d=b.matrix;b=b.geometry}a.merge(b,d,c)},center:function(a){console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead.");return a.center()}};l.Projector=function(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js.");
this.projectVector=function(a,b){console.warn("THREE.Projector: .projectVector() is now vector.project().");a.project(b)};this.unprojectVector=function(a,b){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject().");a.unproject(b)};this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}};l.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been removed")};l.JSONLoader=function(){console.error("THREE.JSONLoader has been removed.")};
l.SceneUtils={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")}};l.LensFlare=function(){console.error("THREE.LensFlare has been moved to /examples/js/objects/Lensflare.js")};Object.defineProperty(l,"__esModule",{value:!0})});

/**
 * @author alteredq / http://alteredqualia.com/
 *
 * Full-screen textured quad shader
 */

THREE.CopyShader = {

	uniforms: {

		"tDiffuse": { value: null },
		"opacity":  { value: 1.0 }

	},

	vertexShader: [

		"varying vec2 vUv;",

		"void main() {",

			"vUv = uv;",
			"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",

		"}"

	].join( "\n" ),

	fragmentShader: [

		"uniform float opacity;",

		"uniform sampler2D tDiffuse;",

		"varying vec2 vUv;",

		"void main() {",

			"vec4 texel = texture2D( tDiffuse, vUv );",
			"gl_FragColor = opacity * texel;",

		"}"

	].join( "\n" )

};

/**
 * @author alteredq / http://alteredqualia.com/
 * @author davidedc / http://www.sketchpatch.net/
 *
 * NVIDIA FXAA by Timothy Lottes
 * http://timothylottes.blogspot.com/2011/06/fxaa3-source-released.html
 * - WebGL port by @supereggbert
 * http://www.glge.org/demos/fxaa/
 */

THREE.FXAAShader = {

	uniforms: {

		"tDiffuse":   { value: null },
		"resolution": { value: new THREE.Vector2( 1 / 1024, 1 / 512 ) }

	},

	vertexShader: [

		"varying vec2 vUv;",

		"void main() {",

			"vUv = uv;",
			"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",

		"}"

	].join( "\n" ),

	fragmentShader: [
        "precision highp float;",
        "",
        "uniform sampler2D tDiffuse;",
        "",
        "uniform vec2 resolution;",
        "",
        "varying vec2 vUv;",
        "",
        "// FXAA 3.11 implementation by NVIDIA, ported to WebGL by Agost Biro (biro@archilogic.com)",
        "",
        "//----------------------------------------------------------------------------------",
        "// File:        es3-kepler\FXAA\assets\shaders/FXAA_DefaultES.frag",
        "// SDK Version: v3.00",
        "// Email:       gameworks@nvidia.com",
        "// Site:        http://developer.nvidia.com/",
        "//",
        "// Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.",
        "//",
        "// Redistribution and use in source and binary forms, with or without",
        "// modification, are permitted provided that the following conditions",
        "// are met:",
        "//  * Redistributions of source code must retain the above copyright",
        "//    notice, this list of conditions and the following disclaimer.",
        "//  * Redistributions in binary form must reproduce the above copyright",
        "//    notice, this list of conditions and the following disclaimer in the",
        "//    documentation and/or other materials provided with the distribution.",
        "//  * Neither the name of NVIDIA CORPORATION nor the names of its",
        "//    contributors may be used to endorse or promote products derived",
        "//    from this software without specific prior written permission.",
        "//",
        "// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY",
        "// EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE",
        "// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR",
        "// PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR",
        "// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,",
        "// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,",
        "// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR",
        "// PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY",
        "// OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT",
        "// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE",
        "// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.",
        "//",
        "//----------------------------------------------------------------------------------",
        "",
        "#define FXAA_PC 1",
        "#define FXAA_GLSL_100 1",
        "#define FXAA_QUALITY_PRESET 12",
        "",
        "#define FXAA_GREEN_AS_LUMA 1",
        "",
        "/*--------------------------------------------------------------------------*/",
        "#ifndef FXAA_PC_CONSOLE",
        "    //",
        "    // The console algorithm for PC is included",
        "    // for developers targeting really low spec machines.",
        "    // Likely better to just run FXAA_PC, and use a really low preset.",
        "    //",
        "    #define FXAA_PC_CONSOLE 0",
        "#endif",
        "/*--------------------------------------------------------------------------*/",
        "#ifndef FXAA_GLSL_120",
        "    #define FXAA_GLSL_120 0",
        "#endif",
        "/*--------------------------------------------------------------------------*/",
        "#ifndef FXAA_GLSL_130",
        "    #define FXAA_GLSL_130 0",
        "#endif",
        "/*--------------------------------------------------------------------------*/",
        "#ifndef FXAA_HLSL_3",
        "    #define FXAA_HLSL_3 0",
        "#endif",
        "/*--------------------------------------------------------------------------*/",
        "#ifndef FXAA_HLSL_4",
        "    #define FXAA_HLSL_4 0",
        "#endif",
        "/*--------------------------------------------------------------------------*/",
        "#ifndef FXAA_HLSL_5",
        "    #define FXAA_HLSL_5 0",
        "#endif",
        "/*==========================================================================*/",
        "#ifndef FXAA_GREEN_AS_LUMA",
        "    //",
        "    // For those using non-linear color,",
        "    // and either not able to get luma in alpha, or not wanting to,",
        "    // this enables FXAA to run using green as a proxy for luma.",
        "    // So with this enabled, no need to pack luma in alpha.",
        "    //",
        "    // This will turn off AA on anything which lacks some amount of green.",
        "    // Pure red and blue or combination of only R and B, will get no AA.",
        "    //",
        "    // Might want to lower the settings for both,",
        "    //    fxaaConsoleEdgeThresholdMin",
        "    //    fxaaQualityEdgeThresholdMin",
        "    // In order to insure AA does not get turned off on colors",
        "    // which contain a minor amount of green.",
        "    //",
        "    // 1 = On.",
        "    // 0 = Off.",
        "    //",
        "    #define FXAA_GREEN_AS_LUMA 0",
        "#endif",
        "/*--------------------------------------------------------------------------*/",
        "#ifndef FXAA_EARLY_EXIT",
        "    //",
        "    // Controls algorithm's early exit path.",
        "    // On PS3 turning this ON adds 2 cycles to the shader.",
        "    // On 360 turning this OFF adds 10ths of a millisecond to the shader.",
        "    // Turning this off on console will result in a more blurry image.",
        "    // So this defaults to on.",
        "    //",
        "    // 1 = On.",
        "    // 0 = Off.",
        "    //",
        "    #define FXAA_EARLY_EXIT 1",
        "#endif",
        "/*--------------------------------------------------------------------------*/",
        "#ifndef FXAA_DISCARD",
        "    //",
        "    // Only valid for PC OpenGL currently.",
        "    // Probably will not work when FXAA_GREEN_AS_LUMA = 1.",
        "    //",
        "    // 1 = Use discard on pixels which don't need AA.",
        "    //     For APIs which enable concurrent TEX+ROP from same surface.",
        "    // 0 = Return unchanged color on pixels which don't need AA.",
        "    //",
        "    #define FXAA_DISCARD 0",
        "#endif",
        "/*--------------------------------------------------------------------------*/",
        "#ifndef FXAA_FAST_PIXEL_OFFSET",
        "    //",
        "    // Used for GLSL 120 only.",
        "    //",
        "    // 1 = GL API supports fast pixel offsets",
        "    // 0 = do not use fast pixel offsets",
        "    //",
        "    #ifdef GL_EXT_gpu_shader4",
        "        #define FXAA_FAST_PIXEL_OFFSET 1",
        "    #endif",
        "    #ifdef GL_NV_gpu_shader5",
        "        #define FXAA_FAST_PIXEL_OFFSET 1",
        "    #endif",
        "    #ifdef GL_ARB_gpu_shader5",
        "        #define FXAA_FAST_PIXEL_OFFSET 1",
        "    #endif",
        "    #ifndef FXAA_FAST_PIXEL_OFFSET",
        "        #define FXAA_FAST_PIXEL_OFFSET 0",
        "    #endif",
        "#endif",
        "/*--------------------------------------------------------------------------*/",
        "#ifndef FXAA_GATHER4_ALPHA",
        "    //",
        "    // 1 = API supports gather4 on alpha channel.",
        "    // 0 = API does not support gather4 on alpha channel.",
        "    //",
        "    #if (FXAA_HLSL_5 == 1)",
        "        #define FXAA_GATHER4_ALPHA 1",
        "    #endif",
        "    #ifdef GL_ARB_gpu_shader5",
        "        #define FXAA_GATHER4_ALPHA 1",
        "    #endif",
        "    #ifdef GL_NV_gpu_shader5",
        "        #define FXAA_GATHER4_ALPHA 1",
        "    #endif",
        "    #ifndef FXAA_GATHER4_ALPHA",
        "        #define FXAA_GATHER4_ALPHA 0",
        "    #endif",
        "#endif",
        "",
        "",
        "/*============================================================================",
        "                        FXAA QUALITY - TUNING KNOBS",
        "------------------------------------------------------------------------------",
        "NOTE the other tuning knobs are now in the shader function inputs!",
        "============================================================================*/",
        "#ifndef FXAA_QUALITY_PRESET",
        "    //",
        "    // Choose the quality preset.",
        "    // This needs to be compiled into the shader as it effects code.",
        "    // Best option to include multiple presets is to",
        "    // in each shader define the preset, then include this file.",
        "    //",
        "    // OPTIONS",
        "    // -----------------------------------------------------------------------",
        "    // 10 to 15 - default medium dither (10=fastest, 15=highest quality)",
        "    // 20 to 29 - less dither, more expensive (20=fastest, 29=highest quality)",
        "    // 39       - no dither, very expensive",
        "    //",
        "    // NOTES",
        "    // -----------------------------------------------------------------------",
        "    // 12 = slightly faster then FXAA 3.9 and higher edge quality (default)",
        "    // 13 = about same speed as FXAA 3.9 and better than 12",
        "    // 23 = closest to FXAA 3.9 visually and performance wise",
        "    //  _ = the lowest digit is directly related to performance",
        "    // _  = the highest digit is directly related to style",
        "    //",
        "    #define FXAA_QUALITY_PRESET 12",
        "#endif",
        "",
        "",
        "/*============================================================================",
        "",
        "                           FXAA QUALITY - PRESETS",
        "",
        "============================================================================*/",
        "",
        "/*============================================================================",
        "                     FXAA QUALITY - MEDIUM DITHER PRESETS",
        "============================================================================*/",
        "#if (FXAA_QUALITY_PRESET == 10)",
        "    #define FXAA_QUALITY_PS 3",
        "    #define FXAA_QUALITY_P0 1.5",
        "    #define FXAA_QUALITY_P1 3.0",
        "    #define FXAA_QUALITY_P2 12.0",
        "#endif",
        "/*--------------------------------------------------------------------------*/",
        "#if (FXAA_QUALITY_PRESET == 11)",
        "    #define FXAA_QUALITY_PS 4",
        "    #define FXAA_QUALITY_P0 1.0",
        "    #define FXAA_QUALITY_P1 1.5",
        "    #define FXAA_QUALITY_P2 3.0",
        "    #define FXAA_QUALITY_P3 12.0",
        "#endif",
        "/*--------------------------------------------------------------------------*/",
        "#if (FXAA_QUALITY_PRESET == 12)",
        "    #define FXAA_QUALITY_PS 5",
        "    #define FXAA_QUALITY_P0 1.0",
        "    #define FXAA_QUALITY_P1 1.5",
        "    #define FXAA_QUALITY_P2 2.0",
        "    #define FXAA_QUALITY_P3 4.0",
        "    #define FXAA_QUALITY_P4 12.0",
        "#endif",
        "/*--------------------------------------------------------------------------*/",
        "#if (FXAA_QUALITY_PRESET == 13)",
        "    #define FXAA_QUALITY_PS 6",
        "    #define FXAA_QUALITY_P0 1.0",
        "    #define FXAA_QUALITY_P1 1.5",
        "    #define FXAA_QUALITY_P2 2.0",
        "    #define FXAA_QUALITY_P3 2.0",
        "    #define FXAA_QUALITY_P4 4.0",
        "    #define FXAA_QUALITY_P5 12.0",
        "#endif",
        "/*--------------------------------------------------------------------------*/",
        "#if (FXAA_QUALITY_PRESET == 14)",
        "    #define FXAA_QUALITY_PS 7",
        "    #define FXAA_QUALITY_P0 1.0",
        "    #define FXAA_QUALITY_P1 1.5",
        "    #define FXAA_QUALITY_P2 2.0",
        "    #define FXAA_QUALITY_P3 2.0",
        "    #define FXAA_QUALITY_P4 2.0",
        "    #define FXAA_QUALITY_P5 4.0",
        "    #define FXAA_QUALITY_P6 12.0",
        "#endif",
        "/*--------------------------------------------------------------------------*/",
        "#if (FXAA_QUALITY_PRESET == 15)",
        "    #define FXAA_QUALITY_PS 8",
        "    #define FXAA_QUALITY_P0 1.0",
        "    #define FXAA_QUALITY_P1 1.5",
        "    #define FXAA_QUALITY_P2 2.0",
        "    #define FXAA_QUALITY_P3 2.0",
        "    #define FXAA_QUALITY_P4 2.0",
        "    #define FXAA_QUALITY_P5 2.0",
        "    #define FXAA_QUALITY_P6 4.0",
        "    #define FXAA_QUALITY_P7 12.0",
        "#endif",
        "",
        "/*============================================================================",
        "                     FXAA QUALITY - LOW DITHER PRESETS",
        "============================================================================*/",
        "#if (FXAA_QUALITY_PRESET == 20)",
        "    #define FXAA_QUALITY_PS 3",
        "    #define FXAA_QUALITY_P0 1.5",
        "    #define FXAA_QUALITY_P1 2.0",
        "    #define FXAA_QUALITY_P2 8.0",
        "#endif",
        "/*--------------------------------------------------------------------------*/",
        "#if (FXAA_QUALITY_PRESET == 21)",
        "    #define FXAA_QUALITY_PS 4",
        "    #define FXAA_QUALITY_P0 1.0",
        "    #define FXAA_QUALITY_P1 1.5",
        "    #define FXAA_QUALITY_P2 2.0",
        "    #define FXAA_QUALITY_P3 8.0",
        "#endif",
        "/*--------------------------------------------------------------------------*/",
        "#if (FXAA_QUALITY_PRESET == 22)",
        "    #define FXAA_QUALITY_PS 5",
        "    #define FXAA_QUALITY_P0 1.0",
        "    #define FXAA_QUALITY_P1 1.5",
        "    #define FXAA_QUALITY_P2 2.0",
        "    #define FXAA_QUALITY_P3 2.0",
        "    #define FXAA_QUALITY_P4 8.0",
        "#endif",
        "/*--------------------------------------------------------------------------*/",
        "#if (FXAA_QUALITY_PRESET == 23)",
        "    #define FXAA_QUALITY_PS 6",
        "    #define FXAA_QUALITY_P0 1.0",
        "    #define FXAA_QUALITY_P1 1.5",
        "    #define FXAA_QUALITY_P2 2.0",
        "    #define FXAA_QUALITY_P3 2.0",
        "    #define FXAA_QUALITY_P4 2.0",
        "    #define FXAA_QUALITY_P5 8.0",
        "#endif",
        "/*--------------------------------------------------------------------------*/",
        "#if (FXAA_QUALITY_PRESET == 24)",
        "    #define FXAA_QUALITY_PS 7",
        "    #define FXAA_QUALITY_P0 1.0",
        "    #define FXAA_QUALITY_P1 1.5",
        "    #define FXAA_QUALITY_P2 2.0",
        "    #define FXAA_QUALITY_P3 2.0",
        "    #define FXAA_QUALITY_P4 2.0",
        "    #define FXAA_QUALITY_P5 3.0",
        "    #define FXAA_QUALITY_P6 8.0",
        "#endif",
        "/*--------------------------------------------------------------------------*/",
        "#if (FXAA_QUALITY_PRESET == 25)",
        "    #define FXAA_QUALITY_PS 8",
        "    #define FXAA_QUALITY_P0 1.0",
        "    #define FXAA_QUALITY_P1 1.5",
        "    #define FXAA_QUALITY_P2 2.0",
        "    #define FXAA_QUALITY_P3 2.0",
        "    #define FXAA_QUALITY_P4 2.0",
        "    #define FXAA_QUALITY_P5 2.0",
        "    #define FXAA_QUALITY_P6 4.0",
        "    #define FXAA_QUALITY_P7 8.0",
        "#endif",
        "/*--------------------------------------------------------------------------*/",
        "#if (FXAA_QUALITY_PRESET == 26)",
        "    #define FXAA_QUALITY_PS 9",
        "    #define FXAA_QUALITY_P0 1.0",
        "    #define FXAA_QUALITY_P1 1.5",
        "    #define FXAA_QUALITY_P2 2.0",
        "    #define FXAA_QUALITY_P3 2.0",
        "    #define FXAA_QUALITY_P4 2.0",
        "    #define FXAA_QUALITY_P5 2.0",
        "    #define FXAA_QUALITY_P6 2.0",
        "    #define FXAA_QUALITY_P7 4.0",
        "    #define FXAA_QUALITY_P8 8.0",
        "#endif",
        "/*--------------------------------------------------------------------------*/",
        "#if (FXAA_QUALITY_PRESET == 27)",
        "    #define FXAA_QUALITY_PS 10",
        "    #define FXAA_QUALITY_P0 1.0",
        "    #define FXAA_QUALITY_P1 1.5",
        "    #define FXAA_QUALITY_P2 2.0",
        "    #define FXAA_QUALITY_P3 2.0",
        "    #define FXAA_QUALITY_P4 2.0",
        "    #define FXAA_QUALITY_P5 2.0",
        "    #define FXAA_QUALITY_P6 2.0",
        "    #define FXAA_QUALITY_P7 2.0",
        "    #define FXAA_QUALITY_P8 4.0",
        "    #define FXAA_QUALITY_P9 8.0",
        "#endif",
        "/*--------------------------------------------------------------------------*/",
        "#if (FXAA_QUALITY_PRESET == 28)",
        "    #define FXAA_QUALITY_PS 11",
        "    #define FXAA_QUALITY_P0 1.0",
        "    #define FXAA_QUALITY_P1 1.5",
        "    #define FXAA_QUALITY_P2 2.0",
        "    #define FXAA_QUALITY_P3 2.0",
        "    #define FXAA_QUALITY_P4 2.0",
        "    #define FXAA_QUALITY_P5 2.0",
        "    #define FXAA_QUALITY_P6 2.0",
        "    #define FXAA_QUALITY_P7 2.0",
        "    #define FXAA_QUALITY_P8 2.0",
        "    #define FXAA_QUALITY_P9 4.0",
        "    #define FXAA_QUALITY_P10 8.0",
        "#endif",
        "/*--------------------------------------------------------------------------*/",
        "#if (FXAA_QUALITY_PRESET == 29)",
        "    #define FXAA_QUALITY_PS 12",
        "    #define FXAA_QUALITY_P0 1.0",
        "    #define FXAA_QUALITY_P1 1.5",
        "    #define FXAA_QUALITY_P2 2.0",
        "    #define FXAA_QUALITY_P3 2.0",
        "    #define FXAA_QUALITY_P4 2.0",
        "    #define FXAA_QUALITY_P5 2.0",
        "    #define FXAA_QUALITY_P6 2.0",
        "    #define FXAA_QUALITY_P7 2.0",
        "    #define FXAA_QUALITY_P8 2.0",
        "    #define FXAA_QUALITY_P9 2.0",
        "    #define FXAA_QUALITY_P10 4.0",
        "    #define FXAA_QUALITY_P11 8.0",
        "#endif",
        "",
        "/*============================================================================",
        "                     FXAA QUALITY - EXTREME QUALITY",
        "============================================================================*/",
        "#if (FXAA_QUALITY_PRESET == 39)",
        "    #define FXAA_QUALITY_PS 12",
        "    #define FXAA_QUALITY_P0 1.0",
        "    #define FXAA_QUALITY_P1 1.0",
        "    #define FXAA_QUALITY_P2 1.0",
        "    #define FXAA_QUALITY_P3 1.0",
        "    #define FXAA_QUALITY_P4 1.0",
        "    #define FXAA_QUALITY_P5 1.5",
        "    #define FXAA_QUALITY_P6 2.0",
        "    #define FXAA_QUALITY_P7 2.0",
        "    #define FXAA_QUALITY_P8 2.0",
        "    #define FXAA_QUALITY_P9 2.0",
        "    #define FXAA_QUALITY_P10 4.0",
        "    #define FXAA_QUALITY_P11 8.0",
        "#endif",
        "",
        "",
        "",
        "/*============================================================================",
        "",
        "                                API PORTING",
        "",
        "============================================================================*/",
        "#if (FXAA_GLSL_100 == 1) || (FXAA_GLSL_120 == 1) || (FXAA_GLSL_130 == 1)",
        "    #define FxaaBool bool",
        "    #define FxaaDiscard discard",
        "    #define FxaaFloat float",
        "    #define FxaaFloat2 vec2",
        "    #define FxaaFloat3 vec3",
        "    #define FxaaFloat4 vec4",
        "    #define FxaaHalf float",
        "    #define FxaaHalf2 vec2",
        "    #define FxaaHalf3 vec3",
        "    #define FxaaHalf4 vec4",
        "    #define FxaaInt2 ivec2",
        "    #define FxaaSat(x) clamp(x, 0.0, 1.0)",
        "    #define FxaaTex sampler2D",
        "#else",
        "    #define FxaaBool bool",
        "    #define FxaaDiscard clip(-1)",
        "    #define FxaaFloat float",
        "    #define FxaaFloat2 float2",
        "    #define FxaaFloat3 float3",
        "    #define FxaaFloat4 float4",
        "    #define FxaaHalf half",
        "    #define FxaaHalf2 half2",
        "    #define FxaaHalf3 half3",
        "    #define FxaaHalf4 half4",
        "    #define FxaaSat(x) saturate(x)",
        "#endif",
        "/*--------------------------------------------------------------------------*/",
        "#if (FXAA_GLSL_100 == 1)",
        "  #define FxaaTexTop(t, p) texture2D(t, p, 0.0)",
        "  #define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r), 0.0)",
        "#endif",
        "/*--------------------------------------------------------------------------*/",
        "#if (FXAA_GLSL_120 == 1)",
        "    // Requires,",
        "    //  #version 120",
        "    // And at least,",
        "    //  #extension GL_EXT_gpu_shader4 : enable",
        "    //  (or set FXAA_FAST_PIXEL_OFFSET 1 to work like DX9)",
        "    #define FxaaTexTop(t, p) texture2DLod(t, p, 0.0)",
        "    #if (FXAA_FAST_PIXEL_OFFSET == 1)",
        "        #define FxaaTexOff(t, p, o, r) texture2DLodOffset(t, p, 0.0, o)",
        "    #else",
        "        #define FxaaTexOff(t, p, o, r) texture2DLod(t, p + (o * r), 0.0)",
        "    #endif",
        "    #if (FXAA_GATHER4_ALPHA == 1)",
        "        // use #extension GL_ARB_gpu_shader5 : enable",
        "        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)",
        "        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)",
        "        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)",
        "        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)",
        "    #endif",
        "#endif",
        "/*--------------------------------------------------------------------------*/",
        "#if (FXAA_GLSL_130 == 1)",
        "    // Requires \"#version 130\" or better",
        "    #define FxaaTexTop(t, p) textureLod(t, p, 0.0)",
        "    #define FxaaTexOff(t, p, o, r) textureLodOffset(t, p, 0.0, o)",
        "    #if (FXAA_GATHER4_ALPHA == 1)",
        "        // use #extension GL_ARB_gpu_shader5 : enable",
        "        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)",
        "        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)",
        "        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)",
        "        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)",
        "    #endif",
        "#endif",
        "/*--------------------------------------------------------------------------*/",
        "#if (FXAA_HLSL_3 == 1)",
        "    #define FxaaInt2 float2",
        "    #define FxaaTex sampler2D",
        "    #define FxaaTexTop(t, p) tex2Dlod(t, float4(p, 0.0, 0.0))",
        "    #define FxaaTexOff(t, p, o, r) tex2Dlod(t, float4(p + (o * r), 0, 0))",
        "#endif",
        "/*--------------------------------------------------------------------------*/",
        "#if (FXAA_HLSL_4 == 1)",
        "    #define FxaaInt2 int2",
        "    struct FxaaTex { SamplerState smpl; Texture2D tex; };",
        "    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)",
        "    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)",
        "#endif",
        "/*--------------------------------------------------------------------------*/",
        "#if (FXAA_HLSL_5 == 1)",
        "    #define FxaaInt2 int2",
        "    struct FxaaTex { SamplerState smpl; Texture2D tex; };",
        "    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)",
        "    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)",
        "    #define FxaaTexAlpha4(t, p) t.tex.GatherAlpha(t.smpl, p)",
        "    #define FxaaTexOffAlpha4(t, p, o) t.tex.GatherAlpha(t.smpl, p, o)",
        "    #define FxaaTexGreen4(t, p) t.tex.GatherGreen(t.smpl, p)",
        "    #define FxaaTexOffGreen4(t, p, o) t.tex.GatherGreen(t.smpl, p, o)",
        "#endif",
        "",
        "",
        "/*============================================================================",
        "                   GREEN AS LUMA OPTION SUPPORT FUNCTION",
        "============================================================================*/",
        "#if (FXAA_GREEN_AS_LUMA == 0)",
        "    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.w; }",
        "#else",
        "    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.y; }",
        "#endif",
        "",
        "",
        "",
        "",
        "/*============================================================================",
        "",
        "                             FXAA3 QUALITY - PC",
        "",
        "============================================================================*/",
        "#if (FXAA_PC == 1)",
        "/*--------------------------------------------------------------------------*/",
        "FxaaFloat4 FxaaPixelShader(",
        "    //",
        "    // Use noperspective interpolation here (turn off perspective interpolation).",
        "    // {xy} = center of pixel",
        "    FxaaFloat2 pos,",
        "    //",
        "    // Used only for FXAA Console, and not used on the 360 version.",
        "    // Use noperspective interpolation here (turn off perspective interpolation).",
        "    // {xy_} = upper left of pixel",
        "    // {_zw} = lower right of pixel",
        "    FxaaFloat4 fxaaConsolePosPos,",
        "    //",
        "    // Input color texture.",
        "    // {rgb_} = color in linear or perceptual color space",
        "    // if (FXAA_GREEN_AS_LUMA == 0)",
        "    //     {__a} = luma in perceptual color space (not linear)",
        "    FxaaTex tex,",
        "    //",
        "    // Only used on the optimized 360 version of FXAA Console.",
        "    // For everything but 360, just use the same input here as for \"tex\".",
        "    // For 360, same texture, just alias with a 2nd sampler.",
        "    // This sampler needs to have an exponent bias of -1.",
        "    FxaaTex fxaaConsole360TexExpBiasNegOne,",
        "    //",
        "    // Only used on the optimized 360 version of FXAA Console.",
        "    // For everything but 360, just use the same input here as for \"tex\".",
        "    // For 360, same texture, just alias with a 3nd sampler.",
        "    // This sampler needs to have an exponent bias of -2.",
        "    FxaaTex fxaaConsole360TexExpBiasNegTwo,",
        "    //",
        "    // Only used on FXAA Quality.",
        "    // This must be from a constant/uniform.",
        "    // {x_} = 1.0/screenWidthInPixels",
        "    // {_y} = 1.0/screenHeightInPixels",
        "    FxaaFloat2 fxaaQualityRcpFrame,",
        "    //",
        "    // Only used on FXAA Console.",
        "    // This must be from a constant/uniform.",
        "    // This effects sub-pixel AA quality and inversely sharpness.",
        "    //   Where N ranges between,",
        "    //     N = 0.50 (default)",
        "    //     N = 0.33 (sharper)",
        "    // {x__} = -N/screenWidthInPixels",
        "    // {_y_} = -N/screenHeightInPixels",
        "    // {_z_} =  N/screenWidthInPixels",
        "    // {__w} =  N/screenHeightInPixels",
        "    FxaaFloat4 fxaaConsoleRcpFrameOpt,",
        "    //",
        "    // Only used on FXAA Console.",
        "    // Not used on 360, but used on PS3 and PC.",
        "    // This must be from a constant/uniform.",
        "    // {x__} = -2.0/screenWidthInPixels",
        "    // {_y_} = -2.0/screenHeightInPixels",
        "    // {_z_} =  2.0/screenWidthInPixels",
        "    // {__w} =  2.0/screenHeightInPixels",
        "    FxaaFloat4 fxaaConsoleRcpFrameOpt2,",
        "    //",
        "    // Only used on FXAA Console.",
        "    // Only used on 360 in place of fxaaConsoleRcpFrameOpt2.",
        "    // This must be from a constant/uniform.",
        "    // {x__} =  8.0/screenWidthInPixels",
        "    // {_y_} =  8.0/screenHeightInPixels",
        "    // {_z_} = -4.0/screenWidthInPixels",
        "    // {__w} = -4.0/screenHeightInPixels",
        "    FxaaFloat4 fxaaConsole360RcpFrameOpt2,",
        "    //",
        "    // Only used on FXAA Quality.",
        "    // This used to be the FXAA_QUALITY_SUBPIX define.",
        "    // It is here now to allow easier tuning.",
        "    // Choose the amount of sub-pixel aliasing removal.",
        "    // This can effect sharpness.",
        "    //   1.00 - upper limit (softer)",
        "    //   0.75 - default amount of filtering",
        "    //   0.50 - lower limit (sharper, less sub-pixel aliasing removal)",
        "    //   0.25 - almost off",
        "    //   0.00 - completely off",
        "    FxaaFloat fxaaQualitySubpix,",
        "    //",
        "    // Only used on FXAA Quality.",
        "    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD define.",
        "    // It is here now to allow easier tuning.",
        "    // The minimum amount of local contrast required to apply algorithm.",
        "    //   0.333 - too little (faster)",
        "    //   0.250 - low quality",
        "    //   0.166 - default",
        "    //   0.125 - high quality",
        "    //   0.063 - overkill (slower)",
        "    FxaaFloat fxaaQualityEdgeThreshold,",
        "    //",
        "    // Only used on FXAA Quality.",
        "    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD_MIN define.",
        "    // It is here now to allow easier tuning.",
        "    // Trims the algorithm from processing darks.",
        "    //   0.0833 - upper limit (default, the start of visible unfiltered edges)",
        "    //   0.0625 - high quality (faster)",
        "    //   0.0312 - visible limit (slower)",
        "    // Special notes when using FXAA_GREEN_AS_LUMA,",
        "    //   Likely want to set this to zero.",
        "    //   As colors that are mostly not-green",
        "    //   will appear very dark in the green channel!",
        "    //   Tune by looking at mostly non-green content,",
        "    //   then start at zero and increase until aliasing is a problem.",
        "    FxaaFloat fxaaQualityEdgeThresholdMin,",
        "    //",
        "    // Only used on FXAA Console.",
        "    // This used to be the FXAA_CONSOLE_EDGE_SHARPNESS define.",
        "    // It is here now to allow easier tuning.",
        "    // This does not effect PS3, as this needs to be compiled in.",
        "    //   Use FXAA_CONSOLE_PS3_EDGE_SHARPNESS for PS3.",
        "    //   Due to the PS3 being ALU bound,",
        "    //   there are only three safe values here: 2 and 4 and 8.",
        "    //   These options use the shaders ability to a free *|/ by 2|4|8.",
        "    // For all other platforms can be a non-power of two.",
        "    //   8.0 is sharper (default!!!)",
        "    //   4.0 is softer",
        "    //   2.0 is really soft (good only for vector graphics inputs)",
        "    FxaaFloat fxaaConsoleEdgeSharpness,",
        "    //",
        "    // Only used on FXAA Console.",
        "    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD define.",
        "    // It is here now to allow easier tuning.",
        "    // This does not effect PS3, as this needs to be compiled in.",
        "    //   Use FXAA_CONSOLE_PS3_EDGE_THRESHOLD for PS3.",
        "    //   Due to the PS3 being ALU bound,",
        "    //   there are only two safe values here: 1/4 and 1/8.",
        "    //   These options use the shaders ability to a free *|/ by 2|4|8.",
        "    // The console setting has a different mapping than the quality setting.",
        "    // Other platforms can use other values.",
        "    //   0.125 leaves less aliasing, but is softer (default!!!)",
        "    //   0.25 leaves more aliasing, and is sharper",
        "    FxaaFloat fxaaConsoleEdgeThreshold,",
        "    //",
        "    // Only used on FXAA Console.",
        "    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD_MIN define.",
        "    // It is here now to allow easier tuning.",
        "    // Trims the algorithm from processing darks.",
        "    // The console setting has a different mapping than the quality setting.",
        "    // This only applies when FXAA_EARLY_EXIT is 1.",
        "    // This does not apply to PS3,",
        "    // PS3 was simplified to avoid more shader instructions.",
        "    //   0.06 - faster but more aliasing in darks",
        "    //   0.05 - default",
        "    //   0.04 - slower and less aliasing in darks",
        "    // Special notes when using FXAA_GREEN_AS_LUMA,",
        "    //   Likely want to set this to zero.",
        "    //   As colors that are mostly not-green",
        "    //   will appear very dark in the green channel!",
        "    //   Tune by looking at mostly non-green content,",
        "    //   then start at zero and increase until aliasing is a problem.",
        "    FxaaFloat fxaaConsoleEdgeThresholdMin,",
        "    //",
        "    // Extra constants for 360 FXAA Console only.",
        "    // Use zeros or anything else for other platforms.",
        "    // These must be in physical constant registers and NOT immediates.",
        "    // Immediates will result in compiler un-optimizing.",
        "    // {xyzw} = float4(1.0, -1.0, 0.25, -0.25)",
        "    FxaaFloat4 fxaaConsole360ConstDir",
        ") {",
        "/*--------------------------------------------------------------------------*/",
        "    FxaaFloat2 posM;",
        "    posM.x = pos.x;",
        "    posM.y = pos.y;",
        "    #if (FXAA_GATHER4_ALPHA == 1)",
        "        #if (FXAA_DISCARD == 0)",
        "            FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);",
        "            #if (FXAA_GREEN_AS_LUMA == 0)",
        "                #define lumaM rgbyM.w",
        "            #else",
        "                #define lumaM rgbyM.y",
        "            #endif",
        "        #endif",
        "        #if (FXAA_GREEN_AS_LUMA == 0)",
        "            FxaaFloat4 luma4A = FxaaTexAlpha4(tex, posM);",
        "            FxaaFloat4 luma4B = FxaaTexOffAlpha4(tex, posM, FxaaInt2(-1, -1));",
        "        #else",
        "            FxaaFloat4 luma4A = FxaaTexGreen4(tex, posM);",
        "            FxaaFloat4 luma4B = FxaaTexOffGreen4(tex, posM, FxaaInt2(-1, -1));",
        "        #endif",
        "        #if (FXAA_DISCARD == 1)",
        "            #define lumaM luma4A.w",
        "        #endif",
        "        #define lumaE luma4A.z",
        "        #define lumaS luma4A.x",
        "        #define lumaSE luma4A.y",
        "        #define lumaNW luma4B.w",
        "        #define lumaN luma4B.z",
        "        #define lumaW luma4B.x",
        "    #else",
        "        FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);",
        "        #if (FXAA_GREEN_AS_LUMA == 0)",
        "            #define lumaM rgbyM.w",
        "        #else",
        "            #define lumaM rgbyM.y",
        "        #endif",
        "        #if (FXAA_GLSL_100 == 1)",
        "          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0, 1.0), fxaaQualityRcpFrame.xy));",
        "          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 0.0), fxaaQualityRcpFrame.xy));",
        "          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0,-1.0), fxaaQualityRcpFrame.xy));",
        "          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 0.0), fxaaQualityRcpFrame.xy));",
        "        #else",
        "          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));",
        "          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));",
        "          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));",
        "          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));",
        "        #endif",
        "    #endif",
        "/*--------------------------------------------------------------------------*/",
        "    FxaaFloat maxSM = max(lumaS, lumaM);",
        "    FxaaFloat minSM = min(lumaS, lumaM);",
        "    FxaaFloat maxESM = max(lumaE, maxSM);",
        "    FxaaFloat minESM = min(lumaE, minSM);",
        "    FxaaFloat maxWN = max(lumaN, lumaW);",
        "    FxaaFloat minWN = min(lumaN, lumaW);",
        "    FxaaFloat rangeMax = max(maxWN, maxESM);",
        "    FxaaFloat rangeMin = min(minWN, minESM);",
        "    FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;",
        "    FxaaFloat range = rangeMax - rangeMin;",
        "    FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);",
        "    FxaaBool earlyExit = range < rangeMaxClamped;",
        "/*--------------------------------------------------------------------------*/",
        "    if(earlyExit)",
        "        #if (FXAA_DISCARD == 1)",
        "            FxaaDiscard;",
        "        #else",
        "            return rgbyM;",
        "        #endif",
        "/*--------------------------------------------------------------------------*/",
        "    #if (FXAA_GATHER4_ALPHA == 0)",
        "        #if (FXAA_GLSL_100 == 1)",
        "          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0,-1.0), fxaaQualityRcpFrame.xy));",
        "          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 1.0), fxaaQualityRcpFrame.xy));",
        "          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0,-1.0), fxaaQualityRcpFrame.xy));",
        "          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 1.0), fxaaQualityRcpFrame.xy));",
        "        #else",
        "          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));",
        "          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));",
        "          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));",
        "          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));",
        "        #endif",
        "    #else",
        "        FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(1, -1), fxaaQualityRcpFrame.xy));",
        "        FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));",
        "    #endif",
        "/*--------------------------------------------------------------------------*/",
        "    FxaaFloat lumaNS = lumaN + lumaS;",
        "    FxaaFloat lumaWE = lumaW + lumaE;",
        "    FxaaFloat subpixRcpRange = 1.0/range;",
        "    FxaaFloat subpixNSWE = lumaNS + lumaWE;",
        "    FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;",
        "    FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;",
        "/*--------------------------------------------------------------------------*/",
        "    FxaaFloat lumaNESE = lumaNE + lumaSE;",
        "    FxaaFloat lumaNWNE = lumaNW + lumaNE;",
        "    FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;",
        "    FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;",
        "/*--------------------------------------------------------------------------*/",
        "    FxaaFloat lumaNWSW = lumaNW + lumaSW;",
        "    FxaaFloat lumaSWSE = lumaSW + lumaSE;",
        "    FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);",
        "    FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);",
        "    FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;",
        "    FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;",
        "    FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;",
        "    FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;",
        "/*--------------------------------------------------------------------------*/",
        "    FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;",
        "    FxaaFloat lengthSign = fxaaQualityRcpFrame.x;",
        "    FxaaBool horzSpan = edgeHorz >= edgeVert;",
        "    FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;",
        "/*--------------------------------------------------------------------------*/",
        "    if(!horzSpan) lumaN = lumaW;",
        "    if(!horzSpan) lumaS = lumaE;",
        "    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;",
        "    FxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;",
        "/*--------------------------------------------------------------------------*/",
        "    FxaaFloat gradientN = lumaN - lumaM;",
        "    FxaaFloat gradientS = lumaS - lumaM;",
        "    FxaaFloat lumaNN = lumaN + lumaM;",
        "    FxaaFloat lumaSS = lumaS + lumaM;",
        "    FxaaBool pairN = abs(gradientN) >= abs(gradientS);",
        "    FxaaFloat gradient = max(abs(gradientN), abs(gradientS));",
        "    if(pairN) lengthSign = -lengthSign;",
        "    FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);",
        "/*--------------------------------------------------------------------------*/",
        "    FxaaFloat2 posB;",
        "    posB.x = posM.x;",
        "    posB.y = posM.y;",
        "    FxaaFloat2 offNP;",
        "    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;",
        "    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;",
        "    if(!horzSpan) posB.x += lengthSign * 0.5;",
        "    if( horzSpan) posB.y += lengthSign * 0.5;",
        "/*--------------------------------------------------------------------------*/",
        "    FxaaFloat2 posN;",
        "    posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;",
        "    posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;",
        "    FxaaFloat2 posP;",
        "    posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;",
        "    posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;",
        "    FxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;",
        "    FxaaFloat lumaEndN = FxaaLuma(FxaaTexTop(tex, posN));",
        "    FxaaFloat subpixE = subpixC * subpixC;",
        "    FxaaFloat lumaEndP = FxaaLuma(FxaaTexTop(tex, posP));",
        "/*--------------------------------------------------------------------------*/",
        "    if(!pairN) lumaNN = lumaSS;",
        "    FxaaFloat gradientScaled = gradient * 1.0/4.0;",
        "    FxaaFloat lumaMM = lumaM - lumaNN * 0.5;",
        "    FxaaFloat subpixF = subpixD * subpixE;",
        "    FxaaBool lumaMLTZero = lumaMM < 0.0;",
        "/*--------------------------------------------------------------------------*/",
        "    lumaEndN -= lumaNN * 0.5;",
        "    lumaEndP -= lumaNN * 0.5;",
        "    FxaaBool doneN = abs(lumaEndN) >= gradientScaled;",
        "    FxaaBool doneP = abs(lumaEndP) >= gradientScaled;",
        "    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;",
        "    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;",
        "    FxaaBool doneNP = (!doneN) || (!doneP);",
        "    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;",
        "    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;",
        "/*--------------------------------------------------------------------------*/",
        "    if(doneNP) {",
        "        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));",
        "        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));",
        "        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;",
        "        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;",
        "        doneN = abs(lumaEndN) >= gradientScaled;",
        "        doneP = abs(lumaEndP) >= gradientScaled;",
        "        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;",
        "        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;",
        "        doneNP = (!doneN) || (!doneP);",
        "        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;",
        "        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;",
        "/*--------------------------------------------------------------------------*/",
        "        #if (FXAA_QUALITY_PS > 3)",
        "        if(doneNP) {",
        "            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));",
        "            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));",
        "            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;",
        "            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;",
        "            doneN = abs(lumaEndN) >= gradientScaled;",
        "            doneP = abs(lumaEndP) >= gradientScaled;",
        "            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;",
        "            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;",
        "            doneNP = (!doneN) || (!doneP);",
        "            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;",
        "            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;",
        "/*--------------------------------------------------------------------------*/",
        "            #if (FXAA_QUALITY_PS > 4)",
        "            if(doneNP) {",
        "                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));",
        "                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));",
        "                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;",
        "                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;",
        "                doneN = abs(lumaEndN) >= gradientScaled;",
        "                doneP = abs(lumaEndP) >= gradientScaled;",
        "                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;",
        "                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;",
        "                doneNP = (!doneN) || (!doneP);",
        "                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;",
        "                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;",
        "/*--------------------------------------------------------------------------*/",
        "                #if (FXAA_QUALITY_PS > 5)",
        "                if(doneNP) {",
        "                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));",
        "                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));",
        "                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;",
        "                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;",
        "                    doneN = abs(lumaEndN) >= gradientScaled;",
        "                    doneP = abs(lumaEndP) >= gradientScaled;",
        "                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;",
        "                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;",
        "                    doneNP = (!doneN) || (!doneP);",
        "                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;",
        "                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;",
        "/*--------------------------------------------------------------------------*/",
        "                    #if (FXAA_QUALITY_PS > 6)",
        "                    if(doneNP) {",
        "                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));",
        "                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));",
        "                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;",
        "                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;",
        "                        doneN = abs(lumaEndN) >= gradientScaled;",
        "                        doneP = abs(lumaEndP) >= gradientScaled;",
        "                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;",
        "                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;",
        "                        doneNP = (!doneN) || (!doneP);",
        "                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;",
        "                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;",
        "/*--------------------------------------------------------------------------*/",
        "                        #if (FXAA_QUALITY_PS > 7)",
        "                        if(doneNP) {",
        "                            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));",
        "                            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));",
        "                            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;",
        "                            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;",
        "                            doneN = abs(lumaEndN) >= gradientScaled;",
        "                            doneP = abs(lumaEndP) >= gradientScaled;",
        "                            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;",
        "                            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;",
        "                            doneNP = (!doneN) || (!doneP);",
        "                            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;",
        "                            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;",
        "/*--------------------------------------------------------------------------*/",
        "    #if (FXAA_QUALITY_PS > 8)",
        "    if(doneNP) {",
        "        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));",
        "        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));",
        "        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;",
        "        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;",
        "        doneN = abs(lumaEndN) >= gradientScaled;",
        "        doneP = abs(lumaEndP) >= gradientScaled;",
        "        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;",
        "        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;",
        "        doneNP = (!doneN) || (!doneP);",
        "        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;",
        "        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;",
        "/*--------------------------------------------------------------------------*/",
        "        #if (FXAA_QUALITY_PS > 9)",
        "        if(doneNP) {",
        "            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));",
        "            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));",
        "            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;",
        "            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;",
        "            doneN = abs(lumaEndN) >= gradientScaled;",
        "            doneP = abs(lumaEndP) >= gradientScaled;",
        "            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;",
        "            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;",
        "            doneNP = (!doneN) || (!doneP);",
        "            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;",
        "            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;",
        "/*--------------------------------------------------------------------------*/",
        "            #if (FXAA_QUALITY_PS > 10)",
        "            if(doneNP) {",
        "                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));",
        "                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));",
        "                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;",
        "                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;",
        "                doneN = abs(lumaEndN) >= gradientScaled;",
        "                doneP = abs(lumaEndP) >= gradientScaled;",
        "                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;",
        "                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;",
        "                doneNP = (!doneN) || (!doneP);",
        "                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;",
        "                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;",
        "/*--------------------------------------------------------------------------*/",
        "                #if (FXAA_QUALITY_PS > 11)",
        "                if(doneNP) {",
        "                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));",
        "                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));",
        "                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;",
        "                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;",
        "                    doneN = abs(lumaEndN) >= gradientScaled;",
        "                    doneP = abs(lumaEndP) >= gradientScaled;",
        "                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;",
        "                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;",
        "                    doneNP = (!doneN) || (!doneP);",
        "                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;",
        "                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;",
        "/*--------------------------------------------------------------------------*/",
        "                    #if (FXAA_QUALITY_PS > 12)",
        "                    if(doneNP) {",
        "                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));",
        "                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));",
        "                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;",
        "                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;",
        "                        doneN = abs(lumaEndN) >= gradientScaled;",
        "                        doneP = abs(lumaEndP) >= gradientScaled;",
        "                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;",
        "                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;",
        "                        doneNP = (!doneN) || (!doneP);",
        "                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;",
        "                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;",
        "/*--------------------------------------------------------------------------*/",
        "                    }",
        "                    #endif",
        "/*--------------------------------------------------------------------------*/",
        "                }",
        "                #endif",
        "/*--------------------------------------------------------------------------*/",
        "            }",
        "            #endif",
        "/*--------------------------------------------------------------------------*/",
        "        }",
        "        #endif",
        "/*--------------------------------------------------------------------------*/",
        "    }",
        "    #endif",
        "/*--------------------------------------------------------------------------*/",
        "                        }",
        "                        #endif",
        "/*--------------------------------------------------------------------------*/",
        "                    }",
        "                    #endif",
        "/*--------------------------------------------------------------------------*/",
        "                }",
        "                #endif",
        "/*--------------------------------------------------------------------------*/",
        "            }",
        "            #endif",
        "/*--------------------------------------------------------------------------*/",
        "        }",
        "        #endif",
        "/*--------------------------------------------------------------------------*/",
        "    }",
        "/*--------------------------------------------------------------------------*/",
        "    FxaaFloat dstN = posM.x - posN.x;",
        "    FxaaFloat dstP = posP.x - posM.x;",
        "    if(!horzSpan) dstN = posM.y - posN.y;",
        "    if(!horzSpan) dstP = posP.y - posM.y;",
        "/*--------------------------------------------------------------------------*/",
        "    FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;",
        "    FxaaFloat spanLength = (dstP + dstN);",
        "    FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;",
        "    FxaaFloat spanLengthRcp = 1.0/spanLength;",
        "/*--------------------------------------------------------------------------*/",
        "    FxaaBool directionN = dstN < dstP;",
        "    FxaaFloat dst = min(dstN, dstP);",
        "    FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;",
        "    FxaaFloat subpixG = subpixF * subpixF;",
        "    FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;",
        "    FxaaFloat subpixH = subpixG * fxaaQualitySubpix;",
        "/*--------------------------------------------------------------------------*/",
        "    FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;",
        "    FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);",
        "    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;",
        "    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;",
        "    #if (FXAA_DISCARD == 1)",
        "        return FxaaTexTop(tex, posM);",
        "    #else",
        "        return FxaaFloat4(FxaaTexTop(tex, posM).xyz, lumaM);",
        "    #endif",
        "}",
        "/*==========================================================================*/",
        "#endif",
        "",
        "void main() {",
        "  gl_FragColor = FxaaPixelShader(",
        "    vUv,",
        "    vec4(0.0),",
        "    tDiffuse,",
        "    tDiffuse,",
        "    tDiffuse,",
        "    resolution,",
        "    vec4(0.0),",
        "    vec4(0.0),",
        "    vec4(0.0),",
        "    0.75,",
        "    0.166,",
        "    0.0833,",
        "    0.0,",
        "    0.0,",
        "    0.0,",
        "    vec4(0.0)",
        "  );",
        "",
        "  // TODO avoid querying texture twice for same texel",
        "  gl_FragColor.a = texture2D(tDiffuse, vUv).a;",
        "}"
	].join("\n")

};

/**
 * @author alteredq / http://alteredqualia.com/
 */

THREE.EffectComposer = function ( renderer, renderTarget ) {

	this.renderer = renderer;

	if ( renderTarget === undefined ) {

		var parameters = {
			minFilter: THREE.LinearFilter,
			magFilter: THREE.LinearFilter,
			format: THREE.RGBAFormat,
			stencilBuffer: false
		};

		var size = renderer.getDrawingBufferSize( new THREE.Vector2() );
		renderTarget = new THREE.WebGLRenderTarget( size.width, size.height, parameters );
		renderTarget.texture.name = 'EffectComposer.rt1';

	}

	this.renderTarget1 = renderTarget;
	this.renderTarget2 = renderTarget.clone();
	this.renderTarget2.texture.name = 'EffectComposer.rt2';

	this.writeBuffer = this.renderTarget1;
	this.readBuffer = this.renderTarget2;

	this.renderToScreen = true;

	this.passes = [];

	// dependencies

	if ( THREE.CopyShader === undefined ) {

		console.error( 'THREE.EffectComposer relies on THREE.CopyShader' );

	}

	if ( THREE.ShaderPass === undefined ) {

		console.error( 'THREE.EffectComposer relies on THREE.ShaderPass' );

	}

	this.copyPass = new THREE.ShaderPass( THREE.CopyShader );

	this._previousFrameTime = Date.now();

};

Object.assign( THREE.EffectComposer.prototype, {

	swapBuffers: function () {

		var tmp = this.readBuffer;
		this.readBuffer = this.writeBuffer;
		this.writeBuffer = tmp;

	},

	addPass: function ( pass ) {

		this.passes.push( pass );

		var size = this.renderer.getDrawingBufferSize( new THREE.Vector2() );
		pass.setSize( size.width, size.height );

	},

	insertPass: function ( pass, index ) {

		this.passes.splice( index, 0, pass );

	},

	isLastEnabledPass: function ( passIndex ) {

		for ( var i = passIndex + 1; i < this.passes.length; i ++ ) {

			if ( this.passes[ i ].enabled ) {

				return false;

			}

		}

		return true;

	},

	render: function ( deltaTime ) {

		// deltaTime value is in seconds

		if ( deltaTime === undefined ) {

			deltaTime = ( Date.now() - this._previousFrameTime ) * 0.001;

		}

		this._previousFrameTime = Date.now();

		var currentRenderTarget = this.renderer.getRenderTarget();

		var maskActive = false;

		var pass, i, il = this.passes.length;

		for ( i = 0; i < il; i ++ ) {

			pass = this.passes[ i ];

			if ( pass.enabled === false ) continue;

			pass.renderToScreen = ( this.renderToScreen && this.isLastEnabledPass( i ) );
			pass.render( this.renderer, this.writeBuffer, this.readBuffer, deltaTime, maskActive );

			if ( pass.needsSwap ) {

				if ( maskActive ) {

					var context = this.renderer.context;

					context.stencilFunc( context.NOTEQUAL, 1, 0xffffffff );

					this.copyPass.render( this.renderer, this.writeBuffer, this.readBuffer, deltaTime );

					context.stencilFunc( context.EQUAL, 1, 0xffffffff );

				}

				this.swapBuffers();

			}

			if ( THREE.MaskPass !== undefined ) {

				if ( pass instanceof THREE.MaskPass ) {

					maskActive = true;

				} else if ( pass instanceof THREE.ClearMaskPass ) {

					maskActive = false;

				}

			}

		}

		this.renderer.setRenderTarget( currentRenderTarget );

	},

	reset: function ( renderTarget ) {

		if ( renderTarget === undefined ) {

			var size = this.renderer.getDrawingBufferSize( new THREE.Vector2() );

			renderTarget = this.renderTarget1.clone();
			renderTarget.setSize( size.width, size.height );

		}

		this.renderTarget1.dispose();
		this.renderTarget2.dispose();
		this.renderTarget1 = renderTarget;
		this.renderTarget2 = renderTarget.clone();

		this.writeBuffer = this.renderTarget1;
		this.readBuffer = this.renderTarget2;

	},

	setSize: function ( width, height ) {

		this.renderTarget1.setSize( width, height );
		this.renderTarget2.setSize( width, height );

		for ( var i = 0; i < this.passes.length; i ++ ) {

			this.passes[ i ].setSize( width, height );

		}

	}

} );


THREE.Pass = function () {

	// if set to true, the pass is processed by the composer
	this.enabled = true;

	// if set to true, the pass indicates to swap read and write buffer after rendering
	this.needsSwap = true;

	// if set to true, the pass clears its buffer before rendering
	this.clear = false;

	// if set to true, the result of the pass is rendered to screen. This is set automatically by EffectComposer.
	this.renderToScreen = false;

};

Object.assign( THREE.Pass.prototype, {

	setSize: function ( width, height ) {},

	render: function ( renderer, writeBuffer, readBuffer, deltaTime, maskActive ) {

		console.error( 'THREE.Pass: .render() must be implemented in derived pass.' );

	}

} );

// Helper for passes that need to fill the viewport with a single quad.
THREE.Pass.FullScreenQuad = ( function () {

	var camera = new THREE.OrthographicCamera( - 1, 1, 1, - 1, 0, 1 );
	var geometry = new THREE.PlaneBufferGeometry( 2, 2 );

	var FullScreenQuad = function ( material ) {

		this._mesh = new THREE.Mesh( geometry, material );

	};

	Object.defineProperty( FullScreenQuad.prototype, 'material', {

		get: function () {

			return this._mesh.material;

		},

		set: function ( value ) {

			this._mesh.material = value;

		}

	} );

	Object.assign( FullScreenQuad.prototype, {

		render: function ( renderer ) {

			renderer.render( this._mesh, camera );

		}

	} );

	return FullScreenQuad;

} )();

/**
 * @author alteredq / http://alteredqualia.com/
 */

THREE.RenderPass = function ( scene, camera, overrideMaterial, clearColor, clearAlpha ) {

	THREE.Pass.call( this );

	this.scene = scene;
	this.camera = camera;

	this.overrideMaterial = overrideMaterial;

	this.clearColor = clearColor;
	this.clearAlpha = ( clearAlpha !== undefined ) ? clearAlpha : 0;

	this.clear = true;
	this.clearDepth = false;
	this.needsSwap = false;

};

THREE.RenderPass.prototype = Object.assign( Object.create( THREE.Pass.prototype ), {

	constructor: THREE.RenderPass,

	render: function ( renderer, writeBuffer, readBuffer, deltaTime, maskActive ) {

		var oldAutoClear = renderer.autoClear;
		renderer.autoClear = false;

		this.scene.overrideMaterial = this.overrideMaterial;

		var oldClearColor, oldClearAlpha;

		if ( this.clearColor ) {

			oldClearColor = renderer.getClearColor().getHex();
			oldClearAlpha = renderer.getClearAlpha();

			renderer.setClearColor( this.clearColor, this.clearAlpha );

		}

		if ( this.clearDepth ) {

			renderer.clearDepth();

		}

		renderer.setRenderTarget( this.renderToScreen ? null : readBuffer );

		// TODO: Avoid using autoClear properties, see https://github.com/mrdoob/three.js/pull/15571#issuecomment-465669600
		if ( this.clear ) renderer.clear( renderer.autoClearColor, renderer.autoClearDepth, renderer.autoClearStencil );
		renderer.render( this.scene, this.camera );

		if ( this.clearColor ) {

			renderer.setClearColor( oldClearColor, oldClearAlpha );

		}

		this.scene.overrideMaterial = null;
		renderer.autoClear = oldAutoClear;

	}

} );

/**
 * @author alteredq / http://alteredqualia.com/
 */

THREE.ShaderPass = function ( shader, textureID ) {

	THREE.Pass.call( this );

	this.textureID = ( textureID !== undefined ) ? textureID : "tDiffuse";

	if ( shader instanceof THREE.ShaderMaterial ) {

		this.uniforms = shader.uniforms;

		this.material = shader;

	} else if ( shader ) {

		this.uniforms = THREE.UniformsUtils.clone( shader.uniforms );

		this.material = new THREE.ShaderMaterial( {

			defines: Object.assign( {}, shader.defines ),
			uniforms: this.uniforms,
			vertexShader: shader.vertexShader,
			fragmentShader: shader.fragmentShader

		} );

	}

	this.fsQuad = new THREE.Pass.FullScreenQuad( this.material );
};

THREE.ShaderPass.prototype = Object.assign( Object.create( THREE.Pass.prototype ), {

	constructor: THREE.ShaderPass,

	render: function ( renderer, writeBuffer, readBuffer, deltaTime, maskActive ) {

		if ( this.uniforms[ this.textureID ] ) {

			this.uniforms[ this.textureID ].value = readBuffer.texture;

		}

		this.fsQuad.material = this.material;

		if ( this.renderToScreen ) {

			renderer.setRenderTarget( null );
			this.fsQuad.render( renderer );

		} else {

			renderer.setRenderTarget( writeBuffer );
			// TODO: Avoid using autoClear properties, see https://github.com/mrdoob/three.js/pull/15571#issuecomment-465669600
			if ( this.clear ) renderer.clear( renderer.autoClearColor, renderer.autoClearDepth, renderer.autoClearStencil );
			this.fsQuad.render( renderer );

		}

	}

} );

/**
 * @author spidersharma / http://eduperiment.com/
 */

THREE.OutlinePass = function (resolution, scene, camera, selectedObjects) {
    this.renderScene = scene;
    this.renderCamera = camera;
    this.selectedObjects = selectedObjects !== undefined ? selectedObjects : [];
    this.visibleEdgeColor = new THREE.Color(1, 1, 1);
    this.hiddenEdgeColor = new THREE.Color(0.1, 0.04, 0.02);
    this.edgeGlow = 0.0;
    this.usePatternTexture = false;
    this.edgeThickness = 1.0;
    this.edgeStrength = 3.0;
    this.downSampleRatio = 2;
    this.pulsePeriod = 0;

    THREE.Pass.call(this);

    this.resolution =
        resolution !== undefined ? new THREE.Vector2(resolution.x, resolution.y) : new THREE.Vector2(256, 256);

    var pars = { minFilter: THREE.LinearFilter, magFilter: THREE.LinearFilter, format: THREE.RGBAFormat };

    var resx = Math.round(this.resolution.x / this.downSampleRatio);
    var resy = Math.round(this.resolution.y / this.downSampleRatio);

    this.maskBufferMaterial = new THREE.MeshBasicMaterial({ color: 0xffffff });
    this.maskBufferMaterial.side = THREE.DoubleSide;
    this.renderTargetMaskBuffer = new THREE.WebGLRenderTarget(this.resolution.x, this.resolution.y, pars);
    this.renderTargetMaskBuffer.texture.name = 'OutlinePass.mask';
    this.renderTargetMaskBuffer.texture.generateMipmaps = false;

    this.depthMaterial = new THREE.MeshDepthMaterial();
    this.depthMaterial.side = THREE.DoubleSide;
    this.depthMaterial.depthPacking = THREE.RGBADepthPacking;
    this.depthMaterial.blending = THREE.NoBlending;

    this.prepareMaskMaterial = this.getPrepareMaskMaterial();
    this.prepareMaskMaterial.side = THREE.DoubleSide;
    this.prepareMaskMaterial.clippingPlanes = [];
    this.prepareMaskMaterial.fragmentShader = replaceDepthToViewZ(
        this.prepareMaskMaterial.fragmentShader,
        this.renderCamera
    );
    this.updateClippedPlanes();

    this.renderTargetDepthBuffer = new THREE.WebGLRenderTarget(this.resolution.x, this.resolution.y, pars);
    this.renderTargetDepthBuffer.texture.name = 'OutlinePass.depth';
    this.renderTargetDepthBuffer.texture.generateMipmaps = false;

    this.renderTargetMaskDownSampleBuffer = new THREE.WebGLRenderTarget(resx, resy, pars);
    this.renderTargetMaskDownSampleBuffer.texture.name = 'OutlinePass.depthDownSample';
    this.renderTargetMaskDownSampleBuffer.texture.generateMipmaps = false;

    this.renderTargetBlurBuffer1 = new THREE.WebGLRenderTarget(resx, resy, pars);
    this.renderTargetBlurBuffer1.texture.name = 'OutlinePass.blur1';
    this.renderTargetBlurBuffer1.texture.generateMipmaps = false;
    this.renderTargetBlurBuffer2 = new THREE.WebGLRenderTarget(Math.round(resx / 2), Math.round(resy / 2), pars);
    this.renderTargetBlurBuffer2.texture.name = 'OutlinePass.blur2';
    this.renderTargetBlurBuffer2.texture.generateMipmaps = false;

    this.edgeDetectionMaterial = this.getEdgeDetectionMaterial();
    this.renderTargetEdgeBuffer1 = new THREE.WebGLRenderTarget(resx, resy, pars);
    this.renderTargetEdgeBuffer1.texture.name = 'OutlinePass.edge1';
    this.renderTargetEdgeBuffer1.texture.generateMipmaps = false;
    this.renderTargetEdgeBuffer2 = new THREE.WebGLRenderTarget(Math.round(resx / 2), Math.round(resy / 2), pars);
    this.renderTargetEdgeBuffer2.texture.name = 'OutlinePass.edge2';
    this.renderTargetEdgeBuffer2.texture.generateMipmaps = false;

    var MAX_EDGE_THICKNESS = 4;
    var MAX_EDGE_GLOW = 4;

    this.separableBlurMaterial1 = this.getSeperableBlurMaterial(MAX_EDGE_THICKNESS);
    this.separableBlurMaterial1.uniforms['texSize'].value = new THREE.Vector2(resx, resy);
    this.separableBlurMaterial1.uniforms['kernelRadius'].value = 1;
    this.separableBlurMaterial2 = this.getSeperableBlurMaterial(MAX_EDGE_GLOW);
    this.separableBlurMaterial2.uniforms['texSize'].value = new THREE.Vector2(
        Math.round(resx / 2),
        Math.round(resy / 2)
    );
    this.separableBlurMaterial2.uniforms['kernelRadius'].value = MAX_EDGE_GLOW;

    // Overlay material
    this.overlayMaterial = this.getOverlayMaterial();

    // copy material
    if (THREE.CopyShader === undefined) console.error('THREE.OutlinePass relies on THREE.CopyShader');

    var copyShader = THREE.CopyShader;

    this.copyUniforms = THREE.UniformsUtils.clone(copyShader.uniforms);
    this.copyUniforms['opacity'].value = 1.0;

    this.materialCopy = new THREE.ShaderMaterial({
        uniforms: this.copyUniforms,
        vertexShader: copyShader.vertexShader,
        fragmentShader: copyShader.fragmentShader,
        blending: THREE.NoBlending,
        depthTest: false,
        depthWrite: false,
        transparent: true
    });

    this.enabled = true;
    this.needsSwap = false;

    this.oldClearColor = new THREE.Color();
    this.oldClearAlpha = 1;

    this.fsQuad = new THREE.Pass.FullScreenQuad(null);

    this.tempPulseColor1 = new THREE.Color();
    this.tempPulseColor2 = new THREE.Color();
    this.textureMatrix = new THREE.Matrix4();

    function replaceDepthToViewZ(string, camera) {
        var type = camera.isPerspectiveCamera ? 'perspective' : 'orthographic';

        return string.replace(/DEPTH_TO_VIEW_Z/g, type + 'DepthToViewZ');
    }
};

THREE.OutlinePass.prototype = Object.assign(Object.create(THREE.Pass.prototype), {
    constructor: THREE.OutlinePass,

    dispose: function () {
        this.renderTargetMaskBuffer.dispose();
        this.renderTargetDepthBuffer.dispose();
        this.renderTargetMaskDownSampleBuffer.dispose();
        this.renderTargetBlurBuffer1.dispose();
        this.renderTargetBlurBuffer2.dispose();
        this.renderTargetEdgeBuffer1.dispose();
        this.renderTargetEdgeBuffer2.dispose();
    },

    setSize: function (width, height) {
        this.renderTargetMaskBuffer.setSize(width, height);

        var resx = Math.round(width / this.downSampleRatio);
        var resy = Math.round(height / this.downSampleRatio);
        this.renderTargetMaskDownSampleBuffer.setSize(resx, resy);
        this.renderTargetBlurBuffer1.setSize(resx, resy);
        this.renderTargetEdgeBuffer1.setSize(resx, resy);
        this.separableBlurMaterial1.uniforms['texSize'].value = new THREE.Vector2(resx, resy);

        resx = Math.round(resx / 2);
        resy = Math.round(resy / 2);

        this.renderTargetBlurBuffer2.setSize(resx, resy);
        this.renderTargetEdgeBuffer2.setSize(resx, resy);

        this.separableBlurMaterial2.uniforms['texSize'].value = new THREE.Vector2(resx, resy);
    },

    changeVisibilityOfSelectedObjects: function (bVisible) {
        function gatherSelectedMeshesCallBack(object) {
            if (object.isMesh) {
                if (bVisible) {
                    object.visible = object.userData.oldVisible;
                    delete object.userData.oldVisible;
                } else {
                    object.userData.oldVisible = object.visible;
                    object.visible = bVisible;
                }
            }
        }

        for (var i = 0; i < this.selectedObjects.length; i++) {
            var selectedObject = this.selectedObjects[i];
            selectedObject.traverse(gatherSelectedMeshesCallBack);
        }
    },

    changeVisibilityOfNonSelectedObjects: function (bVisible) {
        var selectedMeshes = [];

        function gatherSelectedMeshesCallBack(object) {
            if (object.isMesh) selectedMeshes.push(object);
        }

        for (var i = 0; i < this.selectedObjects.length; i++) {
            var selectedObject = this.selectedObjects[i];
            selectedObject.traverse(gatherSelectedMeshesCallBack);
        }

        function VisibilityChangeCallBack(object) {
            if (object.isMesh || object.isLine || object.isSprite) {
                var bFound = false;

                for (var i = 0; i < selectedMeshes.length; i++) {
                    var selectedObjectId = selectedMeshes[i].id;

                    if (selectedObjectId === object.id) {
                        bFound = true;
                        break;
                    }
                }

                if (!bFound) {
                    var visibility = object.visible;

                    if (!bVisible || object.bVisible) object.visible = bVisible;

                    object.bVisible = visibility;
                }
            }
        }

        this.renderScene.traverse(VisibilityChangeCallBack);
    },

    updateTextureMatrix: function () {
        this.textureMatrix.set(0.5, 0.0, 0.0, 0.5, 0.0, 0.5, 0.0, 0.5, 0.0, 0.0, 0.5, 0.5, 0.0, 0.0, 0.0, 1.0);
        this.textureMatrix.multiply(this.renderCamera.projectionMatrix);
        this.textureMatrix.multiply(this.renderCamera.matrixWorldInverse);
    },

    updateClippedPlanes: function () {
        var clippingPlanes = [];
        // Only use clipping planes of first selected object.
        if (this.selectedObjects.length > 0) {
            if (typeof this.selectedObjects[0].material !== 'undefined' && this.selectedObjects[0].material !== null) {
                clippingPlanes = this.selectedObjects[0].material.clippingPlanes || [];
            }
        }
        this.prepareMaskMaterial.clipping = clippingPlanes.length > 0;
        this.prepareMaskMaterial.clippingPlanes = clippingPlanes;
        this.prepareMaskMaterial.needsUpdate = true;
    },

    render: function (renderer, writeBuffer, readBuffer, deltaTime, maskActive) {
        if (this.selectedObjects.length > 0) {
            this.oldClearColor.copy(renderer.getClearColor());
            this.oldClearAlpha = renderer.getClearAlpha();
            var oldAutoClear = renderer.autoClear;

            renderer.autoClear = false;

            if (maskActive) renderer.context.disable(renderer.context.STENCIL_TEST);

            renderer.setClearColor(0xffffff, 1);

            // Make selected objects invisible
            this.changeVisibilityOfSelectedObjects(false);

            var currentBackground = this.renderScene.background;
            this.renderScene.background = null;

            // 1. Draw Non Selected objects in the depth buffer
            this.renderScene.overrideMaterial = this.depthMaterial;
            renderer.setRenderTarget(this.renderTargetDepthBuffer);
            renderer.clear();
            renderer.render(this.renderScene, this.renderCamera);

            // Make selected objects visible
            this.changeVisibilityOfSelectedObjects(true);

            // Update Texture Matrix for Depth compare
            this.updateTextureMatrix();

            // Make non selected objects invisible, and draw only the selected objects, by comparing the depth buffer of non selected objects
            this.changeVisibilityOfNonSelectedObjects(false);
            this.renderScene.overrideMaterial = this.prepareMaskMaterial;
            this.prepareMaskMaterial.uniforms['cameraNearFar'].value = new THREE.Vector2(
                this.renderCamera.near,
                this.renderCamera.far
            );
            this.prepareMaskMaterial.uniforms['depthTexture'].value = this.renderTargetDepthBuffer.texture;
            this.prepareMaskMaterial.uniforms['textureMatrix'].value = this.textureMatrix;

            renderer.setRenderTarget(this.renderTargetMaskBuffer);
            renderer.clear();
            renderer.render(this.renderScene, this.renderCamera);
            this.renderScene.overrideMaterial = null;
            this.changeVisibilityOfNonSelectedObjects(true);

            this.renderScene.background = currentBackground;

            // 2. Downsample to Half resolution
            this.fsQuad.material = this.materialCopy;
            this.copyUniforms['tDiffuse'].value = this.renderTargetMaskBuffer.texture;
            renderer.setRenderTarget(this.renderTargetMaskDownSampleBuffer);
            renderer.clear();
            this.fsQuad.render(renderer);

            this.tempPulseColor1.copy(this.visibleEdgeColor);
            this.tempPulseColor2.copy(this.hiddenEdgeColor);

            if (this.pulsePeriod > 0) {
                var scalar =
                    (1 + 0.25) / 2 + (Math.cos((performance.now() * 0.01) / this.pulsePeriod) * (1.0 - 0.25)) / 2;
                this.tempPulseColor1.multiplyScalar(scalar);
                this.tempPulseColor2.multiplyScalar(scalar);
            }

            // 3. Apply Edge Detection Pass
            this.fsQuad.material = this.edgeDetectionMaterial;
            this.edgeDetectionMaterial.uniforms['maskTexture'].value = this.renderTargetMaskDownSampleBuffer.texture;
            this.edgeDetectionMaterial.uniforms['texSize'].value = new THREE.Vector2(
                this.renderTargetMaskDownSampleBuffer.width,
                this.renderTargetMaskDownSampleBuffer.height
            );
            this.edgeDetectionMaterial.uniforms['visibleEdgeColor'].value = this.tempPulseColor1;
            this.edgeDetectionMaterial.uniforms['hiddenEdgeColor'].value = this.tempPulseColor2;
            renderer.setRenderTarget(this.renderTargetEdgeBuffer1);
            renderer.clear();
            this.fsQuad.render(renderer);

            // 4. Apply Blur on Half res
            this.fsQuad.material = this.separableBlurMaterial1;
            this.separableBlurMaterial1.uniforms['colorTexture'].value = this.renderTargetEdgeBuffer1.texture;
            this.separableBlurMaterial1.uniforms['direction'].value = THREE.OutlinePass.BlurDirectionX;
            this.separableBlurMaterial1.uniforms['kernelRadius'].value = this.edgeThickness;
            renderer.setRenderTarget(this.renderTargetBlurBuffer1);
            renderer.clear();
            this.fsQuad.render(renderer);
            this.separableBlurMaterial1.uniforms['colorTexture'].value = this.renderTargetBlurBuffer1.texture;
            this.separableBlurMaterial1.uniforms['direction'].value = THREE.OutlinePass.BlurDirectionY;
            renderer.setRenderTarget(this.renderTargetEdgeBuffer1);
            renderer.clear();
            this.fsQuad.render(renderer);

            // Apply Blur on quarter res
            this.fsQuad.material = this.separableBlurMaterial2;
            this.separableBlurMaterial2.uniforms['colorTexture'].value = this.renderTargetEdgeBuffer1.texture;
            this.separableBlurMaterial2.uniforms['direction'].value = THREE.OutlinePass.BlurDirectionX;
            renderer.setRenderTarget(this.renderTargetBlurBuffer2);
            renderer.clear();
            this.fsQuad.render(renderer);
            this.separableBlurMaterial2.uniforms['colorTexture'].value = this.renderTargetBlurBuffer2.texture;
            this.separableBlurMaterial2.uniforms['direction'].value = THREE.OutlinePass.BlurDirectionY;
            renderer.setRenderTarget(this.renderTargetEdgeBuffer2);
            renderer.clear();
            this.fsQuad.render(renderer);

            // Blend it additively over the input texture
            this.fsQuad.material = this.overlayMaterial;
            this.overlayMaterial.uniforms['maskTexture'].value = this.renderTargetMaskBuffer.texture;
            this.overlayMaterial.uniforms['edgeTexture1'].value = this.renderTargetEdgeBuffer1.texture;
            this.overlayMaterial.uniforms['edgeTexture2'].value = this.renderTargetEdgeBuffer2.texture;
            this.overlayMaterial.uniforms['patternTexture'].value = this.patternTexture;
            this.overlayMaterial.uniforms['edgeStrength'].value = this.edgeStrength;
            this.overlayMaterial.uniforms['edgeGlow'].value = this.edgeGlow;
            this.overlayMaterial.uniforms['usePatternTexture'].value = this.usePatternTexture;

            if (maskActive) renderer.context.enable(renderer.context.STENCIL_TEST);

            renderer.setRenderTarget(readBuffer);
            this.fsQuad.render(renderer);

            renderer.setClearColor(this.oldClearColor, this.oldClearAlpha);
            renderer.autoClear = oldAutoClear;
        }

        if (this.renderToScreen) {
            this.fsQuad.material = this.materialCopy;
            this.copyUniforms['tDiffuse'].value = readBuffer.texture;
            renderer.setRenderTarget(null);
            this.fsQuad.render(renderer);
        }
    },

    getPrepareMaskMaterial: function () {
        return new THREE.ShaderMaterial({
            clipping: false,

            uniforms: {
                depthTexture: { value: null },
                cameraNearFar: { value: new THREE.Vector2(0.5, 0.5) },
                textureMatrix: { value: new THREE.Matrix4() }
            },

            vertexShader: [
                'varying vec4 projTexCoord;',
                'varying vec4 mvPosition;',
                'uniform mat4 textureMatrix;',

                '#include <clipping_planes_pars_vertex>',

                'void main() {',
                '	mvPosition = modelViewMatrix * vec4( position, 1.0 );',

                '   #include <clipping_planes_vertex>',

                '	vec4 worldPosition = modelMatrix * vec4( position, 1.0 );',
                '	projTexCoord = textureMatrix * worldPosition;',
                '	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',

                '}'
            ].join('\n'),

            fragmentShader: [
                '#include <packing>',
                'varying vec4 mvPosition;',
                'varying vec4 projTexCoord;',
                'uniform sampler2D depthTexture;',
                'uniform vec2 cameraNearFar;',

                '#include <clipping_planes_pars_fragment>',

                'void main() {',
                '	#include <clipping_planes_fragment>',

                '	float depth = unpackRGBAToDepth(texture2DProj( depthTexture, projTexCoord ));',
                '	float viewZ = - DEPTH_TO_VIEW_Z( depth, cameraNearFar.x, cameraNearFar.y );',
                '	float depthTest = (-mvPosition.z > viewZ) ? 1.0 : 0.0;',
                '	gl_FragColor = vec4(0.0, depthTest, 1.0, 1.0);',

                '}'
            ].join('\n')
        });
    },

    getEdgeDetectionMaterial: function () {
        return new THREE.ShaderMaterial({
            uniforms: {
                maskTexture: { value: null },
                texSize: { value: new THREE.Vector2(0.5, 0.5) },
                visibleEdgeColor: { value: new THREE.Vector3(1.0, 1.0, 1.0) },
                hiddenEdgeColor: { value: new THREE.Vector3(1.0, 1.0, 1.0) }
            },

            vertexShader:
                'varying vec2 vUv;\n\
				void main() {\n\
					vUv = uv;\n\
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\
				}',

            fragmentShader:
                'varying vec2 vUv;\
				uniform sampler2D maskTexture;\
				uniform vec2 texSize;\
				uniform vec3 visibleEdgeColor;\
				uniform vec3 hiddenEdgeColor;\
				\
				void main() {\n\
					vec2 invSize = 1.0 / texSize;\
					vec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);\
					vec4 c1 = texture2D( maskTexture, vUv + uvOffset.xy);\
					vec4 c2 = texture2D( maskTexture, vUv - uvOffset.xy);\
					vec4 c3 = texture2D( maskTexture, vUv + uvOffset.yw);\
					vec4 c4 = texture2D( maskTexture, vUv - uvOffset.yw);\
					float diff1 = (c1.r - c2.r)*0.5;\
					float diff2 = (c3.r - c4.r)*0.5;\
					float d = length( vec2(diff1, diff2) );\
					float a1 = min(c1.g, c2.g);\
					float a2 = min(c3.g, c4.g);\
					float visibilityFactor = min(a1, a2);\
					vec3 edgeColor = 1.0 - visibilityFactor > 0.001 ? visibleEdgeColor : hiddenEdgeColor;\
					gl_FragColor = vec4(edgeColor, 1.0) * vec4(d);\
				}'
        });
    },

    getSeperableBlurMaterial: function (maxRadius) {
        return new THREE.ShaderMaterial({
            defines: {
                MAX_RADIUS: maxRadius
            },

            uniforms: {
                colorTexture: { value: null },
                texSize: { value: new THREE.Vector2(0.5, 0.5) },
                direction: { value: new THREE.Vector2(0.5, 0.5) },
                kernelRadius: { value: 1.0 }
            },

            vertexShader:
                'varying vec2 vUv;\n\
				void main() {\n\
					vUv = uv;\n\
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\
				}',

            fragmentShader:
                '#include <common>\
				varying vec2 vUv;\
				uniform sampler2D colorTexture;\
				uniform vec2 texSize;\
				uniform vec2 direction;\
				uniform float kernelRadius;\
				\
				float gaussianPdf(in float x, in float sigma) {\
					return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\
				}\
				void main() {\
					vec2 invSize = 1.0 / texSize;\
					float weightSum = gaussianPdf(0.0, kernelRadius);\
					vec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\
					vec2 delta = direction * invSize * kernelRadius/float(MAX_RADIUS);\
					vec2 uvOffset = delta;\
					for( int i = 1; i <= MAX_RADIUS; i ++ ) {\
						float w = gaussianPdf(uvOffset.x, kernelRadius);\
						vec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\
						vec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\
						diffuseSum += ((sample1 + sample2) * w);\
						weightSum += (2.0 * w);\
						uvOffset += delta;\
					}\
					gl_FragColor = vec4(diffuseSum/weightSum, 1.0);\
				}'
        });
    },

    getOverlayMaterial: function () {
        return new THREE.ShaderMaterial({
            uniforms: {
                maskTexture: { value: null },
                edgeTexture1: { value: null },
                edgeTexture2: { value: null },
                patternTexture: { value: null },
                edgeStrength: { value: 1.0 },
                edgeGlow: { value: 1.0 },
                usePatternTexture: { value: 0.0 }
            },

            vertexShader:
                'varying vec2 vUv;\n\
				void main() {\n\
					vUv = uv;\n\
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\
				}',

            fragmentShader:
                'varying vec2 vUv;\
				uniform sampler2D maskTexture;\
				uniform sampler2D edgeTexture1;\
				uniform sampler2D edgeTexture2;\
				uniform sampler2D patternTexture;\
				uniform float edgeStrength;\
				uniform float edgeGlow;\
				uniform bool usePatternTexture;\
				\
				void main() {\
					vec4 edgeValue1 = texture2D(edgeTexture1, vUv);\
					vec4 edgeValue2 = texture2D(edgeTexture2, vUv);\
					vec4 maskColor = texture2D(maskTexture, vUv);\
					vec4 patternColor = texture2D(patternTexture, 6.0 * vUv);\
					float visibilityFactor = 1.0 - maskColor.g > 0.0 ? 1.0 : 0.5;\
					vec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;\
					vec4 finalColor = edgeStrength * maskColor.r * edgeValue;\
					if(usePatternTexture)\
						finalColor += + visibilityFactor * (1.0 - maskColor.r) * (1.0 - patternColor.r);\
					gl_FragColor = finalColor;\
				}',
            blending: THREE.AdditiveBlending,
            depthTest: false,
            depthWrite: false,
            transparent: true
        });
    }
});

THREE.OutlinePass.BlurDirectionX = new THREE.Vector2(1.0, 0.0);
THREE.OutlinePass.BlurDirectionY = new THREE.Vector2(0.0, 1.0);

/**
 * @author arodic / https://github.com/arodic
 */

THREE.TransformControls = function ( camera, domElement ) {

	THREE.Object3D.call( this );

	domElement = ( domElement !== undefined ) ? domElement : document;

	this.visible = false;

	var _gizmo = new THREE.TransformControlsGizmo();
	this.add( _gizmo );

	var _plane = new THREE.TransformControlsPlane();
	this.add( _plane );

	var scope = this;

	// Define properties with getters/setter
	// Setting the defined property will automatically trigger change event
	// Defined properties are passed down to gizmo and plane

	defineProperty( "camera", camera );
	defineProperty( "object", undefined );
	defineProperty( "enabled", true );
	defineProperty( "axis", null );
	defineProperty( "mode", "translate" );
	defineProperty( "translationSnap", null );
	defineProperty( "rotationSnap", null );
	defineProperty( "space", "world" );
	defineProperty( "size", 1 );
	defineProperty( "dragging", false );
	defineProperty( "showX", true );
	defineProperty( "showY", true );
	defineProperty( "showZ", true );

	var changeEvent = { type: "change" };
	var mouseDownEvent = { type: "mouseDown" };
	var mouseUpEvent = { type: "mouseUp", mode: scope.mode };
	var objectChangeEvent = { type: "objectChange" };

	// Reusable utility variables

	var ray = new THREE.Raycaster();

	var _tempVector = new THREE.Vector3();
	var _tempVector2 = new THREE.Vector3();
	var _tempQuaternion = new THREE.Quaternion();
	var _unit = {
		X: new THREE.Vector3( 1, 0, 0 ),
		Y: new THREE.Vector3( 0, 1, 0 ),
		Z: new THREE.Vector3( 0, 0, 1 )
	};
	var _identityQuaternion = new THREE.Quaternion();
	var _alignVector = new THREE.Vector3();

	var pointStart = new THREE.Vector3();
	var pointEnd = new THREE.Vector3();
	var offset = new THREE.Vector3();
	var rotationAxis = new THREE.Vector3();
	var startNorm = new THREE.Vector3();
	var endNorm = new THREE.Vector3();
	var rotationAngle = 0;

	var cameraPosition = new THREE.Vector3();
	var cameraQuaternion = new THREE.Quaternion();
	var cameraScale = new THREE.Vector3();

	var parentPosition = new THREE.Vector3();
	var parentQuaternion = new THREE.Quaternion();
	var parentQuaternionInv = new THREE.Quaternion();
	var parentScale = new THREE.Vector3();

	var worldPositionStart = new THREE.Vector3();
	var worldQuaternionStart = new THREE.Quaternion();
	var worldScaleStart = new THREE.Vector3();

	var worldPosition = new THREE.Vector3();
	var worldQuaternion = new THREE.Quaternion();
	var worldQuaternionInv = new THREE.Quaternion();
	var worldScale = new THREE.Vector3();

	var eye = new THREE.Vector3();

	var positionStart = new THREE.Vector3();
	var quaternionStart = new THREE.Quaternion();
	var scaleStart = new THREE.Vector3();

	// TODO: remove properties unused in plane and gizmo

	defineProperty( "worldPosition", worldPosition );
	defineProperty( "worldPositionStart", worldPositionStart );
	defineProperty( "worldQuaternion", worldQuaternion );
	defineProperty( "worldQuaternionStart", worldQuaternionStart );
	defineProperty( "cameraPosition", cameraPosition );
	defineProperty( "cameraQuaternion", cameraQuaternion );
	defineProperty( "pointStart", pointStart );
	defineProperty( "pointEnd", pointEnd );
	defineProperty( "rotationAxis", rotationAxis );
	defineProperty( "rotationAngle", rotationAngle );
	defineProperty( "eye", eye );

	{

		domElement.addEventListener( "mousedown", onPointerDown, false );
		domElement.addEventListener( "touchstart", onPointerDown, false );
		domElement.addEventListener( "mousemove", onPointerHover, false );
		domElement.addEventListener( "touchmove", onPointerHover, false );
		domElement.addEventListener( "touchmove", onPointerMove, false );
		document.addEventListener( "mouseup", onPointerUp, false );
		domElement.addEventListener( "touchend", onPointerUp, false );
		domElement.addEventListener( "touchcancel", onPointerUp, false );
		domElement.addEventListener( "touchleave", onPointerUp, false );

	}

	this.dispose = function () {

		domElement.removeEventListener( "mousedown", onPointerDown );
		domElement.removeEventListener( "touchstart", onPointerDown );
		domElement.removeEventListener( "mousemove", onPointerHover );
		domElement.removeEventListener( "touchmove", onPointerHover );
		domElement.removeEventListener( "touchmove", onPointerMove );
		document.removeEventListener( "mouseup", onPointerUp );
		domElement.removeEventListener( "touchend", onPointerUp );
		domElement.removeEventListener( "touchcancel", onPointerUp );
		domElement.removeEventListener( "touchleave", onPointerUp );

	};

	// Set current object
	this.attach = function ( object ) {

		this.object = object;
		this.visible = true;

	};

	// Detatch from object
	this.detach = function () {

		this.object = undefined;
		this.visible = false;
		this.axis = null;

	};

	// Defined getter, setter and store for a property
	function defineProperty( propName, defaultValue ) {

		var propValue = defaultValue;

		Object.defineProperty( scope, propName, {

			get: function() {

				return propValue !== undefined ? propValue : defaultValue;

			},

			set: function( value ) {

				if ( propValue !== value ) {

					propValue = value;
					_plane[ propName ] = value;
					_gizmo[ propName ] = value;

					scope.dispatchEvent( { type: propName + "-changed", value: value } );
					scope.dispatchEvent( changeEvent );

				}

			}

		});

		scope[ propName ] = defaultValue;
		_plane[ propName ] = defaultValue;
		_gizmo[ propName ] = defaultValue;

	}

	// updateMatrixWorld  updates key transformation variables
	this.updateMatrixWorld = function () {

		if ( this.object !== undefined ) {

			this.object.updateMatrixWorld();
			this.object.parent.matrixWorld.decompose( parentPosition, parentQuaternion, parentScale );
			this.object.matrixWorld.decompose( worldPosition, worldQuaternion, worldScale );

			parentQuaternionInv.copy( parentQuaternion ).inverse();
			worldQuaternionInv.copy( worldQuaternion ).inverse();

		}

		this.camera.updateMatrixWorld();
		this.camera.matrixWorld.decompose( cameraPosition, cameraQuaternion, cameraScale );

		if ( this.camera instanceof THREE.PerspectiveCamera ) {

			eye.copy( cameraPosition ).sub( worldPosition ).normalize();

		} else if ( this.camera instanceof THREE.OrthographicCamera ) {

			eye.copy( cameraPosition ).normalize();

		}

		THREE.Object3D.prototype.updateMatrixWorld.call( this );

	};

	this.pointerHover = function( pointer ) {

		if ( this.object === undefined || this.dragging === true || ( pointer.button !== undefined && pointer.button !== 0 ) ) return;

		ray.setFromCamera( pointer, this.camera );

		var intersect = ray.intersectObjects( _gizmo.picker[ this.mode ].children, true )[ 0 ] || false;

		if ( intersect ) {

			this.axis = intersect.object.name;

		} else {

			this.axis = null;

		}

	};

	this.pointerDown = function( pointer ) {

		if ( this.object === undefined || this.dragging === true || ( pointer.button !== undefined && pointer.button !== 0 ) ) return;

		if ( ( pointer.button === 0 || pointer.button === undefined ) && this.axis !== null ) {

			ray.setFromCamera( pointer, this.camera );

			var planeIntersect = ray.intersectObjects( [ _plane ], true )[ 0 ] || false;

			if ( planeIntersect ) {

				var space = this.space;

				if ( this.mode === 'scale') {

					space = 'local';

				} else if ( this.axis === 'E' ||  this.axis === 'XYZE' ||  this.axis === 'XYZ' ) {

					space = 'world';

				}

				if ( space === 'local' && this.mode === 'rotate' ) {

					var snap = this.rotationSnap;

					if ( this.axis === 'X' && snap ) this.object.rotation.x = Math.round( this.object.rotation.x / snap ) * snap;
					if ( this.axis === 'Y' && snap ) this.object.rotation.y = Math.round( this.object.rotation.y / snap ) * snap;
					if ( this.axis === 'Z' && snap ) this.object.rotation.z = Math.round( this.object.rotation.z / snap ) * snap;

				}

				this.object.updateMatrixWorld();
				this.object.parent.updateMatrixWorld();

				positionStart.copy( this.object.position );
				quaternionStart.copy( this.object.quaternion );
				scaleStart.copy( this.object.scale );

				this.object.matrixWorld.decompose( worldPositionStart, worldQuaternionStart, worldScaleStart );

				pointStart.copy( planeIntersect.point ).sub( worldPositionStart );

			}

			this.dragging = true;
			mouseDownEvent.mode = this.mode;
			this.dispatchEvent( mouseDownEvent );

		}

	};

	this.pointerMove = function( pointer ) {

		var axis = this.axis;
		var mode = this.mode;
		var object = this.object;
		var space = this.space;

		if ( mode === 'scale') {

			space = 'local';

		} else if ( axis === 'E' ||  axis === 'XYZE' ||  axis === 'XYZ' ) {

			space = 'world';

		}

		if ( object === undefined || axis === null || this.dragging === false || ( pointer.button !== undefined && pointer.button !== 0 ) ) return;

		ray.setFromCamera( pointer, this.camera );

		var planeIntersect = ray.intersectObjects( [ _plane ], true )[ 0 ] || false;

		if ( planeIntersect === false ) return;

		pointEnd.copy( planeIntersect.point ).sub( worldPositionStart );

		if ( mode === 'translate' ) {

			// Apply translate

			offset.copy( pointEnd ).sub( pointStart );

			if ( space === 'local' && axis !== 'XYZ' ) {
				offset.applyQuaternion( worldQuaternionInv );
			}

			if ( axis.indexOf( 'X' ) === -1 ) offset.x = 0;
			if ( axis.indexOf( 'Y' ) === -1 ) offset.y = 0;
			if ( axis.indexOf( 'Z' ) === -1 ) offset.z = 0;

			if ( space === 'local' && axis !== 'XYZ') {
				offset.applyQuaternion( quaternionStart ).divide( parentScale );
			} else {
				offset.applyQuaternion( parentQuaternionInv ).divide( parentScale );
			}

			object.position.copy( offset ).add( positionStart );

			// Apply translation snap

			if ( this.translationSnap ) {

				if ( space === 'local' ) {

					object.position.applyQuaternion(_tempQuaternion.copy( quaternionStart ).inverse() );

					if ( axis.search( 'X' ) !== -1 ) {
						object.position.x = Math.round( object.position.x / this.translationSnap ) * this.translationSnap;
					}

					if ( axis.search( 'Y' ) !== -1 ) {
						object.position.y = Math.round( object.position.y / this.translationSnap ) * this.translationSnap;
					}

					if ( axis.search( 'Z' ) !== -1 ) {
						object.position.z = Math.round( object.position.z / this.translationSnap ) * this.translationSnap;
					}

					object.position.applyQuaternion( quaternionStart );

				}

				if ( space === 'world' ) {

					if ( object.parent ) {
						object.position.add( _tempVector.setFromMatrixPosition( object.parent.matrixWorld ) );
					}

					if ( axis.search( 'X' ) !== -1 ) {
						object.position.x = Math.round( object.position.x / this.translationSnap ) * this.translationSnap;
					}

					if ( axis.search( 'Y' ) !== -1 ) {
						object.position.y = Math.round( object.position.y / this.translationSnap ) * this.translationSnap;
					}

					if ( axis.search( 'Z' ) !== -1 ) {
						object.position.z = Math.round( object.position.z / this.translationSnap ) * this.translationSnap;
					}

					if ( object.parent ) {
						object.position.sub( _tempVector.setFromMatrixPosition( object.parent.matrixWorld ) );
					}

				}

			}

		} else if ( mode === 'scale' ) {

			if ( axis.search( 'XYZ' ) !== -1 ) {

				var d = pointEnd.length() / pointStart.length();

				if ( pointEnd.dot( pointStart ) < 0 ) d *= -1;

				_tempVector2.set( d, d, d );

			} else {

				_tempVector.copy(pointStart);
				_tempVector2.copy(pointEnd);

				_tempVector.applyQuaternion( worldQuaternionInv );
				_tempVector2.applyQuaternion( worldQuaternionInv );

				_tempVector2.divide( _tempVector );

				if ( axis.search( 'X' ) === -1 ) {
					_tempVector2.x = 1;
				}
				if ( axis.search( 'Y' ) === -1 ) {
					_tempVector2.y = 1;
				}
				if ( axis.search( 'Z' ) === -1 ) {
					_tempVector2.z = 1;
				}

			}

			// Apply scale

			object.scale.copy( scaleStart ).multiply( _tempVector2 );

		} else if ( mode === 'rotate' ) {

			offset.copy( pointEnd ).sub( pointStart );

			var ROTATION_SPEED = 20 / worldPosition.distanceTo( _tempVector.setFromMatrixPosition( this.camera.matrixWorld ) );

			if ( axis === 'E' ) {

				rotationAxis.copy( eye );
				rotationAngle = pointEnd.angleTo( pointStart );

				startNorm.copy( pointStart ).normalize();
				endNorm.copy( pointEnd ).normalize();

				rotationAngle *= ( endNorm.cross( startNorm ).dot( eye ) < 0 ? 1 : -1);

			} else if ( axis === 'XYZE' ) {

				rotationAxis.copy( offset ).cross( eye ).normalize(  );
				rotationAngle = offset.dot( _tempVector.copy( rotationAxis ).cross( this.eye ) ) * ROTATION_SPEED;

			} else if ( axis === 'X' || axis === 'Y' || axis === 'Z' ) {

				rotationAxis.copy( _unit[ axis ] );

				_tempVector.copy( _unit[ axis ] );

				if ( space === 'local' ) {
					_tempVector.applyQuaternion( worldQuaternion );
				}

				rotationAngle = offset.dot( _tempVector.cross( eye ).normalize() ) * ROTATION_SPEED;

			}

			// Apply rotation snap

			if ( this.rotationSnap ) rotationAngle = Math.round( rotationAngle / this.rotationSnap ) * this.rotationSnap;

			this.rotationAngle = rotationAngle;

			// Apply rotate
			if ( space === 'local' && axis !== 'E' && axis !== 'XYZE' ) {

				object.quaternion.copy( quaternionStart );
				object.quaternion.multiply( _tempQuaternion.setFromAxisAngle( rotationAxis, rotationAngle ) ).normalize();

			} else {

				rotationAxis.applyQuaternion( parentQuaternionInv );
				object.quaternion.copy( _tempQuaternion.setFromAxisAngle( rotationAxis, rotationAngle ) );
				object.quaternion.multiply( quaternionStart ).normalize();

			}

		}

		this.dispatchEvent( changeEvent );
		this.dispatchEvent( objectChangeEvent );

	};

	this.pointerUp = function( pointer ) {

		if ( pointer.button !== undefined && pointer.button !== 0 ) return;

		if ( this.dragging && ( this.axis !== null ) ) {

			mouseUpEvent.mode = this.mode;
			this.dispatchEvent( mouseUpEvent );

		}

		this.dragging = false;

		if ( pointer.button === undefined ) this.axis = null;

	};

	// normalize mouse / touch pointer and remap {x,y} to view space.

	function getPointer( event ) {

		var pointer = event.changedTouches ? event.changedTouches[ 0 ] : event;

		var rect = domElement.getBoundingClientRect();

		return {
			x: ( pointer.clientX - rect.left ) / rect.width * 2 - 1,
			y: - ( pointer.clientY - rect.top ) / rect.height * 2 + 1,
			button: event.button
		};

	}

	// mouse / touch event handlers

	function onPointerHover( event ) {

		if ( !scope.enabled ) return;

		scope.pointerHover( getPointer( event ) );

	}

	function onPointerDown( event ) {

		if ( !scope.enabled ) return;

		document.addEventListener( "mousemove", onPointerMove, false );

		scope.pointerHover( getPointer( event ) );
		scope.pointerDown( getPointer( event ) );

	}

	function onPointerMove( event ) {

		if ( !scope.enabled ) return;

		scope.pointerMove( getPointer( event ) );

	}

	function onPointerUp( event ) {

		if ( !scope.enabled ) return;

		document.removeEventListener( "mousemove", onPointerMove, false );

		scope.pointerUp( getPointer( event ) );

	}

	// TODO: depricate

	this.getMode = function () {

		return scope.mode;

	};

	this.setMode = function ( mode ) {

		scope.mode = mode;

	};

	this.setTranslationSnap = function ( translationSnap ) {

		scope.translationSnap = translationSnap;

	};

	this.setRotationSnap = function ( rotationSnap ) {

		scope.rotationSnap = rotationSnap;

	};

	this.setSize = function ( size ) {

		scope.size = size;

	};

	this.setSpace = function ( space ) {

		scope.space = space;

	};

	this.update = function () {

		console.warn( 'THREE.TransformControls: update function has been depricated.' );

	};

};

THREE.TransformControls.prototype = Object.assign( Object.create( THREE.Object3D.prototype ), {

  constructor: THREE.TransformControls,

  isTransformControls: true

} );


THREE.TransformControlsGizmo = function () {

	'use strict';

	THREE.Object3D.call( this );

	this.type = 'TransformControlsGizmo';

	// shared materials

	var gizmoMaterial = new THREE.MeshBasicMaterial({
		depthTest: false,
		depthWrite: false,
		transparent: true,
		side: THREE.DoubleSide,
		fog: false
	});

	var gizmoLineMaterial = new THREE.LineBasicMaterial({
		depthTest: false,
		depthWrite: false,
		transparent: true,
		linewidth: 1,
		fog: false
	});

	// Make unique material for each axis/color

	var matInvisible = gizmoMaterial.clone();
	matInvisible.opacity = 0.15;

	var matHelper = gizmoMaterial.clone();
	matHelper.opacity = 0.33;

	var matRed = gizmoMaterial.clone();
	matRed.color.set( 0xff0000 );

	var matGreen = gizmoMaterial.clone();
	matGreen.color.set( 0x00ff00 );

	var matBlue = gizmoMaterial.clone();
	matBlue.color.set( 0x0000ff );

	var matWhiteTransperent = gizmoMaterial.clone();
	matWhiteTransperent.opacity = 0.25;

	var matYellowTransparent = matWhiteTransperent.clone();
	matYellowTransparent.color.set( 0xffff00 );

	var matCyanTransparent = matWhiteTransperent.clone();
	matCyanTransparent.color.set( 0x00ffff );

	var matMagentaTransparent = matWhiteTransperent.clone();
	matMagentaTransparent.color.set( 0xff00ff );

	var matYellow = gizmoMaterial.clone();
	matYellow.color.set( 0xffff00 );

	var matLineRed = gizmoLineMaterial.clone();
	matLineRed.color.set( 0xff0000 );

	var matLineGreen = gizmoLineMaterial.clone();
	matLineGreen.color.set( 0x00ff00 );

	var matLineBlue = gizmoLineMaterial.clone();
	matLineBlue.color.set( 0x0000ff );

	var matLineCyan = gizmoLineMaterial.clone();
	matLineCyan.color.set( 0x00ffff );

	var matLineMagenta = gizmoLineMaterial.clone();
	matLineMagenta.color.set( 0xff00ff );

	var matLineYellow = gizmoLineMaterial.clone();
	matLineYellow.color.set( 0xffff00 );

	var matLineGray = gizmoLineMaterial.clone();
	matLineGray.color.set( 0x787878);

	var matLineYellowTransparent = matLineYellow.clone();
	matLineYellowTransparent.opacity = 0.25;

	// reusable geometry

	var arrowGeometry = new THREE.CylinderBufferGeometry( 0, 0.05, 0.2, 12, 1, false);

	var scaleHandleGeometry = new THREE.BoxBufferGeometry( 0.125, 0.125, 0.125);

	var lineGeometry = new THREE.BufferGeometry( );
	lineGeometry.addAttribute('position', new THREE.Float32BufferAttribute( [ 0, 0, 0,	1, 0, 0 ], 3 ) );

	var CircleGeometry = function( radius, arc ) {

		var geometry = new THREE.BufferGeometry( );
		var vertices = [];

		for ( var i = 0; i <= 64 * arc; ++i ) {

			vertices.push( 0, Math.cos( i / 32 * Math.PI ) * radius, Math.sin( i / 32 * Math.PI ) * radius );

		}

		geometry.addAttribute('position', new THREE.Float32BufferAttribute( vertices, 3 ) );

		return geometry;

	};

	// Special geometry for transform helper. If scaled with position vector it spans from [0,0,0] to position

	var TranslateHelperGeometry = function( radius, arc ) {

		var geometry = new THREE.BufferGeometry()

		geometry.addAttribute('position', new THREE.Float32BufferAttribute( [ 0, 0, 0, 1, 1, 1 ], 3 ) );

		return geometry;

	};

	// Gizmo definitions - custom hierarchy definitions for setupGizmo() function

	var gizmoTranslate = {
		X: [
			[ new THREE.Mesh( arrowGeometry, matRed ), [ 1, 0, 0 ], [ 0, 0, -Math.PI / 2 ], null, 'fwd' ],
			[ new THREE.Mesh( arrowGeometry, matRed ), [ 1, 0, 0 ], [ 0, 0, Math.PI / 2 ], null, 'bwd' ],
			[ new THREE.Line( lineGeometry, matLineRed ) ]
		],
		Y: [
			[ new THREE.Mesh( arrowGeometry, matGreen ), [ 0, 1, 0 ], null, null, 'fwd' ],
			[ new THREE.Mesh( arrowGeometry, matGreen ), [ 0, 1, 0 ], [ Math.PI, 0, 0 ], null, 'bwd' ],
			[ new THREE.Line( lineGeometry, matLineGreen ), null, [ 0, 0, Math.PI / 2 ] ]
		],
		Z: [
			[ new THREE.Mesh( arrowGeometry, matBlue ), [ 0, 0, 1 ], [ Math.PI / 2, 0, 0 ], null, 'fwd' ],
			[ new THREE.Mesh( arrowGeometry, matBlue ), [ 0, 0, 1 ], [ -Math.PI / 2, 0, 0 ], null, 'bwd' ],
			[ new THREE.Line( lineGeometry, matLineBlue ), null, [ 0, -Math.PI / 2, 0 ] ]
		],
		XYZ: [
			[ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.1, 0 ), matWhiteTransperent ), [ 0, 0, 0 ], [ 0, 0, 0 ] ]
		],
		XY: [
			[ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.295, 0.295 ), matYellowTransparent ), [ 0.15, 0.15, 0 ] ],
			[ new THREE.Line( lineGeometry, matLineYellow ), [ 0.18, 0.3, 0 ], null, [ 0.125, 1, 1 ] ],
			[ new THREE.Line( lineGeometry, matLineYellow ), [ 0.3, 0.18, 0 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ] ]
		],
		YZ: [
			[ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.295, 0.295 ), matCyanTransparent ), [ 0, 0.15, 0.15 ], [ 0, Math.PI / 2, 0 ] ],
			[ new THREE.Line( lineGeometry, matLineCyan ), [ 0, 0.18, 0.3 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ] ],
			[ new THREE.Line( lineGeometry, matLineCyan ), [ 0, 0.3, 0.18 ], [ 0, -Math.PI / 2, 0 ], [ 0.125, 1, 1 ] ]
		],
		XZ: [
			[ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.295, 0.295 ), matMagentaTransparent ), [ 0.15, 0, 0.15 ], [ -Math.PI / 2, 0, 0 ] ],
			[ new THREE.Line( lineGeometry, matLineMagenta ), [ 0.18, 0, 0.3 ], null, [ 0.125, 1, 1 ] ],
			[ new THREE.Line( lineGeometry, matLineMagenta ), [ 0.3, 0, 0.18 ], [ 0, -Math.PI / 2, 0 ], [ 0.125, 1, 1 ] ]
		]
	};

	var pickerTranslate = {
		X: [
			[ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 1, 4, 1, false ), matInvisible ), [ 0.6, 0, 0 ], [ 0, 0, -Math.PI / 2 ] ]
		],
		Y: [
			[ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 1, 4, 1, false ), matInvisible ), [ 0, 0.6, 0 ] ]
		],
		Z: [
			[ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 1, 4, 1, false ), matInvisible ), [ 0, 0, 0.6 ], [ Math.PI / 2, 0, 0 ] ]
		],
		XYZ: [
			[ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.2, 0 ), matInvisible ) ]
		],
		XY: [
			[ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.4, 0.4 ), matInvisible ), [ 0.2, 0.2, 0 ] ]
		],
		YZ: [
			[ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.4, 0.4 ), matInvisible ), [ 0, 0.2, 0.2 ], [ 0, Math.PI / 2, 0 ] ]
		],
		XZ: [
			[ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.4, 0.4 ), matInvisible ), [ 0.2, 0, 0.2 ], [ -Math.PI / 2, 0, 0 ] ]
		]
	};

	var helperTranslate = {
		START: [
			[ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.01, 2 ), matHelper ), null, null, null, 'helper' ]
		],
		END: [
			[ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.01, 2 ), matHelper ), null, null, null, 'helper' ]
		],
		DELTA: [
			[ new THREE.Line( TranslateHelperGeometry(), matHelper ), null, null, null, 'helper' ]
		],
		X: [
			[ new THREE.Line( lineGeometry, matHelper.clone() ), [ -1e3, 0, 0 ], null, [ 1e6, 1, 1 ], 'helper' ]
		],
		Y: [
			[ new THREE.Line( lineGeometry, matHelper.clone() ), [ 0, -1e3, 0 ], [ 0, 0, Math.PI / 2 ], [ 1e6, 1, 1 ], 'helper' ]
		],
		Z: [
			[ new THREE.Line( lineGeometry, matHelper.clone() ), [ 0, 0, -1e3 ], [ 0, -Math.PI / 2, 0 ], [ 1e6, 1, 1 ], 'helper' ]
		]
	};

	var gizmoRotate = {
		X: [
			[ new THREE.Line( CircleGeometry( 1, 0.5 ), matLineRed ) ],
			[ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.04, 0 ), matRed ), [ 0, 0, 0.99 ], null, [ 1, 3, 1 ] ],
		],
		Y: [
			[ new THREE.Line( CircleGeometry( 1, 0.5 ), matLineGreen ), null, [ 0, 0, -Math.PI / 2 ] ],
			[ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.04, 0 ), matGreen ), [ 0, 0, 0.99 ], null, [ 3, 1, 1 ] ],
		],
		Z: [
			[ new THREE.Line( CircleGeometry( 1, 0.5 ), matLineBlue ), null, [ 0, Math.PI / 2, 0 ] ],
			[ new THREE.Mesh( new THREE.OctahedronBufferGeometry( 0.04, 0 ), matBlue ), [ 0.99, 0, 0 ], null, [ 1, 3, 1 ] ],
		],
		E: [
			[ new THREE.Line( CircleGeometry( 1.25, 1 ), matLineYellowTransparent ), null, [ 0, Math.PI / 2, 0 ] ],
			[ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ 1.17, 0, 0 ], [ 0, 0, -Math.PI / 2 ], [ 1, 1, 0.001 ]],
			[ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ -1.17, 0, 0 ], [ 0, 0, Math.PI / 2 ], [ 1, 1, 0.001 ]],
			[ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ 0, -1.17, 0 ], [ Math.PI, 0, 0 ], [ 1, 1, 0.001 ]],
			[ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ 0, 1.17, 0 ], [ 0, 0, 0 ], [ 1, 1, 0.001 ]],
		],
		XYZE: [
			[ new THREE.Line( CircleGeometry( 1, 1 ), matLineGray ), null, [ 0, Math.PI / 2, 0 ] ]
		]
	};

	var helperRotate = {
		AXIS: [
			[ new THREE.Line( lineGeometry, matHelper.clone() ), [ -1e3, 0, 0 ], null, [ 1e6, 1, 1 ], 'helper' ]
		]
	};

	var pickerRotate = {
		X: [
			[ new THREE.Mesh( new THREE.TorusBufferGeometry( 1, 0.1, 4, 24 ), matInvisible ), [ 0, 0, 0 ], [ 0, -Math.PI / 2, -Math.PI / 2 ] ],
		],
		Y: [
			[ new THREE.Mesh( new THREE.TorusBufferGeometry( 1, 0.1, 4, 24 ), matInvisible ), [ 0, 0, 0 ], [ Math.PI / 2, 0, 0 ] ],
		],
		Z: [
			[ new THREE.Mesh( new THREE.TorusBufferGeometry( 1, 0.1, 4, 24 ), matInvisible ), [ 0, 0, 0 ], [ 0, 0, -Math.PI / 2 ] ],
		],
		E: [
			[ new THREE.Mesh( new THREE.TorusBufferGeometry( 1.25, 0.1, 2, 24 ), matInvisible ) ]
		],
		XYZE: [
			[ new THREE.Mesh( new THREE.SphereBufferGeometry( 0.7, 10, 8 ), matInvisible ) ]
		]
	};

	var gizmoScale = {
		X: [
			[ new THREE.Mesh( scaleHandleGeometry, matRed ), [ 0.8, 0, 0 ], [ 0, 0, -Math.PI / 2 ] ],
			[ new THREE.Line( lineGeometry, matLineRed ), null, null, [ 0.8, 1, 1 ] ]
		],
		Y: [
			[ new THREE.Mesh( scaleHandleGeometry, matGreen ), [ 0, 0.8, 0 ] ],
			[ new THREE.Line( lineGeometry, matLineGreen ), null, [ 0, 0, Math.PI / 2 ], [ 0.8, 1, 1 ] ]
		],
		Z: [
			[ new THREE.Mesh( scaleHandleGeometry, matBlue ), [ 0, 0, 0.8 ], [ Math.PI / 2, 0, 0 ] ],
			[ new THREE.Line( lineGeometry, matLineBlue ), null, [ 0, -Math.PI / 2, 0 ], [ 0.8, 1, 1 ] ]
		],
		XY: [
			[ new THREE.Mesh( scaleHandleGeometry, matYellowTransparent ), [ 0.85, 0.85, 0 ], null, [ 2, 2, 0.2 ] ],
			[ new THREE.Line( lineGeometry, matLineYellow ), [ 0.855, 0.98, 0 ], null, [ 0.125, 1, 1 ] ],
			[ new THREE.Line( lineGeometry, matLineYellow ), [ 0.98, 0.855, 0 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ] ]
		],
		YZ: [
			[ new THREE.Mesh( scaleHandleGeometry, matCyanTransparent ), [ 0, 0.85, 0.85 ], null, [ 0.2, 2, 2 ] ],
			[ new THREE.Line( lineGeometry, matLineCyan ), [ 0, 0.855, 0.98 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ] ],
			[ new THREE.Line( lineGeometry, matLineCyan ), [ 0, 0.98, 0.855 ], [ 0, -Math.PI / 2, 0 ], [ 0.125, 1, 1 ] ]
		],
		XZ: [
			[ new THREE.Mesh( scaleHandleGeometry, matMagentaTransparent ), [ 0.85, 0, 0.85 ], null, [ 2, 0.2, 2 ] ],
			[ new THREE.Line( lineGeometry, matLineMagenta ), [ 0.855, 0, 0.98 ], null, [ 0.125, 1, 1 ] ],
			[ new THREE.Line( lineGeometry, matLineMagenta ), [ 0.98, 0, 0.855 ], [ 0, -Math.PI / 2, 0 ], [ 0.125, 1, 1 ] ]
		],
		XYZX: [
			[ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.125, 0.125, 0.125 ), matWhiteTransperent ), [ 1.1, 0, 0 ] ],
		],
		XYZY: [
			[ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.125, 0.125, 0.125 ), matWhiteTransperent ), [ 0, 1.1, 0 ] ],
		],
		XYZZ: [
			[ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.125, 0.125, 0.125 ), matWhiteTransperent ), [ 0, 0, 1.1 ] ],
		]
	};

	var pickerScale = {
		X: [
			[ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 0.8, 4, 1, false ), matInvisible ), [ 0.5, 0, 0 ], [ 0, 0, -Math.PI / 2 ] ]
		],
		Y: [
			[ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 0.8, 4, 1, false ), matInvisible ), [ 0, 0.5, 0 ] ]
		],
		Z: [
			[ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 0.8, 4, 1, false ), matInvisible ), [ 0, 0, 0.5 ], [ Math.PI / 2, 0, 0 ] ]
		],
		XY: [
			[ new THREE.Mesh( scaleHandleGeometry, matInvisible ), [ 0.85, 0.85, 0 ], null, [ 3, 3, 0.2 ] ],
		],
		YZ: [
			[ new THREE.Mesh( scaleHandleGeometry, matInvisible ), [ 0, 0.85, 0.85 ], null, [ 0.2, 3, 3 ] ],
		],
		XZ: [
			[ new THREE.Mesh( scaleHandleGeometry, matInvisible ), [ 0.85, 0, 0.85 ], null, [ 3, 0.2, 3 ] ],
		],
		XYZX: [
			[ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.2, 0.2, 0.2 ), matInvisible ), [ 1.1, 0, 0 ] ],
		],
		XYZY: [
			[ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.2, 0.2, 0.2 ), matInvisible ), [ 0, 1.1, 0 ] ],
		],
		XYZZ: [
			[ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.2, 0.2, 0.2 ), matInvisible ), [ 0, 0, 1.1 ] ],
		]
	};

	var helperScale = {
		X: [
			[ new THREE.Line( lineGeometry, matHelper.clone() ), [ -1e3, 0, 0 ], null, [ 1e6, 1, 1 ], 'helper' ]
		],
		Y: [
			[ new THREE.Line( lineGeometry, matHelper.clone() ), [ 0, -1e3, 0 ], [ 0, 0, Math.PI / 2 ], [ 1e6, 1, 1 ], 'helper' ]
		],
		Z: [
			[ new THREE.Line( lineGeometry, matHelper.clone() ), [ 0, 0, -1e3 ], [ 0, -Math.PI / 2, 0 ], [ 1e6, 1, 1 ], 'helper' ]
		]
	};

	// Creates an Object3D with gizmos described in custom hierarchy definition.

	var setupGizmo = function( gizmoMap ) {

		var gizmo = new THREE.Object3D();

		for ( var name in gizmoMap ) {

			for ( var i = gizmoMap[ name ].length; i --; ) {

				var object = gizmoMap[ name ][ i ][ 0 ].clone();
				var position = gizmoMap[ name ][ i ][ 1 ];
				var rotation = gizmoMap[ name ][ i ][ 2 ];
				var scale = gizmoMap[ name ][ i ][ 3 ];
				var tag = gizmoMap[ name ][ i ][ 4 ];

				// name and tag properties are essential for picking and updating logic.
				object.name = name;
				object.tag = tag;

				if (position) {
					object.position.set(position[ 0 ], position[ 1 ], position[ 2 ]);
				}
				if (rotation) {
					object.rotation.set(rotation[ 0 ], rotation[ 1 ], rotation[ 2 ]);
				}
				if (scale) {
					object.scale.set(scale[ 0 ], scale[ 1 ], scale[ 2 ]);
				}

				object.updateMatrix();

				var tempGeometry = object.geometry.clone();
				tempGeometry.applyMatrix(object.matrix);
				object.geometry = tempGeometry;

				object.position.set( 0, 0, 0 );
				object.rotation.set( 0, 0, 0 );
				object.scale.set(1, 1, 1);

				gizmo.add(object);

			}

		}

		return gizmo;

	};

	// Reusable utility variables

	var tempVector = new THREE.Vector3( 0, 0, 0 );
	var tempEuler = new THREE.Euler();
	var alignVector = new THREE.Vector3( 0, 1, 0 );
	var zeroVector = new THREE.Vector3( 0, 0, 0 );
	var lookAtMatrix = new THREE.Matrix4();
	var tempQuaternion = new THREE.Quaternion();
	var tempQuaternion2 = new THREE.Quaternion();
	var identityQuaternion = new THREE.Quaternion();

	var unitX = new THREE.Vector3( 1, 0, 0 );
	var unitY = new THREE.Vector3( 0, 1, 0 );
	var unitZ = new THREE.Vector3( 0, 0, 1 );

	// Gizmo creation

	this.gizmo = {};
	this.picker = {};
	this.helper = {};

	this.add( this.gizmo[ "translate" ] = setupGizmo( gizmoTranslate ) );
	this.add( this.gizmo[ "rotate" ] = setupGizmo( gizmoRotate ) );
	this.add( this.gizmo[ "scale" ] = setupGizmo( gizmoScale ) );
	this.add( this.picker[ "translate" ] = setupGizmo( pickerTranslate ) );
	this.add( this.picker[ "rotate" ] = setupGizmo( pickerRotate ) );
	this.add( this.picker[ "scale" ] = setupGizmo( pickerScale ) );
	this.add( this.helper[ "translate" ] = setupGizmo( helperTranslate ) );
	this.add( this.helper[ "rotate" ] = setupGizmo( helperRotate ) );
	this.add( this.helper[ "scale" ] = setupGizmo( helperScale ) );

	// Pickers should be hidden always

	this.picker[ "translate" ].visible = false;
	this.picker[ "rotate" ].visible = false;
	this.picker[ "scale" ].visible = false;

	// updateMatrixWorld will update transformations and appearance of individual handles

	this.updateMatrixWorld = function () {

		var space = this.space;

		if ( this.mode === 'scale' ) space = 'local'; // scale always oriented to local rotation

		var quaternion = space === "local" ? this.worldQuaternion : identityQuaternion;

		// Show only gizmos for current transform mode

		this.gizmo[ "translate" ].visible = this.mode === "translate";
		this.gizmo[ "rotate" ].visible = this.mode === "rotate";
		this.gizmo[ "scale" ].visible = this.mode === "scale";

		this.helper[ "translate" ].visible = this.mode === "translate";
		this.helper[ "rotate" ].visible = this.mode === "rotate";
		this.helper[ "scale" ].visible = this.mode === "scale";


		var handles = [];
		handles = handles.concat( this.picker[ this.mode ].children );
		handles = handles.concat( this.gizmo[ this.mode ].children );
		handles = handles.concat( this.helper[ this.mode ].children );

		for ( var i = 0; i < handles.length; i++ ) {

			var handle = handles[i];

			// hide aligned to camera

			handle.visible = true;
			handle.rotation.set( 0, 0, 0 );
			handle.position.copy( this.worldPosition );

			var eyeDistance = this.worldPosition.distanceTo( this.cameraPosition);
			handle.scale.set( 1, 1, 1 ).multiplyScalar( eyeDistance * this.size / 7 );

			// TODO: simplify helpers and consider decoupling from gizmo

			if ( handle.tag === 'helper' ) {

				handle.visible = false;

				if ( handle.name === 'AXIS' ) {

					handle.position.copy( this.worldPositionStart );
					handle.visible = !!this.axis;

					if ( this.axis === 'X' ) {

						tempQuaternion.setFromEuler( tempEuler.set( 0, 0, 0 ) );
						handle.quaternion.copy( quaternion ).multiply( tempQuaternion );

						if ( Math.abs( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) ) > 0.9 ) {
							handle.visible = false;
						}

					}

					if ( this.axis === 'Y' ) {

						tempQuaternion.setFromEuler( tempEuler.set( 0, 0, Math.PI / 2 ) );
						handle.quaternion.copy( quaternion ).multiply( tempQuaternion );

						if ( Math.abs( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) ) > 0.9 ) {
							handle.visible = false;
						}

					}

					if ( this.axis === 'Z' ) {

						tempQuaternion.setFromEuler( tempEuler.set( 0, Math.PI / 2, 0 ) );
						handle.quaternion.copy( quaternion ).multiply( tempQuaternion );

						if ( Math.abs( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) ) > 0.9 ) {
							handle.visible = false;
						}

					}

					if ( this.axis === 'XYZE' ) {

						tempQuaternion.setFromEuler( tempEuler.set( 0, Math.PI / 2, 0 ) );
						alignVector.copy( this.rotationAxis );
						handle.quaternion.setFromRotationMatrix( lookAtMatrix.lookAt( zeroVector, alignVector, unitY ) );
						handle.quaternion.multiply( tempQuaternion );
						handle.visible = this.dragging;

					}

					if ( this.axis === 'E' ) {

						handle.visible = false;

					}


				} else if ( handle.name === 'START' ) {

					handle.position.copy( this.worldPositionStart );
					handle.visible = this.dragging;

				} else if ( handle.name === 'END' ) {

					handle.position.copy( this.worldPosition );
					handle.visible = this.dragging;

				} else if ( handle.name === 'DELTA' ) {

					handle.position.copy( this.worldPositionStart );
					handle.quaternion.copy( this.worldQuaternionStart );
					tempVector.set( 1e-10, 1e-10, 1e-10 ).add( this.worldPositionStart ).sub( this.worldPosition ).multiplyScalar( -1 );
					tempVector.applyQuaternion( this.worldQuaternionStart.clone().inverse() );
					handle.scale.copy( tempVector );
					handle.visible = this.dragging;

				} else {

					handle.quaternion.copy( quaternion );

					if ( this.dragging ) {

						handle.position.copy( this.worldPositionStart );

					} else {

						handle.position.copy( this.worldPosition );

					}

					if ( this.axis ) {

						handle.visible = this.axis.search( handle.name ) !== -1;

					}

				}

				// If updating helper, skip rest of the loop
				continue;

			}

			// Align handles to current local or world rotation

			handle.quaternion.copy( quaternion );

			if ( this.mode === 'translate' || this.mode === 'scale' ) {

				// Hide translate and scale axis facing the camera

				var AXIS_HIDE_TRESHOLD = 0.99;
				var PLANE_HIDE_TRESHOLD = 0.2;
				var AXIS_FLIP_TRESHOLD = 0.0;


				if ( handle.name === 'X' || handle.name === 'XYZX' ) {
					if ( Math.abs( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) ) > AXIS_HIDE_TRESHOLD ) {
						handle.scale.set( 1e-10, 1e-10, 1e-10 );
						handle.visible = false;
					}
				}
				if ( handle.name === 'Y' || handle.name === 'XYZY' ) {
					if ( Math.abs( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) ) > AXIS_HIDE_TRESHOLD ) {
						handle.scale.set( 1e-10, 1e-10, 1e-10 );
						handle.visible = false;
					}
				}
				if ( handle.name === 'Z' || handle.name === 'XYZZ' ) {
					if ( Math.abs( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) ) > AXIS_HIDE_TRESHOLD ) {
						handle.scale.set( 1e-10, 1e-10, 1e-10 );
						handle.visible = false;
					}
				}
				if ( handle.name === 'XY' ) {
					if ( Math.abs( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) ) < PLANE_HIDE_TRESHOLD ) {
						handle.scale.set( 1e-10, 1e-10, 1e-10 );
						handle.visible = false;
					}
				}
				if ( handle.name === 'YZ' ) {
					if ( Math.abs( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) ) < PLANE_HIDE_TRESHOLD ) {
						handle.scale.set( 1e-10, 1e-10, 1e-10 );
						handle.visible = false;
					}
				}
				if ( handle.name === 'XZ' ) {
					if ( Math.abs( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) ) < PLANE_HIDE_TRESHOLD ) {
						handle.scale.set( 1e-10, 1e-10, 1e-10 );
						handle.visible = false;
					}
				}

				// Flip translate and scale axis ocluded behind another axis

				if ( handle.name.search( 'X' ) !== -1 ) {
					if ( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) < AXIS_FLIP_TRESHOLD ) {
						if ( handle.tag === 'fwd' ) {
							handle.visible = false;
						} else {
							handle.scale.x *= -1;
						}
					} else if ( handle.tag === 'bwd' ) {
						handle.visible = false;
					}
				}

				if ( handle.name.search( 'Y' ) !== -1 ) {
					if ( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) < AXIS_FLIP_TRESHOLD ) {
						if ( handle.tag === 'fwd' ) {
							handle.visible = false;
						} else {
							handle.scale.y *= -1;
						}
					} else if ( handle.tag === 'bwd' ) {
						handle.visible = false;
					}
				}

				if ( handle.name.search( 'Z' ) !== -1 ) {
					if ( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) < AXIS_FLIP_TRESHOLD ) {
						if ( handle.tag === 'fwd' ) {
							handle.visible = false;
						} else {
							handle.scale.z *= -1;
						}
					} else if ( handle.tag === 'bwd' ) {
						handle.visible = false;
					}
				}

			} else if ( this.mode === 'rotate' ) {

				// Align handles to current local or world rotation

				tempQuaternion2.copy( quaternion );
				alignVector.copy( this.eye ).applyQuaternion( tempQuaternion.copy( quaternion ).inverse() );

				if ( handle.name.search( "E" ) !== - 1 ) {

					handle.quaternion.setFromRotationMatrix( lookAtMatrix.lookAt( this.eye, zeroVector, unitY ) );

				}

				if ( handle.name === 'X' ) {

					tempQuaternion.setFromAxisAngle( unitX, Math.atan2( -alignVector.y, alignVector.z ) );
					tempQuaternion.multiplyQuaternions( tempQuaternion2, tempQuaternion );
					handle.quaternion.copy( tempQuaternion );

				}

				if ( handle.name === 'Y' ) {

					tempQuaternion.setFromAxisAngle( unitY, Math.atan2( alignVector.x, alignVector.z ) );
					tempQuaternion.multiplyQuaternions( tempQuaternion2, tempQuaternion );
					handle.quaternion.copy( tempQuaternion );

				}

				if ( handle.name === 'Z' ) {

					tempQuaternion.setFromAxisAngle( unitZ, Math.atan2( alignVector.y, alignVector.x ) );
					tempQuaternion.multiplyQuaternions( tempQuaternion2, tempQuaternion );
					handle.quaternion.copy( tempQuaternion );

				}

			}

			// Hide disabled axes
			handle.visible = handle.visible && ( handle.name.indexOf( "X" ) === -1 || this.showX );
			handle.visible = handle.visible && ( handle.name.indexOf( "Y" ) === -1 || this.showY );
			handle.visible = handle.visible && ( handle.name.indexOf( "Z" ) === -1 || this.showZ );
			handle.visible = handle.visible && ( handle.name.indexOf( "E" ) === -1 || ( this.showX && this.showY && this.showZ ) );

			// highlight selected axis

			handle.material._opacity = handle.material._opacity || handle.material.opacity;
			handle.material._color = handle.material._color || handle.material.color.clone();

			handle.material.color.copy( handle.material._color );
			handle.material.opacity = handle.material._opacity;

			if ( !this.enabled ) {

				handle.material.opacity *= 0.5;
				handle.material.color.lerp( new THREE.Color( 1, 1, 1 ), 0.5 );

			} else if ( this.axis ) {

				if ( handle.name === this.axis ) {

					handle.material.opacity = 1.0;
					handle.material.color.lerp( new THREE.Color( 1, 1, 1 ), 0.5 );

				} else if ( this.axis.split('').some( function( a ) { return handle.name === a; } ) ) {

					handle.material.opacity = 1.0;
					handle.material.color.lerp( new THREE.Color( 1, 1, 1 ), 0.5 );

				} else {

					handle.material.opacity *= 0.25;
					handle.material.color.lerp( new THREE.Color( 1, 1, 1 ), 0.5 );

				}

			}

		}

		THREE.Object3D.prototype.updateMatrixWorld.call( this );

	};

};

THREE.TransformControlsGizmo.prototype = Object.assign( Object.create( THREE.Object3D.prototype ), {

	constructor: THREE.TransformControlsGizmo,

	isTransformControlsGizmo: true

} );


THREE.TransformControlsPlane = function () {

	'use strict';

	THREE.Mesh.call( this,
		new THREE.PlaneBufferGeometry( 100000, 100000, 2, 2 ),
		new THREE.MeshBasicMaterial( { visible: false, wireframe: true, side: THREE.DoubleSide, transparent: true, opacity: 0.1 } )
	);

	this.type = 'TransformControlsPlane';

	var unitX = new THREE.Vector3( 1, 0, 0 );
	var unitY = new THREE.Vector3( 0, 1, 0 );
	var unitZ = new THREE.Vector3( 0, 0, 1 );

	var tempVector = new THREE.Vector3();
	var dirVector = new THREE.Vector3();
	var alignVector = new THREE.Vector3();
	var tempMatrix = new THREE.Matrix4();
	var identityQuaternion = new THREE.Quaternion();

	this.updateMatrixWorld = function() {

		var space = this.space;

		this.position.copy( this.worldPosition );

		if ( this.mode === 'scale' ) space = 'local'; // scale always oriented to local rotation

		unitX.set( 1, 0, 0 ).applyQuaternion( space === "local" ? this.worldQuaternion : identityQuaternion );
		unitY.set( 0, 1, 0 ).applyQuaternion( space === "local" ? this.worldQuaternion : identityQuaternion );
		unitZ.set( 0, 0, 1 ).applyQuaternion( space === "local" ? this.worldQuaternion : identityQuaternion );

		// Align the plane for current transform mode, axis and space.

		alignVector.copy( unitY );

		switch ( this.mode ) {
			case 'translate':
			case 'scale':
				switch ( this.axis ) {
					case 'X':
						alignVector.copy( this.eye ).cross( unitX );
						dirVector.copy( unitX ).cross( alignVector );
						break;
					case 'Y':
						alignVector.copy( this.eye ).cross( unitY );
						dirVector.copy( unitY ).cross( alignVector );
						break;
					case 'Z':
						alignVector.copy( this.eye ).cross( unitZ );
						dirVector.copy( unitZ ).cross( alignVector );
						break;
					case 'XY':
						dirVector.copy( unitZ );
						break;
					case 'YZ':
						dirVector.copy( unitX );
						break;
					case 'XZ':
						alignVector.copy( unitZ );
						dirVector.copy( unitY );
						break;
					case 'XYZ':
					case 'E':
						dirVector.set( 0, 0, 0 );
						break;
				}
				break;
			case 'rotate':
			default:
				// special case for rotate
				dirVector.set( 0, 0, 0 );
		}

		if ( dirVector.length() === 0 ) {

			// If in rotate mode, make the plane parallel to camera
			this.quaternion.copy( this.cameraQuaternion );

		} else {

			tempMatrix.lookAt( tempVector.set( 0, 0, 0 ), dirVector, alignVector );

			this.quaternion.setFromRotationMatrix( tempMatrix );

		}

		THREE.Object3D.prototype.updateMatrixWorld.call( this );

	};

};

THREE.TransformControlsPlane.prototype = Object.assign( Object.create( THREE.Mesh.prototype ), {

	constructor: THREE.TransformControlsPlane,

	isTransformControlsPlane: true

} );

/**
 * @author Slayvin / http://slayvin.net
 */

THREE.Reflector = function ( geometry, options ) {

	THREE.Mesh.call( this, geometry );

	this.type = 'Reflector';

	var scope = this;

	options = options || {};

	var color = ( options.color !== undefined ) ? new THREE.Color( options.color ) : new THREE.Color( 0x7F7F7F );
	var opacity = ( options.opacity !== undefined ) ? options.opacity : 1.0;
	var textureWidth = options.textureWidth || 512;
	var textureHeight = options.textureHeight || 512;
	var clipBias = options.clipBias || 0;
	var shader = options.shader || THREE.Reflector.ReflectorShader;
	var recursion = options.recursion !== undefined ? options.recursion : 0;

	//

	var reflectorPlane = new THREE.Plane();
	var normal = new THREE.Vector3();
	var reflectorWorldPosition = new THREE.Vector3();
	var cameraWorldPosition = new THREE.Vector3();
	var rotationMatrix = new THREE.Matrix4();
	var lookAtPosition = new THREE.Vector3( 0, 0, - 1 );
	var clipPlane = new THREE.Vector4();
	var viewport = new THREE.Vector4();

	var view = new THREE.Vector3();
	var target = new THREE.Vector3();
	var q = new THREE.Vector4();
	var size = new THREE.Vector2();

	var textureMatrix = new THREE.Matrix4();
	var virtualCamera = new THREE.PerspectiveCamera();

	var parameters = {
		minFilter: THREE.LinearFilter,
		magFilter: THREE.LinearFilter,
		format: THREE.RGBFormat,
		stencilBuffer: false
	};

	var renderTarget = new THREE.WebGLRenderTarget( textureWidth, textureHeight, parameters );

	if ( ! THREE.Math.isPowerOfTwo( textureWidth ) || ! THREE.Math.isPowerOfTwo( textureHeight ) ) {

		renderTarget.texture.generateMipmaps = false;

	}

	var material = new THREE.ShaderMaterial( {
		uniforms: THREE.UniformsUtils.clone( shader.uniforms ),
		fragmentShader: shader.fragmentShader,
		vertexShader: shader.vertexShader,
        transparent: true
	} );

	material.uniforms[ "tDiffuse" ].value = renderTarget.texture;
	material.uniforms[ "color" ].value = color;
	material.uniforms[ "opacity" ].value = opacity;
	material.uniforms[ "textureMatrix" ].value = textureMatrix;

	this.material = material;

	this.onBeforeRender = function ( renderer, scene, camera ) {

		if ( 'recursion' in camera.userData ) {

			if ( camera.userData.recursion === recursion ) return;

			camera.userData.recursion ++;

		}

		reflectorWorldPosition.setFromMatrixPosition( scope.matrixWorld );
		cameraWorldPosition.setFromMatrixPosition( camera.matrixWorld );

		rotationMatrix.extractRotation( scope.matrixWorld );

		normal.set( 0, 0, 1 );
		normal.applyMatrix4( rotationMatrix );

		view.subVectors( reflectorWorldPosition, cameraWorldPosition );

		// Avoid rendering when reflector is facing away

		if ( view.dot( normal ) > 0 ) return;

		view.reflect( normal ).negate();
		view.add( reflectorWorldPosition );

		rotationMatrix.extractRotation( camera.matrixWorld );

		lookAtPosition.set( 0, 0, - 1 );
		lookAtPosition.applyMatrix4( rotationMatrix );
		lookAtPosition.add( cameraWorldPosition );

		target.subVectors( reflectorWorldPosition, lookAtPosition );
		target.reflect( normal ).negate();
		target.add( reflectorWorldPosition );

		virtualCamera.position.copy( view );
		virtualCamera.up.set( 0, 1, 0 );
		virtualCamera.up.applyMatrix4( rotationMatrix );
		virtualCamera.up.reflect( normal );
		virtualCamera.lookAt( target );

		virtualCamera.far = camera.far; // Used in WebGLBackground

		virtualCamera.updateMatrixWorld();
		virtualCamera.projectionMatrix.copy( camera.projectionMatrix );

		virtualCamera.userData.recursion = 0;

		// Update the texture matrix
		textureMatrix.set(
			0.5, 0.0, 0.0, 0.5,
			0.0, 0.5, 0.0, 0.5,
			0.0, 0.0, 0.5, 0.5,
			0.0, 0.0, 0.0, 1.0
		);
		textureMatrix.multiply( virtualCamera.projectionMatrix );
		textureMatrix.multiply( virtualCamera.matrixWorldInverse );
		textureMatrix.multiply( scope.matrixWorld );

		// Now update projection matrix with new clip plane, implementing code from: http://www.terathon.com/code/oblique.html
		// Paper explaining this technique: http://www.terathon.com/lengyel/Lengyel-Oblique.pdf
		reflectorPlane.setFromNormalAndCoplanarPoint( normal, reflectorWorldPosition );
		reflectorPlane.applyMatrix4( virtualCamera.matrixWorldInverse );

		clipPlane.set( reflectorPlane.normal.x, reflectorPlane.normal.y, reflectorPlane.normal.z, reflectorPlane.constant );

		var projectionMatrix = virtualCamera.projectionMatrix;

		q.x = ( Math.sign( clipPlane.x ) + projectionMatrix.elements[ 8 ] ) / projectionMatrix.elements[ 0 ];
		q.y = ( Math.sign( clipPlane.y ) + projectionMatrix.elements[ 9 ] ) / projectionMatrix.elements[ 5 ];
		q.z = - 1.0;
		q.w = ( 1.0 + projectionMatrix.elements[ 10 ] ) / projectionMatrix.elements[ 14 ];

		// Calculate the scaled plane vector
		clipPlane.multiplyScalar( 2.0 / clipPlane.dot( q ) );

		// Replacing the third row of the projection matrix
		projectionMatrix.elements[ 2 ] = clipPlane.x;
		projectionMatrix.elements[ 6 ] = clipPlane.y;
		projectionMatrix.elements[ 10 ] = clipPlane.z + 1.0 - clipBias;
		projectionMatrix.elements[ 14 ] = clipPlane.w;

		// Render

		scope.visible = false;

		var currentRenderTarget = renderer.getRenderTarget();

		var currentVrEnabled = renderer.vr.enabled;
		var currentShadowAutoUpdate = renderer.shadowMap.autoUpdate;

		renderer.vr.enabled = false; // Avoid camera modification and recursion
		renderer.shadowMap.autoUpdate = false; // Avoid re-computing shadows

		renderer.setRenderTarget( renderTarget );
		renderer.clear();
		renderer.render( scene, virtualCamera );

		renderer.vr.enabled = currentVrEnabled;
		renderer.shadowMap.autoUpdate = currentShadowAutoUpdate;

		renderer.setRenderTarget( currentRenderTarget );

		// Restore viewport

		var bounds = camera.bounds;

		if ( bounds !== undefined ) {

			renderer.getSize( size );
			var pixelRatio = renderer.getPixelRatio();

			viewport.x = bounds.x * size.width * pixelRatio;
			viewport.y = bounds.y * size.height * pixelRatio;
			viewport.z = bounds.z * size.width * pixelRatio;
			viewport.w = bounds.w * size.height * pixelRatio;

			renderer.state.viewport( viewport );

		}

		scope.visible = true;

	};

	this.getRenderTarget = function () {

		return renderTarget;

	};

};

THREE.Reflector.prototype = Object.create( THREE.Mesh.prototype );
THREE.Reflector.prototype.constructor = THREE.Reflector;

THREE.Reflector.ReflectorShader = {

	uniforms: {

		'color': {
			type: 'c',
			value: null
		},

        'opacity': {
		    type: 'f',
		    value: null
        },

		'tDiffuse': {
			type: 't',
			value: null
		},

		'textureMatrix': {
			type: 'm4',
			value: null
		}

	},

	vertexShader: [
		'uniform mat4 textureMatrix;',
		'varying vec4 vUv;',

		'void main() {',

		'	vUv = textureMatrix * vec4( position, 1.0 );',

		'	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',

		'}'
	].join( '\n' ),

	fragmentShader: [
		'uniform vec3 color;',
        'uniform float opacity;',
		'uniform sampler2D tDiffuse;',
		'varying vec4 vUv;',

		'float blendOverlay( float base, float blend ) {',

		'	return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );',

		'}',

		'vec3 blendOverlay( vec3 base, vec3 blend ) {',

		'	return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );',

		'}',

		'void main() {',

		'	vec4 base = texture2DProj( tDiffuse, vUv );',
		'	gl_FragColor = vec4( blendOverlay( base.rgb, color ), opacity );',

		'}'
	].join( '\n' )
};

/**
 * @author Mugen87 / https://github.com/Mugen87
 *
 */

THREE.Refractor = function ( geometry, options ) {

	THREE.Mesh.call( this, geometry );

	this.type = 'Refractor';

	var scope = this;

	options = options || {};

	var color = ( options.color !== undefined ) ? new THREE.Color( options.color ) : new THREE.Color( 0x7F7F7F );
	var textureWidth = options.textureWidth || 512;
	var textureHeight = options.textureHeight || 512;
	var clipBias = options.clipBias || 0;
	var shader = options.shader || THREE.Refractor.RefractorShader;

	//

	var virtualCamera = new THREE.PerspectiveCamera();
	virtualCamera.matrixAutoUpdate = false;
	virtualCamera.userData.refractor = true;

	//

	var refractorPlane = new THREE.Plane();
	var textureMatrix = new THREE.Matrix4();

	// render target

	var parameters = {
		minFilter: THREE.LinearFilter,
		magFilter: THREE.LinearFilter,
		format: THREE.RGBFormat,
		stencilBuffer: false
	};

	var renderTarget = new THREE.WebGLRenderTarget( textureWidth, textureHeight, parameters );

	if ( ! THREE.Math.isPowerOfTwo( textureWidth ) || ! THREE.Math.isPowerOfTwo( textureHeight ) ) {

		renderTarget.texture.generateMipmaps = false;

	}

	// material

	this.material = new THREE.ShaderMaterial( {
		uniforms: THREE.UniformsUtils.clone( shader.uniforms ),
		vertexShader: shader.vertexShader,
		fragmentShader: shader.fragmentShader,
		transparent: true // ensures, refractors are drawn from farthest to closest
	} );

	this.material.uniforms[ "color" ].value = color;
	this.material.uniforms[ "tDiffuse" ].value = renderTarget.texture;
	this.material.uniforms[ "textureMatrix" ].value = textureMatrix;

	// functions

	var visible = ( function () {

		var refractorWorldPosition = new THREE.Vector3();
		var cameraWorldPosition = new THREE.Vector3();
		var rotationMatrix = new THREE.Matrix4();

		var view = new THREE.Vector3();
		var normal = new THREE.Vector3();

		return function visible( camera ) {

			refractorWorldPosition.setFromMatrixPosition( scope.matrixWorld );
			cameraWorldPosition.setFromMatrixPosition( camera.matrixWorld );

			view.subVectors( refractorWorldPosition, cameraWorldPosition );

			rotationMatrix.extractRotation( scope.matrixWorld );

			normal.set( 0, 0, 1 );
			normal.applyMatrix4( rotationMatrix );

			return view.dot( normal ) < 0;

		};

	} )();

	var updateRefractorPlane = ( function () {

		var normal = new THREE.Vector3();
		var position = new THREE.Vector3();
		var quaternion = new THREE.Quaternion();
		var scale = new THREE.Vector3();

		return function updateRefractorPlane() {

			scope.matrixWorld.decompose( position, quaternion, scale );
			normal.set( 0, 0, 1 ).applyQuaternion( quaternion ).normalize();

			// flip the normal because we want to cull everything above the plane

			normal.negate();

			refractorPlane.setFromNormalAndCoplanarPoint( normal, position );

		};

	} )();

	var updateVirtualCamera = ( function () {

		var clipPlane = new THREE.Plane();
		var clipVector = new THREE.Vector4();
		var q = new THREE.Vector4();

		return function updateVirtualCamera( camera ) {

			virtualCamera.matrixWorld.copy( camera.matrixWorld );
			virtualCamera.matrixWorldInverse.getInverse( virtualCamera.matrixWorld );
			virtualCamera.projectionMatrix.copy( camera.projectionMatrix );
			virtualCamera.far = camera.far; // used in WebGLBackground

			// The following code creates an oblique view frustum for clipping.
			// see: Lengyel, Eric. “Oblique View Frustum Depth Projection and Clipping”.
			// Journal of Game Development, Vol. 1, No. 2 (2005), Charles River Media, pp. 5–16

			clipPlane.copy( refractorPlane );
			clipPlane.applyMatrix4( virtualCamera.matrixWorldInverse );

			clipVector.set( clipPlane.normal.x, clipPlane.normal.y, clipPlane.normal.z, clipPlane.constant );

			// calculate the clip-space corner point opposite the clipping plane and
			// transform it into camera space by multiplying it by the inverse of the projection matrix

			var projectionMatrix = virtualCamera.projectionMatrix;

			q.x = ( Math.sign( clipVector.x ) + projectionMatrix.elements[ 8 ] ) / projectionMatrix.elements[ 0 ];
			q.y = ( Math.sign( clipVector.y ) + projectionMatrix.elements[ 9 ] ) / projectionMatrix.elements[ 5 ];
			q.z = - 1.0;
			q.w = ( 1.0 + projectionMatrix.elements[ 10 ] ) / projectionMatrix.elements[ 14 ];

			// calculate the scaled plane vector

			clipVector.multiplyScalar( 2.0 / clipVector.dot( q ) );

			// replacing the third row of the projection matrix

			projectionMatrix.elements[ 2 ] = clipVector.x;
			projectionMatrix.elements[ 6 ] = clipVector.y;
			projectionMatrix.elements[ 10 ] = clipVector.z + 1.0 - clipBias;
			projectionMatrix.elements[ 14 ] = clipVector.w;

		};

	} )();

	// This will update the texture matrix that is used for projective texture mapping in the shader.
	// see: http://developer.download.nvidia.com/assets/gamedev/docs/projective_texture_mapping.pdf

	function updateTextureMatrix( camera ) {

		// this matrix does range mapping to [ 0, 1 ]

		textureMatrix.set(
			0.5, 0.0, 0.0, 0.5,
			0.0, 0.5, 0.0, 0.5,
			0.0, 0.0, 0.5, 0.5,
			0.0, 0.0, 0.0, 1.0
		);

		// we use "Object Linear Texgen", so we need to multiply the texture matrix T
		// (matrix above) with the projection and view matrix of the virtual camera
		// and the model matrix of the refractor

		textureMatrix.multiply( camera.projectionMatrix );
		textureMatrix.multiply( camera.matrixWorldInverse );
		textureMatrix.multiply( scope.matrixWorld );

	}

	//

	var render = ( function () {

		var viewport = new THREE.Vector4();
		var size = new THREE.Vector2();

		return function render( renderer, scene, camera ) {

			scope.visible = false;

			var currentRenderTarget = renderer.getRenderTarget();
			var currentVrEnabled = renderer.vr.enabled;
			var currentShadowAutoUpdate = renderer.shadowMap.autoUpdate;

			renderer.vr.enabled = false; // avoid camera modification
			renderer.shadowMap.autoUpdate = false; // avoid re-computing shadows

			renderer.setRenderTarget( renderTarget );
			renderer.clear();
			renderer.render( scene, virtualCamera );

			renderer.vr.enabled = currentVrEnabled;
			renderer.shadowMap.autoUpdate = currentShadowAutoUpdate;
			renderer.setRenderTarget( currentRenderTarget );

			// restore viewport

			var bounds = camera.bounds;

			if ( bounds !== undefined ) {

				renderer.getSize( size );
				var pixelRatio = renderer.getPixelRatio();

				viewport.x = bounds.x * size.width * pixelRatio;
				viewport.y = bounds.y * size.height * pixelRatio;
				viewport.z = bounds.z * size.width * pixelRatio;
				viewport.w = bounds.w * size.height * pixelRatio;

				renderer.state.viewport( viewport );

			}

			scope.visible = true;

		};

	} )();

	//

	this.onBeforeRender = function ( renderer, scene, camera ) {

		// ensure refractors are rendered only once per frame

		if ( camera.userData.refractor === true ) return;

		// avoid rendering when the refractor is viewed from behind

		if ( ! visible( camera ) === true ) return;

		// update

		updateRefractorPlane();

		updateTextureMatrix( camera );

		updateVirtualCamera( camera );

		render( renderer, scene, camera );

	};

	this.getRenderTarget = function () {

		return renderTarget;

	};

};

THREE.Refractor.prototype = Object.create( THREE.Mesh.prototype );
THREE.Refractor.prototype.constructor = THREE.Refractor;

THREE.Refractor.RefractorShader = {

	uniforms: {

		'color': {
			type: 'c',
			value: null
		},

		'tDiffuse': {
			type: 't',
			value: null
		},

		'textureMatrix': {
			type: 'm4',
			value: null
		}

	},

	vertexShader: [

		'uniform mat4 textureMatrix;',

		'varying vec4 vUv;',

		'void main() {',

		'	vUv = textureMatrix * vec4( position, 1.0 );',

		'	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',

		'}'

	].join( '\n' ),

	fragmentShader: [

		'uniform vec3 color;',
		'uniform sampler2D tDiffuse;',

		'varying vec4 vUv;',

		'float blendOverlay( float base, float blend ) {',

		'	return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );',

		'}',

		'vec3 blendOverlay( vec3 base, vec3 blend ) {',

		'	return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );',

		'}',

		'void main() {',

		'	vec4 base = texture2DProj( tDiffuse, vUv );',

		'	gl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );',

		'}'

	].join( '\n' )
};

/**
 * @author Mugen87 / https://github.com/Mugen87
 *
 * References:
 *	http://www.valvesoftware.com/publications/2010/siggraph2010_vlachos_waterflow.pdf
 * 	http://graphicsrunner.blogspot.de/2010/08/water-using-flow-maps.html
 *
 */

THREE.Water = function ( geometry, options ) {

	THREE.Mesh.call( this, geometry );

	this.type = 'Water';

	var scope = this;

	options = options || {};

	var color = ( options.color !== undefined ) ? new THREE.Color( options.color ) : new THREE.Color( 0xFFFFFF );
	var textureWidth = options.textureWidth || 512;
	var textureHeight = options.textureHeight || 512;
	var clipBias = options.clipBias || 0;
	var flowDirection = options.flowDirection || new THREE.Vector2( 1, 0 );
	var flowSpeed = options.flowSpeed || 0.03;
	var reflectivity = options.reflectivity || 0.02;
	var scale = options.scale || 1;
	var shader = options.shader || THREE.Water.WaterShader;

	var textureLoader = new THREE.TextureLoader();

	var flowMap = options.flowMap || undefined;
	var normalMap0 = options.normalMap0 || textureLoader.load( 'textures/water/Water_1_M_Normal.jpg' );
	var normalMap1 = options.normalMap1 || textureLoader.load( 'textures/water/Water_2_M_Normal.jpg' );

	var cycle = 0.15; // a cycle of a flow map phase
	var halfCycle = cycle * 0.5;
	var textureMatrix = new THREE.Matrix4();
	var clock = new THREE.Clock();

	// internal components

	if ( THREE.Reflector === undefined ) {

		console.error( 'THREE.Water: Required component THREE.Reflector not found.' );
		return;

	}

	if ( THREE.Refractor === undefined ) {

		console.error( 'THREE.Water: Required component THREE.Refractor not found.' );
		return;

	}

	var reflector = new THREE.Reflector( geometry, {
		textureWidth: textureWidth,
		textureHeight: textureHeight,
		clipBias: clipBias
	} );

	var refractor = new THREE.Refractor( geometry, {
		textureWidth: textureWidth,
		textureHeight: textureHeight,
		clipBias: clipBias
	} );

	reflector.matrixAutoUpdate = false;
	refractor.matrixAutoUpdate = false;

	// material

	this.material = new THREE.ShaderMaterial( {
		uniforms: THREE.UniformsUtils.merge( [
			THREE.UniformsLib[ 'fog' ],
			shader.uniforms
		] ),
		vertexShader: shader.vertexShader,
		fragmentShader: shader.fragmentShader,
		transparent: true,
		fog: true
	} );

	if ( flowMap !== undefined ) {

		this.material.defines.USE_FLOWMAP = '';
		this.material.uniforms[ "tFlowMap" ] = {
			type: 't',
			value: flowMap
		};

	} else {

		this.material.uniforms[ "flowDirection" ] = {
			type: 'v2',
			value: flowDirection
		};

	}

	// maps

	normalMap0.wrapS = normalMap0.wrapT = THREE.RepeatWrapping;
	normalMap1.wrapS = normalMap1.wrapT = THREE.RepeatWrapping;

	this.material.uniforms[ "tReflectionMap" ].value = reflector.getRenderTarget().texture;
	this.material.uniforms[ "tRefractionMap" ].value = refractor.getRenderTarget().texture;
	this.material.uniforms[ "tNormalMap0" ].value = normalMap0;
	this.material.uniforms[ "tNormalMap1" ].value = normalMap1;

	// water

	this.material.uniforms[ "color" ].value = color;
	this.material.uniforms[ "reflectivity" ].value = reflectivity;
	this.material.uniforms[ "textureMatrix" ].value = textureMatrix;

	// inital values

	this.material.uniforms[ "config" ].value.x = 0; // flowMapOffset0
	this.material.uniforms[ "config" ].value.y = halfCycle; // flowMapOffset1
	this.material.uniforms[ "config" ].value.z = halfCycle; // halfCycle
	this.material.uniforms[ "config" ].value.w = scale; // scale

	// functions

	function updateTextureMatrix( camera ) {

		textureMatrix.set(
			0.5, 0.0, 0.0, 0.5,
			0.0, 0.5, 0.0, 0.5,
			0.0, 0.0, 0.5, 0.5,
			0.0, 0.0, 0.0, 1.0
		);

		textureMatrix.multiply( camera.projectionMatrix );
		textureMatrix.multiply( camera.matrixWorldInverse );
		textureMatrix.multiply( scope.matrixWorld );

	}

	function updateFlow() {

		var delta = clock.getDelta();
		var config = scope.material.uniforms[ "config" ];

		config.value.x += flowSpeed * delta; // flowMapOffset0
		config.value.y = config.value.x + halfCycle; // flowMapOffset1

		// Important: The distance between offsets should be always the value of "halfCycle".
		// Moreover, both offsets should be in the range of [ 0, cycle ].
		// This approach ensures a smooth water flow and avoids "reset" effects.

		if ( config.value.x >= cycle ) {

			config.value.x = 0;
			config.value.y = halfCycle;

		} else if ( config.value.y >= cycle ) {

			config.value.y = config.value.y - cycle;

		}

	}

	//

	this.onBeforeRender = function ( renderer, scene, camera ) {

		updateTextureMatrix( camera );
		updateFlow();

		scope.visible = false;

		reflector.matrixWorld.copy( scope.matrixWorld );
		refractor.matrixWorld.copy( scope.matrixWorld );

		reflector.onBeforeRender( renderer, scene, camera );
		refractor.onBeforeRender( renderer, scene, camera );

		scope.visible = true;

	};

};

THREE.Water.prototype = Object.create( THREE.Mesh.prototype );
THREE.Water.prototype.constructor = THREE.Water;

THREE.Water.WaterShader = {

	uniforms: {

		'color': {
			type: 'c',
			value: null
		},

		'reflectivity': {
			type: 'f',
			value: 0
		},

		'tReflectionMap': {
			type: 't',
			value: null
		},

		'tRefractionMap': {
			type: 't',
			value: null
		},

		'tNormalMap0': {
			type: 't',
			value: null
		},

		'tNormalMap1': {
			type: 't',
			value: null
		},

		'textureMatrix': {
			type: 'm4',
			value: null
		},

		'config': {
			type: 'v4',
			value: new THREE.Vector4()
		}

	},

	vertexShader: [

		'#include <fog_pars_vertex>',

		'uniform mat4 textureMatrix;',

		'varying vec4 vCoord;',
		'varying vec2 vUv;',
		'varying vec3 vToEye;',

		'void main() {',

		'	vUv = uv;',
		'	vCoord = textureMatrix * vec4( position, 1.0 );',

		'	vec4 worldPosition = modelMatrix * vec4( position, 1.0 );',
		'	vToEye = cameraPosition - worldPosition.xyz;',

		'	vec4 mvPosition =  viewMatrix * worldPosition;', // used in fog_vertex
		'	gl_Position = projectionMatrix * mvPosition;',

		'	#include <fog_vertex>',

		'}'

	].join( '\n' ),

	fragmentShader: [

		'#include <common>',
		'#include <fog_pars_fragment>',

		'uniform sampler2D tReflectionMap;',
		'uniform sampler2D tRefractionMap;',
		'uniform sampler2D tNormalMap0;',
		'uniform sampler2D tNormalMap1;',

		'#ifdef USE_FLOWMAP',
		'	uniform sampler2D tFlowMap;',
		'#else',
		'	uniform vec2 flowDirection;',
		'#endif',

		'uniform vec3 color;',
		'uniform float reflectivity;',
		'uniform vec4 config;',

		'varying vec4 vCoord;',
		'varying vec2 vUv;',
		'varying vec3 vToEye;',

		'void main() {',

		'	float flowMapOffset0 = config.x;',
		'	float flowMapOffset1 = config.y;',
		'	float halfCycle = config.z;',
		'	float scale = config.w;',

		'	vec3 toEye = normalize( vToEye );',

		// determine flow direction
		'	vec2 flow;',
		'	#ifdef USE_FLOWMAP',
		'		flow = texture2D( tFlowMap, vUv ).rg * 2.0 - 1.0;',
		'	#else',
		'		flow = flowDirection;',
		'	#endif',
		'	flow.x *= - 1.0;',

		// sample normal maps (distort uvs with flowdata)
		'	vec4 normalColor0 = texture2D( tNormalMap0, ( vUv * scale ) + flow * flowMapOffset0 );',
		'	vec4 normalColor1 = texture2D( tNormalMap1, ( vUv * scale ) + flow * flowMapOffset1 );',

		// linear interpolate to get the final normal color
		'	float flowLerp = abs( halfCycle - flowMapOffset0 ) / halfCycle;',
		'	vec4 normalColor = mix( normalColor0, normalColor1, flowLerp );',

		// calculate normal vector
		'	vec3 normal = normalize( vec3( normalColor.r * 2.0 - 1.0, normalColor.b,  normalColor.g * 2.0 - 1.0 ) );',

		// calculate the fresnel term to blend reflection and refraction maps
		'	float theta = max( dot( toEye, normal ), 0.0 );',
		'	float reflectance = reflectivity + ( 1.0 - reflectivity ) * pow( ( 1.0 - theta ), 5.0 );',

		// calculate final uv coords
		'	vec3 coord = vCoord.xyz / vCoord.w;',
		'	vec2 uv = coord.xy + coord.z * normal.xz * 0.05;',

		'	vec4 reflectColor = texture2D( tReflectionMap, vec2( 1.0 - uv.x, uv.y ) );',
		'	vec4 refractColor = texture2D( tRefractionMap, uv );',

		// multiply water color with the mix of both textures
		'	gl_FragColor = vec4( color, 1.0 ) * mix( refractColor, reflectColor, reflectance );',

		'	#include <tonemapping_fragment>',
		'	#include <encodings_fragment>',
		'	#include <fog_fragment>',

		'}'

	].join( '\n' )
};

/**
 * Uniforms library for RectAreaLight shared webgl shaders
 * @author abelnation
 * @author WestLangley / http://github.com/WestLangley
 *
 * NOTE: This is a temporary location for the BRDF approximation texture data
 *       based off of Eric Heitz's work (see citation below).  BRDF data for
 *       RectAreaLight is currently approximated using a precomputed texture
 *       of roughly 80kb in size.  The hope is to find a better way to include
 *       the large texture data before including the full RectAreaLight implementation
 *       in the main build files.
 *
 * TODO: figure out a way to compress the LTC BRDF data
 */

// Real-Time Polygonal-Light Shading with Linearly Transformed Cosines
// by Eric Heitz, Jonathan Dupuy, Stephen Hill and David Neubelt
// code: https://github.com/selfshadow/ltc_code/

( function () {

	// source: https://github.com/selfshadow/ltc_code/tree/master/fit/results/ltc.js

	var LTC_MAT_1 = [ 1, 0, 0, 2e-05, 1, 0, 0, 0.000503905, 1, 0, 0, 0.00201562, 1, 0, 0, 0.00453516, 1, 0, 0, 0.00806253, 1, 0, 0, 0.0125978, 1, 0, 0, 0.018141, 1, 0, 0, 0.0246924, 1, 0, 0, 0.0322525, 1, 0, 0, 0.0408213, 1, 0, 0, 0.0503999, 1, 0, 0, 0.0609894, 1, 0, 0, 0.0725906, 1, 0, 0, 0.0852058, 1, 0, 0, 0.0988363, 1, 0, 0, 0.113484, 1, 0, 0, 0.129153, 1, 0, 0, 0.145839, 1, 0, 0, 0.163548, 1, 0, 0, 0.182266, 1, 0, 0, 0.201942, 1, 0, 0, 0.222314, 1, 0, 0, 0.241906, 1, 0, 0, 0.262314, 1, 0, 0, 0.285754, 1, 0, 0, 0.310159, 1, 0, 0, 0.335426, 1, 0, 0, 0.361341, 1, 0, 0, 0.387445, 1, 0, 0, 0.412784, 1, 0, 0, 0.438197, 1, 0, 0, 0.466966, 1, 0, 0, 0.49559, 1, 0, 0, 0.523448, 1, 0, 0, 0.549938, 1, 0, 0, 0.57979, 1, 0, 0, 0.608746, 1, 0, 0, 0.636185, 1, 0, 0, 0.664748, 1, 0, 0, 0.69313, 1, 0, 0, 0.71966, 1, 0, 0, 0.747662, 1, 0, 0, 0.774023, 1, 0, 0, 0.799775, 1, 0, 0, 0.825274, 1, 0, 0, 0.849156, 1, 0, 0, 0.873248, 1, 0, 0, 0.89532, 1, 0, 0, 0.917565, 1, 0, 0, 0.937863, 1, 0, 0, 0.958139, 1, 0, 0, 0.976563, 1, 0, 0, 0.994658, 1, 0, 0, 1.0112, 1, 0, 0, 1.02712, 1, 0, 0, 1.04189, 1, 0, 0, 1.05568, 1, 0, 0, 1.06877, 1, 0, 0, 1.08058, 1, 0, 0, 1.09194, 1, 0, 0, 1.10191, 1, 0, 0, 1.11161, 1, 0, 0, 1.1199, 1, 0, 0, 1.12813, 0.999547, -4.48815e-07, 0.0224417, 1.99902e-05, 0.999495, -1.13079e-05, 0.0224406, 0.000503651, 0.999496, -4.52317e-05, 0.0224406, 0.00201461, 0.999496, -0.000101772, 0.0224406, 0.00453287, 0.999495, -0.000180928, 0.0224406, 0.00805845, 0.999497, -0.000282702, 0.0224406, 0.0125914, 0.999496, -0.000407096, 0.0224406, 0.0181319, 0.999498, -0.000554114, 0.0224406, 0.02468, 0.999499, -0.000723768, 0.0224406, 0.0322363, 0.999495, -0.000916058, 0.0224405, 0.0408009, 0.999499, -0.00113101, 0.0224408, 0.050375, 0.999494, -0.00136863, 0.0224405, 0.0609586, 0.999489, -0.00162896, 0.0224401, 0.0725537, 0.999489, -0.00191201, 0.0224414, 0.0851619, 0.999498, -0.00221787, 0.0224413, 0.0987867, 0.999492, -0.00254642, 0.0224409, 0.113426, 0.999507, -0.00289779, 0.0224417, 0.129088, 0.999494, -0.0032716, 0.0224386, 0.145767, 0.999546, -0.0036673, 0.0224424, 0.163472, 0.999543, -0.00408166, 0.0224387, 0.182182, 0.999499, -0.00450056, 0.0224338, 0.201843, 0.999503, -0.00483661, 0.0224203, 0.222198, 0.999546, -0.00452928, 0.022315, 0.241714, 0.999508, -0.00587403, 0.0224329, 0.262184, 0.999509, -0.00638806, 0.0224271, 0.285609, 0.999501, -0.00691028, 0.0224166, 0.309998, 0.999539, -0.00741979, 0.0223989, 0.335262, 0.999454, -0.00786282, 0.0223675, 0.361154, 0.999529, -0.00811928, 0.0222828, 0.387224, 0.999503, -0.00799941, 0.0221063, 0.41252, 0.999561, -0.00952753, 0.0223057, 0.438006, 0.999557, -0.0099134, 0.0222065, 0.466735, 0.999541, -0.0100935, 0.0220402, 0.495332, 0.999562, -0.00996821, 0.0218067, 0.523197, 0.999556, -0.0105031, 0.0217096, 0.550223, 0.999561, -0.0114191, 0.0217215, 0.579498, 0.999588, -0.0111818, 0.0213357, 0.608416, 0.999633, -0.0107725, 0.0208689, 0.635965, 0.999527, -0.0121671, 0.0210149, 0.664476, 0.999508, -0.0116005, 0.020431, 0.692786, 0.999568, -0.0115604, 0.0199791, 0.719709, 0.999671, -0.0121117, 0.0197415, 0.74737, 0.999688, -0.0110769, 0.0188846, 0.773692, 0.99962, -0.0122368, 0.0188452, 0.799534, 0.999823, -0.0110325, 0.0178001, 0.825046, 0.999599, -0.0114923, 0.0174221, 0.849075, 0.999619, -0.0105923, 0.0164345, 0.872999, 0.999613, -0.0105988, 0.0158227, 0.895371, 0.99964, -0.00979861, 0.0148131, 0.917364, 0.99977, -0.00967238, 0.0140721, 0.938002, 0.999726, -0.00869175, 0.0129543, 0.957917, 0.99973, -0.00866872, 0.0122329, 0.976557, 0.999773, -0.00731956, 0.0108958, 0.994459, 0.999811, -0.00756027, 0.0102715, 1.01118, 0.999862, -0.00583732, 0.00878781, 1.02701, 0.999835, -0.00631438, 0.00827529, 1.04186, 0.999871, -0.00450785, 0.00674583, 1.05569, 0.999867, -0.00486079, 0.00621041, 1.06861, 0.999939, -0.00322072, 0.00478301, 1.08064, 0.999918, -0.00318199, 0.00406395, 1.09181, 1.00003, -0.00193348, 0.00280682, 1.10207, 0.999928, -0.00153729, 0.00198741, 1.11152, 0.999933, -0.000623666, 0.000917714, 1.12009, 1, -1.02387e-06, 9.07581e-07, 1.12813, 0.997866, -8.96716e-07, 0.0448334, 1.99584e-05, 0.997987, -2.25945e-05, 0.0448389, 0.000502891, 0.997987, -9.03781e-05, 0.0448388, 0.00201156, 0.997985, -0.000203351, 0.0448388, 0.00452602, 0.997986, -0.000361514, 0.0448388, 0.00804629, 0.997987, -0.00056487, 0.0448389, 0.0125724, 0.997988, -0.000813423, 0.0448389, 0.0181045, 0.997984, -0.00110718, 0.0448387, 0.0246427, 0.997985, -0.00144616, 0.0448388, 0.0321875, 0.997987, -0.00183038, 0.044839, 0.0407392, 0.997983, -0.00225987, 0.0448387, 0.0502986, 0.997991, -0.00273467, 0.0448389, 0.0608667, 0.997984, -0.00325481, 0.0448384, 0.0724444, 0.998002, -0.00382043, 0.044839, 0.0850348, 0.997997, -0.00443145, 0.0448396, 0.0986372, 0.998007, -0.00508796, 0.0448397, 0.113255, 0.998008, -0.00578985, 0.04484, 0.128891, 0.998003, -0.00653683, 0.0448384, 0.145548, 0.997983, -0.00732713, 0.0448358, 0.163221, 0.997985, -0.00815454, 0.0448358, 0.181899, 0.998005, -0.00898985, 0.0448286, 0.201533, 0.998026, -0.00964404, 0.0447934, 0.221821, 0.998055, -0.00922677, 0.044611, 0.241282, 0.99804, -0.0117361, 0.0448245, 0.261791, 0.998048, -0.0127628, 0.0448159, 0.285181, 0.998088, -0.0138055, 0.0447996, 0.30954, 0.998058, -0.0148206, 0.0447669, 0.334751, 0.998099, -0.0156998, 0.044697, 0.36061, 0.998116, -0.0161976, 0.0445122, 0.386603, 0.998195, -0.015945, 0.0441711, 0.411844, 0.998168, -0.0183947, 0.0444255, 0.43773, 0.998184, -0.0197913, 0.0443809, 0.466009, 0.998251, -0.0201426, 0.0440689, 0.494574, 0.998305, -0.0198847, 0.0435632, 0.522405, 0.998273, -0.0210577, 0.043414, 0.549967, 0.998254, -0.0227901, 0.0433943, 0.578655, 0.998349, -0.0223108, 0.0426529, 0.60758, 0.99843, -0.0223088, 0.042, 0.635524, 0.998373, -0.0241141, 0.0418987, 0.663621, 0.998425, -0.0231446, 0.0408118, 0.691906, 0.998504, -0.0233684, 0.0400565, 0.719339, 0.998443, -0.0241652, 0.0394634, 0.74643, 0.99848, -0.0228715, 0.0380002, 0.773086, 0.998569, -0.023519, 0.0372322, 0.798988, 0.998619, -0.0223108, 0.0356468, 0.824249, 0.998594, -0.0223105, 0.034523, 0.848808, 0.998622, -0.0213426, 0.0328887, 0.87227, 0.998669, -0.0207912, 0.0314374, 0.895157, 0.998705, -0.0198416, 0.0296925, 0.916769, 0.998786, -0.0189168, 0.0279634, 0.937773, 0.998888, -0.0178811, 0.0261597, 0.957431, 0.99906, -0.0166845, 0.0242159, 0.976495, 0.999038, -0.0155464, 0.0222638, 0.994169, 0.999237, -0.0141349, 0.0201967, 1.01112, 0.999378, -0.0129324, 0.0181744, 1.02692, 0.999433, -0.0113192, 0.0159898, 1.04174, 0.999439, -0.0101244, 0.0140385, 1.05559, 0.999614, -0.00837456, 0.0117826, 1.06852, 0.999722, -0.00721769, 0.00983745, 1.08069, 0.999817, -0.00554067, 0.00769002, 1.09176, 0.99983, -0.00426961, 0.005782, 1.10211, 0.999964, -0.00273904, 0.00374503, 1.11152, 1.00001, -0.00136739, 0.00187176, 1.12031, 0.999946, 3.93227e-05, -2.8919e-05, 1.12804, 0.995847, -1.3435e-06, 0.0671785, 1.9916e-05, 0.995464, -3.38387e-05, 0.0671527, 0.000501622, 0.99547, -0.000135355, 0.0671531, 0.00200649, 0.995471, -0.00030455, 0.0671532, 0.00451461, 0.99547, -0.000541423, 0.0671531, 0.008026, 0.995471, -0.00084598, 0.0671531, 0.0125407, 0.99547, -0.00121823, 0.0671531, 0.0180589, 0.99547, -0.00165817, 0.0671531, 0.0245806, 0.995463, -0.00216583, 0.0671526, 0.0321062, 0.995468, -0.00274127, 0.0671527, 0.0406366, 0.995474, -0.00338447, 0.0671534, 0.0501717, 0.995473, -0.00409554, 0.0671533, 0.0607131, 0.995478, -0.00487451, 0.0671531, 0.0722618, 0.995476, -0.00572148, 0.0671532, 0.0848191, 0.995477, -0.00663658, 0.0671539, 0.0983882, 0.995498, -0.00761986, 0.0671541, 0.112972, 0.995509, -0.00867094, 0.0671542, 0.128568, 0.995509, -0.00978951, 0.0671531, 0.145183, 0.995503, -0.0109725, 0.0671491, 0.162808, 0.995501, -0.012211, 0.0671465, 0.181441, 0.99553, -0.0134565, 0.0671371, 0.201015, 0.99555, -0.014391, 0.0670831, 0.221206, 0.99558, -0.014351, 0.0668883, 0.240813, 0.995577, -0.0173997, 0.0671055, 0.261257, 0.995602, -0.0191111, 0.0671178, 0.284467, 0.995623, -0.0206705, 0.0670946, 0.308765, 0.995658, -0.022184, 0.0670472, 0.333905, 0.995705, -0.0234832, 0.0669417, 0.359677, 0.995719, -0.0241933, 0.0666714, 0.385554, 0.995786, -0.0243539, 0.066266, 0.410951, 0.995887, -0.0271866, 0.0664367, 0.437163, 0.995944, -0.0296012, 0.0664931, 0.464842, 0.996004, -0.0301045, 0.0660105, 0.49332, 0.996128, -0.0298311, 0.0652694, 0.521131, 0.996253, -0.0316426, 0.0650739, 0.549167, 0.996244, -0.0339043, 0.0649433, 0.57737, 0.996309, -0.033329, 0.0638926, 0.606073, 0.996417, -0.0338935, 0.0630849, 0.634527, 0.996372, -0.0353104, 0.0625083, 0.66256, 0.996542, -0.0348942, 0.0611986, 0.690516, 0.996568, -0.0351614, 0.060069, 0.718317, 0.996711, -0.0354317, 0.0588522, 0.74528, 0.996671, -0.0349513, 0.0571902, 0.772061, 0.996865, -0.0345622, 0.0555321, 0.798089, 0.996802, -0.0342566, 0.0537816, 0.823178, 0.996992, -0.0330862, 0.0516095, 0.847949, 0.996944, -0.0324666, 0.0495537, 0.871431, 0.997146, -0.0309544, 0.0470302, 0.894357, 0.997189, -0.0299372, 0.0446043, 0.916142, 0.997471, -0.0281389, 0.0418812, 0.937193, 0.997515, -0.0268702, 0.0391823, 0.957, 0.997812, -0.0247166, 0.0361338, 0.975936, 0.998027, -0.0233525, 0.0333945, 0.99391, 0.998233, -0.0209839, 0.0301917, 1.01075, 0.998481, -0.0194309, 0.027271, 1.02669, 0.998859, -0.0169728, 0.0240162, 1.04173, 0.99894, -0.0152322, 0.0210517, 1.05551, 0.999132, -0.0127497, 0.0178632, 1.06856, 0.999369, -0.0108282, 0.014787, 1.08054, 0.999549, -0.00845886, 0.0116185, 1.09185, 0.999805, -0.0063937, 0.00867209, 1.10207, 0.99985, -0.00414582, 0.00566823, 1.1117, 0.999912, -0.00207443, 0.00277562, 1.12022, 1.00001, 8.70226e-05, -5.3766e-05, 1.12832, 0.991943, -1.78672e-06, 0.0893382, 1.98384e-05, 0.991952, -4.50183e-05, 0.089339, 0.000499849, 0.991956, -0.000180074, 0.0893394, 0.0019994, 0.991955, -0.000405167, 0.0893393, 0.00449867, 0.991953, -0.000720298, 0.0893391, 0.00799764, 0.991955, -0.00112548, 0.0893393, 0.0124964, 0.991957, -0.0016207, 0.0893395, 0.0179951, 0.991958, -0.00220601, 0.0893396, 0.0244939, 0.991947, -0.00288137, 0.0893385, 0.0319929, 0.991962, -0.00364693, 0.0893399, 0.0404933, 0.991965, -0.00450264, 0.0893399, 0.049995, 0.99198, -0.00544862, 0.0893411, 0.0604995, 0.99197, -0.00648491, 0.0893397, 0.0720074, 0.991976, -0.00761164, 0.089341, 0.0845207, 0.99198, -0.00882891, 0.0893405, 0.0980413, 0.991982, -0.0101367, 0.0893396, 0.112571, 0.992008, -0.011535, 0.0893415, 0.128115, 0.992026, -0.0130228, 0.0893414, 0.144672, 0.992064, -0.0145966, 0.0893418, 0.162241, 0.992041, -0.0162421, 0.0893359, 0.180801, 0.992086, -0.0178888, 0.0893214, 0.200302, 0.992157, -0.0190368, 0.0892401, 0.220332, 0.992181, -0.0195584, 0.0890525, 0.240144, 0.992175, -0.0227257, 0.0892153, 0.260728, 0.99221, -0.0254195, 0.089304, 0.283473, 0.99222, -0.0274883, 0.0892703, 0.307673, 0.992317, -0.0294905, 0.0892027, 0.332729, 0.992374, -0.0311861, 0.0890577, 0.358387, 0.992505, -0.0320656, 0.0886994, 0.384102, 0.992568, -0.0329715, 0.0883198, 0.409767, 0.992675, -0.036006, 0.0883602, 0.436145, 0.992746, -0.0392897, 0.0884591, 0.463217, 0.992873, -0.0399337, 0.0878287, 0.491557, 0.992934, -0.040231, 0.0870108, 0.519516, 0.993091, -0.0422013, 0.0865857, 0.547741, 0.993259, -0.0443503, 0.0861937, 0.575792, 0.993455, -0.0446368, 0.0851187, 0.604233, 0.993497, -0.0454299, 0.0840576, 0.632925, 0.993694, -0.0463296, 0.0829671, 0.660985, 0.993718, -0.0470619, 0.0817185, 0.688714, 0.993973, -0.0468838, 0.0800294, 0.716743, 0.994207, -0.046705, 0.0781286, 0.74377, 0.994168, -0.0469698, 0.0763337, 0.77042, 0.9945, -0.0456816, 0.0738184, 0.796659, 0.994356, -0.0455518, 0.0715545, 0.821868, 0.994747, -0.0439488, 0.0686085, 0.846572, 0.994937, -0.0430056, 0.065869, 0.870435, 0.995142, -0.0413414, 0.0626446, 0.893272, 0.995451, -0.0396521, 0.05929, 0.915376, 0.995445, -0.0378453, 0.0558503, 0.936196, 0.995967, -0.0355219, 0.0520949, 0.956376, 0.996094, -0.0335146, 0.048377, 0.975327, 0.996622, -0.030682, 0.0442575, 0.993471, 0.996938, -0.0285504, 0.0404693, 1.01052, 0.997383, -0.0253399, 0.0360903, 1.02637, 0.997714, -0.0231651, 0.0322176, 1.04139, 0.998249, -0.0198138, 0.0278433, 1.05542, 0.998596, -0.0174337, 0.0238759, 1.06846, 0.998946, -0.0141349, 0.0195944, 1.08056, 0.99928, -0.0115603, 0.0156279, 1.09181, 0.999507, -0.00839065, 0.0114607, 1.10213, 0.999697, -0.005666, 0.00763325, 1.11169, 0.999869, -0.00269902, 0.00364946, 1.12042, 1.00001, 6.23836e-05, -3.19288e-05, 1.12832, 0.987221, -2.22675e-06, 0.111332, 1.97456e-05, 0.98739, -5.61116e-05, 0.111351, 0.000497563, 0.987448, -0.000224453, 0.111357, 0.00199031, 0.987441, -0.000505019, 0.111357, 0.0044782, 0.987442, -0.000897816, 0.111357, 0.00796129, 0.987442, -0.00140284, 0.111357, 0.0124396, 0.987444, -0.00202012, 0.111357, 0.0179132, 0.987442, -0.00274964, 0.111357, 0.0243824, 0.987446, -0.00359147, 0.111357, 0.0318474, 0.987435, -0.00454562, 0.111356, 0.0403086, 0.987461, -0.00561225, 0.111358, 0.0497678, 0.987458, -0.00679125, 0.111358, 0.0602239, 0.987443, -0.0080828, 0.111356, 0.0716792, 0.987476, -0.0094872, 0.111358, 0.0841364, 0.98749, -0.0110044, 0.111361, 0.097597, 0.987508, -0.0126344, 0.111362, 0.112062, 0.987494, -0.0143767, 0.111357, 0.127533, 0.987526, -0.0162307, 0.111359, 0.144015, 0.987558, -0.0181912, 0.111361, 0.161502, 0.987602, -0.0202393, 0.111355, 0.179979, 0.987692, -0.022273, 0.111346, 0.199386, 0.987702, -0.0235306, 0.111215, 0.219183, 0.987789, -0.0247628, 0.111061, 0.239202, 0.987776, -0.0280668, 0.111171, 0.259957, 0.987856, -0.0316751, 0.111327, 0.282198, 0.987912, -0.0342468, 0.111282, 0.306294, 0.988, -0.0367205, 0.111198, 0.331219, 0.988055, -0.0387766, 0.110994, 0.356708, 0.988241, -0.0397722, 0.110547, 0.382234, 0.988399, -0.0416076, 0.110198, 0.408227, 0.988539, -0.0448192, 0.110137, 0.434662, 0.988661, -0.0483793, 0.110143, 0.461442, 0.988967, -0.0495895, 0.109453, 0.489318, 0.989073, -0.0506797, 0.108628, 0.517516, 0.989274, -0.0526953, 0.108003, 0.545844, 0.989528, -0.054578, 0.107255, 0.573823, 0.989709, -0.0561503, 0.106294, 0.601944, 0.989991, -0.056866, 0.104896, 0.630855, 0.990392, -0.0572914, 0.103336, 0.658925, 0.990374, -0.0586224, 0.10189, 0.686661, 0.990747, -0.0584764, 0.099783, 0.714548, 0.991041, -0.0582662, 0.0974309, 0.74186, 0.991236, -0.0584118, 0.0951678, 0.768422, 0.991585, -0.0573055, 0.0921581, 0.794817, 0.991984, -0.0564241, 0.0891167, 0.820336, 0.9921, -0.0553608, 0.085805, 0.84493, 0.992749, -0.0533816, 0.0820354, 0.868961, 0.99288, -0.0518661, 0.0782181, 0.891931, 0.993511, -0.0492492, 0.0738935, 0.914186, 0.993617, -0.0471956, 0.0696402, 0.93532, 0.99411, -0.044216, 0.0649659, 0.95543, 0.994595, -0.0416654, 0.0603177, 0.974685, 0.994976, -0.0384314, 0.0553493, 0.992807, 0.995579, -0.0353491, 0.0503942, 1.00996, 0.996069, -0.0319787, 0.0452123, 1.02606, 0.996718, -0.028472, 0.0400112, 1.04114, 0.997173, -0.0250789, 0.0349456, 1.05517, 0.997818, -0.0213326, 0.029653, 1.0683, 0.998318, -0.0178509, 0.024549, 1.0805, 0.998853, -0.0141118, 0.0194197, 1.09177, 0.999218, -0.0105914, 0.0143869, 1.1022, 0.999594, -0.00693474, 0.00943517, 1.11175, 0.99975, -0.00340478, 0.00464051, 1.12056, 1.00001, 0.000109172, -0.000112821, 1.12853, 0.983383, -2.66524e-06, 0.133358, 1.96534e-05, 0.981942, -6.71009e-05, 0.133162, 0.000494804, 0.981946, -0.000268405, 0.133163, 0.00197923, 0.981944, -0.000603912, 0.133163, 0.00445326, 0.981941, -0.00107362, 0.133162, 0.00791693, 0.981946, -0.00167755, 0.133163, 0.0123703, 0.981944, -0.00241569, 0.133162, 0.0178135, 0.981945, -0.00328807, 0.133163, 0.0242466, 0.981945, -0.00429472, 0.133162, 0.03167, 0.981955, -0.00543573, 0.133164, 0.0400846, 0.981951, -0.00671105, 0.133163, 0.0494901, 0.981968, -0.00812092, 0.133165, 0.0598886, 0.981979, -0.00966541, 0.133166, 0.0712811, 0.981996, -0.0113446, 0.133168, 0.083669, 0.982014, -0.0131585, 0.133169, 0.0970533, 0.982011, -0.0151073, 0.133167, 0.111438, 0.982062, -0.0171906, 0.133172, 0.126826, 0.9821, -0.0194067, 0.133175, 0.143215, 0.982149, -0.0217502, 0.133176, 0.160609, 0.982163, -0.0241945, 0.133173, 0.178981, 0.982247, -0.0265907, 0.133148, 0.198249, 0.982291, -0.027916, 0.132974, 0.217795, 0.982396, -0.0299663, 0.132868, 0.238042, 0.982456, -0.0334544, 0.132934, 0.258901, 0.982499, -0.0378636, 0.133137, 0.280639, 0.982617, -0.0409274, 0.133085, 0.304604, 0.98274, -0.0438523, 0.132985, 0.329376, 0.982944, -0.0462288, 0.132728, 0.354697, 0.98308, -0.0475995, 0.132228, 0.380102, 0.983391, -0.0501901, 0.131924, 0.406256, 0.983514, -0.0535899, 0.131737, 0.432735, 0.98373, -0.0571858, 0.131567, 0.459359, 0.984056, -0.0592353, 0.130932, 0.486637, 0.984234, -0.0610488, 0.130092, 0.51509, 0.984748, -0.0630758, 0.12923, 0.543461, 0.985073, -0.0647398, 0.128174, 0.571376, 0.985195, -0.0671941, 0.127133, 0.599414, 0.985734, -0.0681345, 0.125576, 0.628134, 0.986241, -0.0686089, 0.123639, 0.656399, 0.986356, -0.0698511, 0.121834, 0.684258, 0.986894, -0.0700931, 0.119454, 0.711818, 0.987382, -0.0698321, 0.116718, 0.739511, 0.988109, -0.0693975, 0.113699, 0.766267, 0.988363, -0.0689584, 0.110454, 0.792456, 0.989112, -0.0672353, 0.106602, 0.81813, 0.989241, -0.0662034, 0.10267, 0.842889, 0.990333, -0.0638938, 0.0981381, 0.867204, 0.990591, -0.0618534, 0.0935388, 0.89038, 0.991106, -0.0593117, 0.088553, 0.912576, 0.991919, -0.0562676, 0.0832187, 0.934118, 0.992111, -0.0534085, 0.0778302, 0.954254, 0.992997, -0.0495459, 0.0720453, 0.973722, 0.993317, -0.0463707, 0.0663458, 0.991949, 0.994133, -0.0421245, 0.0601883, 1.00936, 0.994705, -0.0384977, 0.0542501, 1.02559, 0.995495, -0.0340956, 0.0479862, 1.04083, 0.996206, -0.030105, 0.041887, 1.05497, 0.996971, -0.0256095, 0.0355355, 1.06824, 0.997796, -0.0213932, 0.0293655, 1.08056, 0.998272, -0.0169612, 0.0232926, 1.09182, 0.998857, -0.0126756, 0.0172786, 1.10219, 0.99939, -0.00832486, 0.0113156, 1.11192, 0.999752, -0.00410826, 0.00557892, 1.12075, 1, 0.000150957, -0.000119101, 1.12885, 0.975169, -3.09397e-06, 0.154669, 1.95073e-05, 0.975439, -7.79608e-05, 0.154712, 0.000491534, 0.975464, -0.000311847, 0.154716, 0.00196617, 0.975464, -0.000701656, 0.154716, 0.00442387, 0.975462, -0.0012474, 0.154715, 0.0078647, 0.975461, -0.00194906, 0.154715, 0.0122886, 0.975464, -0.00280667, 0.154715, 0.0176959, 0.975468, -0.00382025, 0.154716, 0.0240867, 0.975471, -0.00498985, 0.154716, 0.0314612, 0.975472, -0.00631541, 0.154717, 0.0398199, 0.975486, -0.00779719, 0.154718, 0.0491639, 0.975489, -0.00943505, 0.154718, 0.0594932, 0.975509, -0.0112295, 0.154721, 0.0708113, 0.97554, -0.0131802, 0.154724, 0.0831176, 0.975557, -0.0152876, 0.154726, 0.096415, 0.975585, -0.0175512, 0.154728, 0.110705, 0.975605, -0.0199713, 0.154729, 0.125992, 0.975645, -0.0225447, 0.154729, 0.142272, 0.975711, -0.0252649, 0.154735, 0.159549, 0.975788, -0.0280986, 0.154736, 0.177805, 0.975872, -0.0308232, 0.154704, 0.196911, 0.975968, -0.0324841, 0.154525, 0.216324, 0.976063, -0.0351281, 0.154432, 0.236628, 0.976157, -0.0388618, 0.15446, 0.257539, 0.976204, -0.0437704, 0.154665, 0.278975, 0.976358, -0.047514, 0.154652, 0.302606, 0.976571, -0.0508638, 0.154535, 0.327204, 0.976725, -0.0534995, 0.154221, 0.352276, 0.977013, -0.0555547, 0.153737, 0.377696, 0.977294, -0.0586728, 0.153403, 0.403855, 0.977602, -0.0622715, 0.15312, 0.430333, 0.977932, -0.0658166, 0.152755, 0.456855, 0.978241, -0.0689877, 0.152233, 0.483668, 0.978602, -0.0712805, 0.15132, 0.512097, 0.979234, -0.0732775, 0.150235, 0.540455, 0.97977, -0.075163, 0.148978, 0.568486, 0.979995, -0.0778026, 0.147755, 0.596524, 0.98078, -0.0791854, 0.146019, 0.624825, 0.981628, -0.0799666, 0.143906, 0.653403, 0.982067, -0.0808532, 0.141561, 0.681445, 0.98271, -0.0816024, 0.139025, 0.708918, 0.983734, -0.0812511, 0.135764, 0.736594, 0.98431, -0.0806201, 0.132152, 0.763576, 0.985071, -0.0801605, 0.12846, 0.789797, 0.98618, -0.0784208, 0.124084, 0.815804, 0.986886, -0.0766643, 0.1193, 0.840869, 0.987485, -0.0747744, 0.114236, 0.864952, 0.988431, -0.0716701, 0.108654, 0.888431, 0.988886, -0.0691609, 0.102994, 0.910963, 0.990024, -0.0654048, 0.0967278, 0.932629, 0.990401, -0.0619765, 0.090384, 0.95313, 0.991093, -0.0579296, 0.0837885, 0.972587, 0.992018, -0.0536576, 0.0770171, 0.991184, 0.992536, -0.0493719, 0.0701486, 1.00863, 0.993421, -0.0444813, 0.062953, 1.02494, 0.993928, -0.040008, 0.0560455, 1.04017, 0.994994, -0.0347982, 0.04856, 1.05463, 0.995866, -0.0301017, 0.0416152, 1.06807, 0.996916, -0.0248225, 0.0342597, 1.08039, 0.997766, -0.0199229, 0.0271668, 1.09177, 0.998479, -0.0147422, 0.0201387, 1.10235, 0.99921, -0.00980173, 0.0131944, 1.11206, 0.999652, -0.0047426, 0.00640712, 1.12104, 0.999998, 8.91673e-05, -0.00010379, 1.12906, 0.967868, -3.51885e-06, 0.175947, 1.93569e-05, 0.968001, -8.86733e-05, 0.175972, 0.000487782, 0.96801, -0.000354697, 0.175973, 0.00195115, 0.968012, -0.000798063, 0.175974, 0.00439006, 0.968011, -0.00141879, 0.175973, 0.00780461, 0.968011, -0.00221686, 0.175973, 0.0121948, 0.968016, -0.00319231, 0.175974, 0.0175607, 0.968019, -0.00434515, 0.175974, 0.0239027, 0.968018, -0.00567538, 0.175974, 0.0312208, 0.968033, -0.00718308, 0.175977, 0.0395158, 0.968049, -0.00886836, 0.175979, 0.0487885, 0.968047, -0.0107312, 0.175978, 0.0590394, 0.968072, -0.0127719, 0.175981, 0.0702705, 0.968108, -0.0149905, 0.175986, 0.0824836, 0.968112, -0.0173866, 0.175985, 0.0956783, 0.968173, -0.0199611, 0.175993, 0.109862, 0.96827, -0.0227128, 0.176008, 0.125033, 0.968292, -0.025639, 0.17601, 0.141193, 0.968339, -0.0287299, 0.176007, 0.158336, 0.968389, -0.0319399, 0.176001, 0.176441, 0.968501, -0.034941, 0.175962, 0.195359, 0.968646, -0.0370812, 0.175793, 0.214686, 0.968789, -0.0402329, 0.175708, 0.234973, 0.96886, -0.0442601, 0.1757, 0.255871, 0.969013, -0.049398, 0.175876, 0.277238, 0.969242, -0.0539932, 0.17594, 0.300326, 0.969419, -0.0577299, 0.175781, 0.324702, 0.969763, -0.0605643, 0.175432, 0.349527, 0.970093, -0.0634488, 0.174992, 0.374976, 0.970361, -0.0670589, 0.174611, 0.401097, 0.970825, -0.0708246, 0.174226, 0.427496, 0.971214, -0.0742871, 0.173684, 0.453858, 0.971622, -0.0782608, 0.173186, 0.480637, 0.972175, -0.0813151, 0.172288, 0.508655, 0.972944, -0.0832678, 0.170979, 0.536973, 0.973595, -0.0855964, 0.169573, 0.565138, 0.974345, -0.0882163, 0.168152, 0.593222, 0.975233, -0.0901671, 0.166314, 0.621201, 0.976239, -0.0912111, 0.163931, 0.649919, 0.977289, -0.0916959, 0.161106, 0.678011, 0.978076, -0.0927061, 0.158272, 0.705717, 0.979533, -0.0925562, 0.15475, 0.733228, 0.980335, -0.0918159, 0.150638, 0.760454, 0.981808, -0.0908508, 0.146201, 0.786918, 0.983061, -0.0896172, 0.141386, 0.812953, 0.984148, -0.0871588, 0.135837, 0.838281, 0.985047, -0.0850624, 0.130135, 0.862594, 0.986219, -0.0818541, 0.123882, 0.88633, 0.987043, -0.0784523, 0.117126, 0.908952, 0.988107, -0.0749601, 0.110341, 0.930744, 0.988955, -0.0703548, 0.102885, 0.951728, 0.989426, -0.0662798, 0.0954167, 0.971166, 0.990421, -0.0610834, 0.0876331, 0.989984, 0.991032, -0.0562936, 0.0797785, 1.00765, 0.992041, -0.0508154, 0.0718166, 1.02434, 0.992794, -0.0454045, 0.0637125, 1.03976, 0.993691, -0.0398194, 0.0555338, 1.05418, 0.994778, -0.0341482, 0.0473388, 1.06772, 0.995915, -0.028428, 0.0391016, 1.08028, 0.997109, -0.022642, 0.0309953, 1.09185, 0.998095, -0.0168738, 0.0230288, 1.10247, 0.998985, -0.0111274, 0.0150722, 1.11229, 0.999581, -0.00543881, 0.00740605, 1.12131, 1.00003, 0.000162239, -0.000105549, 1.12946, 0.959505, -3.93734e-06, 0.196876, 1.91893e-05, 0.959599, -9.92157e-05, 0.196895, 0.000483544, 0.959641, -0.000396868, 0.196903, 0.0019342, 0.959599, -0.000892948, 0.196895, 0.00435193, 0.959603, -0.00158747, 0.196896, 0.0077368, 0.959604, -0.00248042, 0.196896, 0.0120888, 0.959605, -0.00357184, 0.196896, 0.0174082, 0.959605, -0.00486169, 0.196896, 0.0236949, 0.959613, -0.00635008, 0.196897, 0.0309497, 0.959619, -0.00803696, 0.196898, 0.0391725, 0.959636, -0.00992255, 0.196901, 0.0483649, 0.959634, -0.0120067, 0.1969, 0.0585266, 0.959675, -0.0142898, 0.196906, 0.0696609, 0.959712, -0.0167717, 0.196911, 0.0817678, 0.959752, -0.0194524, 0.196918, 0.0948494, 0.959807, -0.0223321, 0.196925, 0.10891, 0.959828, -0.0254091, 0.196924, 0.123947, 0.959906, -0.0286815, 0.196934, 0.139968, 0.960005, -0.0321371, 0.196944, 0.156968, 0.960071, -0.0357114, 0.196936, 0.17491, 0.960237, -0.0389064, 0.196882, 0.193597, 0.960367, -0.041623, 0.196731, 0.21285, 0.960562, -0.0452655, 0.196654, 0.233075, 0.960735, -0.0496207, 0.196643, 0.253941, 0.960913, -0.0549379, 0.196774, 0.275278, 0.961121, -0.0603414, 0.196893, 0.297733, 0.96139, -0.0644244, 0.196717, 0.321877, 0.961818, -0.067556, 0.196314, 0.346476, 0.962175, -0.0712709, 0.195917, 0.371907, 0.96255, -0.0752848, 0.1955, 0.397916, 0.963164, -0.0792073, 0.195026, 0.424229, 0.963782, -0.0828225, 0.194424, 0.450637, 0.964306, -0.0873119, 0.193831, 0.477288, 0.964923, -0.0911051, 0.192973, 0.504716, 0.966048, -0.093251, 0.19151, 0.533053, 0.967024, -0.0958983, 0.190013, 0.561366, 0.968038, -0.09835, 0.188253, 0.589464, 0.969152, -0.100754, 0.186257, 0.617433, 0.970557, -0.102239, 0.183775, 0.645801, 0.972104, -0.102767, 0.180645, 0.674278, 0.973203, -0.103492, 0.177242, 0.702004, 0.975123, -0.103793, 0.17345, 0.729529, 0.97641, -0.102839, 0.168886, 0.756712, 0.978313, -0.101687, 0.163892, 0.783801, 0.980036, -0.100314, 0.158439, 0.809671, 0.981339, -0.097836, 0.152211, 0.835402, 0.982794, -0.0950006, 0.145679, 0.860081, 0.984123, -0.0920994, 0.138949, 0.883757, 0.984918, -0.0878641, 0.131283, 0.90685, 0.985999, -0.083939, 0.123464, 0.928786, 0.987151, -0.0791234, 0.115324, 0.94983, 0.987827, -0.0739332, 0.106854, 0.96962, 0.988806, -0.0688088, 0.0982691, 0.98861, 0.989588, -0.0628962, 0.0893456, 1.00667, 0.990438, -0.0573146, 0.0805392, 1.02344, 0.991506, -0.0509433, 0.0713725, 1.03933, 0.992492, -0.0448724, 0.0623732, 1.05378, 0.993663, -0.0383497, 0.0530838, 1.06747, 0.994956, -0.0319593, 0.0439512, 1.08007, 0.99634, -0.025401, 0.0347803, 1.09182, 0.99761, -0.0189687, 0.0257954, 1.1025, 0.99863, -0.0124441, 0.0169893, 1.11247, 0.99947, -0.00614003, 0.00829498, 1.12151, 1.00008, 0.000216624, -0.000146107, 1.12993, 0.950129, -4.34955e-06, 0.217413, 1.90081e-05, 0.950264, -0.00010957, 0.217444, 0.00047884, 0.9503, -0.000438299, 0.217451, 0.00191543, 0.950246, -0.000986124, 0.21744, 0.00430951, 0.950246, -0.00175311, 0.21744, 0.00766137, 0.950245, -0.00273923, 0.21744, 0.011971, 0.950253, -0.00394453, 0.217441, 0.0172385, 0.950258, -0.00536897, 0.217442, 0.0234641, 0.950267, -0.00701262, 0.217444, 0.030648, 0.950277, -0.00887551, 0.217446, 0.038791, 0.950284, -0.0109576, 0.217446, 0.0478931, 0.950312, -0.0132591, 0.217451, 0.0579568, 0.950334, -0.01578, 0.217454, 0.0689821, 0.950378, -0.0185204, 0.217462, 0.0809714, 0.950417, -0.0214803, 0.217467, 0.0939265, 0.950488, -0.0246594, 0.217479, 0.10785, 0.950534, -0.0280565, 0.217483, 0.122743, 0.950633, -0.0316685, 0.217498, 0.138611, 0.950698, -0.0354787, 0.217499, 0.155442, 0.950844, -0.0394003, 0.217507, 0.173208, 0.950999, -0.0426812, 0.217419, 0.191605, 0.951221, -0.0461302, 0.217317, 0.21084, 0.951412, -0.0502131, 0.217238, 0.230945, 0.951623, -0.0549183, 0.21722, 0.251745, 0.951867, -0.0604493, 0.217306, 0.273001, 0.952069, -0.0665189, 0.217466, 0.294874, 0.952459, -0.0709179, 0.217266, 0.318732, 0.952996, -0.0746112, 0.216891, 0.34318, 0.953425, -0.0789252, 0.216503, 0.36849, 0.953885, -0.0833293, 0.216042, 0.394373, 0.954617, -0.087371, 0.215469, 0.420505, 0.955429, -0.0914054, 0.214802, 0.446907, 0.956068, -0.0961671, 0.214146, 0.473522, 0.957094, -0.10048, 0.213286, 0.50052, 0.958372, -0.103248, 0.211796, 0.528715, 0.959654, -0.106033, 0.21016, 0.557065, 0.961305, -0.108384, 0.208149, 0.585286, 0.962785, -0.111122, 0.206024, 0.613334, 0.964848, -0.112981, 0.203442, 0.641334, 0.966498, -0.113717, 0.19996, 0.669955, 0.968678, -0.114121, 0.196105, 0.698094, 0.970489, -0.114524, 0.191906, 0.725643, 0.972903, -0.113792, 0.186963, 0.752856, 0.974701, -0.112406, 0.181343, 0.780013, 0.976718, -0.110685, 0.175185, 0.806268, 0.978905, -0.108468, 0.168535, 0.832073, 0.980267, -0.105061, 0.161106, 0.857149, 0.981967, -0.101675, 0.153387, 0.881145, 0.983063, -0.0974492, 0.145199, 0.904255, 0.984432, -0.0925815, 0.136527, 0.926686, 0.985734, -0.0877983, 0.127584, 0.947901, 0.986228, -0.081884, 0.118125, 0.968111, 0.98719, -0.0761208, 0.108594, 0.98719, 0.988228, -0.0698196, 0.0989996, 1.00559, 0.989046, -0.0632739, 0.0890074, 1.02246, 0.990242, -0.056522, 0.0790832, 1.03841, 0.991252, -0.0495272, 0.0689182, 1.05347, 0.992542, -0.0425373, 0.0588592, 1.06724, 0.994096, -0.0353198, 0.0486833, 1.08009, 0.995593, -0.028235, 0.0385977, 1.09177, 0.99711, -0.0209511, 0.0286457, 1.10274, 0.998263, -0.0139289, 0.0188497, 1.11262, 0.999254, -0.0067359, 0.009208, 1.12191, 0.999967, 0.000141846, -6.57764e-05, 1.13024, 0.935608, -4.74692e-06, 0.236466, 1.87817e-05, 0.93996, -0.00011971, 0.237568, 0.000473646, 0.939959, -0.000478845, 0.237567, 0.0018946, 0.939954, -0.0010774, 0.237566, 0.00426284, 0.939956, -0.00191538, 0.237566, 0.00757842, 0.939954, -0.00299277, 0.237566, 0.0118413, 0.93996, -0.00430961, 0.237567, 0.0170518, 0.939969, -0.00586589, 0.237569, 0.02321, 0.939982, -0.00766166, 0.237572, 0.0303164, 0.939987, -0.00969686, 0.237572, 0.0383711, 0.939997, -0.0119715, 0.237574, 0.0473751, 0.940031, -0.0144858, 0.237581, 0.0573298, 0.940073, -0.0172399, 0.237589, 0.0682366, 0.94012, -0.0202335, 0.237598, 0.080097, 0.940162, -0.0234663, 0.237604, 0.0929116, 0.940237, -0.0269387, 0.237615, 0.106686, 0.940328, -0.0306489, 0.237632, 0.121421, 0.940419, -0.0345917, 0.237645, 0.137115, 0.940522, -0.0387481, 0.237654, 0.153766, 0.940702, -0.0429906, 0.237661, 0.17133, 0.940871, -0.0465089, 0.237561, 0.189502, 0.941103, -0.050531, 0.23748, 0.208616, 0.941369, -0.0550657, 0.237423, 0.228595, 0.941641, -0.0601337, 0.237399, 0.249287, 0.941903, -0.0658804, 0.237443, 0.270467, 0.942224, -0.0722674, 0.237597, 0.292024, 0.942633, -0.0771788, 0.237419, 0.315272, 0.943172, -0.0815623, 0.237068, 0.339579, 0.943691, -0.0863973, 0.236682, 0.364717, 0.944382, -0.0911536, 0.236213, 0.390435, 0.945392, -0.0952967, 0.235562, 0.416425, 0.946185, -0.0998948, 0.234832, 0.442772, 0.947212, -0.104796, 0.234114, 0.469347, 0.948778, -0.10928, 0.233222, 0.496162, 0.950149, -0.113081, 0.231845, 0.523978, 0.951989, -0.115893, 0.230005, 0.552295, 0.953921, -0.11846, 0.227862, 0.580569, 0.955624, -0.12115, 0.225439, 0.608698, 0.958234, -0.123373, 0.222635, 0.636696, 0.960593, -0.124519, 0.219093, 0.665208, 0.963201, -0.124736, 0.214749, 0.693557, 0.965642, -0.125012, 0.210059, 0.721334, 0.968765, -0.124661, 0.204935, 0.748613, 0.971753, -0.122996, 0.198661, 0.776224, 0.973751, -0.120998, 0.191823, 0.802461, 0.976709, -0.118583, 0.184359, 0.828399, 0.977956, -0.115102, 0.176437, 0.853693, 0.979672, -0.111077, 0.167681, 0.877962, 0.981816, -0.10688, 0.158872, 0.901564, 0.98238, -0.101469, 0.149398, 0.924057, 0.983964, -0.0960013, 0.139436, 0.945751, 0.984933, -0.0899626, 0.12943, 0.966272, 0.985694, -0.0832973, 0.11894, 0.985741, 0.986822, -0.0767082, 0.108349, 1.00407, 0.987725, -0.0693614, 0.0976026, 1.02154, 0.98877, -0.06211, 0.086652, 1.03757, 0.990129, -0.0544143, 0.0756182, 1.05296, 0.991337, -0.046744, 0.0645753, 1.06683, 0.992978, -0.0387931, 0.0534683, 1.0798, 0.994676, -0.030973, 0.0424137, 1.09181, 0.99645, -0.0230311, 0.0314035, 1.10286, 0.997967, -0.0152065, 0.0206869, 1.11291, 0.99922, -0.00744837, 0.010155, 1.12237, 1.00002, 0.000240209, -7.52767e-05, 1.13089, 0.922948, -5.15351e-06, 0.255626, 1.86069e-05, 0.928785, -0.000129623, 0.257244, 0.000468009, 0.928761, -0.00051849, 0.257237, 0.00187202, 0.928751, -0.0011666, 0.257235, 0.00421204, 0.928751, -0.00207395, 0.257234, 0.0074881, 0.928754, -0.00324055, 0.257235, 0.0117002, 0.92876, -0.00466639, 0.257236, 0.0168486, 0.928763, -0.00635149, 0.257237, 0.0229334, 0.928774, -0.00829584, 0.257239, 0.029955, 0.928791, -0.0104995, 0.257243, 0.0379139, 0.928804, -0.0129623, 0.257245, 0.0468108, 0.928847, -0.0156846, 0.257255, 0.0566473, 0.92889, -0.0186661, 0.257263, 0.0674246, 0.928924, -0.0219067, 0.257268, 0.0791433, 0.928989, -0.0254066, 0.257282, 0.0918076, 0.92909, -0.0291651, 0.257301, 0.105419, 0.92918, -0.0331801, 0.257316, 0.119978, 0.92929, -0.0374469, 0.257332, 0.135491, 0.929453, -0.041939, 0.257357, 0.151948, 0.929586, -0.0464612, 0.257347, 0.169275, 0.929858, -0.0503426, 0.257269, 0.187257, 0.930125, -0.0548409, 0.257199, 0.206204, 0.930403, -0.0598063, 0.257149, 0.22601, 0.930726, -0.0652437, 0.257122, 0.246561, 0.931098, -0.0712376, 0.257153, 0.267618, 0.931396, -0.0777506, 0.257237, 0.288993, 0.931947, -0.0832374, 0.257124, 0.311527, 0.932579, -0.0883955, 0.25683, 0.335697, 0.933194, -0.0937037, 0.256444, 0.360634, 0.934013, -0.0987292, 0.255939, 0.386126, 0.935307, -0.103215, 0.255282, 0.412018, 0.936374, -0.108234, 0.254538, 0.438292, 0.93776, -0.113234, 0.253728, 0.464805, 0.939599, -0.118013, 0.25275, 0.491464, 0.941036, -0.122661, 0.251404, 0.518751, 0.94337, -0.125477, 0.249435, 0.547133, 0.945318, -0.128374, 0.247113, 0.575456, 0.947995, -0.130996, 0.244441, 0.60372, 0.950818, -0.133438, 0.241352, 0.63174, 0.954378, -0.135004, 0.237849, 0.659971, 0.957151, -0.135313, 0.233188, 0.688478, 0.960743, -0.13521, 0.228001, 0.716767, 0.964352, -0.135007, 0.222249, 0.744349, 0.967273, -0.133523, 0.21542, 0.771786, 0.969767, -0.131155, 0.208039, 0.798639, 0.973195, -0.128492, 0.200076, 0.824774, 0.975557, -0.125094, 0.191451, 0.850222, 0.977692, -0.120578, 0.18184, 0.874761, 0.98026, -0.115882, 0.172102, 0.898497, 0.981394, -0.110372, 0.161859, 0.921636, 0.982386, -0.10415, 0.15108, 0.943467, 0.983783, -0.0978128, 0.140407, 0.964045, 0.98422, -0.0906171, 0.129058, 0.98398, 0.985447, -0.0832921, 0.117614, 1.00276, 0.986682, -0.0754412, 0.10585, 1.02047, 0.987326, -0.0673885, 0.0940943, 1.03678, 0.988707, -0.0592565, 0.0822093, 1.05218, 0.990185, -0.050717, 0.070192, 1.06652, 0.991866, -0.0423486, 0.0582081, 1.07965, 0.993897, -0.0336118, 0.0460985, 1.09188, 0.995841, -0.0252178, 0.0342737, 1.10307, 0.997605, -0.0164893, 0.0224829, 1.11324, 0.999037, -0.00817112, 0.0110647, 1.12262, 1.00003, 0.000291686, -0.000168673, 1.13139, 0.915304, -5.52675e-06, 0.275999, 1.83285e-05, 0.91668, -0.000139285, 0.276414, 0.000461914, 0.916664, -0.00055713, 0.276409, 0.00184763, 0.916653, -0.00125354, 0.276406, 0.00415715, 0.916651, -0.00222851, 0.276405, 0.00739053, 0.916655, -0.00348205, 0.276406, 0.0115478, 0.916653, -0.00501414, 0.276405, 0.0166291, 0.916667, -0.00682478, 0.276409, 0.0226346, 0.91668, -0.00891398, 0.276412, 0.0295648, 0.91669, -0.0112817, 0.276413, 0.0374199, 0.916727, -0.013928, 0.276422, 0.0462016, 0.916759, -0.0168528, 0.276429, 0.0559101, 0.916793, -0.0200558, 0.276436, 0.0665466, 0.916849, -0.0235373, 0.276448, 0.0781139, 0.916964, -0.0272973, 0.276474, 0.0906156, 0.917047, -0.0313344, 0.276491, 0.104051, 0.917152, -0.0356465, 0.276511, 0.118424, 0.917286, -0.0402271, 0.276533, 0.133736, 0.917469, -0.0450408, 0.276564, 0.149978, 0.917686, -0.0497872, 0.276563, 0.167057, 0.917953, -0.0540937, 0.276493, 0.184846, 0.918228, -0.0590709, 0.276437, 0.203614, 0.918572, -0.0644277, 0.276398, 0.223212, 0.918918, -0.0702326, 0.276362, 0.243584, 0.919356, -0.076484, 0.276383, 0.264465, 0.919842, -0.0830808, 0.276434, 0.285701, 0.920451, -0.0892972, 0.276407, 0.307559, 0.921113, -0.095016, 0.276128, 0.331501, 0.921881, -0.100771, 0.275754, 0.356207, 0.923027, -0.106029, 0.275254, 0.381477, 0.924364, -0.111029, 0.274595, 0.40722, 0.925818, -0.116345, 0.273841, 0.433385, 0.92746, -0.121424, 0.272913, 0.459848, 0.929167, -0.12657, 0.271837, 0.486493, 0.931426, -0.131581, 0.270575, 0.513432, 0.934001, -0.135038, 0.268512, 0.541502, 0.936296, -0.138039, 0.266135, 0.569658, 0.939985, -0.140687, 0.263271, 0.598375, 0.943516, -0.143247, 0.260058, 0.626563, 0.94782, -0.145135, 0.256138, 0.654711, 0.951023, -0.145733, 0.251154, 0.683285, 0.955338, -0.145554, 0.245562, 0.711831, 0.959629, -0.145008, 0.239265, 0.739573, 0.963123, -0.144003, 0.232064, 0.767027, 0.966742, -0.141289, 0.224036, 0.794359, 0.969991, -0.138247, 0.215305, 0.820361, 0.973403, -0.134786, 0.206051, 0.846548, 0.975317, -0.129966, 0.195914, 0.871541, 0.977647, -0.12471, 0.185184, 0.895313, 0.980137, -0.119086, 0.174161, 0.918398, 0.981031, -0.112297, 0.162792, 0.940679, 0.982037, -0.105372, 0.150952, 0.961991, 0.983164, -0.097821, 0.138921, 0.981913, 0.983757, -0.0897245, 0.126611, 1.00109, 0.985036, -0.0815974, 0.114228, 1.01902, 0.986289, -0.0727725, 0.101389, 1.03604, 0.987329, -0.0639323, 0.0886476, 1.05149, 0.989193, -0.0548109, 0.0756837, 1.06619, 0.990716, -0.045687, 0.0627581, 1.07948, 0.992769, -0.0364315, 0.0498337, 1.09172, 0.99524, -0.0271761, 0.0370305, 1.1033, 0.997154, -0.0179609, 0.0243959, 1.11353, 0.998845, -0.00878063, 0.0119567, 1.12319, 1.00002, 0.000259038, -0.000108146, 1.13177, 0.903945, -5.91681e-06, 0.295126, 1.81226e-05, 0.903668, -0.000148672, 0.295037, 0.000455367, 0.903677, -0.000594683, 0.29504, 0.00182145, 0.903673, -0.00133805, 0.295039, 0.00409831, 0.903666, -0.00237872, 0.295036, 0.00728584, 0.903668, -0.00371676, 0.295037, 0.0113842, 0.903679, -0.00535212, 0.29504, 0.0163936, 0.903684, -0.00728479, 0.295041, 0.0223141, 0.903698, -0.00951473, 0.295044, 0.0291462, 0.903718, -0.0120419, 0.295049, 0.0368904, 0.903754, -0.0148664, 0.295058, 0.0455477, 0.903801, -0.017988, 0.29507, 0.0551194, 0.903851, -0.0214064, 0.295082, 0.0656058, 0.903921, -0.0251219, 0.295097, 0.0770109, 0.904002, -0.0291337, 0.295116, 0.0893354, 0.904111, -0.033441, 0.29514, 0.102583, 0.904246, -0.0380415, 0.295169, 0.116755, 0.904408, -0.0429258, 0.295202, 0.131853, 0.904637, -0.0480468, 0.295245, 0.147869, 0.904821, -0.0529208, 0.295214, 0.164658, 0.905163, -0.0577748, 0.295185, 0.182274, 0.905469, -0.0631763, 0.295143, 0.200828, 0.905851, -0.068917, 0.295112, 0.2202, 0.906322, -0.0750861, 0.295104, 0.240372, 0.906761, -0.0815855, 0.295086, 0.261082, 0.90735, -0.0882138, 0.295095, 0.282123, 0.908087, -0.095082, 0.295139, 0.303563, 0.908826, -0.101488, 0.29492, 0.327028, 0.909832, -0.107577, 0.294577, 0.351464, 0.911393, -0.113033, 0.294115, 0.376497, 0.912804, -0.118629, 0.293446, 0.402115, 0.914081, -0.124232, 0.292581, 0.428111, 0.91637, -0.129399, 0.29166, 0.454442, 0.91814, -0.134892, 0.290422, 0.481024, 0.921179, -0.140069, 0.289194, 0.507924, 0.924544, -0.144431, 0.287421, 0.535557, 0.927995, -0.147498, 0.284867, 0.563984, 0.931556, -0.150197, 0.281722, 0.5923, 0.935777, -0.152711, 0.278207, 0.620832, 0.940869, -0.154836, 0.274148, 0.649069, 0.945994, -0.155912, 0.269057, 0.677746, 0.949634, -0.155641, 0.262799, 0.706293, 0.955032, -0.154809, 0.256097, 0.734278, 0.95917, -0.153678, 0.248618, 0.761751, 0.962931, -0.151253, 0.239794, 0.789032, 0.966045, -0.147625, 0.230281, 0.815422, 0.96971, -0.143964, 0.220382, 0.841787, 0.972747, -0.139464, 0.209846, 0.867446, 0.975545, -0.133459, 0.198189, 0.892004, 0.978381, -0.127424, 0.186362, 0.915458, 0.979935, -0.120506, 0.173964, 0.937948, 0.980948, -0.11282, 0.161429, 0.959732, 0.982234, -0.104941, 0.148557, 0.980118, 0.982767, -0.0962905, 0.135508, 0.999463, 0.983544, -0.0873625, 0.122338, 1.01756, 0.984965, -0.0783447, 0.108669, 1.03492, 0.986233, -0.0684798, 0.0949911, 1.05087, 0.987796, -0.0590867, 0.0811386, 1.0656, 0.989885, -0.0489145, 0.0673099, 1.0794, 0.991821, -0.0391, 0.0535665, 1.09174, 0.99448, -0.029087, 0.0397529, 1.10341, 0.996769, -0.019114, 0.0261463, 1.11383, 0.998641, -0.00947007, 0.0128731, 1.1237, 0.999978, 0.000446316, -0.000169093, 1.13253, 0.888362, -6.27064e-06, 0.312578, 1.78215e-05, 0.889988, -0.000157791, 0.313148, 0.000448451, 0.889825, -0.000631076, 0.313092, 0.00179356, 0.88984, -0.00141994, 0.313097, 0.00403554, 0.889828, -0.0025243, 0.313092, 0.00717429, 0.889831, -0.00394421, 0.313093, 0.0112099, 0.889831, -0.00567962, 0.313093, 0.0161425, 0.889844, -0.00773051, 0.313096, 0.0219724, 0.889858, -0.0100968, 0.3131, 0.0286999, 0.889882, -0.0127786, 0.313106, 0.0363256, 0.889918, -0.0157757, 0.313116, 0.0448509, 0.889967, -0.0190878, 0.313129, 0.0542758, 0.89003, -0.022715, 0.313145, 0.0646032, 0.890108, -0.0266566, 0.313165, 0.0758339, 0.890218, -0.0309131, 0.313193, 0.0879729, 0.890351, -0.0354819, 0.313226, 0.101019, 0.89051, -0.0403613, 0.313263, 0.114979, 0.890672, -0.0455385, 0.313294, 0.129848, 0.890882, -0.0509444, 0.313333, 0.145616, 0.891189, -0.0559657, 0.313324, 0.162122, 0.891457, -0.0613123, 0.313281, 0.179524, 0.891856, -0.0671488, 0.313281, 0.197855, 0.892312, -0.0732732, 0.313268, 0.216991, 0.892819, -0.0797865, 0.313263, 0.236924, 0.893369, -0.0865269, 0.313247, 0.257433, 0.894045, -0.0931592, 0.313205, 0.278215, 0.894884, -0.100532, 0.313276, 0.299467, 0.895832, -0.107716, 0.313205, 0.322276, 0.897043, -0.114099, 0.312873, 0.34642, 0.898515, -0.119941, 0.312331, 0.371187, 0.900191, -0.126044, 0.311731, 0.396656, 0.90188, -0.131808, 0.310859, 0.422488, 0.904359, -0.137289, 0.309857, 0.448744, 0.906923, -0.142991, 0.308714, 0.475239, 0.910634, -0.148253, 0.307465, 0.501983, 0.914502, -0.153332, 0.305774, 0.529254, 0.919046, -0.156646, 0.303156, 0.557709, 0.923194, -0.159612, 0.299928, 0.586267, 0.928858, -0.162027, 0.296245, 0.614925, 0.934464, -0.164203, 0.291832, 0.643187, 0.939824, -0.165602, 0.286565, 0.671601, 0.944582, -0.165383, 0.280073, 0.700213, 0.949257, -0.164439, 0.272891, 0.728432, 0.954389, -0.162953, 0.264771, 0.756082, 0.958595, -0.161007, 0.255927, 0.78369, 0.962138, -0.157243, 0.245769, 0.810769, 0.966979, -0.152872, 0.235127, 0.836999, 0.969566, -0.148209, 0.22347, 0.862684, 0.972372, -0.142211, 0.211147, 0.887847, 0.975916, -0.135458, 0.198606, 0.911843, 0.978026, -0.128398, 0.185498, 0.934795, 0.979686, -0.120313, 0.17171, 0.956787, 0.980748, -0.11166, 0.158159, 0.978046, 0.981622, -0.103035, 0.144399, 0.997693, 0.982356, -0.0930328, 0.13001, 1.01642, 0.983308, -0.0834627, 0.115778, 1.03366, 0.985037, -0.0732249, 0.101327, 1.05014, 0.986493, -0.0628145, 0.086554, 1.06507, 0.988484, -0.0526556, 0.0720413, 1.07907, 0.991051, -0.0415744, 0.0571151, 1.09189, 0.993523, -0.0314275, 0.0426643, 1.10369, 0.99628, -0.0203603, 0.0279325, 1.11423, 0.998344, -0.0102446, 0.0138182, 1.12421, 0.999997, 0.00042612, -0.000193628, 1.1333, 0.871555, -6.60007e-06, 0.329176, 1.74749e-05, 0.875255, -0.000166579, 0.330571, 0.000441051, 0.875644, -0.000666394, 0.330718, 0.00176441, 0.875159, -0.00149903, 0.330536, 0.00396899, 0.87516, -0.00266493, 0.330536, 0.007056, 0.875158, -0.00416393, 0.330535, 0.0110251, 0.87516, -0.00599598, 0.330535, 0.0158764, 0.875163, -0.00816108, 0.330536, 0.0216101, 0.875174, -0.0106591, 0.330538, 0.0282266, 0.875199, -0.0134899, 0.330545, 0.0357266, 0.875257, -0.0166538, 0.330563, 0.0441117, 0.875304, -0.0201501, 0.330575, 0.0533821, 0.875373, -0.0239785, 0.330595, 0.0635395, 0.875464, -0.0281389, 0.330619, 0.0745872, 0.875565, -0.0326301, 0.330645, 0.0865255, 0.875691, -0.0374516, 0.330676, 0.0993599, 0.875897, -0.0425993, 0.330733, 0.113093, 0.876091, -0.0480576, 0.330776, 0.127722, 0.876353, -0.0537216, 0.330826, 0.143227, 0.876649, -0.0589807, 0.330809, 0.159462, 0.877034, -0.0647865, 0.330819, 0.176642, 0.877443, -0.0709789, 0.330817, 0.194702, 0.877956, -0.0774782, 0.330832, 0.213577, 0.878499, -0.0843175, 0.330822, 0.233246, 0.879144, -0.0912714, 0.330804, 0.253512, 0.879982, -0.0980824, 0.330766, 0.274137, 0.88097, -0.105823, 0.330864, 0.295209, 0.882051, -0.113671, 0.330896, 0.317226, 0.883397, -0.120303, 0.330545, 0.341068, 0.884987, -0.12667, 0.330068, 0.365613, 0.886789, -0.133118, 0.329418, 0.390807, 0.889311, -0.139024, 0.328683, 0.416494, 0.891995, -0.144971, 0.327729, 0.442618, 0.895106, -0.150747, 0.326521, 0.469131, 0.899527, -0.156283, 0.325229, 0.495921, 0.90504, -0.161707, 0.32378, 0.523162, 0.909875, -0.165661, 0.32122, 0.55092, 0.91561, -0.168755, 0.317942, 0.579928, 0.921225, -0.171193, 0.313983, 0.608539, 0.927308, -0.17319, 0.309636, 0.636854, 0.933077, -0.174819, 0.304262, 0.66523, 0.938766, -0.175002, 0.297563, 0.693609, 0.943667, -0.173946, 0.289613, 0.722157, 0.949033, -0.172221, 0.281227, 0.750021, 0.953765, -0.169869, 0.271545, 0.777466, 0.95804, -0.166578, 0.261034, 0.804853, 0.962302, -0.161761, 0.249434, 0.831569, 0.966544, -0.156636, 0.237484, 0.857779, 0.969372, -0.150784, 0.224395, 0.883051, 0.972486, -0.143672, 0.210786, 0.907864, 0.975853, -0.135772, 0.196556, 0.931223, 0.977975, -0.127942, 0.182307, 0.954061, 0.979122, -0.118347, 0.167607, 0.97531, 0.980719, -0.109112, 0.152739, 0.995666, 0.981223, -0.0991789, 0.137932, 1.01475, 0.98216, -0.0883553, 0.122692, 1.03253, 0.983379, -0.0780825, 0.107493, 1.04917, 0.985434, -0.0665646, 0.0917791, 1.06464, 0.987332, -0.0557714, 0.0764949, 1.07896, 0.990004, -0.0442805, 0.060721, 1.09199, 0.992975, -0.0331676, 0.0452284, 1.10393, 0.995811, -0.0219547, 0.0297934, 1.11476, 0.9982, -0.0107613, 0.0146415, 1.12484, 1.00002, 0.000248678, -0.00014555, 1.13413, 0.859519, -6.93595e-06, 0.347264, 1.71673e-05, 0.859843, -0.00017503, 0.347394, 0.000433219, 0.859656, -0.000700076, 0.347319, 0.00173277, 0.859671, -0.00157517, 0.347325, 0.00389875, 0.859669, -0.00280028, 0.347324, 0.00693112, 0.85967, -0.0043754, 0.347324, 0.01083, 0.859665, -0.00630049, 0.347321, 0.0155954, 0.859685, -0.0085755, 0.347328, 0.0212278, 0.859694, -0.0112003, 0.347329, 0.0277273, 0.859718, -0.0141747, 0.347336, 0.0350946, 0.85976, -0.0174988, 0.347348, 0.0433314, 0.85982, -0.0211722, 0.347366, 0.0524384, 0.859892, -0.0251941, 0.347387, 0.0624168, 0.860006, -0.0295649, 0.347422, 0.0732708, 0.860122, -0.0342825, 0.347453, 0.0849999, 0.860282, -0.0393462, 0.347499, 0.0976102, 0.860482, -0.0447513, 0.347554, 0.111104, 0.860719, -0.0504775, 0.347614, 0.125479, 0.860998, -0.0563577, 0.347666, 0.140703, 0.861322, -0.0619473, 0.347662, 0.156681, 0.861724, -0.0681277, 0.347684, 0.173597, 0.862198, -0.0746567, 0.347709, 0.191371, 0.862733, -0.0815234, 0.347727, 0.209976, 0.863371, -0.0886643, 0.347744, 0.229351, 0.86414, -0.0957908, 0.347734, 0.24934, 0.865138, -0.102912, 0.34772, 0.269797, 0.866182, -0.110924, 0.3478, 0.290654, 0.867436, -0.119223, 0.347911, 0.312074, 0.869087, -0.126197, 0.347649, 0.335438, 0.870859, -0.133145, 0.347222, 0.359732, 0.872997, -0.139869, 0.346645, 0.38467, 0.875939, -0.146089, 0.345935, 0.41019, 0.879012, -0.152334, 0.345012, 0.436218, 0.883353, -0.15821, 0.343924, 0.462641, 0.888362, -0.164097, 0.342636, 0.489449, 0.895026, -0.169528, 0.341351, 0.516629, 0.900753, -0.174408, 0.339115, 0.544109, 0.906814, -0.17751, 0.335809, 0.572857, 0.912855, -0.180101, 0.331597, 0.601554, 0.919438, -0.182116, 0.32698, 0.630198, 0.925962, -0.183494, 0.321449, 0.658404, 0.931734, -0.184159, 0.314595, 0.686625, 0.93762, -0.18304, 0.306462, 0.71531, 0.943858, -0.181323, 0.297514, 0.744272, 0.948662, -0.178683, 0.287447, 0.771462, 0.953299, -0.175379, 0.276166, 0.798593, 0.957346, -0.170395, 0.263758, 0.8256, 0.962565, -0.165042, 0.251019, 0.852575, 0.966075, -0.158655, 0.237011, 0.878316, 0.969048, -0.151707, 0.222518, 0.90329, 0.972423, -0.143271, 0.207848, 0.927745, 0.975833, -0.134824, 0.192463, 0.950859, 0.977629, -0.125444, 0.1768, 0.972947, 0.978995, -0.114949, 0.161033, 0.993263, 0.980533, -0.104936, 0.145523, 1.01337, 0.980745, -0.0935577, 0.129799, 1.03128, 0.981814, -0.0822956, 0.113486, 1.04825, 0.983943, -0.0710082, 0.0972925, 1.06405, 0.986141, -0.0587931, 0.0808138, 1.0785, 0.988878, -0.0472755, 0.0644915, 1.09204, 0.992132, -0.0349128, 0.0478128, 1.10413, 0.9953, -0.0232407, 0.031621, 1.11527, 0.998117, -0.0112713, 0.0154935, 1.12551, 1.00003, 0.000339743, -0.000195763, 1.13504, 0.845441, -7.29126e-06, 0.364305, 1.69208e-05, 0.843588, -0.000183164, 0.363506, 0.000425067, 0.843412, -0.00073253, 0.36343, 0.00169999, 0.843401, -0.00164818, 0.363426, 0.00382495, 0.843399, -0.00293008, 0.363425, 0.00679993, 0.843401, -0.00457822, 0.363425, 0.010625, 0.843394, -0.00659249, 0.363421, 0.0153002, 0.843398, -0.00897282, 0.363421, 0.0208258, 0.843415, -0.0117191, 0.363426, 0.0272024, 0.843438, -0.0148312, 0.363432, 0.0344305, 0.843483, -0.018309, 0.363447, 0.0425116, 0.84356, -0.0221521, 0.363472, 0.0514471, 0.843646, -0.0263597, 0.363499, 0.061238, 0.843743, -0.0309315, 0.363527, 0.0718873, 0.84388, -0.0358658, 0.363569, 0.0833969, 0.844079, -0.0411624, 0.363631, 0.0957742, 0.844279, -0.0468128, 0.363688, 0.109015, 0.844549, -0.0527923, 0.363761, 0.123124, 0.844858, -0.0588204, 0.363817, 0.138044, 0.84522, -0.0647573, 0.36383, 0.153755, 0.845669, -0.0713181, 0.363879, 0.170394, 0.846155, -0.0781697, 0.363908, 0.187861, 0.846789, -0.0853913, 0.363969, 0.206176, 0.847502, -0.0928086, 0.363999, 0.225244, 0.8484, -0.10005, 0.363997, 0.244926, 0.849461, -0.107615, 0.364008, 0.265188, 0.850562, -0.115814, 0.364055, 0.28587, 0.851962, -0.124334, 0.364179, 0.306926, 0.854326, -0.131995, 0.364233, 0.329605, 0.856295, -0.139338, 0.363856, 0.35359, 0.858857, -0.146346, 0.363347, 0.37831, 0.862428, -0.152994, 0.362807, 0.403722, 0.866203, -0.159463, 0.361963, 0.429537, 0.871629, -0.165623, 0.36112, 0.456, 0.877365, -0.171649, 0.359917, 0.482773, 0.883744, -0.177151, 0.35848, 0.509705, 0.890693, -0.182381, 0.356523, 0.537215, 0.897278, -0.186076, 0.3533, 0.565493, 0.903958, -0.188602, 0.349095, 0.594293, 0.910908, -0.190755, 0.344215, 0.623165, 0.918117, -0.192063, 0.338606, 0.651573, 0.924644, -0.192758, 0.331544, 0.679869, 0.931054, -0.192238, 0.323163, 0.708668, 0.937303, -0.190035, 0.313529, 0.737201, 0.943387, -0.187162, 0.303152, 0.764977, 0.948494, -0.183876, 0.29146, 0.792683, 0.952546, -0.178901, 0.277917, 0.819228, 0.958077, -0.173173, 0.264753, 0.846559, 0.962462, -0.16645, 0.25002, 0.872962, 0.966569, -0.159452, 0.234873, 0.898729, 0.969108, -0.15074, 0.218752, 0.923126, 0.973072, -0.141523, 0.202673, 0.947278, 0.975452, -0.132075, 0.186326, 0.969938, 0.977784, -0.121257, 0.169396, 0.991325, 0.97899, -0.110182, 0.153044, 1.01123, 0.979777, -0.0989634, 0.136485, 1.0299, 0.980865, -0.0865894, 0.119343, 1.04727, 0.982432, -0.0746115, 0.102452, 1.06341, 0.984935, -0.0621822, 0.0852423, 1.07834, 0.987776, -0.0495694, 0.0678546, 1.092, 0.99103, -0.0372386, 0.0506917, 1.1043, 0.99474, -0.0244353, 0.0333316, 1.11576, 0.997768, -0.0121448, 0.0164348, 1.12617, 1.00003, 0.00031774, -0.000169504, 1.13598, 0.825551, -7.56799e-06, 0.378425, 1.65099e-05, 0.82664, -0.000190922, 0.378923, 0.000416504, 0.826323, -0.000763495, 0.378779, 0.0016656, 0.826359, -0.00171789, 0.378795, 0.00374768, 0.82636, -0.00305402, 0.378795, 0.00666259, 0.826368, -0.00477185, 0.378798, 0.0104104, 0.826364, -0.00687131, 0.378795, 0.0149912, 0.826368, -0.00935232, 0.378795, 0.0204054, 0.826376, -0.0122146, 0.378797, 0.0266532, 0.826399, -0.0154581, 0.378803, 0.0337355, 0.82646, -0.0190825, 0.378824, 0.0416537, 0.826525, -0.0230873, 0.378846, 0.0504091, 0.826614, -0.0274719, 0.378876, 0.0600032, 0.82674, -0.0322355, 0.378917, 0.0704393, 0.826888, -0.0373766, 0.378964, 0.0817195, 0.827078, -0.0428936, 0.379024, 0.0938492, 0.827318, -0.0487778, 0.379099, 0.106828, 0.82764, -0.0549935, 0.379199, 0.120659, 0.827926, -0.0611058, 0.379227, 0.13526, 0.828325, -0.0675054, 0.379275, 0.150713, 0.828801, -0.0743455, 0.379332, 0.167034, 0.8294, -0.0815523, 0.379415, 0.184209, 0.830094, -0.0890779, 0.379495, 0.202203, 0.8309, -0.096736, 0.379555, 0.220945, 0.831943, -0.104135, 0.379577, 0.240306, 0.833037, -0.112106, 0.379604, 0.260317, 0.834278, -0.120554, 0.379668, 0.2808, 0.836192, -0.129128, 0.3799, 0.301654, 0.838671, -0.137541, 0.380109, 0.323502, 0.840939, -0.14523, 0.379809, 0.347176, 0.844575, -0.15248, 0.379593, 0.371706, 0.848379, -0.159607, 0.37909, 0.39688, 0.853616, -0.166267, 0.378617, 0.422702, 0.858921, -0.172698, 0.377746, 0.448919, 0.865324, -0.178823, 0.376749, 0.475661, 0.872207, -0.184542, 0.375363, 0.502599, 0.880018, -0.189836, 0.373657, 0.529914, 0.88694, -0.194294, 0.370673, 0.557683, 0.894779, -0.197022, 0.36662, 0.586848, 0.902242, -0.199108, 0.36138, 0.615831, 0.909914, -0.200398, 0.355434, 0.644478, 0.917088, -0.20094, 0.348173, 0.672905, 0.923888, -0.200671, 0.339482, 0.701327, 0.930495, -0.198773, 0.32956, 0.730101, 0.937247, -0.195394, 0.318363, 0.758383, 0.943108, -0.191956, 0.306323, 0.786539, 0.948296, -0.187227, 0.292576, 0.813637, 0.953472, -0.181165, 0.278234, 0.840793, 0.958485, -0.174119, 0.263054, 0.867712, 0.962714, -0.166564, 0.246756, 0.893635, 0.966185, -0.158181, 0.229945, 0.919028, 0.970146, -0.148275, 0.212633, 0.943413, 0.973491, -0.138157, 0.195229, 0.966627, 0.975741, -0.127574, 0.178048, 0.988817, 0.977238, -0.11554, 0.160312, 1.00924, 0.978411, -0.10364, 0.142857, 1.02845, 0.979811, -0.0913122, 0.125317, 1.04648, 0.98116, -0.0782558, 0.107627, 1.06284, 0.983543, -0.0655957, 0.0895862, 1.07798, 0.986789, -0.0520411, 0.0713756, 1.092, 0.990292, -0.0389727, 0.053228, 1.10484, 0.994187, -0.025808, 0.0351945, 1.11642, 0.997499, -0.0126071, 0.0173198, 1.12703, 0.999999, 0.000275604, -0.000148602, 1.13674, 0.81075, -7.8735e-06, 0.394456, 1.61829e-05, 0.808692, -0.000198293, 0.393453, 0.000407564, 0.80846, -0.000792877, 0.39334, 0.00162965, 0.808595, -0.00178416, 0.393407, 0.00366711, 0.808597, -0.00317182, 0.393408, 0.00651934, 0.808598, -0.00495589, 0.393408, 0.0101866, 0.808591, -0.00713627, 0.393403, 0.0146689, 0.808592, -0.00971285, 0.393402, 0.0199667, 0.80861, -0.0126855, 0.393407, 0.0260803, 0.808633, -0.0160538, 0.393413, 0.0330107, 0.80868, -0.0198175, 0.393429, 0.0407589, 0.808748, -0.0239758, 0.393453, 0.0493264, 0.808854, -0.0285286, 0.39349, 0.0587161, 0.808992, -0.0334748, 0.39354, 0.0689304, 0.809141, -0.0388116, 0.393588, 0.0799707, 0.809352, -0.0445375, 0.39366, 0.0918432, 0.809608, -0.0506427, 0.393742, 0.104549, 0.809915, -0.0570708, 0.393834, 0.118085, 0.810253, -0.0633526, 0.393885, 0.132377, 0.810687, -0.0700966, 0.393953, 0.147537, 0.811233, -0.0772274, 0.394047, 0.163543, 0.811865, -0.0847629, 0.394148, 0.180394, 0.812648, -0.0925663, 0.394265, 0.198051, 0.813583, -0.100416, 0.394363, 0.216443, 0.814683, -0.108119, 0.394402, 0.235502, 0.815948, -0.11644, 0.394489, 0.255242, 0.817278, -0.125036, 0.394542, 0.275441, 0.819605, -0.133655, 0.39486, 0.296094, 0.822256, -0.142682, 0.395248, 0.317309, 0.825349, -0.150756, 0.395241, 0.340516, 0.829605, -0.158392, 0.395285, 0.364819, 0.83391, -0.165801, 0.394922, 0.389736, 0.839808, -0.172677, 0.394691, 0.415409, 0.845708, -0.179448, 0.394006, 0.441546, 0.853025, -0.185746, 0.393279, 0.46832, 0.859666, -0.191684, 0.391655, 0.495302, 0.86789, -0.197146, 0.390068, 0.52262, 0.875845, -0.201904, 0.38727, 0.550336, 0.882634, -0.205023, 0.382688, 0.578825, 0.891076, -0.207098, 0.377543, 0.608103, 0.900589, -0.208474, 0.371752, 0.63723, 0.90791, -0.209068, 0.364016, 0.665769, 0.915971, -0.208655, 0.355593, 0.694428, 0.923455, -0.20729, 0.345439, 0.723224, 0.931514, -0.203821, 0.334099, 0.751925, 0.937885, -0.19986, 0.321069, 0.780249, 0.943136, -0.194993, 0.306571, 0.8077, 0.948818, -0.189132, 0.291556, 0.83497, 0.954433, -0.181617, 0.275745, 0.86188, 0.959078, -0.173595, 0.258695, 0.888562, 0.962705, -0.164855, 0.240825, 0.914008, 0.966753, -0.155129, 0.22268, 0.939145, 0.970704, -0.144241, 0.204542, 0.963393, 0.973367, -0.133188, 0.185927, 0.985983, 0.975984, -0.121146, 0.167743, 1.00704, 0.976994, -0.108366, 0.149218, 1.02715, 0.978485, -0.0956746, 0.13131, 1.0455, 0.980074, -0.0820733, 0.112513, 1.06221, 0.98225, -0.0684061, 0.0938323, 1.07782, 0.98553, -0.0549503, 0.0749508, 1.09199, 0.989529, -0.0407857, 0.055848, 1.10508, 0.993536, -0.0271978, 0.0368581, 1.11684, 0.997247, -0.0132716, 0.0181845, 1.12789, 1, 0.000431817, -0.000198809, 1.13792, 0.785886, -8.12608e-06, 0.405036, 1.57669e-05, 0.790388, -0.000205278, 0.407355, 0.000398297, 0.790145, -0.000820824, 0.407231, 0.00159263, 0.790135, -0.00184681, 0.407226, 0.00358336, 0.790119, -0.00328316, 0.407218, 0.00637039, 0.790126, -0.00512988, 0.40722, 0.0099539, 0.79013, -0.00738684, 0.407221, 0.0143339, 0.790135, -0.0100538, 0.407221, 0.0195107, 0.790134, -0.0131306, 0.407217, 0.0254848, 0.79016, -0.0166169, 0.407224, 0.0322572, 0.790197, -0.020512, 0.407236, 0.0398284, 0.790273, -0.0248157, 0.407263, 0.0482014, 0.790381, -0.029527, 0.407304, 0.0573777, 0.790521, -0.0346446, 0.407355, 0.0673602, 0.790704, -0.0401665, 0.40742, 0.0781522, 0.790925, -0.0460896, 0.407499, 0.0897582, 0.791195, -0.0524017, 0.407589, 0.10218, 0.791522, -0.0590121, 0.407691, 0.11541, 0.791878, -0.0654876, 0.407748, 0.12939, 0.792361, -0.0725207, 0.407849, 0.144237, 0.792942, -0.0799844, 0.407963, 0.159924, 0.79362, -0.0877896, 0.408087, 0.176425, 0.794529, -0.0958451, 0.408259, 0.193733, 0.795521, -0.103827, 0.408362, 0.211756, 0.796778, -0.111937, 0.408482, 0.230524, 0.798027, -0.120521, 0.408547, 0.249967, 0.799813, -0.129242, 0.408721, 0.269926, 0.802387, -0.138048, 0.409148, 0.290338, 0.805279, -0.147301, 0.409641, 0.311193, 0.809251, -0.155895, 0.410154, 0.333611, 0.813733, -0.163942, 0.410297, 0.357615, 0.819081, -0.171666, 0.410373, 0.382339, 0.825427, -0.178905, 0.410348, 0.407828, 0.83172, -0.185812, 0.409486, 0.434034, 0.83877, -0.192318, 0.408776, 0.460493, 0.845817, -0.198249, 0.407176, 0.487346, 0.854664, -0.204034, 0.405719, 0.514832, 0.863495, -0.208908, 0.403282, 0.542401, 0.871883, -0.212765, 0.399293, 0.570683, 0.88065, -0.214911, 0.393803, 0.599947, 0.89004, -0.216214, 0.387536, 0.62932, 0.898476, -0.216745, 0.379846, 0.658319, 0.906738, -0.216387, 0.370625, 0.687138, 0.914844, -0.215053, 0.360139, 0.71601, 0.923877, -0.212007, 0.348849, 0.745124, 0.931925, -0.207481, 0.335639, 0.773366, 0.938054, -0.202418, 0.320798, 0.801636, 0.943895, -0.196507, 0.304772, 0.829055, 0.949468, -0.189009, 0.288033, 0.856097, 0.955152, -0.180539, 0.270532, 0.88301, 0.959403, -0.171437, 0.251639, 0.909296, 0.963309, -0.161661, 0.232563, 0.934868, 0.967399, -0.150425, 0.213231, 0.959662, 0.972009, -0.138659, 0.194247, 0.98302, 0.97433, -0.126595, 0.174718, 1.00517, 0.975823, -0.113205, 0.155518, 1.02566, 0.976371, -0.0996096, 0.136709, 1.04418, 0.978705, -0.0860754, 0.117571, 1.06146, 0.981477, -0.0714438, 0.0980046, 1.07777, 0.984263, -0.0572304, 0.0782181, 1.09214, 0.988423, -0.0428875, 0.0584052, 1.10553, 0.993, -0.0282442, 0.038522, 1.11758, 0.99704, -0.0140183, 0.0190148, 1.12864, 0.999913, 0.000369494, -0.000145203, 1.13901, 0.777662, -8.4153e-06, 0.423844, 1.54403e-05, 0.770458, -0.000211714, 0.419915, 0.00038845, 0.770716, -0.000846888, 0.420055, 0.00155386, 0.770982, -0.00190567, 0.420202, 0.00349653, 0.770981, -0.00338782, 0.420201, 0.00621606, 0.77098, -0.00529338, 0.4202, 0.00971274, 0.770983, -0.00762223, 0.4202, 0.0139867, 0.770985, -0.0103741, 0.420198, 0.0190381, 0.770996, -0.0135489, 0.4202, 0.0248677, 0.771029, -0.0171461, 0.420212, 0.0314764, 0.771052, -0.0211647, 0.420215, 0.0388648, 0.771131, -0.0256048, 0.420245, 0.047036, 0.771235, -0.0304647, 0.420284, 0.0559911, 0.771383, -0.0357436, 0.420341, 0.0657346, 0.771591, -0.0414392, 0.420423, 0.0762694, 0.771819, -0.0475462, 0.420506, 0.0875984, 0.772123, -0.0540506, 0.420617, 0.099727, 0.772464, -0.060797, 0.42072, 0.112637, 0.772855, -0.0675393, 0.420799, 0.126313, 0.773317, -0.0748323, 0.420893, 0.140824, 0.773981, -0.0825681, 0.421058, 0.15617, 0.774746, -0.0906307, 0.421226, 0.172322, 0.77566, -0.0988982, 0.421397, 0.189253, 0.776837, -0.106994, 0.421569, 0.206912, 0.778097, -0.115528, 0.421704, 0.225359, 0.779588, -0.124317, 0.421849, 0.24447, 0.781574, -0.133139, 0.422097, 0.264156, 0.784451, -0.142179, 0.422615, 0.284318, 0.787682, -0.15165, 0.423269, 0.304902, 0.792433, -0.160771, 0.424396, 0.3265, 0.797359, -0.169166, 0.424772, 0.35014, 0.803986, -0.177149, 0.425475, 0.374768, 0.809504, -0.184745, 0.424996, 0.399928, 0.815885, -0.19173, 0.424247, 0.425796, 0.823513, -0.198525, 0.423515, 0.452287, 0.832549, -0.204709, 0.422787, 0.479321, 0.841653, -0.210447, 0.421187, 0.506718, 0.850401, -0.215501, 0.418519, 0.53432, 0.859854, -0.219752, 0.414715, 0.56242, 0.869364, -0.222305, 0.409462, 0.591558, 0.878837, -0.223744, 0.402926, 0.621074, 0.888636, -0.224065, 0.395043, 0.650538, 0.898132, -0.223742, 0.38564, 0.679538, 0.907181, -0.222308, 0.375378, 0.708674, 0.915621, -0.219837, 0.363212, 0.737714, 0.9239, -0.215233, 0.349313, 0.767014, 0.931644, -0.209592, 0.334162, 0.795133, 0.938887, -0.203644, 0.317943, 0.823228, 0.945282, -0.196349, 0.300581, 0.850822, 0.950758, -0.18742, 0.282195, 0.877594, 0.956146, -0.177879, 0.262481, 0.904564, 0.960355, -0.167643, 0.242487, 0.930741, 0.965256, -0.156671, 0.222668, 0.955868, 0.968029, -0.144123, 0.201907, 0.979869, 0.97251, -0.131305, 0.18202, 1.00291, 0.974925, -0.118335, 0.161909, 1.02392, 0.975402, -0.103714, 0.142129, 1.0433, 0.976987, -0.089415, 0.122447, 1.06089, 0.979677, -0.0748858, 0.102248, 1.07713, 0.983184, -0.0596086, 0.0814851, 1.09218, 0.987466, -0.0447671, 0.0609484, 1.10585, 0.992348, -0.0295217, 0.0401835, 1.11829, 0.996674, -0.0143917, 0.0198163, 1.12966, 1.00003, 0.000321364, -0.000149983, 1.1402, 0.757901, -8.69074e-06, 0.436176, 1.51011e-05, 0.751195, -0.000217848, 0.432317, 0.000378533, 0.751178, -0.000871373, 0.432307, 0.0015141, 0.751195, -0.00196061, 0.432317, 0.0034068, 0.751198, -0.00348552, 0.432318, 0.00605659, 0.751195, -0.00544599, 0.432315, 0.00946353, 0.751207, -0.00784203, 0.43232, 0.013628, 0.751213, -0.0106732, 0.43232, 0.0185499, 0.751221, -0.0139393, 0.432319, 0.0242302, 0.751244, -0.0176398, 0.432325, 0.0306694, 0.7513, -0.0217743, 0.432348, 0.0378698, 0.751358, -0.0263412, 0.432367, 0.0458321, 0.751458, -0.0313396, 0.432404, 0.0545587, 0.751608, -0.0367682, 0.432464, 0.0640543, 0.7518, -0.0426246, 0.43254, 0.0743222, 0.752065, -0.0489031, 0.432645, 0.0853668, 0.752376, -0.0555828, 0.432762, 0.0971911, 0.752715, -0.0623861, 0.432859, 0.109768, 0.753137, -0.069415, 0.432958, 0.123126, 0.753676, -0.0770039, 0.433099, 0.137308, 0.754345, -0.084971, 0.433272, 0.15229, 0.755235, -0.0932681, 0.433504, 0.168075, 0.756186, -0.10171, 0.433693, 0.184625, 0.757363, -0.110019, 0.433857, 0.201897, 0.75884, -0.11887, 0.434102, 0.220014, 0.760467, -0.127881, 0.434306, 0.238778, 0.762969, -0.136766, 0.434751, 0.258172, 0.765823, -0.14612, 0.43529, 0.278062, 0.769676, -0.15566, 0.436236, 0.298437, 0.774909, -0.165177, 0.437754, 0.319532, 0.77994, -0.17402, 0.438343, 0.342505, 0.785757, -0.182201, 0.438609, 0.366693, 0.792487, -0.190104, 0.438762, 0.391668, 0.80038, -0.197438, 0.438795, 0.417494, 0.808494, -0.204365, 0.438226, 0.443933, 0.817695, -0.210714, 0.437283, 0.470929, 0.828111, -0.216651, 0.436087, 0.498569, 0.837901, -0.221804, 0.433717, 0.526165, 0.847813, -0.226318, 0.430133, 0.554155, 0.858314, -0.229297, 0.425213, 0.582822, 0.868891, -0.230999, 0.418576, 0.612847, 0.878941, -0.231155, 0.410405, 0.642445, 0.888809, -0.230935, 0.400544, 0.672024, 0.898089, -0.229343, 0.389613, 0.701366, 0.908081, -0.226886, 0.377197, 0.730763, 0.916819, -0.222676, 0.363397, 0.759642, 0.924968, -0.216835, 0.347437, 0.788775, 0.932906, -0.210245, 0.32995, 0.817135, 0.940025, -0.202992, 0.312262, 0.844912, 0.946101, -0.19436, 0.293313, 0.872164, 0.952835, -0.184125, 0.273638, 0.899443, 0.957347, -0.173657, 0.252385, 0.926389, 0.961434, -0.162204, 0.231038, 0.951947, 0.965522, -0.14979, 0.209834, 0.976751, 0.969412, -0.136307, 0.188821, 1.00022, 0.973902, -0.122527, 0.168013, 1.02229, 0.974045, -0.108213, 0.147634, 1.04199, 0.975775, -0.0927397, 0.12705, 1.06019, 0.978383, -0.0778212, 0.106309, 1.07711, 0.98211, -0.0621216, 0.0849279, 1.09245, 0.986517, -0.0463847, 0.0633519, 1.10651, 0.991696, -0.0309353, 0.0419698, 1.11903, 0.996349, -0.0150914, 0.0206272, 1.13073, 1.00003, 0.000442449, -0.000231396, 1.14146, 0.727498, -8.85074e-06, 0.441528, 1.45832e-05, 0.730897, -0.000223525, 0.443589, 0.000368298, 0.730796, -0.000893996, 0.443528, 0.00147303, 0.730805, -0.00201149, 0.443533, 0.00331433, 0.730814, -0.00357596, 0.443538, 0.00589222, 0.730815, -0.00558734, 0.443538, 0.00920678, 0.730822, -0.00804544, 0.44354, 0.0132582, 0.730836, -0.0109501, 0.443545, 0.0180468, 0.730848, -0.0143008, 0.443546, 0.0235732, 0.730871, -0.0180969, 0.443552, 0.0298382, 0.730915, -0.022338, 0.443567, 0.0368438, 0.730982, -0.0270225, 0.443591, 0.044591, 0.731076, -0.0321491, 0.443627, 0.0530831, 0.731245, -0.0377166, 0.443699, 0.0623243, 0.73144, -0.0437216, 0.443777, 0.0723181, 0.7317, -0.0501576, 0.443881, 0.0830691, 0.732034, -0.0569942, 0.444014, 0.0945809, 0.732388, -0.0638756, 0.444113, 0.106825, 0.732853, -0.071203, 0.444247, 0.119859, 0.733473, -0.0790076, 0.444442, 0.13369, 0.734195, -0.0871937, 0.444645, 0.148304, 0.735069, -0.095696, 0.444877, 0.163702, 0.736169, -0.10426, 0.445133, 0.179861, 0.73747, -0.112853, 0.44537, 0.196778, 0.738991, -0.12199, 0.445651, 0.214496, 0.740865, -0.131153, 0.445958, 0.232913, 0.743637, -0.140245, 0.446548, 0.251977, 0.746797, -0.149722, 0.447246, 0.271551, 0.751517, -0.159341, 0.448656, 0.291774, 0.756156, -0.169106, 0.449866, 0.312455, 0.761519, -0.178436, 0.450919, 0.334552, 0.768295, -0.186904, 0.451776, 0.358491, 0.776613, -0.195117, 0.452832, 0.383446, 0.783966, -0.202695, 0.45249, 0.408945, 0.793542, -0.20985, 0.452587, 0.435364, 0.803192, -0.216403, 0.451852, 0.462336, 0.813892, -0.22251, 0.450708, 0.48987, 0.824968, -0.227676, 0.4486, 0.517697, 0.835859, -0.232443, 0.445156, 0.545975, 0.846825, -0.235775, 0.440351, 0.574483, 0.858085, -0.237897, 0.433641, 0.604246, 0.868825, -0.238074, 0.425354, 0.634101, 0.879638, -0.237661, 0.415383, 0.664201, 0.889966, -0.236186, 0.404136, 0.693918, 0.899479, -0.233599, 0.390917, 0.723481, 0.908769, -0.229737, 0.376352, 0.75258, 0.917966, -0.223836, 0.360372, 0.781764, 0.926304, -0.217067, 0.342551, 0.811139, 0.934626, -0.209309, 0.324238, 0.839585, 0.941841, -0.20071, 0.304484, 0.867044, 0.94789, -0.190602, 0.283607, 0.894579, 0.954196, -0.179253, 0.262205, 0.921743, 0.958383, -0.167646, 0.239847, 0.948026, 0.963119, -0.155073, 0.218078, 0.973296, 0.966941, -0.141426, 0.195899, 0.998135, 0.970836, -0.126849, 0.174121, 1.02021, 0.973301, -0.112296, 0.153052, 1.04085, 0.97448, -0.0964965, 0.131733, 1.05946, 0.977045, -0.080489, 0.10997, 1.07693, 0.980751, -0.064844, 0.0881657, 1.09254, 0.985475, -0.0481938, 0.0657987, 1.10697, 0.991089, -0.0319185, 0.0435215, 1.12004, 0.996122, -0.0158088, 0.0214779, 1.13173, 1.00001, 0.000372455, -0.000200295, 1.14291, 0.708622, -9.07597e-06, 0.45304, 1.41962e-05, 0.711162, -0.000228911, 0.454662, 0.000358052, 0.709812, -0.000914446, 0.453797, 0.00143034, 0.709865, -0.00205819, 0.453834, 0.00321935, 0.709864, -0.00365894, 0.453833, 0.00572331, 0.709855, -0.00571692, 0.453826, 0.00894278, 0.709862, -0.00823201, 0.453828, 0.012878, 0.709875, -0.011204, 0.453832, 0.0175295, 0.709896, -0.0146323, 0.453839, 0.0228978, 0.709925, -0.0185163, 0.453847, 0.0289839, 0.709974, -0.0228551, 0.453866, 0.0357894, 0.710045, -0.0276473, 0.453892, 0.0433161, 0.710133, -0.032891, 0.453924, 0.0515665, 0.710292, -0.0385851, 0.453992, 0.0605458, 0.710485, -0.0447254, 0.45407, 0.0702574, 0.710769, -0.0513051, 0.454192, 0.0807077, 0.711106, -0.0582733, 0.454329, 0.091896, 0.711516, -0.0652866, 0.45446, 0.103814, 0.712071, -0.0728426, 0.454653, 0.116508, 0.712676, -0.0808307, 0.45484, 0.129968, 0.713476, -0.0892216, 0.455096, 0.144206, 0.714377, -0.0979047, 0.455346, 0.159212, 0.715579, -0.106531, 0.455647, 0.174973, 0.716977, -0.115492, 0.455961, 0.191504, 0.71862, -0.124821, 0.456315, 0.208835, 0.72084, -0.134079, 0.4568, 0.226869, 0.723786, -0.143427, 0.457521, 0.245582, 0.727464, -0.153061, 0.458475, 0.264957, 0.732771, -0.162768, 0.460239, 0.284948, 0.736515, -0.172627, 0.460899, 0.30522, 0.743519, -0.182487, 0.463225, 0.326717, 0.750041, -0.191295, 0.464027, 0.350113, 0.758589, -0.199746, 0.465227, 0.374782, 0.767703, -0.207584, 0.465877, 0.400226, 0.777484, -0.214973, 0.465996, 0.426442, 0.788792, -0.221796, 0.466019, 0.453688, 0.800194, -0.228038, 0.465083, 0.481246, 0.811234, -0.233346, 0.462506, 0.509086, 0.822859, -0.238073, 0.459257, 0.537338, 0.835082, -0.241764, 0.454863, 0.566108, 0.846332, -0.244241, 0.448163, 0.595126, 0.858355, -0.244736, 0.439709, 0.625574, 0.87034, -0.244278, 0.429837, 0.65617, 0.881027, -0.24255, 0.418002, 0.686029, 0.891007, -0.239912, 0.404325, 0.716039, 0.900874, -0.236133, 0.389222, 0.745518, 0.911072, -0.230672, 0.373269, 0.775026, 0.920359, -0.22356, 0.355083, 0.804521, 0.928604, -0.215591, 0.335533, 0.834045, 0.937175, -0.206503, 0.315278, 0.861612, 0.942825, -0.196684, 0.293653, 0.889131, 0.949805, -0.185116, 0.271503, 0.916853, 0.955535, -0.172703, 0.248821, 0.943541, 0.959843, -0.159978, 0.225591, 0.970132, 0.964393, -0.146375, 0.202719, 0.994709, 0.968008, -0.131269, 0.179928, 1.0186, 0.971013, -0.11569, 0.158007, 1.03928, 0.973334, -0.1003, 0.13624, 1.05887, 0.975775, -0.0833352, 0.1138, 1.07652, 0.979579, -0.0668981, 0.0913141, 1.09297, 0.984323, -0.0500902, 0.0683051, 1.10734, 0.990351, -0.0332377, 0.0451771, 1.12084, 0.995823, -0.0161491, 0.0221705, 1.13296, 1.0001, 0.000234083, -0.000108712, 1.14441, 0.683895, -9.24677e-06, 0.46015, 1.37429e-05, 0.68833, -0.000233383, 0.463134, 0.000346865, 0.688368, -0.000933547, 0.463159, 0.00138748, 0.688367, -0.00210049, 0.463159, 0.00312187, 0.688369, -0.00373415, 0.463159, 0.00555004, 0.688377, -0.00583449, 0.463163, 0.00867216, 0.688386, -0.00840128, 0.463166, 0.0124884, 0.688398, -0.0114343, 0.463169, 0.0169993, 0.688418, -0.0149329, 0.463175, 0.0222054, 0.688453, -0.0188964, 0.463188, 0.028108, 0.688515, -0.0233239, 0.463214, 0.0347085, 0.68857, -0.0282136, 0.463231, 0.0420091, 0.688679, -0.033564, 0.463276, 0.0500132, 0.688854, -0.0393733, 0.463356, 0.0587255, 0.689038, -0.0456354, 0.46343, 0.0681476, 0.689321, -0.0523433, 0.463553, 0.0782897, 0.689662, -0.059412, 0.463693, 0.0891501, 0.690188, -0.0665736, 0.4639, 0.100735, 0.690755, -0.0743106, 0.464107, 0.113074, 0.691405, -0.0824722, 0.464329, 0.126161, 0.692198, -0.0910484, 0.464585, 0.140007, 0.693196, -0.0998778, 0.464893, 0.154612, 0.69454, -0.108651, 0.465285, 0.169984, 0.695921, -0.117855, 0.465596, 0.186106, 0.697749, -0.12734, 0.466056, 0.203034, 0.700375, -0.136714, 0.466771, 0.220703, 0.703395, -0.146386, 0.467579, 0.239062, 0.707904, -0.156096, 0.469067, 0.258188, 0.711673, -0.165904, 0.469851, 0.277759, 0.717489, -0.175812, 0.471815, 0.297935, 0.724051, -0.185931, 0.47389, 0.318916, 0.731965, -0.195238, 0.47587, 0.341591, 0.741151, -0.204021, 0.477523, 0.366062, 0.751416, -0.212113, 0.478881, 0.391396, 0.761848, -0.21979, 0.479226, 0.417599, 0.771886, -0.2267, 0.478495, 0.444401, 0.783998, -0.232991, 0.477622, 0.472084, 0.796523, -0.238645, 0.475833, 0.500193, 0.808851, -0.243396, 0.472568, 0.52865, 0.821191, -0.247226, 0.467857, 0.557362, 0.834261, -0.250102, 0.461871, 0.586768, 0.846762, -0.251056, 0.453543, 0.617085, 0.859867, -0.250604, 0.443494, 0.647659, 0.871948, -0.248783, 0.431711, 0.678119, 0.882967, -0.245855, 0.417911, 0.708399, 0.892826, -0.242168, 0.401993, 0.738256, 0.90332, -0.237062, 0.385371, 0.767999, 0.913633, -0.22997, 0.366837, 0.798191, 0.922774, -0.221687, 0.346372, 0.827756, 0.931371, -0.212345, 0.325682, 0.856425, 0.938929, -0.20206, 0.303665, 0.884299, 0.944821, -0.190981, 0.280786, 0.912023, 0.951792, -0.178065, 0.2573, 0.939669, 0.957712, -0.164634, 0.233448, 0.96655, 0.961912, -0.150863, 0.209504, 0.992366, 0.966382, -0.13577, 0.18597, 1.01633, 0.969588, -0.119593, 0.162905, 1.03843, 0.971777, -0.103203, 0.14053, 1.05841, 0.97433, -0.0865888, 0.117909, 1.07632, 0.978686, -0.0690829, 0.0944101, 1.09326, 0.983281, -0.0516568, 0.0705671, 1.10796, 0.989562, -0.034558, 0.0468592, 1.12182, 0.995465, -0.0167808, 0.0229846, 1.1342, 0.999991, 0.000373016, -0.000235606, 1.1459, 0.662251, -9.39016e-06, 0.468575, 1.32714e-05, 0.666634, -0.000237624, 0.471675, 0.000335842, 0.666411, -0.000950385, 0.471516, 0.00134321, 0.666399, -0.00213833, 0.471509, 0.00302221, 0.666386, -0.0038014, 0.471499, 0.00537283, 0.666405, -0.00593958, 0.471511, 0.00839533, 0.666406, -0.00855253, 0.471508, 0.0120898, 0.666428, -0.0116401, 0.471519, 0.0164569, 0.666444, -0.0152015, 0.471522, 0.0214971, 0.66649, -0.0192362, 0.471543, 0.027212, 0.666537, -0.0237428, 0.471558, 0.033603, 0.666617, -0.0287198, 0.471591, 0.0406728, 0.666718, -0.0341647, 0.471631, 0.0484238, 0.666889, -0.0400759, 0.47171, 0.0568621, 0.667104, -0.0464479, 0.471805, 0.0659915, 0.667374, -0.0532677, 0.471923, 0.0758178, 0.667772, -0.0603805, 0.472098, 0.0863425, 0.668371, -0.0677392, 0.472363, 0.0975917, 0.668971, -0.0756028, 0.472596, 0.109567, 0.669696, -0.0839293, 0.472869, 0.122272, 0.670481, -0.0926683, 0.473126, 0.135718, 0.6715, -0.1016, 0.473442, 0.149914, 0.672911, -0.110566, 0.47389, 0.164882, 0.674512, -0.119984, 0.474354, 0.180602, 0.67651, -0.129574, 0.474922, 0.19711, 0.679292, -0.139106, 0.475764, 0.214371, 0.682798, -0.148993, 0.476886, 0.232405, 0.686955, -0.158737, 0.478179, 0.251153, 0.691406, -0.168754, 0.479432, 0.270436, 0.697438, -0.178703, 0.481481, 0.290374, 0.704761, -0.188955, 0.484143, 0.311044, 0.713599, -0.198814, 0.487007, 0.333003, 0.723194, -0.207869, 0.488962, 0.357144, 0.732601, -0.216189, 0.489815, 0.382169, 0.744193, -0.22398, 0.490888, 0.408227, 0.754907, -0.231156, 0.490355, 0.434928, 0.767403, -0.23747, 0.489548, 0.462599, 0.78107, -0.243503, 0.488274, 0.490908, 0.793893, -0.248114, 0.484843, 0.519421, 0.807296, -0.25222, 0.4803, 0.548561, 0.820529, -0.255265, 0.474097, 0.577772, 0.833716, -0.256741, 0.466041, 0.607782, 0.848403, -0.25637, 0.456547, 0.638807, 0.860755, -0.254804, 0.443946, 0.670058, 0.874012, -0.251834, 0.430852, 0.700749, 0.885619, -0.247867, 0.414903, 0.731446, 0.896069, -0.242634, 0.397276, 0.761191, 0.906266, -0.236093, 0.378535, 0.791053, 0.916759, -0.227543, 0.358038, 0.821298, 0.92523, -0.21783, 0.335705, 0.850747, 0.93436, -0.207534, 0.313797, 0.879258, 0.941631, -0.195983, 0.289671, 0.907734, 0.947564, -0.183567, 0.265319, 0.935206, 0.953681, -0.169345, 0.240815, 0.962739, 0.960008, -0.154909, 0.216119, 0.989227, 0.964145, -0.140161, 0.192096, 1.01465, 0.968171, -0.123411, 0.167855, 1.03737, 0.969859, -0.106525, 0.144817, 1.05767, 0.972666, -0.0891023, 0.12149, 1.0761, 0.977055, -0.0718094, 0.0975306, 1.09336, 0.982527, -0.0534213, 0.0730217, 1.10878, 0.989001, -0.0355579, 0.0483366, 1.12285, 0.99512, -0.0176383, 0.023938, 1.13548, 1.00007, 0.000368831, -0.000211581, 1.14744, 0.651047, -9.60845e-06, 0.484101, 1.2922e-05, 0.644145, -0.000241347, 0.478968, 0.000324578, 0.64396, -0.000965142, 0.478831, 0.00129798, 0.64396, -0.00217154, 0.47883, 0.00292046, 0.643968, -0.00386049, 0.478835, 0.00519202, 0.643974, -0.00603186, 0.478838, 0.0081128, 0.643977, -0.0086854, 0.478836, 0.011683, 0.643982, -0.0118207, 0.478834, 0.0159031, 0.644024, -0.0154374, 0.478856, 0.0207743, 0.644059, -0.0195343, 0.478868, 0.0262975, 0.644122, -0.0241103, 0.478896, 0.0324747, 0.644207, -0.0291638, 0.478933, 0.039309, 0.64432, -0.0346919, 0.478981, 0.0468029, 0.644481, -0.0406919, 0.479053, 0.0549614, 0.644722, -0.047159, 0.479169, 0.0637909, 0.645013, -0.0540748, 0.479302, 0.0732974, 0.645503, -0.0612001, 0.479541, 0.0834898, 0.646117, -0.0687303, 0.479829, 0.0943873, 0.646707, -0.0767846, 0.480061, 0.105991, 0.647431, -0.0852465, 0.480343, 0.11831, 0.64831, -0.0940719, 0.48066, 0.131348, 0.649486, -0.103056, 0.481083, 0.14514, 0.650864, -0.112261, 0.481528, 0.159676, 0.652604, -0.121852, 0.482102, 0.174979, 0.654825, -0.131505, 0.482813, 0.191079, 0.657876, -0.141189, 0.483876, 0.207927, 0.661339, -0.151239, 0.48499, 0.225586, 0.665463, -0.161091, 0.486279, 0.243947, 0.670542, -0.171235, 0.487968, 0.262957, 0.677361, -0.181347, 0.49053, 0.282781, 0.685672, -0.191679, 0.493862, 0.303311, 0.694551, -0.201781, 0.49699, 0.324607, 0.703753, -0.211164, 0.498884, 0.347916, 0.713703, -0.219675, 0.500086, 0.372628, 0.725911, -0.227836, 0.501554, 0.398694, 0.73862, -0.23533, 0.502193, 0.425529, 0.752118, -0.241786, 0.501811, 0.453209, 0.76579, -0.247865, 0.500185, 0.481381, 0.779568, -0.252696, 0.497159, 0.51011, 0.793991, -0.256802, 0.492765, 0.539322, 0.808182, -0.259942, 0.486827, 0.569078, 0.821698, -0.261703, 0.478386, 0.598818, 0.836009, -0.262006, 0.468772, 0.629762, 0.849824, -0.260333, 0.456352, 0.661366, 0.863888, -0.257398, 0.442533, 0.69295, 0.876585, -0.253264, 0.426573, 0.723608, 0.888665, -0.248026, 0.408964, 0.754378, 0.899537, -0.241487, 0.389677, 0.784761, 0.9094, -0.233463, 0.368516, 0.814688, 0.920166, -0.223397, 0.346624, 0.845009, 0.928899, -0.21255, 0.322717, 0.874431, 0.937156, -0.200869, 0.298698, 0.902922, 0.943861, -0.188387, 0.273491, 0.931356, 0.949557, -0.174341, 0.247866, 0.958854, 0.955862, -0.158994, 0.222496, 0.986098, 0.961721, -0.143664, 0.197522, 1.01229, 0.965976, -0.127412, 0.17302, 1.03571, 0.968652, -0.109798, 0.148954, 1.05699, 0.971084, -0.0916787, 0.125044, 1.07587, 0.975584, -0.0739634, 0.100577, 1.09372, 0.98122, -0.055322, 0.0753666, 1.10948, 0.988253, -0.0366825, 0.0498899, 1.12394, 0.99482, -0.0180389, 0.024611, 1.13694, 1.00001, 0.000229839, -0.000188283, 1.14919, 0.613867, -9.64198e-06, 0.479449, 1.23452e-05, 0.621485, -0.000244534, 0.485399, 0.000313091, 0.621429, -0.000978202, 0.485353, 0.00125245, 0.62112, -0.00220004, 0.485114, 0.00281687, 0.621119, -0.0039111, 0.485112, 0.00500783, 0.621122, -0.00611091, 0.485112, 0.00782498, 0.621133, -0.00879922, 0.485117, 0.0112687, 0.621152, -0.0119756, 0.485125, 0.0153394, 0.621183, -0.0156396, 0.485139, 0.0200382, 0.621227, -0.0197898, 0.485158, 0.0253663, 0.621298, -0.0244253, 0.485192, 0.0313261, 0.621388, -0.0295441, 0.485233, 0.0379204, 0.621507, -0.0351432, 0.485286, 0.0451523, 0.621693, -0.0412198, 0.485378, 0.0530277, 0.621933, -0.0477673, 0.485495, 0.0615522, 0.622232, -0.0547574, 0.485635, 0.0707316, 0.622809, -0.0619417, 0.485943, 0.0805883, 0.623407, -0.069625, 0.486232, 0.0911267, 0.62406, -0.077796, 0.486516, 0.102354, 0.624835, -0.0863731, 0.486838, 0.114279, 0.625758, -0.095251, 0.487188, 0.126902, 0.627043, -0.104299, 0.487695, 0.140285, 0.628438, -0.113724, 0.488163, 0.154397, 0.630325, -0.123417, 0.488858, 0.169267, 0.632801, -0.133137, 0.489754, 0.184941, 0.635784, -0.143052, 0.490815, 0.20136, 0.639406, -0.153132, 0.492048, 0.218643, 0.643872, -0.163143, 0.49363, 0.236615, 0.6499, -0.17333, 0.496009, 0.255449, 0.657201, -0.183622, 0.498994, 0.275006, 0.666221, -0.194019, 0.502888, 0.295354, 0.674419, -0.204192, 0.505459, 0.316244, 0.683729, -0.21406, 0.507771, 0.33849, 0.695584, -0.222854, 0.510245, 0.363166, 0.708583, -0.231315, 0.512293, 0.389071, 0.721233, -0.238911, 0.512747, 0.415737, 0.735134, -0.245657, 0.512482, 0.443331, 0.750179, -0.251879, 0.511526, 0.471891, 0.765073, -0.256911, 0.508935, 0.500892, 0.779794, -0.261144, 0.504341, 0.530294, 0.794801, -0.264316, 0.498515, 0.560144, 0.810339, -0.266276, 0.491015, 0.590213, 0.824818, -0.266981, 0.481126, 0.620865, 0.839375, -0.265778, 0.468685, 0.652687, 0.853043, -0.262748, 0.453925, 0.684759, 0.867335, -0.258474, 0.437912, 0.716209, 0.88037, -0.253187, 0.419648, 0.747508, 0.891711, -0.246476, 0.39982, 0.77797, 0.902896, -0.238735, 0.37879, 0.808586, 0.913601, -0.22885, 0.355891, 0.838843, 0.923019, -0.217656, 0.331773, 0.869014, 0.933432, -0.205539, 0.307356, 0.898512, 0.939691, -0.192595, 0.281321, 0.9269, 0.946938, -0.178945, 0.255441, 0.955297, 0.952372, -0.163587, 0.229013, 0.983231, 0.95909, -0.147214, 0.203179, 1.00971, 0.963675, -0.13064, 0.17792, 1.03438, 0.968247, -0.113121, 0.152898, 1.05625, 0.97001, -0.0945824, 0.128712, 1.07598, 0.974458, -0.0755648, 0.103349, 1.094, 0.980168, -0.0571998, 0.0776731, 1.1104, 0.987295, -0.0377994, 0.0514445, 1.12491, 0.994432, -0.0186417, 0.025429, 1.13851, 0.999975, 0.000542714, -0.000282356, 1.15108, 0.592656, -9.80249e-06, 0.486018, 1.19532e-05, 0.598467, -0.000247275, 0.490781, 0.000301531, 0.597934, -0.000988317, 0.490343, 0.00120517, 0.597903, -0.00222366, 0.490319, 0.0027116, 0.597913, -0.00395315, 0.490327, 0.00482077, 0.597919, -0.00617653, 0.490329, 0.00753264, 0.597936, -0.00889375, 0.490339, 0.0108478, 0.597956, -0.0121043, 0.490347, 0.0147668, 0.597992, -0.0158073, 0.490365, 0.0192905, 0.598032, -0.0200017, 0.490382, 0.0244204, 0.598109, -0.0246865, 0.49042, 0.0301593, 0.598215, -0.0298594, 0.490474, 0.03651, 0.59833, -0.0355167, 0.490524, 0.0434757, 0.598525, -0.0416559, 0.490624, 0.0510629, 0.598778, -0.0482692, 0.490753, 0.0592781, 0.599135, -0.0553114, 0.49094, 0.0681304, 0.599802, -0.062542, 0.491328, 0.0776467, 0.600361, -0.0703638, 0.491598, 0.0878184, 0.60101, -0.0786256, 0.491882, 0.0986573, 0.601811, -0.0872962, 0.492232, 0.11018, 0.602861, -0.0962284, 0.492684, 0.1224, 0.604167, -0.10538, 0.493213, 0.135354, 0.605693, -0.114896, 0.493799, 0.149034, 0.607682, -0.124654, 0.494576, 0.163469, 0.610672, -0.13456, 0.4959, 0.178747, 0.613313, -0.144581, 0.496713, 0.194723, 0.617603, -0.154703, 0.498499, 0.211617, 0.622174, -0.16489, 0.500188, 0.229183, 0.628855, -0.175164, 0.503072, 0.247786, 0.636963, -0.185565, 0.506798, 0.267116, 0.644866, -0.195911, 0.509719, 0.28702, 0.653741, -0.206104, 0.512776, 0.307763, 0.664942, -0.216447, 0.516812, 0.329631, 0.67633, -0.22552, 0.519181, 0.353515, 0.690012, -0.234316, 0.521681, 0.379226, 0.704243, -0.242032, 0.523129, 0.405901, 0.719396, -0.249172, 0.523768, 0.433585, 0.734471, -0.255543, 0.522541, 0.462085, 0.750539, -0.260697, 0.520217, 0.491233, 0.766365, -0.26501, 0.516293, 0.521094, 0.781677, -0.268409, 0.509708, 0.551014, 0.797132, -0.270399, 0.501944, 0.581463, 0.812655, -0.271247, 0.492025, 0.612402, 0.828592, -0.270708, 0.480424, 0.643798, 0.844044, -0.268085, 0.465955, 0.67682, 0.857305, -0.263459, 0.448425, 0.708496, 0.87114, -0.258151, 0.430243, 0.74046, 0.884936, -0.251171, 0.410578, 0.771583, 0.895772, -0.243305, 0.38862, 0.802234, 0.906961, -0.234037, 0.365214, 0.833179, 0.917775, -0.222714, 0.34116, 0.86353, 0.927883, -0.210175, 0.31572, 0.893557, 0.936617, -0.196925, 0.289159, 0.922976, 0.943384, -0.182788, 0.261996, 0.951606, 0.949713, -0.167965, 0.235324, 0.979958, 0.955818, -0.151109, 0.208408, 1.00765, 0.961344, -0.133834, 0.182591, 1.03329, 0.965469, -0.115987, 0.156958, 1.0557, 0.968693, -0.09746, 0.132239, 1.07583, 0.973165, -0.0778514, 0.106195, 1.09451, 0.979387, -0.0585067, 0.0797669, 1.11137, 0.98671, -0.0390409, 0.0530263, 1.12643, 0.994093, -0.019408, 0.0263163, 1.14016, 1.00002, 0.000540029, -0.000194487, 1.15299, 0.574483, -9.89066e-06, 0.494533, 1.14896e-05, 0.574478, -0.000249127, 0.494528, 0.000289403, 0.574607, -0.000996811, 0.494637, 0.00115797, 0.574396, -0.00224241, 0.494458, 0.00260498, 0.574377, -0.00398632, 0.49444, 0.00463102, 0.574386, -0.00622836, 0.494445, 0.00723623, 0.574401, -0.0089683, 0.494453, 0.010421, 0.574419, -0.0122056, 0.49446, 0.0141859, 0.574459, -0.0159396, 0.494481, 0.0185322, 0.574525, -0.0201692, 0.49452, 0.0234617, 0.574587, -0.0248924, 0.494547, 0.0289762, 0.574697, -0.0301074, 0.494604, 0.0350797, 0.574853, -0.0358114, 0.494688, 0.0417767, 0.575027, -0.041999, 0.494772, 0.0490718, 0.575294, -0.0486618, 0.494915, 0.0569728, 0.575733, -0.0557148, 0.495173, 0.0654955, 0.576356, -0.0630489, 0.495537, 0.0746612, 0.576944, -0.0709285, 0.495836, 0.0844615, 0.57765, -0.0792723, 0.496177, 0.0949142, 0.578491, -0.0880167, 0.496563, 0.10603, 0.579639, -0.0969462, 0.497096, 0.117841, 0.580989, -0.10622, 0.497684, 0.130367, 0.582587, -0.115861, 0.498337, 0.143609, 0.584951, -0.125605, 0.499414, 0.157625, 0.587602, -0.135608, 0.500518, 0.172413, 0.59076, -0.145742, 0.501767, 0.187999, 0.594992, -0.155934, 0.503542, 0.20445, 0.600656, -0.166303, 0.506135, 0.221764, 0.607816, -0.176681, 0.509542, 0.24002, 0.61522, -0.187071, 0.51263, 0.258992, 0.623702, -0.197465, 0.516021, 0.278773, 0.634192, -0.207816, 0.520422, 0.299377, 0.644936, -0.218183, 0.524073, 0.320802, 0.657888, -0.2278, 0.528049, 0.34384, 0.670666, -0.236747, 0.52986, 0.36916, 0.685626, -0.24484, 0.531892, 0.395867, 0.701304, -0.252071, 0.532727, 0.423488, 0.717727, -0.258714, 0.532146, 0.452201, 0.733914, -0.264211, 0.529883, 0.481579, 0.750529, -0.26859, 0.5259, 0.511558, 0.76747, -0.272046, 0.51999, 0.542042, 0.785189, -0.274225, 0.513083, 0.572799, 0.800954, -0.275189, 0.502936, 0.603816, 0.816962, -0.274946, 0.490921, 0.635461, 0.83336, -0.272695, 0.47684, 0.6676, 0.848143, -0.268223, 0.459405, 0.70051, 0.861818, -0.262768, 0.440319, 0.732902, 0.876828, -0.255872, 0.420123, 0.765084, 0.889312, -0.247703, 0.398379, 0.796391, 0.900412, -0.238381, 0.374496, 0.827333, 0.912251, -0.227783, 0.349874, 0.858385, 0.921792, -0.214832, 0.323181, 0.888652, 0.931273, -0.200949, 0.296624, 0.917763, 0.940295, -0.186537, 0.269211, 0.947878, 0.946812, -0.171538, 0.241447, 0.977016, 0.953588, -0.155254, 0.213829, 1.00501, 0.958841, -0.137156, 0.186807, 1.03179, 0.963746, -0.118699, 0.160706, 1.05502, 0.966468, -0.0998358, 0.135504, 1.07568, 0.971178, -0.0805186, 0.109131, 1.09479, 0.97831, -0.0599348, 0.0818293, 1.1123, 0.985886, -0.0399661, 0.0545872, 1.12771, 0.994021, -0.0198682, 0.0269405, 1.14186, 1.00009, 0.000271022, -0.00012989, 1.15514, 0.538716, -9.90918e-06, 0.486732, 1.09675e-05, 0.550656, -0.000250642, 0.497518, 0.000277412, 0.55057, -0.00100265, 0.497441, 0.00110974, 0.550903, -0.00225672, 0.497733, 0.00249779, 0.550568, -0.00401046, 0.497438, 0.00443906, 0.550574, -0.00626613, 0.49744, 0.00693637, 0.550591, -0.0090226, 0.497449, 0.00998921, 0.550623, -0.0122795, 0.497469, 0.0135984, 0.550667, -0.0160361, 0.497495, 0.0177654, 0.550724, -0.0202908, 0.497526, 0.0224915, 0.550792, -0.0250421, 0.497557, 0.0277795, 0.550918, -0.0302878, 0.49763, 0.0336334, 0.551058, -0.0360241, 0.497701, 0.0400573, 0.551276, -0.0422473, 0.497824, 0.0470585, 0.551551, -0.0489441, 0.497977, 0.0546433, 0.552074, -0.0559596, 0.498312, 0.0628367, 0.552681, -0.0633978, 0.498679, 0.071646, 0.553324, -0.0713176, 0.499031, 0.0810746, 0.554011, -0.0797268, 0.499365, 0.091129, 0.55488, -0.0885238, 0.499779, 0.101837, 0.556171, -0.0974417, 0.500444, 0.113239, 0.557498, -0.106841, 0.501025, 0.125316, 0.559299, -0.116533, 0.501864, 0.138128, 0.561647, -0.126298, 0.502967, 0.151695, 0.564347, -0.136388, 0.504129, 0.16604, 0.567863, -0.146576, 0.505713, 0.181207, 0.572569, -0.156832, 0.507953, 0.197259, 0.578919, -0.167323, 0.511186, 0.214258, 0.585387, -0.177712, 0.514042, 0.232038, 0.593134, -0.188184, 0.517484, 0.250733, 0.603295, -0.198717, 0.522345, 0.270454, 0.613854, -0.209177, 0.526751, 0.290807, 0.626092, -0.219644, 0.531595, 0.312202, 0.637868, -0.229494, 0.534721, 0.334435, 0.652458, -0.238718, 0.538304, 0.359184, 0.666985, -0.247061, 0.539875, 0.385637, 0.683301, -0.254652, 0.541042, 0.41328, 0.69998, -0.261376, 0.540735, 0.441903, 0.717824, -0.267085, 0.539139, 0.471609, 0.734617, -0.271465, 0.534958, 0.501446, 0.753663, -0.27528, 0.53032, 0.532571, 0.770512, -0.277617, 0.522134, 0.563641, 0.787356, -0.278525, 0.51206, 0.595067, 0.806252, -0.278512, 0.50119, 0.627226, 0.822061, -0.277023, 0.486791, 0.659402, 0.838959, -0.273175, 0.470467, 0.692874, 0.85379, -0.267238, 0.450688, 0.725702, 0.868268, -0.260327, 0.429741, 0.75832, 0.881994, -0.251946, 0.407223, 0.790189, 0.893885, -0.242432, 0.383214, 0.821625, 0.905118, -0.231904, 0.357297, 0.853011, 0.916045, -0.219545, 0.330733, 0.883773, 0.927614, -0.205378, 0.303916, 0.914435, 0.936005, -0.190388, 0.275941, 0.944502, 0.944533, -0.1749, 0.247493, 0.974439, 0.950758, -0.158588, 0.218996, 1.00286, 0.957078, -0.141027, 0.191559, 1.0304, 0.962448, -0.121507, 0.164457, 1.05466, 0.964993, -0.102068, 0.138636, 1.0761, 0.970017, -0.0822598, 0.111861, 1.09541, 0.97661, -0.062033, 0.0843438, 1.11317, 0.985073, -0.0409832, 0.0558496, 1.12911, 0.993515, -0.020146, 0.0275331, 1.1438, 1.00006, 0.00027329, -0.000107883, 1.15736, 0.525324, -9.99341e-06, 0.498153, 1.05385e-05, 0.526513, -0.000251605, 0.499277, 0.000265329, 0.526517, -0.00100641, 0.499282, 0.0010613, 0.526588, -0.00226466, 0.499337, 0.00238823, 0.526539, -0.0040255, 0.499302, 0.00424535, 0.526547, -0.00628954, 0.499306, 0.00663364, 0.526561, -0.00905628, 0.499313, 0.00955337, 0.526593, -0.0123253, 0.499334, 0.0130054, 0.526642, -0.0160957, 0.499365, 0.0169911, 0.5267, -0.0203661, 0.499396, 0.0215122, 0.526792, -0.0251347, 0.499451, 0.0265718, 0.526904, -0.0303985, 0.499511, 0.0321732, 0.527079, -0.0361554, 0.499617, 0.0383231, 0.527285, -0.0423982, 0.499731, 0.045026, 0.527602, -0.0491121, 0.499924, 0.0522936, 0.528166, -0.0561127, 0.500306, 0.0601528, 0.52879, -0.0635988, 0.5007, 0.0686059, 0.529421, -0.071581, 0.501048, 0.0776518, 0.530144, -0.0799854, 0.501421, 0.0873148, 0.531062, -0.0888032, 0.501884, 0.0976084, 0.532374, -0.0977643, 0.50259, 0.108588, 0.533828, -0.107197, 0.50329, 0.120234, 0.53581, -0.116887, 0.504312, 0.132602, 0.538063, -0.126755, 0.505365, 0.145721, 0.5409, -0.136819, 0.506668, 0.159617, 0.544882, -0.147117, 0.508731, 0.174369, 0.550238, -0.157446, 0.511601, 0.190028, 0.556038, -0.167988, 0.514431, 0.206587, 0.563031, -0.178364, 0.517808, 0.224046, 0.571543, -0.189007, 0.521937, 0.242503, 0.582255, -0.199546, 0.527415, 0.261977, 0.59272, -0.210084, 0.531682, 0.282162, 0.605648, -0.220448, 0.537123, 0.303426, 0.61785, -0.230593, 0.540664, 0.325323, 0.632223, -0.240238, 0.544467, 0.348993, 0.648819, -0.24887, 0.547594, 0.375462, 0.665825, -0.256657, 0.54912, 0.403024, 0.683389, -0.263711, 0.549294, 0.431773, 0.701495, -0.269666, 0.547649, 0.461494, 0.719197, -0.274169, 0.543786, 0.491623, 0.737906, -0.278124, 0.538644, 0.522994, 0.756652, -0.280632, 0.531057, 0.554775, 0.775279, -0.281741, 0.521972, 0.586441, 0.792688, -0.281652, 0.509613, 0.618596, 0.811894, -0.280345, 0.496497, 0.651462, 0.827938, -0.277128, 0.47968, 0.684023, 0.844837, -0.271646, 0.460688, 0.718024, 0.859239, -0.264397, 0.438872, 0.751207, 0.874088, -0.256144, 0.41577, 0.784232, 0.887693, -0.246311, 0.391369, 0.816191, 0.899402, -0.235497, 0.365872, 0.847828, 0.910973, -0.223631, 0.338618, 0.87934, 0.92204, -0.209874, 0.310803, 0.910325, 0.930987, -0.194265, 0.281802, 0.940695, 0.94, -0.178125, 0.252836, 0.970958, 0.948018, -0.161479, 0.224239, 1.00078, 0.955141, -0.144038, 0.195857, 1.0288, 0.960513, -0.124915, 0.168487, 1.05371, 0.963964, -0.104284, 0.141495, 1.07596, 0.968713, -0.0838732, 0.114437, 1.09628, 0.975524, -0.0635579, 0.0863105, 1.11448, 0.98431, -0.042291, 0.0574774, 1.13069, 0.992916, -0.0209131, 0.0284343, 1.14568, 0.999926, 0.000743097, -0.000379265, 1.15955, 0.501042, -9.98428e-06, 0.498726, 1.00306e-05, 0.502992, -0.000252112, 0.500665, 0.000253283, 0.502417, -0.00100791, 0.500092, 0.00101259, 0.502965, -0.00226919, 0.500621, 0.00227978, 0.502318, -0.00403109, 0.499994, 0.00405011, 0.502333, -0.00629832, 0.500005, 0.00632868, 0.502362, -0.00906907, 0.500027, 0.00911446, 0.502369, -0.0123423, 0.500023, 0.0124078, 0.50243, -0.0161178, 0.500066, 0.016211, 0.502493, -0.0203937, 0.500103, 0.0205256, 0.502592, -0.0251684, 0.500166, 0.0253548, 0.502707, -0.0304389, 0.50023, 0.0307029, 0.502881, -0.0362015, 0.500335, 0.0365753, 0.503124, -0.0424507, 0.500488, 0.0429798, 0.503443, -0.0491582, 0.500686, 0.0499268, 0.504083, -0.0561476, 0.501155, 0.0574541, 0.504668, -0.0636846, 0.501524, 0.0655408, 0.505319, -0.0716834, 0.501904, 0.0742072, 0.50609, -0.0800925, 0.502321, 0.0834699, 0.507122, -0.0888425, 0.502896, 0.0933603, 0.508414, -0.097855, 0.503603, 0.10391, 0.509955, -0.107304, 0.504416, 0.115113, 0.512061, -0.116921, 0.505565, 0.127054, 0.514419, -0.12689, 0.506732, 0.139709, 0.517529, -0.136934, 0.508338, 0.153173, 0.522085, -0.147327, 0.510987, 0.167528, 0.526986, -0.157612, 0.513527, 0.182708, 0.533122, -0.168213, 0.516717, 0.198881, 0.540807, -0.178688, 0.520832, 0.215986, 0.550687, -0.189511, 0.52632, 0.234335, 0.560567, -0.199998, 0.531009, 0.253375, 0.571698, -0.210652, 0.535839, 0.273499, 0.584364, -0.220917, 0.541091, 0.294355, 0.599066, -0.23137, 0.546875, 0.316525, 0.614148, -0.241206, 0.551306, 0.339671, 0.631157, -0.250379, 0.555187, 0.36531, 0.647919, -0.258397, 0.556595, 0.392767, 0.666112, -0.265528, 0.556949, 0.421397, 0.686158, -0.271827, 0.556617, 0.451433, 0.704838, -0.27674, 0.552975, 0.482131, 0.723957, -0.280733, 0.547814, 0.513458, 0.74262, -0.283359, 0.53997, 0.545446, 0.762009, -0.284541, 0.530422, 0.57775, 0.781314, -0.284507, 0.518546, 0.610434, 0.799116, -0.283309, 0.504178, 0.643178, 0.817604, -0.280378, 0.48843, 0.676248, 0.83459, -0.275619, 0.469457, 0.709698, 0.850974, -0.26856, 0.447698, 0.744245, 0.866747, -0.260094, 0.424791, 0.777695, 0.881412, -0.249929, 0.399913, 0.810392, 0.8936, -0.239137, 0.37308, 0.842872, 0.905943, -0.226818, 0.345705, 0.874677, 0.916408, -0.213699, 0.31706, 0.906257, 0.927215, -0.198428, 0.288444, 0.936881, 0.935625, -0.181643, 0.258329, 0.96795, 0.944076, -0.164386, 0.228488, 0.998216, 0.951229, -0.146339, 0.199763, 1.02689, 0.958793, -0.127709, 0.172153, 1.0535, 0.963219, -0.107244, 0.144989, 1.07646, 0.967562, -0.0857764, 0.11685, 1.09675, 0.974866, -0.0645377, 0.0880571, 1.11576, 0.983353, -0.0431732, 0.0587352, 1.13227, 0.992503, -0.0218356, 0.0294181, 1.1478, 1.00003, 0.000605203, -0.000231013, 1.16207, 0.482935, -1.01177e-05, 0.504695, 9.68142e-06, 0.477554, -0.000251521, 0.499071, 0.000240676, 0.477904, -0.00100683, 0.499436, 0.00096342, 0.478368, -0.00226636, 0.499899, 0.0021687, 0.477977, -0.00402719, 0.499513, 0.00385384, 0.477993, -0.00629226, 0.499525, 0.0060221, 0.478011, -0.00906011, 0.499536, 0.00867289, 0.478051, -0.0123305, 0.499566, 0.0118074, 0.478089, -0.016102, 0.499587, 0.0154269, 0.478171, -0.0203736, 0.499645, 0.0195341, 0.478254, -0.025143, 0.499692, 0.0241318, 0.47839, -0.0304071, 0.499779, 0.0292247, 0.478588, -0.0361631, 0.499911, 0.0348196, 0.478812, -0.0424023, 0.500046, 0.0409231, 0.479208, -0.0490724, 0.500326, 0.047552, 0.479841, -0.0560722, 0.500805, 0.0547377, 0.480392, -0.0636125, 0.501152, 0.0624607, 0.481068, -0.0716134, 0.501561, 0.0707473, 0.481898, -0.0800062, 0.502054, 0.0796118, 0.483022, -0.0886568, 0.502728, 0.0890974, 0.484332, -0.0977553, 0.503479, 0.0992099, 0.486126, -0.107173, 0.504546, 0.10999, 0.488066, -0.11677, 0.50557, 0.121476, 0.490521, -0.126725, 0.506849, 0.133672, 0.494232, -0.136793, 0.50911, 0.146731, 0.498302, -0.147116, 0.511345, 0.160577, 0.503565, -0.157446, 0.514344, 0.175335, 0.510902, -0.168121, 0.518824, 0.191207, 0.519263, -0.178799, 0.523666, 0.208058, 0.528204, -0.189407, 0.528296, 0.225875, 0.538854, -0.200145, 0.533724, 0.244782, 0.551278, -0.210701, 0.539833, 0.264753, 0.565222, -0.221303, 0.546131, 0.285745, 0.579403, -0.231688, 0.551496, 0.307592, 0.595469, -0.241718, 0.556809, 0.330582, 0.610929, -0.250992, 0.559641, 0.354995, 0.629433, -0.259602, 0.562379, 0.382471, 0.648504, -0.267038, 0.563676, 0.411126, 0.66756, -0.273388, 0.562092, 0.440924, 0.689143, -0.278788, 0.560807, 0.472118, 0.709056, -0.282783, 0.555701, 0.503774, 0.729855, -0.285836, 0.548698, 0.536364, 0.748954, -0.287078, 0.538544, 0.56895, 0.768373, -0.287133, 0.526711, 0.601991, 0.78827, -0.285839, 0.512511, 0.635403, 0.807465, -0.283238, 0.496323, 0.668797, 0.825194, -0.27906, 0.477638, 0.702584, 0.842203, -0.272286, 0.456253, 0.736393, 0.857749, -0.263854, 0.432412, 0.77096, 0.874799, -0.253943, 0.407806, 0.80489, 0.887497, -0.24237, 0.38033, 0.83771, 0.89966, -0.230278, 0.352446, 0.870376, 0.911753, -0.21646, 0.323268, 0.902256, 0.923011, -0.202071, 0.294314, 0.933306, 0.932375, -0.185519, 0.264104, 0.965177, 0.940537, -0.167604, 0.234035, 0.996303, 0.948904, -0.149068, 0.20412, 1.0261, 0.955263, -0.129539, 0.175431, 1.05304, 0.960303, -0.109932, 0.148116, 1.07617, 0.965512, -0.0880572, 0.119693, 1.09742, 0.973466, -0.0660548, 0.0901619, 1.11721, 0.98284, -0.0439228, 0.0599875, 1.13436, 0.992216, -0.0219588, 0.0298975, 1.15006, 0.999946, 0.000119402, -2.08547e-05, 1.16471, 0.447827, -1.00414e-05, 0.491543, 9.14833e-06, 0.454778, -0.000251257, 0.499172, 0.00022891, 0.453519, -0.00100342, 0.497787, 0.000914184, 0.45357, -0.00225776, 0.497847, 0.00205701, 0.453578, -0.00401371, 0.497855, 0.00365705, 0.45357, -0.00627107, 0.497841, 0.00571453, 0.453598, -0.00902968, 0.497864, 0.00823019, 0.453627, -0.0122888, 0.497882, 0.0112049, 0.453684, -0.0160475, 0.497923, 0.0146405, 0.453764, -0.0203044, 0.49798, 0.0185394, 0.453866, -0.0250576, 0.498049, 0.0229054, 0.453996, -0.0303028, 0.49813, 0.0277424, 0.454196, -0.0360379, 0.498267, 0.0330587, 0.454457, -0.0422521, 0.498445, 0.0388613, 0.454926, -0.0488393, 0.498812, 0.0451767, 0.455525, -0.0558653, 0.499272, 0.0520153, 0.456074, -0.0633772, 0.499625, 0.0593754, 0.456752, -0.0713606, 0.500049, 0.0672751, 0.457648, -0.07971, 0.500615, 0.0757447, 0.458849, -0.0883032, 0.501399, 0.0848231, 0.46029, -0.0974095, 0.502293, 0.0945135, 0.462, -0.106729, 0.503301, 0.104848, 0.464121, -0.116354, 0.504533, 0.115884, 0.466889, -0.126214, 0.506172, 0.127652, 0.470744, -0.136324, 0.508667, 0.14024, 0.47488, -0.146595, 0.510995, 0.153673, 0.480845, -0.157027, 0.514832, 0.168053, 0.488262, -0.167658, 0.519506, 0.183508, 0.496547, -0.178343, 0.524347, 0.199948, 0.506254, -0.188916, 0.52983, 0.217503, 0.517961, -0.199975, 0.536357, 0.236272, 0.531484, -0.210624, 0.543641, 0.256096, 0.545496, -0.221227, 0.550048, 0.277085, 0.559497, -0.231568, 0.555076, 0.298615, 0.575752, -0.241698, 0.560541, 0.321547, 0.591999, -0.251172, 0.564156, 0.345602, 0.610654, -0.260178, 0.567607, 0.371851, 0.630484, -0.268094, 0.56923, 0.40076, 0.651807, -0.274661, 0.569779, 0.430801, 0.67239, -0.280331, 0.566791, 0.461939, 0.693024, -0.284501, 0.562007, 0.493854, 0.715473, -0.287852, 0.555791, 0.526992, 0.736323, -0.28929, 0.546345, 0.560102, 0.755771, -0.289405, 0.534, 0.593543, 0.775424, -0.2881, 0.519114, 0.627256, 0.795447, -0.285562, 0.502543, 0.661464, 0.815319, -0.281416, 0.484773, 0.695206, 0.831769, -0.275523, 0.463445, 0.729044, 0.849464, -0.267516, 0.440269, 0.764069, 0.866775, -0.257584, 0.415049, 0.799089, 0.881252, -0.245817, 0.388049, 0.831948, 0.894209, -0.233127, 0.35889, 0.865526, 0.906922, -0.219579, 0.329915, 0.89818, 0.919686, -0.204491, 0.300441, 0.930013, 0.929044, -0.188962, 0.269445, 0.962061, 0.938393, -0.171079, 0.238402, 0.994214, 0.94661, -0.15199, 0.208204, 1.02533, 0.953095, -0.131953, 0.178653, 1.0529, 0.958644, -0.111233, 0.150684, 1.0771, 0.963925, -0.0903098, 0.122359, 1.09855, 0.971995, -0.0680505, 0.0923342, 1.11874, 0.981658, -0.0448512, 0.0614195, 1.13635, 0.991649, -0.0221931, 0.0303582, 1.15238, 0.999985, 0.000393403, -0.000111086, 1.16772, 0.396806, -9.71563e-06, 0.457671, 8.42355e-06, 0.429186, -0.000249421, 0.495017, 0.00021625, 0.429324, -0.000998052, 0.495173, 0.000865322, 0.429175, -0.00224487, 0.494999, 0.00194637, 0.429129, -0.00399041, 0.494952, 0.00346004, 0.429153, -0.00623476, 0.494974, 0.00540684, 0.429168, -0.0089773, 0.494983, 0.00778714, 0.429207, -0.0122175, 0.495012, 0.0106022, 0.429257, -0.0159542, 0.495047, 0.0138535, 0.429338, -0.0201864, 0.495106, 0.0175443, 0.429431, -0.0249104, 0.495165, 0.0216774, 0.429587, -0.0301252, 0.495279, 0.0262594, 0.429796, -0.0358249, 0.495432, 0.0312968, 0.430065, -0.0419972, 0.495621, 0.0367985, 0.430588, -0.0485144, 0.496061, 0.042798, 0.43113, -0.0555028, 0.496472, 0.0492914, 0.431743, -0.0629852, 0.496904, 0.0562907, 0.432448, -0.0709256, 0.497369, 0.0638056, 0.433414, -0.0791942, 0.498032, 0.071885, 0.434638, -0.0877346, 0.498854, 0.0805517, 0.43611, -0.0968056, 0.499812, 0.0898047, 0.437859, -0.106002, 0.500891, 0.0997142, 0.440017, -0.115648, 0.502198, 0.110289, 0.443236, -0.125427, 0.504389, 0.121644, 0.44697, -0.135492, 0.506809, 0.133769, 0.451689, -0.145746, 0.509858, 0.146787, 0.45811, -0.156219, 0.514247, 0.160793, 0.465305, -0.166834, 0.518816, 0.175791, 0.474085, -0.177546, 0.524331, 0.191906, 0.484808, -0.188262, 0.53104, 0.209199, 0.49732, -0.199346, 0.538511, 0.227825, 0.509693, -0.209951, 0.544554, 0.247269, 0.524367, -0.220533, 0.551616, 0.267978, 0.539228, -0.231082, 0.557368, 0.289672, 0.55644, -0.241342, 0.563782, 0.31268, 0.574204, -0.250964, 0.568851, 0.33651, 0.593388, -0.260306, 0.57312, 0.362219, 0.613358, -0.268667, 0.574916, 0.390322, 0.634512, -0.275591, 0.575053, 0.420478, 0.65563, -0.281328, 0.572404, 0.451614, 0.678265, -0.285948, 0.568893, 0.484112, 0.70011, -0.289408, 0.561878, 0.517348, 0.723005, -0.291328, 0.55359, 0.551355, 0.743744, -0.291418, 0.541099, 0.585109, 0.763949, -0.290252, 0.526489, 0.619487, 0.784186, -0.287648, 0.509496, 0.65404, 0.804304, -0.283782, 0.491484, 0.688649, 0.823629, -0.278067, 0.470517, 0.723133, 0.84094, -0.270588, 0.44705, 0.757163, 0.857852, -0.261188, 0.421252, 0.792816, 0.874934, -0.249313, 0.394191, 0.827248, 0.888709, -0.236492, 0.365359, 0.861074, 0.902589, -0.222185, 0.336016, 0.894417, 0.914201, -0.207314, 0.30527, 0.926825, 0.925978, -0.191146, 0.274532, 0.9595, 0.93512, -0.174135, 0.243393, 0.991583, 0.943656, -0.155231, 0.212414, 1.02356, 0.951719, -0.134403, 0.182005, 1.05239, 0.957164, -0.113023, 0.153043, 1.07754, 0.962656, -0.0914493, 0.124186, 1.09984, 0.970695, -0.0694179, 0.0941654, 1.12, 0.980749, -0.0466199, 0.0629671, 1.13849, 0.991205, -0.0227032, 0.0311146, 1.15494, 0.999884, 0.000632388, -0.000254483, 1.1706, 0.379821, -9.57289e-06, 0.460637, 7.89337e-06, 0.405188, -0.000247483, 0.491396, 0.000204064, 0.404796, -0.000989434, 0.490914, 0.000815853, 0.40483, -0.00222607, 0.490949, 0.00183559, 0.40473, -0.00395723, 0.49084, 0.00326332, 0.404731, -0.00618287, 0.490836, 0.00509945, 0.404768, -0.00890258, 0.490871, 0.00734463, 0.404791, -0.0121156, 0.490883, 0.00999992, 0.404857, -0.0158214, 0.490938, 0.0130676, 0.404943, -0.0200178, 0.491004, 0.0165503, 0.405059, -0.0247027, 0.491093, 0.0204521, 0.405213, -0.0298729, 0.491205, 0.0247788, 0.405399, -0.0355226, 0.491333, 0.0295373, 0.405731, -0.0416352, 0.491604, 0.034741, 0.406303, -0.0480807, 0.492116, 0.0404255, 0.406814, -0.0550458, 0.492506, 0.0465732, 0.407404, -0.0624652, 0.492926, 0.0532058, 0.408149, -0.0702958, 0.493442, 0.0603442, 0.409128, -0.0784623, 0.494136, 0.0680297, 0.410408, -0.087007, 0.495054, 0.0762786, 0.411813, -0.0959639, 0.495962, 0.0851046, 0.413735, -0.105075, 0.497257, 0.0945878, 0.416137, -0.114646, 0.498882, 0.104725, 0.41934, -0.124394, 0.501132, 0.11563, 0.423326, -0.134328, 0.503883, 0.127325, 0.428419, -0.14458, 0.50747, 0.139911, 0.43484, -0.154979, 0.511964, 0.153481, 0.442641, -0.165628, 0.517328, 0.168114, 0.452511, -0.176365, 0.524258, 0.183995, 0.463473, -0.187298, 0.531248, 0.200953, 0.475564, -0.198244, 0.538367, 0.219176, 0.488664, -0.208938, 0.545175, 0.238514, 0.504073, -0.219599, 0.553227, 0.259129, 0.520832, -0.230378, 0.560653, 0.280997, 0.538455, -0.240703, 0.567523, 0.303821, 0.55709, -0.250548, 0.573287, 0.327948, 0.576646, -0.259964, 0.577795, 0.353362, 0.596705, -0.268721, 0.580077, 0.380336, 0.618053, -0.276054, 0.58018, 0.4101, 0.640303, -0.282176, 0.578747, 0.44161, 0.662365, -0.286931, 0.574294, 0.474106, 0.684542, -0.290521, 0.567035, 0.507549, 0.707984, -0.292672, 0.558687, 0.541853, 0.730913, -0.293189, 0.547606, 0.576581, 0.752948, -0.292199, 0.533471, 0.61172, 0.773452, -0.289508, 0.516395, 0.646339, 0.794715, -0.285716, 0.497873, 0.682131, 0.814251, -0.280051, 0.476845, 0.716396, 0.833057, -0.272873, 0.453449, 0.751503, 0.84959, -0.263982, 0.427857, 0.786085, 0.867022, -0.252745, 0.400335, 0.821355, 0.882277, -0.239655, 0.371304, 0.85646, 0.895375, -0.225386, 0.340397, 0.890828, 0.909347, -0.209587, 0.310005, 0.923532, 0.921885, -0.193433, 0.2796, 0.956419, 0.932127, -0.176135, 0.247276, 0.989445, 0.941869, -0.157872, 0.216186, 1.02221, 0.949735, -0.137577, 0.185602, 1.05195, 0.956617, -0.115285, 0.155767, 1.07822, 0.961974, -0.0928418, 0.126103, 1.10149, 0.96972, -0.0700592, 0.0956758, 1.12207, 0.98012, -0.0474671, 0.0643269, 1.1408, 0.990825, -0.0238113, 0.0320863, 1.1577, 0.999876, 0.000381574, -8.12203e-05, 1.17403, 0.367636, -9.61342e-06, 0.469176, 7.53287e-06, 0.380377, -0.000244772, 0.485434, 0.000191797, 0.380416, -0.000978857, 0.485475, 0.000767015, 0.380376, -0.00220165, 0.485435, 0.00172522, 0.380419, -0.00391408, 0.485487, 0.00306734, 0.380438, -0.00611549, 0.485505, 0.00479332, 0.380462, -0.00880558, 0.485525, 0.00690391, 0.380496, -0.0119837, 0.485551, 0.00940039, 0.38056, -0.0156487, 0.485605, 0.0122848, 0.38064, -0.0197988, 0.485666, 0.0155601, 0.380767, -0.0244324, 0.48577, 0.0192313, 0.380909, -0.0295444, 0.485871, 0.0233032, 0.381142, -0.0351321, 0.48606, 0.0277861, 0.381472, -0.0411535, 0.486336, 0.0326939, 0.382015, -0.0475408, 0.486833, 0.0380565, 0.382523, -0.0544395, 0.487231, 0.0438615, 0.383129, -0.061784, 0.487683, 0.0501332, 0.383952, -0.0695085, 0.488313, 0.0568996, 0.38498, -0.0775819, 0.489077, 0.0641952, 0.386331, -0.0860443, 0.490113, 0.0720324, 0.387788, -0.0948406, 0.491099, 0.0804379, 0.389808, -0.103899, 0.492566, 0.0894899, 0.39252, -0.113313, 0.494601, 0.0992098, 0.395493, -0.123007, 0.496619, 0.109641, 0.399826, -0.132859, 0.499912, 0.120919, 0.405341, -0.143077, 0.504061, 0.133107, 0.411932, -0.153465, 0.508905, 0.146263, 0.420591, -0.164108, 0.515482, 0.160544, 0.43101, -0.174893, 0.523191, 0.176123, 0.441881, -0.185839, 0.53026, 0.192757, 0.453919, -0.196633, 0.537295, 0.210535, 0.468715, -0.207611, 0.546156, 0.229886, 0.485182, -0.218517, 0.555173, 0.250543, 0.501926, -0.229249, 0.562728, 0.27221, 0.51785, -0.239481, 0.567494, 0.294892, 0.536947, -0.249395, 0.573889, 0.318987, 0.557115, -0.259, 0.578831, 0.344348, 0.577966, -0.268075, 0.582055, 0.371223, 0.599489, -0.276115, 0.583307, 0.399834, 0.62479, -0.282523, 0.583902, 0.431415, 0.647504, -0.287663, 0.57953, 0.464301, 0.670601, -0.291538, 0.573103, 0.498123, 0.693539, -0.293842, 0.563731, 0.532662, 0.717385, -0.294681, 0.553169, 0.567925, 0.741533, -0.293717, 0.539908, 0.603502, 0.762142, -0.291156, 0.521902, 0.639074, 0.783014, -0.28719, 0.502815, 0.674439, 0.805158, -0.281773, 0.482598, 0.710497, 0.823646, -0.274682, 0.458949, 0.7456, 0.841879, -0.266184, 0.433129, 0.781085, 0.859515, -0.255682, 0.406064, 0.816, 0.875335, -0.242849, 0.376509, 0.851074, 0.890147, -0.228329, 0.345502, 0.886473, 0.903144, -0.212491, 0.31428, 0.920751, 0.916618, -0.195695, 0.282994, 0.954606, 0.927953, -0.178267, 0.251091, 0.988402, 0.937414, -0.159549, 0.219107, 1.02141, 0.946823, -0.140022, 0.18896, 1.05167, 0.954651, -0.118154, 0.158667, 1.07819, 0.959955, -0.0946636, 0.128808, 1.1025, 0.96858, -0.0711792, 0.0973787, 1.12391, 0.97938, -0.0475046, 0.0650965, 1.14322, 0.990498, -0.024059, 0.0326267, 1.16077, 0.999844, -5.12408e-05, 0.000112444, 1.17727, 0.316912, -9.34977e-06, 0.425996, 6.95559e-06, 0.356423, -0.000241372, 0.479108, 0.000179562, 0.356272, -0.000965292, 0.478897, 0.00071811, 0.356262, -0.00217182, 0.478894, 0.00161574, 0.356265, -0.00386092, 0.478895, 0.00287261, 0.356278, -0.0060324, 0.478905, 0.00448907, 0.356293, -0.00868565, 0.478914, 0.00646572, 0.356346, -0.0118207, 0.478965, 0.00880438, 0.356395, -0.0154355, 0.479001, 0.0115066, 0.356484, -0.019529, 0.479075, 0.0145762, 0.356609, -0.0240991, 0.47918, 0.018018, 0.356766, -0.0291413, 0.479305, 0.0218379, 0.357009, -0.0346498, 0.479512, 0.0260454, 0.357424, -0.0405462, 0.479909, 0.0306657, 0.357899, -0.0468825, 0.480337, 0.0357054, 0.358424, -0.0536887, 0.480771, 0.0411728, 0.359041, -0.0609416, 0.481242, 0.0470841, 0.359903, -0.0685239, 0.481943, 0.0534831, 0.360932, -0.0764883, 0.482741, 0.0603795, 0.362196, -0.0848364, 0.483688, 0.0678028, 0.363847, -0.0935002, 0.484947, 0.0758086, 0.365972, -0.102471, 0.486588, 0.0844173, 0.368741, -0.111751, 0.488787, 0.0937199, 0.372146, -0.121334, 0.491405, 0.103732, 0.377114, -0.131147, 0.495604, 0.114608, 0.38226, -0.141213, 0.499436, 0.126345, 0.389609, -0.151632, 0.505334, 0.139116, 0.397925, -0.162073, 0.51168, 0.152995, 0.407824, -0.172819, 0.518876, 0.168071, 0.420014, -0.183929, 0.527639, 0.184495, 0.434266, -0.195032, 0.537588, 0.20232, 0.447352, -0.205792, 0.544379, 0.221189, 0.463726, -0.216704, 0.553422, 0.241616, 0.481406, -0.227531, 0.562074, 0.263298, 0.498707, -0.238017, 0.568227, 0.286116, 0.518039, -0.247936, 0.574473, 0.3101, 0.538277, -0.257437, 0.579191, 0.335401, 0.561166, -0.266829, 0.584807, 0.362246, 0.583189, -0.275329, 0.586476, 0.390609, 0.606024, -0.28234, 0.585578, 0.420998, 0.632419, -0.287924, 0.584496, 0.454357, 0.656128, -0.291972, 0.577766, 0.488233, 0.679953, -0.29456, 0.56875, 0.523248, 0.704654, -0.295816, 0.558388, 0.559168, 0.729016, -0.295157, 0.544826, 0.595326, 0.752062, -0.292779, 0.528273, 0.631864, 0.773138, -0.288681, 0.508482, 0.667793, 0.794869, -0.283358, 0.487341, 0.704035, 0.815101, -0.27608, 0.46354, 0.739925, 0.834212, -0.26767, 0.438672, 0.775539, 0.852368, -0.257397, 0.411239, 0.810895, 0.870207, -0.245689, 0.3829, 0.846472, 0.884063, -0.231452, 0.351496, 0.881788, 0.898284, -0.215561, 0.31895, 0.917438, 0.912964, -0.198208, 0.287367, 0.952422, 0.924666, -0.180426, 0.254487, 0.987551, 0.934429, -0.161525, 0.222226, 1.02142, 0.943485, -0.141197, 0.191143, 1.05218, 0.9521, -0.120085, 0.161112, 1.07937, 0.957876, -0.0975881, 0.130982, 1.10403, 0.966943, -0.0726842, 0.0990553, 1.12616, 0.978313, -0.0483705, 0.0662818, 1.14619, 0.990048, -0.0239072, 0.0329243, 1.16413, 0.999984, 0.000461885, -7.72859e-05, 1.18099, 0.321287, -9.35049e-06, 0.455413, 6.59662e-06, 0.332595, -0.000237513, 0.471437, 0.000167562, 0.332729, -0.000949964, 0.471618, 0.000670192, 0.332305, -0.00213618, 0.471028, 0.00150712, 0.332326, -0.00379765, 0.471055, 0.00267959, 0.332344, -0.00593353, 0.471072, 0.00418751, 0.332356, -0.00854349, 0.471077, 0.00603172, 0.332403, -0.0116268, 0.471121, 0.00821362, 0.332461, -0.0151824, 0.47117, 0.0107357, 0.332552, -0.0192088, 0.471251, 0.0136014, 0.332657, -0.0237024, 0.47133, 0.0168152, 0.332835, -0.0286615, 0.471487, 0.0203853, 0.333083, -0.0340765, 0.471708, 0.0243212, 0.333547, -0.0398563, 0.47219, 0.0286518, 0.333989, -0.0460916, 0.472587, 0.0333763, 0.334532, -0.0527897, 0.473054, 0.0385084, 0.335167, -0.0599284, 0.473568, 0.0440638, 0.33608, -0.0673514, 0.474362, 0.0500962, 0.337146, -0.0752237, 0.475231, 0.0566022, 0.338462, -0.083418, 0.476282, 0.0636272, 0.34014, -0.0919382, 0.477615, 0.0712153, 0.342341, -0.100741, 0.479404, 0.079417, 0.345088, -0.109905, 0.481618, 0.0882631, 0.349049, -0.119369, 0.485081, 0.0978851, 0.353939, -0.129033, 0.489317, 0.108336, 0.359893, -0.139038, 0.494309, 0.119698, 0.366945, -0.149411, 0.499983, 0.132024, 0.375814, -0.159843, 0.507185, 0.145558, 0.387112, -0.170664, 0.516392, 0.160433, 0.40023, -0.181897, 0.526519, 0.176648, 0.412555, -0.192785, 0.53423, 0.193922, 0.427023, -0.203663, 0.542741, 0.212662, 0.443685, -0.214695, 0.552066, 0.232944, 0.461499, -0.225561, 0.560762, 0.254495, 0.480975, -0.236257, 0.569421, 0.277531, 0.501, -0.24639, 0.576101, 0.301724, 0.521691, -0.256101, 0.581493, 0.327112, 0.543478, -0.265289, 0.585221, 0.353917, 0.566094, -0.273938, 0.587614, 0.381941, 0.589578, -0.281679, 0.587991, 0.41172, 0.614583, -0.287655, 0.585928, 0.444148, 0.641813, -0.292228, 0.582092, 0.478617, 0.666189, -0.295172, 0.57398, 0.51397, 0.690475, -0.29648, 0.561676, 0.550118, 0.715543, -0.296203, 0.548758, 0.586933, 0.740405, -0.293999, 0.532792, 0.62384, 0.762183, -0.28998, 0.512735, 0.660723, 0.786069, -0.28478, 0.492402, 0.69807, 0.806812, -0.277568, 0.469058, 0.734422, 0.826987, -0.268951, 0.443017, 0.770946, 0.844588, -0.259049, 0.415501, 0.80699, 0.863725, -0.2471, 0.387328, 0.842107, 0.879137, -0.234157, 0.356108, 0.878078, 0.894634, -0.218719, 0.324315, 0.914058, 0.909162, -0.201293, 0.291813, 0.949922, 0.92072, -0.18267, 0.258474, 0.985337, 0.93158, -0.163212, 0.225593, 1.0205, 0.941238, -0.142771, 0.193986, 1.05273, 0.949293, -0.120956, 0.163392, 1.08075, 0.956226, -0.0985743, 0.132934, 1.10559, 0.96546, -0.075118, 0.101255, 1.12823, 0.977403, -0.0497921, 0.0675441, 1.149, 0.989648, -0.0241574, 0.0334681, 1.16765, 1.00001, 0.0005762, -0.000184807, 1.18519, 0.303474, -9.16603e-06, 0.4542, 6.1243e-06, 0.308894, -0.000232869, 0.462306, 0.000155592, 0.309426, -0.000931661, 0.463093, 0.000622499, 0.308643, -0.0020949, 0.461933, 0.00139979, 0.308651, -0.0037242, 0.461941, 0.00248874, 0.308662, -0.00581873, 0.46195, 0.00388933, 0.308687, -0.00837818, 0.461974, 0.00560247, 0.308728, -0.0114016, 0.462011, 0.00762948, 0.308789, -0.0148884, 0.462067, 0.00997326, 0.308882, -0.0188369, 0.462151, 0.0126375, 0.309007, -0.0232436, 0.462263, 0.0156271, 0.30918, -0.0281054, 0.462417, 0.0189498, 0.309442, -0.0334065, 0.462667, 0.0226167, 0.309901, -0.0390589, 0.463162, 0.0266614, 0.310331, -0.0452042, 0.463555, 0.0310715, 0.310858, -0.0517735, 0.464019, 0.0358698, 0.311576, -0.0587359, 0.464669, 0.0410848, 0.312436, -0.0660383, 0.465406, 0.0467453, 0.313526, -0.0737266, 0.466339, 0.0528718, 0.314903, -0.0817574, 0.467504, 0.0595039, 0.316814, -0.090167, 0.469226, 0.0666888, 0.318965, -0.0987555, 0.470981, 0.0744658, 0.322077, -0.107792, 0.473814, 0.082912, 0.325947, -0.117098, 0.477241, 0.0920846, 0.331008, -0.126602, 0.48184, 0.102137, 0.337893, -0.136619, 0.488334, 0.113135, 0.345106, -0.146838, 0.494415, 0.12511, 0.355111, -0.157357, 0.503275, 0.138356, 0.365095, -0.167955, 0.510966, 0.152686, 0.378344, -0.179157, 0.521508, 0.16856, 0.391599, -0.190143, 0.530455, 0.18561, 0.407786, -0.20123, 0.541275, 0.204308, 0.425294, -0.212456, 0.551784, 0.224623, 0.444021, -0.223568, 0.561493, 0.246172, 0.463418, -0.234154, 0.569886, 0.268979, 0.484077, -0.244546, 0.577116, 0.293411, 0.505513, -0.254301, 0.582914, 0.318936, 0.527672, -0.263564, 0.587208, 0.345856, 0.550565, -0.272332, 0.589277, 0.374054, 0.573656, -0.280011, 0.588426, 0.403276, 0.59827, -0.286924, 0.587504, 0.43474, 0.624731, -0.291994, 0.583401, 0.468767, 0.652396, -0.295159, 0.576997, 0.504411, 0.67732, -0.296954, 0.565863, 0.54114, 0.703147, -0.296877, 0.552316, 0.57816, 0.728715, -0.295147, 0.536773, 0.616124, 0.752448, -0.291275, 0.51771, 0.653885, 0.775169, -0.285905, 0.496087, 0.691537, 0.799307, -0.279064, 0.474232, 0.729251, 0.819482, -0.270294, 0.447676, 0.766267, 0.837659, -0.260032, 0.419656, 0.802616, 0.856903, -0.248497, 0.391328, 0.838583, 0.873325, -0.235252, 0.360285, 0.874711, 0.889788, -0.221126, 0.329215, 0.91077, 0.904486, -0.204304, 0.296392, 0.94653, 0.917711, -0.185562, 0.262159, 0.983828, 0.928969, -0.165635, 0.229142, 1.01955, 0.939707, -0.14442, 0.19673, 1.05317, 0.948167, -0.122147, 0.165095, 1.0823, 0.955222, -0.099098, 0.13451, 1.10791, 0.964401, -0.0755332, 0.102476, 1.1312, 0.976605, -0.0513817, 0.0689667, 1.15218, 0.989085, -0.0258499, 0.034506, 1.17129, 0.999908, 0.000617773, -0.000271268, 1.18961, 0.285803, -9.05752e-06, 0.452348, 5.72272e-06, 0.284689, -0.00022732, 0.450581, 0.000143626, 0.285263, -0.000910214, 0.451482, 0.000575099, 0.285302, -0.00204784, 0.451553, 0.00129395, 0.285318, -0.00364057, 0.451574, 0.0023006, 0.28533, -0.00568813, 0.451585, 0.00359547, 0.285361, -0.00819001, 0.451618, 0.00517934, 0.285397, -0.0111458, 0.45165, 0.007054, 0.285447, -0.0145536, 0.451688, 0.00922167, 0.285527, -0.0184127, 0.451758, 0.0116869, 0.285688, -0.0227207, 0.451929, 0.0144555, 0.28584, -0.0274712, 0.452055, 0.0175341, 0.286136, -0.0326278, 0.452369, 0.0209406, 0.286574, -0.0381792, 0.452853, 0.0246965, 0.287012, -0.0441879, 0.453272, 0.0287996, 0.287542, -0.0506096, 0.453752, 0.033268, 0.288299, -0.0573634, 0.454488, 0.0381504, 0.289186, -0.0645458, 0.455294, 0.0434447, 0.290302, -0.0720405, 0.456301, 0.0491973, 0.291776, -0.0799046, 0.457648, 0.0554453, 0.29372, -0.088117, 0.459483, 0.0622311, 0.296052, -0.0965328, 0.461571, 0.0695992, 0.299563, -0.105409, 0.465085, 0.077658, 0.30335, -0.114553, 0.468506, 0.0864176, 0.309167, -0.123917, 0.474423, 0.0961078, 0.31529, -0.13381, 0.47995, 0.106643, 0.324163, -0.144021, 0.488592, 0.118322, 0.333272, -0.154382, 0.496461, 0.131133, 0.344224, -0.165015, 0.50562, 0.145208, 0.357733, -0.176168, 0.516719, 0.16073, 0.373046, -0.187468, 0.528513, 0.177807, 0.38788, -0.198488, 0.537713, 0.196072, 0.405133, -0.209545, 0.547999, 0.21605, 0.423845, -0.220724, 0.55759, 0.237484, 0.443777, -0.231518, 0.566246, 0.26039, 0.464824, -0.242035, 0.574326, 0.284835, 0.486635, -0.251898, 0.58037, 0.310518, 0.51012, -0.261304, 0.58568, 0.337678, 0.535301, -0.270384, 0.590197, 0.366242, 0.559193, -0.27841, 0.590569, 0.395873, 0.583544, -0.285325, 0.588161, 0.426857, 0.608834, -0.291113, 0.584249, 0.459477, 0.635753, -0.294882, 0.57763, 0.494734, 0.664367, -0.297088, 0.569479, 0.532023, 0.689688, -0.297364, 0.555064, 0.569629, 0.715732, -0.295949, 0.539522, 0.608124, 0.741307, -0.292259, 0.521613, 0.646231, 0.764949, -0.287063, 0.49969, 0.684938, 0.788599, -0.28012, 0.476747, 0.723548, 0.81048, -0.27153, 0.45116, 0.761135, 0.831372, -0.261289, 0.424101, 0.798916, 0.850092, -0.249559, 0.39443, 0.835952, 0.867777, -0.236348, 0.363849, 0.871606, 0.884632, -0.221569, 0.332477, 0.907843, 0.90047, -0.20618, 0.300667, 0.944187, 0.914524, -0.188771, 0.266552, 0.981371, 0.926892, -0.168362, 0.232349, 1.01841, 0.937951, -0.146761, 0.199359, 1.05308, 0.947236, -0.123813, 0.1675, 1.0839, 0.954367, -0.099984, 0.136166, 1.11047, 0.963907, -0.0759278, 0.103808, 1.13414, 0.976218, -0.0511367, 0.0697061, 1.15575, 0.988772, -0.0267415, 0.0352529, 1.17531, 0.999888, -0.000520778, 0.000289926, 1.19389, 0.263546, -8.83274e-06, 0.441896, 5.26783e-06, 0.262352, -0.000221849, 0.439889, 0.000132311, 0.262325, -0.000886683, 0.439848, 0.000528824, 0.26228, -0.00199476, 0.439765, 0.00118975, 0.262372, -0.00354671, 0.439922, 0.00211568, 0.26239, -0.00554141, 0.439941, 0.00330652, 0.262412, -0.00797888, 0.439961, 0.00476346, 0.262453, -0.0108584, 0.440002, 0.00648818, 0.262528, -0.0141788, 0.440085, 0.0084835, 0.262615, -0.017938, 0.440166, 0.0107533, 0.262744, -0.0221346, 0.440291, 0.0133044, 0.262939, -0.026762, 0.440493, 0.0161445, 0.263277, -0.0317573, 0.440889, 0.0192974, 0.26368, -0.0371832, 0.441338, 0.0227699, 0.264106, -0.0430371, 0.441753, 0.0265698, 0.264624, -0.0493035, 0.442227, 0.0307178, 0.265378, -0.0558669, 0.442985, 0.0352616, 0.266253, -0.0628718, 0.443795, 0.0401968, 0.267478, -0.0701569, 0.445008, 0.04559, 0.269062, -0.077845, 0.446599, 0.0514539, 0.270926, -0.0857941, 0.448349, 0.0578382, 0.273693, -0.0940773, 0.451221, 0.0648363, 0.276746, -0.102704, 0.454097, 0.0724389, 0.281693, -0.111735, 0.459517, 0.0808744, 0.287335, -0.121004, 0.46531, 0.0901551, 0.29448, -0.130734, 0.472605, 0.100371, 0.30257, -0.140777, 0.480251, 0.111644, 0.312465, -0.15111, 0.489444, 0.124111, 0.324856, -0.16189, 0.500919, 0.137979, 0.33774, -0.172946, 0.511317, 0.153163, 0.35255, -0.184152, 0.522684, 0.169817, 0.367786, -0.19522, 0.53248, 0.187886, 0.385474, -0.20632, 0.543326, 0.207634, 0.404976, -0.217744, 0.554109, 0.229165, 0.425203, -0.228691, 0.563395, 0.252068, 0.446704, -0.239299, 0.571565, 0.276471, 0.468951, -0.249348, 0.577935, 0.302323, 0.493487, -0.258933, 0.584309, 0.329882, 0.517861, -0.268009, 0.58773, 0.358525, 0.543309, -0.276238, 0.589612, 0.388585, 0.569704, -0.28356, 0.589294, 0.419787, 0.594871, -0.289497, 0.585137, 0.452114, 0.622555, -0.294452, 0.580356, 0.486466, 0.651167, -0.296918, 0.57185, 0.523079, 0.677332, -0.297647, 0.558428, 0.5611, 0.703718, -0.296321, 0.542232, 0.599592, 0.730262, -0.293339, 0.524541, 0.639138, 0.754304, -0.288036, 0.502691, 0.677978, 0.778051, -0.281018, 0.479212, 0.716537, 0.801557, -0.272414, 0.454071, 0.75586, 0.822559, -0.262419, 0.425952, 0.794477, 0.843051, -0.250702, 0.397313, 0.832664, 0.86232, -0.237264, 0.366534, 0.869876, 0.879044, -0.222716, 0.334816, 0.906973, 0.896362, -0.206827, 0.303143, 0.943558, 0.910342, -0.189659, 0.269699, 0.979759, 0.924119, -0.171108, 0.236411, 1.01718, 0.935374, -0.149579, 0.202224, 1.05289, 0.944295, -0.126295, 0.16989, 1.08496, 0.952227, -0.101511, 0.138089, 1.11256, 0.962041, -0.0766392, 0.105053, 1.1375, 0.97528, -0.0511967, 0.070329, 1.15983, 0.988476, -0.025463, 0.0351268, 1.17987, 0.999962, 2.86808e-05, 1.45564e-05, 1.19901, 0.227089, -8.41413e-06, 0.404216, 4.72707e-06, 0.239725, -0.000215083, 0.426708, 0.000120833, 0.239904, -0.000860718, 0.427028, 0.000483555, 0.239911, -0.00193661, 0.427039, 0.00108806, 0.239914, -0.00344276, 0.42704, 0.00193457, 0.239933, -0.00537907, 0.427064, 0.00302363, 0.239944, -0.00774482, 0.427065, 0.00435604, 0.239993, -0.01054, 0.427122, 0.00593398, 0.240052, -0.0137626, 0.427179, 0.00775987, 0.240148, -0.0174115, 0.427279, 0.00983854, 0.240278, -0.021484, 0.42741, 0.0121763, 0.240472, -0.0259729, 0.427618, 0.0147827, 0.240839, -0.0308131, 0.428086, 0.0176837, 0.241201, -0.0360893, 0.428482, 0.0208775, 0.241626, -0.0417723, 0.428907, 0.0243821, 0.242207, -0.0478337, 0.42952, 0.0282228, 0.24298, -0.0542199, 0.430332, 0.0324333, 0.243881, -0.0610015, 0.431222, 0.0370252, 0.245123, -0.0680874, 0.432512, 0.0420535, 0.24667, -0.0755482, 0.434088, 0.0475414, 0.248779, -0.0832873, 0.436323, 0.0535542, 0.251665, -0.0913546, 0.439509, 0.0601716, 0.255305, -0.0998489, 0.443478, 0.0674282, 0.260049, -0.108576, 0.448713, 0.0754673, 0.266192, -0.117754, 0.455524, 0.084339, 0.273158, -0.127294, 0.4627, 0.0941683, 0.282131, -0.137311, 0.472068, 0.10515, 0.293332, -0.147736, 0.483565, 0.117402, 0.304667, -0.158357, 0.493702, 0.130824, 0.317785, -0.169274, 0.504708, 0.145724, 0.333245, -0.180595, 0.517107, 0.16215, 0.349843, -0.191892, 0.528849, 0.180149, 0.367944, -0.203168, 0.540301, 0.199746, 0.387579, -0.214443, 0.551514, 0.221047, 0.408247, -0.225624, 0.560906, 0.243981, 0.43014, -0.236422, 0.56959, 0.268513, 0.452669, -0.24654, 0.576098, 0.294409, 0.476196, -0.256157, 0.580925, 0.322002, 0.501157, -0.265289, 0.584839, 0.351052, 0.527632, -0.273671, 0.587614, 0.3812, 0.555754, -0.281254, 0.589119, 0.412994, 0.581682, -0.287448, 0.585204, 0.445498, 0.608196, -0.292614, 0.579006, 0.479505, 0.635661, -0.296068, 0.571297, 0.514643, 0.664999, -0.297395, 0.560855, 0.552213, 0.691039, -0.296645, 0.544525, 0.591365, 0.7179, -0.293785, 0.526535, 0.630883, 0.744059, -0.289089, 0.50545, 0.670932, 0.76863, -0.282239, 0.482514, 0.710904, 0.793273, -0.273688, 0.457246, 0.750259, 0.814731, -0.26328, 0.428872, 0.78948, 0.835603, -0.251526, 0.399384, 0.828597, 0.85489, -0.238339, 0.368811, 0.866892, 0.872828, -0.223607, 0.336617, 0.90563, 0.889462, -0.207538, 0.303997, 0.943538, 0.904929, -0.190297, 0.270812, 0.980591, 0.919101, -0.172034, 0.237453, 1.01935, 0.930536, -0.152058, 0.204431, 1.05498, 0.941223, -0.129515, 0.172495, 1.08717, 0.94982, -0.104263, 0.140175, 1.11551, 0.960592, -0.0781944, 0.106465, 1.14098, 0.974629, -0.051688, 0.0711592, 1.16418, 0.98811, -0.0253929, 0.0354432, 1.18465, 1.00004, 0.000804378, -0.000330876, 1.20462, 0.214668, -8.21282e-06, 0.406619, 4.33582e-06, 0.218053, -0.000208144, 0.413025, 0.000109887, 0.217987, -0.000832212, 0.412901, 0.000439362, 0.217971, -0.00187246, 0.412876, 0.000988623, 0.217968, -0.00332855, 0.41286, 0.00175772, 0.217985, -0.00520055, 0.412882, 0.00274729, 0.218014, -0.00748814, 0.412916, 0.00395842, 0.218054, -0.0101901, 0.412957, 0.00539274, 0.218106, -0.0133057, 0.413005, 0.00705348, 0.218217, -0.0168342, 0.413139, 0.00894581, 0.218338, -0.0207707, 0.413258, 0.0110754, 0.21855, -0.0251001, 0.413509, 0.0134551, 0.218913, -0.0297861, 0.413992, 0.0161081, 0.219265, -0.0348956, 0.414383, 0.0190307, 0.219696, -0.0403909, 0.414839, 0.0222458, 0.220329, -0.0462003, 0.415567, 0.025792, 0.220989, -0.0524208, 0.41621, 0.0296637, 0.222027, -0.058948, 0.417385, 0.0339323, 0.223301, -0.0658208, 0.418779, 0.0386055, 0.224988, -0.0730347, 0.420665, 0.0437355, 0.227211, -0.0805274, 0.423198, 0.0493844, 0.230131, -0.088395, 0.426566, 0.0556135, 0.233908, -0.0966208, 0.43091, 0.0624829, 0.239092, -0.105223, 0.437148, 0.0701636, 0.245315, -0.11424, 0.444302, 0.0786949, 0.253166, -0.12368, 0.453262, 0.0882382, 0.262374, -0.133569, 0.463211, 0.0988682, 0.273145, -0.143836, 0.474271, 0.110727, 0.285512, -0.154577, 0.4863, 0.123945, 0.299512, -0.165501, 0.498817, 0.138581, 0.314287, -0.176698, 0.510341, 0.154676, 0.331083, -0.188066, 0.522583, 0.172459, 0.349615, -0.199597, 0.534879, 0.191979, 0.369318, -0.210843, 0.546083, 0.21309, 0.390377, -0.222068, 0.5562, 0.235998, 0.412411, -0.233059, 0.564704, 0.260518, 0.435715, -0.24357, 0.572314, 0.286795, 0.461196, -0.253356, 0.579395, 0.314559, 0.485587, -0.262362, 0.581985, 0.343581, 0.511908, -0.270895, 0.584347, 0.374367, 0.539798, -0.278452, 0.58505, 0.406015, 0.567974, -0.284877, 0.583344, 0.439168, 0.594303, -0.290124, 0.577348, 0.473005, 0.622951, -0.294183, 0.570751, 0.508534, 0.652404, -0.296389, 0.561541, 0.544764, 0.679291, -0.296605, 0.546426, 0.582927, 0.706437, -0.294095, 0.528599, 0.622681, 0.734485, -0.28978, 0.508676, 0.663567, 0.758841, -0.283363, 0.484768, 0.704092, 0.78537, -0.275015, 0.460434, 0.745101, 0.807315, -0.264689, 0.432166, 0.784712, 0.8271, -0.252597, 0.401807, 0.824241, 0.849191, -0.239154, 0.371458, 0.863803, 0.867046, -0.224451, 0.338873, 0.903063, 0.8852, -0.208342, 0.306175, 0.942763, 0.901771, -0.190684, 0.272759, 0.981559, 0.915958, -0.172105, 0.239306, 1.02048, 0.928046, -0.152214, 0.206071, 1.05765, 0.939961, -0.130247, 0.17367, 1.08999, 0.948711, -0.10672, 0.142201, 1.11829, 0.959305, -0.0808688, 0.108454, 1.14467, 0.973009, -0.0539145, 0.0728109, 1.16839, 0.987631, -0.0262947, 0.0360625, 1.19004, 0.999978, 0.00132758, -0.000559424, 1.21058, 0.193925, -7.93421e-06, 0.391974, 3.92537e-06, 0.196746, -0.000200315, 0.397675, 9.91033e-05, 0.19667, -0.000801099, 0.397521, 0.000396342, 0.196633, -0.00180246, 0.397445, 0.000891829, 0.196654, -0.00320443, 0.397482, 0.00158582, 0.196659, -0.00500647, 0.39748, 0.00247867, 0.196683, -0.0072086, 0.397506, 0.00357167, 0.196728, -0.00981001, 0.397562, 0.00486675, 0.196792, -0.0128096, 0.397633, 0.00636707, 0.19689, -0.0162055, 0.397746, 0.00807752, 0.197017, -0.0199943, 0.397884, 0.0100052, 0.19729, -0.024139, 0.39827, 0.0121691, 0.197583, -0.0286671, 0.398639, 0.0145755, 0.197927, -0.0335858, 0.399034, 0.0172355, 0.198383, -0.0388806, 0.399554, 0.0201718, 0.199002, -0.0444736, 0.400289, 0.0234194, 0.199739, -0.0504583, 0.401111, 0.026984, 0.200784, -0.056729, 0.402349, 0.0309217, 0.202075, -0.0633643, 0.403841, 0.0352496, 0.203898, -0.0703247, 0.406076, 0.0400313, 0.206199, -0.0775565, 0.408841, 0.0453282, 0.209252, -0.085184, 0.41259, 0.0511794, 0.213638, -0.0931994, 0.418288, 0.0577459, 0.21881, -0.101617, 0.424681, 0.0650508, 0.225642, -0.11052, 0.433429, 0.0732759, 0.233717, -0.119772, 0.442897, 0.0824683, 0.242823, -0.129505, 0.452888, 0.0927484, 0.254772, -0.139906, 0.466407, 0.104417, 0.266603, -0.150402, 0.477413, 0.117211, 0.28073, -0.161395, 0.490519, 0.131598, 0.295399, -0.172465, 0.50201, 0.147407, 0.312705, -0.183982, 0.515311, 0.165031, 0.331335, -0.195532, 0.52786, 0.184336, 0.351037, -0.206971, 0.5392, 0.205361, 0.372175, -0.218117, 0.54941, 0.228043, 0.394548, -0.229327, 0.558642, 0.25267, 0.419598, -0.240052, 0.567861, 0.279071, 0.443922, -0.249937, 0.573332, 0.306882, 0.471495, -0.259407, 0.58013, 0.33661, 0.496769, -0.267749, 0.580564, 0.367328, 0.524951, -0.275524, 0.581696, 0.399753, 0.55318, -0.282148, 0.579885, 0.433134, 0.581577, -0.287533, 0.575471, 0.467534, 0.609231, -0.291612, 0.567445, 0.502943, 0.637478, -0.293911, 0.557657, 0.53871, 0.667795, -0.295096, 0.546535, 0.576568, 0.694272, -0.294073, 0.529561, 0.614929, 0.722937, -0.290386, 0.510561, 0.655909, 0.749682, -0.284481, 0.487846, 0.697663, 0.774754, -0.276188, 0.462487, 0.738515, 0.799301, -0.266215, 0.43481, 0.779802, 0.820762, -0.254116, 0.404879, 0.820045, 0.843231, -0.240393, 0.374559, 0.860294, 0.861857, -0.225503, 0.341582, 0.900965, 0.880815, -0.209382, 0.308778, 0.941727, 0.89766, -0.19155, 0.275232, 0.980916, 0.912926, -0.172346, 0.240938, 1.02162, 0.926391, -0.151799, 0.207223, 1.0597, 0.938429, -0.129968, 0.17484, 1.09291, 0.947834, -0.10651, 0.142984, 1.12248, 0.958432, -0.0824098, 0.109902, 1.149, 0.972402, -0.0565242, 0.0744454, 1.1733, 0.987191, -0.028427, 0.0373794, 1.19538, 0.999975, 3.85685e-05, -4.203e-05, 1.21676, 0.178114, -7.66075e-06, 0.385418, 3.54027e-06, 0.176074, -0.000191966, 0.381002, 8.87135e-05, 0.17601, -0.000767549, 0.380861, 0.000354715, 0.17598, -0.00172696, 0.380798, 0.000798168, 0.175994, -0.00307012, 0.380824, 0.00141928, 0.176017, -0.00479684, 0.380858, 0.00221859, 0.176019, -0.00690648, 0.380839, 0.00319714, 0.176072, -0.00939888, 0.380913, 0.0043572, 0.176131, -0.0122726, 0.380979, 0.005702, 0.176239, -0.0155264, 0.38112, 0.00723689, 0.176371, -0.0191551, 0.381272, 0.00896907, 0.176638, -0.023117, 0.381669, 0.0109194, 0.176912, -0.0274633, 0.382015, 0.0130903, 0.177279, -0.032173, 0.382476, 0.0154949, 0.17774, -0.0372219, 0.383041, 0.0181669, 0.178344, -0.0426132, 0.38378, 0.0211209, 0.179153, -0.0483309, 0.384773, 0.0243899, 0.180197, -0.0543447, 0.386076, 0.0280062, 0.181581, -0.0607122, 0.387809, 0.032004, 0.18344, -0.0673855, 0.390205, 0.036453, 0.186139, -0.0743989, 0.393944, 0.0414162, 0.189432, -0.0817731, 0.39832, 0.0469394, 0.193795, -0.0895464, 0.404188, 0.0531442, 0.199641, -0.0978264, 0.4121, 0.0601374, 0.206679, -0.106499, 0.421425, 0.0680078, 0.214865, -0.115654, 0.431504, 0.076919, 0.224406, -0.125268, 0.442526, 0.0868835, 0.235876, -0.135475, 0.455465, 0.0981875, 0.248335, -0.146023, 0.4681, 0.110759, 0.262868, -0.157016, 0.482069, 0.124885, 0.278962, -0.168245, 0.496182, 0.140645, 0.295082, -0.17958, 0.507401, 0.157838, 0.313738, -0.191227, 0.520252, 0.17695, 0.333573, -0.202718, 0.531708, 0.197817, 0.356433, -0.214424, 0.544509, 0.220785, 0.378853, -0.225492, 0.55373, 0.245306, 0.402717, -0.236236, 0.561348, 0.271593, 0.428375, -0.246568, 0.568538, 0.299776, 0.454724, -0.255941, 0.573462, 0.329433, 0.482291, -0.264511, 0.576356, 0.360598, 0.509706, -0.272129, 0.576446, 0.393204, 0.538805, -0.278979, 0.575298, 0.427227, 0.568919, -0.284528, 0.572154, 0.462157, 0.596804, -0.288801, 0.564691, 0.497997, 0.625987, -0.291334, 0.555134, 0.534467, 0.656414, -0.292722, 0.545051, 0.571736, 0.683916, -0.292185, 0.528813, 0.610158, 0.711809, -0.290043, 0.51106, 0.649061, 0.739547, -0.285246, 0.490103, 0.690081, 0.766914, -0.277647, 0.465523, 0.732554, 0.791375, -0.267603, 0.437718, 0.773982, 0.814772, -0.256109, 0.40882, 0.81609, 0.836691, -0.242281, 0.377823, 0.856849, 0.856984, -0.227155, 0.34496, 0.898363, 0.876332, -0.210395, 0.311335, 0.939471, 0.894988, -0.192612, 0.277703, 0.980799, 0.911113, -0.173236, 0.243019, 1.02215, 0.924092, -0.152258, 0.209037, 1.06139, 0.936828, -0.129575, 0.175909, 1.09635, 0.946869, -0.10594, 0.143852, 1.12707, 0.958284, -0.081318, 0.110289, 1.15419, 0.972325, -0.0556133, 0.0747232, 1.17909, 0.986878, -0.0297899, 0.0383149, 1.20163, 0.999936, -0.00197169, 0.000912402, 1.22338, 0.151174, -7.20365e-06, 0.351531, 3.09789e-06, 0.155594, -0.00018279, 0.361806, 7.8608e-05, 0.156099, -0.000731569, 0.362982, 0.000314615, 0.156053, -0.00164578, 0.362869, 0.000707845, 0.156093, -0.0029261, 0.362961, 0.00125884, 0.156099, -0.00457155, 0.362959, 0.00196783, 0.15612, -0.00658224, 0.362982, 0.00283622, 0.156168, -0.00895774, 0.363048, 0.00386625, 0.156221, -0.0116962, 0.363101, 0.00506109, 0.156324, -0.0147973, 0.363241, 0.00642675, 0.156476, -0.0182503, 0.363448, 0.00797175, 0.156731, -0.0220266, 0.36384, 0.00971484, 0.156994, -0.026176, 0.364179, 0.0116575, 0.157341, -0.0306701, 0.36462, 0.0138207, 0.157867, -0.0354591, 0.365364, 0.0162356, 0.15846, -0.0406141, 0.366111, 0.0189092, 0.159308, -0.0460519, 0.367248, 0.021885, 0.160426, -0.0518096, 0.368767, 0.0252004, 0.161877, -0.0578906, 0.370745, 0.0288825, 0.163995, -0.0642812, 0.373831, 0.0330139, 0.16655, -0.0710067, 0.377366, 0.0376283, 0.170237, -0.0781522, 0.382799, 0.0428493, 0.175096, -0.0857172, 0.389915, 0.0487324, 0.181069, -0.0938025, 0.398487, 0.0554214, 0.188487, -0.102363, 0.408799, 0.0630189, 0.197029, -0.111343, 0.419991, 0.071634, 0.206684, -0.120812, 0.431455, 0.0812797, 0.218698, -0.131033, 0.445746, 0.0923651, 0.230726, -0.141373, 0.457471, 0.104545, 0.245516, -0.152387, 0.472388, 0.118449, 0.261551, -0.163628, 0.486671, 0.133923, 0.277437, -0.174814, 0.49762, 0.150849, 0.296662, -0.186713, 0.51162, 0.169924, 0.31795, -0.198513, 0.525435, 0.190848, 0.339422, -0.210119, 0.536267, 0.213504, 0.362143, -0.221354, 0.545982, 0.237947, 0.387198, -0.23224, 0.555364, 0.264427, 0.412349, -0.24257, 0.561489, 0.292519, 0.439274, -0.252284, 0.566903, 0.322561, 0.466779, -0.261023, 0.569614, 0.353952, 0.496011, -0.26899, 0.571589, 0.387278, 0.524964, -0.275498, 0.570325, 0.421356, 0.556518, -0.281449, 0.568792, 0.457314, 0.584363, -0.285526, 0.560268, 0.493199, 0.614214, -0.28844, 0.55205, 0.530276, 0.645684, -0.289777, 0.541906, 0.56855, 0.673446, -0.289722, 0.526464, 0.606927, 0.701924, -0.287792, 0.509872, 0.645945, 0.73037, -0.284315, 0.490649, 0.685564, 0.757405, -0.278804, 0.467964, 0.726511, 0.784025, -0.269543, 0.441468, 0.768601, 0.808255, -0.258117, 0.41216, 0.811321, 0.830739, -0.244728, 0.380606, 0.853496, 0.851914, -0.229428, 0.348111, 0.895374, 0.872586, -0.212508, 0.314732, 0.937674, 0.891581, -0.194025, 0.280338, 0.979869, 0.907641, -0.174711, 0.245203, 1.02253, 0.922233, -0.153509, 0.21077, 1.06371, 0.935878, -0.130418, 0.177399, 1.09972, 0.946338, -0.105558, 0.144507, 1.13124, 0.957265, -0.080059, 0.110508, 1.15973, 0.971668, -0.0539766, 0.0742311, 1.18515, 0.9866, -0.0277101, 0.0375224, 1.20858, 1.00021, -0.000515531, 0.000135226, 1.23135, 0.137468, -6.86011e-06, 0.345041, 2.73315e-06, 0.13703, -0.000173378, 0.343936, 6.90761e-05, 0.136986, -0.000693048, 0.34383, 0.000276126, 0.136964, -0.00155931, 0.343761, 0.000621337, 0.137003, -0.00277211, 0.343863, 0.00110494, 0.137012, -0.00433103, 0.343868, 0.00172744, 0.137043, -0.00623606, 0.343916, 0.00249022, 0.13709, -0.0084868, 0.343986, 0.00339559, 0.137145, -0.0110814, 0.344045, 0.00444687, 0.137242, -0.0140187, 0.344177, 0.00565007, 0.137431, -0.0172713, 0.344491, 0.00701868, 0.137644, -0.0208605, 0.344805, 0.00856042, 0.13791, -0.024792, 0.345172, 0.0102863, 0.138295, -0.0290461, 0.345734, 0.0122185, 0.138764, -0.0335957, 0.346371, 0.0143771, 0.139415, -0.038467, 0.347298, 0.0167894, 0.140272, -0.0436176, 0.348527, 0.0194895, 0.141457, -0.0491016, 0.350276, 0.0225043, 0.14303, -0.0548764, 0.352646, 0.0258962, 0.145289, -0.0610096, 0.356206, 0.0297168, 0.148502, -0.0674777, 0.361488, 0.0340562, 0.152188, -0.074345, 0.367103, 0.0389534, 0.157359, -0.0817442, 0.375247, 0.0445541, 0.16379, -0.0896334, 0.385064, 0.0509535, 0.171376, -0.098005, 0.396082, 0.0582611, 0.179901, -0.106817, 0.407418, 0.06654, 0.189892, -0.116239, 0.420031, 0.075994, 0.201838, -0.12627, 0.434321, 0.0867239, 0.214311, -0.136701, 0.447631, 0.0987517, 0.228902, -0.147616, 0.462046, 0.112353, 0.245107, -0.158871, 0.476942, 0.127605, 0.262292, -0.170261, 0.490285, 0.144469, 0.281215, -0.182017, 0.503783, 0.163282, 0.301058, -0.193729, 0.515505, 0.183873, 0.322752, -0.205512, 0.52682, 0.206466, 0.347547, -0.217214, 0.539473, 0.231194, 0.370969, -0.227966, 0.546625, 0.257288, 0.397533, -0.238555, 0.55472, 0.285789, 0.42398, -0.248278, 0.559468, 0.315746, 0.452928, -0.257422, 0.564095, 0.347724, 0.482121, -0.265306, 0.565426, 0.380922, 0.510438, -0.272043, 0.563205, 0.415639, 0.541188, -0.277614, 0.561087, 0.451702, 0.571667, -0.281927, 0.554922, 0.48845, 0.602432, -0.285015, 0.546838, 0.526442, 0.634126, -0.286512, 0.537415, 0.564896, 0.662816, -0.286388, 0.522906, 0.604037, 0.692411, -0.284734, 0.507003, 0.643795, 0.720946, -0.281297, 0.488398, 0.68298, 0.748293, -0.276262, 0.466353, 0.723466, 0.776931, -0.269978, 0.443573, 0.764565, 0.801065, -0.260305, 0.415279, 0.805838, 0.825843, -0.247426, 0.384773, 0.849985, 0.84807, -0.232437, 0.352555, 0.893174, 0.869122, -0.215806, 0.318642, 0.936564, 0.888963, -0.197307, 0.28381, 0.980253, 0.905547, -0.177203, 0.247888, 1.02463, 0.918554, -0.155542, 0.212904, 1.06714, 0.931395, -0.131948, 0.1787, 1.10451, 0.941749, -0.106723, 0.145902, 1.13694, 0.954551, -0.0804939, 0.111193, 1.1666, 0.970279, -0.0534239, 0.0744697, 1.19249, 0.986117, -0.0257452, 0.0368788, 1.21665, 0.999938, 0.00190634, -0.0010291, 1.23981, 0.118493, -6.47439e-06, 0.32272, 2.3772e-06, 0.118765, -0.000163023, 0.323456, 5.98573e-05, 0.118772, -0.00065212, 0.323477, 0.000239447, 0.118843, -0.00146741, 0.323657, 0.000538881, 0.118804, -0.00260846, 0.323553, 0.00095826, 0.118826, -0.00407576, 0.323595, 0.00149845, 0.118846, -0.00586826, 0.323617, 0.00216047, 0.118886, -0.00798578, 0.32367, 0.00294679, 0.118947, -0.0104273, 0.323753, 0.00386124, 0.119055, -0.0131909, 0.323922, 0.00490999, 0.119241, -0.0162444, 0.324251, 0.00610804, 0.11944, -0.0196339, 0.324544, 0.00745805, 0.119739, -0.0233378, 0.325026, 0.00897805, 0.12011, -0.0273179, 0.325586, 0.0106895, 0.120571, -0.0316143, 0.326231, 0.0126073, 0.12124, -0.0361939, 0.327264, 0.0147654, 0.122162, -0.0410511, 0.328733, 0.0172001, 0.123378, -0.0462233, 0.330659, 0.0199375, 0.125183, -0.0517109, 0.333754, 0.0230498, 0.127832, -0.0575652, 0.338507, 0.026597, 0.130909, -0.0637441, 0.343666, 0.0306345, 0.135221, -0.0704302, 0.351063, 0.035273, 0.14082, -0.0776364, 0.360604, 0.0406137, 0.146781, -0.0852293, 0.369638, 0.0466788, 0.155121, -0.0935351, 0.3827, 0.0537628, 0.16398, -0.102234, 0.39522, 0.0617985, 0.173926, -0.111465, 0.40793, 0.07097, 0.185137, -0.121296, 0.42105, 0.0813426, 0.19826, -0.13169, 0.435735, 0.0931596, 0.212938, -0.142614, 0.450932, 0.106547, 0.229046, -0.153884, 0.465726, 0.121575, 0.246246, -0.165382, 0.479461, 0.138286, 0.264637, -0.176806, 0.492106, 0.15666, 0.284959, -0.188793, 0.504774, 0.17728, 0.308157, -0.200763, 0.518805, 0.19988, 0.330951, -0.21239, 0.528231, 0.224293, 0.3549, -0.223521, 0.536376, 0.250541, 0.381502, -0.234169, 0.544846, 0.278902, 0.409529, -0.244077, 0.551717, 0.309227, 0.437523, -0.253363, 0.55517, 0.341426, 0.467624, -0.261659, 0.557772, 0.37518, 0.497268, -0.268498, 0.556442, 0.41007, 0.528294, -0.274018, 0.553915, 0.446445, 0.559053, -0.278169, 0.549153, 0.483779, 0.589329, -0.281229, 0.539878, 0.522249, 0.622503, -0.282902, 0.53162, 0.561754, 0.652382, -0.282815, 0.518119, 0.601544, 0.681847, -0.281247, 0.502187, 0.641574, 0.712285, -0.277986, 0.484824, 0.682633, 0.740094, -0.273017, 0.463483, 0.723426, 0.768478, -0.266692, 0.441299, 0.763747, 0.794556, -0.258358, 0.415238, 0.805565, 0.819408, -0.248807, 0.386912, 0.847254, 0.843411, -0.236214, 0.356165, 0.891091, 0.862397, -0.219794, 0.320562, 0.936174, 0.883113, -0.201768, 0.285322, 0.982562, 0.90023, -0.181672, 0.249713, 1.02862, 0.915192, -0.159279, 0.214546, 1.07163, 0.928458, -0.134725, 0.180285, 1.10995, 0.94069, -0.10913, 0.147119, 1.14354, 0.953409, -0.0821315, 0.112492, 1.17372, 0.969537, -0.0542677, 0.0752014, 1.20043, 0.985612, -0.0259096, 0.0370361, 1.22528, 0.999835, 0.00298198, -0.00151801, 1.24959, 0.10097, -6.02574e-06, 0.300277, 2.02619e-06, 0.101577, -0.000152164, 0.302077, 5.11662e-05, 0.101572, -0.000608889, 0.302066, 0.000204751, 0.101566, -0.00136997, 0.302047, 0.000460753, 0.101592, -0.00243557, 0.302114, 0.000819497, 0.101608, -0.0038053, 0.30214, 0.00128154, 0.101627, -0.00547906, 0.30216, 0.0018483, 0.101669, -0.00745647, 0.302224, 0.00252223, 0.101732, -0.00973615, 0.302318, 0.00330716, 0.101844, -0.0123097, 0.302513, 0.00421061, 0.102025, -0.0151681, 0.30285, 0.00524481, 0.102224, -0.0183334, 0.303166, 0.0064154, 0.102515, -0.0217819, 0.303654, 0.00774063, 0.102886, -0.0255067, 0.304243, 0.0092398, 0.103395, -0.029514, 0.305089, 0.0109339, 0.104109, -0.0337912, 0.306301, 0.0128561, 0.105074, -0.0383565, 0.30798, 0.0150338, 0.10654, -0.0432132, 0.310726, 0.0175228, 0.108478, -0.0484244, 0.314351, 0.0203648, 0.111015, -0.0539339, 0.319032, 0.0236325, 0.114682, -0.0598885, 0.32605, 0.0274188, 0.11911, -0.0663375, 0.334109, 0.0317905, 0.124736, -0.0733011, 0.344013, 0.0368502, 0.131479, -0.0807744, 0.355358, 0.0427104, 0.139283, -0.0888204, 0.367614, 0.0494788, 0.148054, -0.0973394, 0.380072, 0.0572367, 0.159037, -0.10665, 0.395678, 0.0662704, 0.169794, -0.116221, 0.40795, 0.0763192, 0.18314, -0.126632, 0.423546, 0.087956, 0.197515, -0.137383, 0.438213, 0.101042, 0.213514, -0.148641, 0.453248, 0.115827, 0.23065, -0.160117, 0.46688, 0.132283, 0.249148, -0.171807, 0.479962, 0.150644, 0.270219, -0.183695, 0.494618, 0.171073, 0.292338, -0.195574, 0.506937, 0.193378, 0.314999, -0.207205, 0.516463, 0.217585, 0.340991, -0.218955, 0.528123, 0.24428, 0.367982, -0.229917, 0.537025, 0.272784, 0.39432, -0.239737, 0.541627, 0.302742, 0.423364, -0.249048, 0.546466, 0.335112, 0.453751, -0.257329, 0.549466, 0.369032, 0.48416, -0.264623, 0.549503, 0.404577, 0.515262, -0.270411, 0.547008, 0.441337, 0.547036, -0.274581, 0.542249, 0.479162, 0.576614, -0.277266, 0.533015, 0.517904, 0.611143, -0.279144, 0.525512, 0.558508, 0.640989, -0.279001, 0.51154, 0.598995, 0.671182, -0.277324, 0.495641, 0.639935, 0.700848, -0.273908, 0.477526, 0.681017, 0.729862, -0.269063, 0.457955, 0.722764, 0.758273, -0.262282, 0.434846, 0.764349, 0.784121, -0.254281, 0.409203, 0.806206, 0.809798, -0.24505, 0.382694, 0.848617, 0.834953, -0.233861, 0.354034, 0.892445, 0.856817, -0.221308, 0.321764, 0.936263, 0.877609, -0.205996, 0.288118, 0.982401, 0.897489, -0.186702, 0.253277, 1.02975, 0.913792, -0.164618, 0.217963, 1.07488, 0.92785, -0.140023, 0.183221, 1.11487, 0.940378, -0.11328, 0.149385, 1.14947, 0.95273, -0.0853958, 0.114152, 1.1807, 0.969059, -0.0568698, 0.0769845, 1.20912, 0.985574, -0.0276502, 0.0381186, 1.23498, 0.999943, 0.00239052, -0.00126861, 1.25987, 0.0852715, -5.60067e-06, 0.279021, 1.71162e-06, 0.0854143, -0.000140871, 0.279483, 4.30516e-05, 0.0854191, -0.000563385, 0.2795, 0.000172184, 0.0854188, -0.00126753, 0.279493, 0.000387464, 0.0854229, -0.00225337, 0.279501, 0.00068918, 0.0854443, -0.00352086, 0.279549, 0.00107803, 0.0854697, -0.00506962, 0.279591, 0.00155536, 0.0855093, -0.00689873, 0.279652, 0.00212354, 0.0855724, -0.00900821, 0.279752, 0.00278703, 0.0856991, -0.0113799, 0.280011, 0.0035551, 0.085855, -0.0140314, 0.280297, 0.00443449, 0.0860682, -0.016963, 0.280682, 0.00543636, 0.086344, -0.0201438, 0.281159, 0.0065788, 0.0867426, -0.0235999, 0.281886, 0.00787977, 0.087239, -0.0273069, 0.282745, 0.0093606, 0.0879815, -0.031269, 0.284139, 0.011056, 0.0891258, -0.035531, 0.28647, 0.0130065, 0.0906909, -0.0400947, 0.289708, 0.0152495, 0.0927624, -0.0449638, 0.293904, 0.0178454, 0.0958376, -0.0502427, 0.300471, 0.0208915, 0.0995827, -0.0559514, 0.30806, 0.0244247, 0.104526, -0.0622152, 0.317874, 0.0285721, 0.110532, -0.0690046, 0.329332, 0.0334227, 0.117385, -0.0763068, 0.341217, 0.0390466, 0.12522, -0.084184, 0.353968, 0.0455786, 0.134037, -0.0925248, 0.366797, 0.0530773, 0.144014, -0.101487, 0.380209, 0.0617424, 0.156013, -0.111273, 0.395956, 0.071777, 0.168872, -0.121431, 0.41053, 0.0830905, 0.183089, -0.132105, 0.425073, 0.0959341, 0.198763, -0.143286, 0.439833, 0.110448, 0.216159, -0.154841, 0.454507, 0.126769, 0.234859, -0.166588, 0.468368, 0.14495, 0.255879, -0.178626, 0.482846, 0.165233, 0.27677, -0.190218, 0.493489, 0.187217, 0.301184, -0.202227, 0.506549, 0.211659, 0.325852, -0.213764, 0.5158, 0.237922, 0.352824, -0.22487, 0.525442, 0.26632, 0.380882, -0.235246, 0.532487, 0.296691, 0.410137, -0.244847, 0.537703, 0.329179, 0.439787, -0.253122, 0.540361, 0.363135, 0.472291, -0.260517, 0.542734, 0.399222, 0.501856, -0.266519, 0.538826, 0.436352, 0.534816, -0.270905, 0.535152, 0.474505, 0.565069, -0.273826, 0.525979, 0.513988, 0.597154, -0.275333, 0.516394, 0.554852, 0.630473, -0.275314, 0.506206, 0.596592, 0.660574, -0.273323, 0.489769, 0.638117, 0.692015, -0.270008, 0.472578, 0.680457, 0.720647, -0.265001, 0.452134, 0.723008, 0.750528, -0.258311, 0.430344, 0.765954, 0.777568, -0.250046, 0.405624, 0.809012, 0.80387, -0.240114, 0.378339, 0.852425, 0.828439, -0.228737, 0.349877, 0.895346, 0.851472, -0.216632, 0.318968, 0.940695, 0.873906, -0.202782, 0.287489, 0.987235, 0.89467, -0.187059, 0.254394, 1.03348, 0.912281, -0.168818, 0.221294, 1.07812, 0.927358, -0.146494, 0.18675, 1.11928, 0.940385, -0.120009, 0.152322, 1.15609, 0.952672, -0.0917183, 0.117514, 1.18875, 0.968496, -0.0620321, 0.0797405, 1.21821, 0.985236, -0.0314945, 0.0402383, 1.24523, 0.99998, -0.000575153, 0.000110644, 1.27133, 0.0702429, -5.12222e-06, 0.255273, 1.40947e-06, 0.0702981, -0.000128826, 0.255469, 3.54488e-05, 0.0703691, -0.000515562, 0.255727, 0.000141874, 0.0703805, -0.00116, 0.255754, 0.00031929, 0.0703961, -0.00206224, 0.255813, 0.000567999, 0.0704102, -0.00322223, 0.255839, 0.00088871, 0.0704298, -0.00463928, 0.255863, 0.00128272, 0.0704759, -0.00631375, 0.255953, 0.00175283, 0.0705434, -0.00824317, 0.256079, 0.00230342, 0.0706693, -0.010412, 0.25636, 0.0029443, 0.0708189, -0.0128439, 0.256647, 0.00368031, 0.0710364, -0.0155177, 0.257084, 0.00452614, 0.0713223, -0.0184374, 0.257637, 0.00549706, 0.0717182, -0.0216002, 0.258416, 0.00661246, 0.072321, -0.0249966, 0.259699, 0.00790147, 0.0731446, -0.0286566, 0.261475, 0.0093884, 0.0743352, -0.0325888, 0.264132, 0.0111186, 0.0760676, -0.036843, 0.26815, 0.013145, 0.078454, -0.0414292, 0.273636, 0.0155251, 0.0818618, -0.0464634, 0.281653, 0.0183525, 0.0857382, -0.0519478, 0.289992, 0.0216642, 0.0908131, -0.0579836, 0.30066, 0.0255956, 0.0967512, -0.0645124, 0.312204, 0.0301954, 0.103717, -0.0716505, 0.325001, 0.0356017, 0.111596, -0.0793232, 0.338129, 0.041896, 0.120933, -0.087645, 0.352853, 0.0492447, 0.130787, -0.096492, 0.366192, 0.0576749, 0.142311, -0.105973, 0.380864, 0.0673969, 0.155344, -0.116182, 0.396575, 0.0785899, 0.169535, -0.126815, 0.411443, 0.0912377, 0.185173, -0.138015, 0.426256, 0.105607, 0.201755, -0.149325, 0.439607, 0.121551, 0.221334, -0.161207, 0.455467, 0.139608, 0.241461, -0.173162, 0.469096, 0.159591, 0.26294, -0.18504, 0.481014, 0.18156, 0.286776, -0.196881, 0.493291, 0.205781, 0.311596, -0.208311, 0.503556, 0.231819, 0.338667, -0.219671, 0.513268, 0.260274, 0.366021, -0.230451, 0.519414, 0.290862, 0.395875, -0.240131, 0.526766, 0.323196, 0.425564, -0.248566, 0.52905, 0.357071, 0.457094, -0.256195, 0.530796, 0.393262, 0.488286, -0.262331, 0.528703, 0.430797, 0.522291, -0.267141, 0.52727, 0.470231, 0.554172, -0.270411, 0.519848, 0.510477, 0.586427, -0.271986, 0.510307, 0.551594, 0.619638, -0.27192, 0.499158, 0.593849, 0.650656, -0.269817, 0.483852, 0.636314, 0.68284, -0.266267, 0.467515, 0.679679, 0.714356, -0.26113, 0.44931, 0.723884, 0.742717, -0.254067, 0.425789, 0.767245, 0.770894, -0.245652, 0.401144, 0.811819, 0.797358, -0.235554, 0.374224, 0.856315, 0.823377, -0.223896, 0.346167, 0.901077, 0.847456, -0.210865, 0.316056, 0.946502, 0.870697, -0.196574, 0.284503, 0.993711, 0.891068, -0.180814, 0.251628, 1.04134, 0.909267, -0.163314, 0.219065, 1.08609, 0.925653, -0.143304, 0.186446, 1.12702, 0.940017, -0.121322, 0.153416, 1.16371, 0.952398, -0.0973872, 0.120334, 1.19712, 0.967568, -0.0698785, 0.08352, 1.22791, 0.984772, -0.0390031, 0.0439209, 1.25672, 1.00026, -0.0070087, 0.00315668, 1.28428, 0.0556653, -4.59654e-06, 0.227325, 1.12556e-06, 0.0565238, -0.000116382, 0.230826, 2.84985e-05, 0.0565717, -0.000465666, 0.231026, 0.000114036, 0.0565859, -0.00104773, 0.231079, 0.000256656, 0.0565761, -0.00186255, 0.231025, 0.00045663, 0.0565913, -0.00291002, 0.231058, 0.000714664, 0.0566108, -0.00418998, 0.231085, 0.00103224, 0.0566532, -0.00570206, 0.231169, 0.00141202, 0.0567473, -0.00743666, 0.231417, 0.00186018, 0.0568567, -0.00940298, 0.231661, 0.00238264, 0.0569859, -0.0115991, 0.231895, 0.00298699, 0.0572221, -0.0140096, 0.232456, 0.00368957, 0.057519, -0.0166508, 0.233096, 0.00450303, 0.0579534, -0.01951, 0.234094, 0.00544945, 0.0585922, -0.0225991, 0.235629, 0.00655564, 0.0595647, -0.0259416, 0.238106, 0.00785724, 0.0609109, -0.0295661, 0.241557, 0.00939127, 0.0628751, -0.0335126, 0.246652, 0.0112198, 0.0656908, -0.0378604, 0.254091, 0.0134168, 0.0691347, -0.0426543, 0.262666, 0.0160374, 0.0732165, -0.0478967, 0.272029, 0.0191514, 0.0782863, -0.0536716, 0.283007, 0.0228597, 0.0843973, -0.0600683, 0.295732, 0.0272829, 0.0913598, -0.0670095, 0.308779, 0.032484, 0.0994407, -0.0745516, 0.322886, 0.0385886, 0.108189, -0.082712, 0.336408, 0.0457133, 0.118574, -0.0914927, 0.351692, 0.0539832, 0.129989, -0.100854, 0.366502, 0.0635162, 0.142722, -0.110837, 0.381675, 0.0744386, 0.156654, -0.121353, 0.3963, 0.0868483, 0.172151, -0.132414, 0.411477, 0.100963, 0.188712, -0.143809, 0.42508, 0.116795, 0.208093, -0.155765, 0.441328, 0.134715, 0.227936, -0.167608, 0.454328, 0.154396, 0.249495, -0.179579, 0.467235, 0.176179, 0.27362, -0.191488, 0.480248, 0.200193, 0.296371, -0.202618, 0.487886, 0.225775, 0.324234, -0.214133, 0.499632, 0.25441, 0.353049, -0.225212, 0.509532, 0.285077, 0.381785, -0.234875, 0.514265, 0.317047, 0.414038, -0.244205, 0.521282, 0.351874, 0.445251, -0.252145, 0.522931, 0.388279, 0.476819, -0.258433, 0.520947, 0.425825, 0.509209, -0.263411, 0.517669, 0.465104, 0.542759, -0.266732, 0.512841, 0.505741, 0.574822, -0.268263, 0.503317, 0.547611, 0.609324, -0.268489, 0.493035, 0.590953, 0.641772, -0.266941, 0.478816, 0.63488, 0.674049, -0.263297, 0.462863, 0.679072, 0.705071, -0.257618, 0.442931, 0.723487, 0.734709, -0.250625, 0.421299, 0.768708, 0.763704, -0.24179, 0.397085, 0.814375, 0.791818, -0.231115, 0.370577, 0.859907, 0.817439, -0.21922, 0.34232, 0.906715, 0.843202, -0.205658, 0.312627, 0.953943, 0.866639, -0.190563, 0.280933, 1.00185, 0.888129, -0.173978, 0.248393, 1.05105, 0.907239, -0.155485, 0.216007, 1.09704, 0.923893, -0.134782, 0.183233, 1.13857, 0.938882, -0.11249, 0.150376, 1.17539, 0.952464, -0.0890706, 0.117177, 1.20924, 0.968529, -0.0646523, 0.0813095, 1.24055, 0.984763, -0.038606, 0.0439378, 1.27018, 1.00053, -0.01238, 0.00598668, 1.29873, 0.0437928, -4.09594e-06, 0.204012, 8.79224e-07, 0.0440166, -0.000103395, 0.205049, 2.21946e-05, 0.0440529, -0.000413633, 0.205225, 8.87981e-05, 0.0440493, -0.000930594, 0.2052, 0.000199858, 0.0439884, -0.00165352, 0.204901, 0.000355495, 0.0440716, -0.0025849, 0.205255, 0.000556983, 0.0440968, -0.00372222, 0.205311, 0.000805326, 0.0441359, -0.00506478, 0.205391, 0.00110333, 0.0442231, -0.00660384, 0.205638, 0.00145768, 0.0443254, -0.00835246, 0.205877, 0.00187275, 0.0444832, -0.0102992, 0.20627, 0.00235938, 0.0447001, -0.0124449, 0.206796, 0.0029299, 0.0450168, -0.0147935, 0.207593, 0.0036005, 0.0454816, -0.017336, 0.208819, 0.00439246, 0.0462446, -0.0201156, 0.211036, 0.00533864, 0.0473694, -0.0231568, 0.214388, 0.00646984, 0.0490191, -0.0264941, 0.219357, 0.00783856, 0.0512776, -0.030184, 0.226061, 0.00950182, 0.0541279, -0.0342661, 0.234094, 0.0115156, 0.0578989, -0.0388539, 0.244297, 0.0139687, 0.0620835, -0.0438735, 0.254457, 0.0169015, 0.0673497, -0.04951, 0.266706, 0.0204554, 0.0731759, -0.0556263, 0.278753, 0.0246606, 0.0803937, -0.0624585, 0.29309, 0.0297126, 0.0879287, -0.0697556, 0.305856, 0.0355868, 0.0970669, -0.0778795, 0.321059, 0.0425768, 0.106508, -0.0863541, 0.333873, 0.05056, 0.11776, -0.0955935, 0.349008, 0.0598972, 0.130081, -0.105438, 0.363776, 0.0706314, 0.144454, -0.115899, 0.380112, 0.0828822, 0.1596, -0.126827, 0.394843, 0.0967611, 0.176097, -0.138161, 0.409033, 0.112381, 0.194726, -0.149904, 0.424257, 0.129952, 0.213944, -0.161675, 0.436945, 0.149333, 0.235516, -0.173659, 0.450176, 0.170892, 0.260564, -0.185963, 0.466305, 0.194984, 0.285183, -0.197582, 0.477328, 0.220805, 0.311095, -0.208697, 0.486566, 0.248694, 0.338924, -0.219519, 0.494811, 0.279015, 0.369757, -0.229766, 0.504065, 0.311725, 0.3996, -0.238879, 0.507909, 0.345844, 0.430484, -0.246802, 0.509805, 0.381749, 0.46413, -0.253924, 0.511436, 0.420251, 0.497077, -0.259319, 0.508787, 0.459957, 0.530434, -0.263297, 0.50394, 0.501356, 0.565725, -0.265619, 0.49804, 0.544252, 0.599254, -0.265842, 0.487346, 0.587856, 0.631251, -0.263978, 0.472975, 0.631969, 0.663972, -0.26043, 0.457135, 0.677471, 0.697724, -0.255358, 0.439844, 0.723744, 0.727725, -0.248308, 0.417872, 0.770653, 0.756417, -0.239181, 0.39273, 0.817357, 0.785419, -0.22814, 0.367839, 0.864221, 0.81266, -0.215681, 0.339449, 0.912701, 0.839391, -0.201623, 0.309279, 0.962419, 0.86366, -0.185624, 0.278029, 1.0122, 0.885028, -0.16797, 0.245294, 1.06186, 0.904639, -0.148336, 0.212689, 1.10934, 0.922048, -0.12637, 0.179616, 1.15063, 0.936952, -0.102928, 0.146749, 1.18885, 0.951895, -0.0785268, 0.112733, 1.22352, 0.967198, -0.0530153, 0.0760056, 1.25681, 0.984405, -0.02649, 0.0383183, 1.28762, 1.00021, 0.00070019, -0.00020039, 1.31656, 0.0325964, -3.55447e-06, 0.176706, 6.55682e-07, 0.0329333, -8.99174e-05, 0.178527, 1.65869e-05, 0.0329181, -0.000359637, 0.178453, 6.63498e-05, 0.0329085, -0.000808991, 0.178383, 0.000149332, 0.0329181, -0.00143826, 0.178394, 0.000265873, 0.0329425, -0.00224678, 0.178517, 0.000416597, 0.0329511, -0.00323575, 0.17849, 0.000603299, 0.033011, -0.00439875, 0.178695, 0.000829422, 0.0330733, -0.00574059, 0.178843, 0.00109908, 0.0331857, -0.00725896, 0.179176, 0.00141933, 0.0333445, -0.00895289, 0.179618, 0.0017999, 0.0335674, -0.0108219, 0.180238, 0.00225316, 0.033939, -0.0128687, 0.181417, 0.00279765, 0.0345239, -0.015114, 0.183395, 0.0034564, 0.0354458, -0.017596, 0.186616, 0.00425864, 0.0368313, -0.0203524, 0.191547, 0.00524936, 0.0386115, -0.0234105, 0.197508, 0.00647033, 0.0410303, -0.0268509, 0.205395, 0.00798121, 0.0442245, -0.0307481, 0.215365, 0.0098557, 0.0478659, -0.0350863, 0.225595, 0.0121417, 0.0522416, -0.0399506, 0.236946, 0.0149385, 0.0574513, -0.045357, 0.249442, 0.0183189, 0.0631208, -0.0512863, 0.261222, 0.0223644, 0.0701124, -0.0579273, 0.275418, 0.0272418, 0.0777331, -0.0650652, 0.288989, 0.0329458, 0.0862709, -0.0728813, 0.302546, 0.0396819, 0.096103, -0.081363, 0.317164, 0.04757, 0.106976, -0.0904463, 0.331733, 0.0567012, 0.119175, -0.100105, 0.34661, 0.067202, 0.132919, -0.110375, 0.362249, 0.0792588, 0.147727, -0.121115, 0.376978, 0.0928672, 0.163618, -0.132299, 0.390681, 0.108228, 0.182234, -0.143887, 0.406571, 0.125502, 0.201809, -0.155827, 0.42042, 0.144836, 0.225041, -0.168357, 0.438411, 0.166706, 0.247621, -0.18004, 0.450368, 0.189909, 0.27097, -0.191536, 0.460083, 0.215251, 0.296658, -0.203024, 0.469765, 0.243164, 0.325892, -0.214056, 0.481837, 0.273388, 0.35406, -0.224104, 0.487474, 0.305344, 0.384372, -0.233489, 0.492773, 0.339741, 0.41749, -0.241874, 0.498451, 0.376287, 0.45013, -0.248834, 0.499632, 0.414195, 0.481285, -0.254658, 0.495233, 0.454077, 0.519183, -0.259367, 0.496401, 0.496352, 0.551544, -0.261818, 0.487686, 0.538798, 0.587349, -0.262964, 0.479453, 0.583626, 0.621679, -0.262128, 0.467709, 0.629451, 0.654991, -0.258998, 0.452123, 0.67566, 0.686873, -0.254119, 0.433495, 0.723248, 0.719801, -0.246946, 0.413657, 0.771156, 0.750355, -0.237709, 0.390366, 0.81989, 0.780033, -0.226549, 0.364947, 0.868601, 0.809254, -0.214186, 0.337256, 0.920034, 0.836576, -0.199639, 0.307395, 0.971706, 0.861774, -0.183169, 0.275431, 1.02479, 0.885707, -0.165111, 0.243431, 1.07837, 0.904742, -0.144363, 0.210921, 1.12783, 0.915604, -0.121305, 0.17647, 1.17254, 0.930959, -0.0962119, 0.143106, 1.21012, 0.948404, -0.069969, 0.108112, 1.24474, 0.967012, -0.0427586, 0.0708478, 1.27718, 0.984183, -0.0147043, 0.032335, 1.3083, 0.999577, 0.0142165, -0.00726867, 1.3382, 0.0229227, -2.99799e-06, 0.148623, 4.62391e-07, 0.0232194, -7.58796e-05, 0.15054, 1.17033e-05, 0.0232315, -0.000303636, 0.15063, 4.68397e-05, 0.0232354, -0.000683189, 0.150624, 0.000105472, 0.0232092, -0.0012136, 0.150445, 0.000187744, 0.0232523, -0.00189765, 0.150679, 0.000294847, 0.0232828, -0.00273247, 0.150789, 0.000428013, 0.0233371, -0.00371287, 0.150995, 0.000591134, 0.0234015, -0.00484794, 0.15118, 0.000787642, 0.023514, -0.00612877, 0.151562, 0.00102547, 0.023679, -0.00756125, 0.152116, 0.00131351, 0.0239559, -0.00914651, 0.153162, 0.00166594, 0.0244334, -0.010904, 0.155133, 0.00210182, 0.025139, -0.0128615, 0.158035, 0.00264406, 0.0262598, -0.0150628, 0.162751, 0.00332923, 0.0277875, -0.0175532, 0.168944, 0.00419773, 0.0298472, -0.0203981, 0.176835, 0.00530034, 0.0325444, -0.023655, 0.186686, 0.00669777, 0.0355581, -0.0272982, 0.196248, 0.00842661, 0.0392841, -0.0314457, 0.207352, 0.0105854, 0.0436815, -0.0361157, 0.219279, 0.0132458, 0.0485272, -0.0412932, 0.230728, 0.0164736, 0.0541574, -0.0470337, 0.242994, 0.0203715, 0.0609479, -0.0535002, 0.257042, 0.0250953, 0.0685228, -0.0605409, 0.27102, 0.0306856, 0.0768042, -0.0680553, 0.28406, 0.037193, 0.0864844, -0.0765011, 0.299186, 0.0449795, 0.0969415, -0.0852674, 0.3132, 0.0538316, 0.108478, -0.0947333, 0.327138, 0.0641149, 0.121705, -0.10481, 0.342345, 0.0759185, 0.136743, -0.115474, 0.358472, 0.0894116, 0.152986, -0.126536, 0.374067, 0.104562, 0.170397, -0.138061, 0.388267, 0.121632, 0.191392, -0.150203, 0.406467, 0.140996, 0.211566, -0.161751, 0.418641, 0.161696, 0.233567, -0.173407, 0.430418, 0.184557, 0.257769, -0.185397, 0.44277, 0.210092, 0.28531, -0.197048, 0.457191, 0.237827, 0.311726, -0.20784, 0.464712, 0.267253, 0.340537, -0.218345, 0.472539, 0.299332, 0.372921, -0.228306, 0.482331, 0.333988, 0.402924, -0.236665, 0.484378, 0.369722, 0.434475, -0.244097, 0.484717, 0.407836, 0.469736, -0.250547, 0.487093, 0.448465, 0.505045, -0.25511, 0.485575, 0.490263, 0.540262, -0.258444, 0.481225, 0.534495, 0.576347, -0.259903, 0.473481, 0.579451, 0.608656, -0.259572, 0.4603, 0.625604, 0.646679, -0.257908, 0.450341, 0.674511, 0.679902, -0.253663, 0.431561, 0.723269, 0.714159, -0.247419, 0.412684, 0.773263, 0.745345, -0.239122, 0.389388, 0.824182, 0.778248, -0.228837, 0.365361, 0.876634, 0.807208, -0.216197, 0.337667, 0.92945, 0.835019, -0.201772, 0.307197, 0.985261, 0.860261, -0.185291, 0.274205, 1.04299, 0.877601, -0.165809, 0.240178, 1.09816, 0.898211, -0.143897, 0.207571, 1.14694, 0.915789, -0.119513, 0.174904, 1.19008, 0.931831, -0.0932919, 0.141423, 1.2297, 0.949244, -0.0656528, 0.105603, 1.26553, 0.967527, -0.0370262, 0.0679551, 1.29986, 0.984139, -0.00730117, 0.0283133, 1.33252, 0.999713, 0.0234648, -0.0121785, 1.36397, 0.0152135, -2.45447e-06, 0.122795, 3.04092e-07, 0.0151652, -6.15778e-05, 0.122399, 7.6292e-06, 0.0151181, -0.000245948, 0.122023, 3.04802e-05, 0.0151203, -0.000553394, 0.12203, 6.86634e-05, 0.015125, -0.000983841, 0.122037, 0.000122463, 0.0151427, -0.00153774, 0.12214, 0.000192706, 0.0151708, -0.0022103, 0.122237, 0.000281219, 0.0152115, -0.00300741, 0.12238, 0.000390804, 0.0152877, -0.00392494, 0.1227, 0.000526317, 0.015412, -0.00496597, 0.123244, 0.00069443, 0.0156201, -0.00613314, 0.124228, 0.00090547, 0.0159658, -0.00744113, 0.125945, 0.0011732, 0.0165674, -0.00892546, 0.129098, 0.00151888, 0.017487, -0.010627, 0.133865, 0.00197007, 0.018839, -0.0126043, 0.140682, 0.0025637, 0.020554, -0.0148814, 0.148534, 0.00333637, 0.0226727, -0.0175123, 0.157381, 0.00433738, 0.0251879, -0.0205266, 0.166685, 0.00561664, 0.0283635, -0.0240319, 0.177796, 0.00725563, 0.0318694, -0.0279432, 0.188251, 0.00928811, 0.0361044, -0.0324313, 0.200038, 0.011835, 0.0406656, -0.0373527, 0.210685, 0.0149146, 0.0463846, -0.0430132, 0.224182, 0.0187254, 0.0525696, -0.0491013, 0.23634, 0.0232283, 0.0598083, -0.0559175, 0.250013, 0.0286521, 0.0679437, -0.0633657, 0.263981, 0.0350634, 0.0771181, -0.0714602, 0.278072, 0.0425882, 0.0881273, -0.0803502, 0.29511, 0.0514487, 0.0996628, -0.0896903, 0.309976, 0.0615766, 0.112702, -0.099644, 0.325611, 0.0732139, 0.126488, -0.109829, 0.339321, 0.0862324, 0.142625, -0.120859, 0.35574, 0.101275, 0.15953, -0.131956, 0.369845, 0.117892, 0.176991, -0.143145, 0.38146, 0.136205, 0.199715, -0.155292, 0.40052, 0.157252, 0.220787, -0.167066, 0.412055, 0.179966, 0.243697, -0.178396, 0.423133, 0.204418, 0.272106, -0.190433, 0.439524, 0.232141, 0.297637, -0.201265, 0.447041, 0.261109, 0.325273, -0.211834, 0.454488, 0.292627, 0.357219, -0.221889, 0.465004, 0.326669, 0.387362, -0.230729, 0.468527, 0.362426, 0.423131, -0.23924, 0.475836, 0.401533, 0.45543, -0.246067, 0.475017, 0.441902, 0.493393, -0.251557, 0.478017, 0.484239, 0.526253, -0.255571, 0.4709, 0.528586, 0.560554, -0.257752, 0.463167, 0.574346, 0.599306, -0.258076, 0.456452, 0.621655, 0.634541, -0.256471, 0.443725, 0.670492, 0.668907, -0.253283, 0.428719, 0.721943, 0.705619, -0.247562, 0.411348, 0.772477, 0.739034, -0.240626, 0.388939, 0.8264, 0.771408, -0.231493, 0.36425, 0.881702, 0.803312, -0.220125, 0.337321, 0.9385, 0.828457, -0.206645, 0.305364, 0.997437, 0.854819, -0.190664, 0.273715, 1.05693, 0.878666, -0.171429, 0.242218, 1.11251, 0.898404, -0.149235, 0.209556, 1.16398, 0.917416, -0.12435, 0.176863, 1.21014, 0.933133, -0.0972703, 0.142775, 1.25178, 0.95066, -0.0683607, 0.106735, 1.29028, 0.968589, -0.0378724, 0.0681609, 1.32703, 0.984776, -0.00605712, 0.0273966, 1.36158, 0.99994, 0.0263276, -0.0138124, 1.3943, 0.00867437, -1.86005e-06, 0.0928979, 1.73682e-07, 0.00864003, -4.66389e-05, 0.0925237, 4.35505e-06, 0.00864593, -0.000186594, 0.0925806, 1.74322e-05, 0.00864095, -0.000419639, 0.0924903, 3.92862e-05, 0.00863851, -0.000746272, 0.0924589, 7.02598e-05, 0.00868531, -0.00116456, 0.0929, 0.000111188, 0.00869667, -0.00167711, 0.0928529, 0.000163867, 0.00874332, -0.00228051, 0.0930914, 0.00023104, 0.00882709, -0.00297864, 0.0935679, 0.00031741, 0.00898874, -0.00377557, 0.0946165, 0.000430186, 0.00929346, -0.00469247, 0.0967406, 0.000580383, 0.00978271, -0.00575491, 0.100084, 0.000783529, 0.0105746, -0.00701514, 0.105447, 0.00106304, 0.0116949, -0.00851797, 0.112494, 0.00144685, 0.0130419, -0.0102757, 0.119876, 0.00196439, 0.0148375, -0.012381, 0.129034, 0.00266433, 0.0168725, -0.01482, 0.137812, 0.00358364, 0.0193689, -0.0176563, 0.147696, 0.00478132, 0.0222691, -0.0209211, 0.157795, 0.00631721, 0.0256891, -0.0246655, 0.168431, 0.00826346, 0.0294686, -0.0288597, 0.178587, 0.0106714, 0.0340412, -0.0336441, 0.190251, 0.0136629, 0.0393918, -0.039033, 0.202999, 0.0173272, 0.0453947, -0.0450087, 0.215655, 0.0217448, 0.0521936, -0.0515461, 0.228686, 0.0269941, 0.0600279, -0.058817, 0.242838, 0.033272, 0.0692398, -0.0667228, 0.258145, 0.0406457, 0.0793832, -0.0752401, 0.273565, 0.0492239, 0.0902297, -0.0841851, 0.287735, 0.0590105, 0.102014, -0.0936479, 0.301161, 0.0702021, 0.116054, -0.103967, 0.317438, 0.0832001, 0.13191, -0.114622, 0.334166, 0.0977951, 0.148239, -0.125452, 0.348192, 0.113985, 0.165809, -0.136453, 0.361094, 0.131928, 0.184616, -0.147648, 0.373534, 0.151811, 0.207491, -0.159607, 0.39101, 0.174476, 0.230106, -0.171119, 0.402504, 0.198798, 0.257036, -0.182906, 0.418032, 0.225796, 0.281172, -0.193605, 0.425468, 0.254027, 0.312034, -0.204771, 0.440379, 0.285713, 0.340402, -0.214988, 0.445406, 0.319196, 0.370231, -0.224711, 0.44968, 0.35537, 0.407105, -0.233516, 0.460747, 0.393838, 0.439037, -0.240801, 0.460624, 0.433747, 0.47781, -0.24762, 0.465957, 0.477234, 0.510655, -0.251823, 0.460054, 0.52044, 0.550584, -0.255552, 0.459172, 0.567853, 0.585872, -0.257036, 0.450311, 0.615943, 0.620466, -0.257535, 0.437763, 0.667693, 0.660496, -0.255248, 0.426639, 0.718988, 0.695578, -0.251141, 0.409185, 0.772503, 0.732176, -0.244718, 0.39015, 0.827023, 0.760782, -0.236782, 0.362594, 0.885651, 0.79422, -0.225923, 0.33711, 0.943756, 0.824521, -0.213855, 0.308272, 1.00874, 0.854964, -0.197723, 0.278529, 1.06764, 0.878065, -0.179209, 0.246208, 1.12836, 0.899834, -0.157569, 0.21329, 1.18318, 0.918815, -0.133206, 0.181038, 1.23161, 0.934934, -0.106545, 0.146993, 1.27644, 0.952115, -0.0780574, 0.111175, 1.31842, 0.96906, -0.0478279, 0.0728553, 1.35839, 0.985178, -0.0160014, 0.032579, 1.39697, 1.00039, 0.0173126, -0.0095256, 1.43312, 0.00384146, -1.24311e-06, 0.0613583, 7.78271e-08, 0.00390023, -3.14043e-05, 0.0622919, 1.96626e-06, 0.00389971, -0.000125622, 0.0622632, 7.87379e-06, 0.00389491, -0.000282352, 0.0620659, 1.778e-05, 0.00391618, -0.000502512, 0.0624687, 3.20918e-05, 0.00392662, -0.000784458, 0.0625113, 5.15573e-05, 0.00396053, -0.00112907, 0.0628175, 7.78668e-05, 0.00401911, -0.00153821, 0.0633286, 0.000113811, 0.00414994, -0.0020208, 0.0646443, 0.00016445, 0.00441223, -0.00260007, 0.0673886, 0.000237734, 0.00484427, -0.0033097, 0.0716528, 0.000345929, 0.00549109, -0.00418966, 0.0774998, 0.000505987, 0.00636293, -0.00527331, 0.0844758, 0.000739208, 0.00746566, -0.00660428, 0.0921325, 0.00107347, 0.00876625, -0.00818826, 0.0997067, 0.00153691, 0.0103125, -0.0100811, 0.107433, 0.00217153, 0.0123309, -0.0123643, 0.117088, 0.00303427, 0.0146274, -0.0150007, 0.126438, 0.00416018, 0.0172295, -0.0180531, 0.135672, 0.00561513, 0.0204248, -0.0215962, 0.146244, 0.007478, 0.0241597, -0.0256234, 0.157481, 0.00981046, 0.0284693, -0.0302209, 0.169125, 0.0127148, 0.033445, -0.0353333, 0.181659, 0.0162453, 0.0391251, -0.0410845, 0.1944, 0.0205417, 0.0454721, -0.0473451, 0.207082, 0.0256333, 0.0530983, -0.0542858, 0.221656, 0.0317036, 0.0615356, -0.0618384, 0.236036, 0.0388319, 0.0703363, -0.0697631, 0.248398, 0.046974, 0.0810391, -0.0784757, 0.263611, 0.0565246, 0.0920144, -0.0873488, 0.275857, 0.0671724, 0.105584, -0.0973652, 0.292555, 0.0798105, 0.119506, -0.107271, 0.306333, 0.0935945, 0.134434, -0.117608, 0.318888, 0.109106, 0.153399, -0.128938, 0.337552, 0.127074, 0.171258, -0.139944, 0.349955, 0.14643, 0.191059, -0.151288, 0.361545, 0.168, 0.215069, -0.163018, 0.378421, 0.192082, 0.237838, -0.174226, 0.38879, 0.217838, 0.266965, -0.186063, 0.405857, 0.246931, 0.292827, -0.196909, 0.414146, 0.277505, 0.324352, -0.207473, 0.426955, 0.310711, 0.354427, -0.217713, 0.433429, 0.346794, 0.389854, -0.227183, 0.443966, 0.385237, 0.420749, -0.235131, 0.44471, 0.424955, 0.459597, -0.242786, 0.451729, 0.468446, 0.495316, -0.248767, 0.45072, 0.513422, 0.534903, -0.253351, 0.450924, 0.560618, 0.572369, -0.256277, 0.445266, 0.609677, 0.612383, -0.2576, 0.438798, 0.660995, 0.644037, -0.256931, 0.421693, 0.713807, 0.686749, -0.254036, 0.4109, 0.767616, 0.719814, -0.249785, 0.390151, 0.82533, 0.754719, -0.244283, 0.367847, 0.888311, 0.792022, -0.235076, 0.345013, 0.948177, 0.822404, -0.225061, 0.316193, 1.01661, 0.853084, -0.211113, 0.287013, 1.08075, 0.879871, -0.19449, 0.255424, 1.14501, 0.901655, -0.174023, 0.222879, 1.20203, 0.919957, -0.1509, 0.18989, 1.25698, 0.938412, -0.124923, 0.15606, 1.30588, 0.953471, -0.0968139, 0.120512, 1.3529, 0.970451, -0.066734, 0.0828515, 1.3986, 0.985522, -0.034734, 0.0424458, 1.44148, 1.00099, -0.00102222, 0.000678929, 1.48398, 0.000965494, -6.27338e-07, 0.0306409, 1.97672e-08, 0.00099168, -1.58573e-05, 0.0314638, 4.99803e-07, 0.000991068, -6.34012e-05, 0.031363, 2.00682e-06, 0.000974567, -0.00014144, 0.03036, 4.57312e-06, 0.000998079, -0.000252812, 0.031496, 8.60131e-06, 0.00102243, -0.000396506, 0.0319955, 1.48288e-05, 0.00107877, -0.000577593, 0.0331376, 2.49141e-05, 0.00121622, -0.000816816, 0.0359396, 4.23011e-05, 0.0014455, -0.00113761, 0.0399652, 7.24613e-05, 0.00178791, -0.00156959, 0.0450556, 0.000123929, 0.00225668, -0.00214064, 0.0508025, 0.000208531, 0.00285627, -0.00287655, 0.0568443, 0.000341969, 0.0035991, -0.00380271, 0.0630892, 0.000544158, 0.00455524, -0.00496264, 0.0702204, 0.000842423, 0.00569143, -0.0063793, 0.0773426, 0.00126704, 0.00716928, -0.00813531, 0.0860839, 0.00186642, 0.00885307, -0.0101946, 0.0944079, 0.00267014, 0.0109316, -0.0126386, 0.103951, 0.00374033, 0.0133704, -0.0154876, 0.113786, 0.0051304, 0.0161525, -0.0187317, 0.123477, 0.00688858, 0.0194267, -0.0224652, 0.133986, 0.00910557, 0.0230967, -0.0265976, 0.143979, 0.0118074, 0.0273627, -0.0312848, 0.154645, 0.0151266, 0.0323898, -0.0365949, 0.166765, 0.0191791, 0.0379225, -0.0422914, 0.177932, 0.0239236, 0.0447501, -0.0487469, 0.19167, 0.0296568, 0.0519391, -0.0556398, 0.203224, 0.0362924, 0.0599464, -0.0631646, 0.215652, 0.0440585, 0.0702427, -0.0714308, 0.232089, 0.0531619, 0.0806902, -0.0800605, 0.245258, 0.0634564, 0.0923194, -0.0892815, 0.258609, 0.0752481, 0.106938, -0.09931, 0.276654, 0.0888914, 0.121238, -0.109575, 0.289847, 0.104055, 0.138817, -0.120461, 0.307566, 0.121266, 0.15595, -0.131209, 0.320117, 0.139944, 0.178418, -0.143049, 0.339677, 0.161591, 0.197875, -0.154074, 0.349886, 0.184303, 0.224368, -0.166307, 0.369352, 0.210669, 0.252213, -0.178051, 0.386242, 0.238895, 0.277321, -0.189335, 0.395294, 0.269182, 0.310332, -0.200683, 0.412148, 0.302508, 0.338809, -0.210856, 0.418266, 0.337264, 0.372678, -0.220655, 0.428723, 0.374881, 0.405632, -0.230053, 0.433887, 0.415656, 0.442293, -0.237993, 0.439911, 0.457982, 0.477256, -0.244897, 0.440175, 0.502831, 0.515592, -0.250657, 0.441079, 0.550277, 0.550969, -0.255459, 0.435219, 0.601102, 0.592883, -0.257696, 0.432882, 0.651785, 0.629092, -0.259894, 0.421054, 0.708961, 0.672033, -0.258592, 0.41177, 0.763806, 0.709147, -0.256525, 0.395267, 0.824249, 0.745367, -0.254677, 0.375013, 0.8951, 0.784715, -0.247892, 0.353906, 0.959317, 0.818107, -0.240162, 0.327801, 1.03153, 0.847895, -0.229741, 0.298821, 1.10601, 0.879603, -0.213084, 0.269115, 1.164, 0.902605, -0.195242, 0.236606, 1.22854, 0.922788, -0.174505, 0.203442, 1.29017, 0.944831, -0.150169, 0.169594, 1.34157, 0.959656, -0.124099, 0.135909, 1.3956, 0.972399, -0.0960626, 0.0990563, 1.45128, 0.986549, -0.0657097, 0.0602348, 1.50312, 1.00013, -0.0333558, 0.0186694, 1.55364, 6.19747e-06, -1e-07, 0.00778326, 7.96756e-11, 2.37499e-08, -9.99999e-08, 2.82592e-05, 1.14596e-10, 1.00292e-06, -1.66369e-06, 0.000250354, 6.77492e-09, 3.50752e-06, -6.37769e-06, 0.000357289, 6.31655e-08, 8.26445e-06, -1.74689e-05, 0.000516179, 3.1851e-07, 2.42481e-05, -4.50868e-05, 0.0010223, 1.30577e-06, 4.55631e-05, -8.9044e-05, 0.00144302, 3.74587e-06, 9.71222e-05, -0.000178311, 0.00241912, 1.02584e-05, 0.000171403, -0.000313976, 0.00354938, 2.36481e-05, 0.000292747, -0.000520026, 0.00513765, 4.96014e-05, 0.000789827, -0.00118187, 0.0238621, 0.000139056, 0.00114093, -0.00171827, 0.0286691, 0.000244093, 0.00176119, -0.00249667, 0.0368565, 0.000420623, 0.0022233, -0.00333742, 0.0400469, 0.00065673, 0.00343382, -0.00481976, 0.0535751, 0.00109323, 0.00427602, -0.00600755, 0.057099, 0.00155268, 0.00461435, -0.00737637, 0.0551084, 0.00215031, 0.00695698, -0.00971401, 0.0715767, 0.00316529, 0.00867619, -0.0120943, 0.0793314, 0.00436995, 0.0106694, -0.0148202, 0.0869391, 0.0058959, 0.0140351, -0.0183501, 0.101572, 0.00798757, 0.0168939, -0.022006, 0.11018, 0.0104233, 0.020197, -0.0261568, 0.119041, 0.0134167, 0.0254702, -0.0312778, 0.135404, 0.0173009, 0.0298384, -0.0362469, 0.1437, 0.0215428, 0.035159, -0.042237, 0.15512, 0.0268882, 0.0427685, -0.0488711, 0.17128, 0.033235, 0.0494848, -0.0557997, 0.181813, 0.0404443, 0.0592394, -0.0635578, 0.198745, 0.0490043, 0.0681463, -0.071838, 0.210497, 0.0588239, 0.0804753, -0.0809297, 0.228864, 0.0702835, 0.0942205, -0.0906488, 0.247008, 0.0834012, 0.106777, -0.100216, 0.258812, 0.0975952, 0.124471, -0.110827, 0.278617, 0.114162, 0.138389, -0.121193, 0.287049, 0.131983, 0.159543, -0.13253, 0.307151, 0.152541, 0.176432, -0.143611, 0.31564, 0.174673, 0.201723, -0.15548, 0.33538, 0.199842, 0.229721, -0.167166, 0.355256, 0.227097, 0.250206, -0.178238, 0.360047, 0.256014, 0.282118, -0.189905, 0.378761, 0.28855, 0.312821, -0.201033, 0.39181, 0.323348, 0.341482, -0.211584, 0.397716, 0.360564, 0.377368, -0.221314, 0.410141, 0.400004, 0.418229, -0.230474, 0.423485, 0.442371, 0.444881, -0.239443, 0.418874, 0.488796, 0.488899, -0.245987, 0.427545, 0.535012, 0.520317, -0.253948, 0.422147, 0.589678, 0.568566, -0.256616, 0.42719, 0.637683, 0.599607, -0.26376, 0.415114, 0.703363, 0.64222, -0.268687, 0.408715, 0.771363, 0.685698, -0.2694, 0.399722, 0.83574, 0.732327, -0.266642, 0.388651, 0.897764, 0.769873, -0.267712, 0.369198, 0.983312, 0.806733, -0.263479, 0.346802, 1.06222, 0.843466, -0.254575, 0.321368, 1.13477, 0.873008, -0.242749, 0.29211, 1.20712, 0.908438, -0.22725, 0.262143, 1.27465, 0.936321, -0.207621, 0.228876, 1.33203, 0.950353, -0.187932, 0.19484, 1.40439, 0.96442, -0.165154, 0.163178, 1.4732, 0.979856, -0.139302, 0.127531, 1.53574, 0.982561, -0.11134, 0.0903457, 1.59982, 0.996389, -0.0808124, 0.0489007, 1.6577 ];

	var LTC_MAT_2 = [ 1, 0, 0, 0, 1, 7.91421e-31, 0, 0, 1, 1.04392e-24, 0, 0, 1, 3.49405e-21, 0, 0, 1, 1.09923e-18, 0, 0, 1, 9.47414e-17, 0, 0, 1, 3.59627e-15, 0, 0, 1, 7.72053e-14, 0, 0, 1, 1.08799e-12, 0, 0, 1, 1.10655e-11, 0, 0, 1, 8.65818e-11, 0, 0, 0.999998, 5.45037e-10, 0, 0, 0.999994, 2.85095e-09, 0, 0, 0.999989, 1.26931e-08, 0, 0, 0.999973, 4.89938e-08, 0, 0, 0.999947, 1.66347e-07, 0, 0, 0.999894, 5.02694e-07, 0, 0, 0.999798, 1.36532e-06, 0, 0, 0.999617, 3.35898e-06, 0, 0, 0.999234, 7.52126e-06, 0, 0, 0.998258, 1.52586e-05, 0, 0, 0.99504, 2.66207e-05, 0, 0, 0.980816, 2.36802e-05, 0, 0, 0.967553, 2.07684e-06, 0, 0, 0.966877, 4.03733e-06, 0, 0, 0.965752, 7.41174e-06, 0, 0, 0.96382, 1.27746e-05, 0, 0, 0.960306, 2.02792e-05, 0, 0, 0.953619, 2.80232e-05, 0, 0, 0.941103, 2.78816e-05, 0, 0, 0.926619, 1.60221e-05, 0, 0, 0.920983, 2.35164e-05, 0, 0, 0.912293, 3.11924e-05, 0, 0.0158731, 0.899277, 3.48118e-05, 0, 0.0476191, 0.880884, 2.6041e-05, 0, 0.0793651, 0.870399, 3.38726e-05, 0, 0.111111, 0.856138, 3.92906e-05, 0, 0.142857, 0.837436, 3.72874e-05, 0, 0.174603, 0.820973, 3.92558e-05, 0, 0.206349, 0.803583, 4.34658e-05, 0, 0.238095, 0.782168, 4.0256e-05, 0, 0.269841, 0.764107, 4.48159e-05, 0, 0.301587, 0.743092, 4.57627e-05, 0, 0.333333, 0.721626, 4.55314e-05, 0, 0.365079, 0.700375, 4.77335e-05, 0, 0.396825, 0.677334, 4.61072e-05, 0, 0.428571, 0.655702, 4.84393e-05, 0, 0.460317, 0.632059, 4.64583e-05, 0, 0.492064, 0.610125, 4.83923e-05, 0, 0.52381, 0.58653, 4.64342e-05, 0, 0.555556, 0.564508, 4.77033e-05, 0, 0.587302, 0.541405, 4.59263e-05, 0, 0.619048, 0.519556, 4.6412e-05, 0, 0.650794, 0.497292, 4.48913e-05, 0, 0.68254, 0.475898, 4.45789e-05, 0, 0.714286, 0.454722, 4.33496e-05, 0, 0.746032, 0.434042, 4.23054e-05, 0, 0.777778, 0.414126, 4.13737e-05, 0, 0.809524, 0.394387, 3.97265e-05, 0, 0.84127, 0.375841, 3.90709e-05, 0, 0.873016, 0.357219, 3.69938e-05, 0, 0.904762, 0.340084, 3.65618e-05, 0, 0.936508, 0.322714, 3.42533e-05, 0, 0.968254, 0.306974, 3.39596e-05, 0, 1, 1, 1.01524e-18, 0, 0, 1, 1.0292e-18, 0, 0, 1, 1.30908e-18, 0, 0, 1, 4.73331e-18, 0, 0, 1, 6.25319e-17, 0, 0, 1, 1.07932e-15, 0, 0, 1, 1.63779e-14, 0, 0, 1, 2.03198e-13, 0, 0, 1, 2.04717e-12, 0, 0, 0.999999, 1.68995e-11, 0, 0, 0.999998, 1.15855e-10, 0, 0, 0.999996, 6.6947e-10, 0, 0, 0.999991, 3.30863e-09, 0, 0, 0.999983, 1.41737e-08, 0, 0, 0.999968, 5.32626e-08, 0, 0, 0.99994, 1.77431e-07, 0, 0, 0.999891, 5.28835e-07, 0, 0, 0.999797, 1.42169e-06, 0, 0, 0.999617, 3.47057e-06, 0, 0, 0.999227, 7.7231e-06, 0, 0, 0.998239, 1.55753e-05, 0, 0, 0.994937, 2.68495e-05, 0, 0, 0.980225, 2.13742e-05, 0, 0, 0.967549, 2.1631e-06, 0, 0, 0.966865, 4.17989e-06, 0, 0, 0.965739, 7.63341e-06, 0, 0, 0.963794, 1.30892e-05, 0, 0, 0.960244, 2.06456e-05, 0, 0, 0.953495, 2.82016e-05, 0, 0.000148105, 0.940876, 2.71581e-05, 0, 0.002454, 0.926569, 1.64159e-05, 0, 0.00867491, 0.920905, 2.39521e-05, 0, 0.01956, 0.912169, 3.15127e-05, 0, 0.035433, 0.899095, 3.46626e-05, 0, 0.056294, 0.882209, 2.90223e-05, 0, 0.0818191, 0.870272, 3.42992e-05, 0, 0.111259, 0.855977, 3.94164e-05, 0, 0.142857, 0.837431, 3.72343e-05, 0, 0.174603, 0.820826, 3.96691e-05, 0, 0.206349, 0.803408, 4.35395e-05, 0, 0.238095, 0.782838, 4.19579e-05, 0, 0.269841, 0.763941, 4.50953e-05, 0, 0.301587, 0.742904, 4.55847e-05, 0, 0.333333, 0.721463, 4.58833e-05, 0, 0.365079, 0.700197, 4.77159e-05, 0, 0.396825, 0.677501, 4.70641e-05, 0, 0.428571, 0.655527, 4.84732e-05, 0, 0.460317, 0.6324, 4.76834e-05, 0, 0.492064, 0.609964, 4.84213e-05, 0, 0.52381, 0.586839, 4.75541e-05, 0, 0.555556, 0.564353, 4.76951e-05, 0, 0.587302, 0.541589, 4.67611e-05, 0, 0.619048, 0.519413, 4.63493e-05, 0, 0.650794, 0.497337, 4.53994e-05, 0, 0.68254, 0.475797, 4.45308e-05, 0, 0.714286, 0.454659, 4.35787e-05, 0, 0.746032, 0.434065, 4.24839e-05, 0, 0.777778, 0.414018, 4.1436e-05, 0, 0.809524, 0.39455, 4.01902e-05, 0, 0.84127, 0.375742, 3.90813e-05, 0, 0.873016, 0.357501, 3.77116e-05, 0, 0.904762, 0.339996, 3.6535e-05, 0, 0.936508, 0.323069, 3.51265e-05, 0, 0.968254, 0.306897, 3.39112e-05, 0, 1, 1, 1.0396e-15, 0, 0, 1, 1.04326e-15, 0, 0, 1, 1.10153e-15, 0, 0, 1, 1.44668e-15, 0, 0, 1, 3.4528e-15, 0, 0, 1, 1.75958e-14, 0, 0, 1, 1.2627e-13, 0, 0, 1, 9.36074e-13, 0, 0, 1, 6.45742e-12, 0, 0, 0.999998, 4.01228e-11, 0, 0, 0.999997, 2.22338e-10, 0, 0, 0.999995, 1.0967e-09, 0, 0, 0.999991, 4.82132e-09, 0, 0, 0.999981, 1.89434e-08, 0, 0, 0.999967, 6.67716e-08, 0, 0, 0.999938, 2.12066e-07, 0, 0, 0.999886, 6.0977e-07, 0, 0, 0.999792, 1.59504e-06, 0, 0, 0.999608, 3.81191e-06, 0, 0, 0.999209, 8.33727e-06, 0, 0, 0.998179, 1.65288e-05, 0, 0, 0.994605, 2.74387e-05, 0, 0, 0.979468, 1.67316e-05, 0, 0, 0.967529, 2.42877e-06, 0, 0, 0.966836, 4.61696e-06, 0, 0, 0.96569, 8.30977e-06, 0, 0, 0.963706, 1.40427e-05, 0, 2.44659e-06, 0.960063, 2.17353e-05, 0, 0.000760774, 0.953113, 2.86606e-05, 0, 0.00367261, 0.940192, 2.47691e-05, 0, 0.00940263, 0.927731, 1.95814e-05, 0, 0.018333, 0.920669, 2.52531e-05, 0, 0.0306825, 0.911799, 3.24277e-05, 0, 0.0465556, 0.89857, 3.40982e-05, 0, 0.0659521, 0.883283, 3.19622e-05, 0, 0.0887677, 0.86989, 3.5548e-05, 0, 0.114784, 0.855483, 3.97143e-05, 0, 0.143618, 0.837987, 3.91665e-05, 0, 0.174606, 0.820546, 4.11306e-05, 0, 0.206349, 0.802878, 4.36753e-05, 0, 0.238095, 0.783402, 4.44e-05, 0, 0.269841, 0.763439, 4.58726e-05, 0, 0.301587, 0.742925, 4.67097e-05, 0, 0.333333, 0.721633, 4.78887e-05, 0, 0.365079, 0.69985, 4.81251e-05, 0, 0.396825, 0.67783, 4.91811e-05, 0, 0.428571, 0.655126, 4.88199e-05, 0, 0.460318, 0.632697, 4.96025e-05, 0, 0.492064, 0.609613, 4.8829e-05, 0, 0.52381, 0.587098, 4.92754e-05, 0, 0.555556, 0.564119, 4.82625e-05, 0, 0.587302, 0.541813, 4.82807e-05, 0, 0.619048, 0.519342, 4.71552e-05, 0, 0.650794, 0.497514, 4.66765e-05, 0, 0.68254, 0.475879, 4.55582e-05, 0, 0.714286, 0.454789, 4.46007e-05, 0, 0.746032, 0.434217, 4.35382e-05, 0, 0.777778, 0.414086, 4.21753e-05, 0, 0.809524, 0.394744, 4.12093e-05, 0, 0.84127, 0.375782, 3.96634e-05, 0, 0.873016, 0.357707, 3.86419e-05, 0, 0.904762, 0.340038, 3.70345e-05, 0, 0.936508, 0.323284, 3.59725e-05, 0, 0.968254, 0.306954, 3.436e-05, 0, 1, 1, 5.99567e-14, 0, 0, 1, 6.00497e-14, 0, 0, 1, 6.14839e-14, 0, 0, 1, 6.86641e-14, 0, 0, 1, 9.72658e-14, 0, 0, 1, 2.21271e-13, 0, 0, 1, 8.33195e-13, 0, 0, 1, 4.03601e-12, 0, 0, 0.999999, 2.06001e-11, 0, 0, 0.999998, 1.01739e-10, 0, 0, 0.999997, 4.70132e-10, 0, 0, 0.999993, 2.00436e-09, 0, 0, 0.999988, 7.83682e-09, 0, 0, 0.999979, 2.80338e-08, 0, 0, 0.999962, 9.17033e-08, 0, 0, 0.999933, 2.74514e-07, 0, 0, 0.999881, 7.53201e-07, 0, 0, 0.999783, 1.89826e-06, 0, 0, 0.999594, 4.40279e-06, 0, 0, 0.999178, 9.3898e-06, 0, 0, 0.998073, 1.81265e-05, 0, 0, 0.993993, 2.80487e-05, 0, 0, 0.979982, 1.49422e-05, 0, 0, 0.968145, 3.78481e-06, 0, 0, 0.966786, 5.3771e-06, 0, 0, 0.965611, 9.47508e-06, 0, 3.88934e-05, 0.963557, 1.56616e-05, 0, 0.0009693, 0.959752, 2.35144e-05, 0, 0.00370329, 0.952461, 2.91568e-05, 0, 0.00868428, 0.940193, 2.40102e-05, 0, 0.0161889, 0.929042, 2.31235e-05, 0, 0.0263948, 0.920266, 2.73968e-05, 0, 0.0394088, 0.911178, 3.37915e-05, 0, 0.0552818, 0.897873, 3.33629e-05, 0, 0.0740138, 0.884053, 3.51405e-05, 0, 0.0955539, 0.869455, 3.78034e-05, 0, 0.119795, 0.854655, 3.99378e-05, 0, 0.14656, 0.838347, 4.19108e-05, 0, 0.175573, 0.820693, 4.40831e-05, 0, 0.206388, 0.802277, 4.45599e-05, 0, 0.238095, 0.783634, 4.72691e-05, 0, 0.269841, 0.763159, 4.76984e-05, 0, 0.301587, 0.742914, 4.91487e-05, 0, 0.333333, 0.721662, 5.02312e-05, 0, 0.365079, 0.699668, 5.02817e-05, 0, 0.396825, 0.677839, 5.1406e-05, 0, 0.428571, 0.655091, 5.11095e-05, 0, 0.460317, 0.632665, 5.16067e-05, 0, 0.492064, 0.609734, 5.12255e-05, 0, 0.52381, 0.587043, 5.10263e-05, 0, 0.555556, 0.564298, 5.0565e-05, 0, 0.587302, 0.541769, 4.97951e-05, 0, 0.619048, 0.519529, 4.92698e-05, 0, 0.650794, 0.497574, 4.82066e-05, 0, 0.68254, 0.476028, 4.73689e-05, 0, 0.714286, 0.454961, 4.61941e-05, 0, 0.746032, 0.434341, 4.50618e-05, 0, 0.777778, 0.414364, 4.38355e-05, 0, 0.809524, 0.394832, 4.24196e-05, 0, 0.84127, 0.376109, 4.12563e-05, 0, 0.873016, 0.35779, 3.96226e-05, 0, 0.904762, 0.340379, 3.84886e-05, 0, 0.936508, 0.323385, 3.68214e-05, 0, 0.968254, 0.307295, 3.56636e-05, 0, 1, 1, 1.06465e-12, 0, 0, 1, 1.06555e-12, 0, 0, 1, 1.07966e-12, 0, 0, 1, 1.14601e-12, 0, 0, 1, 1.37123e-12, 0, 0, 1, 2.1243e-12, 0, 0, 0.999999, 4.89653e-12, 0, 0, 0.999999, 1.60283e-11, 0, 0, 0.999998, 6.2269e-11, 0, 0, 0.999997, 2.51859e-10, 0, 0, 0.999996, 9.96192e-10, 0, 0, 0.999992, 3.74531e-09, 0, 0, 0.999986, 1.32022e-08, 0, 0, 0.999975, 4.33315e-08, 0, 0, 0.999959, 1.31956e-07, 0, 0, 0.999927, 3.72249e-07, 0, 0, 0.999871, 9.72461e-07, 0, 0, 0.999771, 2.35343e-06, 0, 0, 0.999572, 5.2768e-06, 0, 0, 0.999133, 1.09237e-05, 0, 0, 0.997912, 2.03675e-05, 0, 0, 0.993008, 2.79396e-05, 0, 0, 0.980645, 1.39604e-05, 0, 0, 0.970057, 6.46596e-06, 0, 0, 0.966717, 6.5089e-06, 0, 4.74145e-05, 0.965497, 1.11863e-05, 0, 0.00089544, 0.96334, 1.79857e-05, 0, 0.0032647, 0.959294, 2.59045e-05, 0, 0.0075144, 0.951519, 2.92327e-05, 0, 0.0138734, 0.940517, 2.49769e-05, 0, 0.0224952, 0.93014, 2.6803e-05, 0, 0.0334828, 0.91972, 3.03656e-05, 0, 0.0468973, 0.910294, 3.53323e-05, 0, 0.0627703, 0.897701, 3.51002e-05, 0, 0.0811019, 0.884522, 3.88104e-05, 0, 0.10186, 0.869489, 4.12932e-05, 0, 0.124985, 0.853983, 4.15781e-05, 0, 0.150372, 0.838425, 4.54066e-05, 0, 0.177868, 0.820656, 4.71624e-05, 0, 0.207245, 0.801875, 4.75243e-05, 0, 0.238143, 0.783521, 5.05621e-05, 0, 0.269841, 0.763131, 5.0721e-05, 0, 0.301587, 0.74261, 5.23293e-05, 0, 0.333333, 0.72148, 5.28699e-05, 0, 0.365079, 0.699696, 5.38677e-05, 0, 0.396825, 0.677592, 5.39255e-05, 0, 0.428571, 0.65525, 5.46367e-05, 0, 0.460317, 0.632452, 5.41348e-05, 0, 0.492064, 0.609903, 5.44976e-05, 0, 0.52381, 0.586928, 5.36201e-05, 0, 0.555556, 0.564464, 5.35185e-05, 0, 0.587302, 0.541801, 5.24949e-05, 0, 0.619048, 0.519681, 5.1812e-05, 0, 0.650794, 0.497685, 5.07687e-05, 0, 0.68254, 0.47622, 4.96243e-05, 0, 0.714286, 0.455135, 4.85714e-05, 0, 0.746032, 0.4346, 4.71847e-05, 0, 0.777778, 0.414564, 4.59294e-05, 0, 0.809524, 0.395165, 4.44705e-05, 0, 0.84127, 0.376333, 4.30772e-05, 0, 0.873016, 0.358197, 4.16229e-05, 0, 0.904762, 0.34064, 4.01019e-05, 0, 0.936508, 0.323816, 3.86623e-05, 0, 0.968254, 0.307581, 3.70933e-05, 0, 1, 1, 9.91541e-12, 0, 0, 1, 9.92077e-12, 0, 0, 1, 1.00041e-11, 0, 0, 1, 1.0385e-11, 0, 0, 1, 1.15777e-11, 0, 0, 1, 1.50215e-11, 0, 0, 0.999999, 2.54738e-11, 0, 0, 0.999999, 5.98822e-11, 0, 0, 0.999998, 1.79597e-10, 0, 0, 0.999997, 6.02367e-10, 0, 0, 0.999994, 2.06835e-09, 0, 0, 0.99999, 6.94952e-09, 0, 0, 0.999984, 2.23363e-08, 0, 0, 0.999972, 6.78578e-08, 0, 0, 0.999952, 1.93571e-07, 0, 0, 0.999919, 5.16594e-07, 0, 0, 0.99986, 1.28739e-06, 0, 0, 0.999753, 2.99298e-06, 0, 0, 0.999546, 6.48258e-06, 0, 0, 0.999074, 1.29985e-05, 0, 0, 0.997671, 2.32176e-05, 0, 0, 0.991504, 2.56701e-05, 0, 0, 0.981148, 1.31141e-05, 0, 0, 0.971965, 8.69048e-06, 0, 2.80182e-05, 0.966624, 8.08301e-06, 0, 0.000695475, 0.965344, 1.35235e-05, 0, 0.00265522, 0.963048, 2.10592e-05, 0, 0.00622975, 0.958673, 2.87473e-05, 0, 0.0116234, 0.950262, 2.81379e-05, 0, 0.018976, 0.940836, 2.71089e-05, 0, 0.0283844, 0.930996, 3.0926e-05, 0, 0.0399151, 0.919848, 3.48359e-05, 0, 0.0536063, 0.909136, 3.66092e-05, 0, 0.0694793, 0.897554, 3.84162e-05, 0, 0.0875342, 0.884691, 4.30971e-05, 0, 0.107749, 0.869414, 4.47803e-05, 0, 0.130087, 0.853462, 4.52858e-05, 0, 0.154481, 0.838187, 4.95769e-05, 0, 0.180833, 0.820381, 5.02709e-05, 0, 0.209005, 0.801844, 5.22713e-05, 0, 0.238791, 0.783061, 5.41505e-05, 0, 0.269869, 0.763205, 5.53712e-05, 0, 0.301587, 0.742362, 5.64909e-05, 0, 0.333333, 0.721393, 5.72646e-05, 0, 0.365079, 0.699676, 5.81012e-05, 0, 0.396825, 0.677395, 5.8096e-05, 0, 0.428571, 0.655208, 5.85766e-05, 0, 0.460317, 0.632451, 5.83602e-05, 0, 0.492064, 0.609839, 5.80234e-05, 0, 0.52381, 0.587093, 5.77161e-05, 0, 0.555556, 0.564467, 5.68447e-05, 0, 0.587302, 0.542043, 5.63166e-05, 0, 0.619048, 0.519826, 5.5156e-05, 0, 0.650794, 0.497952, 5.41682e-05, 0, 0.68254, 0.476477, 5.28971e-05, 0, 0.714286, 0.455412, 5.14952e-05, 0, 0.746032, 0.434926, 5.02222e-05, 0, 0.777778, 0.4149, 4.85779e-05, 0, 0.809524, 0.395552, 4.72242e-05, 0, 0.84127, 0.376712, 4.54891e-05, 0, 0.873016, 0.358622, 4.40924e-05, 0, 0.904762, 0.341048, 4.22984e-05, 0, 0.936508, 0.324262, 4.08582e-05, 0, 0.968254, 0.308013, 3.90839e-05, 0, 1, 1, 6.13913e-11, 0, 0, 1, 6.14145e-11, 0, 0, 1, 6.17708e-11, 0, 0, 1, 6.33717e-11, 0, 0, 1, 6.81648e-11, 0, 0, 1, 8.08291e-11, 0, 0, 1, 1.14608e-10, 0, 0, 0.999998, 2.10507e-10, 0, 0, 0.999997, 4.99595e-10, 0, 0, 0.999995, 1.39897e-09, 0, 0, 0.999994, 4.19818e-09, 0, 0, 0.999988, 1.27042e-08, 0, 0, 0.999979, 3.75153e-08, 0, 0, 0.999965, 1.06206e-07, 0, 0, 0.999945, 2.85381e-07, 0, 0, 0.999908, 7.23611e-07, 0, 0, 0.999846, 1.7255e-06, 0, 0, 0.999733, 3.86104e-06, 0, 0, 0.999511, 8.08493e-06, 0, 0, 0.998993, 1.56884e-05, 0, 0, 0.997326, 2.65538e-05, 0, 0, 0.989706, 2.06466e-05, 0, 0, 0.981713, 1.30756e-05, 0, 7.0005e-06, 0.973636, 1.06473e-05, 0, 0.000464797, 0.966509, 1.0194e-05, 0, 0.00201743, 0.965149, 1.65881e-05, 0, 0.00497549, 0.962669, 2.49147e-05, 0, 0.00953262, 0.95786, 3.17449e-05, 0, 0.0158211, 0.949334, 2.81045e-05, 0, 0.0239343, 0.941041, 3.03263e-05, 0, 0.0339372, 0.931575, 3.56754e-05, 0, 0.0458738, 0.920102, 3.97075e-05, 0, 0.059772, 0.908002, 3.84886e-05, 0, 0.075645, 0.897269, 4.3027e-05, 0, 0.0934929, 0.884559, 4.79925e-05, 0, 0.113302, 0.869161, 4.8246e-05, 0, 0.135045, 0.853342, 5.09505e-05, 0, 0.158678, 0.837633, 5.42846e-05, 0, 0.184136, 0.820252, 5.54139e-05, 0, 0.211325, 0.801872, 5.81412e-05, 0, 0.240113, 0.782418, 5.85535e-05, 0, 0.270306, 0.7631, 6.10923e-05, 0, 0.301594, 0.742183, 6.13678e-05, 0, 0.333333, 0.721098, 6.27275e-05, 0, 0.365079, 0.699512, 6.29413e-05, 0, 0.396825, 0.677372, 6.36351e-05, 0, 0.428571, 0.655059, 6.33555e-05, 0, 0.460317, 0.632567, 6.36513e-05, 0, 0.492064, 0.609784, 6.28965e-05, 0, 0.52381, 0.587237, 6.25546e-05, 0, 0.555556, 0.564525, 6.15825e-05, 0, 0.587302, 0.542181, 6.05048e-05, 0, 0.619048, 0.520017, 5.96329e-05, 0, 0.650794, 0.498204, 5.81516e-05, 0, 0.68254, 0.476742, 5.69186e-05, 0, 0.714286, 0.455803, 5.53833e-05, 0, 0.746032, 0.435251, 5.37807e-05, 0, 0.777778, 0.415374, 5.22025e-05, 0, 0.809524, 0.395921, 5.03421e-05, 0, 0.84127, 0.377253, 4.88211e-05, 0, 0.873016, 0.359021, 4.68234e-05, 0, 0.904762, 0.341637, 4.53269e-05, 0, 0.936508, 0.3247, 4.33014e-05, 0, 0.968254, 0.308625, 4.18007e-05, 0, 1, 1, 2.86798e-10, 0, 0, 1, 2.86877e-10, 0, 0, 1, 2.88094e-10, 0, 0, 1, 2.93506e-10, 0, 0, 1, 3.09262e-10, 0, 0, 0.999999, 3.48593e-10, 0, 0, 0.999999, 4.44582e-10, 0, 0, 0.999998, 6.88591e-10, 0, 0, 0.999996, 1.34391e-09, 0, 0, 0.999993, 3.17438e-09, 0, 0, 0.999989, 8.35609e-09, 0, 0, 0.999983, 2.28677e-08, 0, 0, 0.999974, 6.23361e-08, 0, 0, 0.999959, 1.65225e-07, 0, 0, 0.999936, 4.19983e-07, 0, 0, 0.999896, 1.01546e-06, 0, 0, 0.99983, 2.32376e-06, 0, 0, 0.999709, 5.0156e-06, 0, 0, 0.999469, 1.0167e-05, 0, 0, 0.998886, 1.90775e-05, 0, 0, 0.996819, 3.00511e-05, 0, 0, 0.988837, 1.85092e-05, 0, 1.68222e-07, 0.982178, 1.34622e-05, 0, 0.000259622, 0.975017, 1.25961e-05, 0, 0.00142595, 0.967101, 1.3507e-05, 0, 0.00382273, 0.964905, 2.05003e-05, 0, 0.00764164, 0.96218, 2.9546e-05, 0, 0.0130121, 0.956821, 3.43738e-05, 0, 0.0200253, 0.948829, 3.05063e-05, 0, 0.0287452, 0.941092, 3.46487e-05, 0, 0.039218, 0.931883, 4.12061e-05, 0, 0.0514748, 0.920211, 4.44651e-05, 0, 0.0655351, 0.907307, 4.31252e-05, 0, 0.0814082, 0.89684, 4.90382e-05, 0, 0.0990939, 0.884119, 5.3334e-05, 0, 0.118583, 0.869148, 5.4114e-05, 0, 0.139856, 0.853377, 5.78536e-05, 0, 0.162882, 0.836753, 5.92285e-05, 0, 0.187615, 0.820063, 6.22787e-05, 0, 0.213991, 0.801694, 6.45492e-05, 0, 0.241918, 0.782116, 6.5353e-05, 0, 0.271267, 0.762673, 6.74344e-05, 0, 0.301847, 0.742133, 6.82788e-05, 0, 0.333333, 0.720779, 6.91959e-05, 0, 0.365079, 0.699386, 6.96817e-05, 0, 0.396826, 0.67732, 6.99583e-05, 0, 0.428572, 0.654888, 6.98447e-05, 0, 0.460318, 0.632499, 6.94063e-05, 0, 0.492064, 0.609825, 6.91612e-05, 0, 0.52381, 0.587287, 6.81576e-05, 0, 0.555556, 0.564743, 6.74138e-05, 0, 0.587302, 0.542409, 6.61617e-05, 0, 0.619048, 0.520282, 6.47785e-05, 0, 0.650794, 0.498506, 6.33836e-05, 0, 0.68254, 0.477102, 6.15905e-05, 0, 0.714286, 0.456167, 6.01013e-05, 0, 0.746032, 0.435728, 5.81457e-05, 0, 0.777778, 0.415809, 5.64215e-05, 0, 0.809524, 0.396517, 5.44997e-05, 0, 0.84127, 0.377737, 5.25061e-05, 0, 0.873016, 0.359698, 5.06831e-05, 0, 0.904762, 0.342164, 4.8568e-05, 0, 0.936508, 0.325417, 4.67826e-05, 0, 0.968254, 0.309186, 4.46736e-05, 0, 1, 1, 1.09018e-09, 0, 0, 1, 1.0904e-09, 0, 0, 1, 1.09393e-09, 0, 0, 1, 1.1095e-09, 0, 0, 1, 1.154e-09, 0, 0, 1, 1.26089e-09, 0, 0, 0.999999, 1.5059e-09, 0, 0, 0.999997, 2.07899e-09, 0, 0, 0.999994, 3.48164e-09, 0, 0, 0.999993, 7.05728e-09, 0, 0, 0.999987, 1.63692e-08, 0, 0, 0.999981, 4.06033e-08, 0, 0, 0.999969, 1.0245e-07, 0, 0, 0.999953, 2.55023e-07, 0, 0, 0.999925, 6.1511e-07, 0, 0, 0.999881, 1.42218e-06, 0, 0, 0.99981, 3.13086e-06, 0, 0, 0.99968, 6.53119e-06, 0, 0, 0.999418, 1.2832e-05, 0, 0, 0.998748, 2.32497e-05, 0, 0, 0.996066, 3.29522e-05, 0, 0, 0.988379, 1.79613e-05, 0, 0.000108799, 0.982567, 1.43715e-05, 0, 0.000921302, 0.976097, 1.48096e-05, 0, 0.00280738, 0.968475, 1.78905e-05, 0, 0.00596622, 0.964606, 2.53921e-05, 0, 0.0105284, 0.961564, 3.48623e-05, 0, 0.0165848, 0.955517, 3.57612e-05, 0, 0.0242, 0.948381, 3.43493e-05, 0, 0.03342, 0.941095, 4.05849e-05, 0, 0.0442777, 0.931923, 4.75394e-05, 0, 0.0567958, 0.91996, 4.84328e-05, 0, 0.0709879, 0.907419, 5.02146e-05, 0, 0.086861, 0.89618, 5.61654e-05, 0, 0.104415, 0.88337, 5.87612e-05, 0, 0.123643, 0.869046, 6.18057e-05, 0, 0.144531, 0.853278, 6.57392e-05, 0, 0.167057, 0.836091, 6.6303e-05, 0, 0.191188, 0.819644, 7.04445e-05, 0, 0.216878, 0.801246, 7.14071e-05, 0, 0.244062, 0.782031, 7.40093e-05, 0, 0.272649, 0.762066, 7.4685e-05, 0, 0.302509, 0.741964, 7.66647e-05, 0, 0.333442, 0.720554, 7.66328e-05, 0, 0.365079, 0.699098, 7.77857e-05, 0, 0.396826, 0.677189, 7.74633e-05, 0, 0.428572, 0.65484, 7.76235e-05, 0, 0.460318, 0.632496, 7.70316e-05, 0, 0.492064, 0.609908, 7.62669e-05, 0, 0.52381, 0.587312, 7.53972e-05, 0, 0.555556, 0.564938, 7.39994e-05, 0, 0.587302, 0.542577, 7.28382e-05, 0, 0.619048, 0.52062, 7.1112e-05, 0, 0.650794, 0.498819, 6.94004e-05, 0, 0.68254, 0.477555, 6.75575e-05, 0, 0.714286, 0.456568, 6.53449e-05, 0, 0.746032, 0.436278, 6.36068e-05, 0, 0.777778, 0.41637, 6.13466e-05, 0, 0.809524, 0.397144, 5.94177e-05, 0, 0.84127, 0.378412, 5.70987e-05, 0, 0.873016, 0.360376, 5.50419e-05, 0, 0.904762, 0.342906, 5.27422e-05, 0, 0.936508, 0.326136, 5.06544e-05, 0, 0.968254, 0.30997, 4.84307e-05, 0, 1, 1, 3.54014e-09, 0, 0, 1, 3.54073e-09, 0, 0, 1, 3.54972e-09, 0, 0, 1, 3.58929e-09, 0, 0, 1, 3.70093e-09, 0, 0, 0.999999, 3.96194e-09, 0, 0, 0.999998, 4.53352e-09, 0, 0, 0.999997, 5.78828e-09, 0, 0, 0.999994, 8.63812e-09, 0, 0, 0.999991, 1.53622e-08, 0, 0, 0.999985, 3.16356e-08, 0, 0, 0.999977, 7.12781e-08, 0, 0, 0.999964, 1.66725e-07, 0, 0, 0.999945, 3.90501e-07, 0, 0, 0.999912, 8.95622e-07, 0, 0, 0.999866, 1.98428e-06, 0, 0, 0.999786, 4.21038e-06, 0, 0, 0.999647, 8.50239e-06, 0, 0, 0.999356, 1.62059e-05, 0, 0, 0.998563, 2.82652e-05, 0, 0, 0.994928, 3.36309e-05, 0, 2.44244e-05, 0.987999, 1.78458e-05, 0, 0.000523891, 0.982893, 1.59162e-05, 0, 0.00194729, 0.977044, 1.78056e-05, 0, 0.00451099, 0.969972, 2.30624e-05, 0, 0.00835132, 0.964237, 3.13922e-05, 0, 0.013561, 0.960791, 4.06145e-05, 0, 0.0202056, 0.954292, 3.72796e-05, 0, 0.0283321, 0.948052, 4.03199e-05, 0, 0.0379739, 0.940938, 4.79537e-05, 0, 0.0491551, 0.931689, 5.45292e-05, 0, 0.0618918, 0.91987, 5.4038e-05, 0, 0.0761941, 0.907665, 5.89909e-05, 0, 0.0920672, 0.895281, 6.42651e-05, 0, 0.109511, 0.882621, 6.59707e-05, 0, 0.12852, 0.86873, 7.09973e-05, 0, 0.149085, 0.853008, 7.42221e-05, 0, 0.171189, 0.835944, 7.61754e-05, 0, 0.194809, 0.818949, 7.97052e-05, 0, 0.21991, 0.800951, 8.12434e-05, 0, 0.246447, 0.781847, 8.38075e-05, 0, 0.274352, 0.761649, 8.4501e-05, 0, 0.303535, 0.74152, 8.60258e-05, 0, 0.333857, 0.720495, 8.66233e-05, 0, 0.365104, 0.698742, 8.68326e-05, 0, 0.396826, 0.677096, 8.7133e-05, 0, 0.428572, 0.654782, 8.63497e-05, 0, 0.460318, 0.632335, 8.60206e-05, 0, 0.492064, 0.610031, 8.49337e-05, 0, 0.52381, 0.587457, 8.38279e-05, 0, 0.555556, 0.56513, 8.2309e-05, 0, 0.587302, 0.542877, 8.03542e-05, 0, 0.619048, 0.5209, 7.86928e-05, 0, 0.650794, 0.499291, 7.65171e-05, 0, 0.68254, 0.477971, 7.44753e-05, 0, 0.714286, 0.457221, 7.2209e-05, 0, 0.746032, 0.436803, 6.97448e-05, 0, 0.777778, 0.417083, 6.75333e-05, 0, 0.809524, 0.397749, 6.48058e-05, 0, 0.84127, 0.379177, 6.25759e-05, 0, 0.873016, 0.361061, 5.98584e-05, 0, 0.904762, 0.343713, 5.75797e-05, 0, 0.936508, 0.326894, 5.49999e-05, 0, 0.968254, 0.310816, 5.27482e-05, 0, 1, 1, 1.0153e-08, 0, 0, 1, 1.01544e-08, 0, 0, 1, 1.01751e-08, 0, 0, 1, 1.02662e-08, 0, 0, 1, 1.0521e-08, 0, 0, 0.999999, 1.11049e-08, 0, 0, 0.999999, 1.23408e-08, 0, 0, 0.999996, 1.4924e-08, 0, 0, 0.999992, 2.04471e-08, 0, 0, 0.999989, 3.26539e-08, 0, 0, 0.99998, 6.03559e-08, 0, 0, 0.999971, 1.23936e-07, 0, 0, 0.999955, 2.69058e-07, 0, 0, 0.999933, 5.93604e-07, 0, 0, 0.999901, 1.29633e-06, 0, 0, 0.999847, 2.75621e-06, 0, 0, 0.999761, 5.64494e-06, 0, 0, 0.999607, 1.10485e-05, 0, 0, 0.999282, 2.04388e-05, 0, 0, 0.99831, 3.41084e-05, 0, 2.2038e-07, 0.993288, 2.94949e-05, 0, 0.000242388, 0.987855, 1.92736e-05, 0, 0.0012503, 0.983167, 1.82383e-05, 0, 0.0032745, 0.977908, 2.18633e-05, 0, 0.00646321, 0.971194, 2.90662e-05, 0, 0.0109133, 0.963867, 3.86401e-05, 0, 0.0166927, 0.95982, 4.62827e-05, 0, 0.0238494, 0.953497, 4.20705e-05, 0, 0.0324178, 0.947621, 4.77743e-05, 0, 0.0424225, 0.940611, 5.68258e-05, 0, 0.0538808, 0.931174, 6.18061e-05, 0, 0.0668047, 0.919919, 6.27098e-05, 0, 0.0812014, 0.907856, 6.94714e-05, 0, 0.0970745, 0.894509, 7.35008e-05, 0, 0.114424, 0.881954, 7.63369e-05, 0, 0.133246, 0.868309, 8.21896e-05, 0, 0.153534, 0.852511, 8.3769e-05, 0, 0.175275, 0.835821, 8.81615e-05, 0, 0.198453, 0.817981, 8.96368e-05, 0, 0.223042, 0.800504, 9.30906e-05, 0, 0.249009, 0.78141, 9.45056e-05, 0, 0.276304, 0.761427, 9.63605e-05, 0, 0.304862, 0.74094, 9.68088e-05, 0, 0.334584, 0.720233, 9.81481e-05, 0, 0.365322, 0.698592, 9.79122e-05, 0, 0.396826, 0.676763, 9.81057e-05, 0, 0.428571, 0.654808, 9.73956e-05, 0, 0.460318, 0.632326, 9.62619e-05, 0, 0.492064, 0.610049, 9.52996e-05, 0, 0.52381, 0.58763, 9.33334e-05, 0, 0.555556, 0.565261, 9.17573e-05, 0, 0.587302, 0.543244, 8.96636e-05, 0, 0.619048, 0.521273, 8.73304e-05, 0, 0.650794, 0.499818, 8.52648e-05, 0, 0.68254, 0.478536, 8.23961e-05, 0, 0.714286, 0.457826, 7.9939e-05, 0, 0.746032, 0.437549, 7.7126e-05, 0, 0.777778, 0.41776, 7.43043e-05, 0, 0.809524, 0.39863, 7.16426e-05, 0, 0.84127, 0.379954, 6.86456e-05, 0, 0.873016, 0.362025, 6.60514e-05, 0, 0.904762, 0.344581, 6.30755e-05, 0, 0.936508, 0.327909, 6.05439e-05, 0, 0.968254, 0.311736, 5.76345e-05, 0, 1, 1, 2.63344e-08, 0, 0, 1, 2.63373e-08, 0, 0, 1, 2.63815e-08, 0, 0, 1, 2.65753e-08, 0, 0, 1, 2.71132e-08, 0, 0, 0.999999, 2.83279e-08, 0, 0, 0.999997, 3.0833e-08, 0, 0, 0.999995, 3.58711e-08, 0, 0, 0.999992, 4.61266e-08, 0, 0, 0.999985, 6.7574e-08, 0, 0, 0.999977, 1.1358e-07, 0, 0, 0.999966, 2.13657e-07, 0, 0, 0.999948, 4.31151e-07, 0, 0, 0.999923, 8.96656e-07, 0, 0, 0.999884, 1.86603e-06, 0, 0, 0.999826, 3.81115e-06, 0, 0, 0.999732, 7.54184e-06, 0, 0, 0.999561, 1.43192e-05, 0, 0, 0.999191, 2.57061e-05, 0, 0, 0.997955, 4.05724e-05, 0, 7.44132e-05, 0.992228, 2.76537e-05, 0, 0.000716477, 0.987638, 2.08885e-05, 0, 0.0022524, 0.983395, 2.15226e-05, 0, 0.00484816, 0.978614, 2.70795e-05, 0, 0.00860962, 0.972389, 3.65282e-05, 0, 0.0136083, 0.964392, 4.74747e-05, 0, 0.0198941, 0.95861, 5.09141e-05, 0, 0.0275023, 0.952806, 4.8963e-05, 0, 0.0364584, 0.94712, 5.71119e-05, 0, 0.04678, 0.940104, 6.71704e-05, 0, 0.0584799, 0.930398, 6.87586e-05, 0, 0.0715665, 0.919866, 7.38161e-05, 0, 0.086045, 0.907853, 8.13235e-05, 0, 0.101918, 0.894078, 8.34582e-05, 0, 0.119186, 0.881177, 8.92093e-05, 0, 0.137845, 0.867575, 9.44548e-05, 0, 0.157891, 0.852107, 9.69607e-05, 0, 0.179316, 0.835502, 0.000101456, 0, 0.202106, 0.81756, 0.000103256, 0, 0.226243, 0.79984, 0.000106954, 0, 0.251704, 0.780998, 0.000108066, 0, 0.278451, 0.761132, 0.000110111, 0, 0.306436, 0.740429, 0.000110459, 0, 0.335586, 0.719836, 0.000111219, 0, 0.365796, 0.698467, 0.00011145, 0, 0.3969, 0.676446, 0.000110393, 0, 0.428571, 0.654635, 0.000110035, 0, 0.460318, 0.632411, 0.000108548, 0, 0.492064, 0.609986, 0.000106963, 0, 0.52381, 0.587872, 0.000105238, 0, 0.555556, 0.565528, 0.000102665, 0, 0.587302, 0.543563, 0.000100543, 0, 0.619048, 0.52176, 9.76182e-05, 0, 0.650794, 0.500188, 9.47099e-05, 0, 0.68254, 0.479204, 9.19929e-05, 0, 0.714286, 0.458413, 8.86139e-05, 0, 0.746032, 0.438314, 8.57839e-05, 0, 0.777778, 0.418573, 8.2411e-05, 0, 0.809524, 0.39947, 7.92211e-05, 0, 0.84127, 0.380892, 7.59546e-05, 0, 0.873016, 0.362953, 7.27571e-05, 0, 0.904762, 0.345601, 6.95738e-05, 0, 0.936508, 0.328895, 6.64907e-05, 0, 0.968254, 0.312808, 6.34277e-05, 0, 1, 1, 6.28647e-08, 0, 0, 1, 6.28705e-08, 0, 0, 1, 6.29587e-08, 0, 0, 1, 6.33441e-08, 0, 0, 0.999999, 6.44087e-08, 0, 0, 0.999998, 6.67856e-08, 0, 0, 0.999997, 7.15889e-08, 0, 0, 0.999995, 8.09577e-08, 0, 0, 0.999989, 9.92764e-08, 0, 0, 0.999983, 1.35834e-07, 0, 0, 0.999974, 2.10482e-07, 0, 0, 0.999959, 3.65215e-07, 0, 0, 0.999939, 6.86693e-07, 0, 0, 0.999911, 1.3472e-06, 0, 0, 0.999868, 2.6731e-06, 0, 0, 0.999804, 5.24756e-06, 0, 0, 0.9997, 1.00403e-05, 0, 0, 0.99951, 1.85019e-05, 0, 0, 0.999078, 3.22036e-05, 0, 6.20676e-06, 0.997428, 4.70002e-05, 0, 0.000341552, 0.99162, 2.87123e-05, 0, 0.00143727, 0.987479, 2.34706e-05, 0, 0.00349201, 0.983582, 2.60083e-05, 0, 0.0066242, 0.979186, 3.37927e-05, 0, 0.0109113, 0.97325, 4.54689e-05, 0, 0.0164064, 0.965221, 5.73759e-05, 0, 0.0231463, 0.957262, 5.44114e-05, 0, 0.0311571, 0.952211, 5.87006e-05, 0, 0.0404572, 0.946631, 6.92256e-05, 0, 0.0510592, 0.939391, 7.87819e-05, 0, 0.0629723, 0.929795, 7.92368e-05, 0, 0.0762025, 0.91965, 8.75075e-05, 0, 0.090753, 0.907737, 9.50903e-05, 0, 0.106626, 0.893899, 9.72963e-05, 0, 0.123822, 0.880239, 0.00010459, 0, 0.142337, 0.866562, 0.000107689, 0, 0.16217, 0.85164, 0.000113081, 0, 0.183314, 0.835021, 0.000116636, 0, 0.20576, 0.817311, 0.000120074, 0, 0.229496, 0.798845, 0.000121921, 0, 0.254502, 0.780479, 0.00012475, 0, 0.280753, 0.760694, 0.000125255, 0, 0.308212, 0.740142, 0.000126719, 0, 0.336825, 0.719248, 0.00012636, 0, 0.366517, 0.698209, 0.000126712, 0, 0.397167, 0.676398, 0.000125769, 0, 0.428578, 0.654378, 0.000124432, 0, 0.460318, 0.632484, 0.000123272, 0, 0.492064, 0.610113, 0.00012085, 0, 0.52381, 0.587931, 0.000118411, 0, 0.555556, 0.565872, 0.00011569, 0, 0.587302, 0.543814, 0.000112521, 0, 0.619048, 0.522265, 0.000109737, 0, 0.650794, 0.500835, 0.000106228, 0, 0.68254, 0.479818, 0.000102591, 0, 0.714286, 0.459258, 9.91288e-05, 0, 0.746032, 0.439061, 9.52325e-05, 0, 0.777778, 0.419552, 9.1895e-05, 0, 0.809524, 0.400399, 8.79051e-05, 0, 0.84127, 0.381976, 8.44775e-05, 0, 0.873016, 0.364009, 8.06316e-05, 0, 0.904762, 0.346761, 7.71848e-05, 0, 0.936508, 0.330049, 7.35429e-05, 0, 0.968254, 0.314018, 7.02103e-05, 0, 1, 1, 1.39968e-07, 0, 0, 1, 1.39979e-07, 0, 0, 1, 1.40145e-07, 0, 0, 1, 1.4087e-07, 0, 0, 0.999999, 1.42865e-07, 0, 0, 0.999998, 1.47279e-07, 0, 0, 0.999997, 1.56057e-07, 0, 0, 0.999992, 1.7276e-07, 0, 0, 0.999989, 2.04352e-07, 0, 0, 0.99998, 2.6494e-07, 0, 0, 0.999969, 3.83435e-07, 0, 0, 0.999953, 6.18641e-07, 0, 0, 0.999929, 1.08755e-06, 0, 0, 0.999898, 2.01497e-06, 0, 0, 0.999849, 3.81346e-06, 0, 0, 0.999778, 7.19815e-06, 0, 0, 0.999661, 1.33215e-05, 0, 0, 0.999451, 2.38313e-05, 0, 0, 0.998936, 4.01343e-05, 0, 0.000113724, 0.99662, 5.17346e-05, 0, 0.000820171, 0.991094, 3.04323e-05, 0, 0.00238143, 0.987487, 2.81757e-05, 0, 0.00493527, 0.983731, 3.20048e-05, 0, 0.00856859, 0.979647, 4.23905e-05, 0, 0.0133393, 0.973837, 5.62935e-05, 0, 0.0192863, 0.96584, 6.77442e-05, 0, 0.0264369, 0.956309, 6.23073e-05, 0, 0.03481, 0.951523, 7.04131e-05, 0, 0.0444184, 0.946003, 8.36594e-05, 0, 0.0552713, 0.938454, 9.11736e-05, 0, 0.0673749, 0.929279, 9.38264e-05, 0, 0.0807329, 0.919239, 0.000103754, 0, 0.0953479, 0.907293, 0.000109928, 0, 0.111221, 0.893936, 0.000115257, 0, 0.128352, 0.879674, 0.000122265, 0, 0.14674, 0.865668, 0.000125733, 0, 0.166382, 0.850998, 0.000132305, 0, 0.187276, 0.834498, 0.000134844, 0, 0.209413, 0.816903, 0.000139276, 0, 0.232786, 0.798235, 0.000140984, 0, 0.257382, 0.779724, 0.00014378, 0, 0.283181, 0.760251, 0.000144623, 0, 0.310156, 0.739808, 0.000145228, 0, 0.338269, 0.718762, 0.00014539, 0, 0.367461, 0.697815, 0.000144432, 0, 0.397646, 0.67631, 0.000143893, 0, 0.428685, 0.654278, 0.000141846, 0, 0.460318, 0.632347, 0.00013935, 0, 0.492064, 0.610296, 0.000137138, 0, 0.52381, 0.588039, 0.000133806, 0, 0.555556, 0.566218, 0.000130755, 0, 0.587302, 0.544346, 0.000127128, 0, 0.619048, 0.522701, 0.000123002, 0, 0.650794, 0.501542, 0.000119443, 0, 0.68254, 0.480508, 0.000115055, 0, 0.714286, 0.460092, 0.000111032, 0, 0.746032, 0.440021, 0.000106635, 0, 0.777778, 0.420446, 0.000102162, 0, 0.809524, 0.401512, 9.8184e-05, 0, 0.84127, 0.38299, 9.36497e-05, 0, 0.873016, 0.365232, 8.9813e-05, 0, 0.904762, 0.347865, 8.53073e-05, 0, 0.936508, 0.331342, 8.17068e-05, 0, 0.968254, 0.315202, 7.73818e-05, 0, 1, 1, 2.9368e-07, 0, 0, 1, 2.937e-07, 0, 0, 1, 2.93998e-07, 0, 0, 1, 2.95298e-07, 0, 0, 0.999999, 2.98865e-07, 0, 0, 0.999998, 3.067e-07, 0, 0, 0.999995, 3.22082e-07, 0, 0, 0.999992, 3.50767e-07, 0, 0, 0.999986, 4.03538e-07, 0, 0, 0.999976, 5.01372e-07, 0, 0, 0.999964, 6.8562e-07, 0, 0, 0.999945, 1.0374e-06, 0, 0, 0.999919, 1.71269e-06, 0, 0, 0.999882, 3.00175e-06, 0, 0, 0.999829, 5.42144e-06, 0, 0, 0.999749, 9.84182e-06, 0, 0, 0.99962, 1.76213e-05, 0, 0, 0.999382, 3.05995e-05, 0, 1.38418e-05, 0.998751, 4.96686e-05, 0, 0.000389844, 0.995344, 5.10733e-05, 0, 0.00150343, 0.990768, 3.45829e-05, 0, 0.00352451, 0.987464, 3.42841e-05, 0, 0.00655379, 0.983846, 3.99072e-05, 0, 0.0106554, 0.980007, 5.33219e-05, 0, 0.0158723, 0.974494, 6.96992e-05, 0, 0.0222333, 0.96622, 7.76754e-05, 0, 0.029758, 0.956273, 7.47718e-05, 0, 0.0384596, 0.950952, 8.64611e-05, 0, 0.0483473, 0.945215, 0.000100464, 0, 0.0594266, 0.937287, 0.000103729, 0, 0.0717019, 0.928649, 0.000111665, 0, 0.0851752, 0.918791, 0.00012353, 0, 0.0998479, 0.906685, 0.000127115, 0, 0.115721, 0.893706, 0.00013628, 0, 0.132794, 0.879248, 0.000142427, 0, 0.151067, 0.864685, 0.000148091, 0, 0.170538, 0.850032, 0.000153517, 0, 0.191204, 0.833853, 0.000157322, 0, 0.213063, 0.816353, 0.000161086, 0, 0.236107, 0.797834, 0.000164111, 0, 0.260329, 0.778831, 0.000165446, 0, 0.285714, 0.759756, 0.000167492, 0, 0.312243, 0.739419, 0.000166928, 0, 0.339887, 0.718491, 0.000167, 0, 0.368604, 0.697392, 0.000165674, 0, 0.398329, 0.676102, 0.000163815, 0, 0.428961, 0.654243, 0.000162003, 0, 0.460331, 0.632176, 0.000158831, 0, 0.492064, 0.610407, 0.000155463, 0, 0.52381, 0.588394, 0.000152062, 0, 0.555556, 0.56645, 0.000147665, 0, 0.587302, 0.5449, 0.00014375, 0, 0.619048, 0.523276, 0.000138905, 0, 0.650794, 0.502179, 0.000134189, 0, 0.68254, 0.481359, 0.000129392, 0, 0.714286, 0.46092, 0.000124556, 0, 0.746032, 0.441084, 0.00011957, 0, 0.777778, 0.421517, 0.000114652, 0, 0.809524, 0.402721, 0.000109688, 0, 0.84127, 0.384222, 0.000104667, 0, 0.873016, 0.366534, 9.99633e-05, 0, 0.904762, 0.349205, 9.50177e-05, 0, 0.936508, 0.332702, 9.07301e-05, 0, 0.968254, 0.316599, 8.59769e-05, 0, 1, 1, 5.85473e-07, 0, 0, 1, 5.85507e-07, 0, 0, 1, 5.8602e-07, 0, 0, 0.999999, 5.88259e-07, 0, 0, 0.999999, 5.94381e-07, 0, 0, 0.999998, 6.07754e-07, 0, 0, 0.999995, 6.33729e-07, 0, 0, 0.99999, 6.8137e-07, 0, 0, 0.999984, 7.67003e-07, 0, 0, 0.999973, 9.21212e-07, 0, 0, 0.999959, 1.20218e-06, 0, 0, 0.999936, 1.72024e-06, 0, 0, 0.999907, 2.68088e-06, 0, 0, 0.999866, 4.45512e-06, 0, 0, 0.999806, 7.68481e-06, 0, 0, 0.999716, 1.342e-05, 0, 0, 0.999576, 2.32473e-05, 0, 0, 0.9993, 3.91694e-05, 0, 0.000129917, 0.998498, 6.08429e-05, 0, 0.000845035, 0.994132, 4.89743e-05, 0, 0.00237616, 0.99031, 3.84644e-05, 0, 0.00484456, 0.987409, 4.21768e-05, 0, 0.00832472, 0.983981, 5.04854e-05, 0, 0.0128643, 0.980268, 6.71028e-05, 0, 0.0184947, 0.974875, 8.52749e-05, 0, 0.025237, 0.966063, 8.5531e-05, 0, 0.0331046, 0.956779, 9.00588e-05, 0, 0.0421067, 0.950259, 0.00010577, 0, 0.0522487, 0.944239, 0.000119458, 0, 0.0635343, 0.936341, 0.000122164, 0, 0.0759654, 0.928047, 0.000134929, 0, 0.0895434, 0.918065, 0.000145544, 0, 0.104269, 0.906267, 0.000150531, 0, 0.120142, 0.893419, 0.000161652, 0, 0.137163, 0.878758, 0.00016593, 0, 0.15533, 0.863699, 0.000174014, 0, 0.174645, 0.848876, 0.000177877, 0, 0.195106, 0.833032, 0.000184049, 0, 0.21671, 0.815557, 0.000186088, 0, 0.239454, 0.797323, 0.00019054, 0, 0.263332, 0.778124, 0.000191765, 0, 0.288336, 0.758929, 0.000192535, 0, 0.314451, 0.738979, 0.000192688, 0, 0.341658, 0.718213, 0.000191522, 0, 0.369924, 0.696947, 0.000190491, 0, 0.399202, 0.675807, 0.000187913, 0, 0.429416, 0.654147, 0.000184451, 0, 0.460447, 0.63229, 0.000181442, 0, 0.492064, 0.610499, 0.000177139, 0, 0.523809, 0.588747, 0.000172596, 0, 0.555555, 0.566783, 0.000167457, 0, 0.587301, 0.545359, 0.000162518, 0, 0.619048, 0.523984, 0.000156818, 0, 0.650794, 0.502917, 0.000151884, 0, 0.68254, 0.482294, 0.000145514, 0, 0.714286, 0.461945, 0.000140199, 0, 0.746032, 0.442133, 0.000134101, 0, 0.777778, 0.422705, 0.000128374, 0, 0.809524, 0.403916, 0.000122996, 0, 0.84127, 0.38554, 0.000116808, 0, 0.873016, 0.367909, 0.000111973, 0, 0.904762, 0.350651, 0.000105938, 0, 0.936508, 0.334208, 0.000101355, 0, 0.968254, 0.318123, 9.57629e-05, 0, 1, 1, 1.11633e-06, 0, 0, 1, 1.11639e-06, 0, 0, 1, 1.11725e-06, 0, 0, 1, 1.12096e-06, 0, 0, 0.999999, 1.1311e-06, 0, 0, 0.999997, 1.15315e-06, 0, 0, 0.999995, 1.1956e-06, 0, 0, 0.999989, 1.27239e-06, 0, 0, 0.999981, 1.40772e-06, 0, 0, 0.999969, 1.64541e-06, 0, 0, 0.999952, 2.06607e-06, 0, 0, 0.999928, 2.81783e-06, 0, 0, 0.999895, 4.16835e-06, 0, 0, 0.999848, 6.58728e-06, 0, 0, 0.999781, 1.08648e-05, 0, 0, 0.999682, 1.82579e-05, 0, 0, 0.999523, 3.06003e-05, 0, 1.59122e-05, 0.999205, 4.99862e-05, 0, 0.000391184, 0.998131, 7.3306e-05, 0, 0.00147534, 0.993334, 5.13229e-05, 0, 0.0034227, 0.99016, 4.67783e-05, 0, 0.00632232, 0.987321, 5.23413e-05, 0, 0.0102295, 0.984099, 6.4267e-05, 0, 0.0151794, 0.980432, 8.43042e-05, 0, 0.0211947, 0.974976, 0.000102819, 0, 0.0282899, 0.966429, 9.96234e-05, 0, 0.0364739, 0.957633, 0.000111074, 0, 0.0457522, 0.949422, 0.000128644, 0, 0.0561278, 0.943045, 0.000140076, 0, 0.0676023, 0.935448, 0.000146349, 0, 0.0801762, 0.927225, 0.000161854, 0, 0.0938499, 0.917033, 0.000169135, 0, 0.108623, 0.905762, 0.000179987, 0, 0.124496, 0.892879, 0.000189832, 0, 0.141469, 0.878435, 0.000195881, 0, 0.159541, 0.863114, 0.00020466, 0, 0.178713, 0.84776, 0.000209473, 0, 0.198985, 0.832084, 0.000214861, 0, 0.220355, 0.814915, 0.000217695, 0, 0.242823, 0.796711, 0.000220313, 0, 0.266385, 0.777603, 0.00022313, 0, 0.291036, 0.757991, 0.000222471, 0, 0.316767, 0.738371, 0.000222869, 0, 0.343563, 0.717872, 0.000221243, 0, 0.371402, 0.696619, 0.000218089, 0, 0.400248, 0.675379, 0.00021562, 0, 0.430047, 0.65411, 0.00021169, 0, 0.460709, 0.63241, 0.000206947, 0, 0.492079, 0.61046, 0.000201709, 0, 0.52381, 0.58903, 0.000196753, 0, 0.555556, 0.567267, 0.000189637, 0, 0.587302, 0.545886, 0.000184735, 0, 0.619048, 0.524714, 0.000177257, 0, 0.650794, 0.503789, 0.000171424, 0, 0.68254, 0.483204, 0.000164688, 0, 0.714286, 0.462976, 0.000157172, 0, 0.746032, 0.443294, 0.000151341, 0, 0.777778, 0.423988, 0.000143737, 0, 0.809524, 0.405325, 0.000138098, 0, 0.84127, 0.386981, 0.000130698, 0, 0.873016, 0.369436, 0.000125276, 0, 0.904762, 0.35219, 0.000118349, 0, 0.936508, 0.335804, 0.00011312, 0, 0.968254, 0.319749, 0.000106687, 0, 1, 1, 2.04685e-06, 0, 0, 1, 2.04694e-06, 0, 0, 1, 2.04831e-06, 0, 0, 0.999999, 2.05428e-06, 0, 0, 0.999999, 2.07056e-06, 0, 0, 0.999997, 2.10581e-06, 0, 0, 0.999993, 2.1732e-06, 0, 0, 0.999987, 2.29365e-06, 0, 0, 0.999979, 2.50243e-06, 0, 0, 0.999965, 2.86127e-06, 0, 0, 0.999947, 3.48028e-06, 0, 0, 0.999918, 4.55588e-06, 0, 0, 0.999881, 6.43303e-06, 0, 0, 0.999828, 9.70064e-06, 0, 0, 0.999753, 1.53233e-05, 0, 0, 0.999642, 2.4793e-05, 0, 0, 0.999464, 4.02032e-05, 0, 0.000122947, 0.999089, 6.35852e-05, 0, 0.000807414, 0.997567, 8.57026e-05, 0, 0.00227206, 0.992903, 5.94912e-05, 0, 0.00462812, 0.990011, 5.78515e-05, 0, 0.00794162, 0.987192, 6.5399e-05, 0, 0.0122534, 0.98418, 8.19675e-05, 0, 0.0175888, 0.980491, 0.000105514, 0, 0.0239635, 0.974779, 0.000121532, 0, 0.031387, 0.96675, 0.000119144, 0, 0.0398644, 0.958248, 0.000136125, 0, 0.0493982, 0.948884, 0.000155408, 0, 0.0599896, 0.941673, 0.000162281, 0, 0.0716382, 0.934521, 0.000176754, 0, 0.0843437, 0.926205, 0.000192873, 0, 0.0981056, 0.916089, 0.000200038, 0, 0.112923, 0.904963, 0.000213624, 0, 0.128796, 0.892089, 0.000221834, 0, 0.145725, 0.878028, 0.000232619, 0, 0.163709, 0.86249, 0.000238632, 0, 0.182749, 0.846587, 0.000247002, 0, 0.202847, 0.830988, 0.000250702, 0, 0.224001, 0.814165, 0.000255562, 0, 0.246214, 0.796135, 0.000257505, 0, 0.269482, 0.777052, 0.000258625, 0, 0.293805, 0.757201, 0.000258398, 0, 0.319176, 0.737655, 0.000256714, 0, 0.345587, 0.717477, 0.000255187, 0, 0.373021, 0.696433, 0.000251792, 0, 0.401454, 0.675084, 0.000247223, 0, 0.430844, 0.653907, 0.000242213, 0, 0.461125, 0.632561, 0.000237397, 0, 0.492187, 0.610658, 0.000229313, 0, 0.52381, 0.589322, 0.000224402, 0, 0.555556, 0.567857, 0.000216116, 0, 0.587302, 0.54652, 0.000209124, 0, 0.619048, 0.525433, 0.000201601, 0, 0.650794, 0.504679, 0.000192957, 0, 0.68254, 0.484203, 0.000186052, 0, 0.714286, 0.464203, 0.000177672, 0, 0.746032, 0.444549, 0.000170005, 0, 0.777778, 0.425346, 0.000162401, 0, 0.809524, 0.406706, 0.0001544, 0, 0.84127, 0.388576, 0.000147437, 0, 0.873016, 0.37094, 0.000139493, 0, 0.904762, 0.353996, 0.000133219, 0, 0.936508, 0.337391, 0.000125573, 0, 0.968254, 0.321648, 0.000119867, 0, 1, 1, 3.62511e-06, 0, 0, 1, 3.62525e-06, 0, 0, 1, 3.62739e-06, 0, 0, 0.999999, 3.63673e-06, 0, 0, 0.999998, 3.66214e-06, 0, 0, 0.999996, 3.71698e-06, 0, 0, 0.999992, 3.82116e-06, 0, 0, 0.999986, 4.00554e-06, 0, 0, 0.999976, 4.32058e-06, 0, 0, 0.999961, 4.85194e-06, 0, 0, 0.999938, 5.74808e-06, 0, 0, 0.999908, 7.26643e-06, 0, 0, 0.999865, 9.84707e-06, 0, 0, 0.999807, 1.42217e-05, 0, 0, 0.999723, 2.15581e-05, 0, 0, 0.999602, 3.36114e-05, 0, 1.19113e-05, 0.999398, 5.27353e-05, 0, 0.000355813, 0.998946, 8.05809e-05, 0, 0.00137768, 0.996647, 9.42908e-05, 0, 0.00322469, 0.992298, 6.68733e-05, 0, 0.00597897, 0.989802, 7.16564e-05, 0, 0.00968903, 0.987019, 8.21355e-05, 0, 0.0143845, 0.984219, 0.000104555, 0, 0.0200831, 0.980425, 0.000131245, 0, 0.0267948, 0.974241, 0.000139613, 0, 0.034525, 0.967006, 0.000145931, 0, 0.0432757, 0.95893, 0.000167153, 0, 0.0530471, 0.949157, 0.000188146, 0, 0.0638386, 0.94062, 0.000194625, 0, 0.0756487, 0.933509, 0.000213721, 0, 0.0884762, 0.925088, 0.000229616, 0, 0.10232, 0.915178, 0.000239638, 0, 0.117178, 0.904093, 0.000254814, 0, 0.133051, 0.891337, 0.000263685, 0, 0.149939, 0.877326, 0.000274789, 0, 0.167841, 0.861794, 0.000280534, 0, 0.18676, 0.845758, 0.000289534, 0, 0.206696, 0.829792, 0.000294446, 0, 0.22765, 0.813037, 0.000296877, 0, 0.249625, 0.795285, 0.000300217, 0, 0.27262, 0.776323, 0.000299826, 0, 0.296636, 0.756673, 0.000299787, 0, 0.321671, 0.736856, 0.000297867, 0, 0.347718, 0.716883, 0.000294052, 0, 0.374768, 0.696089, 0.000289462, 0, 0.402804, 0.67505, 0.000285212, 0, 0.431796, 0.653509, 0.00027653, 0, 0.461695, 0.63258, 0.000271759, 0, 0.49242, 0.61104, 0.000262811, 0, 0.523822, 0.589567, 0.000255151, 0, 0.555556, 0.568322, 0.000246434, 0, 0.587302, 0.547235, 0.000237061, 0, 0.619048, 0.52616, 0.000228343, 0, 0.650794, 0.505716, 0.000219236, 0, 0.68254, 0.485274, 0.000209595, 0, 0.714286, 0.465411, 0.000201011, 0, 0.746032, 0.445854, 0.00019109, 0, 0.777778, 0.426911, 0.000182897, 0, 0.809524, 0.408222, 0.000173569, 0, 0.84127, 0.390307, 0.000165496, 0, 0.873016, 0.372624, 0.000156799, 0, 0.904762, 0.355804, 0.00014917, 0, 0.936508, 0.33924, 0.000140907, 0, 0.968254, 0.323534, 0.000134062, 0, 1, 1, 6.22487e-06, 0, 0, 1, 6.2251e-06, 0, 0, 1, 6.22837e-06, 0, 0, 0.999999, 6.24259e-06, 0, 0, 0.999998, 6.28127e-06, 0, 0, 0.999996, 6.36451e-06, 0, 0, 0.999991, 6.5218e-06, 0, 0, 0.999984, 6.79782e-06, 0, 0, 0.999973, 7.26361e-06, 0, 0, 0.999955, 8.03644e-06, 0, 0, 0.999931, 9.31397e-06, 0, 0, 0.999896, 1.14299e-05, 0, 0, 0.999847, 1.49402e-05, 0, 0, 0.999784, 2.07461e-05, 0, 0, 0.999692, 3.02493e-05, 0, 0, 0.999554, 4.54957e-05, 0, 9.97275e-05, 0.999326, 6.90762e-05, 0, 0.000724813, 0.998757, 0.000101605, 0, 0.0020972, 0.995367, 9.58745e-05, 0, 0.00432324, 0.99209, 8.32808e-05, 0, 0.00746347, 0.989517, 8.87601e-05, 0, 0.0115534, 0.987008, 0.00010564, 0, 0.0166134, 0.98421, 0.000133179, 0, 0.0226552, 0.98021, 0.000161746, 0, 0.0296838, 0.973676, 0.000161821, 0, 0.0377016, 0.967052, 0.000178635, 0, 0.0467079, 0.959385, 0.000206765, 0, 0.0567013, 0.949461, 0.00022476, 0, 0.0676796, 0.939578, 0.00023574, 0, 0.0796403, 0.932416, 0.00025893, 0, 0.0925812, 0.923759, 0.000271228, 0, 0.106501, 0.914223, 0.000289165, 0, 0.121397, 0.902942, 0.000301156, 0, 0.13727, 0.890419, 0.000313852, 0, 0.15412, 0.876639, 0.000324408, 0, 0.171946, 0.861316, 0.00033249, 0, 0.190751, 0.84496, 0.000338497, 0, 0.210537, 0.828427, 0.000345861, 0, 0.231305, 0.811871, 0.000347863, 0, 0.253057, 0.794397, 0.000350225, 0, 0.275797, 0.775726, 0.000349915, 0, 0.299525, 0.75617, 0.000347297, 0, 0.324242, 0.736091, 0.000344232, 0, 0.349947, 0.716213, 0.000340835, 0, 0.376633, 0.695736, 0.000332369, 0, 0.404289, 0.674961, 0.000327943, 0, 0.432895, 0.653518, 0.000318533, 0, 0.462415, 0.632574, 0.000310391, 0, 0.492788, 0.61134, 0.000300755, 0, 0.523909, 0.590017, 0.000290506, 0, 0.555556, 0.568752, 0.000280446, 0, 0.587302, 0.548061, 0.000269902, 0, 0.619048, 0.52711, 0.000258815, 0, 0.650794, 0.506682, 0.000248481, 0, 0.68254, 0.486524, 0.000237141, 0, 0.714286, 0.466812, 0.000226872, 0, 0.746032, 0.44732, 0.000216037, 0, 0.777778, 0.428473, 0.000205629, 0, 0.809524, 0.409921, 0.000195691, 0, 0.84127, 0.392028, 0.000185457, 0, 0.873016, 0.374606, 0.000176436, 0, 0.904762, 0.357601, 0.000166508, 0, 0.936508, 0.341348, 0.000158385, 0, 0.968254, 0.32542, 0.000149203, 0, 1, 1, 1.03967e-05, 0, 0, 1, 1.0397e-05, 0, 0, 1, 1.04019e-05, 0, 0, 0.999999, 1.04231e-05, 0, 0, 0.999998, 1.04806e-05, 0, 0, 0.999995, 1.06042e-05, 0, 0, 0.999991, 1.08366e-05, 0, 0, 0.999982, 1.12415e-05, 0, 0, 0.999968, 1.19174e-05, 0, 0, 0.99995, 1.30227e-05, 0, 0, 0.999922, 1.48176e-05, 0, 0, 0.999884, 1.77303e-05, 0, 0, 0.99983, 2.24564e-05, 0, 0, 0.999758, 3.00966e-05, 0, 0, 0.999654, 4.23193e-05, 0, 5.49083e-06, 0.999503, 6.14848e-05, 0, 0.000296087, 0.999237, 9.03576e-05, 0, 0.00123144, 0.998491, 0.0001271, 0, 0.00295954, 0.994594, 0.000107754, 0, 0.00555829, 0.99178, 0.000103025, 0, 0.00907209, 0.989265, 0.00011154, 0, 0.0135257, 0.986998, 0.000136296, 0, 0.0189327, 0.984137, 0.000169154, 0, 0.0252993, 0.979798, 0.000196671, 0, 0.0326272, 0.97337, 0.000196678, 0, 0.0409157, 0.967239, 0.000223121, 0, 0.0501623, 0.959543, 0.000253809, 0, 0.0603638, 0.949466, 0.000265972, 0, 0.0715171, 0.939074, 0.000288372, 0, 0.0836187, 0.931118, 0.000310983, 0, 0.0966657, 0.922525, 0.000325561, 0, 0.110656, 0.912983, 0.000345725, 0, 0.125588, 0.901617, 0.0003556, 0, 0.141461, 0.889487, 0.000374012, 0, 0.158275, 0.875787, 0.000383445, 0, 0.176031, 0.860654, 0.000393972, 0, 0.19473, 0.844417, 0.000400311, 0, 0.214374, 0.82741, 0.000405004, 0, 0.234967, 0.810545, 0.000407378, 0, 0.256512, 0.793312, 0.000407351, 0, 0.279011, 0.774847, 0.000406563, 0, 0.302468, 0.755621, 0.000404903, 0, 0.326887, 0.735511, 0.000397486, 0, 0.352266, 0.715435, 0.00039357, 0, 0.378605, 0.695403, 0.000384739, 0, 0.405897, 0.674681, 0.000376108, 0, 0.43413, 0.65359, 0.000365997, 0, 0.463277, 0.632471, 0.000354957, 0, 0.493295, 0.61151, 0.000343593, 0, 0.524106, 0.59064, 0.000331841, 0, 0.555561, 0.569386, 0.000318891, 0, 0.587302, 0.548785, 0.0003072, 0, 0.619048, 0.528146, 0.00029361, 0, 0.650794, 0.507872, 0.000281709, 0, 0.68254, 0.487805, 0.000268627, 0, 0.714286, 0.468196, 0.000255887, 0, 0.746032, 0.448922, 0.000243997, 0, 0.777778, 0.430093, 0.000231662, 0, 0.809524, 0.411845, 0.000220339, 0, 0.84127, 0.393808, 0.000208694, 0, 0.873016, 0.376615, 0.000198045, 0, 0.904762, 0.359655, 0.000187375, 0, 0.936508, 0.343452, 0.000177371, 0, 0.968254, 0.32765, 0.000167525, 0, 1, 1, 1.69351e-05, 0, 0, 1, 1.69356e-05, 0, 0, 1, 1.69427e-05, 0, 0, 0.999999, 1.69736e-05, 0, 0, 0.999998, 1.70575e-05, 0, 0, 0.999995, 1.72372e-05, 0, 0, 0.99999, 1.75739e-05, 0, 0, 0.999979, 1.81568e-05, 0, 0, 0.999966, 1.91206e-05, 0, 0, 0.999944, 2.0677e-05, 0, 0, 0.999912, 2.31644e-05, 0, 0, 0.999869, 2.71268e-05, 0, 0, 0.999811, 3.34272e-05, 0, 0, 0.99973, 4.33979e-05, 0, 0, 0.999617, 5.90083e-05, 0, 6.80315e-05, 0.999445, 8.29497e-05, 0, 0.000612796, 0.999138, 0.000118019, 0, 0.00187408, 0.998095, 0.000156712, 0, 0.00395791, 0.993919, 0.000125054, 0, 0.00692144, 0.991333, 0.000126091, 0, 0.0107962, 0.989226, 0.000144912, 0, 0.0155986, 0.986954, 0.000175737, 0, 0.0213364, 0.983982, 0.000213883, 0, 0.0280114, 0.979128, 0.000234526, 0, 0.0356226, 0.973327, 0.000243725, 0, 0.0441668, 0.967416, 0.0002773, 0, 0.0536399, 0.959729, 0.000308799, 0, 0.0640376, 0.949758, 0.000322447, 0, 0.0753554, 0.939173, 0.000350021, 0, 0.0875893, 0.9296, 0.000370089, 0, 0.100736, 0.921181, 0.000391365, 0, 0.114793, 0.91164, 0.000413636, 0, 0.129759, 0.900435, 0.000427068, 0, 0.145632, 0.888183, 0.000441046, 0, 0.162412, 0.874772, 0.000454968, 0, 0.180101, 0.859566, 0.000461882, 0, 0.1987, 0.843579, 0.000471556, 0, 0.218213, 0.826453, 0.000474335, 0, 0.238641, 0.809164, 0.000477078, 0, 0.259989, 0.792179, 0.00047755, 0, 0.282262, 0.773866, 0.000472573, 0, 0.305464, 0.754944, 0.000469765, 0, 0.329599, 0.735133, 0.000462371, 0, 0.35467, 0.714858, 0.000453674, 0, 0.380678, 0.694829, 0.000443888, 0, 0.407622, 0.674453, 0.000432052, 0, 0.435493, 0.653685, 0.000420315, 0, 0.464275, 0.632666, 0.000406829, 0, 0.493938, 0.611676, 0.000392234, 0, 0.524422, 0.591193, 0.000379208, 0, 0.555624, 0.570145, 0.00036319, 0, 0.587302, 0.549566, 0.000349111, 0, 0.619048, 0.529278, 0.000334166, 0, 0.650794, 0.509026, 0.000318456, 0, 0.68254, 0.489186, 0.00030449, 0, 0.714286, 0.469662, 0.000289051, 0, 0.746032, 0.450691, 0.000275494, 0, 0.777778, 0.431841, 0.000261437, 0, 0.809524, 0.413752, 0.000247846, 0, 0.84127, 0.395951, 0.000235085, 0, 0.873016, 0.378633, 0.000222245, 0, 0.904762, 0.36194, 0.000210533, 0, 0.936508, 0.345599, 0.000198494, 0, 0.968254, 0.329999, 0.000188133, 0, 1, 1, 2.69663e-05, 0, 0, 1, 2.6967e-05, 0, 0, 1, 2.69772e-05, 0, 0, 0.999999, 2.70214e-05, 0, 0, 0.999998, 2.71415e-05, 0, 0, 0.999994, 2.7398e-05, 0, 0, 0.999988, 2.78771e-05, 0, 0, 0.999977, 2.87019e-05, 0, 0, 0.999961, 3.00544e-05, 0, 0, 0.999937, 3.22138e-05, 0, 0, 0.999904, 3.56163e-05, 0, 0, 0.999854, 4.09465e-05, 0, 0, 0.99979, 4.92651e-05, 0, 0, 0.999699, 6.21722e-05, 0, 8.8288e-07, 0.999572, 8.19715e-05, 0, 0.000223369, 0.999381, 0.000111689, 0, 0.00105414, 0.999016, 0.000153862, 0, 0.0026493, 0.997437, 0.000187667, 0, 0.00508608, 0.993545, 0.000155672, 0, 0.00840554, 0.991135, 0.000161455, 0, 0.012629, 0.989157, 0.000188241, 0, 0.0177661, 0.986874, 0.000226229, 0, 0.0238198, 0.983714, 0.000268668, 0, 0.0307887, 0.978301, 0.000277109, 0, 0.0386688, 0.973227, 0.000303446, 0, 0.0474554, 0.967317, 0.000341851, 0, 0.0571428, 0.959477, 0.000370885, 0, 0.0677256, 0.950012, 0.000392753, 0, 0.0791988, 0.939484, 0.00042781, 0, 0.0915576, 0.928135, 0.000443866, 0, 0.104798, 0.919819, 0.000472959, 0, 0.118918, 0.910049, 0.000491551, 0, 0.133915, 0.899181, 0.000512616, 0, 0.149788, 0.886881, 0.000523563, 0, 0.166537, 0.87359, 0.000540183, 0, 0.184164, 0.858613, 0.000547386, 0, 0.202669, 0.842809, 0.000554809, 0, 0.222056, 0.825727, 0.000558316, 0, 0.242329, 0.808086, 0.000557824, 0, 0.263492, 0.790728, 0.000556346, 0, 0.285551, 0.772987, 0.000552672, 0, 0.30851, 0.7541, 0.000543738, 0, 0.332376, 0.734669, 0.000536107, 0, 0.357153, 0.714411, 0.000523342, 0, 0.382845, 0.694196, 0.000512238, 0, 0.409454, 0.674252, 0.000497465, 0, 0.436977, 0.65357, 0.000481096, 0, 0.465404, 0.632999, 0.000467054, 0, 0.494713, 0.611994, 0.000448771, 0, 0.524864, 0.591604, 0.000431889, 0, 0.555779, 0.571134, 0.000415238, 0, 0.587302, 0.550528, 0.000396369, 0, 0.619048, 0.530292, 0.000379477, 0, 0.650794, 0.510364, 0.000361488, 0, 0.68254, 0.490749, 0.000343787, 0, 0.714286, 0.471266, 0.000327822, 0, 0.746032, 0.452462, 0.000310626, 0, 0.777778, 0.433907, 0.000295352, 0, 0.809524, 0.415659, 0.000279179, 0, 0.84127, 0.398138, 0.000264685, 0, 0.873016, 0.380833, 0.000249905, 0, 0.904762, 0.364247, 0.000236282, 0, 0.936508, 0.348041, 0.000222905, 0, 0.968254, 0.332389, 0.000210522, 0, 1, 1, 4.20604e-05, 0, 0, 1, 4.20614e-05, 0, 0, 1, 4.20757e-05, 0, 0, 0.999999, 4.2138e-05, 0, 0, 0.999997, 4.23067e-05, 0, 0, 0.999993, 4.26668e-05, 0, 0, 0.999986, 4.33372e-05, 0, 0, 0.999974, 4.44857e-05, 0, 0, 0.999956, 4.63554e-05, 0, 0, 0.99993, 4.93105e-05, 0, 0, 0.999892, 5.39077e-05, 0, 0, 0.999838, 6.10005e-05, 0, 0, 0.999767, 7.18822e-05, 0, 0, 0.999666, 8.84581e-05, 0, 3.65471e-05, 0.999525, 0.000113398, 0, 0.000485623, 0.999311, 0.000150043, 0, 0.00162096, 0.998865, 0.000200063, 0, 0.00355319, 0.996278, 0.000211014, 0, 0.00633818, 0.992956, 0.000189672, 0, 0.0100043, 0.991017, 0.000210262, 0, 0.0145648, 0.989055, 0.000244292, 0, 0.0200237, 0.986741, 0.000290481, 0, 0.0263798, 0.983288, 0.000334303, 0, 0.033629, 0.977784, 0.000340307, 0, 0.0417652, 0.973037, 0.000377864, 0, 0.0507821, 0.967181, 0.0004239, 0, 0.060673, 0.958971, 0.000443854, 0, 0.0714314, 0.950093, 0.000483039, 0, 0.0830518, 0.939552, 0.000517934, 0, 0.0955288, 0.927678, 0.000539449, 0, 0.108859, 0.918278, 0.000568604, 0, 0.123038, 0.908449, 0.000588505, 0, 0.138065, 0.897713, 0.000612473, 0, 0.153938, 0.885533, 0.000625575, 0, 0.170657, 0.872131, 0.00063854, 0, 0.188224, 0.857517, 0.000647034, 0, 0.20664, 0.841796, 0.00065209, 0, 0.225909, 0.824726, 0.0006544, 0, 0.246035, 0.807297, 0.000655744, 0, 0.267022, 0.789058, 0.000646716, 0, 0.288878, 0.77189, 0.000643898, 0, 0.311607, 0.753082, 0.000629973, 0, 0.335216, 0.7341, 0.000621564, 0, 0.359713, 0.714094, 0.000605171, 0, 0.385103, 0.693839, 0.000588752, 0, 0.41139, 0.673891, 0.000573294, 0, 0.438576, 0.653565, 0.000552682, 0, 0.466656, 0.633326, 0.000533446, 0, 0.495617, 0.612582, 0.000514635, 0, 0.525431, 0.59205, 0.00049303, 0, 0.556041, 0.571918, 0.000471842, 0, 0.587338, 0.551572, 0.000451713, 0, 0.619048, 0.531553, 0.000430049, 0, 0.650794, 0.51175, 0.000410445, 0, 0.68254, 0.49238, 0.000390098, 0, 0.714286, 0.473143, 0.000370033, 0, 0.746032, 0.45423, 0.000351205, 0, 0.777778, 0.435963, 0.000332049, 0, 0.809524, 0.41787, 0.000315021, 0, 0.84127, 0.400387, 0.000297315, 0, 0.873016, 0.383332, 0.000281385, 0, 0.904762, 0.366665, 0.000265397, 0, 0.936508, 0.350633, 0.000250601, 0, 0.968254, 0.334964, 0.00023589, 0, 1, 1, 6.43736e-05, 0, 0, 1, 6.4375e-05, 0, 0, 1, 6.43947e-05, 0, 0, 0.999999, 6.4481e-05, 0, 0, 0.999997, 6.47143e-05, 0, 0, 0.999994, 6.52119e-05, 0, 0, 0.999985, 6.61359e-05, 0, 0, 0.999972, 6.77116e-05, 0, 0, 0.999952, 7.02599e-05, 0, 0, 0.999922, 7.42517e-05, 0, 0, 0.99988, 8.03906e-05, 0, 0, 0.99982, 8.97315e-05, 0, 0, 0.999741, 0.000103838, 0, 0, 0.999629, 0.00012496, 0, 0.000149024, 0.999474, 0.000156161, 0, 0.000861027, 0.999229, 0.000201034, 0, 0.00231198, 0.998662, 0.000259069, 0, 0.00458147, 0.995299, 0.000245439, 0, 0.00770895, 0.992732, 0.00024498, 0, 0.0117126, 0.990847, 0.000273211, 0, 0.0165989, 0.988911, 0.000316492, 0, 0.0223674, 0.98654, 0.00037161, 0, 0.0290135, 0.982636, 0.000410352, 0, 0.0365309, 0.977346, 0.000421756, 0, 0.0449117, 0.972909, 0.000475578, 0, 0.0541481, 0.966821, 0.000522482, 0, 0.0642326, 0.958686, 0.000545008, 0, 0.075158, 0.949754, 0.000589286, 0, 0.0869181, 0.939184, 0.000619995, 0, 0.0995074, 0.927505, 0.000654266, 0, 0.112922, 0.916606, 0.000682362, 0, 0.127157, 0.906707, 0.000704286, 0, 0.142212, 0.895937, 0.000725909, 0, 0.158085, 0.883913, 0.000743939, 0, 0.174776, 0.870642, 0.000755157, 0, 0.192287, 0.856241, 0.000764387, 0, 0.210619, 0.84069, 0.000771032, 0, 0.229775, 0.823728, 0.000765906, 0, 0.249761, 0.806481, 0.000767604, 0, 0.270582, 0.787924, 0.000754385, 0, 0.292243, 0.770588, 0.000749668, 0, 0.314753, 0.751991, 0.000731613, 0, 0.338118, 0.733407, 0.000717655, 0, 0.362347, 0.713688, 0.000700604, 0, 0.387447, 0.693595, 0.000678765, 0, 0.413424, 0.673426, 0.000657042, 0, 0.440284, 0.65359, 0.000635892, 0, 0.468027, 0.633576, 0.000611569, 0, 0.496645, 0.613144, 0.000586011, 0, 0.526122, 0.592711, 0.000563111, 0, 0.556417, 0.572722, 0.000537699, 0, 0.587451, 0.552762, 0.000512556, 0, 0.619048, 0.532985, 0.000489757, 0, 0.650794, 0.513219, 0.000464139, 0, 0.68254, 0.493992, 0.000442193, 0, 0.714286, 0.47509, 0.000418629, 0, 0.746032, 0.456287, 0.000397045, 0, 0.777778, 0.438152, 0.000375504, 0, 0.809524, 0.420294, 0.00035492, 0, 0.84127, 0.402749, 0.000335327, 0, 0.873016, 0.385879, 0.000316422, 0, 0.904762, 0.369352, 0.000298333, 0, 0.936508, 0.353301, 0.000281417, 0, 0.968254, 0.337781, 0.000265203, 0, 1, 1, 9.68267e-05, 0, 0, 1, 9.68284e-05, 0, 0, 1, 9.68556e-05, 0, 0, 0.999999, 9.69733e-05, 0, 0, 0.999997, 9.72913e-05, 0, 0, 0.999993, 9.79688e-05, 0, 0, 0.999984, 9.92239e-05, 0, 0, 0.999969, 0.000101356, 0, 0, 0.999946, 0.000104784, 0, 0, 0.999913, 0.000110111, 0, 0, 0.999868, 0.000118217, 0, 0, 0.999801, 0.000130396, 0, 0, 0.999712, 0.000148523, 0, 1.24907e-05, 0.999589, 0.000175233, 0, 0.000355405, 0.999416, 0.000213999, 0, 0.0013528, 0.999136, 0.000268529, 0, 0.00312557, 0.998367, 0.000333088, 0, 0.00573045, 0.994701, 0.000304757, 0, 0.00919397, 0.992497, 0.000318031, 0, 0.0135261, 0.990608, 0.000353863, 0, 0.0187278, 0.988715, 0.000409044, 0, 0.0247947, 0.986241, 0.000472967, 0, 0.0317196, 0.981696, 0.000495104, 0, 0.039494, 0.977097, 0.000532873, 0, 0.0481087, 0.972583, 0.000594447, 0, 0.0575549, 0.966142, 0.000636867, 0, 0.0678242, 0.95823, 0.000669899, 0, 0.0789089, 0.949677, 0.000719499, 0, 0.0908023, 0.939226, 0.000750584, 0, 0.103499, 0.927501, 0.000793183, 0, 0.116993, 0.915199, 0.00081995, 0, 0.131282, 0.90498, 0.000847654, 0, 0.146364, 0.894243, 0.000868929, 0, 0.162237, 0.882154, 0.000884278, 0, 0.178902, 0.869161, 0.000898108, 0, 0.196358, 0.854751, 0.000901254, 0, 0.21461, 0.839368, 0.00090679, 0, 0.23366, 0.822874, 0.000901541, 0, 0.253512, 0.805514, 0.000897297, 0, 0.274174, 0.78716, 0.000881856, 0, 0.29565, 0.769061, 0.000870032, 0, 0.31795, 0.751, 0.000851719, 0, 0.341081, 0.732614, 0.000830671, 0, 0.365053, 0.713171, 0.000806569, 0, 0.389874, 0.693472, 0.00078338, 0, 0.415553, 0.673528, 0.000756404, 0, 0.442098, 0.653397, 0.000726872, 0, 0.469512, 0.633781, 0.000700494, 0, 0.497794, 0.613877, 0.00067105, 0, 0.526935, 0.593506, 0.000640361, 0, 0.556908, 0.573667, 0.000613502, 0, 0.587657, 0.553932, 0.000583177, 0, 0.61906, 0.534345, 0.000554375, 0, 0.650794, 0.515042, 0.000527811, 0, 0.68254, 0.495674, 0.000499367, 0, 0.714286, 0.477132, 0.00047429, 0, 0.746032, 0.458609, 0.000447726, 0, 0.777778, 0.440354, 0.000424205, 0, 0.809524, 0.422765, 0.000399549, 0, 0.84127, 0.405472, 0.000378315, 0, 0.873016, 0.388482, 0.000355327, 0, 0.904762, 0.372191, 0.000336122, 0, 0.936508, 0.356099, 0.000315247, 0, 0.968254, 0.340737, 0.00029794, 0, 1, 1, 0.000143327, 0, 0, 1, 0.00014333, 0, 0, 1, 0.000143366, 0, 0, 0.999999, 0.000143524, 0, 0, 0.999996, 0.000143952, 0, 0, 0.999991, 0.000144862, 0, 0, 0.999981, 0.000146544, 0, 0, 0.999966, 0.000149391, 0, 0, 0.999941, 0.000153946, 0, 0, 0.999905, 0.000160971, 0, 0, 0.999852, 0.000171562, 0, 0, 0.99978, 0.00018729, 0, 0, 0.999681, 0.000210386, 0, 8.26239e-05, 0.999546, 0.000243906, 0, 0.000664807, 0.999352, 0.000291739, 0, 0.00196192, 0.999027, 0.000357419, 0, 0.00405941, 0.997886, 0.000422349, 0, 0.00699664, 0.99419, 0.000385008, 0, 0.0107896, 0.99214, 0.000409775, 0, 0.0154415, 0.990274, 0.000456418, 0, 0.0209488, 0.988455, 0.000527008, 0, 0.0273037, 0.985804, 0.000597685, 0, 0.0344969, 0.98103, 0.000613124, 0, 0.0425183, 0.976674, 0.000668321, 0, 0.0513575, 0.972021, 0.000736985, 0, 0.0610046, 0.965274, 0.000773789, 0, 0.0714508, 0.958046, 0.000830852, 0, 0.0826877, 0.949333, 0.000875766, 0, 0.0947085, 0.939135, 0.000917088, 0, 0.107507, 0.927119, 0.000952244, 0, 0.121078, 0.91469, 0.000990626, 0, 0.135419, 0.903006, 0.00101304, 0, 0.150526, 0.892368, 0.00103834, 0, 0.166399, 0.880231, 0.00105002, 0, 0.183038, 0.867432, 0.00106331, 0, 0.200443, 0.853208, 0.00106783, 0, 0.218618, 0.837956, 0.00106458, 0, 0.237566, 0.821772, 0.00105945, 0, 0.257291, 0.804328, 0.00104685, 0, 0.2778, 0.786465, 0.00103178, 0, 0.2991, 0.768004, 0.00101077, 0, 0.321199, 0.74972, 0.000985504, 0, 0.344106, 0.731682, 0.000962893, 0, 0.36783, 0.712813, 0.000932146, 0, 0.392383, 0.693139, 0.00089871, 0, 0.417774, 0.673566, 0.000869678, 0, 0.444013, 0.653483, 0.000835525, 0, 0.471107, 0.633891, 0.000799853, 0, 0.49906, 0.614433, 0.000766838, 0, 0.527869, 0.594586, 0.000732227, 0, 0.557517, 0.574769, 0.000696442, 0, 0.587966, 0.555149, 0.000663935, 0, 0.61913, 0.535898, 0.000629826, 0, 0.650794, 0.516753, 0.000596486, 0, 0.68254, 0.497816, 0.000567078, 0, 0.714286, 0.479034, 0.000534399, 0, 0.746032, 0.460975, 0.000507013, 0, 0.777778, 0.442935, 0.000477421, 0, 0.809524, 0.425263, 0.000451101, 0, 0.84127, 0.408248, 0.000424964, 0, 0.873016, 0.391339, 0.00039993, 0, 0.904762, 0.37513, 0.000377619, 0, 0.936508, 0.359172, 0.000354418, 0, 0.968254, 0.343876, 0.000334823, 0, 1, 1, 0.000209042, 0, 0, 1, 0.000209045, 0, 0, 1, 0.000209093, 0, 0, 0.999999, 0.000209304, 0, 0, 0.999996, 0.000209871, 0, 0, 0.999991, 0.000211078, 0, 0, 0.999979, 0.000213304, 0, 0, 0.999963, 0.000217061, 0, 0, 0.999933, 0.000223042, 0, 0, 0.999894, 0.000232206, 0, 0, 0.999837, 0.000245901, 0, 0, 0.999756, 0.000266023, 0, 1.02927e-06, 0.999648, 0.000295204, 0, 0.000233468, 0.999499, 0.000336958, 0, 0.00108237, 0.999283, 0.000395563, 0, 0.00268832, 0.998896, 0.000473785, 0, 0.00511138, 0.997006, 0.000520008, 0, 0.00837705, 0.993819, 0.000497261, 0, 0.0124928, 0.991632, 0.000523722, 0, 0.0174561, 0.989875, 0.000587258, 0, 0.0232596, 0.988109, 0.000676329, 0, 0.0298932, 0.985155, 0.000747701, 0, 0.0373453, 0.980479, 0.000768803, 0, 0.0456045, 0.976271, 0.000841054, 0, 0.0546593, 0.971347, 0.000911469, 0, 0.0644994, 0.964528, 0.000953057, 0, 0.0751152, 0.957632, 0.00102221, 0, 0.0864981, 0.948681, 0.00106122, 0, 0.0986407, 0.938716, 0.00111857, 0, 0.111537, 0.926629, 0.00114762, 0, 0.125182, 0.914025, 0.00118995, 0, 0.139571, 0.901026, 0.00121228, 0, 0.154703, 0.890358, 0.00123946, 0, 0.170576, 0.878283, 0.0012527, 0, 0.18719, 0.865459, 0.00125536, 0, 0.204547, 0.851407, 0.00126134, 0, 0.222648, 0.836276, 0.00124759, 0, 0.241498, 0.820436, 0.00124443, 0, 0.261101, 0.803253, 0.00122071, 0, 0.281465, 0.785562, 0.00120107, 0, 0.302595, 0.76718, 0.00117762, 0, 0.324501, 0.748551, 0.00114289, 0, 0.347192, 0.730564, 0.00110872, 0, 0.370679, 0.712253, 0.00107636, 0, 0.394973, 0.692867, 0.00103646, 0, 0.420085, 0.673695, 0.000996793, 0, 0.446027, 0.653912, 0.00095675, 0, 0.47281, 0.634129, 0.000916739, 0, 0.500441, 0.615004, 0.000874401, 0, 0.528921, 0.595587, 0.000833411, 0, 0.558244, 0.575965, 0.000794556, 0, 0.588384, 0.5566, 0.00075196, 0, 0.619281, 0.537428, 0.000716381, 0, 0.650795, 0.518623, 0.000676558, 0, 0.68254, 0.499964, 0.00064074, 0, 0.714286, 0.481356, 0.000605984, 0, 0.746032, 0.463279, 0.000570256, 0, 0.777778, 0.445673, 0.000540138, 0, 0.809524, 0.428032, 0.000507299, 0, 0.84127, 0.411112, 0.000479553, 0, 0.873016, 0.394444, 0.000450737, 0, 0.904762, 0.378247, 0.000424269, 0, 0.936508, 0.362415, 0.000399111, 0, 0.968254, 0.347103, 0.000375274, 0, 1, 1, 0.000300729, 0, 0, 1, 0.000300733, 0, 0, 1, 0.000300797, 0, 0, 0.999998, 0.000301072, 0, 0, 0.999996, 0.000301817, 0, 0, 0.999989, 0.000303398, 0, 0, 0.999977, 0.000306309, 0, 0, 0.999958, 0.000311209, 0, 0, 0.999927, 0.000318975, 0, 0, 0.999884, 0.000330804, 0, 0, 0.99982, 0.00034834, 0, 0, 0.999733, 0.000373854, 0, 3.26995e-05, 0.999613, 0.000410424, 0, 0.000477174, 0.999447, 0.000462047, 0, 0.00161099, 0.999204, 0.000533322, 0, 0.00353153, 0.998725, 0.000624964, 0, 0.00627965, 0.995871, 0.000631786, 0, 0.0098693, 0.993194, 0.000632017, 0, 0.0143011, 0.991541, 0.00068923, 0, 0.019568, 0.989773, 0.000766892, 0, 0.0256593, 0.987647, 0.000863668, 0, 0.0325625, 0.984193, 0.000922089, 0, 0.0402647, 0.980016, 0.000970749, 0, 0.0487532, 0.975859, 0.00106027, 0, 0.058016, 0.970514, 0.00112239, 0, 0.0680419, 0.963625, 0.00117212, 0, 0.0788208, 0.956959, 0.00125211, 0, 0.0903439, 0.947956, 0.00129411, 0, 0.102604, 0.93809, 0.00135879, 0, 0.115594, 0.92659, 0.00139309, 0, 0.129309, 0.913829, 0.00143253, 0, 0.143745, 0.90005, 0.00145809, 0, 0.158901, 0.888129, 0.0014748, 0, 0.174774, 0.87607, 0.00148756, 0, 0.191365, 0.863461, 0.00148714, 0, 0.208674, 0.849594, 0.00148892, 0, 0.226705, 0.834531, 0.00146496, 0, 0.245461, 0.81903, 0.0014579, 0, 0.264947, 0.802122, 0.00143039, 0, 0.28517, 0.78445, 0.00139717, 0, 0.306137, 0.766434, 0.00136312, 0, 0.327857, 0.747816, 0.00132597, 0, 0.350341, 0.729519, 0.00128323, 0, 0.373598, 0.711454, 0.00123803, 0, 0.397642, 0.692699, 0.00119097, 0, 0.422485, 0.673723, 0.00114565, 0, 0.448139, 0.654386, 0.00109552, 0, 0.474619, 0.634673, 0.00104553, 0, 0.501933, 0.615554, 0.00099985, 0, 0.530089, 0.596462, 0.000948207, 0, 0.559087, 0.577385, 0.000902299, 0, 0.588913, 0.558257, 0.000856448, 0, 0.619525, 0.5392, 0.000810395, 0, 0.650826, 0.520543, 0.000768558, 0, 0.68254, 0.502206, 0.0007239, 0, 0.714286, 0.48402, 0.000685794, 0, 0.746032, 0.465779, 0.00064471, 0, 0.777778, 0.448455, 0.000609583, 0, 0.809524, 0.431091, 0.00057227, 0, 0.84127, 0.414147, 0.00054042, 0, 0.873016, 0.39765, 0.000506545, 0, 0.904762, 0.381576, 0.000477635, 0, 0.936508, 0.365881, 0.000448446, 0, 0.968254, 0.350582, 0.000421424, 0, 1, 1, 0.000427144, 0, 0, 1, 0.000427151, 0, 0, 1, 0.000427232, 0, 0, 0.999998, 0.00042759, 0, 0, 0.999995, 0.000428555, 0, 0, 0.999988, 0.000430603, 0, 0, 0.999976, 0.000434368, 0, 0, 0.999952, 0.000440688, 0, 0, 0.999919, 0.000450667, 0, 0, 0.999871, 0.00046578, 0, 0, 0.999801, 0.000488024, 0, 0, 0.999704, 0.000520092, 0, 0.000129791, 0.999572, 0.000565553, 0, 0.000821056, 0.999389, 0.000628906, 0, 0.00225241, 0.999114, 0.000714911, 0, 0.00449109, 0.998488, 0.000819218, 0, 0.00756249, 0.995234, 0.00080415, 0, 0.0114716, 0.993021, 0.000830181, 0, 0.0162131, 0.991407, 0.000902645, 0, 0.021776, 0.989625, 0.000996934, 0, 0.0281471, 0.987064, 0.00109707, 0, 0.0353118, 0.983265, 0.00114353, 0, 0.0432562, 0.979535, 0.0012272, 0, 0.0519665, 0.975224, 0.00132642, 0, 0.0614298, 0.969574, 0.00138092, 0, 0.0716348, 0.963021, 0.00145896, 0, 0.0825709, 0.956046, 0.00152834, 0, 0.094229, 0.947136, 0.00158217, 0, 0.106602, 0.937313, 0.0016347, 0, 0.119682, 0.926073, 0.00168383, 0, 0.133465, 0.913121, 0.00171627, 0, 0.147947, 0.899165, 0.00174229, 0, 0.163125, 0.885891, 0.00176137, 0, 0.178998, 0.873783, 0.00176406, 0, 0.195566, 0.861331, 0.00176156, 0, 0.21283, 0.847569, 0.00175346, 0, 0.230793, 0.832785, 0.00172753, 0, 0.249459, 0.817442, 0.00170204, 0, 0.268832, 0.800613, 0.00166576, 0, 0.28892, 0.783597, 0.00162909, 0, 0.30973, 0.76571, 0.0015826, 0, 0.331271, 0.747021, 0.00153106, 0, 0.353554, 0.728593, 0.00148036, 0, 0.37659, 0.710661, 0.00142808, 0, 0.400391, 0.692426, 0.00136906, 0, 0.424973, 0.673623, 0.00131066, 0, 0.450347, 0.65494, 0.00125569, 0, 0.476531, 0.635448, 0.00119517, 0, 0.503535, 0.616221, 0.00113828, 0, 0.531372, 0.597531, 0.0010816, 0, 0.560047, 0.578795, 0.00102673, 0, 0.589554, 0.559892, 0.000970985, 0, 0.619869, 0.541307, 0.000919773, 0, 0.650923, 0.522608, 0.000868479, 0, 0.68254, 0.504484, 0.00082137, 0, 0.714286, 0.486603, 0.000772916, 0, 0.746032, 0.468802, 0.000730353, 0, 0.777778, 0.451172, 0.000684955, 0, 0.809524, 0.434348, 0.000647565, 0, 0.84127, 0.417445, 0.000605863, 0, 0.873016, 0.401077, 0.000571885, 0, 0.904762, 0.385039, 0.000536034, 0, 0.936508, 0.369483, 0.000504227, 0, 0.968254, 0.354272, 0.000473165, 0, 1, 1, 0.000599525, 0, 0, 1, 0.000599533, 0, 0, 1, 0.000599639, 0, 0, 0.999998, 0.000600097, 0, 0, 0.999994, 0.000601336, 0, 0, 0.999987, 0.000603958, 0, 0, 0.999972, 0.000608775, 0, 0, 0.999949, 0.000616842, 0, 0, 0.999912, 0.000629534, 0, 0, 0.999857, 0.000648658, 0, 0, 0.999781, 0.000676615, 0, 5.38873e-06, 0.999674, 0.000716574, 0, 0.000308602, 0.999528, 0.000772641, 0, 0.00127003, 0.999326, 0.000849806, 0, 0.00300783, 0.999009, 0.000952682, 0, 0.00556637, 0.998112, 0.00106394, 0, 0.00895889, 0.994496, 0.00102228, 0, 0.0131827, 0.992806, 0.00108586, 0, 0.0182277, 0.991211, 0.0011759, 0, 0.0240795, 0.989415, 0.00128955, 0, 0.030723, 0.986499, 0.00139038, 0, 0.0381418, 0.982679, 0.00144539, 0, 0.046321, 0.978839, 0.00153954, 0, 0.0552459, 0.974295, 0.00164417, 0, 0.0649034, 0.968784, 0.00171517, 0, 0.0752814, 0.962324, 0.00180282, 0, 0.0863693, 0.954956, 0.00186387, 0, 0.0981578, 0.94624, 0.00193817, 0, 0.110639, 0.936517, 0.00198156, 0, 0.123806, 0.925186, 0.00203042, 0, 0.137655, 0.91252, 0.0020664, 0, 0.15218, 0.898441, 0.00207822, 0, 0.16738, 0.884394, 0.0020992, 0, 0.183253, 0.871273, 0.00208748, 0, 0.199799, 0.859057, 0.00208686, 0, 0.21702, 0.845243, 0.00205519, 0, 0.234918, 0.830723, 0.00202868, 0, 0.253496, 0.815801, 0.00199501, 0, 0.272761, 0.79914, 0.00194193, 0, 0.292719, 0.782372, 0.00188824, 0, 0.313377, 0.76482, 0.00183695, 0, 0.334745, 0.746586, 0.00177418, 0, 0.356833, 0.7281, 0.00170628, 0, 0.379654, 0.709842, 0.00164063, 0, 0.403221, 0.692019, 0.00157355, 0, 0.427548, 0.67364, 0.00150262, 0, 0.452651, 0.655277, 0.00143473, 0, 0.478545, 0.636438, 0.00136371, 0, 0.505246, 0.617364, 0.00129911, 0, 0.532768, 0.598603, 0.00123014, 0, 0.561122, 0.580195, 0.00116587, 0, 0.590309, 0.561786, 0.00110398, 0, 0.620318, 0.543377, 0.00104148, 0, 0.651102, 0.525093, 0.000983984, 0, 0.682545, 0.506791, 0.00092667, 0, 0.714286, 0.489291, 0.000874326, 0, 0.746032, 0.471811, 0.000821734, 0, 0.777778, 0.454435, 0.000774698, 0, 0.809524, 0.437493, 0.000727302, 0, 0.84127, 0.420977, 0.000684039, 0, 0.873016, 0.404729, 0.00064373, 0, 0.904762, 0.388756, 0.00060285, 0, 0.936508, 0.373344, 0.00056765, 0, 0.968254, 0.358191, 0.000531929, 0, 1, 1, 0.000832169, 0, 0, 1, 0.000832178, 0, 0, 1, 0.00083231, 0, 0, 0.999998, 0.000832893, 0, 0, 0.999995, 0.000834465, 0, 0, 0.999985, 0.000837791, 0, 0, 0.999969, 0.000843893, 0, 0, 0.999944, 0.000854086, 0, 0, 0.999903, 0.000870071, 0, 0, 0.999843, 0.000894042, 0, 0, 0.999759, 0.000928865, 0, 5.31805e-05, 0.999643, 0.000978242, 0, 0.000579365, 0.99948, 0.00104684, 0, 0.00182774, 0.999255, 0.00114012, 0, 0.00387804, 0.998885, 0.00126188, 0, 0.00675709, 0.997405, 0.00135888, 0, 0.010468, 0.99424, 0.00133626, 0, 0.0150018, 0.992458, 0.00140905, 0, 0.0203443, 0.990929, 0.00152305, 0, 0.0264786, 0.989116, 0.00165882, 0, 0.0333875, 0.985624, 0.00174128, 0, 0.0410536, 0.982003, 0.00182108, 0, 0.0494609, 0.978336, 0.00194498, 0, 0.0585941, 0.973184, 0.00202708, 0, 0.0684396, 0.9678, 0.00212166, 0, 0.0789851, 0.961348, 0.00221366, 0, 0.0902199, 0.953841, 0.00228219, 0, 0.102134, 0.94534, 0.00235662, 0, 0.114721, 0.935552, 0.00240572, 0, 0.127972, 0.924064, 0.00244405, 0, 0.141884, 0.911827, 0.00247557, 0, 0.156451, 0.897731, 0.00248374, 0, 0.171672, 0.883409, 0.00249863, 0, 0.187545, 0.868625, 0.00246688, 0, 0.20407, 0.856529, 0.00246523, 0, 0.221249, 0.842999, 0.00242368, 0, 0.239083, 0.828505, 0.00237354, 0, 0.257578, 0.813825, 0.00232588, 0, 0.276738, 0.797813, 0.00226731, 0, 0.296569, 0.781097, 0.00219704, 0, 0.31708, 0.764038, 0.00212394, 0, 0.338281, 0.746067, 0.00204786, 0, 0.360181, 0.727687, 0.00196728, 0, 0.382794, 0.709571, 0.00188779, 0, 0.406133, 0.691503, 0.00180532, 0, 0.430213, 0.673673, 0.00171849, 0, 0.45505, 0.655732, 0.00164147, 0, 0.480662, 0.637399, 0.00155858, 0, 0.507065, 0.618616, 0.00147641, 0, 0.534278, 0.60005, 0.00140125, 0, 0.562313, 0.581713, 0.00132441, 0, 0.59118, 0.563546, 0.00125014, 0, 0.620875, 0.545605, 0.00118249, 0, 0.651373, 0.527559, 0.0011116, 0, 0.682593, 0.509764, 0.00104979, 0, 0.714286, 0.49193, 0.000985977, 0, 0.746032, 0.475011, 0.000928592, 0, 0.777778, 0.457878, 0.000873466, 0, 0.809524, 0.440979, 0.000819585, 0, 0.84127, 0.424613, 0.000772365, 0, 0.873016, 0.408549, 0.000722195, 0, 0.904762, 0.392771, 0.000680014, 0, 0.936508, 0.377317, 0.000636797, 0, 0.968254, 0.362352, 0.000598318, 0, 1, 1, 0.00114313, 0, 0, 1, 0.00114314, 0, 0, 0.999999, 0.00114331, 0, 0, 0.999998, 0.00114404, 0, 0, 0.999994, 0.00114601, 0, 0, 0.999984, 0.00115019, 0, 0, 0.999967, 0.00115784, 0, 0, 0.999937, 0.0011706, 0, 0, 0.999894, 0.00119054, 0, 0, 0.999828, 0.00122031, 0, 0, 0.999735, 0.00126331, 0, 0.000169263, 0.999606, 0.00132382, 0, 0.000949167, 0.999426, 0.0014071, 0, 0.00249668, 0.999173, 0.00151895, 0, 0.00486392, 0.99873, 0.00166102, 0, 0.00806323, 0.996243, 0.0017023, 0, 0.0120895, 0.993779, 0.00172782, 0, 0.0169288, 0.9919, 0.0018108, 0, 0.0225633, 0.990524, 0.00196028, 0, 0.028974, 0.98868, 0.00212014, 0, 0.036142, 0.984663, 0.00217598, 0, 0.044049, 0.981457, 0.00230563, 0, 0.0526781, 0.977608, 0.00243966, 0, 0.0620137, 0.972215, 0.00251336, 0, 0.0720418, 0.966798, 0.0026285, 0, 0.0827499, 0.960241, 0.00271409, 0, 0.0941271, 0.952489, 0.00278381, 0, 0.106164, 0.944127, 0.00285399, 0, 0.118852, 0.934282, 0.00290994, 0, 0.132185, 0.923271, 0.00294558, 0, 0.146157, 0.910803, 0.00296269, 0, 0.160766, 0.896705, 0.00296803, 0, 0.176007, 0.88238, 0.00296637, 0, 0.19188, 0.867116, 0.00293163, 0, 0.208385, 0.853636, 0.00289418, 0, 0.225523, 0.840469, 0.00284663, 0, 0.243296, 0.82639, 0.00278594, 0, 0.261709, 0.811759, 0.00271618, 0, 0.280767, 0.796113, 0.00263187, 0, 0.300476, 0.779518, 0.00254589, 0, 0.320845, 0.763142, 0.00246003, 0, 0.341883, 0.745464, 0.00236529, 0, 0.363601, 0.727491, 0.00226536, 0, 0.386011, 0.709414, 0.00216375, 0, 0.409128, 0.691396, 0.00207127, 0, 0.432967, 0.67368, 0.00197106, 0, 0.457545, 0.656049, 0.00187022, 0, 0.482881, 0.638188, 0.00177605, 0, 0.508992, 0.620177, 0.00168482, 0, 0.535899, 0.601506, 0.00158909, 0, 0.563619, 0.58362, 0.00150583, 0, 0.592165, 0.565496, 0.00141791, 0, 0.621544, 0.54789, 0.00133693, 0, 0.651743, 0.530323, 0.00126038, 0, 0.682709, 0.512795, 0.00118556, 0, 0.714286, 0.495199, 0.00111527, 0, 0.746032, 0.478101, 0.0010489, 0, 0.777778, 0.461511, 0.000984264, 0, 0.809524, 0.444879, 0.00092591, 0, 0.84127, 0.428424, 0.000866582, 0, 0.873016, 0.412495, 0.000814463, 0, 0.904762, 0.396975, 0.000764498, 0, 0.936508, 0.381614, 0.000715967, 0, 0.968254, 0.366732, 0.000672483, 0, 1, 1, 0.00155501, 0, 0, 1, 0.00155503, 0, 0, 1, 0.00155524, 0, 0, 0.999998, 0.00155615, 0, 0, 0.999994, 0.0015586, 0, 0, 0.999983, 0.00156379, 0, 0, 0.999963, 0.0015733, 0, 0, 0.999932, 0.00158911, 0, 0, 0.999882, 0.00161376, 0, 0, 0.99981, 0.00165041, 0, 1.00875e-05, 0.999708, 0.00170304, 0, 0.000367658, 0.999565, 0.00177658, 0, 0.0014234, 0.999368, 0.00187688, 0, 0.00327939, 0.999081, 0.00200989, 0, 0.00596629, 0.99852, 0.00217177, 0, 0.0094852, 0.99549, 0.0021745, 0, 0.013824, 0.993252, 0.00222357, 0, 0.0189642, 0.991727, 0.00235022, 0, 0.0248856, 0.989951, 0.00250561, 0, 0.0315669, 0.988029, 0.00268829, 0, 0.0389882, 0.984029, 0.0027496, 0, 0.0471302, 0.980683, 0.00289793, 0, 0.0559754, 0.976554, 0.00303315, 0, 0.0655081, 0.97139, 0.00313257, 0, 0.0757138, 0.965544, 0.00323656, 0, 0.08658, 0.95912, 0.00333432, 0, 0.0980954, 0.951183, 0.0034039, 0, 0.110251, 0.942974, 0.00347515, 0, 0.123038, 0.932642, 0.00350381, 0, 0.13645, 0.922158, 0.00354519, 0, 0.150482, 0.909404, 0.00353851, 0, 0.165129, 0.896071, 0.0035435, 0, 0.18039, 0.881206, 0.00349936, 0, 0.196263, 0.866077, 0.00347256, 0, 0.212748, 0.85093, 0.003415, 0, 0.229847, 0.837703, 0.00333367, 0, 0.247561, 0.823878, 0.003249, 0, 0.265895, 0.809449, 0.00316347, 0, 0.284854, 0.794379, 0.00306351, 0, 0.304445, 0.778138, 0.0029499, 0, 0.324675, 0.761997, 0.00284099, 0, 0.345555, 0.744938, 0.00272104, 0, 0.367095, 0.727212, 0.00260715, 0, 0.389309, 0.709549, 0.00248855, 0, 0.41221, 0.691704, 0.00236783, 0, 0.435814, 0.673689, 0.00225178, 0, 0.460138, 0.656453, 0.00213765, 0, 0.485203, 0.639128, 0.00202178, 0, 0.511028, 0.621512, 0.00191443, 0, 0.537634, 0.603598, 0.00180977, 0, 0.565041, 0.58559, 0.00170456, 0, 0.593268, 0.567852, 0.00160927, 0, 0.622327, 0.5503, 0.00151395, 0, 0.652217, 0.533033, 0.00142499, 0, 0.682907, 0.515942, 0.00133955, 0, 0.714296, 0.498814, 0.0012602, 0, 0.746032, 0.481595, 0.00118188, 0, 0.777778, 0.465117, 0.00111171, 0, 0.809524, 0.448865, 0.00104091, 0, 0.84127, 0.432711, 0.000976618, 0, 0.873016, 0.416822, 0.00091859, 0, 0.904762, 0.401272, 0.000857704, 0, 0.936508, 0.386226, 0.000807172, 0, 0.968254, 0.371321, 0.00075464, 0, 1, 1, 0.00209596, 0, 0, 1, 0.00209598, 0, 0, 1, 0.00209624, 0, 0, 0.999997, 0.00209736, 0, 0, 0.999991, 0.00210039, 0, 0, 0.999979, 0.00210678, 0, 0, 0.999959, 0.00211847, 0, 0, 0.999925, 0.0021379, 0, 0, 0.99987, 0.00216809, 0, 0, 0.999791, 0.00221281, 0, 6.81487e-05, 0.999677, 0.00227669, 0, 0.000658161, 0.999521, 0.00236533, 0, 0.00200635, 0.999301, 0.00248514, 0, 0.0041779, 0.998977, 0.00264185, 0, 0.00718648, 0.998191, 0.00281695, 0, 0.0110239, 0.994801, 0.00278518, 0, 0.015672, 0.993091, 0.00288774, 0, 0.0211091, 0.991571, 0.00303931, 0, 0.0273123, 0.9897, 0.00321643, 0, 0.034259, 0.987023, 0.00337332, 0, 0.0419282, 0.983289, 0.00346146, 0, 0.0502998, 0.979892, 0.00363704, 0, 0.0593562, 0.975111, 0.00373601, 0, 0.069081, 0.970351, 0.0038842, 0, 0.0794598, 0.964131, 0.00397053, 0, 0.0904798, 0.957747, 0.00408078, 0, 0.10213, 0.949536, 0.00413533, 0, 0.1144, 0.941372, 0.00420305, 0, 0.127284, 0.931049, 0.00422815, 0, 0.140772, 0.920647, 0.00425048, 0, 0.154862, 0.908033, 0.0042281, 0, 0.169548, 0.895028, 0.00422026, 0, 0.184828, 0.879968, 0.00415042, 0, 0.200701, 0.864875, 0.00408821, 0, 0.217167, 0.84918, 0.00400909, 0, 0.234227, 0.834934, 0.00391178, 0, 0.251884, 0.821397, 0.00380066, 0, 0.270141, 0.807135, 0.00367974, 0, 0.289004, 0.792363, 0.00355172, 0, 0.308479, 0.776661, 0.003411, 0, 0.328575, 0.760705, 0.00328123, 0, 0.349301, 0.744408, 0.00314003, 0, 0.370668, 0.726994, 0.0029906, 0, 0.392689, 0.709598, 0.00285034, 0, 0.415379, 0.692112, 0.00271179, 0, 0.438754, 0.674435, 0.00257185, 0, 0.46283, 0.65676, 0.00243425, 0, 0.48763, 0.639982, 0.00230351, 0, 0.513173, 0.622983, 0.0021777, 0, 0.539482, 0.605471, 0.00204991, 0, 0.566579, 0.58796, 0.00193759, 0, 0.594488, 0.570463, 0.00181976, 0, 0.623226, 0.553058, 0.00171497, 0, 0.6528, 0.535894, 0.00161109, 0, 0.683198, 0.519089, 0.00151394, 0, 0.714354, 0.502454, 0.00142122, 0, 0.746032, 0.485681, 0.00133488, 0, 0.777778, 0.468935, 0.00124975, 0, 0.809524, 0.452951, 0.00117309, 0, 0.84127, 0.437139, 0.00110155, 0, 0.873016, 0.421446, 0.00103124, 0, 0.904762, 0.405951, 0.000966387, 0, 0.936508, 0.391003, 0.000908119, 0, 0.968254, 0.376198, 0.000848057, 0, 1, 1, 0.00280076, 0, 0, 1, 0.00280078, 0, 0, 0.999999, 0.00280109, 0, 0, 0.999997, 0.00280246, 0, 0, 0.999992, 0.00280616, 0, 0, 0.999979, 0.00281396, 0, 0, 0.999956, 0.00282822, 0, 0, 0.999916, 0.00285186, 0, 0, 0.999857, 0.0028885, 0, 0, 0.999768, 0.00294259, 0, 0.000196026, 0.999645, 0.00301946, 0, 0.00104842, 0.99947, 0.00312541, 0, 0.00270199, 0.999229, 0.00326733, 0, 0.00519449, 0.998852, 0.00344992, 0, 0.00852602, 0.997558, 0.00361052, 0, 0.0126804, 0.994417, 0.0035898, 0, 0.017635, 0.992824, 0.00372393, 0, 0.023365, 0.991344, 0.00390695, 0, 0.0298456, 0.989337, 0.00410392, 0, 0.0370529, 0.985811, 0.00420987, 0, 0.0449651, 0.982772, 0.00437488, 0, 0.0535615, 0.979001, 0.00455069, 0, 0.0628243, 0.974102, 0.00464462, 0, 0.0727368, 0.969197, 0.00480577, 0, 0.0832844, 0.962759, 0.00487818, 0, 0.0944545, 0.956207, 0.00498176, 0, 0.106236, 0.947909, 0.00503392, 0, 0.118619, 0.939596, 0.00507474, 0, 0.131595, 0.929642, 0.00509798, 0, 0.145159, 0.918807, 0.00508476, 0, 0.159305, 0.906921, 0.00505634, 0, 0.174028, 0.893312, 0.00498845, 0, 0.189327, 0.878933, 0.0049133, 0, 0.2052, 0.863986, 0.0048259, 0, 0.221647, 0.847936, 0.00470848, 0, 0.23867, 0.832253, 0.00456889, 0, 0.25627, 0.818619, 0.00442726, 0, 0.274453, 0.804788, 0.00427677, 0, 0.293222, 0.790241, 0.00411906, 0, 0.312585, 0.775162, 0.00394833, 0, 0.33255, 0.759463, 0.00377366, 0, 0.353126, 0.743598, 0.00361026, 0, 0.374324, 0.72697, 0.00343627, 0, 0.396158, 0.709646, 0.00326422, 0, 0.418641, 0.69277, 0.00309717, 0, 0.44179, 0.675371, 0.0029356, 0, 0.465624, 0.657863, 0.00277712, 0, 0.490163, 0.640772, 0.00261738, 0, 0.515429, 0.624441, 0.0024737, 0, 0.541445, 0.607497, 0.00233125, 0, 0.568236, 0.590438, 0.00218994, 0, 0.595828, 0.573224, 0.0020664, 0, 0.624242, 0.556168, 0.00193526, 0, 0.653496, 0.539232, 0.00182463, 0, 0.683588, 0.522352, 0.00170735, 0, 0.714482, 0.506172, 0.00160555, 0, 0.746032, 0.489842, 0.00150451, 0, 0.777778, 0.473463, 0.00140938, 0, 0.809524, 0.457266, 0.00132568, 0, 0.84127, 0.441609, 0.0012376, 0, 0.873016, 0.426348, 0.00116265, 0, 0.904762, 0.411002, 0.00108935, 0, 0.936508, 0.396045, 0.00101946, 0, 0.968254, 0.381448, 0.000955665, 0, 1, 1, 0.0037121, 0, 0, 1, 0.00371213, 0, 0, 1, 0.00371251, 0, 0, 0.999997, 0.00371417, 0, 0, 0.99999, 0.00371863, 0, 0, 0.999977, 0.00372807, 0, 0, 0.99995, 0.00374529, 0, 0, 0.999908, 0.0037738, 0, 0, 0.999843, 0.00381789, 0, 1.23596e-05, 0.999745, 0.00388273, 0, 0.000407442, 0.999608, 0.00397443, 0, 0.0015447, 0.999415, 0.00409998, 0, 0.00351385, 0.999143, 0.00426662, 0, 0.0063316, 0.9987, 0.00447625, 0, 0.00998679, 0.996363, 0.00455323, 0, 0.0144569, 0.994021, 0.00461052, 0, 0.0197151, 0.992372, 0.00476359, 0, 0.0257344, 0.991007, 0.00499101, 0, 0.0324882, 0.988767, 0.0051972, 0, 0.0399517, 0.984872, 0.00528407, 0, 0.0481022, 0.982004, 0.00548926, 0, 0.0569191, 0.977714, 0.00564385, 0, 0.0663839, 0.973076, 0.0057693, 0, 0.0764801, 0.967565, 0.0058924, 0, 0.0871928, 0.961384, 0.00599629, 0, 0.0985095, 0.954435, 0.00605998, 0, 0.110419, 0.946303, 0.0061133, 0, 0.122912, 0.937662, 0.00612028, 0, 0.13598, 0.927867, 0.00612209, 0, 0.149617, 0.916475, 0.00604813, 0, 0.163817, 0.90541, 0.00603088, 0, 0.178577, 0.891591, 0.00592218, 0, 0.193894, 0.877573, 0.00578854, 0, 0.209767, 0.862511, 0.00566648, 0, 0.226196, 0.846861, 0.00551481, 0, 0.243182, 0.83068, 0.00533754, 0, 0.260728, 0.815725, 0.00515487, 0, 0.278837, 0.802321, 0.0049655, 0, 0.297515, 0.787826, 0.00475421, 0, 0.316768, 0.773454, 0.00456002, 0, 0.336605, 0.758224, 0.00434727, 0, 0.357034, 0.74265, 0.00414444, 0, 0.378067, 0.726729, 0.00393738, 0, 0.399717, 0.710155, 0.00373575, 0, 0.421998, 0.693312, 0.00353736, 0, 0.444928, 0.67653, 0.00334368, 0, 0.468523, 0.659444, 0.00315981, 0, 0.492806, 0.642051, 0.00297809, 0, 0.517798, 0.625758, 0.00280592, 0, 0.543525, 0.609615, 0.00264254, 0, 0.570012, 0.592919, 0.00248459, 0, 0.597288, 0.576298, 0.00233327, 0, 0.625379, 0.559489, 0.00219519, 0, 0.654307, 0.542891, 0.00205441, 0, 0.684084, 0.526255, 0.00193385, 0, 0.714693, 0.509853, 0.00180745, 0, 0.746044, 0.494131, 0.00169817, 0, 0.777778, 0.478114, 0.0015913, 0, 0.809524, 0.462274, 0.00148981, 0, 0.84127, 0.446412, 0.00139537, 0, 0.873016, 0.431274, 0.00130984, 0, 0.904762, 0.41635, 0.00122403, 0, 0.936508, 0.401476, 0.00114809, 0, 0.968254, 0.386993, 0.00107563, 0, 1, 1, 0.00488216, 0, 0, 1, 0.0048822, 0, 0, 1, 0.00488265, 0, 0, 0.999997, 0.00488463, 0, 0, 0.999988, 0.00488999, 0, 0, 0.999974, 0.00490129, 0, 0, 0.999946, 0.00492191, 0, 0, 0.999897, 0.00495598, 0, 0, 0.999825, 0.00500855, 0, 7.44791e-05, 0.999718, 0.00508559, 0, 0.000712744, 0.999565, 0.005194, 0, 0.00215249, 0.999352, 0.00534147, 0, 0.00444576, 0.999046, 0.00553523, 0, 0.00759218, 0.998492, 0.00577016, 0, 0.0115714, 0.995564, 0.00578487, 0, 0.0163557, 0.993339, 0.00586414, 0, 0.021915, 0.991834, 0.00606002, 0, 0.0282201, 0.990496, 0.00633312, 0, 0.0352433, 0.987826, 0.00651941, 0, 0.042959, 0.98383, 0.00660842, 0, 0.0513439, 0.98109, 0.00685523, 0, 0.0603772, 0.976131, 0.00695778, 0, 0.0700402, 0.971922, 0.00714236, 0, 0.0803163, 0.965901, 0.00721437, 0, 0.0911908, 0.959606, 0.00732017, 0, 0.102651, 0.952504, 0.00735788, 0, 0.114686, 0.944365, 0.00738493, 0, 0.127286, 0.935652, 0.00737969, 0, 0.140443, 0.925813, 0.00733612, 0, 0.154151, 0.914397, 0.00723094, 0, 0.168405, 0.903257, 0.00714002, 0, 0.183201, 0.890015, 0.00700149, 0, 0.198536, 0.876014, 0.00682813, 0, 0.214409, 0.861436, 0.00665567, 0, 0.23082, 0.845752, 0.00644526, 0, 0.24777, 0.829169, 0.00621635, 0, 0.265263, 0.813435, 0.00597789, 0, 0.283301, 0.799701, 0.00575694, 0, 0.301889, 0.785726, 0.00549866, 0, 0.321035, 0.77152, 0.0052503, 0, 0.340746, 0.75683, 0.00499619, 0, 0.361032, 0.741951, 0.0047543, 0, 0.381904, 0.726367, 0.0045084, 0, 0.403374, 0.710537, 0.00426784, 0, 0.425457, 0.693965, 0.00403487, 0, 0.448169, 0.677724, 0.0038075, 0, 0.47153, 0.66117, 0.00359431, 0, 0.495561, 0.644274, 0.00338354, 0, 0.520284, 0.627449, 0.00318163, 0, 0.545725, 0.611645, 0.00299672, 0, 0.571911, 0.595614, 0.00281016, 0, 0.598873, 0.579426, 0.00264252, 0, 0.62664, 0.563016, 0.00247509, 0, 0.655239, 0.546728, 0.00232647, 0, 0.684692, 0.530539, 0.00217803, 0, 0.714999, 0.514164, 0.00204216, 0, 0.746106, 0.498344, 0.00191403, 0, 0.777778, 0.482957, 0.00179203, 0, 0.809524, 0.467336, 0.00167695, 0, 0.84127, 0.451994, 0.00157567, 0, 0.873016, 0.436514, 0.00147113, 0, 0.904762, 0.42178, 0.00138034, 0, 0.936508, 0.407271, 0.00129219, 0, 0.968254, 0.392822, 0.0012098, 0, 1, 1, 0.00637427, 0, 0, 1, 0.00637431, 0, 0, 0.999999, 0.00637485, 0, 0, 0.999996, 0.00637721, 0, 0, 0.999987, 0.00638357, 0, 0, 0.999971, 0.006397, 0, 0, 0.999939, 0.00642142, 0, 0, 0.999888, 0.00646177, 0, 0, 0.999807, 0.00652387, 0, 0.000207916, 0.999689, 0.00661454, 0, 0.00112051, 0.99952, 0.00674155, 0, 0.00287719, 0.999283, 0.00691313, 0, 0.00550145, 0.998936, 0.00713598, 0, 0.00897928, 0.998165, 0.00738501, 0, 0.0132829, 0.994847, 0.00734388, 0, 0.01838, 0.993182, 0.00749991, 0, 0.0242381, 0.991665, 0.0077246, 0, 0.030826, 0.989708, 0.00797579, 0, 0.0381152, 0.986663, 0.00813011, 0, 0.0460794, 0.983288, 0.00830365, 0, 0.0546951, 0.980104, 0.00853496, 0, 0.0639411, 0.974855, 0.00861045, 0, 0.0737988, 0.97045, 0.00879133, 0, 0.0842516, 0.964509, 0.00886377, 0, 0.0952848, 0.957594, 0.00890346, 0, 0.106886, 0.950546, 0.00893289, 0, 0.119044, 0.942225, 0.00890074, 0, 0.131749, 0.933365, 0.00886826, 0, 0.144994, 0.923202, 0.0087316, 0, 0.158772, 0.912605, 0.00863082, 0, 0.173078, 0.901099, 0.00847403, 0, 0.187908, 0.888177, 0.00825838, 0, 0.203261, 0.873955, 0.00801834, 0, 0.219134, 0.860091, 0.00779026, 0, 0.235527, 0.84434, 0.00752478, 0, 0.252443, 0.828517, 0.00724074, 0, 0.269883, 0.81239, 0.00693769, 0, 0.287851, 0.79721, 0.00664817, 0, 0.306352, 0.783489, 0.00634763, 0, 0.325393, 0.769514, 0.00604221, 0, 0.344981, 0.755419, 0.00573568, 0, 0.365126, 0.741083, 0.00544359, 0, 0.385839, 0.726059, 0.00515515, 0, 0.407132, 0.710809, 0.00487139, 0, 0.42902, 0.695052, 0.00459846, 0, 0.45152, 0.678886, 0.00433412, 0, 0.474651, 0.663042, 0.00407981, 0, 0.498433, 0.646634, 0.00384264, 0, 0.52289, 0.630117, 0.00360897, 0, 0.548048, 0.613804, 0.00338863, 0, 0.573936, 0.598338, 0.00318486, 0, 0.600584, 0.582687, 0.00298377, 0, 0.628027, 0.566809, 0.00280082, 0, 0.656295, 0.550817, 0.00262255, 0, 0.685417, 0.534937, 0.00245835, 0, 0.715406, 0.519151, 0.00230574, 0, 0.74624, 0.503118, 0.0021549, 0, 0.777778, 0.487723, 0.00202008, 0, 0.809524, 0.472725, 0.00189355, 0, 0.84127, 0.457599, 0.00177108, 0, 0.873016, 0.442558, 0.00165843, 0, 0.904762, 0.427624, 0.00155494, 0, 0.936508, 0.413171, 0.00145273, 0, 0.968254, 0.399122, 0.00136454, 0, 1, 1, 0.00826496, 0, 0, 1, 0.00826499, 0, 0, 1, 0.00826564, 0, 0, 0.999996, 0.00826842, 0, 0, 0.999987, 0.00827589, 0, 0, 0.999967, 0.00829167, 0, 0, 0.999933, 0.00832037, 0, 0, 0.999876, 0.00836768, 0, 1.09338e-05, 0.999786, 0.00844031, 0, 0.000427145, 0.999655, 0.00854603, 0, 0.0016384, 0.999468, 0.00869337, 0, 0.00372392, 0.999203, 0.008891, 0, 0.00668513, 0.998803, 0.00914387, 0, 0.0104968, 0.99748, 0.00935838, 0, 0.015125, 0.994446, 0.00933309, 0, 0.0205338, 0.99292, 0.00953084, 0, 0.0266884, 0.991414, 0.0097893, 0, 0.0335565, 0.989049, 0.0100228, 0, 0.0411086, 0.98582, 0.0101664, 0, 0.0493181, 0.982441, 0.0103582, 0, 0.0581613, 0.978595, 0.0105292, 0, 0.0676169, 0.973495, 0.0106274, 0, 0.0776661, 0.968405, 0.0107261, 0, 0.0882926, 0.962717, 0.0108234, 0, 0.0994817, 0.955478, 0.0108102, 0, 0.111221, 0.948275, 0.0107914, 0, 0.123499, 0.940006, 0.0107161, 0, 0.136308, 0.930831, 0.0106309, 0, 0.149639, 0.920648, 0.0104083, 0, 0.163485, 0.910205, 0.0102312, 0, 0.177843, 0.898445, 0.0100051, 0, 0.192707, 0.885986, 0.00971928, 0, 0.208077, 0.872204, 0.00940747, 0, 0.22395, 0.858436, 0.0091085, 0, 0.240326, 0.843454, 0.00876595, 0, 0.257208, 0.827437, 0.00839794, 0, 0.274596, 0.811488, 0.00803692, 0, 0.292496, 0.796039, 0.00767352, 0, 0.310911, 0.781083, 0.0073097, 0, 0.329849, 0.767642, 0.00694032, 0, 0.349316, 0.753901, 0.00657476, 0, 0.369323, 0.740131, 0.00622699, 0, 0.38988, 0.725845, 0.0058838, 0, 0.410999, 0.710991, 0.00555586, 0, 0.432696, 0.696002, 0.00523089, 0, 0.454987, 0.680461, 0.00492494, 0, 0.47789, 0.664875, 0.00463464, 0, 0.501426, 0.649273, 0.00435422, 0, 0.52562, 0.63302, 0.0040875, 0, 0.550498, 0.61705, 0.00384075, 0, 0.576089, 0.601154, 0.00359557, 0, 0.602427, 0.586008, 0.00337636, 0, 0.629544, 0.570699, 0.00316019, 0, 0.657479, 0.555166, 0.00296033, 0, 0.686264, 0.539645, 0.00277552, 0, 0.715924, 0.524159, 0.00259499, 0, 0.746459, 0.508682, 0.00243257, 0, 0.777789, 0.493163, 0.00227851, 0, 0.809524, 0.478004, 0.00213083, 0, 0.84127, 0.46347, 0.00199502, 0, 0.873016, 0.448778, 0.00186967, 0, 0.904762, 0.434105, 0.00174732, 0, 0.936508, 0.419576, 0.00163861, 0, 0.968254, 0.405541, 0.00153341, 0, 1, 1, 0.0106462, 0, 0, 1, 0.0106462, 0, 0, 0.999999, 0.010647, 0, 0, 0.999995, 0.0106502, 0, 0, 0.999985, 0.0106589, 0, 0, 0.999964, 0.0106773, 0, 0, 0.999925, 0.0107106, 0, 0, 0.999861, 0.0107655, 0, 7.12986e-05, 0.999763, 0.0108497, 0, 0.000743959, 0.999616, 0.0109716, 0, 0.00227361, 0.999408, 0.0111408, 0, 0.0046983, 0.999112, 0.0113659, 0, 0.00800158, 0.998637, 0.0116475, 0, 0.0121493, 0.996223, 0.0117231, 0, 0.0171023, 0.994006, 0.0118064, 0, 0.0228218, 0.992444, 0.0120254, 0, 0.0292711, 0.991028, 0.0123314, 0, 0.036417, 0.98803, 0.0124954, 0, 0.0442295, 0.984816, 0.0126538, 0, 0.0526815, 0.981399, 0.0128537, 0, 0.0617492, 0.977085, 0.0129694, 0, 0.0714114, 0.972154, 0.013091, 0, 0.0816495, 0.966617, 0.0131166, 0, 0.0924472, 0.960628, 0.0131583, 0, 0.10379, 0.953295, 0.0131094, 0, 0.115665, 0.94575, 0.0129966, 0, 0.128062, 0.937654, 0.0128796, 0, 0.140972, 0.927716, 0.0126477, 0, 0.154387, 0.917932, 0.0123889, 0, 0.168301, 0.907719, 0.012131, 0, 0.182709, 0.89584, 0.0118013, 0, 0.197608, 0.883526, 0.0114145, 0, 0.212994, 0.870301, 0.0110075, 0, 0.228867, 0.856272, 0.0106019, 0, 0.245227, 0.842251, 0.0101938, 0, 0.262074, 0.826466, 0.00973254, 0, 0.279412, 0.810859, 0.0092846, 0, 0.297244, 0.795051, 0.00883304, 0, 0.315575, 0.780053, 0.00840272, 0, 0.334412, 0.76575, 0.00796438, 0, 0.35376, 0.752298, 0.00752526, 0, 0.373631, 0.739153, 0.00711486, 0, 0.394034, 0.725514, 0.00670361, 0, 0.414983, 0.711473, 0.00632656, 0, 0.436491, 0.696936, 0.00595206, 0, 0.458575, 0.682126, 0.00559191, 0, 0.481253, 0.667027, 0.00525362, 0, 0.504547, 0.651875, 0.00493805, 0, 0.528481, 0.636463, 0.00462848, 0, 0.553081, 0.620641, 0.00433936, 0, 0.578377, 0.604931, 0.00407, 0, 0.604404, 0.589549, 0.00380864, 0, 0.631197, 0.574712, 0.00357049, 0, 0.658795, 0.559775, 0.00334466, 0, 0.687238, 0.544514, 0.00312505, 0, 0.716559, 0.529555, 0.00293199, 0, 0.746776, 0.514402, 0.00274204, 0, 0.777849, 0.499302, 0.00256647, 0, 0.809524, 0.484114, 0.00239901, 0, 0.84127, 0.469308, 0.00225148, 0, 0.873016, 0.455133, 0.00210178, 0, 0.904762, 0.440939, 0.0019727, 0, 0.936508, 0.426627, 0.00184382, 0, 0.968254, 0.412509, 0.00172548, 0, 1, 1, 0.013628, 0, 0, 1, 0.0136281, 0, 0, 0.999999, 0.0136289, 0, 0, 0.999995, 0.0136327, 0, 0, 0.999983, 0.0136427, 0, 0, 0.99996, 0.0136638, 0, 0, 0.999917, 0.0137022, 0, 0, 0.999846, 0.0137652, 0, 0.000204597, 0.999736, 0.0138615, 0, 0.00116837, 0.999573, 0.0140007, 0, 0.00303325, 0.99934, 0.0141927, 0, 0.00580613, 0.999004, 0.0144457, 0, 0.00945626, 0.998407, 0.0147489, 0, 0.0139421, 0.995464, 0.014731, 0, 0.0192202, 0.993328, 0.0148283, 0, 0.0252495, 0.991799, 0.0150797, 0, 0.0319921, 0.990397, 0.0154316, 0, 0.0394138, 0.986835, 0.0155005, 0, 0.0474843, 0.983938, 0.0157308, 0, 0.0561763, 0.980154, 0.0158753, 0, 0.0654661, 0.975659, 0.0159581, 0, 0.0753326, 0.970171, 0.0159832, 0, 0.0857571, 0.964803, 0.0160084, 0, 0.0967236, 0.958366, 0.0159484, 0, 0.108218, 0.950613, 0.0158001, 0, 0.120227, 0.942874, 0.0155845, 0, 0.132741, 0.935005, 0.0154292, 0, 0.145751, 0.924991, 0.0150742, 0, 0.159249, 0.914814, 0.0146757, 0, 0.17323, 0.904743, 0.0143097, 0, 0.187687, 0.893216, 0.0138695, 0, 0.202619, 0.880769, 0.0133706, 0, 0.218021, 0.868136, 0.0128606, 0, 0.233894, 0.85469, 0.0123403, 0, 0.250238, 0.840593, 0.0118091, 0, 0.267052, 0.825808, 0.011253, 0, 0.284341, 0.81009, 0.0107099, 0, 0.302106, 0.79504, 0.0101636, 0, 0.320354, 0.779757, 0.00964041, 0, 0.33909, 0.764697, 0.00911896, 0, 0.358322, 0.750913, 0.00859533, 0, 0.378059, 0.738175, 0.00811592, 0, 0.398311, 0.725242, 0.00764504, 0, 0.41909, 0.711864, 0.00718885, 0, 0.440412, 0.698009, 0.00675843, 0, 0.462292, 0.683841, 0.00634984, 0, 0.484748, 0.669391, 0.00595502, 0, 0.507802, 0.654731, 0.00558671, 0, 0.531477, 0.639805, 0.00523578, 0, 0.555802, 0.624789, 0.00490834, 0, 0.580805, 0.609325, 0.00459448, 0, 0.606522, 0.593975, 0.00430342, 0, 0.63299, 0.578983, 0.00403019, 0, 0.66025, 0.564442, 0.0037707, 0, 0.688346, 0.549835, 0.0035316, 0, 0.717319, 0.535039, 0.00330255, 0, 0.7472, 0.520403, 0.00308932, 0, 0.777982, 0.505687, 0.00289335, 0, 0.809524, 0.490939, 0.00270818, 0, 0.84127, 0.476233, 0.0025343, 0, 0.873016, 0.461624, 0.00237097, 0, 0.904762, 0.447833, 0.00222065, 0, 0.936508, 0.433992, 0.00207561, 0, 0.968254, 0.420147, 0.00194955, 0, 1, 1, 0.0173415, 0, 0, 1, 0.0173416, 0, 0, 0.999999, 0.0173426, 0, 0, 0.999995, 0.0173468, 0, 0, 0.999983, 0.0173582, 0, 0, 0.999954, 0.0173822, 0, 0, 0.999908, 0.0174258, 0, 6.69501e-06, 0.999828, 0.0174973, 0, 0.000427399, 0.999705, 0.0176063, 0, 0.00171019, 0.999524, 0.0177631, 0, 0.0039248, 0.999263, 0.0179781, 0, 0.00705382, 0.998878, 0.018258, 0, 0.0110552, 0.998012, 0.0185551, 0, 0.0158812, 0.994614, 0.0184264, 0, 0.0214852, 0.993132, 0.0186385, 0, 0.0278239, 0.991563, 0.0189067, 0, 0.0348585, 0.989298, 0.0191577, 0, 0.0425544, 0.986036, 0.0192522, 0, 0.050881, 0.982558, 0.0194063, 0, 0.059811, 0.978531, 0.019486, 0, 0.0693209, 0.974198, 0.0195847, 0, 0.0793895, 0.968148, 0.0194749, 0, 0.0899984, 0.962565, 0.0194277, 0, 0.101132, 0.956041, 0.0192991, 0, 0.112775, 0.947749, 0.0189893, 0, 0.124917, 0.94018, 0.018704, 0, 0.137547, 0.93165, 0.0183458, 0, 0.150655, 0.921798, 0.0178775, 0, 0.164236, 0.911573, 0.0173618, 0, 0.178281, 0.901569, 0.0168482, 0, 0.192788, 0.890341, 0.016265, 0, 0.207752, 0.877835, 0.0156199, 0, 0.223171, 0.865472, 0.0149516, 0, 0.239044, 0.852905, 0.0143274, 0, 0.255371, 0.838906, 0.0136643, 0, 0.272153, 0.824888, 0.0129903, 0, 0.289393, 0.809977, 0.0123218, 0, 0.307093, 0.794697, 0.0116572, 0, 0.325259, 0.780028, 0.0110307, 0, 0.343896, 0.765124, 0.0104236, 0, 0.363012, 0.750411, 0.0098219, 0, 0.382617, 0.737264, 0.00924397, 0, 0.402719, 0.724799, 0.00868719, 0, 0.423332, 0.712253, 0.00816476, 0, 0.444469, 0.699267, 0.00767262, 0, 0.466146, 0.685618, 0.00719746, 0, 0.488383, 0.671736, 0.00673916, 0, 0.511199, 0.657777, 0.00631937, 0, 0.534618, 0.643497, 0.00592411, 0, 0.558668, 0.62889, 0.00553928, 0, 0.58338, 0.614299, 0.0051934, 0, 0.608787, 0.599197, 0.00485985, 0, 0.634929, 0.584175, 0.00454357, 0, 0.661849, 0.569541, 0.00425787, 0, 0.689594, 0.555193, 0.00397905, 0, 0.718211, 0.540947, 0.00372364, 0, 0.747742, 0.526593, 0.00348599, 0, 0.778205, 0.512335, 0.00326103, 0, 0.80953, 0.498017, 0.00305137, 0, 0.84127, 0.483609, 0.00285485, 0, 0.873016, 0.469368, 0.00267472, 0, 0.904762, 0.455037, 0.00249945, 0, 0.936508, 0.441493, 0.00234792, 0, 0.968254, 0.428147, 0.00219936, 0, 1, 1, 0.0219422, 0, 0, 1, 0.0219423, 0, 0, 0.999998, 0.0219434, 0, 0, 0.999993, 0.0219481, 0, 0, 0.999981, 0.021961, 0, 0, 0.999949, 0.0219879, 0, 0, 0.999896, 0.0220367, 0, 5.93194e-05, 0.999808, 0.0221167, 0, 0.00075364, 0.99967, 0.0222383, 0, 0.00237884, 0.999466, 0.0224125, 0, 0.00495612, 0.999174, 0.0226495, 0, 0.00844887, 0.998725, 0.0229525, 0, 0.0128058, 0.996979, 0.0231123, 0, 0.0179742, 0.994317, 0.0230742, 0, 0.0239047, 0.992781, 0.0232895, 0, 0.0305526, 0.991191, 0.0235734, 0, 0.0378786, 0.987787, 0.0236152, 0, 0.0458475, 0.985092, 0.0237994, 0, 0.0544287, 0.981121, 0.0238553, 0, 0.0635952, 0.976924, 0.0238706, 0, 0.0733233, 0.97218, 0.0238704, 0, 0.0835922, 0.965956, 0.0236598, 0, 0.0943839, 0.959998, 0.0234735, 0, 0.105682, 0.953245, 0.0232277, 0, 0.117474, 0.944445, 0.0226973, 0, 0.129747, 0.937087, 0.0223527, 0, 0.142491, 0.928341, 0.0218144, 0, 0.155697, 0.9184, 0.0211516, 0, 0.169358, 0.907959, 0.0204553, 0, 0.183469, 0.89808, 0.0197673, 0, 0.198024, 0.887047, 0.0189915, 0, 0.21302, 0.875221, 0.0182082, 0, 0.228455, 0.86269, 0.0173584, 0, 0.244329, 0.850735, 0.0165718, 0, 0.260639, 0.837545, 0.0157524, 0, 0.277389, 0.823639, 0.0149482, 0, 0.29458, 0.809699, 0.0141431, 0, 0.312216, 0.794797, 0.0133527, 0, 0.3303, 0.780578, 0.0126193, 0, 0.34884, 0.766019, 0.0118914, 0, 0.367842, 0.751447, 0.0111839, 0, 0.387315, 0.737275, 0.010514, 0, 0.40727, 0.724545, 0.00987277, 0, 0.427717, 0.712644, 0.00926569, 0, 0.448671, 0.700432, 0.00869029, 0, 0.470149, 0.687664, 0.00814691, 0, 0.492167, 0.674288, 0.00763012, 0, 0.514746, 0.660966, 0.00714437, 0, 0.537911, 0.647264, 0.00668457, 0, 0.561688, 0.633431, 0.00626581, 0, 0.586108, 0.619133, 0.00585593, 0, 0.611206, 0.604935, 0.00548188, 0, 0.637022, 0.590236, 0.00513288, 0, 0.663599, 0.575473, 0.0047906, 0, 0.690989, 0.561228, 0.00448895, 0, 0.719242, 0.547054, 0.00420233, 0, 0.748411, 0.533175, 0.00392869, 0, 0.778531, 0.519163, 0.00367445, 0, 0.809583, 0.505328, 0.00344097, 0, 0.84127, 0.491446, 0.00322003, 0, 0.873016, 0.477356, 0.00301283, 0, 0.904762, 0.46356, 0.00282592, 0, 0.936508, 0.449623, 0.00264956, 0, 0.968254, 0.436068, 0.00246956, 0, 1, 1, 0.0276135, 0, 0, 1, 0.0276136, 0, 0, 0.999998, 0.0276148, 0, 0, 0.999993, 0.0276201, 0, 0, 0.999976, 0.0276342, 0, 0, 0.999945, 0.027664, 0, 0, 0.999884, 0.0277179, 0, 0.00018679, 0.999784, 0.027806, 0, 0.00119607, 0.99963, 0.0279394, 0, 0.00318407, 0.999401, 0.0281295, 0, 0.00613601, 0.999066, 0.0283858, 0, 0.00999963, 0.998524, 0.0287027, 0, 0.0147164, 0.995702, 0.0286256, 0, 0.0202295, 0.993593, 0.0286733, 0, 0.0264876, 0.992067, 0.0288989, 0, 0.0334452, 0.990548, 0.0292135, 0, 0.0410621, 0.986775, 0.0291296, 0, 0.0493032, 0.984054, 0.0293099, 0, 0.0581381, 0.979481, 0.0291881, 0, 0.0675397, 0.975297, 0.0291598, 0, 0.0774848, 0.96981, 0.028954, 0, 0.0879528, 0.963524, 0.028628, 0, 0.0989258, 0.957398, 0.0283135, 0, 0.110388, 0.950088, 0.0278469, 0, 0.122327, 0.941538, 0.0271798, 0, 0.134729, 0.933332, 0.0265388, 0, 0.147587, 0.924392, 0.0257776, 0, 0.160889, 0.914581, 0.024916, 0, 0.174631, 0.904347, 0.0240242, 0, 0.188806, 0.894324, 0.0231229, 0, 0.203409, 0.883724, 0.022153, 0, 0.218437, 0.872207, 0.0211355, 0, 0.233888, 0.859927, 0.0201048, 0, 0.249761, 0.848373, 0.0191263, 0, 0.266056, 0.836023, 0.0181306, 0, 0.282774, 0.82289, 0.0171718, 0, 0.299917, 0.809324, 0.0162196, 0, 0.317488, 0.795361, 0.0152622, 0, 0.335493, 0.781253, 0.01439, 0, 0.353936, 0.767338, 0.013533, 0, 0.372825, 0.753156, 0.0127244, 0, 0.392168, 0.739122, 0.0119454, 0, 0.411976, 0.725358, 0.0112054, 0, 0.432259, 0.712949, 0.010487, 0, 0.453032, 0.701621, 0.00984032, 0, 0.47431, 0.689703, 0.00921495, 0, 0.496111, 0.677216, 0.00862492, 0, 0.518456, 0.664217, 0.00806882, 0, 0.541367, 0.65137, 0.00755922, 0, 0.564872, 0.638, 0.00705705, 0, 0.589001, 0.62453, 0.00661266, 0, 0.613789, 0.610601, 0.00618432, 0, 0.639277, 0.59676, 0.00578033, 0, 0.66551, 0.582433, 0.00540927, 0, 0.692539, 0.568026, 0.00506104, 0, 0.720422, 0.55414, 0.0047353, 0, 0.749216, 0.540178, 0.00442889, 0, 0.778974, 0.526513, 0.00414363, 0, 0.809711, 0.512954, 0.00388237, 0, 0.84127, 0.499403, 0.00362875, 0, 0.873016, 0.486026, 0.00340827, 0, 0.904762, 0.472345, 0.00318598, 0, 0.936508, 0.458828, 0.00297635, 0, 0.968254, 0.445379, 0.00279447, 0, 1, 1, 0.0345716, 0, 0, 1, 0.0345717, 0, 0, 0.999999, 0.034573, 0, 0, 0.999991, 0.0345787, 0, 0, 0.999974, 0.0345941, 0, 0, 0.999937, 0.0346263, 0, 1.88589e-06, 0.999869, 0.0346847, 0, 0.000409238, 0.999757, 0.0347798, 0, 0.0017674, 0.999582, 0.0349233, 0, 0.00413658, 0.999322, 0.0351265, 0, 0.00747408, 0.998939, 0.0353967, 0, 0.0117157, 0.998219, 0.0357018, 0, 0.0167966, 0.994974, 0.0354726, 0, 0.0226572, 0.993201, 0.0355621, 0, 0.0292445, 0.991573, 0.0357641, 0, 0.0365123, 0.989301, 0.0359252, 0, 0.0444203, 0.985712, 0.0358017, 0, 0.0529334, 0.982411, 0.0358353, 0, 0.0620214, 0.977827, 0.035617, 0, 0.0716574, 0.973278, 0.0354398, 0, 0.0818186, 0.967397, 0.0350483, 0, 0.0924846, 0.960696, 0.0344795, 0, 0.103638, 0.954349, 0.0339861, 0, 0.115263, 0.946066, 0.0331323, 0, 0.127348, 0.938012, 0.032359, 0, 0.13988, 0.929413, 0.0314413, 0, 0.152849, 0.920355, 0.0304103, 0, 0.166248, 0.910586, 0.0292785, 0, 0.18007, 0.900609, 0.0281391, 0, 0.194308, 0.890093, 0.0269103, 0, 0.208958, 0.880013, 0.0257269, 0, 0.224018, 0.869001, 0.0244671, 0, 0.239485, 0.85751, 0.0232252, 0, 0.255359, 0.84582, 0.0220117, 0, 0.271638, 0.834383, 0.0208274, 0, 0.288324, 0.822158, 0.0196628, 0, 0.305419, 0.809056, 0.0185306, 0, 0.322927, 0.795832, 0.0174174, 0, 0.340851, 0.782547, 0.0163758, 0, 0.359199, 0.7689, 0.015391, 0, 0.377975, 0.755526, 0.0144488, 0, 0.397189, 0.741681, 0.0135372, 0, 0.416851, 0.728178, 0.0126957, 0, 0.436971, 0.714642, 0.0118812, 0, 0.457564, 0.702756, 0.0111165, 0, 0.478644, 0.69175, 0.0104145, 0, 0.500229, 0.680159, 0.00974439, 0, 0.522339, 0.668073, 0.00911926, 0, 0.544997, 0.655405, 0.00851393, 0, 0.56823, 0.642921, 0.00797637, 0, 0.592068, 0.629993, 0.00745119, 0, 0.616546, 0.616828, 0.00696972, 0, 0.641705, 0.603305, 0.00652425, 0, 0.66759, 0.589833, 0.00610188, 0, 0.694255, 0.575945, 0.00570834, 0, 0.72176, 0.561745, 0.00533384, 0, 0.750168, 0.548277, 0.00500001, 0, 0.779545, 0.534467, 0.00467582, 0, 0.809933, 0.521032, 0.00438092, 0, 0.841272, 0.507877, 0.00410348, 0, 0.873016, 0.494654, 0.00383618, 0, 0.904762, 0.481592, 0.00358699, 0, 0.936508, 0.468509, 0.00337281, 0, 0.968254, 0.455293, 0.00316196, 0, 1, 1, 0.0430698, 0, 0, 1, 0.0430699, 0, 0, 0.999998, 0.0430713, 0, 0, 0.999991, 0.0430773, 0, 0, 0.99997, 0.0430936, 0, 0, 0.999928, 0.0431277, 0, 4.06396e-05, 0.999852, 0.0431893, 0, 0.000744376, 0.999724, 0.0432895, 0, 0.0024806, 0.999527, 0.0434397, 0, 0.00524779, 0.99923, 0.0436507, 0, 0.00898164, 0.998783, 0.0439255, 0, 0.0136083, 0.997507, 0.0441104, 0, 0.0190582, 0.994418, 0.0438225, 0, 0.0252694, 0.992864, 0.0439396, 0, 0.0321879, 0.991127, 0.0440962, 0, 0.039767, 0.987331, 0.0438408, 0, 0.0479667, 0.984819, 0.0438991, 0, 0.056752, 0.980384, 0.0435906, 0, 0.0660929, 0.975846, 0.0432543, 0, 0.075963, 0.970748, 0.0428293, 0, 0.0863398, 0.964303, 0.042153, 0, 0.0972035, 0.95772, 0.0414111, 0, 0.108537, 0.950747, 0.0405893, 0, 0.120325, 0.942533, 0.0394887, 0, 0.132554, 0.934045, 0.0383544, 0, 0.145215, 0.924942, 0.037057, 0, 0.158296, 0.915811, 0.0356993, 0, 0.17179, 0.90612, 0.0342401, 0, 0.185691, 0.896434, 0.0328078, 0, 0.199993, 0.886021, 0.031288, 0, 0.214691, 0.876081, 0.0297776, 0, 0.229782, 0.865608, 0.0282334, 0, 0.245265, 0.854924, 0.026749, 0, 0.261138, 0.843607, 0.02526, 0, 0.277401, 0.832456, 0.0238214, 0, 0.294056, 0.821342, 0.0224682, 0, 0.311104, 0.809303, 0.0211297, 0, 0.328548, 0.796468, 0.0198387, 0, 0.346394, 0.784046, 0.0186227, 0, 0.364645, 0.771262, 0.0174561, 0, 0.38331, 0.758118, 0.0163806, 0, 0.402396, 0.745075, 0.0153287, 0, 0.421912, 0.731926, 0.0143647, 0, 0.44187, 0.71863, 0.0134363, 0, 0.462283, 0.705414, 0.0125603, 0, 0.483165, 0.693792, 0.0117508, 0, 0.504535, 0.683108, 0.0110016, 0, 0.52641, 0.67183, 0.0102757, 0, 0.548816, 0.66015, 0.00962044, 0, 0.571776, 0.647907, 0.00898031, 0, 0.595323, 0.635734, 0.00840811, 0, 0.619489, 0.623208, 0.00786211, 0, 0.644317, 0.610438, 0.00734953, 0, 0.669852, 0.597345, 0.00687688, 0, 0.696148, 0.584138, 0.00643469, 0, 0.723267, 0.5707, 0.00602236, 0, 0.75128, 0.556966, 0.0056324, 0, 0.780258, 0.543607, 0.00528277, 0, 0.810268, 0.530213, 0.00493999, 0, 0.841311, 0.516912, 0.00462265, 0, 0.873016, 0.503916, 0.0043307, 0, 0.904762, 0.491146, 0.00406858, 0, 0.936508, 0.478439, 0.00381436, 0, 0.968254, 0.465834, 0.00358003, 0, 1, 1, 0.0534039, 0, 0, 1, 0.053404, 0, 0, 0.999998, 0.0534055, 0, 0, 0.999989, 0.0534116, 0, 0, 0.999968, 0.0534283, 0, 0, 0.999918, 0.0534633, 0, 0.000155895, 0.99983, 0.0535262, 0, 0.00120914, 0.999685, 0.0536281, 0, 0.00334944, 0.999461, 0.0537799, 0, 0.00653077, 0.999119, 0.0539902, 0, 0.0106718, 0.998582, 0.0542524, 0, 0.0156907, 0.995919, 0.0540318, 0, 0.0215147, 0.993735, 0.0538914, 0, 0.0280801, 0.992126, 0.0539557, 0, 0.0353323, 0.990266, 0.0540401, 0, 0.0432247, 0.986317, 0.0536064, 0, 0.0517172, 0.983213, 0.0534425, 0, 0.0607754, 0.978303, 0.0528622, 0, 0.0703698, 0.973665, 0.0523363, 0, 0.0804742, 0.968091, 0.0516165, 0, 0.0910667, 0.961026, 0.0505434, 0, 0.102128, 0.954333, 0.049523, 0, 0.113641, 0.946372, 0.0481698, 0, 0.125591, 0.938254, 0.0467674, 0, 0.137965, 0.929516, 0.0452341, 0, 0.150754, 0.920106, 0.0435083, 0, 0.163947, 0.910899, 0.0417399, 0, 0.177537, 0.901532, 0.0399389, 0, 0.191516, 0.891919, 0.0380901, 0, 0.205881, 0.882006, 0.0362341, 0, 0.220626, 0.871965, 0.0343444, 0, 0.235749, 0.862145, 0.0324832, 0, 0.251248, 0.852058, 0.0306681, 0, 0.267121, 0.84161, 0.0289097, 0, 0.283368, 0.830806, 0.0272079, 0, 0.299992, 0.820476, 0.0256089, 0, 0.316992, 0.809514, 0.0240394, 0, 0.334374, 0.797865, 0.0225379, 0, 0.35214, 0.785621, 0.0211235, 0, 0.370296, 0.773765, 0.0197908, 0, 0.388849, 0.761629, 0.0185235, 0, 0.407807, 0.748891, 0.0173358, 0, 0.427178, 0.736437, 0.0162305, 0, 0.446974, 0.723707, 0.0151778, 0, 0.467207, 0.710606, 0.0141791, 0, 0.487892, 0.698019, 0.0132592, 0, 0.509046, 0.686203, 0.0123887, 0, 0.530687, 0.675692, 0.0115976, 0, 0.552839, 0.664826, 0.0108325, 0, 0.575527, 0.65349, 0.0101348, 0, 0.59878, 0.641774, 0.00947756, 0, 0.622634, 0.629794, 0.00886058, 0, 0.647128, 0.617647, 0.00828526, 0, 0.672308, 0.60534, 0.00775312, 0, 0.698231, 0.592718, 0.00726033, 0, 0.724958, 0.579746, 0.00679731, 0, 0.752563, 0.566763, 0.00636111, 0, 0.781127, 0.553515, 0.00595228, 0, 0.810733, 0.540118, 0.00556876, 0, 0.841426, 0.527325, 0.00523051, 0, 0.873016, 0.514265, 0.00490712, 0, 0.904762, 0.501406, 0.00460297, 0, 0.936508, 0.488922, 0.00431247, 0, 0.968254, 0.476541, 0.0040472, 0, 1, 1, 0.0659184, 0, 0, 1, 0.0659185, 0, 0, 0.999998, 0.06592, 0, 0, 0.999988, 0.0659259, 0, 0, 0.999963, 0.0659423, 0, 0, 0.999907, 0.0659764, 0, 0.000374198, 0.999806, 0.0660376, 0, 0.00182071, 0.999639, 0.0661361, 0, 0.0043894, 0.999378, 0.0662814, 0, 0.00800055, 0.998985, 0.0664779, 0, 0.0125594, 0.998285, 0.0666914, 0, 0.0179786, 0.995071, 0.0661989, 0, 0.0241822, 0.993172, 0.0660454, 0, 0.031106, 0.991438, 0.0660105, 0, 0.0386952, 0.988428, 0.0656875, 0, 0.0469032, 0.985218, 0.0652913, 0, 0.0556905, 0.981128, 0.0647107, 0, 0.065023, 0.976015, 0.0638491, 0, 0.0748717, 0.97097, 0.062993, 0, 0.0852112, 0.964582, 0.0617927, 0, 0.0960199, 0.957383, 0.0603626, 0, 0.107279, 0.949969, 0.0588128, 0, 0.118971, 0.941843, 0.0570274, 0, 0.131084, 0.933624, 0.0551885, 0, 0.143604, 0.924543, 0.053122, 0, 0.156521, 0.914919, 0.0508897, 0, 0.169825, 0.905773, 0.0486418, 0, 0.18351, 0.896434, 0.0463364, 0, 0.197569, 0.887195, 0.0440623, 0, 0.211997, 0.877706, 0.0417799, 0, 0.226789, 0.867719, 0.03945, 0, 0.241944, 0.858587, 0.037243, 0, 0.257458, 0.849317, 0.0350956, 0, 0.273331, 0.839585, 0.0329852, 0, 0.289563, 0.829856, 0.0310028, 0, 0.306154, 0.819589, 0.0290953, 0, 0.323108, 0.809714, 0.0272738, 0, 0.340426, 0.79934, 0.0255631, 0, 0.358113, 0.788224, 0.0239175, 0, 0.376175, 0.776619, 0.0223831, 0, 0.394616, 0.76521, 0.0209298, 0, 0.413445, 0.753716, 0.0195786, 0, 0.432671, 0.741564, 0.0183001, 0, 0.452305, 0.729413, 0.0171259, 0, 0.472358, 0.717146, 0.0159933, 0, 0.492845, 0.70436, 0.0149495, 0, 0.513783, 0.69219, 0.0139681, 0, 0.535189, 0.680289, 0.0130577, 0, 0.557087, 0.669611, 0.0122198, 0, 0.5795, 0.659113, 0.0114174, 0, 0.602459, 0.648148, 0.0106729, 0, 0.625997, 0.636905, 0.00998997, 0, 0.650154, 0.625154, 0.00934313, 0, 0.674976, 0.613481, 0.00874839, 0, 0.700518, 0.60154, 0.00818265, 0, 0.726845, 0.58943, 0.00766889, 0, 0.754032, 0.576828, 0.00717153, 0, 0.782167, 0.564194, 0.00672696, 0, 0.811344, 0.551501, 0.00630863, 0, 0.841644, 0.538635, 0.00592177, 0, 0.873016, 0.525724, 0.00554888, 0, 0.904762, 0.513209, 0.00520225, 0, 0.936508, 0.500457, 0.00488231, 0, 0.968254, 0.48799, 0.00457153, 0, 1, 1, 0.0810131, 0, 0, 1, 0.0810133, 0, 0, 0.999997, 0.0810145, 0, 0, 0.999985, 0.08102, 0, 0, 0.999956, 0.0810347, 0, 1.95026e-05, 0.999893, 0.0810656, 0, 0.000719316, 0.999777, 0.0811205, 0, 0.00259774, 0.999583, 0.081208, 0, 0.00561807, 0.999281, 0.0813343, 0, 0.00967472, 0.998813, 0.0814969, 0, 0.0146627, 0.997597, 0.0815217, 0, 0.0204902, 0.994379, 0.0808502, 0, 0.0270802, 0.992744, 0.0806792, 0, 0.0343674, 0.990745, 0.0804589, 0, 0.0422974, 0.986646, 0.0796107, 0, 0.0508242, 0.983611, 0.0790913, 0, 0.0599087, 0.978869, 0.0780746, 0, 0.0695175, 0.973475, 0.0768218, 0, 0.0796223, 0.967845, 0.0754926, 0, 0.0901983, 0.960778, 0.0737063, 0, 0.101224, 0.953333, 0.0718052, 0, 0.112682, 0.945274, 0.0695946, 0, 0.124555, 0.936955, 0.0672492, 0, 0.136831, 0.928319, 0.0647732, 0, 0.149496, 0.919075, 0.0620947, 0, 0.162542, 0.909114, 0.0591816, 0, 0.175958, 0.900137, 0.0563917, 0, 0.189739, 0.891069, 0.0535392, 0, 0.203877, 0.882262, 0.0507642, 0, 0.218368, 0.873232, 0.0479793, 0, 0.233208, 0.864042, 0.045226, 0, 0.248393, 0.855002, 0.0425413, 0, 0.263923, 0.846569, 0.0400126, 0, 0.279796, 0.837714, 0.0375269, 0, 0.296012, 0.828918, 0.0352027, 0, 0.312573, 0.819783, 0.0330011, 0, 0.329479, 0.810129, 0.0308908, 0, 0.346734, 0.800866, 0.0289112, 0, 0.364342, 0.79093, 0.0270255, 0, 0.382307, 0.780593, 0.0252758, 0, 0.400637, 0.769511, 0.0236178, 0, 0.419337, 0.758558, 0.0220652, 0, 0.438418, 0.747632, 0.0206289, 0, 0.457889, 0.736146, 0.0192873, 0, 0.477761, 0.724093, 0.0180333, 0, 0.49805, 0.71234, 0.0168264, 0, 0.51877, 0.700201, 0.015746, 0, 0.53994, 0.687949, 0.0147027, 0, 0.561581, 0.676163, 0.0137512, 0, 0.583718, 0.665001, 0.0128655, 0, 0.60638, 0.65472, 0.0120366, 0, 0.629599, 0.644213, 0.0112604, 0, 0.653415, 0.633382, 0.0105413, 0, 0.677874, 0.62212, 0.00986498, 0, 0.70303, 0.610631, 0.00923308, 0, 0.728948, 0.599078, 0.00864206, 0, 0.755706, 0.587519, 0.00811784, 0, 0.783396, 0.575505, 0.00761237, 0, 0.812121, 0.563148, 0.00713949, 0, 0.841989, 0.550828, 0.00668379, 0, 0.873035, 0.538458, 0.00627715, 0, 0.904762, 0.525905, 0.00588336, 0, 0.936508, 0.513517, 0.00552687, 0, 0.968254, 0.501395, 0.00519681, 0, 1, 1, 0.0991506, 0, 0, 1, 0.0991504, 0, 0, 0.999996, 0.0991515, 0, 0, 0.999984, 0.0991558, 0, 0, 0.999947, 0.0991672, 0, 0.000114389, 0.999874, 0.0991912, 0, 0.00121503, 0.999739, 0.0992331, 0, 0.00356108, 0.999514, 0.0992983, 0, 0.00705578, 0.999159, 0.0993877, 0, 0.011574, 0.998586, 0.0994837, 0, 0.017003, 0.995731, 0.0988425, 0, 0.0232484, 0.993384, 0.098276, 0, 0.0302318, 0.991615, 0.0979269, 0, 0.0378884, 0.989029, 0.0973432, 0, 0.0461641, 0.985373, 0.0963539, 0, 0.0550136, 0.981278, 0.0952306, 0, 0.0643988, 0.975777, 0.0936233, 0, 0.0742868, 0.970526, 0.0920219, 0, 0.0846501, 0.963755, 0.0898912, 0, 0.0954644, 0.956676, 0.0876064, 0, 0.106709, 0.948099, 0.0847751, 0, 0.118367, 0.939718, 0.0818638, 0, 0.130423, 0.931305, 0.078857, 0, 0.142862, 0.922342, 0.0756127, 0, 0.155674, 0.912842, 0.0721473, 0, 0.168849, 0.903304, 0.0686195, 0, 0.182378, 0.89411, 0.0650589, 0, 0.196255, 0.885512, 0.0616022, 0, 0.210473, 0.877193, 0.0582434, 0, 0.225027, 0.86877, 0.0548979, 0, 0.239915, 0.860267, 0.0516095, 0, 0.255132, 0.851915, 0.048468, 0, 0.270678, 0.843912, 0.0454447, 0, 0.286551, 0.83604, 0.0425612, 0, 0.302751, 0.828245, 0.0398752, 0, 0.31928, 0.820159, 0.0373198, 0, 0.336138, 0.81167, 0.034916, 0, 0.35333, 0.802659, 0.0326402, 0, 0.370858, 0.793921, 0.0304901, 0, 0.388728, 0.784713, 0.0284857, 0, 0.406944, 0.774946, 0.0266186, 0, 0.425515, 0.76448, 0.0248593, 0, 0.444449, 0.753793, 0.0232114, 0, 0.463756, 0.743506, 0.0217039, 0, 0.483447, 0.732555, 0.0202841, 0, 0.503535, 0.720965, 0.0189648, 0, 0.524036, 0.709422, 0.0177189, 0, 0.544968, 0.697756, 0.0165626, 0, 0.56635, 0.685565, 0.015483, 0, 0.588208, 0.673987, 0.0144892, 0, 0.610569, 0.66244, 0.0135607, 0, 0.633466, 0.651675, 0.0126956, 0, 0.656936, 0.641598, 0.0118788, 0, 0.681025, 0.63121, 0.0111261, 0, 0.705788, 0.620514, 0.010437, 0, 0.731289, 0.609366, 0.00978747, 0, 0.757606, 0.598137, 0.00917257, 0, 0.784834, 0.586966, 0.00859778, 0, 0.813085, 0.575549, 0.00806803, 0, 0.842485, 0.563797, 0.00757294, 0, 0.87313, 0.551758, 0.00710592, 0, 0.904762, 0.539894, 0.0066841, 0, 0.936508, 0.527901, 0.00627901, 0, 0.968254, 0.515819, 0.00590506, 0, 1, 1, 0.120864, 0, 0, 1, 0.120864, 0, 0, 0.999996, 0.120864, 0, 0, 0.99998, 0.120867, 0, 0, 0.99994, 0.120872, 0, 0.000323781, 0.999852, 0.120884, 0, 0.00188693, 0.999693, 0.120903, 0, 0.00473489, 0.999426, 0.120929, 0, 0.00872704, 0.999002, 0.120955, 0, 0.0137237, 0.998235, 0.120918, 0, 0.0196068, 0.994608, 0.119764, 0, 0.0262803, 0.992997, 0.119265, 0, 0.0336657, 0.990968, 0.11863, 0, 0.0416987, 0.987002, 0.117261, 0, 0.0503261, 0.983524, 0.116009, 0, 0.0595035, 0.97875, 0.114252, 0, 0.0691935, 0.972652, 0.11193, 0, 0.0793645, 0.966613, 0.109555, 0, 0.0899894, 0.959275, 0.106612, 0, 0.101045, 0.951272, 0.103375, 0, 0.112512, 0.942323, 0.0996594, 0, 0.124372, 0.933679, 0.0958841, 0, 0.136611, 0.924822, 0.0919265, 0, 0.149216, 0.915742, 0.0878061, 0, 0.162176, 0.906348, 0.0834894, 0, 0.175482, 0.896883, 0.079085, 0, 0.189125, 0.88774, 0.0746745, 0, 0.203098, 0.87986, 0.0705773, 0, 0.217396, 0.871998, 0.0665005, 0, 0.232015, 0.864325, 0.0625413, 0, 0.24695, 0.856685, 0.0586781, 0, 0.2622, 0.84925, 0.0550063, 0, 0.277761, 0.841719, 0.0514727, 0, 0.293634, 0.834755, 0.0481398, 0, 0.309819, 0.827853, 0.0450172, 0, 0.326315, 0.820888, 0.0420969, 0, 0.343126, 0.813616, 0.0393702, 0, 0.360254, 0.805767, 0.0367771, 0, 0.377701, 0.797338, 0.0343274, 0, 0.395474, 0.789122, 0.0320529, 0, 0.413577, 0.780601, 0.0299485, 0, 0.432018, 0.771424, 0.0279812, 0, 0.450804, 0.761502, 0.0261054, 0, 0.469944, 0.751166, 0.0243942, 0, 0.489451, 0.741276, 0.0228087, 0, 0.509337, 0.730898, 0.0213265, 0, 0.529617, 0.719878, 0.0199307, 0, 0.550307, 0.708379, 0.0186574, 0, 0.571428, 0.697165, 0.0174446, 0, 0.593003, 0.685554, 0.0163144, 0, 0.615059, 0.673631, 0.015276, 0, 0.637628, 0.662385, 0.0143003, 0, 0.660746, 0.651059, 0.0134112, 0, 0.68446, 0.640451, 0.0125794, 0, 0.70882, 0.630536, 0.011793, 0, 0.733893, 0.620316, 0.0110547, 0, 0.759756, 0.609722, 0.0103668, 0, 0.786505, 0.598804, 0.00973009, 0, 0.814259, 0.587871, 0.00912812, 0, 0.843157, 0.577121, 0.00858916, 0, 0.87334, 0.566019, 0.00807333, 0, 0.904762, 0.554664, 0.00759687, 0, 0.936508, 0.543101, 0.00714759, 0, 0.968254, 0.531558, 0.00673418, 0, 1, 1, 0.146767, 0, 0, 1, 0.146767, 0, 0, 0.999997, 0.146767, 0, 0, 0.999977, 0.146765, 0, 3.20658e-06, 0.999929, 0.146762, 0, 0.000682576, 0.999823, 0.146753, 0, 0.00276402, 0.999633, 0.146735, 0, 0.00614771, 0.999314, 0.146699, 0, 0.0106613, 0.998796, 0.14662, 0, 0.0161546, 0.997124, 0.146107, 0, 0.0225063, 0.994062, 0.144857, 0, 0.0296198, 0.992154, 0.144011, 0, 0.037417, 0.989186, 0.142712, 0, 0.0458348, 0.985279, 0.140926, 0, 0.0548211, 0.980826, 0.13885, 0, 0.0643326, 0.975056, 0.136168, 0, 0.074333, 0.969005, 0.133217, 0, 0.0847917, 0.961554, 0.12959, 0, 0.0956828, 0.954206, 0.125886, 0, 0.106984, 0.945046, 0.121335, 0, 0.118675, 0.935678, 0.116492, 0, 0.130741, 0.926748, 0.111635, 0, 0.143166, 0.917764, 0.106625, 0, 0.155939, 0.908358, 0.101325, 0, 0.169049, 0.899219, 0.0960249, 0, 0.182487, 0.890089, 0.0906527, 0, 0.196245, 0.881488, 0.0853905, 0, 0.210317, 0.874031, 0.0804177, 0, 0.224697, 0.866932, 0.0756005, 0, 0.23938, 0.859976, 0.0709019, 0, 0.254364, 0.853375, 0.0664391, 0, 0.269646, 0.846971, 0.0622012, 0, 0.285223, 0.840483, 0.058129, 0, 0.301096, 0.833969, 0.0542762, 0, 0.317265, 0.82806, 0.0507042, 0, 0.333729, 0.822128, 0.047368, 0, 0.350491, 0.815989, 0.044272, 0, 0.367554, 0.809336, 0.0413444, 0, 0.38492, 0.802177, 0.038601, 0, 0.402594, 0.79441, 0.0360227, 0, 0.420582, 0.786573, 0.0336383, 0, 0.438891, 0.778619, 0.0314321, 0, 0.457527, 0.77, 0.029362, 0, 0.476499, 0.760698, 0.0274102, 0, 0.49582, 0.750932, 0.0256146, 0, 0.5155, 0.740993, 0.023974, 0, 0.535555, 0.731159, 0.0224182, 0, 0.556, 0.720836, 0.0209889, 0, 0.576855, 0.709913, 0.0196411, 0, 0.598143, 0.698415, 0.0183824, 0, 0.619888, 0.68745, 0.0172222, 0, 0.642123, 0.676154, 0.0161509, 0, 0.664883, 0.664383, 0.0151397, 0, 0.688211, 0.6533, 0.0141873, 0, 0.71216, 0.642072, 0.0133105, 0, 0.736792, 0.631412, 0.0124932, 0, 0.762186, 0.621622, 0.0117408, 0, 0.788439, 0.611681, 0.0110358, 0, 0.815672, 0.60142, 0.0103775, 0, 0.844034, 0.59083, 0.00975623, 0, 0.873699, 0.580254, 0.00918084, 0, 0.904765, 0.569841, 0.00864721, 0, 0.936508, 0.559224, 0.00815731, 0, 0.968254, 0.548315, 0.00767924, 0, 1, 1, 0.177563, 0, 0, 1, 0.177563, 0, 0, 0.999994, 0.177562, 0, 0, 0.999972, 0.177555, 0, 6.64171e-05, 0.999914, 0.177536, 0, 0.0012276, 0.999787, 0.177496, 0, 0.00388025, 0.999556, 0.17742, 0, 0.00783463, 0.999165, 0.177285, 0, 0.0128953, 0.9985, 0.177037, 0, 0.0189053, 0.995388, 0.175634, 0, 0.025742, 0.993102, 0.174375, 0, 0.033309, 0.990992, 0.173121, 0, 0.0415298, 0.986932, 0.170896, 0, 0.0503425, 0.982786, 0.16847, 0, 0.0596964, 0.977592, 0.165455, 0, 0.0695498, 0.971075, 0.161676, 0, 0.0798676, 0.963967, 0.157458, 0, 0.0906201, 0.956397, 0.152836, 0, 0.101783, 0.947489, 0.147467, 0, 0.113333, 0.937564, 0.14145, 0, 0.125254, 0.928182, 0.135383, 0, 0.137529, 0.919027, 0.129212, 0, 0.150144, 0.909618, 0.12276, 0, 0.163088, 0.900492, 0.116273, 0, 0.176351, 0.891671, 0.1098, 0, 0.189924, 0.883146, 0.103362, 0, 0.203799, 0.875151, 0.0970799, 0, 0.21797, 0.868338, 0.0911732, 0, 0.232433, 0.862033, 0.0854966, 0, 0.247182, 0.856107, 0.0800691, 0, 0.262216, 0.850644, 0.0749618, 0, 0.27753, 0.845261, 0.070079, 0, 0.293124, 0.839885, 0.0654321, 0, 0.308997, 0.834609, 0.0610975, 0, 0.325149, 0.829083, 0.0569741, 0, 0.341581, 0.82404, 0.0531736, 0, 0.358294, 0.818968, 0.049665, 0, 0.37529, 0.813496, 0.0463856, 0, 0.392573, 0.807533, 0.0433217, 0, 0.410148, 0.80099, 0.0404402, 0, 0.428019, 0.793891, 0.0377578, 0, 0.446192, 0.786281, 0.0352616, 0, 0.464676, 0.778773, 0.0329577, 0, 0.483478, 0.770737, 0.030808, 0, 0.502608, 0.762094, 0.0287964, 0, 0.522079, 0.752898, 0.0269254, 0, 0.541905, 0.743306, 0.0251926, 0, 0.5621, 0.733416, 0.023595, 0, 0.582684, 0.723742, 0.0221155, 0, 0.603677, 0.713542, 0.0207435, 0, 0.625106, 0.702755, 0.019434, 0, 0.646998, 0.691484, 0.0182046, 0, 0.66939, 0.680531, 0.0170771, 0, 0.692324, 0.66953, 0.0160339, 0, 0.715849, 0.658126, 0.0150677, 0, 0.740028, 0.646933, 0.0141551, 0, 0.764937, 0.636107, 0.0133179, 0, 0.790673, 0.625271, 0.0125284, 0, 0.817358, 0.615225, 0.0117937, 0, 0.84515, 0.605678, 0.0111181, 0, 0.874244, 0.59583, 0.0104759, 0, 0.904828, 0.585704, 0.00986672, 0, 0.936508, 0.575413, 0.00929712, 0, 0.968254, 0.565373, 0.00876713, 0, 1, 1, 0.214058, 0, 0, 0.999999, 0.214058, 0, 0, 0.999994, 0.214055, 0, 0, 0.999966, 0.214039, 0, 0.000259642, 0.999893, 0.213998, 0, 0.00200075, 0.999737, 0.21391, 0, 0.00527775, 0.999449, 0.213745, 0, 0.00983959, 0.99896, 0.213458, 0, 0.0154755, 0.9979, 0.212855, 0, 0.0220249, 0.994278, 0.210779, 0, 0.0293654, 0.992254, 0.20926, 0, 0.0374021, 0.98881, 0.206908, 0, 0.0460604, 0.984715, 0.204009, 0, 0.0552802, 0.979738, 0.200471, 0, 0.0650127, 0.972884, 0.195813, 0, 0.0752175, 0.965996, 0.190856, 0, 0.0858612, 0.957974, 0.185077, 0, 0.0969155, 0.949155, 0.17868, 0, 0.108356, 0.939288, 0.171513, 0, 0.120163, 0.928996, 0.163838, 0, 0.132319, 0.919563, 0.156246, 0, 0.144808, 0.910004, 0.148359, 0, 0.157618, 0.900791, 0.140417, 0, 0.170737, 0.892135, 0.132569, 0, 0.184155, 0.883803, 0.124741, 0, 0.197866, 0.876034, 0.117091, 0, 0.211861, 0.869219, 0.109835, 0, 0.226134, 0.863062, 0.102859, 0, 0.240682, 0.857795, 0.0962928, 0, 0.255499, 0.853009, 0.0900725, 0, 0.270583, 0.848603, 0.0842101, 0, 0.285931, 0.844335, 0.0786527, 0, 0.301542, 0.840208, 0.0734397, 0, 0.317415, 0.836035, 0.0685334, 0, 0.33355, 0.83172, 0.0639275, 0, 0.349948, 0.827135, 0.0595909, 0, 0.36661, 0.822797, 0.0556204, 0, 0.383539, 0.818387, 0.0519394, 0, 0.400738, 0.813565, 0.0485317, 0, 0.41821, 0.808142, 0.0453138, 0, 0.435961, 0.802212, 0.0423354, 0, 0.453997, 0.79573, 0.0395553, 0, 0.472324, 0.788741, 0.036988, 0, 0.490951, 0.781093, 0.0345688, 0, 0.509887, 0.773597, 0.0323297, 0, 0.529144, 0.765622, 0.0302719, 0, 0.548735, 0.757083, 0.0283477, 0, 0.568674, 0.747992, 0.0265562, 0, 0.588979, 0.738591, 0.0248844, 0, 0.609671, 0.728719, 0.0233342, 0, 0.630773, 0.719146, 0.0219081, 0, 0.652314, 0.709165, 0.0205711, 0, 0.674328, 0.69875, 0.0193248, 0, 0.696854, 0.687884, 0.0181582, 0, 0.719942, 0.676818, 0.0170746, 0, 0.743651, 0.666247, 0.0160718, 0, 0.768057, 0.655284, 0.0151262, 0, 0.793253, 0.64401, 0.0142561, 0, 0.819363, 0.633353, 0.0134327, 0, 0.846547, 0.622674, 0.012653, 0, 0.875017, 0.612265, 0.0119354, 0, 0.905021, 0.602455, 0.0112533, 0, 0.936508, 0.593147, 0.0106234, 0, 0.968254, 0.583592, 0.0100213, 0, 1, 1, 0.25717, 0, 0, 1, 0.25717, 0, 0, 0.999992, 0.257164, 0, 0, 0.999958, 0.257135, 0, 0.000641715, 0.999864, 0.25706, 0, 0.00305314, 0.999666, 0.256897, 0, 0.00700975, 0.999302, 0.256596, 0, 0.0122194, 0.998663, 0.25607, 0, 0.0184622, 0.995607, 0.254123, 0, 0.0255773, 0.993094, 0.252081, 0, 0.0334439, 0.9907, 0.249867, 0, 0.0419696, 0.98594, 0.246118, 0, 0.0510823, 0.981214, 0.242049, 0, 0.0607242, 0.974966, 0.236869, 0, 0.0708486, 0.967589, 0.230724, 0, 0.081417, 0.95915, 0.223635, 0, 0.0923974, 0.950257, 0.21596, 0, 0.103763, 0.940165, 0.207296, 0, 0.115491, 0.929396, 0.197901, 0, 0.127562, 0.919288, 0.188437, 0, 0.13996, 0.909428, 0.178762, 0, 0.15267, 0.900105, 0.169072, 0, 0.165679, 0.891418, 0.159478, 0, 0.178979, 0.883347, 0.15002, 0, 0.192558, 0.875992, 0.140813, 0, 0.20641, 0.869466, 0.13196, 0, 0.220529, 0.863699, 0.123501, 0, 0.234907, 0.858553, 0.115436, 0, 0.249542, 0.854379, 0.107901, 0, 0.264428, 0.850894, 0.10088, 0, 0.279564, 0.847632, 0.0942296, 0, 0.294947, 0.844571, 0.0879861, 0, 0.310575, 0.84163, 0.0821534, 0, 0.326448, 0.838542, 0.0766409, 0, 0.342566, 0.835412, 0.0715322, 0, 0.358929, 0.831899, 0.0666883, 0, 0.37554, 0.828177, 0.0622175, 0, 0.392399, 0.82416, 0.0580452, 0, 0.409511, 0.820393, 0.054267, 0, 0.426878, 0.816068, 0.0507172, 0, 0.444506, 0.811201, 0.0474041, 0, 0.4624, 0.805785, 0.0443174, 0, 0.480566, 0.799878, 0.0414562, 0, 0.499013, 0.793469, 0.0388147, 0, 0.517749, 0.786473, 0.0363453, 0, 0.536785, 0.778874, 0.0340225, 0, 0.556134, 0.771277, 0.0318599, 0, 0.575809, 0.763426, 0.0298859, 0, 0.595827, 0.755044, 0.0280357, 0, 0.616207, 0.746161, 0.0262979, 0, 0.636973, 0.737124, 0.0247295, 0, 0.65815, 0.72761, 0.0232514, 0, 0.679772, 0.717822, 0.0218755, 0, 0.701876, 0.708279, 0.0205942, 0, 0.724509, 0.698333, 0.0193947, 0, 0.74773, 0.68802, 0.0182717, 0, 0.771609, 0.677321, 0.0172044, 0, 0.79624, 0.666504, 0.0162122, 0, 0.821743, 0.656184, 0.0152924, 0, 0.84828, 0.64556, 0.0144326, 0, 0.876069, 0.634636, 0.0136157, 0, 0.905404, 0.624124, 0.0128612, 0, 0.936508, 0.613914, 0.0121435, 0, 0.968254, 0.603589, 0.0114887, 0, 1, 1, 0.307946, 0, 0, 0.999999, 0.307945, 0, 0, 0.999988, 0.307934, 0, 2.04479e-05, 0.999944, 0.307886, 0, 0.00127833, 0.999824, 0.307756, 0, 0.00445047, 0.999565, 0.30748, 0, 0.00914673, 0.999085, 0.306966, 0, 0.0150498, 0.998103, 0.306004, 0, 0.0219367, 0.994249, 0.303028, 0, 0.0296485, 0.991807, 0.300435, 0, 0.038068, 0.987773, 0.296554, 0, 0.0471062, 0.982673, 0.2916, 0, 0.0566942, 0.976623, 0.285641, 0, 0.0667768, 0.968757, 0.27815, 0, 0.0773099, 0.959849, 0.269529, 0, 0.088257, 0.950663, 0.260248, 0, 0.0995879, 0.940129, 0.249704, 0, 0.111277, 0.92895, 0.238291, 0, 0.123304, 0.917996, 0.226501, 0, 0.13565, 0.907813, 0.214669, 0, 0.148299, 0.898305, 0.202835, 0, 0.161237, 0.889626, 0.191158, 0, 0.174455, 0.88175, 0.179695, 0, 0.187941, 0.874715, 0.168548, 0, 0.201687, 0.868746, 0.15792, 0, 0.215687, 0.863703, 0.147807, 0, 0.229933, 0.859315, 0.138149, 0, 0.24442, 0.855538, 0.128993, 0, 0.259145, 0.852428, 0.120414, 0, 0.274103, 0.850168, 0.112498, 0, 0.289293, 0.848132, 0.105054, 0, 0.304711, 0.846291, 0.0981087, 0, 0.320357, 0.844431, 0.0915942, 0, 0.33623, 0.842493, 0.0855056, 0, 0.35233, 0.840368, 0.0798204, 0, 0.368658, 0.83798, 0.0745097, 0, 0.385214, 0.83523, 0.0695424, 0, 0.402002, 0.832091, 0.0649092, 0, 0.419023, 0.828667, 0.0606291, 0, 0.436282, 0.824805, 0.0566523, 0, 0.453782, 0.820988, 0.0530229, 0, 0.471529, 0.816635, 0.0496364, 0, 0.489528, 0.811725, 0.0464658, 0, 0.507788, 0.806316, 0.0435082, 0, 0.526317, 0.800469, 0.0407873, 0, 0.545124, 0.794107, 0.038255, 0, 0.564221, 0.787218, 0.0358825, 0, 0.583621, 0.779872, 0.0336785, 0, 0.603341, 0.772097, 0.0316379, 0, 0.623397, 0.764484, 0.0297379, 0, 0.643812, 0.756428, 0.0279581, 0, 0.664611, 0.748022, 0.0263153, 0, 0.685824, 0.739268, 0.0247799, 0, 0.707488, 0.73024, 0.0233385, 0, 0.729646, 0.720893, 0.0220035, 0, 0.752354, 0.71119, 0.0207555, 0, 0.77568, 0.701791, 0.0195843, 0, 0.799715, 0.692184, 0.0184891, 0, 0.824574, 0.682258, 0.0174541, 0, 0.850417, 0.67206, 0.0164873, 0, 0.877466, 0.661717, 0.0155959, 0, 0.90604, 0.651462, 0.0147519, 0, 0.936528, 0.641467, 0.0139727, 0, 0.968254, 0.631229, 0.0132363, 0, 1, 1, 0.367573, 0, 0, 0.999999, 0.367571, 0, 0, 0.999984, 0.367553, 0, 0.000183382, 0.999925, 0.367473, 0, 0.00225254, 0.999759, 0.367259, 0, 0.00628165, 0.99941, 0.366801, 0, 0.0117858, 0.998739, 0.365946, 0, 0.0184359, 0.995529, 0.363191, 0, 0.0260114, 0.992875, 0.360171, 0, 0.0343581, 0.989135, 0.355981, 0, 0.0433637, 0.984166, 0.350401, 0, 0.0529438, 0.977871, 0.343348, 0, 0.0630334, 0.96951, 0.334341, 0, 0.0735805, 0.959964, 0.323862, 0, 0.0845437, 0.950162, 0.312521, 0, 0.095889, 0.938882, 0.299577, 0, 0.107588, 0.926992, 0.285573, 0, 0.119617, 0.915589, 0.271212, 0, 0.131957, 0.904791, 0.256611, 0, 0.144591, 0.895177, 0.242224, 0, 0.157503, 0.886403, 0.227952, 0, 0.170682, 0.878957, 0.214192, 0, 0.184117, 0.872418, 0.200795, 0, 0.197799, 0.867029, 0.188015, 0, 0.21172, 0.862835, 0.175975, 0, 0.225873, 0.859411, 0.164526, 0, 0.240253, 0.856655, 0.153693, 0, 0.254854, 0.854519, 0.14352, 0, 0.269673, 0.852828, 0.13397, 0, 0.284707, 0.851412, 0.124984, 0, 0.299953, 0.850609, 0.116748, 0, 0.315408, 0.849855, 0.10905, 0, 0.331073, 0.849017, 0.101839, 0, 0.346946, 0.848079, 0.0951359, 0, 0.363028, 0.846911, 0.0888774, 0, 0.379318, 0.845445, 0.0830375, 0, 0.395818, 0.84362, 0.0775844, 0, 0.41253, 0.841411, 0.0725054, 0, 0.429457, 0.838768, 0.0677691, 0, 0.446602, 0.835801, 0.0634016, 0, 0.463968, 0.832341, 0.0593095, 0, 0.481561, 0.828424, 0.0555121, 0, 0.499386, 0.824312, 0.052024, 0, 0.51745, 0.819918, 0.0487865, 0, 0.535761, 0.815072, 0.0457801, 0, 0.554328, 0.809863, 0.0430184, 0, 0.573162, 0.804164, 0.0404245, 0, 0.592275, 0.798034, 0.0380146, 0, 0.611681, 0.791436, 0.0357436, 0, 0.631398, 0.784498, 0.0336475, 0, 0.651445, 0.777125, 0.0316666, 0, 0.671845, 0.769365, 0.0298122, 0, 0.692628, 0.761579, 0.0281001, 0, 0.713827, 0.753746, 0.0265049, 0, 0.735484, 0.745573, 0.0250067, 0, 0.75765, 0.737083, 0.0236026, 0, 0.78039, 0.728545, 0.0223302, 0, 0.803789, 0.719691, 0.0211243, 0, 0.82796, 0.710569, 0.0199983, 0, 0.853056, 0.701216, 0.0189569, 0, 0.879298, 0.692094, 0.0179702, 0, 0.907014, 0.682909, 0.0170418, 0, 0.936691, 0.673509, 0.0161732, 0, 0.968254, 0.663863, 0.0153406, 0, 1, 1, 0.437395, 0, 0, 0.999998, 0.437394, 0, 0, 0.99998, 0.437363, 0, 0.000616704, 0.999891, 0.437232, 0, 0.00367925, 0.999656, 0.436877, 0, 0.00867446, 0.999148, 0.436121, 0, 0.0150679, 0.997959, 0.434564, 0, 0.022531, 0.993464, 0.430134, 0, 0.0308507, 0.990606, 0.426077, 0, 0.0398805, 0.985027, 0.419397, 0, 0.0495148, 0.978491, 0.41118, 0, 0.0596749, 0.969643, 0.40048, 0, 0.0703001, 0.959189, 0.38769, 0, 0.0813427, 0.948223, 0.373575, 0, 0.0927641, 0.935955, 0.357622, 0, 0.104533, 0.923237, 0.34043, 0, 0.116624, 0.911074, 0.322735, 0, 0.129015, 0.899724, 0.30479, 0, 0.141687, 0.890189, 0.287392, 0, 0.154626, 0.881796, 0.270248, 0, 0.167818, 0.874781, 0.253659, 0, 0.181252, 0.869166, 0.237786, 0, 0.194918, 0.864725, 0.222618, 0, 0.208807, 0.861565, 0.208356, 0, 0.222913, 0.859284, 0.194867, 0, 0.237229, 0.857677, 0.18212, 0, 0.25175, 0.856714, 0.17018, 0, 0.266473, 0.856155, 0.158969, 0, 0.281392, 0.8558, 0.148413, 0, 0.296505, 0.855672, 0.138578, 0, 0.311811, 0.855538, 0.129345, 0, 0.327306, 0.855689, 0.120861, 0, 0.342991, 0.855767, 0.112969, 0, 0.358864, 0.855618, 0.105593, 0, 0.374925, 0.85525, 0.0987451, 0, 0.391176, 0.854583, 0.0923727, 0, 0.407616, 0.853534, 0.0864143, 0, 0.424249, 0.852061, 0.0808338, 0, 0.441076, 0.850253, 0.0756771, 0, 0.4581, 0.848004, 0.0708612, 0, 0.475324, 0.845333, 0.0663784, 0, 0.492754, 0.842376, 0.0622631, 0, 0.510394, 0.838956, 0.0584112, 0, 0.528251, 0.835121, 0.0548328, 0, 0.546331, 0.830842, 0.0514838, 0, 0.564644, 0.826212, 0.048355, 0, 0.583198, 0.821522, 0.0454714, 0, 0.602005, 0.816551, 0.0428263, 0, 0.621078, 0.811211, 0.0403612, 0, 0.640434, 0.805479, 0.038039, 0, 0.660089, 0.799409, 0.0358739, 0, 0.680066, 0.79306, 0.0338727, 0, 0.70039, 0.786395, 0.0319985, 0, 0.721094, 0.779416, 0.030241, 0, 0.742215, 0.77214, 0.0285951, 0, 0.7638, 0.764636, 0.0270747, 0, 0.785912, 0.756836, 0.0256354, 0, 0.808628, 0.749315, 0.0243027, 0, 0.832055, 0.741561, 0.0230497, 0, 0.856338, 0.733589, 0.0218801, 0, 0.88169, 0.725479, 0.020784, 0, 0.908441, 0.717255, 0.0197702, 0, 0.937125, 0.708829, 0.0188168, 0, 0.968254, 0.700191, 0.0179113, 0, 1, 1, 0.518937, 0, 0, 0.999998, 0.518933, 0, 0, 0.999967, 0.518883, 0, 0.00147741, 0.999832, 0.51866, 0, 0.00573221, 0.999466, 0.518057, 0, 0.011826, 0.998644, 0.516752, 0, 0.0192116, 0.994458, 0.512347, 0, 0.027573, 0.991223, 0.507675, 0, 0.0367099, 0.985515, 0.500188, 0, 0.046487, 0.978308, 0.490408, 0, 0.0568071, 0.968359, 0.477357, 0, 0.0675984, 0.95682, 0.461752, 0, 0.0788059, 0.943929, 0.443796, 0, 0.090386, 0.930224, 0.423893, 0, 0.102304, 0.916514, 0.402682, 0, 0.114532, 0.903653, 0.380914, 0, 0.127047, 0.892315, 0.359212, 0, 0.139828, 0.882942, 0.338102, 0, 0.152861, 0.875438, 0.31773, 0, 0.16613, 0.869642, 0.298186, 0, 0.179624, 0.865304, 0.279491, 0, 0.193332, 0.862382, 0.261804, 0, 0.207247, 0.860666, 0.245146, 0, 0.22136, 0.859788, 0.229406, 0, 0.235666, 0.859608, 0.214605, 0, 0.250158, 0.859912, 0.200691, 0, 0.264832, 0.86053, 0.187623, 0, 0.279684, 0.861368, 0.17539, 0, 0.294711, 0.862237, 0.163901, 0, 0.309911, 0.863127, 0.153175, 0, 0.32528, 0.863923, 0.143147, 0, 0.340819, 0.864567, 0.133781, 0, 0.356524, 0.865013, 0.125042, 0, 0.372397, 0.86539, 0.116952, 0, 0.388438, 0.865591, 0.109476, 0, 0.404645, 0.865517, 0.102542, 0, 0.421022, 0.865084, 0.0960688, 0, 0.437569, 0.864309, 0.0900499, 0, 0.454287, 0.863151, 0.0844328, 0, 0.471181, 0.861649, 0.0792218, 0, 0.488253, 0.859742, 0.0743482, 0, 0.505507, 0.857446, 0.0697963, 0, 0.522947, 0.854757, 0.0655364, 0, 0.54058, 0.851783, 0.061608, 0, 0.558412, 0.848516, 0.0579701, 0, 0.576449, 0.844897, 0.0545742, 0, 0.594701, 0.840956, 0.0514167, 0, 0.613178, 0.836676, 0.0484598, 0, 0.631892, 0.832075, 0.0456934, 0, 0.650856, 0.827191, 0.0431178, 0, 0.670088, 0.822295, 0.0407718, 0, 0.689606, 0.817294, 0.0386032, 0, 0.709434, 0.812013, 0.0365675, 0, 0.7296, 0.806465, 0.0346547, 0, 0.750138, 0.800691, 0.0328717, 0, 0.771093, 0.794709, 0.031211, 0, 0.792519, 0.788493, 0.0296504, 0, 0.814488, 0.782049, 0.0281782, 0, 0.837097, 0.775403, 0.0267965, 0, 0.860481, 0.76857, 0.0255002, 0, 0.884842, 0.761536, 0.0242759, 0, 0.910494, 0.754303, 0.0231142, 0, 0.937985, 0.74692, 0.0220305, 0, 0.968254, 0.739745, 0.0210192, 0, 1, 1, 0.613914, 0, 0, 0.999996, 0.613907, 0, 9.63597e-05, 0.999942, 0.613814, 0, 0.00301247, 0.999704, 0.613407, 0, 0.00870385, 0.999046, 0.612302, 0, 0.0160714, 0.995516, 0.608266, 0, 0.0245899, 0.991726, 0.602863, 0, 0.0339681, 0.985157, 0.593956, 0, 0.0440254, 0.97642, 0.581748, 0, 0.0546409, 0.964404, 0.565183, 0, 0.0657284, 0.950601, 0.545273, 0, 0.0772246, 0.935158, 0.522129, 0, 0.0890812, 0.919364, 0.496782, 0, 0.10126, 0.904754, 0.470571, 0, 0.113731, 0.89176, 0.444037, 0, 0.126469, 0.881492, 0.418322, 0, 0.139454, 0.873656, 0.393522, 0, 0.15267, 0.868053, 0.369795, 0, 0.166101, 0.864336, 0.347171, 0, 0.179736, 0.862259, 0.325737, 0, 0.193565, 0.861556, 0.305532, 0, 0.207578, 0.861776, 0.286416, 0, 0.221769, 0.862661, 0.268355, 0, 0.23613, 0.864015, 0.251334, 0, 0.250656, 0.865711, 0.235352, 0, 0.265343, 0.867519, 0.220302, 0, 0.280187, 0.869351, 0.206161, 0, 0.295183, 0.871144, 0.192908, 0, 0.31033, 0.872839, 0.180505, 0, 0.325624, 0.874307, 0.168848, 0, 0.341065, 0.875667, 0.158021, 0, 0.35665, 0.876758, 0.147877, 0, 0.37238, 0.87764, 0.138441, 0, 0.388253, 0.878237, 0.129627, 0, 0.404269, 0.878563, 0.121415, 0, 0.42043, 0.878572, 0.113741, 0, 0.436735, 0.87842, 0.106652, 0, 0.453187, 0.878057, 0.100097, 0, 0.469786, 0.877413, 0.0940128, 0, 0.486536, 0.87646, 0.0883462, 0, 0.503439, 0.875233, 0.0830924, 0, 0.520498, 0.8737, 0.0781975, 0, 0.537717, 0.871873, 0.07364, 0, 0.555102, 0.86978, 0.0694103, 0, 0.572657, 0.867405, 0.0654696, 0, 0.59039, 0.864751, 0.0617914, 0, 0.608307, 0.861818, 0.0583491, 0, 0.626419, 0.858645, 0.0551443, 0, 0.644733, 0.855307, 0.0521894, 0, 0.663264, 0.851736, 0.0494334, 0, 0.682025, 0.847927, 0.0468504, 0, 0.701032, 0.843888, 0.0444261, 0, 0.720308, 0.839629, 0.0421497, 0, 0.739875, 0.835158, 0.0400082, 0, 0.759764, 0.830509, 0.0380076, 0, 0.780014, 0.825714, 0.0361488, 0, 0.800673, 0.820729, 0.0343956, 0, 0.821803, 0.815751, 0.0327781, 0, 0.843492, 0.810752, 0.031275, 0, 0.86586, 0.805587, 0.0298542, 0, 0.889087, 0.800317, 0.0285397, 0, 0.913466, 0.79489, 0.0272948, 0, 0.93952, 0.789314, 0.0261139, 0, 0.96835, 0.783593, 0.0249938, 0, 1, 1, 0.724258, 0, 0, 0.999992, 0.724243, 0, 0.000726889, 0.99987, 0.724044, 0, 0.00569574, 0.999336, 0.72317, 0, 0.0131702, 0.996271, 0.719432, 0, 0.0220738, 0.991159, 0.712576, 0, 0.0319405, 0.982465, 0.700927, 0, 0.0425202, 0.97049, 0.684297, 0, 0.0536599, 0.953973, 0.661244, 0, 0.065258, 0.935546, 0.633804, 0, 0.0772427, 0.916596, 0.603071, 0, 0.0895616, 0.899353, 0.57105, 0, 0.102175, 0.885216, 0.539206, 0, 0.11505, 0.875076, 0.508714, 0, 0.128164, 0.868334, 0.479571, 0, 0.141495, 0.864414, 0.451796, 0, 0.155026, 0.862678, 0.425328, 0, 0.168745, 0.862835, 0.400352, 0, 0.182639, 0.864067, 0.376532, 0, 0.196699, 0.866086, 0.35391, 0, 0.210915, 0.868557, 0.332424, 0, 0.225282, 0.871271, 0.312053, 0, 0.239792, 0.874058, 0.292764, 0, 0.25444, 0.8768, 0.27453, 0, 0.269223, 0.87939, 0.257297, 0, 0.284135, 0.8819, 0.24114, 0, 0.299174, 0.884187, 0.225934, 0, 0.314337, 0.886262, 0.211669, 0, 0.329622, 0.888119, 0.198311, 0, 0.345026, 0.889709, 0.185783, 0, 0.360549, 0.891054, 0.174063, 0, 0.376189, 0.892196, 0.163143, 0, 0.391946, 0.893101, 0.152952, 0, 0.407819, 0.893803, 0.143475, 0, 0.423808, 0.894277, 0.134647, 0, 0.439914, 0.894532, 0.126434, 0, 0.456137, 0.894576, 0.1188, 0, 0.472479, 0.894393, 0.111694, 0, 0.48894, 0.893976, 0.105069, 0, 0.505523, 0.893346, 0.0989077, 0, 0.52223, 0.892502, 0.0931724, 0, 0.539064, 0.891441, 0.0878276, 0, 0.556028, 0.890276, 0.082903, 0, 0.573125, 0.888972, 0.0783505, 0, 0.590361, 0.887469, 0.0741083, 0, 0.607741, 0.885785, 0.0701633, 0, 0.62527, 0.883914, 0.0664835, 0, 0.642957, 0.881872, 0.0630567, 0, 0.660809, 0.879651, 0.0598527, 0, 0.678836, 0.877267, 0.0568615, 0, 0.69705, 0.874717, 0.05406, 0, 0.715465, 0.872012, 0.0514378, 0, 0.734098, 0.869157, 0.0489805, 0, 0.752968, 0.866155, 0.0466727, 0, 0.772101, 0.863014, 0.0445056, 0, 0.791529, 0.859748, 0.0424733, 0, 0.81129, 0.856416, 0.0405957, 0, 0.831438, 0.852958, 0.0388273, 0, 0.852044, 0.849382, 0.0371619, 0, 0.87321, 0.845694, 0.0355959, 0, 0.89509, 0.841893, 0.0341155, 0, 0.917932, 0.837981, 0.0327141, 0, 0.942204, 0.833963, 0.0313856, 0, 0.968981, 0.829847, 0.0301275, 0, 1, 1, 0.85214, 0, 0, 0.999969, 0.852095, 0, 0.00279627, 0.999483, 0.851408, 0, 0.0107635, 0.994545, 0.84579, 0, 0.0206454, 0.986188, 0.835231, 0, 0.0315756, 0.969847, 0.814687, 0, 0.0432021, 0.945951, 0.783735, 0, 0.0553396, 0.91917, 0.746074, 0, 0.0678766, 0.895488, 0.706938, 0, 0.0807395, 0.878232, 0.669534, 0, 0.0938767, 0.868252, 0.635168, 0, 0.10725, 0.863873, 0.603069, 0, 0.120832, 0.863369, 0.572514, 0, 0.134598, 0.86545, 0.543169, 0, 0.148533, 0.868803, 0.514578, 0, 0.16262, 0.872794, 0.486762, 0, 0.176849, 0.87702, 0.459811, 0, 0.19121, 0.881054, 0.433654, 0, 0.205694, 0.884974, 0.408574, 0, 0.220294, 0.888587, 0.384525, 0, 0.235005, 0.891877, 0.36156, 0, 0.24982, 0.894793, 0.339661, 0, 0.264737, 0.89743, 0.318913, 0, 0.279751, 0.899796, 0.299302, 0, 0.294859, 0.901943, 0.280843, 0, 0.310058, 0.903858, 0.263481, 0, 0.325346, 0.905574, 0.247197, 0, 0.340721, 0.907069, 0.231915, 0, 0.356181, 0.908379, 0.217614, 0, 0.371725, 0.90952, 0.20425, 0, 0.387353, 0.910483, 0.191758, 0, 0.403063, 0.91128, 0.180092, 0, 0.418854, 0.911936, 0.169222, 0, 0.434727, 0.912454, 0.159098, 0, 0.450682, 0.912835, 0.149668, 0, 0.466718, 0.913078, 0.140884, 0, 0.482837, 0.913192, 0.132709, 0, 0.499038, 0.913175, 0.125095, 0, 0.515324, 0.91304, 0.118012, 0, 0.531695, 0.912781, 0.111417, 0, 0.548153, 0.91241, 0.105281, 0, 0.5647, 0.911924, 0.0995691, 0, 0.581338, 0.911331, 0.0942531, 0, 0.59807, 0.910637, 0.0893076, 0, 0.6149, 0.90984, 0.0846998, 0, 0.63183, 0.908941, 0.0804044, 0, 0.648865, 0.907944, 0.0763984, 0, 0.666011, 0.906857, 0.0726638, 0, 0.683273, 0.90568, 0.0691783, 0, 0.700659, 0.904416, 0.0659222, 0, 0.718176, 0.903067, 0.0628782, 0, 0.735834, 0.901637, 0.0600307, 0, 0.753646, 0.900128, 0.0573647, 0, 0.771625, 0.898544, 0.0548668, 0, 0.78979, 0.89689, 0.052527, 0, 0.808162, 0.895165, 0.0503306, 0, 0.826771, 0.893371, 0.0482668, 0, 0.845654, 0.891572, 0.0463605, 0, 0.864863, 0.889763, 0.0445998, 0, 0.884472, 0.887894, 0.0429451, 0, 0.904592, 0.885967, 0.0413884, 0, 0.925407, 0.883984, 0.0399225, 0, 0.947271, 0.881945, 0.0385405, 0, 0.97105, 0.879854, 0.0372362, 0, 1, 0.999804, 0.995833, 0, 0, 0.938155, 0.933611, 0, 0.0158731, 0.864755, 0.854311, 0, 0.0317461, 0.888594, 0.865264, 0, 0.0476191, 0.905575, 0.863922, 0, 0.0634921, 0.915125, 0.850558, 0, 0.0793651, 0.920665, 0.829254, 0, 0.0952381, 0.924073, 0.802578, 0, 0.111111, 0.926304, 0.772211, 0, 0.126984, 0.927829, 0.739366, 0, 0.142857, 0.928924, 0.705033, 0, 0.15873, 0.92973, 0.670019, 0, 0.174603, 0.930339, 0.634993, 0, 0.190476, 0.930811, 0.600485, 0, 0.206349, 0.931191, 0.566897, 0, 0.222222, 0.93149, 0.534485, 0, 0.238095, 0.931737, 0.503429, 0, 0.253968, 0.931939, 0.473811, 0, 0.269841, 0.932108, 0.445668, 0, 0.285714, 0.93225, 0.418993, 0, 0.301587, 0.932371, 0.393762, 0, 0.31746, 0.932474, 0.369939, 0, 0.333333, 0.932562, 0.347479, 0, 0.349206, 0.932638, 0.326336, 0, 0.365079, 0.932703, 0.306462, 0, 0.380952, 0.93276, 0.287805, 0, 0.396825, 0.932809, 0.270313, 0, 0.412698, 0.932851, 0.253933, 0, 0.428571, 0.932887, 0.23861, 0, 0.444444, 0.932917, 0.224289, 0, 0.460317, 0.932943, 0.210917, 0, 0.47619, 0.932965, 0.19844, 0, 0.492063, 0.932982, 0.186807, 0, 0.507937, 0.932995, 0.175966, 0, 0.52381, 0.933005, 0.165869, 0, 0.539683, 0.933011, 0.156468, 0, 0.555556, 0.933013, 0.147719, 0, 0.571429, 0.933013, 0.139579, 0, 0.587302, 0.93301, 0.132007, 0, 0.603175, 0.933004, 0.124965, 0, 0.619048, 0.932994, 0.118416, 0, 0.634921, 0.932982, 0.112326, 0, 0.650794, 0.932968, 0.106663, 0, 0.666667, 0.93295, 0.101397, 0, 0.68254, 0.932931, 0.0964993, 0, 0.698413, 0.932908, 0.0919438, 0, 0.714286, 0.932883, 0.0877057, 0, 0.730159, 0.932856, 0.0837623, 0, 0.746032, 0.932827, 0.0800921, 0, 0.761905, 0.932796, 0.0766754, 0, 0.777778, 0.932762, 0.0734936, 0, 0.793651, 0.932727, 0.0705296, 0, 0.809524, 0.932689, 0.0677676, 0, 0.825397, 0.93265, 0.0651929, 0, 0.84127, 0.932609, 0.0627917, 0, 0.857143, 0.932565, 0.0605515, 0, 0.873016, 0.932521, 0.0584606, 0, 0.888889, 0.932474, 0.0565082, 0, 0.904762, 0.932427, 0.0546841, 0, 0.920635, 0.932377, 0.0529793, 0, 0.936508, 0.932326, 0.0513851, 0, 0.952381, 0.932274, 0.0498936, 0, 0.968254, 0.93222, 0.0484975, 0, 0.984127, 0.932164, 0.0471899, 0, 1 ];

	// data textures

	var ltc_1 = new THREE.DataTexture( new Float32Array( LTC_MAT_1 ), 64, 64, THREE.RGBAFormat, THREE.FloatType, THREE.UVMapping, THREE.ClampToEdgeWrapping, THREE.ClampToEdgeWrapping, THREE.LinearFilter, THREE.NearestFilter, 1 );

	var ltc_2 = new THREE.DataTexture( new Float32Array( LTC_MAT_2 ), 64, 64, THREE.RGBAFormat, THREE.FloatType, THREE.UVMapping, THREE.ClampToEdgeWrapping, THREE.ClampToEdgeWrapping, THREE.LinearFilter, THREE.NearestFilter, 1 );

	ltc_1.needsUpdate = true;
	ltc_2.needsUpdate = true;

	THREE.UniformsLib.LTC_1 = ltc_1;
	THREE.UniformsLib.LTC_2 = ltc_2;

	// add ltc data textures to material uniforms

	var ltc = { ltc_1: { value: null }, ltc_2: { value: null } };

	Object.assign( THREE.ShaderLib.standard.uniforms, ltc );
	Object.assign( THREE.ShaderLib.physical.uniforms, ltc );

} )()

;(function() {

"use strict";

var root = this

var has_require = typeof require !== 'undefined'

var THREE = root.THREE || has_require && require('three')
if( !THREE )
	throw new Error( 'MeshLine requires three.js' )

function MeshLine() {

	this.positions = [];

	this.previous = [];
	this.next = [];
	this.side = [];
	this.width = [];
	this.indices_array = [];
	this.uvs = [];
	this.counters = [];
	this.geometry = new THREE.BufferGeometry();

	this.widthCallback = null;

	// Used to raycast
	this.matrixWorld = new THREE.Matrix4();
}

MeshLine.prototype.setMatrixWorld = function(matrixWorld) {
	this.matrixWorld = matrixWorld;
}


MeshLine.prototype.setGeometry = function( g, c ) {
	
	this.widthCallback = c;

	this.positions = [];
	this.counters = [];
	// g.computeBoundingBox();
	// g.computeBoundingSphere();

	// set the normals
	// g.computeVertexNormals();
	if( g instanceof THREE.Geometry ) {
		for( var j = 0; j < g.vertices.length; j++ ) {
			var v = g.vertices[ j ];
			var c = j/g.vertices.length;
			this.positions.push( v.x, v.y, v.z );
			this.positions.push( v.x, v.y, v.z );
			this.counters.push(c);
			this.counters.push(c);
		}
	}

	if( g instanceof THREE.BufferGeometry ) {
		// read attribute positions ?
	}

	if( g instanceof Float32Array || g instanceof Array ) {
		for( var j = 0; j < g.length; j += 3 ) {
			var c = j/g.length;
			this.positions.push( g[ j ], g[ j + 1 ], g[ j + 2 ] );
			this.positions.push( g[ j ], g[ j + 1 ], g[ j + 2 ] );
			this.counters.push(c);
			this.counters.push(c);
		}
	}

	this.process();

}

MeshLine.prototype.raycast = ( function () {

	var inverseMatrix = new THREE.Matrix4();
	var ray = new THREE.Ray();
	var sphere = new THREE.Sphere();

	return function raycast( raycaster, intersects ) {

		var precision = raycaster.linePrecision;
		var precisionSq = precision * precision;

		var geometry = this.geometry;

		if ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();

		// Checking boundingSphere distance to ray

		sphere.copy( geometry.boundingSphere );
		sphere.applyMatrix4( this.matrixWorld );

		if ( raycaster.ray.intersectSphere( sphere ) === false ) {

			return;

		}

		inverseMatrix.getInverse( this.matrixWorld );
		ray.copy( raycaster.ray ).applyMatrix4( inverseMatrix );

		var vStart = new THREE.Vector3();
		var vEnd = new THREE.Vector3();
		var interSegment = new THREE.Vector3();
		var interRay = new THREE.Vector3();
		var step = this instanceof THREE.LineSegments ? 2 : 1;

		if ( geometry instanceof THREE.BufferGeometry ) {

			var index = geometry.index;
			var attributes = geometry.attributes;

			if ( index !== null ) {

				var indices = index.array;
				var positions = attributes.position.array;

				for ( var i = 0, l = indices.length - 1; i < l; i += step ) {

					var a = indices[ i ];
					var b = indices[ i + 1 ];

					vStart.fromArray( positions, a * 3 );
					vEnd.fromArray( positions, b * 3 );

					var distSq = ray.distanceSqToSegment( vStart, vEnd, interRay, interSegment );

					if ( distSq > precisionSq ) continue;

					interRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation

					var distance = raycaster.ray.origin.distanceTo( interRay );

					if ( distance < raycaster.near || distance > raycaster.far ) continue;

					intersects.push( {

						distance: distance,
						// What do we want? intersection point on the ray or on the segment??
						// point: raycaster.ray.at( distance ),
						point: interSegment.clone().applyMatrix4( this.matrixWorld ),
						index: i,
						face: null,
						faceIndex: null,
						object: this

					} );

				}

			} else {

				var positions = attributes.position.array;

				for ( var i = 0, l = positions.length / 3 - 1; i < l; i += step ) {

					vStart.fromArray( positions, 3 * i );
					vEnd.fromArray( positions, 3 * i + 3 );

					var distSq = ray.distanceSqToSegment( vStart, vEnd, interRay, interSegment );

					if ( distSq > precisionSq ) continue;

					interRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation

					var distance = raycaster.ray.origin.distanceTo( interRay );

					if ( distance < raycaster.near || distance > raycaster.far ) continue;

					intersects.push( {

						distance: distance,
						// What do we want? intersection point on the ray or on the segment??
						// point: raycaster.ray.at( distance ),
						point: interSegment.clone().applyMatrix4( this.matrixWorld ),
						index: i,
						face: null,
						faceIndex: null,
						object: this

					} );

				}

			}

		} else if ( geometry instanceof THREE.Geometry ) {

			var vertices = geometry.vertices;
			var nbVertices = vertices.length;

			for ( var i = 0; i < nbVertices - 1; i += step ) {

				var distSq = ray.distanceSqToSegment( vertices[ i ], vertices[ i + 1 ], interRay, interSegment );

				if ( distSq > precisionSq ) continue;

				interRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation

				var distance = raycaster.ray.origin.distanceTo( interRay );

				if ( distance < raycaster.near || distance > raycaster.far ) continue;

				intersects.push( {

					distance: distance,
					// What do we want? intersection point on the ray or on the segment??
					// point: raycaster.ray.at( distance ),
					point: interSegment.clone().applyMatrix4( this.matrixWorld ),
					index: i,
					face: null,
					faceIndex: null,
					object: this

				} );

			}

		}

	};

}() );


MeshLine.prototype.compareV3 = function( a, b ) {

	var aa = a * 6;
	var ab = b * 6;
	return ( this.positions[ aa ] === this.positions[ ab ] ) && ( this.positions[ aa + 1 ] === this.positions[ ab + 1 ] ) && ( this.positions[ aa + 2 ] === this.positions[ ab + 2 ] );

}

MeshLine.prototype.copyV3 = function( a ) {

	var aa = a * 6;
	return [ this.positions[ aa ], this.positions[ aa + 1 ], this.positions[ aa + 2 ] ];

}

MeshLine.prototype.process = function() {

	var l = this.positions.length / 6;

	this.previous = [];
	this.next = [];
	this.side = [];
	this.width = [];
	this.indices_array = [];
	this.uvs = [];

	for( var j = 0; j < l; j++ ) {
		this.side.push( 1 );
		this.side.push( -1 );
	}

	var w;
	for( var j = 0; j < l; j++ ) {
		if( this.widthCallback ) w = this.widthCallback( j / ( l -1 ) );
		else w = 1;
		this.width.push( w );
		this.width.push( w );
	}

	for( var j = 0; j < l; j++ ) {
		this.uvs.push( j / ( l - 1 ), 0 );
		this.uvs.push( j / ( l - 1 ), 1 );
	}

	var v;

	if( this.compareV3( 0, l - 1 ) ){
		v = this.copyV3( l - 2 );
	} else {
		v = this.copyV3( 0 );
	}
	this.previous.push( v[ 0 ], v[ 1 ], v[ 2 ] );
	this.previous.push( v[ 0 ], v[ 1 ], v[ 2 ] );
	for( var j = 0; j < l - 1; j++ ) {
		v = this.copyV3( j );
		this.previous.push( v[ 0 ], v[ 1 ], v[ 2 ] );
		this.previous.push( v[ 0 ], v[ 1 ], v[ 2 ] );
	}

	for( var j = 1; j < l; j++ ) {
		v = this.copyV3( j );
		this.next.push( v[ 0 ], v[ 1 ], v[ 2 ] );
		this.next.push( v[ 0 ], v[ 1 ], v[ 2 ] );
	}

	if( this.compareV3( l - 1, 0 ) ){
		v = this.copyV3( 1 );
	} else {
		v = this.copyV3( l - 1 );
	}
	this.next.push( v[ 0 ], v[ 1 ], v[ 2 ] );
	this.next.push( v[ 0 ], v[ 1 ], v[ 2 ] );

	for( var j = 0; j < l - 1; j++ ) {
		var n = j * 2;
		this.indices_array.push( n, n + 1, n + 2 );
		this.indices_array.push( n + 2, n + 1, n + 3 );
	}

	if (!this.attributes) {
		this.attributes = {
			position: new THREE.BufferAttribute( new Float32Array( this.positions ), 3 ),
			previous: new THREE.BufferAttribute( new Float32Array( this.previous ), 3 ),
			next: new THREE.BufferAttribute( new Float32Array( this.next ), 3 ),
			side: new THREE.BufferAttribute( new Float32Array( this.side ), 1 ),
			width: new THREE.BufferAttribute( new Float32Array( this.width ), 1 ),
			uv: new THREE.BufferAttribute( new Float32Array( this.uvs ), 2 ),
			index: new THREE.BufferAttribute( new Uint16Array( this.indices_array ), 1 ),
			counters: new THREE.BufferAttribute( new Float32Array( this.counters ), 1 )
		}
	} else {
		this.attributes.position.copyArray(new Float32Array(this.positions));
		this.attributes.position.needsUpdate = true;
		this.attributes.previous.copyArray(new Float32Array(this.previous));
		this.attributes.previous.needsUpdate = true;
		this.attributes.next.copyArray(new Float32Array(this.next));
		this.attributes.next.needsUpdate = true;
		this.attributes.side.copyArray(new Float32Array(this.side));
		this.attributes.side.needsUpdate = true;
		this.attributes.width.copyArray(new Float32Array(this.width));
		this.attributes.width.needsUpdate = true;
		this.attributes.uv.copyArray(new Float32Array(this.uvs));
		this.attributes.uv.needsUpdate = true;
		this.attributes.index.copyArray(new Uint16Array(this.indices_array));
		this.attributes.index.needsUpdate = true;
	}

	this.geometry.addAttribute( 'position', this.attributes.position );
	this.geometry.addAttribute( 'previous', this.attributes.previous );
	this.geometry.addAttribute( 'next', this.attributes.next );
	this.geometry.addAttribute( 'side', this.attributes.side );
	this.geometry.addAttribute( 'width', this.attributes.width );
	this.geometry.addAttribute( 'uv', this.attributes.uv );
	this.geometry.addAttribute( 'counters', this.attributes.counters );

	this.geometry.setIndex( this.attributes.index );

}

function memcpy (src, srcOffset, dst, dstOffset, length) {
	var i

	src = src.subarray || src.slice ? src : src.buffer
	dst = dst.subarray || dst.slice ? dst : dst.buffer

	src = srcOffset ? src.subarray ?
	src.subarray(srcOffset, length && srcOffset + length) :
	src.slice(srcOffset, length && srcOffset + length) : src

	if (dst.set) {
		dst.set(src, dstOffset)
	} else {
		for (i=0; i<src.length; i++) {
			dst[i + dstOffset] = src[i]
		}
	}

	return dst
}

/**
 * Fast method to advance the line by one position.  The oldest position is removed.
 * @param position
 */
MeshLine.prototype.advance = function(position) {

	var positions = this.attributes.position.array;
	var previous = this.attributes.previous.array;
	var next = this.attributes.next.array;
	var l = positions.length;

	// PREVIOUS
	memcpy( positions, 0, previous, 0, l );

	// POSITIONS
	memcpy( positions, 6, positions, 0, l - 6 );

	positions[l - 6] = position.x;
	positions[l - 5] = position.y;
	positions[l - 4] = position.z;
	positions[l - 3] = position.x;
	positions[l - 2] = position.y;
	positions[l - 1] = position.z;

	// NEXT
	memcpy( positions, 6, next, 0, l - 6 );

	next[l - 6]  = position.x;
	next[l - 5]  = position.y;
	next[l - 4]  = position.z;
	next[l - 3]  = position.x;
	next[l - 2]  = position.y;
	next[l - 1]  = position.z;

	this.attributes.position.needsUpdate = true;
	this.attributes.previous.needsUpdate = true;
	this.attributes.next.needsUpdate = true;

};

THREE.ShaderChunk[ 'meshline_vert' ] = [
	'',
	THREE.ShaderChunk.logdepthbuf_pars_vertex,
	THREE.ShaderChunk.fog_pars_vertex,
	'',
	'attribute vec3 previous;',
	'attribute vec3 next;',
	'attribute float side;',
	'attribute float width;',
	'attribute float counters;',
	'',
	'uniform vec2 resolution;',
	'uniform float lineWidth;',
	'uniform vec3 color;',
	'uniform float opacity;',
	'uniform float near;',
	'uniform float far;',
	'uniform float sizeAttenuation;',
	'',
	'varying vec2 vUV;',
	'varying vec4 vColor;',
	'varying float vCounters;',
	'',
	'vec2 fix( vec4 i, float aspect ) {',
	'',
	'    vec2 res = i.xy / i.w;',
	'    res.x *= aspect;',
	'	 vCounters = counters;',
	'    return res;',
	'',
	'}',
	'',
	'void main() {',
	'',
	'    float aspect = resolution.x / resolution.y;',
	'    float pixelWidthRatio = 1. / (resolution.x * projectionMatrix[0][0]);',
	'',
	'    vColor = vec4( color, opacity );',
	'    vUV = uv;',
	'',
	'    mat4 m = projectionMatrix * modelViewMatrix;',
	'    vec4 finalPosition = m * vec4( position, 1.0 );',
	'    vec4 prevPos = m * vec4( previous, 1.0 );',
	'    vec4 nextPos = m * vec4( next, 1.0 );',
	'',
	'    vec2 currentP = fix( finalPosition, aspect );',
	'    vec2 prevP = fix( prevPos, aspect );',
	'    vec2 nextP = fix( nextPos, aspect );',
	'',
	'    float pixelWidth = finalPosition.w * pixelWidthRatio;',
	'    float w = 1.8 * pixelWidth * lineWidth * width;',
	'',
	'    if( sizeAttenuation == 1. ) {',
	'        w = 1.8 * lineWidth * width;',
	'    }',
	'',
	'    vec2 dir;',
	'    if( nextP == currentP ) dir = normalize( currentP - prevP );',
	'    else if( prevP == currentP ) dir = normalize( nextP - currentP );',
	'    else {',
	'        vec2 dir1 = normalize( currentP - prevP );',
	'        vec2 dir2 = normalize( nextP - currentP );',
	'        dir = normalize( dir1 + dir2 );',
	'',
	'        vec2 perp = vec2( -dir1.y, dir1.x );',
	'        vec2 miter = vec2( -dir.y, dir.x );',
	'        //w = clamp( w / dot( miter, perp ), 0., 4. * lineWidth * width );',
	'',
	'    }',
	'',
	'    //vec2 normal = ( cross( vec3( dir, 0. ), vec3( 0., 0., 1. ) ) ).xy;',
	'    vec2 normal = vec2( -dir.y, dir.x );',
	'    normal.x /= aspect;',
	'    normal *= .5 * w;',
	'',
	'    vec4 offset = vec4( normal * side, 0.0, 1.0 );',
	'    finalPosition.xy += offset.xy;',
	'',
	'    gl_Position = finalPosition;',
	'',
	THREE.ShaderChunk.logdepthbuf_vertex,
  THREE.ShaderChunk.fog_vertex && '    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );',
  THREE.ShaderChunk.fog_vertex,
	'}'
].join( '\r\n' );

THREE.ShaderChunk[ 'meshline_frag' ] = [
	'',
	THREE.ShaderChunk.fog_pars_fragment,
	THREE.ShaderChunk.logdepthbuf_pars_fragment,
	'',
	'uniform sampler2D map;',
	'uniform sampler2D alphaMap;',
	'uniform float useMap;',
	'uniform float useAlphaMap;',
	'uniform float useDash;',
	'uniform float dashArray;',
	'uniform float dashOffset;',
	'uniform float dashRatio;',
	'uniform float visibility;',
	'uniform float alphaTest;',
	'uniform vec2 repeat;',
	'',
	'varying vec2 vUV;',
	'varying vec4 vColor;',
	'varying float vCounters;',
	'',
	'void main() {',
	'',
	THREE.ShaderChunk.logdepthbuf_fragment,
	'',
	'    vec4 c = vColor;',
	'    if( useMap == 1. ) c *= texture2D( map, vUV * repeat );',
	'    if( useAlphaMap == 1. ) c.a *= texture2D( alphaMap, vUV * repeat ).a;',
	'    if( c.a < alphaTest ) discard;',
	'    if( useDash == 1. ){',
	'        c.a *= ceil(mod(vCounters + dashOffset, dashArray) - (dashArray * dashRatio));',
	'    }',
	'    gl_FragColor = c;',
	'    gl_FragColor.a *= step(vCounters, visibility);',
	'',
	THREE.ShaderChunk.fog_fragment,
	'}'
].join( '\r\n' );

function MeshLineMaterial( parameters ) {

	THREE.ShaderMaterial.call( this, {
		uniforms: Object.assign({},
			THREE.UniformsLib.fog,
			{
				lineWidth: { value: 1 },
				map: { value: null },
				useMap: { value: 0 },
				alphaMap: { value: null },
				useAlphaMap: { value: 0 },
				color: { value: new THREE.Color( 0xffffff ) },
				opacity: { value: 1 },
				resolution: { value: new THREE.Vector2( 1, 1 ) },
				sizeAttenuation: { value: 1 },
				near: { value: 1 },
				far: { value: 1 },
				dashArray: { value: 0 },
				dashOffset: { value: 0 },
				dashRatio: { value: 0.5 },
				useDash: { value: 0 },
				visibility: {value: 1 },
				alphaTest: {value: 0 },
				repeat: { value: new THREE.Vector2( 1, 1 ) },
			}
		),

		vertexShader: THREE.ShaderChunk.meshline_vert,

		fragmentShader: THREE.ShaderChunk.meshline_frag,

	} );

	this.type = 'MeshLineMaterial';

	Object.defineProperties( this, {
		lineWidth: {
			enumerable: true,
			get: function () {
				return this.uniforms.lineWidth.value;
			},
			set: function ( value ) {
				this.uniforms.lineWidth.value = value;
			}
		},
		map: {
			enumerable: true,
			get: function () {
				return this.uniforms.map.value;
			},
			set: function ( value ) {
				this.uniforms.map.value = value;
			}
		},
		useMap: {
			enumerable: true,
			get: function () {
				return this.uniforms.useMap.value;
			},
			set: function ( value ) {
				this.uniforms.useMap.value = value;
			}
		},
		alphaMap: {
			enumerable: true,
			get: function () {
				return this.uniforms.alphaMap.value;
			},
			set: function ( value ) {
				this.uniforms.alphaMap.value = value;
			}
		},
		useAlphaMap: {
			enumerable: true,
			get: function () {
				return this.uniforms.useAlphaMap.value;
			},
			set: function ( value ) {
				this.uniforms.useAlphaMap.value = value;
			}
		},
		color: {
			enumerable: true,
			get: function () {
				return this.uniforms.color.value;
			},
			set: function ( value ) {
				this.uniforms.color.value = value;
			}
		},
		opacity: {
			enumerable: true,
			get: function () {
				return this.uniforms.opacity.value;
			},
			set: function ( value ) {
				this.uniforms.opacity.value = value;
			}
		},
		resolution: {
			enumerable: true,
			get: function () {
				return this.uniforms.resolution.value;
			},
			set: function ( value ) {
				this.uniforms.resolution.value.copy( value );
			}
		},
		sizeAttenuation: {
			enumerable: true,
			get: function () {
				return this.uniforms.sizeAttenuation.value;
			},
			set: function ( value ) {
				this.uniforms.sizeAttenuation.value = value;
			}
		},
		near: {
			enumerable: true,
			get: function () {
				return this.uniforms.near.value;
			},
			set: function ( value ) {
				this.uniforms.near.value = value;
			}
		},
		far: {
			enumerable: true,
			get: function () {
				return this.uniforms.far.value;
			},
			set: function ( value ) {
				this.uniforms.far.value = value;
			}
		},
		dashArray: {
			enumerable: true,
			get: function () {
				return this.uniforms.dashArray.value;
			},
			set: function ( value ) {
				this.uniforms.dashArray.value = value;
				this.useDash = ( value !== 0 ) ? 1 : 0
			}
		},
		dashOffset: {
			enumerable: true,
			get: function () {
				return this.uniforms.dashOffset.value;
			},
			set: function ( value ) {
				this.uniforms.dashOffset.value = value;
			}
		},
		dashRatio: {
			enumerable: true,
			get: function () {
				return this.uniforms.dashRatio.value;
			},
			set: function ( value ) {
				this.uniforms.dashRatio.value = value;
			}
		},
		useDash: {
			enumerable: true,
			get: function () {
				return this.uniforms.useDash.value;
			},
			set: function ( value ) {
				this.uniforms.useDash.value = value;
			}
		},
		visibility: {
			enumerable: true,
			get: function () {
				return this.uniforms.visibility.value;
			},
			set: function ( value ) {
				this.uniforms.visibility.value = value;
			}
		},
		alphaTest: {
			enumerable: true,
			get: function () {
				return this.uniforms.alphaTest.value;
			},
			set: function ( value ) {
				this.uniforms.alphaTest.value = value;
			}
		},
		repeat: {
			enumerable: true,
			get: function () {
				return this.uniforms.repeat.value;
			},
			set: function ( value ) {
				this.uniforms.repeat.value.copy( value );
			}
		},
	});

	this.setValues( parameters );
}

MeshLineMaterial.prototype = Object.create( THREE.ShaderMaterial.prototype );
MeshLineMaterial.prototype.constructor = MeshLineMaterial;
MeshLineMaterial.prototype.isMeshLineMaterial = true;

MeshLineMaterial.prototype.copy = function ( source ) {

	THREE.ShaderMaterial.prototype.copy.call( this, source );

	this.lineWidth = source.lineWidth;
	this.map = source.map;
	this.useMap = source.useMap;
	this.alphaMap = source.alphaMap;
	this.useAlphaMap = source.useAlphaMap;
	this.color.copy( source.color );
	this.opacity = source.opacity;
	this.resolution.copy( source.resolution );
	this.sizeAttenuation = source.sizeAttenuation;
	this.near = source.near;
	this.far = source.far;
	this.dashArray.copy( source.dashArray );
	this.dashOffset.copy( source.dashOffset );
	this.dashRatio.copy( source.dashRatio );
	this.useDash = source.useDash;
	this.visibility = source.visibility;
	this.alphaTest = source.alphaTest;
	this.repeat.copy( source.repeat );

	return this;

};

if( typeof exports !== 'undefined' ) {
	if( typeof module !== 'undefined' && module.exports ) {
		exports = module.exports = { MeshLine: MeshLine, MeshLineMaterial: MeshLineMaterial };
	}
	exports.MeshLine = MeshLine;
	exports.MeshLineMaterial = MeshLineMaterial;
}
else {
	root.MeshLine = MeshLine;
	root.MeshLineMaterial = MeshLineMaterial;
}

}).call(this);

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("three")):"function"==typeof define&&define.amd?define(["three"],e):((t=t||self).THREE=t.THREE||{},t.THREE.TextTexture=e(t.THREE))}(this,(function(t){"use strict";function e(t,e,i,n,r){return[i,n,r,e+"px",t].join(" ")}var i=function(i){function n(e){void 0===e&&(e={});var n=e.align;void 0===n&&(n="center");var r=e.fillStyle;void 0===r&&(r="#fff");var o=e.fontFamily;void 0===o&&(o="sans-serif");var a=e.fontSize;void 0===a&&(a=16);var h=e.fontStyle;void 0===h&&(h="normal");var s=e.fontVariant;void 0===s&&(s="normal");var l=e.fontWeight;void 0===l&&(l="normal");var f=e.lineGap;void 0===f&&(f=.15);var d=e.padding;void 0===d&&(d=.25);var c=e.strokeStyle;void 0===c&&(c="#000");var g=e.strokeWidth;void 0===g&&(g=0);var u=e.text;void 0===u&&(u=""),i.call(this,document.createElement("canvas"),void 0,void 0,void 0,t.LinearFilter,t.LinearFilter),Object.assign(this,{_align:n,_fillStyle:r,_fontFamily:o,_fontSize:a,_fontStyle:h,_fontVariant:s,_fontWeight:l,_lineGap:f,_padding:d,_strokeStyle:c,_strokeWidth:g,_text:u,needsRedraw:!0})}i&&(n.__proto__=i),n.prototype=Object.create(i&&i.prototype),n.prototype.constructor=n;var r={lines:{configurable:!0},textWidth:{configurable:!0},textHeight:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return r.lines.get=function(){var t=this.text;return t?t.split("\n"):[]},r.textWidth.get=function(){var t=this.fontFamily,i=this.fontStyle,n=this.fontVariant,r=this.fontWeight,o=this.lines;if(o.length){var a=document.createElement("canvas").getContext("2d");return a.font=e(t,1,i,n,r),o.map((function(t){return a.measureText(t).width})).reduce((function(t,e){return Math.max(t,e)}))}return 0},r.textHeight.get=function(){var t=this.lineGap,e=this.lines;return e.length?e.length+t*(e.length-1):0},r.width.get=function(){var t=this.padding;return 2*(t+=this.strokeWidth/2)+this.textWidth},r.height.get=function(){var t=this.padding;return 2*(t+=this.strokeWidth/2)+this.textHeight},Object.defineProperties(n.prototype,r),n}(t.Texture);var n=new t.Vector3,r=new t.Vector3,o=new t.Vector3;var a={computeAndSetOptimalFontSize:function(){for(var t,e=[],i=arguments.length;i--;)e[i]=arguments[i];this.fontSize=(t=this).computeOptimalFontSize.apply(t,e)},computeOptimalFontSize:function(e,i,a,h){var s=this.height,l=this.width;if(l&&s){var f=(i.capabilities||{}).maxTextureSize||1/0;e.getWorldPosition(r),a.getWorldPosition(n);var d=r.distanceTo(n);if(a.isPerspectiveCamera&&(d*=2*Math.tan(t.Math.degToRad(a.fov)/2)),(a.isPerspectiveCamera||a.isOrthographicCamera)&&(d/=a.zoom),d){e.getWorldScale(o);var c=o.y*i.domElement.offsetHeight/d/s;return h&&(c=t.Math.ceilPowerOfTwo(c)),s*=c,((l*=c)>f||s>f)&&(c*=f/Math.max(l,s),h&&(c=t.Math.floorPowerOfTwo(c))),c}}return 0},isTextTexture:!0,redraw:function(){if(this.needsRedraw){var t=this.image;if(t){var i=this.fontSize,n=this.height,r=this.width,o=t.getContext("2d");if(o.clearRect(0,0,t.width,t.height),n*=i,(r*=i)&&n){t.width=r,t.height=n;var a,h=this.align,s=this.fillStyle,l=this.fontFamily,f=this.fontStyle,d=this.fontVariant,c=this.fontWeight,g=this.lineGap,u=this.lines,v=this.padding,p=this.strokeStyle,m=this.strokeWidth;switch(v+=m/2,m*=i,g*=i,v*=i,o.font=e(l,i,f,d,c),h){case"left":o.textAlign="left",a=v;break;case"right":o.textAlign="right",a=r-v;break;case"center":o.textAlign="center",a=r/2}o.textBaseline="top";var y=v;o.fillStyle=s,o.miterLimit=1,o.lineWidth=m,o.strokeStyle=p,u.forEach((function(t){m&&o.strokeText(t,a,y),o.fillText(t,a,y),y+=i+g}))}else t.width=t.height=1;this.needsRedraw=!1,this.needsUpdate=!0}}}},h=i.prototype;return Object.entries({_align:"align",_fillStyle:"fillStyle",_fontFamily:"fontFamily",_fontSize:"fontSize",_fontStyle:"fontStyle",_fontVariant:"fontVariant",_fontWeight:"fontWeight",_lineGap:"lineGap",_padding:"padding",_strokeStyle:"strokeStyle",_strokeWidth:"strokeWidth",_text:"text"}).forEach((function(t){var e=t[0],i=t[1];Object.defineProperty(h,i,{get:function(){return this[e]},set:function(t){this[e]!==t&&(this[e]=t,this.needsRedraw=!0)}})})),Object.assign(h,a),i}));

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("three"),require("@seregpie/three.text-texture")):"function"==typeof define&&define.amd?define(["three","@seregpie/three.text-texture"],e):((t=t||self).THREE=t.THREE||{},t.THREE.TextSprite=e(t.THREE,t.THREE.TextTexture))}(this,(function(t,e){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e;var i=function(i){function r(r){void 0===r&&(r={});var n=r.fontSize;void 0===n&&(n=1);var o=function(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&-1===e.indexOf(r)&&(i[r]=t[r]);return i}(r,["fontSize"]),a=new e(Object.assign({},o,{fontSize:0})),s=new t.SpriteMaterial({depthWrite:!1,map:a});i.call(this,s),Object.assign(this,{fontSize:n})}i&&(r.__proto__=i),r.prototype=Object.create(i&&i.prototype),r.prototype.constructor=r;var n={width:{configurable:!0},height:{configurable:!0}};return n.width.get=function(){var t=this.fontSize,e=this.material.map.width;return e*=t},n.height.get=function(){var t=this.fontSize,e=this.material.map.height;return e*=t},Object.defineProperties(r.prototype,n),r}(t.Sprite);var r={dispose:function(){var t=this.material;t.map.dispose(),t.dispose()},isTextSprite:!0,onBeforeRender:function(t,e,i){var r=this.height,n=this.material,o=this.scale,a=this.width,s=n.map;a&&r?o.setX(a).setY(r):o.setX(1).setY(1),s.computeAndSetOptimalFontSize(this,t,i,!0),s.redraw()}},n=i.prototype;return["align","fillStyle","fontFamily","fontStyle","fontVariant","fontWeight","lineGap","padding","strokeStyle","strokeWidth","text"].forEach((function(t){Object.defineProperty(n,t,{get:function(){return this.material.map[t]},set:function(e){this.material.map[t]=e}})})),Object.assign(n,r),i}));

/*!
 * three-particle-fire
 * (c) 2017 @yomotsu
 * Released under the MIT License.
 */
(function (global, factory) {
	typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :
	typeof define === 'function' && define.amd ? define(factory) :
	(global.particleFire = factory());
}(this, (function () { 'use strict';

	var SPRITE_ROW_LENGTH = 4;
	var ONE_SPRITE_ROW_LENGTH = 1 / SPRITE_ROW_LENGTH;

	var libs = {};
	var callbacks = {};

	function install(_libs) {

		libs.THREE = _libs.THREE;

		for (var i = 0, l = callbacks['THREE'].length; i < l; i++) {

			callbacks['THREE'][i]();
		}

		delete callbacks['THREE'];
	}

	function getInstalled(key) {

		return libs[key];
	}

	function onInstall(key, callback) {

		if (!callbacks[key]) callbacks[key] = [];

		callbacks[key].push(callback);
	}

	function makeGeometryClass() {

		var THREE = getInstalled('THREE');

		var Geometry = function Geometry(radius, height, particleCount) {

			THREE.BufferGeometry.call(this);

			var halfHeight = height * 0.5;
			var position = new Float32Array(particleCount * 3);
			var randam = new Float32Array(particleCount);
			var sprite = new Float32Array(particleCount);

			for (var i = 0; i < particleCount; i++) {

				var r = Math.sqrt(Math.random()) * radius;
				var angle = Math.random() * 2 * Math.PI;
				position[i * 3 + 0] = Math.cos(angle) * r;
				position[i * 3 + 1] = (radius - r) / radius * halfHeight + halfHeight;
				position[i * 3 + 2] = Math.sin(angle) * r;
				sprite[i] = ONE_SPRITE_ROW_LENGTH * (Math.random() * 4 | 0);
				randam[i] = Math.random();

				if (i === 0) {

					// to avoid going out of Frustum
					position[i * 3 + 0] = 0;
					position[i * 3 + 1] = 0;
					position[i * 3 + 2] = 0;
				}
			}

			this.addAttribute('position', new THREE.BufferAttribute(position, 3));
			this.addAttribute('randam', new THREE.BufferAttribute(randam, 1));
			this.addAttribute('sprite', new THREE.BufferAttribute(sprite, 1));
		};

		Geometry.prototype = Object.create(THREE.BufferGeometry.prototype);

		return Geometry;
	}

	var texture = void 0;

	function getTexture() {

		if (!!texture) return texture;

		var THREE = getInstalled('THREE');

		var image = new Image();

		texture = new THREE.Texture();
		texture.wrapS = texture.wrapT = THREE.RepeatWrapping;
		texture.image = image;

		image.onload = function () {

			texture.needsUpdate = true;
		};

		image.src = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAABACAMAAADCg1mMAAABgFBMVEUAAAABAQEGBgYLCwsODg4QEBACAgIWFhYbGxsdHR0fHx8gICAjIyMoKCgtLS0wMDAyMjI1NTU2NjY3Nzc4ODgvLy8wLzA5OTk9PT0+Pj4/Pz47OztAQEBDQ0NHR0dLS0tOTk5QUFBSUlJXV1cxMTFcXFxgYGBgYWFiYmJmZmZra2tub25wcHBzc3NxcXEuLi5fX19wb3B3eHd9fHyDg4OGhYWGh4eBgYF+f36JiImLi4uQkZGXl5egoKCkpKSrq6ucnJyQkJCNjY2Pj4+SkpKhoaGurq6zs7O3t7dPT08/QECwsLDGxsbLy8vOzs6vr6+8vLzCwsLW1tbf39/h4eHd3d3X19fT09NfYF9/f3/a2trj4+Po5+js7Ozq6urn5+fm5ubR0dC+v77Pz8/AwMDR0dI3ODjf4N+foJ+enp7p6ene3t6jo6PZ2Nju7u6eoKDZ19fz8/Px8fHw7/DY19hucG7e395OT0/V1dXX1tbY2NqPj435+fl4eHhYWFh9f31mJTJvAAAUEElEQVR4Ae161Z9cR9ZkxMlLRc2SLWk8grHAvMz0tAxPy//Avu4fs/i0jK/7PS0zw4BlYYssS2o1d8GFzBMf1LZmrG652/6N58PTWFXdmSfiZkSecyuJX8FBEfNv89D8O4WfXvBXMv4fp0dAhOYcCL8eCOBhcgRBAILm3366FGS/YuHPg6QBnKN2Ha7/X/MEAHnHOXoGgoQguZIDAqhfHQSQ8G+6+iNJmpnRQg5CIcY4h69fLSvAAgDpG8AHQZgxe3trGCwYSSO7uj6gR/CnKYSAby2YlXlw/2buR2aWZyH0VsJo0O//wmevbwFIEqCfoqcbvrWwavH3lzm/EX6zYHnoL1T9cnmlWllYWlpavLK0sDRcCMbjYdKMRpvHyXR8+xJguVjcHqX2GywBMjBYNsyL/nJcZhyZMcLPlOV/SG9YUySMBgoAXJREgdDPfgUQ87CirBZ6Cxm/pm1yLoD+XxwV1aCfjWxhmXnxYnPr+X7zrJ9XBI+dNBS93mC4NBz2e70qIw0FCJI/cw8gAYL52qCX9bq6+9q1H83y0Fsv+6Pf6udXbKdrdzZiZ7XFYZrUnRxHSCCZFUu9fr9ay/q9QalAI0hyns7PTgI8xMEbTb+ghnXT4NQhzsUcrJcVvVHWZLPnXagboXz3M1WrTbQcAP0Y4rJ+2cuYpUVcvaNB7NxjlDWepCTBfzYEvKKa+c6ZcjWduVNVKepryB80C2GUL6UzYbD39v3ZRz8AgPozMO70b2yDx9UCZGA5WpAsAk96WNEsOq7eVp1ibJvYOiV96wTw1TdYfzBaWFjaXm67izejTv//pFnI8l4Y5ud86073/u2yARSAMlpbvkF0tDCs+kvL5w78xVAYTMAOGv+Wu2sdJ6nOtydtG+U/AxMkQZDWW/xN1eJqOFtWvZ0q8Os4AIMNin5vsKgX78ziZ11dlgoxokHVfF/EcUHLcqtmm7e2Fm26MNyQL4TFbLFZC36jKHs2WFwqc/JbNUGSAEHSGKqlQff2WRLd2uoG3AEQPI0AGDIrqsX+YFDu7z2v8tYR4QXzrrLRwstZM4sSwNe2wHDOc33wUlufN+OXW7v17rOmnrTsj2ZP8+gIQB6lU0mA37DYFvgK/7s7K9lwDRG5Jls9N3TRT1G+UiTB0Ptdm2V55lZW25Q9uKHdF0foX/zf3k6O15NtLZT1/yzatosukZZlRTHYXV24emsc1TpG537gLp1IAEmI8G928wZGyyz09gbht28H26SQlR9834fTrEknUUuIhJkN8rurn9z9rE743l20AAJjl08Xehuz3avPkkS9PpAROsh9FrvkLVoyL4Lle5WtHLBtHRJum53CBElmhBKknxSmn87AYVkeBiFbaEf5g7ewMZoMx4v9B6FEPrU6OUWdZAIMIZS9pYPn7RT2I+QdwNBKWlnt32nG/7GTcAQ/AXlC8pR86hLoKG7cGbW+r4MakvoTQKchIOSZrW1443PLNICEzE+zAGDZd+osz8z6echXgWmccj+7NN7LLavRduJJDAK0Xr60hv87nQEuRMj7Y7j1Ru3WbGevcx0FIrgUDUnu0yRBlgXdzPDRQbk7hiQA7qfwALIohmwXZ2yjCfMLYojxpK5WBMFQtWVuobDFtrcgU3fhPocKRQBGDPv2VX0B54NYKKqlUba13QEAHBJ2IJQLYWFnfxzlx98VdMUMQEqrLxQBNrFHtc8uDdbn2oT7OEonElAtfXzHHHl3EDsXLbdQZfD9OulkAbBayrPKuNCyt3AWXb3/dMlnkZ98fzyrF/aX437bEtBXUMgQFpbf7m0+ffcWbty6cVNSslq+cOaDLx5/MT27HY9vh+W+NHPAuz0lATFjysqV8+WtGQAiTeJB251IAO3c1We5jybgQjqQyKKyQPpicupECwyLJc3CoGV7ZVncWfpR3T/bFgfjq4+fxzoAo3H31b08LSz0RpcevmhvQp/iR4qtrw0eCP3V0dbUu/tRb6AP2gh9Z5hbFgKUl0tL9tlugAApxi7KT5RAaNaDYUoODmzRkXILhBls0EknNkDMy1hy1NBGK07qQadLt85Ui/mqt5MJaHl/6gQAvWkPYK94a/j4yVQAJKFNl9YhZGcu/d8P/kesO4E6toPwZGoykIv1fIKzsVpZnI7RCEK13+13rhPbYcvyfmUEWIf8F+I3Z1kwYwhF+dXFnCCAoSrC9dG1cPXCdQfQ7Wb2//aebe43k4Ozv/mtDL8kJwEC+YYqMBT9rNwaC4KQ0LgeQODK+QfV3dn1NknScfRJkjuQyi0aAXI7P2PYBABVaZImKZ5MABFKI0GSNggh3MkMgwFRZXlOnmACBhtWw6ff2/5Od04kHz2XZVl1sPtk+2lRTC+cycH5MDzWyAESVp5dm+5EAYJsXjsAC5fUndu++J+SiOPwa06YQsi84BxUP7ueX8wAwCdw/24ScPIKyHNjDhJgPTAzDAYAS35Y5DyxCzKOhm9/MiuNz1/U9bNZV4TsA+tPt56sP11p8M6lYpQtGgEQ4LGboJVldWmjBQTIvQwkyO+Nhl39fw9+4DDhTeEuwRkyknM/u5ffEwUADqwDOrEdpvX6g1lDABRmAwAzABbLh+VweuI+ALRn41Pkk07c0qyAiDt084N2nK6NffjuF3kZHIQAHYef7A8X/1cCIQCGWNZ+doO7F8u9br+ZMIiOY2M+YswBAOYGyLv+cPX/ysX+AcBT3RBhxsZoaU5hfbhA8ryvcd6eWMOdXQnTbcuAGkCVkPIEy2yGNnYvvjsqvptvhI2I44xMFEkLv+cLTKNZAkAoS1Wzxf7qJxvTg0aDCRMoHBuUgAxgsjlHiuHleCoEEeY0I0/yACLkoWfvXL/6BwNpRjMLRlbsNVYVwU66DbKV8GI8nmqmqtQMILNgdMI4G5ffv/+j7uzqUiAB8Ms+SM6t590Hb08rhMOikBmzfjX8LdvjOi3kH4/4VSZMIZEMOWkg6jSJb1ughOnAwjAznuABBCz7qP0dQ67MLlWZscpCKMpqOBi1v5hGTiOJN4fZWbRd0OwPVZqpasBrCkSo6Ar6Qfdyb7IUKh6/Dwqk2eejMzszVTAeRs5iVM4OWHl1j4WAN6dAZiSYnSFIVpqmh3mGec5mISNPkABJ+/Tci+LxeOEdPktdzHnt7lK2uDRpNqIVlSen87g3ezQH5RtXs/bKQ/zXWsAMCOt5BJyCp9KDtibW65kEEToiIIA2yKbqsuv/mwl65Q2Luy0X/SBz1A7qzUvwFUJLBiB6t9bWzXwkG6QofbUERCt75ez5ZHvn8dLV31Hk5KOVXr//tDt34b2iGFVVlRdFHoyvN5ZzPPhu6AfciaiRYopSAmC0mTJ3CED7Ym1oIABSRygwMjvHDzx+PxvZISQiJORVe33xOgF7k5sRJOdb9dw/yiSf1DsLi9J8BdgV44kmmDHX8pkvprMe1vSb76LX4/Ufbryz7tWn/SZX560kKSY/tj18sIgCeRIjDAkQOU/sPB7VlQhFFIcKoF6/fjCGZquxD9/9FzVJESDeu2VEd+GL+/EeQFBvrkMubwIUAsBAQNWkv3NhGqRQs39gjwnqBALKfMDn23XsWmmRa3b5wdKLg7hRDNBL2awMqgSpG73ovtweCgZAihC7AMGVX72LQAGQf+cBLj8GALVTgSZx7lpfUpCRlnVIxcZdvqoNedvs/Zd82Zv5aELamwkwPuoFCsJWWNtiEYp25L29lSdZR/caEk4kgIprOmiSq9tNk6rX3J3txvO3a58s5pNkAQ4Iytrh4GlM0BEX2J8s70BICrG7A7CDINcD4QHrCnNcX5bNodBJGCnQlBb2DjeJ9+7Awv+8FqaxV25VdTBSR2FwToBlAJBaDv1iw9D7revFwsKnS7OMsRWUdEIzJCJwN8yUIjx2s35Jb2famUC9c/sAMJgAAOAffHrhC/wkAyQkqbEo6RW6Fq0cXHshAA4PWT7Bq/xFfZk/gsnyMPaMZecmUbdpxmZ64cnqZmCeDd65jUThSJBm7IEATP1irTdI57n5tnOdTd8PkNXdfow6aRcwI5YeTaNHbzSuwvs35TggPty4Faruxx5i9/K2Z1301xCo3vz4mbKO6tRl6HJ41SoOJICrB2We8yBBh1au1+ADaD5burqxd/X2blYegNdvwxhKfo5irz9Z2BtqZzSWH2OAMFoQSQlVebl6fwNNO+QzdbHcVZ3vjJsu6gQCyCwb5jtMXbM8WEfT8O6sxuWHJGcaPmfoMI8BMAmDJJde00DbPbKaBNB5AyWkJsVmHY6grVEegNQK0BvqYKg9aHcWlp952bWZ+20QxlhgXC35OY0XEdS4RB2pIi0wBL53i7B8qVrMnl25Vz1DlZp2p/veD8exSy7hBALsXG5CTFzecJfIpxTvkfhvb82WwrR9NcC0D3Kwb+lLIOTe7K8s1spSiJDkcsSUXEkKYZhBzjTDMQqACEhUiCnr6l4fvX1voicMmpAzT+OFrKiv3l1Bl3egcLSIoBXkLYgo15b2/9vu5rW7wDu3Z/Vs+jS6SzqpFyCzpo+ECrN9eQKSHVZHQt2NDoR5DKaYDg7oV27zNQUoHSzHomUWlcWkJLnXlBxZPgwA1G9qnzOgn/TAwycufl6GmLpZ11cpayJ8muna/V7DSaE0Xt5Z8gmoo1UYyRBICgyD0ds3a5S3kuv/tfV+mxwSgBMJsOzDF/XCRnLAHQ64ASDcVmNaaX/nv+dsAABT09G3lAQCUrv8KOSKQiOlJI/Nd9ejLAs9yC3xoKjTnAG+ZgGA09YDY2DXNXkorbA4dSBfz0Sc/2Kleet5b9wE6Nh76Vc2+f5tACgG1f+cCTWg6qDdq1067QGJ6k6BfRoxf9IMtGAWsNnu3dVohZhiOquNxinA17KQBN/dYcZOXVSVkqfpMN5PzK8VA0ry68KlXUE/CfvQDSUoySetkqudzg6mKSNBIFUB+OH0qfZZZeXEhSMh8JHzNkmG/khdqqqyLKuDOOlcOu0RGevs8pPMgTzKkoFGco4zjXfLp+/mjxvLPEYRQY6HR7oB58R6HfMGKveTt6OD50C48vgx64wZ+Rnw31r31yVwqAEHAU2yUh6ibPrh7bIVgboPYFYwoO7+yF9PR9CTABBIg4dRNdABMJm/lBzC6QggELDe62onz74wygiw7AiAf/znnu2fry6cw3htFrZj3WiwzzOfv1aLSNodbscgJh1c/5H7C4BmjwWxLRKDo5m5XkM/Z08UgCSQFx6xMKfH73sLqZsbUw11mtV/uxV0VAIG8r07GEzQDEM65EjS6Q9JicwGiA2UFQfBxcuPzEKWG6j4c2h1L3901tper1ud5Ss7E2KTr68Apfbeb91sOvOy/TQ24cojmgtr2BTaUHaatulV/scwEAnR1sHRVmldkuuDe1JM6KVgi24+flknADraihK4lQ1qs56hxTwckE5NAChMy4wXNv/0Py+ymfB5lpkhAGAhmLx5916WTypbDuDiDOARFII2Xg7rJNT84NOgzcwThD1cnGDTpynOL58A8AgIAVSiyQNeXHkclCB+mie2RRuzwdVB83Jze8clHd0G5QJu3KlpVvZX7+onvOX0BAipz/xCv/o3uVAEIGUEwFeT4CY9Rg+JmLnhtd5MhIj0+cXB0yi43xQQ3ZGfBx5gb3FtI3YuAOIbUqMASEEyW7/yJM8A4NodQ1u4fWdp88Xm9jg6jt0GgdX6sxywYVk9mh5emxv/T/oaByWpSds8fskyC8yZ/NXwhL1vFj4gAa/ruqu7Orpnfkz6+/cxTOndlDyp6XztYvMAuPzg/ItnsyYJ+P+fxNHQ/CO53PUgNZPZTN2n17rk2fJ7K88fbrzcmrrrmDpSkDZcDtJ9xfJDAj5zSTi9CcI7dM9qWHAXARcNcAD4jMAtmxtr0zD5n/n7s6jX7+uLio9Wf+u/aj9VtDYJ2tsAHlx+gPuNSwR0+HdH0fPVCykk0QhZXemzPDt72Rce7G+M65Qc0DEGArmlDEI+il/MDsDZAJjAR3s4NQGCLLn7ODWv3hhPaEt4IEWR5F/+x4NacCHGv5u66MeYkabr2cLLzlq5CuD8AwAPPHYOQF+pTPGVF6RgYUCKtKIanRkM4/q9/XHnMUk4vqsXutzdQHkuuqZ9QP4ifY3D0kZk6Fo0ddE6otVNF629sBG7ZIkQiB8q9rMsNDHF/m7n6YgZAdTMK49T9+KdzZR2AXjXRgng6c/Yofgr96qqt7B49sx3zhbZ0/WHLycppfQGXydoRAEz9pH2akF9TDxNuqjTT0rL86zXG03c3VOTLq5DEEWCZ7eLjKQRBARP7bRLrwuMAgEif2tlb+poNJdVjC6Bry7wKc7ZIJxdHozafj4q+tP9rfHObjdvLAThDQRkWVYVeTlY2JvJvT+Be7fXdv41WDeaMQ9/7udiSu5yORyAudHMzm73FAgA+uj7kzRvL3XsWFYuK7VZAyh1rzZ+CqCoU+RDDv7qv/r4vmFaPJvuN0kC5nRDwrEE0CxnNiirYjbPW6kdt9H1NQggSGQWCEBRcAkQCBgsGGlmJWJMea0U33A1iHlflRHSXLRfMwgQYVQGeHvhfnIXcTiXoDf9Cxksy0Y5IN34TFA6aKM7vgYBAAkyAHyF/nAjJM3mAgAkd3cJx+IXIYLgCaXoCQzw1a2OQ+M8gv8oA8z75TxDxK47HX7w6NSckw19eXybvwTBJb0xGwqEKFAUvklwziOO7LInsGbMcqOg4vwv7Tyn45+vzy2+olxz4f6YGhCCcPjtq+JE8Ceg0WtnNkXoFKeMDXPa5X46/OCbHur1jPhjXAK+TQJAHAmdWjnzkKBvOBePm46HqKjT9xk/LQpODUXUt5gRDwPEtx+vhPftxm/Eb8TPAwz8rJ6S1NOrAAAAAElFTkSuQmCC';

		return texture;
	}

	function makeMaterialClass() {

		var THREE = getInstalled('THREE');

		var Material = function Material(parameters) {

			var uniforms = {
				color: { type: "c", value: null },
				size: { type: "f", value: 0.0 },
				firetexture: { type: "t", value: getTexture() },
				time: { type: "f", value: 0.0 },
				heightOfNearPlane: { type: "f", value: 0.0 }
			};

			THREE.ShaderMaterial.call(this, {

				uniforms: uniforms,

				vertexShader: ['attribute float randam;', 'attribute float sprite;', 'uniform float time;', 'uniform float size;', 'uniform float heightOfNearPlane;', 'varying float vSprite;', 'varying float vOpacity;', 'float PI = 3.14;', 'float quadraticIn( float t ) {', 'float tt = t * t;', 'return tt * tt;', '}', 'void main() {', 'float progress = fract( time + ( 2.0 * randam - 1.0 ) );', 'float progressNeg = 1.0 - progress;', 'float ease = quadraticIn( progress );', 'float influence = sin( PI * ease );', 'vec3 newPosition = position * vec3( 1.0, ease, 1.0 );', 'gl_Position = projectionMatrix * modelViewMatrix * vec4( newPosition, 1.0 );', 'gl_PointSize = ( heightOfNearPlane * size ) / gl_Position.w;', 'vOpacity = min( influence * 4.0, 1.0 ) * progressNeg;', 'vSprite = sprite;', '}'].join('\n'),

				fragmentShader: ['uniform vec3 color;', 'uniform sampler2D firetexture;', 'varying float vSprite;', 'varying float vOpacity;', 'void main() {', 'vec2 texCoord = vec2(', 'gl_PointCoord.x * ' + ONE_SPRITE_ROW_LENGTH + ' + vSprite,', 'gl_PointCoord.y', ');', 'gl_FragColor = vec4( texture2D( firetexture, vec2( texCoord ) ).xyz * color * vOpacity, 1.0 );', '}'].join('\n'),

				blending: THREE.AdditiveBlending,
				depthTest: true,
				depthWrite: false,
				transparent: true
				// fog        : true

			});

			this.color = new THREE.Color(0xff2200);
			this.size = 0.4;
			this.setValues(parameters);

			this.uniforms.color.value = this.color;
			this.uniforms.size.value = this.size;
		};

		Material.prototype = Object.create(THREE.ShaderMaterial.prototype);

		Material.prototype.update = function (delta) {

			this.uniforms.time.value = (this.uniforms.time.value + delta) % 1;
		};

		Material.prototype.setPerspective = function (fov, height) {

			this.uniforms.heightOfNearPlane.value = Math.abs(height / (2 * Math.tan(THREE.Math.degToRad(fov * 0.5))));
		};

		return Material;
	}

	var particleFire = {
		// Geometry,
		// Material,
		install: install
	};

	onInstall('THREE', function () {

		particleFire.Geometry = makeGeometryClass();
		particleFire.Material = makeMaterialClass();
	});

	return particleFire;

})));

/* Font Face Observer v2.1.0 - © Bram Stein. License: BSD-3-Clause */(function(){'use strict';var f,g=[];function l(a){g.push(a);1==g.length&&f()}function m(){for(;g.length;)g[0](),g.shift()}f=function(){setTimeout(m)};function n(a){this.a=p;this.b=void 0;this.f=[];var b=this;try{a(function(a){q(b,a)},function(a){r(b,a)})}catch(c){r(b,c)}}var p=2;function t(a){return new n(function(b,c){c(a)})}function u(a){return new n(function(b){b(a)})}function q(a,b){if(a.a==p){if(b==a)throw new TypeError;var c=!1;try{var d=b&&b.then;if(null!=b&&"object"==typeof b&&"function"==typeof d){d.call(b,function(b){c||q(a,b);c=!0},function(b){c||r(a,b);c=!0});return}}catch(e){c||r(a,e);return}a.a=0;a.b=b;v(a)}}
function r(a,b){if(a.a==p){if(b==a)throw new TypeError;a.a=1;a.b=b;v(a)}}function v(a){l(function(){if(a.a!=p)for(;a.f.length;){var b=a.f.shift(),c=b[0],d=b[1],e=b[2],b=b[3];try{0==a.a?"function"==typeof c?e(c.call(void 0,a.b)):e(a.b):1==a.a&&("function"==typeof d?e(d.call(void 0,a.b)):b(a.b))}catch(h){b(h)}}})}n.prototype.g=function(a){return this.c(void 0,a)};n.prototype.c=function(a,b){var c=this;return new n(function(d,e){c.f.push([a,b,d,e]);v(c)})};
function w(a){return new n(function(b,c){function d(c){return function(d){h[c]=d;e+=1;e==a.length&&b(h)}}var e=0,h=[];0==a.length&&b(h);for(var k=0;k<a.length;k+=1)u(a[k]).c(d(k),c)})}function x(a){return new n(function(b,c){for(var d=0;d<a.length;d+=1)u(a[d]).c(b,c)})};window.Promise||(window.Promise=n,window.Promise.resolve=u,window.Promise.reject=t,window.Promise.race=x,window.Promise.all=w,window.Promise.prototype.then=n.prototype.c,window.Promise.prototype["catch"]=n.prototype.g);}());

(function(){function l(a,b){document.addEventListener?a.addEventListener("scroll",b,!1):a.attachEvent("scroll",b)}function m(a){document.body?a():document.addEventListener?document.addEventListener("DOMContentLoaded",function c(){document.removeEventListener("DOMContentLoaded",c);a()}):document.attachEvent("onreadystatechange",function k(){if("interactive"==document.readyState||"complete"==document.readyState)document.detachEvent("onreadystatechange",k),a()})};function t(a){this.a=document.createElement("div");this.a.setAttribute("aria-hidden","true");this.a.appendChild(document.createTextNode(a));this.b=document.createElement("span");this.c=document.createElement("span");this.h=document.createElement("span");this.f=document.createElement("span");this.g=-1;this.b.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.c.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";
this.f.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.h.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;";this.b.appendChild(this.h);this.c.appendChild(this.f);this.a.appendChild(this.b);this.a.appendChild(this.c)}
function u(a,b){a.a.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;white-space:nowrap;font-synthesis:none;font:"+b+";"}function z(a){var b=a.a.offsetWidth,c=b+100;a.f.style.width=c+"px";a.c.scrollLeft=c;a.b.scrollLeft=a.b.scrollWidth+100;return a.g!==b?(a.g=b,!0):!1}function A(a,b){function c(){var a=k;z(a)&&a.a.parentNode&&b(a.g)}var k=a;l(a.b,c);l(a.c,c);z(a)};function B(a,b){var c=b||{};this.family=a;this.style=c.style||"normal";this.weight=c.weight||"normal";this.stretch=c.stretch||"normal"}var C=null,D=null,E=null,F=null;function G(){if(null===D)if(J()&&/Apple/.test(window.navigator.vendor)){var a=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(window.navigator.userAgent);D=!!a&&603>parseInt(a[1],10)}else D=!1;return D}function J(){null===F&&(F=!!document.fonts);return F}
function K(){if(null===E){var a=document.createElement("div");try{a.style.font="condensed 100px sans-serif"}catch(b){}E=""!==a.style.font}return E}function L(a,b){return[a.style,a.weight,K()?a.stretch:"","100px",b].join(" ")}
B.prototype.load=function(a,b){var c=this,k=a||"BESbswy",r=0,n=b||3E3,H=(new Date).getTime();return new Promise(function(a,b){if(J()&&!G()){var M=new Promise(function(a,b){function e(){(new Date).getTime()-H>=n?b(Error(""+n+"ms timeout exceeded")):document.fonts.load(L(c,'"'+c.family+'"'),k).then(function(c){1<=c.length?a():setTimeout(e,25)},b)}e()}),N=new Promise(function(a,c){r=setTimeout(function(){c(Error(""+n+"ms timeout exceeded"))},n)});Promise.race([N,M]).then(function(){clearTimeout(r);a(c)},
b)}else m(function(){function v(){var b;if(b=-1!=f&&-1!=g||-1!=f&&-1!=h||-1!=g&&-1!=h)(b=f!=g&&f!=h&&g!=h)||(null===C&&(b=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),C=!!b&&(536>parseInt(b[1],10)||536===parseInt(b[1],10)&&11>=parseInt(b[2],10))),b=C&&(f==w&&g==w&&h==w||f==x&&g==x&&h==x||f==y&&g==y&&h==y)),b=!b;b&&(d.parentNode&&d.parentNode.removeChild(d),clearTimeout(r),a(c))}function I(){if((new Date).getTime()-H>=n)d.parentNode&&d.parentNode.removeChild(d),b(Error(""+
n+"ms timeout exceeded"));else{var a=document.hidden;if(!0===a||void 0===a)f=e.a.offsetWidth,g=p.a.offsetWidth,h=q.a.offsetWidth,v();r=setTimeout(I,50)}}var e=new t(k),p=new t(k),q=new t(k),f=-1,g=-1,h=-1,w=-1,x=-1,y=-1,d=document.createElement("div");d.dir="ltr";u(e,L(c,"sans-serif"));u(p,L(c,"serif"));u(q,L(c,"monospace"));d.appendChild(e.a);d.appendChild(p.a);d.appendChild(q.a);document.body.appendChild(d);w=e.a.offsetWidth;x=p.a.offsetWidth;y=q.a.offsetWidth;I();A(e,function(a){f=a;v()});u(e,
L(c,'"'+c.family+'",sans-serif'));A(p,function(a){g=a;v()});u(p,L(c,'"'+c.family+'",serif'));A(q,function(a){h=a;v()});u(q,L(c,'"'+c.family+'",monospace'))})})};"object"===typeof module?module.exports=B:(window.FontFaceObserver=B,window.FontFaceObserver.prototype.load=B.prototype.load);}());

/**
 * @author qiao / https://github.com/qiao
 * @author mrdoob / http://mrdoob.com
 * @author alteredq / http://alteredqualia.com/
 * @author WestLangley / http://github.com/WestLangley
 */

THREE.EditorControls = function ( object, domElement, target ) {

	domElement = ( domElement !== undefined ) ? domElement : document;

	// API

	this.enabled = true;
	this.target = target;
	this.center = this.target===undefined?new THREE.Vector3():this.target.clone();
	this.panSpeed = 0.001;
	this.zoomSpeed = 0.001;
	this.rotationSpeed = 0.005;

	this.maxZoom = 10000;
	this.minZoom = 0;
	this.disablePan = false;
	this.lockUpVector = false;

	// internals

	var scope = this;
	var vector = new THREE.Vector3();

	var STATE = { NONE: - 1, ROTATE: 0, ZOOM: 1, PAN: 2 };
	var state = STATE.NONE;

	var center = this.center;
	var normalMatrix = new THREE.Matrix3();
	var pointer = new THREE.Vector2();
	var pointerOld = new THREE.Vector2();
	var spherical = new THREE.Spherical();

  this.reset = function(){
    console.log("reset editor controls");
    vector = new THREE.Vector3();
    if(this.target===undefined){
      scope.center = object.position.clone();
      var camDir = new THREE.Vector3();
      object.getWorldDirection( camDir );
      scope.center.add(camDir.multiplyScalar(5));
    }else{
      scope.center = this.target.clone();
    }
    center = scope.center;
    normalMatrix = new THREE.Matrix3();
    pointer = new THREE.Vector2();
    pointerOld = new THREE.Vector2();
    spherical = new THREE.Spherical();
  }

	// events

	var changeEvent = { type: 'change' };

	this.focus = function ( target ) {

		var box = new THREE.Box3().setFromObject( target );
		object.lookAt( center.copy( box.getCenter() ) );
		scope.dispatchEvent( changeEvent );

	};

	this.pan = function ( delta ) {
	  if(this.disablePan) return;

		var distance = object.position.distanceTo( center );

		delta.multiplyScalar( distance * scope.panSpeed );
		delta.applyMatrix3( normalMatrix.getNormalMatrix( object.matrix ) );

		object.position.add( delta );
		center.add( delta );

		scope.dispatchEvent( changeEvent );

	};

	this.zoom = function ( delta ) {

		var distance = object.position.distanceTo( center );

		delta.multiplyScalar( distance * scope.zoomSpeed );

		if ( delta.length() > distance ) return;

		delta.applyMatrix3( normalMatrix.getNormalMatrix( object.matrix ) );

		var prevPosition = object.position.clone();

    prevPosition.add( delta );

    var newDistance = prevPosition.distanceTo( center );
    if(newDistance < this.minZoom || newDistance > this.maxZoom) return;

    object.position.copy(prevPosition);

		scope.dispatchEvent( changeEvent );

	};

	this.rotate = function ( delta ) {

		vector.copy( object.position ).sub( center );

		spherical.setFromVector3( vector );

		spherical.theta += delta.x;
		spherical.phi += delta.y;

		spherical.makeSafe();

		vector.setFromSpherical( spherical );


		var nextPosition = object.position.clone();
    nextPosition.copy( center ).add( vector );

    if(this.lockUpVector && nextPosition.clone().sub(center).normalize().dot(new THREE.Vector3(0, 1, 0)) < 0) return;

    object.position.copy( nextPosition );

    object.lookAt( center );

    scope.dispatchEvent( changeEvent );
	};

	// mouse

	function onMouseDown( event ) {

		if ( scope.enabled === false ) return;

		if ( event.button === 0 ) {

			state = STATE.ROTATE;

		} else if ( event.button === 1 ) {

			state = STATE.ZOOM;

		} else if ( event.button === 2 ) {

			state = STATE.PAN;

		}

		pointerOld.set( event.clientX, event.clientY );

		domElement.addEventListener( 'mousemove', onMouseMove, false );
		domElement.addEventListener( 'mouseup', onMouseUp, false );
		domElement.addEventListener( 'mouseout', onMouseUp, false );
		domElement.addEventListener( 'dblclick', onMouseUp, false );

	}

	function onMouseMove( event ) {

		if ( scope.enabled === false ) return;

		pointer.set( event.clientX, event.clientY );

		var movementX = pointer.x - pointerOld.x;
		var movementY = pointer.y - pointerOld.y;

		if ( state === STATE.ROTATE ) {

			scope.rotate( new THREE.Vector3( - movementX * scope.rotationSpeed, - movementY * scope.rotationSpeed, 0 ) );

		} else if ( state === STATE.ZOOM ) {

			scope.zoom( new THREE.Vector3( 0, 0, movementY ) );

		} else if ( state === STATE.PAN ) {

			scope.pan( new THREE.Vector3( - movementX, movementY, 0 ) );

		}

		pointerOld.set( event.clientX, event.clientY );

	}

	function onMouseUp( event ) {

		domElement.removeEventListener( 'mousemove', onMouseMove, false );
		domElement.removeEventListener( 'mouseup', onMouseUp, false );
		domElement.removeEventListener( 'mouseout', onMouseUp, false );
		domElement.removeEventListener( 'dblclick', onMouseUp, false );

		state = STATE.NONE;

	}

	function onMouseWheel( event ) {

		event.preventDefault();

		// if ( scope.enabled === false ) return;

		scope.zoom( new THREE.Vector3( 0, 0, event.deltaY ) );

	}

	function contextmenu( event ) {

		event.preventDefault();

	}

	this.dispose = function() {

		domElement.removeEventListener( 'contextmenu', contextmenu, false );
		domElement.removeEventListener( 'mousedown', onMouseDown, false );
		domElement.removeEventListener( 'wheel', onMouseWheel, false );

		domElement.removeEventListener( 'mousemove', onMouseMove, false );
		domElement.removeEventListener( 'mouseup', onMouseUp, false );
		domElement.removeEventListener( 'mouseout', onMouseUp, false );
		domElement.removeEventListener( 'dblclick', onMouseUp, false );

		domElement.removeEventListener( 'touchstart', touchStart, false );
		domElement.removeEventListener( 'touchmove', touchMove, false );

	};

	domElement.addEventListener( 'contextmenu', contextmenu, false );
	domElement.addEventListener( 'mousedown', onMouseDown, false );
	domElement.addEventListener( 'wheel', onMouseWheel, false );

	// touch

	var touch = new THREE.Vector3();

	var touches = [ new THREE.Vector3(), new THREE.Vector3(), new THREE.Vector3() ];
	var prevTouches = [ new THREE.Vector3(), new THREE.Vector3(), new THREE.Vector3() ];

	var prevDistance = null;

	function touchStart( event ) {

		if ( scope.enabled === false ) return;

		switch ( event.touches.length ) {

			case 1:
				touches[ 0 ].set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY, 0 );
				touches[ 1 ].set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY, 0 );
				break;

			case 2:
				touches[ 0 ].set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY, 0 );
				touches[ 1 ].set( event.touches[ 1 ].pageX, event.touches[ 1 ].pageY, 0 );
				prevDistance = touches[ 0 ].distanceTo( touches[ 1 ] );
				break;

		}

		prevTouches[ 0 ].copy( touches[ 0 ] );
		prevTouches[ 1 ].copy( touches[ 1 ] );

	}


	function touchMove( event ) {

		if ( scope.enabled === false ) return;

		event.preventDefault();
		event.stopPropagation();

		function getClosest( touch, touches ) {

			var closest = touches[ 0 ];

			for ( var i in touches ) {

				if ( closest.distanceTo( touch ) > touches[ i ].distanceTo( touch ) ) closest = touches[ i ];

			}

			return closest;

		}

		switch ( event.touches.length ) {

			case 1:
				touches[ 0 ].set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY, 0 );
				touches[ 1 ].set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY, 0 );
				scope.rotate( touches[ 0 ].sub( getClosest( touches[ 0 ], prevTouches ) ).multiplyScalar( - scope.rotationSpeed ) );
				break;

			case 2:
				touches[ 0 ].set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY, 0 );
				touches[ 1 ].set( event.touches[ 1 ].pageX, event.touches[ 1 ].pageY, 0 );
				distance = touches[ 0 ].distanceTo( touches[ 1 ] );
				scope.zoom( new THREE.Vector3( 0, 0, prevDistance - distance ) );
				prevDistance = distance;


				var offset0 = touches[ 0 ].clone().sub( getClosest( touches[ 0 ], prevTouches ) );
				var offset1 = touches[ 1 ].clone().sub( getClosest( touches[ 1 ], prevTouches ) );
				offset0.x = - offset0.x;
				offset1.x = - offset1.x;

				scope.pan( offset0.add( offset1 ).multiplyScalar( 0.5 ) );

				break;

		}

		prevTouches[ 0 ].copy( touches[ 0 ] );
		prevTouches[ 1 ].copy( touches[ 1 ] );

	}

	domElement.addEventListener( 'touchstart', touchStart, false );
	domElement.addEventListener( 'touchmove', touchMove, false );

};

THREE.EditorControls.prototype = Object.create( THREE.EventDispatcher.prototype );
THREE.EditorControls.prototype.constructor = THREE.EditorControls;

/**
 * Copywrite Expivi B.V. 2018
 * @author Siamak M. Mirzaie
 */

THREE.ExpiviFirstPersonControls = function ( object, domElement ) {

	this.object = object;
  this.target = new THREE.Vector3( 0, 0, 0 );

	this.domElement = ( domElement !== undefined ) ? domElement : document;
  this.hammerManager = new Hammer.Manager(this.domElement);
  this.hammerManager.add( new Hammer.Pan({ direction: Hammer.DIRECTION_ALL }) );

	this.enabled = true;

	this.movementSpeed = 1.0;
  this.lookSpeed = 0.75;
	this.fastForward = false;

	this.lookVertical = true;
	this.constrainVertical = false;

  this.viewWidth = 1;
  this.viewHeight = 1;

  this.panDown = false;
  this.panDeltaX = 0;
  this.panDeltaY = 0;
  this.panDstQuat = null;
  this.panSpeed = 1;
  this.cameraLook = {
    t: 1,
    s: null,
    e: null,
    d: null
  };
  this.elementPrevCursor = null;

  var changeEvent = { type: 'change' };

	this.reset = function(){
    this.panDstQuat = null;
    this.dispatchEvent(changeEvent);
  }

	this.handleResize = function () {
		if ( this.domElement === document ) {
			this.viewWidth = window.innerWidth;
			this.viewHeight = window.innerHeight;
		} else {
			this.viewWidth = this.domElement.offsetWidth;
			this.viewHeight = this.domElement.offsetHeight;
		}
	};

	this.onKeyDown = function ( event ) {

		//event.preventDefault();

    if(event.shiftKey){
      this.fastForward = true;
    }

		switch ( event.keyCode ) {

			case 38: /*up*/
			case 87: /*W*/ this.moveForward = true; break;

			case 37: /*left*/
			case 65: /*A*/ this.moveLeft = true; break;

			case 40: /*down*/
			case 83: /*S*/ this.moveBackward = true; break;

			case 39: /*right*/
			case 68: /*D*/ this.moveRight = true; break;

			case 82: /*R*/ this.moveUp = true; break;
			case 70: /*F*/ this.moveDown = true; break;

		}

	};

	this.onKeyUp = function ( event ) {

    this.fastForward = false;

		switch ( event.keyCode ) {

			case 38: /*up*/
			case 87: /*W*/ this.moveForward = false; break;

			case 37: /*left*/
			case 65: /*A*/ this.moveLeft = false; break;

			case 40: /*down*/
			case 83: /*S*/ this.moveBackward = false; break;

			case 39: /*right*/
			case 68: /*D*/ this.moveRight = false; break;

			case 82: /*R*/ this.moveUp = false; break;
			case 70: /*F*/ this.moveDown = false; break;

		}
	};

	this.onBeginPan = function(event){
	  if(!this.enabled) return;

    this.panDown = true;
    this.panDstQuat = this.object.quaternion.clone();
    this.panDeltaX = event.deltaX;
    this.panDeltaY = event.deltaY;
    this.panSpeed = 1;

    //add movement animation
    this.cameraLook.s = this.panDstQuat.clone();
    this.cameraLook.t = 0;

    //change cursor to grabbing
    this.domElement.style.cursor = "grabbing";
    if(this.domElement.style.cursor === "" || this.domElement.style.cursor === "-webkit-grab"){
      this.domElement.style.cursor = "-webkit-grabbing";
    }
  }

	this.onEndPan = function(event){
    this.panDown = false;

    //console.log("event end: ", event);

    //change cursor to grab
    this.domElement.style.cursor = "grab";
    if(this.domElement.style.cursor === "" || this.domElement.style.cursor === "-webkit-grabbing"){
      this.domElement.style.cursor = "-webkit-grab";
    }
  }

  if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)
    || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4))){
    this.isMobile = true;
  }else{
    this.isMobile = false;
  }

	this.onPanned = function(event) {
    if (this.enabled === false || !this.panDown) return;

    //camera field of view
    var vFov = this.object.fov;
    var aspect = this.object.aspect;
    var hFov = THREE.Math.radToDeg(Math.abs(2 * Math.atan(Math.tan(vFov / 2) * aspect)));

    //movement delta
    var deltaX = event.deltaX - this.panDeltaX;
    var deltaY = event.deltaY - this.panDeltaY;
    this.panDeltaX = event.deltaX;
    this.panDeltaY = event.deltaY;
    this.panSpeed = THREE.Math.clamp(Math.abs(event.overallVelocity), 1, 5);

    //normalize delta
    deltaX = deltaX / (this.viewWidth * 0.6);
    deltaY = deltaY / (this.viewHeight * 0.6);

    //angles moved
    var dAngleX = vFov * deltaY * (this.lookVertical ? -1 : 1) * THREE.Math.clamp(Math.abs(event.overallVelocityY), 1, 2);
    var dAngleY = hFov * deltaX * (this.lookVertical ? -1 : 1) * THREE.Math.clamp(Math.abs(event.overallVelocityX), 1, 2);

    this.panDstQuat.premultiply((new THREE.Quaternion()).setFromAxisAngle(new THREE.Vector3(0, 1, 0), THREE.Math.degToRad(dAngleY)));
    this.panDstQuat.multiply((new THREE.Quaternion()).setFromAxisAngle(new THREE.Vector3(1, 0, 0), THREE.Math.degToRad(dAngleX)));

    var cameraLook = this.cameraLook;

    cameraLook.t = this.isMobile?0.1:0.0;
    cameraLook.e = this.panDstQuat.clone();

    if(cameraLook.d !== null){
      cameraLook.s = cameraLook.d;
    }
  }

	this.update = function( delta ) {
	  if ( this.enabled === false ) return;

	  var requestRender = false;

		var actualMoveSpeed = delta * (this.movementSpeed*(this.fastForward?8.0:1.0));

		if ( this.moveForward ) this.object.translateZ( - actualMoveSpeed  ), requestRender=true;
		if ( this.moveBackward ) this.object.translateZ( actualMoveSpeed ), requestRender=true;

		if ( this.moveLeft ) this.object.translateX( - actualMoveSpeed ), requestRender=true;
		if ( this.moveRight ) this.object.translateX( actualMoveSpeed ), requestRender=true;

		if ( this.moveUp ) this.object.translateY( actualMoveSpeed ), requestRender=true;
		if ( this.moveDown ) this.object.translateY( - actualMoveSpeed ), requestRender=true;

		if(this.cameraLook.e !== null && this.cameraLook.t < 0.9999){
      var cameraLook = this.cameraLook;
      var actualLookSpeed = delta * this.lookSpeed * this.panSpeed;

      cameraLook.t += actualLookSpeed * (cameraLook.t >0.8?5:1);
      cameraLook.t = THREE.Math.clamp(cameraLook.t, 0, 1);

      //console.log("slerp ", cameraLook.t, "speed", actualLookSpeed);

      var nextRotation = new THREE.Quaternion();
      THREE.Quaternion.slerp(cameraLook.s, cameraLook.e, nextRotation, THREE.Math.clamp(Math.log10(1.0 + (cameraLook.t*9.0)) , 0, 1));

      this.cameraLook.d = nextRotation.clone();

      this.object.quaternion.copy(nextRotation);

      requestRender = true;
    }

    if(requestRender){
      this.dispatchEvent(changeEvent);
    }
	};

	function contextmenu( event ) {

		event.preventDefault();

	}

	this.dispose = function() {
		this.domElement.removeEventListener( 'contextmenu', contextmenu, false );
    this.hammerManager.destroy();
		window.removeEventListener( 'keydown', _onKeyDown, false );
		window.removeEventListener( 'keyup', _onKeyUp, false );
    this.domElement.style.cursor = this.elementPrevCursor;
	};

	var _handlePanBegin = bind(this, this.onBeginPan);
	var _handlePanEnd = bind(this, this.onEndPan);
	var _handlePan = bind(this, this.onPanned);
	var _onKeyDown = bind( this, this.onKeyDown );
	var _onKeyUp = bind( this, this.onKeyUp );

	this.domElement.addEventListener( 'contextmenu', contextmenu, false );

  this.hammerManager.on("panstart", _handlePanBegin);
  this.hammerManager.on("panmove", _handlePan);
  this.hammerManager.on("panend", _handlePanEnd);
  this.hammerManager.on("pancancel", _handlePanEnd);

	window.addEventListener( 'keydown', _onKeyDown, false );
	window.addEventListener( 'keyup', _onKeyUp, false );

  this.elementPrevCursor = this.domElement.style.cursor;
  this.domElement.style.cursor = "grab";
  if(this.domElement.style.cursor === ""){
    this.domElement.style.cursor = "-webkit-grab";
  }

	function bind( scope, fn ) {

		return function () {

			fn.apply( scope, arguments );

		};

	}

	this.handleResize();

};

THREE.ExpiviFirstPersonControls.prototype = Object.create( THREE.EventDispatcher.prototype );
THREE.ExpiviFirstPersonControls.prototype.constructor = THREE.ExpiviFirstPersonControls;

/**
 * @author qiao / https://github.com/qiao
 * @author mrdoob / http://mrdoob.com
 * @author alteredq / http://alteredqualia.com/
 * @author WestLangley / http://github.com/WestLangley
 * @author erich666 / http://erichaines.com
 */

// This set of controls performs orbiting, dollying (zooming), and panning.
// Unlike TrackballControls, it maintains the "up" direction object.up (+Y by default).
//
//    Orbit - left mouse / touch: one-finger move
//    Zoom - middle mouse, or mousewheel / touch: two-finger spread or squish
//    Pan - right mouse, or arrow keys / touch: two-finger move

THREE.ExpiviOrbitControls = function ( object, domElement ) {

	this.object = object;

	this.domElement = ( domElement !== undefined ) ? domElement : document;

	// Set to false to disable this control
	this.enabled = true;

	// "target" sets the location of focus, where the object orbits around
	this.target = new THREE.Vector3();

	// How far you can dolly in and out ( PerspectiveCamera only )
	this.minDistance = 0;
	this.maxDistance = Infinity;

	// How far you can zoom in and out ( OrthographicCamera only )
	this.minZoom = 0;
	this.maxZoom = Infinity;

	// How far you can orbit vertically, upper and lower limits.
	// Range is 0 to Math.PI radians.
	this.minPolarAngle = 0; // radians
	this.maxPolarAngle = Math.PI; // radians

	// How far you can orbit horizontally, upper and lower limits.
	// If set, must be a sub-interval of the interval [ - Math.PI, Math.PI ].
	this.minAzimuthAngle = - Infinity; // radians
	this.maxAzimuthAngle = Infinity; // radians

	// Set to true to enable damping (inertia)
	// If damping is enabled, you must call controls.update() in your animation loop
	this.enableDamping = false;
	this.dampingFactor = 0.25;

	// This option actually enables dollying in and out; left as "zoom" for backwards compatibility.
	// Set to false to disable zooming
	this.enableZoom = true;
	this.zoomSpeed = 1.0;

	// Set to false to disable rotating
	this.enableRotate = true;
	this.rotateSpeed = 1.0;

	// Set to false to disable panning
	this.enablePan = true;
	this.panSpeed = 1.0;
	this.screenSpacePanning = false; // if true, pan in screen-space
	this.keyPanSpeed = 7.0;	// pixels moved per arrow key push

	// Set to true to automatically rotate around the target
	// If auto-rotate is enabled, you must call controls.update() in your animation loop
	this.autoRotate = false;
	this.autoRotateSpeed = 2.0; // 30 seconds per round when fps is 60

	// Set to false to disable use of the keys
	this.enableKeys = true;

	// The four arrow keys
	this.keys = { LEFT: 37, UP: 38, RIGHT: 39, BOTTOM: 40 };

	// Mouse buttons
	this.mouseButtons = { ORBIT: THREE.MOUSE.LEFT, ZOOM: THREE.MOUSE.MIDDLE, PAN: THREE.MOUSE.RIGHT };

	// for reset
	this.target0 = this.target.clone();
	this.position0 = this.object.position.clone();
	this.zoom0 = this.object.zoom;

	// Touch settings
    this.blockDefaultTouch = true;

	//
	// public methods
	//

	this.getPolarAngle = function () {

		return spherical.phi;

	};

	this.getAzimuthalAngle = function () {

		return spherical.theta;

	};

	this.saveState = function () {

		scope.target0.copy( scope.target );
		scope.position0.copy( scope.object.position );
		scope.zoom0 = scope.object.zoom;

	};

	this.reset = function () {

		scope.target.copy( scope.target0 );
		scope.object.position.copy( scope.position0 );
		scope.object.zoom = scope.zoom0;

		scope.object.updateProjectionMatrix();
		scope.dispatchEvent( changeEvent );

		scope.update();

		state = STATE.NONE;

	};

	// this method is exposed, but perhaps it would be better if we can make it private...
	this.update = function () {

		var offset = new THREE.Vector3();

		// so camera.up is the orbit axis
		var quat = new THREE.Quaternion().setFromUnitVectors( object.up, new THREE.Vector3( 0, 1, 0 ) );
		var quatInverse = quat.clone().inverse();

		var lastPosition = new THREE.Vector3();
		var lastQuaternion = new THREE.Quaternion();

		return function update() {

			var position = scope.object.position;

			offset.copy( position ).sub( scope.target );

			// rotate offset to "y-axis-is-up" space
			offset.applyQuaternion( quat );

			// angle from z-axis around y-axis
			spherical.setFromVector3( offset );

			if ( scope.autoRotate && state === STATE.NONE ) {

				rotateLeft( getAutoRotationAngle() );

			}

			spherical.theta += sphericalDelta.theta;
			spherical.phi += sphericalDelta.phi;

			// restrict theta to be between desired limits
			spherical.theta = Math.max( scope.minAzimuthAngle, Math.min( scope.maxAzimuthAngle, spherical.theta ) );

			// restrict phi to be between desired limits
			spherical.phi = Math.max( scope.minPolarAngle, Math.min( scope.maxPolarAngle, spherical.phi ) );

			spherical.makeSafe();


			spherical.radius *= scale;

			// restrict radius to be between desired limits
			spherical.radius = Math.max( scope.minDistance, Math.min( scope.maxDistance, spherical.radius ) );

			// move target to panned location
			scope.target.add( panOffset );

			offset.setFromSpherical( spherical );

			// rotate offset back to "camera-up-vector-is-up" space
			offset.applyQuaternion( quatInverse );

			position.copy( scope.target ).add( offset );

			scope.object.lookAt( scope.target );

			if ( scope.enableDamping === true ) {

				sphericalDelta.theta *= ( 1 - scope.dampingFactor );
				sphericalDelta.phi *= ( 1 - scope.dampingFactor );

				panOffset.multiplyScalar( 1 - scope.dampingFactor );

			} else {

				sphericalDelta.set( 0, 0, 0 );

				panOffset.set( 0, 0, 0 );

			}

			scale = 1;

			// update condition is:
			// min(camera displacement, camera rotation in radians)^2 > EPS
			// using small-angle approximation cos(x/2) = 1 - x^2 / 8

			if ( zoomChanged ||
				lastPosition.distanceToSquared( scope.object.position ) > EPS ||
				8 * ( 1 - lastQuaternion.dot( scope.object.quaternion ) ) > EPS ) {

				scope.dispatchEvent( changeEvent );
				scope.dispatchEvent( zoomEvent );

				lastPosition.copy( scope.object.position );
				lastQuaternion.copy( scope.object.quaternion );
				zoomChanged = false;

				return true;

			}

			return false;

		};

	}();

	this.dispose = function () {

		scope.domElement.removeEventListener( 'contextmenu', onContextMenu, false );
		scope.domElement.removeEventListener( 'mousedown', onMouseDown, false );
		scope.domElement.removeEventListener( 'wheel', onMouseWheel, false );

		scope.domElement.removeEventListener( 'touchstart', onTouchStart, false );
		scope.domElement.removeEventListener( 'touchend', onTouchEnd, false );
		scope.domElement.removeEventListener( 'touchmove', onTouchMove, false );

		document.removeEventListener( 'mousemove', onMouseMove, false );
		document.removeEventListener( 'mouseup', onMouseUp, false );

		window.removeEventListener( 'keydown', onKeyDown, false );

		//scope.dispatchEvent( { type: 'dispose' } ); // should this be added here?

	};

	this.resetMouseState = function(){
		document.removeEventListener( 'mousemove', onMouseMove, false );
		document.removeEventListener( 'mouseup', onMouseUp, false );

		state = STATE.NONE;
	};

	//
	// internals
	//

	var scope = this;

	var changeEvent = { type: 'change' };
	var startEvent = { type: 'start' };
	var endEvent = { type: 'end' };
	var zoomEvent = { type: 'zoom' };

	var STATE = { NONE: - 1, ROTATE: 0, DOLLY: 1, PAN: 2, TOUCH_ROTATE: 3, TOUCH_DOLLY_PAN: 4 };

	var state = STATE.NONE;

	var EPS = 0.000001;

	// current position in spherical coordinates
	var spherical = new THREE.Spherical();
	var sphericalDelta = new THREE.Spherical();

	var scale = 1;
	var panOffset = new THREE.Vector3();
	var zoomChanged = false;

	var rotateStart = new THREE.Vector2();
	var rotateEnd = new THREE.Vector2();
	var rotateDelta = new THREE.Vector2();

	var panStart = new THREE.Vector2();
	var panEnd = new THREE.Vector2();
	var panDelta = new THREE.Vector2();

	var dollyStart = new THREE.Vector2();
	var dollyEnd = new THREE.Vector2();
	var dollyDelta = new THREE.Vector2();

	function getAutoRotationAngle() {

		return 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;

	}

	function getZoomScale() {

		return Math.pow( 0.95, scope.zoomSpeed );

	}

	function rotateLeft( angle ) {

		sphericalDelta.theta -= angle;

	}

	function rotateUp( angle ) {

		sphericalDelta.phi -= angle;

	}

	var panLeft = function () {

		var v = new THREE.Vector3();

		return function panLeft( distance, objectMatrix ) {

			v.setFromMatrixColumn( objectMatrix, 0 ); // get X column of objectMatrix
			v.multiplyScalar( - distance );

			panOffset.add( v );

		};

	}();

	var panUp = function () {

		var v = new THREE.Vector3();

		return function panUp( distance, objectMatrix ) {

			if ( scope.screenSpacePanning === true ) {

				v.setFromMatrixColumn( objectMatrix, 1 );

			} else {

				v.setFromMatrixColumn( objectMatrix, 0 );
				v.crossVectors( scope.object.up, v );

			}

			v.multiplyScalar( distance );

			panOffset.add( v );

		};

	}();

	// deltaX and deltaY are in pixels; right and down are positive
	var pan = function () {

		var offset = new THREE.Vector3();

		return function pan( deltaX, deltaY ) {

			var element = scope.domElement === document ? scope.domElement.body : scope.domElement;

			if ( scope.object.isPerspectiveCamera ) {

				// perspective
				var position = scope.object.position;
				offset.copy( position ).sub( scope.target );
				var targetDistance = offset.length();

				// half of the fov is center to top of screen
				targetDistance *= Math.tan( ( scope.object.fov / 2 ) * Math.PI / 180.0 );

				// we use only clientHeight here so aspect ratio does not distort speed
				panLeft( 2 * deltaX * targetDistance / element.clientHeight, scope.object.matrix );
				panUp( 2 * deltaY * targetDistance / element.clientHeight, scope.object.matrix );

			} else if ( scope.object.isOrthographicCamera ) {

				// orthographic
				panLeft( deltaX * ( scope.object.right - scope.object.left ) / scope.object.zoom / element.clientWidth, scope.object.matrix );
				panUp( deltaY * ( scope.object.top - scope.object.bottom ) / scope.object.zoom / element.clientHeight, scope.object.matrix );

			} else {

				// camera neither orthographic nor perspective
				console.warn( 'WARNING: ExpiviOrbitControls.js encountered an unknown camera type - pan disabled.' );
				scope.enablePan = false;

			}

		};

	}();

	function dollyIn( dollyScale ) {

		if ( scope.object.isPerspectiveCamera ) {

			scale /= dollyScale;

		} else if ( scope.object.isOrthographicCamera ) {

			scope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom * dollyScale ) );
			scope.object.updateProjectionMatrix();
			zoomChanged = true;

		} else {

			console.warn( 'WARNING: ExpiviOrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );
			scope.enableZoom = false;

		}

	}

	function dollyOut( dollyScale ) {

		if ( scope.object.isPerspectiveCamera ) {

			scale *= dollyScale;

		} else if ( scope.object.isOrthographicCamera ) {

			scope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom / dollyScale ) );
			scope.object.updateProjectionMatrix();
			zoomChanged = true;

		} else {

			console.warn( 'WARNING: ExpiviOrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );
			scope.enableZoom = false;

		}

	}

	//
	// event callbacks - update the object state
	//

	function handleMouseDownRotate( event ) {

		//console.log( 'handleMouseDownRotate' );

		rotateStart.set( event.clientX, event.clientY );

	}

	function handleMouseDownDolly( event ) {

		//console.log( 'handleMouseDownDolly' );

		dollyStart.set( event.clientX, event.clientY );

	}

	function handleMouseDownPan( event ) {

		//console.log( 'handleMouseDownPan' );

		panStart.set( event.clientX, event.clientY );

	}

	function handleMouseMoveRotate( event ) {

		//console.log( 'handleMouseMoveRotate' );

		rotateEnd.set( event.clientX, event.clientY );

		rotateDelta.subVectors( rotateEnd, rotateStart ).multiplyScalar( scope.rotateSpeed );

		var element = scope.domElement === document ? scope.domElement.body : scope.domElement;

		// rotating across whole screen goes 360 degrees around
		rotateLeft( 2 * Math.PI * rotateDelta.x / element.clientWidth );

		// rotating up and down along whole screen attempts to go 360, but limited to 180
		rotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );

		rotateStart.copy( rotateEnd );

		scope.update();

	}

	function handleMouseMoveDolly( event ) {

		//console.log( 'handleMouseMoveDolly' );

		dollyEnd.set( event.clientX, event.clientY );

		dollyDelta.subVectors( dollyEnd, dollyStart );

		if ( dollyDelta.y > 0 ) {

			dollyIn( getZoomScale() );

		} else if ( dollyDelta.y < 0 ) {

			dollyOut( getZoomScale() );

		}

		dollyStart.copy( dollyEnd );

		scope.update();

	}

	function handleMouseMovePan( event ) {

		//console.log( 'handleMouseMovePan' );

		panEnd.set( event.clientX, event.clientY );

		panDelta.subVectors( panEnd, panStart ).multiplyScalar( scope.panSpeed );

		pan( panDelta.x, panDelta.y );

		panStart.copy( panEnd );

		scope.update();

	}

	function handleMouseUp( event ) {

		// console.log( 'handleMouseUp' );

	}

	function handleMouseWheel( event ) {

		// console.log( 'handleMouseWheel' );

		if ( event.deltaY < 0 ) {

			dollyOut( getZoomScale() );

		} else if ( event.deltaY > 0 ) {

			dollyIn( getZoomScale() );

		}

		scope.update();

	}

	function handleKeyDown( event ) {

		//console.log( 'handleKeyDown' );

		switch ( event.keyCode ) {

			case scope.keys.UP:
				pan( 0, scope.keyPanSpeed );
				scope.update();
				break;

			case scope.keys.BOTTOM:
				pan( 0, - scope.keyPanSpeed );
				scope.update();
				break;

			case scope.keys.LEFT:
				pan( scope.keyPanSpeed, 0 );
				scope.update();
				break;

			case scope.keys.RIGHT:
				pan( - scope.keyPanSpeed, 0 );
				scope.update();
				break;

		}

	}

	function handleTouchStartRotate( event ) {

		//console.log( 'handleTouchStartRotate' );

		rotateStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );

	}

	function handleTouchStartDollyPan( event ) {

		//console.log( 'handleTouchStartDollyPan' );

		if ( scope.enableZoom ) {

			var dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;
			var dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;

			var distance = Math.sqrt( dx * dx + dy * dy );

			dollyStart.set( 0, distance );

		}

		if ( scope.enablePan ) {

			var x = 0.5 * ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX );
			var y = 0.5 * ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY );

			panStart.set( x, y );

		}

	}

	function handleTouchMoveRotate( event ) {

		//console.log( 'handleTouchMoveRotate' );

		rotateEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );

		rotateDelta.subVectors( rotateEnd, rotateStart ).multiplyScalar( scope.rotateSpeed );

		var element = scope.domElement === document ? scope.domElement.body : scope.domElement;

		// rotating across whole screen goes 360 degrees around
		rotateLeft( 2 * Math.PI * rotateDelta.x / element.clientWidth );

		// rotating up and down along whole screen attempts to go 360, but limited to 180
		rotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );

		rotateStart.copy( rotateEnd );

		scope.update();

	}

	function handleTouchMoveDollyPan( event ) {

		//console.log( 'handleTouchMoveDollyPan' );

		if ( scope.enableZoom ) {

			var dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;
			var dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;

			var distance = Math.sqrt( dx * dx + dy * dy );

			dollyEnd.set( 0, distance );

			dollyDelta.set( 0, Math.pow( dollyEnd.y / dollyStart.y, scope.zoomSpeed ) );

			dollyIn( dollyDelta.y );

			dollyStart.copy( dollyEnd );

		}

		if ( scope.enablePan ) {

			var x = 0.5 * ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX );
			var y = 0.5 * ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY );

			panEnd.set( x, y );

			panDelta.subVectors( panEnd, panStart ).multiplyScalar( scope.panSpeed );

			pan( panDelta.x, panDelta.y );

			panStart.copy( panEnd );

		}

		scope.update();

	}

	function handleTouchEnd( event ) {

		//console.log( 'handleTouchEnd' );

	}

	//
	// event handlers - FSM: listen for events and reset state
	//

	function onMouseDown( event ) {

		if ( scope.enabled === false ) return;

		event.preventDefault();

		switch ( event.button ) {

			case scope.mouseButtons.ORBIT:

				if ( scope.enableRotate === false ) return;

				handleMouseDownRotate( event );

				state = STATE.ROTATE;

				break;

			case scope.mouseButtons.ZOOM:

				if ( scope.enableZoom === false ) return;

				handleMouseDownDolly( event );

				state = STATE.DOLLY;

				break;

			case scope.mouseButtons.PAN:

				if ( scope.enablePan === false ) return;

				handleMouseDownPan( event );

				state = STATE.PAN;

				break;

		}

		if ( state !== STATE.NONE ) {

			document.addEventListener( 'mousemove', onMouseMove, false );
			document.addEventListener( 'mouseup', onMouseUp, false );

			scope.dispatchEvent( startEvent );

		}

	}

	function onMouseMove( event ) {

		if ( scope.enabled === false ) return;

		event.preventDefault();

		switch ( state ) {

			case STATE.ROTATE:

				if ( scope.enableRotate === false ) return;

				handleMouseMoveRotate( event );

				break;

			case STATE.DOLLY:

				if ( scope.enableZoom === false ) return;

				handleMouseMoveDolly( event );

				break;

			case STATE.PAN:

				if ( scope.enablePan === false ) return;

				handleMouseMovePan( event );

				break;

		}

	}

	function onMouseUp( event ) {

		if ( scope.enabled === false ) return;

		handleMouseUp( event );

		document.removeEventListener( 'mousemove', onMouseMove, false );
		document.removeEventListener( 'mouseup', onMouseUp, false );

		scope.dispatchEvent( endEvent );

		state = STATE.NONE;

	}

	function onMouseWheel( event ) {

		if ( scope.enabled === false || scope.enableZoom === false || ( state !== STATE.NONE && state !== STATE.ROTATE ) ) return;

		event.preventDefault();
		event.stopPropagation();

		scope.dispatchEvent( startEvent );

		handleMouseWheel( event );

		scope.dispatchEvent( endEvent );

	}

	function onKeyDown( event ) {

		if ( scope.enabled === false || scope.enableKeys === false || scope.enablePan === false ) return;

		handleKeyDown( event );

	}

	function onTouchStart( event ) {

		if ( scope.enabled === false ) return;

		if ( scope.blockDefaultTouch === true) event.preventDefault();

		switch ( event.touches.length ) {

			case 1:	// one-fingered touch: rotate

				if ( scope.enableRotate === false ) return;

				handleTouchStartRotate( event );

				state = STATE.TOUCH_ROTATE;

				break;

			case 2:	// two-fingered touch: dolly-pan

				if ( scope.enableZoom === false && scope.enablePan === false ) return;

				handleTouchStartDollyPan( event );

				state = STATE.TOUCH_DOLLY_PAN;

				break;

			default:

				state = STATE.NONE;

		}

		if ( state !== STATE.NONE ) {

			scope.dispatchEvent( startEvent );

		}

	}

	function onTouchMove( event ) {

		if ( scope.enabled === false ) return;

        if ( scope.blockDefaultTouch === true ) {
            event.preventDefault();
		    event.stopPropagation();
        }

		switch ( event.touches.length ) {

			case 1: // one-fingered touch: rotate

				if ( scope.enableRotate === false ) return;
				if ( state !== STATE.TOUCH_ROTATE ) return; // is this needed?

				handleTouchMoveRotate( event );

				break;

			case 2: // two-fingered touch: dolly-pan

				if ( scope.enableZoom === false && scope.enablePan === false ) return;
				if ( state !== STATE.TOUCH_DOLLY_PAN ) return; // is this needed?

				handleTouchMoveDollyPan( event );

				break;

			default:

				state = STATE.NONE;

		}

	}

	function onTouchEnd( event ) {

		if ( scope.enabled === false ) return;

		handleTouchEnd( event );

		scope.dispatchEvent( endEvent );

		state = STATE.NONE;

	}

	function onContextMenu( event ) {

		if ( scope.enabled === false ) return;

		event.preventDefault();

	}

	//

	scope.domElement.addEventListener( 'contextmenu', onContextMenu, false );

	scope.domElement.addEventListener( 'mousedown', onMouseDown, false );
	scope.domElement.addEventListener( 'wheel', onMouseWheel, false );

	scope.domElement.addEventListener( 'touchstart', onTouchStart, false );
	scope.domElement.addEventListener( 'touchend', onTouchEnd, false );
	scope.domElement.addEventListener( 'touchmove', onTouchMove, false );

	window.addEventListener( 'keydown', onKeyDown, false );

	// force an update at start

	this.update();

};

THREE.ExpiviOrbitControls.prototype = Object.create( THREE.EventDispatcher.prototype );
THREE.ExpiviOrbitControls.prototype.constructor = THREE.ExpiviOrbitControls;


Object.defineProperties( THREE.ExpiviOrbitControls.prototype, {

	center: {

		get: function () {

			console.warn( 'THREE.ExpiviOrbitControls: .center has been renamed to .target' );
			return this.target;

		}

	},

	// backward compatibility

	noZoom: {

		get: function () {

			console.warn( 'THREE.ExpiviOrbitControls: .noZoom has been deprecated. Use .enableZoom instead.' );
			return ! this.enableZoom;

		},

		set: function ( value ) {

			console.warn( 'THREE.ExpiviOrbitControls: .noZoom has been deprecated. Use .enableZoom instead.' );
			this.enableZoom = ! value;

		}

	},

	noRotate: {

		get: function () {

			console.warn( 'THREE.ExpiviOrbitControls: .noRotate has been deprecated. Use .enableRotate instead.' );
			return ! this.enableRotate;

		},

		set: function ( value ) {

			console.warn( 'THREE.ExpiviOrbitControls: .noRotate has been deprecated. Use .enableRotate instead.' );
			this.enableRotate = ! value;

		}

	},

	noPan: {

		get: function () {

			console.warn( 'THREE.ExpiviOrbitControls: .noPan has been deprecated. Use .enablePan instead.' );
			return ! this.enablePan;

		},

		set: function ( value ) {

			console.warn( 'THREE.ExpiviOrbitControls: .noPan has been deprecated. Use .enablePan instead.' );
			this.enablePan = ! value;

		}

	},

	noKeys: {

		get: function () {

			console.warn( 'THREE.ExpiviOrbitControls: .noKeys has been deprecated. Use .enableKeys instead.' );
			return ! this.enableKeys;

		},

		set: function ( value ) {

			console.warn( 'THREE.ExpiviOrbitControls: .noKeys has been deprecated. Use .enableKeys instead.' );
			this.enableKeys = ! value;

		}

	},

	staticMoving: {

		get: function () {

			console.warn( 'THREE.ExpiviOrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.' );
			return ! this.enableDamping;

		},

		set: function ( value ) {

			console.warn( 'THREE.ExpiviOrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.' );
			this.enableDamping = ! value;

		}

	},

	dynamicDampingFactor: {

		get: function () {

			console.warn( 'THREE.ExpiviOrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.' );
			return this.dampingFactor;

		},

		set: function ( value ) {

			console.warn( 'THREE.ExpiviOrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.' );
			this.dampingFactor = value;

		}

	}

} );

/**
 * TurntableControls
 * @param {*} camera The camera used for zoom
 * @param {*} object The object should be used as turntable
 * @param {*} target Position of the pivot of rotation
 * @param {*} axis The axis of the rotation
 * @param {*} domElement The domElement for attaching events
 */
var TurntableControls = function ( camera, object, target, axis, domElement ) {
	if ( domElement === undefined ) console.warn( 'TurntableControls: The second parameter "domElement" is now mandatory.' );
	if ( domElement === document ) console.error( 'TurntableControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.' );

    this.camera = camera;
	this.object = object || new THREE.Object3D();
    this.domElement = domElement;
    this.target = target || new THREE.Vector3(0, 0, 0);
    this.axis = axis || new THREE.Vector3(0, 1, 0);

	// Set to false to disable this control
    this.enabled = true;
    
    this.MOUSE = {
        LEFT: 0,
        MIDDLE: 1,
        RIGHT: 2,
    
        ROTATE: 0,
        DOLLY: 1
    }
    this.TOUCH = {
        ROTATE: 0,
        DOLLY_ROTATE: 1
    };

	// How far you can dolly in and out
	this.minDistance = 0;
	this.maxDistance = Infinity;

    // How far you can zoom in and out
	this.minZoom = 0;
	this.maxZoom = Infinity;

	// How far you can orbit vertically, upper and lower limits.
	// Range is 0 to Math.PI radians.
	this.minPolarAngle = 0; // radians
	this.maxPolarAngle = Math.PI; // radians

	// How far you can orbit horizontally, upper and lower limits.
	// If set, must be a sub-interval of the interval [ - Math.PI, Math.PI ].
	this.minAzimuthAngle = - Infinity; // radians
	this.maxAzimuthAngle = Infinity; // radians

	// Set to true to enable damping (inertia)
	// If damping is enabled, you must call controls.update() in your animation loop
	this.enableDamping = false;
	this.dampingFactor = 0.05;

	// This option actually enables dollying in and out; left as "zoom" for backwards compatibility.
	// Set to false to disable zooming
	this.enableZoom = true;
	this.zoomSpeed = 1.0;

	// Set to false to disable rotating
	this.enableRotate = true;
	this.rotateSpeed = 1.0;

	// Set to true to automatically rotate around the target
	// If auto-rotate is enabled, you must call controls.update() in your animation loop
	this.autoRotate = false;
	this.autoRotateSpeed = 2.0; // 30 seconds per round when fps is 60

	// Mouse buttons
	this.mouseButtons = { LEFT: this.MOUSE.ROTATE, MIDDLE: this.MOUSE.DOLLY, RIGHT: this.MOUSE.ROTATE };

	// Touch fingers
	this.touches = { ONE: this.TOUCH.ROTATE, TWO: this.TOUCH.DOLLY_ROTATE };

	// for reset
    this.position0 = this.object.position.clone();
    this.quaternion0 = this.object.quaternion.clone();
	this.zoom0 = this.camera.zoom;

	//
	// public methods
	//
	this.getPolarAngle = function () {
		return spherical.phi;
	};

	this.getAzimuthalAngle = function () {
		return spherical.theta;
	};

	this.saveState = function () {
        //scope.position0.copy( scope.object.position );
        scope.quaternion0.copy( scope.object.quaternion );
		scope.zoom0 = scope.camera.zoom;
	};

	this.reset = function () {
        //scope.object.position.copy( scope.position0 );
        scope.object.quaternion.copy( scope.quaternion0 );
		scope.camera.zoom = scope.zoom0;

		scope.camera.updateProjectionMatrix();
        //scope.dispatchEvent( changeEvent );
        scope.dispatchEvent({ type: changeEvent.type, state: 'reset' });

		scope.update();

		state = STATE.NONE;
	};

	// this method is exposed, but perhaps it would be better if we can make it private...
	this.update = function () {
		var lastPosition = new THREE.Vector3();
        var lastQuaternion = new THREE.Quaternion();

        var startRotation = object.quaternion.clone();

		return function update() {
            // auto rotate if enabled
			if ( scope.autoRotate && state === STATE.NONE ) {
				rotateLeft( getAutoRotationAngle() );
			}

            // add theta/phi with damping if enabled
			if ( scope.enableDamping ) {
				spherical.theta += sphericalDelta.theta * scope.dampingFactor;
				spherical.phi += sphericalDelta.phi * scope.dampingFactor;
			} else {
				spherical.theta += sphericalDelta.theta;
				spherical.phi += sphericalDelta.phi;
			}

			// restrict theta to be between desired limits
			spherical.theta = Math.max( scope.minAzimuthAngle, Math.min( scope.maxAzimuthAngle, spherical.theta ) );
            
            // restrict phi to be between desired limits
			spherical.phi = Math.max( scope.minPolarAngle, Math.min( scope.maxPolarAngle, spherical.phi ) );
            
            // make spherical safe when polar is not set to Infinite
            if (scope.minPolarAngle !== -Infinity && scope.maxPolarAngle !== Infinity) {
                spherical.makeSafe();
            }

			spherical.radius *= scale;
			// restrict radius to be between desired limits
            spherical.radius = Math.max( scope.minDistance, Math.min( scope.maxDistance, spherical.radius ) );

            // Conversion from Spherical Coordinates to Quaternion which we can apply on object
            var angle = this.axis.y > 0 ? spherical.theta : spherical.phi;
            var objQuat = new THREE.Quaternion().setFromAxisAngle(this.axis, -angle);
            scope.object.quaternion.copy(startRotation.clone().multiply(objQuat));

			if ( scope.enableDamping === true ) {
				sphericalDelta.theta *= ( 1 - scope.dampingFactor );
				sphericalDelta.phi *= ( 1 - scope.dampingFactor );
			} else {
				sphericalDelta.set( 0, 0, 0 );
			}

			scale = 1;

			// update condition is:
			// min(camera displacement, camera rotation in radians)^2 > EPS
			// using small-angle approximation cos(x/2) = 1 - x^2 / 8

			if ( zoomChanged ||
				lastPosition.distanceToSquared( scope.object.position ) > EPS ||
				8 * ( 1 - lastQuaternion.dot( scope.object.quaternion ) ) > EPS ) {

                //scope.dispatchEvent( changeEvent );
                scope.dispatchEvent({ type: changeEvent.type, state: 'any' });

				lastPosition.copy( scope.object.position );
				lastQuaternion.copy( scope.object.quaternion );
				zoomChanged = false;
				return true;
			}
			return false;
		};

	}();

	this.dispose = function () {

		scope.domElement.removeEventListener( 'contextmenu', onContextMenu, false );
		scope.domElement.removeEventListener( 'mousedown', onMouseDown, false );
		scope.domElement.removeEventListener( 'wheel', onMouseWheel, false );

		scope.domElement.removeEventListener( 'touchstart', onTouchStart, false );
		scope.domElement.removeEventListener( 'touchend', onTouchEnd, false );
		scope.domElement.removeEventListener( 'touchmove', onTouchMove, false );

		document.removeEventListener( 'mousemove', onMouseMove, false );
		document.removeEventListener( 'mouseup', onMouseUp, false );

		//scope.dispatchEvent( { type: 'dispose' } ); // should this be added here?

	};

	//
	// internals
	//

	var scope = this;

    var changeEvent = { type: 'change' };
	var startEvent = { type: 'start' };
	var endEvent = { type: 'end' };
	var zoomEvent = { type: 'zoom' };

	var STATE = {
		NONE: - 1,
		ROTATE: 0,
		DOLLY: 1,
		TOUCH_ROTATE: 2,
		TOUCH_DOLLY_ROTATE: 3
	};

	var state = STATE.NONE;

	var EPS = 0.000001;

	// current position in spherical coordinates
	var spherical = new THREE.Spherical();
	var sphericalDelta = new THREE.Spherical();

	var scale = 1;
	var zoomChanged = false;

	var rotateStart = new THREE.Vector2();
	var rotateEnd = new THREE.Vector2();
	var rotateDelta = new THREE.Vector2();

	var dollyStart = new THREE.Vector2();
	var dollyEnd = new THREE.Vector2();
	var dollyDelta = new THREE.Vector2();

	function getAutoRotationAngle() {
		return 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;
	}

	function getZoomScale() {
		return Math.pow( 0.95, scope.zoomSpeed );
	}

	function rotateLeft( angle ) {
		sphericalDelta.theta -= angle;
	}

	function rotateUp( angle ) {
		sphericalDelta.phi -= angle;
	}

	function dollyOut( dollyScale ) {
		if ( scope.camera.isPerspectiveCamera ) {
            scale /= dollyScale;
            scope.dispatchEvent({ type: zoomEvent.type, state: 'zoom-out' });
		} else if ( scope.camera.isOrthographicCamera ) {
			scope.camera.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.camera.zoom * dollyScale ) );
			scope.camera.updateProjectionMatrix();
            zoomChanged = true;
            scope.dispatchEvent({ type: zoomEvent.type, state: 'zoom-out' });
		} else {
			console.warn( 'WARNING: TurntableControls.js encountered an unknown camera type - dolly/zoom disabled.' );
			scope.enableZoom = false;
		}
	}

	function dollyIn( dollyScale ) {
		if ( scope.camera.isPerspectiveCamera ) {
            scale *= dollyScale;
            scope.dispatchEvent({ type: zoomEvent.type, state: 'zoom-in' });
		} else if ( scope.camera.isOrthographicCamera ) {
			scope.camera.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.camera.zoom / dollyScale ) );
			scope.camera.updateProjectionMatrix();
            zoomChanged = true;
            scope.dispatchEvent({ type: zoomEvent.type, state: 'zoom-in' });
		} else {
			console.warn( 'WARNING: TurntableControls.js encountered an unknown camera type - dolly/zoom disabled.' );
			scope.enableZoom = false;
		}
	}

	//
	// event callbacks - update the object state
	//
	function handleMouseDownRotate( event ) {
		rotateStart.set( event.clientX, event.clientY );
	}

	function handleMouseDownDolly( event ) {
		dollyStart.set( event.clientX, event.clientY );
	}

	function handleMouseMoveRotate( event ) {
		rotateEnd.set( event.clientX, event.clientY );

		rotateDelta.subVectors( rotateEnd, rotateStart ).multiplyScalar( scope.rotateSpeed );

		var element = scope.domElement;

		rotateLeft( 2 * Math.PI * rotateDelta.x / element.clientHeight ); // yes, height

        rotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );

		rotateStart.copy( rotateEnd );

		scope.update();
	}

	function handleMouseMoveDolly( event ) {
		dollyEnd.set( event.clientX, event.clientY );

		dollyDelta.subVectors( dollyEnd, dollyStart );

		if ( dollyDelta.y > 0 ) {
			dollyOut( getZoomScale() );
		} else if ( dollyDelta.y < 0 ) {
			dollyIn( getZoomScale() );
		}

		dollyStart.copy( dollyEnd );

		scope.update();
	}

	function handleMouseUp( /*event*/ ) {
		// no-op
	}

	function handleMouseWheel( event ) {
		if ( event.deltaY < 0 ) {
			dollyIn( getZoomScale() );
		} else if ( event.deltaY > 0 ) {
			dollyOut( getZoomScale() );
		}
		scope.update();
	}

	function handleTouchStartRotate( event ) {
		if ( event.touches.length == 1 ) {
			rotateStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );
		} else {
			var x = 0.5 * ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX );
			var y = 0.5 * ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY );

			rotateStart.set( x, y );
		}
	}

	function handleTouchStartDolly( event ) {
		var dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;
		var dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;

		var distance = Math.sqrt( dx * dx + dy * dy );

		dollyStart.set( 0, distance );
	}

	function handleTouchStartDollyRotate( event ) {
		if ( scope.enableZoom ) handleTouchStartDolly( event );

		if ( scope.enableRotate ) handleTouchStartRotate( event );
	}

	function handleTouchMoveRotate( event ) {
		if ( event.touches.length == 1 ) {
			rotateEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );
		} else {
			var x = 0.5 * ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX );
			var y = 0.5 * ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY );

			rotateEnd.set( x, y );
		}

		rotateDelta.subVectors( rotateEnd, rotateStart ).multiplyScalar( scope.rotateSpeed );

		var element = scope.domElement;

		rotateLeft( 2 * Math.PI * rotateDelta.x / element.clientHeight ); // yes, height

		rotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );

		rotateStart.copy( rotateEnd );
	}

	function handleTouchMoveDolly( event ) {
		var dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;
		var dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;

		var distance = Math.sqrt( dx * dx + dy * dy );

		dollyEnd.set( 0, distance );

		dollyDelta.set( 0, Math.pow( dollyEnd.y / dollyStart.y, scope.zoomSpeed ) );

		dollyOut( dollyDelta.y );

		dollyStart.copy( dollyEnd );
	}

	function handleTouchMoveDollyRotate( event ) {
		if ( scope.enableZoom ) handleTouchMoveDolly( event );

		if ( scope.enableRotate ) handleTouchMoveRotate( event );
	}

	function handleTouchEnd( /*event*/ ) {
		// no-op
	}

	//
	// event handlers - FSM: listen for events and reset state
	//

	function onMouseDown( event ) {
		if ( scope.enabled === false ) return;

		// Prevent the browser from scrolling.
		event.preventDefault();

		// Manually set the focus since calling preventDefault above
		// prevents the browser from setting it automatically.

		scope.domElement.focus ? scope.domElement.focus() : window.focus();

		var mouseAction;

		switch ( event.button ) {
			case 0:
				mouseAction = scope.mouseButtons.LEFT;
				break;
			case 1:
				mouseAction = scope.mouseButtons.MIDDLE;
				break;
			case 2:
				mouseAction = scope.mouseButtons.RIGHT;
				break;
			default:
				mouseAction = - 1;
		}

		switch ( mouseAction ) {
			case scope.MOUSE.DOLLY:
				if ( scope.enableZoom === false ) return;
				handleMouseDownDolly( event );
				state = STATE.DOLLY;
				break;
			case scope.MOUSE.ROTATE:
                if ( scope.enableRotate === false ) return;
                handleMouseDownRotate( event );
                state = STATE.ROTATE;
				break;
			default:
				state = STATE.NONE;
		}

		if ( state !== STATE.NONE ) {
			document.addEventListener( 'mousemove', onMouseMove, false );
			document.addEventListener( 'mouseup', onMouseUp, false );

            //scope.dispatchEvent( startEvent );
            switch ( state ) {
                case STATE.ROTATE:
                    scope.dispatchEvent({ type: startEvent.type, state: 'rotate' });
                    break;
                case STATE.PAN:
                    scope.dispatchEvent({ type: startEvent.type, state: 'pan' });
                    break;
                case STATE.DOLLY:
                    scope.dispatchEvent({ type: startEvent.type, state: 'zoom' });
                    break;
                default:
                    scope.dispatchEvent({ type: startEvent.type, state: 'any' });
                    break;
            }
		}
	}

	function onMouseMove( event ) {
		if ( scope.enabled === false ) return;

		event.preventDefault();

		switch ( state ) {
			case STATE.ROTATE:
				if ( scope.enableRotate === false ) return;
				handleMouseMoveRotate( event );
				break;
			case STATE.DOLLY:
				if ( scope.enableZoom === false ) return;
				handleMouseMoveDolly( event );
				break;
		}
	}

	function onMouseUp( event ) {
		if ( scope.enabled === false ) return;

		handleMouseUp( event );

		document.removeEventListener( 'mousemove', onMouseMove, false );
		document.removeEventListener( 'mouseup', onMouseUp, false );

        //scope.dispatchEvent( endEvent );
        switch ( state ) {
            case STATE.ROTATE:
                scope.dispatchEvent({ type: endEvent.type, state: 'rotate' });
                break;
            case STATE.PAN:
                scope.dispatchEvent({ type: endEvent.type, state: 'pan' });
                break;
            case STATE.DOLLY:
                scope.dispatchEvent({ type: endEvent.type, state: 'zoom' });
                break;
            default:
                scope.dispatchEvent({ type: endEvent.type, state: 'any' });
                break;
        }

		state = STATE.NONE;
	}

	function onMouseWheel( event ) {
		if ( scope.enabled === false || scope.enableZoom === false || ( state !== STATE.NONE && state !== STATE.ROTATE ) ) return;

		event.preventDefault();
		event.stopPropagation();

        //scope.dispatchEvent( startEvent );
        scope.dispatchEvent({ type: startEvent.type, state: 'zoom' });

		handleMouseWheel( event );

        //scope.dispatchEvent( endEvent );
        scope.dispatchEvent({ type: endEvent.type, state: 'zoom' });
	}

	function onTouchStart( event ) {
		if ( scope.enabled === false ) return;

		event.preventDefault(); // prevent scrolling

		switch ( event.touches.length ) {
			case 1:
				switch ( scope.touches.ONE ) {
					case scope.TOUCH.ROTATE:
						if ( scope.enableRotate === false ) return;
						handleTouchStartRotate( event );

						state = STATE.TOUCH_ROTATE;
						break;
					default:
						state = STATE.NONE;
				}
				break;
			case 2:
				switch ( scope.touches.TWO ) {
					case scope.TOUCH.DOLLY_ROTATE:
						if ( scope.enableZoom === false && scope.enableRotate === false ) return;
						handleTouchStartDollyRotate( event );
						state = STATE.TOUCH_DOLLY_ROTATE;
						break;
					default:
						state = STATE.NONE;
				}
				break;

			default:
				state = STATE.NONE;
		}

		if ( state !== STATE.NONE ) {
            //scope.dispatchEvent( startEvent );
            switch ( state ) {
                case STATE.TOUCH_ROTATE:
                    scope.dispatchEvent({ type: startEvent.type, state: 'rotate' });
                    break;
                case STATE.TOUCH_DOLLY_PAN:
                    scope.dispatchEvent({ type: startEvent.type, state: 'pan' });
                    scope.dispatchEvent({ type: startEvent.type, state: 'zoom' });
                    break;
                default:
                    scope.dispatchEvent({ type: startEvent.type, state: 'any' });
                    break;
            }
		}
	}

	function onTouchMove( event ) {
		if ( scope.enabled === false ) return;

		event.preventDefault(); // prevent scrolling
		event.stopPropagation();

		switch ( state ) {
			case STATE.TOUCH_ROTATE:
				if ( scope.enableRotate === false ) return;
				handleTouchMoveRotate( event );
				scope.update();
				break;
			case STATE.TOUCH_DOLLY_ROTATE:
                if ( scope.enableZoom === false && scope.enableRotate === false ) return;
				handleTouchMoveDollyRotate( event );
				scope.update();
				break;
			default:
				state = STATE.NONE;
		}
	}

	function onTouchEnd( event ) {
		if ( scope.enabled === false ) return;
		handleTouchEnd( event );
        //scope.dispatchEvent( endEvent );
        switch ( state ) {
            case STATE.TOUCH_ROTATE:
                scope.dispatchEvent({ type: endEvent.type, state: 'rotate' });
                break;
            case STATE.TOUCH_DOLLY_PAN:
                scope.dispatchEvent({ type: endEvent.type, state: 'pan' });
                scope.dispatchEvent({ type: endEvent.type, state: 'zoom' });
                break;
            default:
                scope.dispatchEvent({ type: endEvent.type, state: 'any' });
                break;
        }
		state = STATE.NONE;
	}

	function onContextMenu( event ) {
		if ( scope.enabled === false ) return;
		event.preventDefault();
	}

	//

	scope.domElement.addEventListener( 'contextmenu', onContextMenu, false );

	scope.domElement.addEventListener( 'mousedown', onMouseDown, false );
	scope.domElement.addEventListener( 'wheel', onMouseWheel, false );

	scope.domElement.addEventListener( 'touchstart', onTouchStart, false );
	scope.domElement.addEventListener( 'touchend', onTouchEnd, false );
	scope.domElement.addEventListener( 'touchmove', onTouchMove, false );

	// make sure element can receive keys.
	if ( scope.domElement.tabIndex === - 1 ) {
		scope.domElement.tabIndex = 0;
	}

	// force an update at start
	this.update();
};

TurntableControls.prototype = Object.create( THREE.EventDispatcher.prototype );
TurntableControls.prototype.constructor = TurntableControls;
/**
 * @author mrdoob / http://mrdoob.com/
 */

THREE.OBJExporter = function () {};

THREE.OBJExporter.prototype = {

	constructor: THREE.OBJExporter,

	parse: function ( object ) {

		var output = '';

		var indexVertex = 0;
		var indexVertexUvs = 0;
		var indexNormals = 0;

		var vertex = new THREE.Vector3();
		var normal = new THREE.Vector3();
		var uv = new THREE.Vector2();

		var i, j, k, l, m, face = [];

		var parseMesh = function ( mesh ) {

			var nbVertex = 0;
			var nbNormals = 0;
			var nbVertexUvs = 0;

			var geometry = mesh.geometry;

			var normalMatrixWorld = new THREE.Matrix3();

			if ( geometry instanceof THREE.Geometry ) {

				geometry = new THREE.BufferGeometry().setFromObject( mesh );

			}

			if ( geometry instanceof THREE.BufferGeometry ) {

				// shortcuts
				var vertices = geometry.getAttribute( 'position' );
				var normals = geometry.getAttribute( 'normal' );
				var uvs = geometry.getAttribute( 'uv' );
				var indices = geometry.getIndex();

				// name of the mesh object
				output += 'o ' + mesh.name + '\n';

				// name of the mesh material
				if ( mesh.material && mesh.material.name ) {
					output += 'usemtl ' + mesh.material.name + '\n';
				}

				// vertices

				if( vertices !== undefined ) {

					for ( i = 0, l = vertices.count; i < l; i ++, nbVertex++ ) {

						vertex.x = vertices.getX( i );
						vertex.y = vertices.getY( i );
						vertex.z = vertices.getZ( i );

						// transfrom the vertex to world space
						vertex.applyMatrix4( mesh.matrixWorld );

						// transform the vertex to export format
						output += 'v ' + vertex.x + ' ' + vertex.y + ' ' + vertex.z + '\n';

					}

				}

				// uvs

				if( uvs !== undefined ) {

					for ( i = 0, l = uvs.count; i < l; i ++, nbVertexUvs++ ) {

						uv.x = uvs.getX( i );
						uv.y = uvs.getY( i );

						// transform the uv to export format
						output += 'vt ' + uv.x + ' ' + uv.y + '\n';

					}

				}

				// normals

				if( normals !== undefined ) {

					normalMatrixWorld.getNormalMatrix( mesh.matrixWorld );

					for ( i = 0, l = normals.count; i < l; i ++, nbNormals++ ) {

						normal.x = normals.getX( i );
						normal.y = normals.getY( i );
						normal.z = normals.getZ( i );

						// transfrom the normal to world space
						normal.applyMatrix3( normalMatrixWorld );

						// transform the normal to export format
						output += 'vn ' + normal.x + ' ' + normal.y + ' ' + normal.z + '\n';

					}

				}

				// faces

				if( indices !== null ) {

					for ( i = 0, l = indices.count; i < l; i += 3 ) {

						for( m = 0; m < 3; m ++ ){

							j = indices.getX( i + m ) + 1;

							face[ m ] = ( indexVertex + j ) + '/' + ( uvs ? ( indexVertexUvs + j ) : '' ) + '/' + ( indexNormals + j );

						}

						// transform the face to export format
						output += 'f ' + face.join( ' ' ) + "\n";

					}

				} else {

					for ( i = 0, l = vertices.count; i < l; i += 3 ) {

						for( m = 0; m < 3; m ++ ){

							j = i + m + 1;

							face[ m ] = ( indexVertex + j ) + '/' + ( uvs ? ( indexVertexUvs + j ) : '' ) + '/' + ( indexNormals + j );

						}

						// transform the face to export format
						output += 'f ' + face.join( ' ' ) + "\n";

					}

				}

			} else {

				console.warn( 'THREE.OBJExporter.parseMesh(): geometry type unsupported', geometry );

			}

			// update index
			indexVertex += nbVertex;
			indexVertexUvs += nbVertexUvs;
			indexNormals += nbNormals;

		};

		var parseLine = function( line ) {

			var nbVertex = 0;

			var geometry = line.geometry;
			var type = line.type;

			if ( geometry instanceof THREE.Geometry ) {

				geometry = new THREE.BufferGeometry().setFromObject( line );

			}

			if ( geometry instanceof THREE.BufferGeometry ) {

				// shortcuts
				var vertices = geometry.getAttribute( 'position' );
				var indices = geometry.getIndex();

				// name of the line object
				output += 'o ' + line.name + '\n';

				if( vertices !== undefined ) {

					for ( i = 0, l = vertices.count; i < l; i ++, nbVertex++ ) {

						vertex.x = vertices.getX( i );
						vertex.y = vertices.getY( i );
						vertex.z = vertices.getZ( i );

						// transfrom the vertex to world space
						vertex.applyMatrix4( line.matrixWorld );

						// transform the vertex to export format
						output += 'v ' + vertex.x + ' ' + vertex.y + ' ' + vertex.z + '\n';

					}

				}

				if ( type === 'Line' ) {

					output += 'l ';

					for ( j = 1, l = vertices.count; j <= l; j++ ) {

						output += ( indexVertex + j ) + ' ';

					}

					output += '\n';

				}

				if ( type === 'LineSegments' ) {

					for ( j = 1, k = j + 1, l = vertices.count; j < l; j += 2, k = j + 1 ) {

						output += 'l ' + ( indexVertex + j ) + ' ' + ( indexVertex + k ) + '\n';

					}

				}

			} else {

				console.warn('THREE.OBJExporter.parseLine(): geometry type unsupported', geometry );

			}

			// update index
			indexVertex += nbVertex;

		};

		object.traverse( function ( child ) {

			if ( child instanceof THREE.Mesh &&  child.visible !== false ) {

				parseMesh( child );

			}

			if ( child instanceof THREE.Line && child.visible !== false ) {

				parseLine( child );

			}

		} );

		return output;

	}

};

// Copyright 2016 The Draco Authors.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//      http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
//
'use strict';

/**
 * @param {THREE.LoadingManager} manager
 */
THREE.DRACOLoader = function(manager) {
    this.timeLoaded = 0;
    this.manager = manager || THREE.DefaultLoadingManager;
    this.materials = null;
    this.verbosity = 0;
    this.attributeOptions = {};
    this.drawMode = THREE.TrianglesDrawMode;
    // Native Draco attribute type to Three.JS attribute type.
    this.nativeAttributes = [
      'position',
      'normal',
      'color',
      'uv',
      'uv2'
    ];
};

THREE.DRACOLoader.prototype = {

    constructor: THREE.DRACOLoader,

    load: function(url, onLoad, onProgress, onError) {
        var scope = this;
        var loader = new THREE.FileLoader(scope.manager);
        loader.setPath(this.path);
        loader.setResponseType('arraybuffer');
        if (this.crossOrigin !== undefined) {
          loader.crossOrigin = this.crossOrigin;
        }
        loader.load(url, function(blob) {
            scope.decodeDracoFile(blob, onLoad);
        }, onProgress, onError);
    },

    setPath: function(value) {
        this.path = value;
    },

    setCrossOrigin: function(value) {
        this.crossOrigin = value;
    },

    setVerbosity: function(level) {
        this.verbosity = level;
    },

    /**
     *  Sets desired mode for generated geometry indices.
     *  Can be either:
     *      THREE.TrianglesDrawMode
     *      THREE.TriangleStripDrawMode
     */
    setDrawMode: function(drawMode) {
        this.drawMode = drawMode;
    },

    /**
     * Skips dequantization for a specific attribute.
     * |attributeName| is the THREE.js name of the given attribute type.
     * The only currently supported |attributeName| is 'position', more may be
     * added in future.
     */
    setSkipDequantization: function(attributeName, skip) {
        var skipDequantization = true;
        if (typeof skip !== 'undefined')
          skipDequantization = skip;
        this.getAttributeOptions(attributeName).skipDequantization =
            skipDequantization;
    },

    /**
     * |attributeUniqueIdMap| specifies attribute unique id for an attribute in
     * the geometry to be decoded. The name of the attribute must be one of the
     * supported attribute type in Three.JS, including:
     *     'position',
     *     'color',
     *     'normal',
     *     'uv',
     *     'uv2',
     *     'skinIndex',
     *     'skinWeight'.
     * The format is:
     *     attributeUniqueIdMap[attributeName] = attributeId
     */
    decodeDracoFile: function(rawBuffer, callback, attributeUniqueIdMap,
                              attributeTypeMap) {
      var scope = this;
      THREE.DRACOLoader.getDecoderModule()
          .then( function ( module ) {
            scope.decodeDracoFileInternal( rawBuffer, module.decoder, callback,
              attributeUniqueIdMap || {}, attributeTypeMap || {});
          });
    },

    decodeDracoFileInternal: function(rawBuffer, dracoDecoder, callback,
                                      attributeUniqueIdMap, attributeTypeMap) {
      /*
       * Here is how to use Draco Javascript decoder and get the geometry.
       */
      var buffer = new dracoDecoder.DecoderBuffer();
      buffer.Init(new Int8Array(rawBuffer), rawBuffer.byteLength);
      var decoder = new dracoDecoder.Decoder();

      /*
       * Determine what type is this file: mesh or point cloud.
       */
      var geometryType = decoder.GetEncodedGeometryType(buffer);
      if (geometryType == dracoDecoder.TRIANGULAR_MESH) {
        if (this.verbosity > 0) {
          console.log('Loaded a mesh.');
        }
      } else if (geometryType == dracoDecoder.POINT_CLOUD) {
        if (this.verbosity > 0) {
          console.log('Loaded a point cloud.');
        }
      } else {
        var errorMsg = 'THREE.DRACOLoader: Unknown geometry type.'
        console.error(errorMsg);
        throw new Error(errorMsg);
      }
      callback(this.convertDracoGeometryTo3JS(dracoDecoder, decoder,
          geometryType, buffer, attributeUniqueIdMap, attributeTypeMap));
    },

    addAttributeToGeometry: function(dracoDecoder, decoder, dracoGeometry,
                                     attributeName, attributeType, attribute,
                                     geometry, geometryBuffer) {
      if (attribute.ptr === 0) {
        var errorMsg = 'THREE.DRACOLoader: No attribute ' + attributeName;
        console.error(errorMsg);
        throw new Error(errorMsg);
      }

      var numComponents = attribute.num_components();
      var numPoints = dracoGeometry.num_points();
      var numValues = numPoints * numComponents;
      var attributeData;
      var TypedBufferAttribute;

      switch ( attributeType ) {

        case Float32Array:
          attributeData = new dracoDecoder.DracoFloat32Array();
          decoder.GetAttributeFloatForAllPoints(
            dracoGeometry, attribute, attributeData);
          geometryBuffer[ attributeName ] = new Float32Array( numValues );
          TypedBufferAttribute = THREE.Float32BufferAttribute;
          break;

        case Int8Array:
          attributeData = new dracoDecoder.DracoInt8Array();
          decoder.GetAttributeInt8ForAllPoints(
            dracoGeometry, attribute, attributeData );
          geometryBuffer[ attributeName ] = new Int8Array( numValues );
          TypedBufferAttribute = THREE.Int8BufferAttribute;
          break;

        case Int16Array:
          attributeData = new dracoDecoder.DracoInt16Array();
          decoder.GetAttributeInt16ForAllPoints(
            dracoGeometry, attribute, attributeData);
          geometryBuffer[ attributeName ] = new Int16Array( numValues );
          TypedBufferAttribute = THREE.Int16BufferAttribute;
          break;

        case Int32Array:
          attributeData = new dracoDecoder.DracoInt32Array();
          decoder.GetAttributeInt32ForAllPoints(
            dracoGeometry, attribute, attributeData);
          geometryBuffer[ attributeName ] = new Int32Array( numValues );
          TypedBufferAttribute = THREE.Int32BufferAttribute;
          break;

        case Uint8Array:
          attributeData = new dracoDecoder.DracoUInt8Array();
          decoder.GetAttributeUInt8ForAllPoints(
            dracoGeometry, attribute, attributeData);
          geometryBuffer[ attributeName ] = new Uint8Array( numValues );
          TypedBufferAttribute = THREE.Uint8BufferAttribute;
          break;

        case Uint16Array:
          attributeData = new dracoDecoder.DracoUInt16Array();
          decoder.GetAttributeUInt16ForAllPoints(
            dracoGeometry, attribute, attributeData);
          geometryBuffer[ attributeName ] = new Uint16Array( numValues );
          TypedBufferAttribute = THREE.Uint16BufferAttribute;
          break;

        case Uint32Array:
          attributeData = new dracoDecoder.DracoUInt32Array();
          decoder.GetAttributeUInt32ForAllPoints(
            dracoGeometry, attribute, attributeData);
          geometryBuffer[ attributeName ] = new Uint32Array( numValues );
          TypedBufferAttribute = THREE.Uint32BufferAttribute;
          break;

        default:
          var errorMsg = 'THREE.DRACOLoader: Unexpected attribute type.';
          console.error( errorMsg );
          throw new Error( errorMsg );

      }

      // Copy data from decoder.
      for (var i = 0; i < numValues; i++) {
        geometryBuffer[attributeName][i] = attributeData.GetValue(i);
      }
      // Add attribute to THREEJS geometry for rendering.
      geometry.addAttribute(attributeName,
          new TypedBufferAttribute(geometryBuffer[attributeName],
            numComponents));
      dracoDecoder.destroy(attributeData);
    },

    convertDracoGeometryTo3JS: function(dracoDecoder, decoder, geometryType,
                                        buffer, attributeUniqueIdMap,
                                        attributeTypeMap) {
        if (this.getAttributeOptions('position').skipDequantization === true) {
          decoder.SkipAttributeTransform(dracoDecoder.POSITION);
        }
        var dracoGeometry;
        var decodingStatus;
        const start_time = performance.now();
        if (geometryType === dracoDecoder.TRIANGULAR_MESH) {
          dracoGeometry = new dracoDecoder.Mesh();
          decodingStatus = decoder.DecodeBufferToMesh(buffer, dracoGeometry);
        } else {
          dracoGeometry = new dracoDecoder.PointCloud();
          decodingStatus =
              decoder.DecodeBufferToPointCloud(buffer, dracoGeometry);
        }
        if (!decodingStatus.ok() || dracoGeometry.ptr == 0) {
          var errorMsg = 'THREE.DRACOLoader: Decoding failed: ';
          errorMsg += decodingStatus.error_msg();
          console.error(errorMsg);
          dracoDecoder.destroy(decoder);
          dracoDecoder.destroy(dracoGeometry);
          throw new Error(errorMsg);
        }

        var decode_end = performance.now();
        dracoDecoder.destroy(buffer);
        /*
         * Example on how to retrieve mesh and attributes.
         */
        var numFaces;
        if (geometryType == dracoDecoder.TRIANGULAR_MESH) {
          numFaces = dracoGeometry.num_faces();
          if (this.verbosity > 0) {
            console.log('Number of faces loaded: ' + numFaces.toString());
          }
        } else {
          numFaces = 0;
        }

        var numPoints = dracoGeometry.num_points();
        var numAttributes = dracoGeometry.num_attributes();
        if (this.verbosity > 0) {
          console.log('Number of points loaded: ' + numPoints.toString());
          console.log('Number of attributes loaded: ' +
              numAttributes.toString());
        }

        // Verify if there is position attribute.
        var posAttId = decoder.GetAttributeId(dracoGeometry,
                                              dracoDecoder.POSITION);
        if (posAttId == -1) {
          var errorMsg = 'THREE.DRACOLoader: No position attribute found.';
          console.error(errorMsg);
          dracoDecoder.destroy(decoder);
          dracoDecoder.destroy(dracoGeometry);
          throw new Error(errorMsg);
        }
        var posAttribute = decoder.GetAttribute(dracoGeometry, posAttId);

        // console.log("draco decoder: ", dracoDecoder);
        // console.log("draco normal attribute: ", decoder.GetAttributeIdByName(dracoGeometry, "uv2"));

        // Structure for converting to THREEJS geometry later.
        var geometryBuffer = {};
        // Import data to Three JS geometry.
        var geometry = new THREE.BufferGeometry();

        // Add native Draco attribute type to geometry.
        for(var ai=0; ai < this.nativeAttributes.length; ai++){
          var attributeName = this.nativeAttributes[ai];
          if (attributeUniqueIdMap[attributeName] === undefined) {
            var attId = decoder.GetAttributeIdByName(dracoGeometry, attributeName);
            if (attId !== -1) {
              if (this.verbosity > 0) {
                console.log('Loaded ' + attributeName + ' attribute.');
              }
              var attribute = decoder.GetAttribute(dracoGeometry, attId);
              this.addAttributeToGeometry(dracoDecoder, decoder, dracoGeometry,
                  attributeName, Float32Array, attribute, geometry, geometryBuffer);
            }
          }
        }

        // for (var attributeName in this.nativeAttributeMap) {
        //   // The native attribute type is only used when no unique Id is
        //   // provided. For example, loading .drc files.
        //   if (attributeUniqueIdMap[attributeName] === undefined) {
        //     var attId = decoder.GetAttributeId(dracoGeometry,
        //         dracoDecoder[this.nativeAttributeMap[attributeName]]);
        //     if (attId !== -1) {
        //       if (this.verbosity > 0) {
        //         console.log('Loaded ' + attributeName + ' attribute.');
        //       }
        //       var attribute = decoder.GetAttribute(dracoGeometry, attId);
        //       this.addAttributeToGeometry(dracoDecoder, decoder, dracoGeometry,
        //           attributeName, attribute, geometry, geometryBuffer);
        //     }
        //   }
        // }

        // Add attributes of user specified unique id. E.g. GLTF models.
        for (var attributeName in attributeUniqueIdMap) {
          var attributeType = attributeTypeMap[attributeName] || Float32Array;
          var attributeId = attributeUniqueIdMap[attributeName];
          var attribute = decoder.GetAttributeByUniqueId(dracoGeometry,
                                                         attributeId);
          this.addAttributeToGeometry(dracoDecoder, decoder, dracoGeometry,
              attributeName, attributeType, attribute, geometry, geometryBuffer);
        }

        // For mesh, we need to generate the faces.
        if (geometryType == dracoDecoder.TRIANGULAR_MESH) {
          if (this.drawMode === THREE.TriangleStripDrawMode) {
            var stripsArray = new dracoDecoder.DracoInt32Array();
            var numStrips = decoder.GetTriangleStripsFromMesh(
                dracoGeometry, stripsArray);
            geometryBuffer.indices = new Uint32Array(stripsArray.size());
            for (var i = 0; i < stripsArray.size(); ++i) {
              geometryBuffer.indices[i] = stripsArray.GetValue(i);
            }
            dracoDecoder.destroy(stripsArray);
          } else {
            var numIndices = numFaces * 3;
            geometryBuffer.indices = new Uint32Array(numIndices);
            var ia = new dracoDecoder.DracoInt32Array();
            for (var i = 0; i < numFaces; ++i) {
              decoder.GetFaceFromMesh(dracoGeometry, i, ia);
              var index = i * 3;
              geometryBuffer.indices[index] = ia.GetValue(0);
              geometryBuffer.indices[index + 1] = ia.GetValue(1);
              geometryBuffer.indices[index + 2] = ia.GetValue(2);
            }
            dracoDecoder.destroy(ia);
         }
        }

        geometry.drawMode = this.drawMode;
        if (geometryType == dracoDecoder.TRIANGULAR_MESH) {
          geometry.setIndex(new(geometryBuffer.indices.length > 65535 ?
                THREE.Uint32BufferAttribute : THREE.Uint16BufferAttribute)
              (geometryBuffer.indices, 1));
        }
        var posTransform = new dracoDecoder.AttributeQuantizationTransform();
        if (posTransform.InitFromAttribute(posAttribute)) {
          // Quantized attribute. Store the quantization parameters into the
          // THREE.js attribute.
          geometry.attributes['position'].isQuantized = true;
          geometry.attributes['position'].maxRange = posTransform.range();
          geometry.attributes['position'].numQuantizationBits =
              posTransform.quantization_bits();
          geometry.attributes['position'].minValues = new Float32Array(3);
          for (var i = 0; i < 3; ++i) {
            geometry.attributes['position'].minValues[i] =
                posTransform.min_value(i);
          }
        }
        dracoDecoder.destroy(posTransform);
        dracoDecoder.destroy(decoder);
        dracoDecoder.destroy(dracoGeometry);

        this.decode_time = decode_end - start_time;
        this.import_time = performance.now() - decode_end;

        if (this.verbosity > 0) {
          console.log('Decode time: ' + this.decode_time);
          console.log('Import time: ' + this.import_time);
        }
        return geometry;
    },

    isVersionSupported: function(version, callback) {
        THREE.DRACOLoader.getDecoderModule()
            .then( function ( module ) {
              callback( module.decoder.isVersionSupported( version ) );
            });
    },

    getAttributeOptions: function(attributeName) {
        if (typeof this.attributeOptions[attributeName] === 'undefined')
          this.attributeOptions[attributeName] = {};
        return this.attributeOptions[attributeName];
    }
};

THREE.DRACOLoader.decoderPath = './assets/vendors/draco/';
THREE.DRACOLoader.decoderConfig = {};
THREE.DRACOLoader.decoderModulePromise = null;

/**
 * Sets the base path for decoder source files.
 * @param {string} path
 */
THREE.DRACOLoader.setDecoderPath = function ( path ) {
  THREE.DRACOLoader.decoderPath = path;
};

/**
 * Sets decoder configuration and releases singleton decoder module. Module
 * will be recreated with the next decoding call.
 * @param {Object} config
 */
THREE.DRACOLoader.setDecoderConfig = function ( config ) {
  var wasmBinary = THREE.DRACOLoader.decoderConfig.wasmBinary;
  THREE.DRACOLoader.decoderConfig = config || {};
  THREE.DRACOLoader.releaseDecoderModule();

  // Reuse WASM binary.
  if ( wasmBinary ) THREE.DRACOLoader.decoderConfig.wasmBinary = wasmBinary;
};

/**
 * Releases the singleton DracoDecoderModule instance. Module will be recreated
 * with the next decoding call.
 */
THREE.DRACOLoader.releaseDecoderModule = function () {
  THREE.DRACOLoader.decoderModulePromise = null;
};

/**
 * Gets WebAssembly or asm.js singleton instance of DracoDecoderModule
 * after testing for browser support. Returns Promise that resolves when
 * module is available.
 * @return {Promise<{decoder: DracoDecoderModule}>}
 */
THREE.DRACOLoader.getDecoderModule = function () {
  var scope = this;
  var path = THREE.DRACOLoader.decoderPath;
  var config = THREE.DRACOLoader.decoderConfig;
  var promise = THREE.DRACOLoader.decoderModulePromise;

  if ( promise ) return promise;

  // Load source files.
  if ( typeof DracoDecoderModule !== 'undefined' ) {
    // Loaded externally.
    promise = Promise.resolve();
  } else if ( typeof WebAssembly !== 'object' || config.type === 'js' ) {
    // Load with asm.js.
    promise = THREE.DRACOLoader._loadScript( path + 'draco_decoder.js' );
  } else {
    // Load with WebAssembly.
    config.wasmBinaryFile = path + 'draco_decoder.wasm';
    promise = THREE.DRACOLoader._loadScript( path + 'draco_wasm_wrapper.js' )
        .then( function () {
          return THREE.DRACOLoader._loadArrayBuffer( config.wasmBinaryFile );
        } )
        .then( function ( wasmBinary ) {
          config.wasmBinary = wasmBinary;
        } );
  }

  // Wait for source files, then create and return a decoder.
  promise = promise.then( function () {
    return new Promise( function ( resolve ) {
      config.onModuleLoaded = function ( decoder ) {
        scope.timeLoaded = performance.now();
        // Module is Promise-like. Wrap before resolving to avoid loop.
        resolve( { decoder: decoder } );
      };
      DracoDecoderModule( config );
    } );
  } );

  THREE.DRACOLoader.decoderModulePromise = promise;
  return promise;
};

/**
 * @param {string} src
 * @return {Promise}
 */
THREE.DRACOLoader._loadScript = function ( src ) {
  var prevScript = document.getElementById( 'decoder_script' );
  if ( prevScript !== null ) {
    prevScript.parentNode.removeChild( prevScript );
  }
  var head = document.getElementsByTagName( 'head' )[ 0 ];
  var script = document.createElement( 'script' );
  script.id = 'decoder_script';
  script.type = 'text/javascript';
  script.src = src;
  return new Promise( function ( resolve ) {
    script.onload = resolve;
    head.appendChild( script );
  });
};

/**
 * @param {string} src
 * @return {Promise}
 */
THREE.DRACOLoader._loadArrayBuffer = function ( src ) {
  var loader = new THREE.FileLoader();
  loader.setResponseType( 'arraybuffer' );
  return new Promise( function( resolve, reject ) {
    loader.load( src, resolve, undefined, reject );
  });
};

!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){n(1),n(2),n(3),n(4),e.exports=n(5)},function(e,t){THREE.MaterialExt=function(e,t){THREE.ShaderMaterial.call(this,{uniforms:{},defines:{},extensions:{}})},THREE.MaterialExt.prototype=Object.create(THREE.ShaderMaterial.prototype),THREE.MaterialExt.prototype.constructor=THREE.MaterialExt,THREE.MaterialExt.prototype.isMaterialExt=!0,THREE.MaterialExt.prototype.setVertexShader=function(e){this.vertexShader=e},THREE.MaterialExt.prototype.setFragmentShader=function(e){this.fragmentShader=e},THREE.MaterialExt.prototype.setUniforms=function(e){this.uniforms=e},THREE.MaterialExt.prototype.setDefines=function(e){this.defines=e},THREE.MaterialExt.prototype.setExtensions=function(e){this.extensions=e},THREE.MaterialExt.prototype.init=function(e,t,n,i){this.uniforms=e,this.defines=t,this.extensions=n;var r={};for(property in i)this.hasOwnProperty(property)&&(r[property]=i[property]);for(property in!this.isMeshBasicMaterialExt||this.isMeshPhongMaterialExt?r.lights=!0:r.lights=!1,this.setValues(r),r)this[property]=r[property]},THREE.MaterialExt.prototype.toJSON=function(e){THREE.Material.prototype.toJSON.call(this,e)},THREE.MaterialExt.prototype.clone=function(){return(new this.constructor).copy(this)},THREE.MaterialExt.prototype.copy=function(e){THREE.Material.prototype.copy.call(this,e)}},function(e,t){THREE.MeshBasicMaterialExt=function(e,t){THREE.MaterialExt.call(this,e,t),this.combine=THREE.MultiplyOperation,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.lights=!1;var n=!1;if(Object.defineProperties(this,{color:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.diffuse.value},set:function(e){void 0!==e&&this.uniforms.diffuse.value.set(e)}},diffuse:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.diffuse.value},set:function(e){void 0!==e&&this.uniforms.diffuse.value.set(e)}},opacity:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.opacity.value},set:function(e){void 0!==e&&(this.uniforms.opacity.value=e)}},map:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.map.value},set:function(e){void 0!==e&&(this.uniforms.map.value=e)}},uvTransform:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.uvTransform.value},set:function(e){null===this.uniforms.uvTransform.value&&(this.uniforms.uvTransform.value=new THREE.Matrix3),this.uniforms.uvTransform.value.copy(e)}},alphaMap:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.alphaMap.value},set:function(e){void 0!==e&&(this.uniforms.alphaMap.value=e)}},specularMap:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.specularMap.value},set:function(e){void 0!==e&&(this.uniforms.specularMap.value=e)}},envMap:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.envMap.value},set:function(e){void 0!==e&&(this.uniforms.envMap.value=e)}},flipEnvMap:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.flipEnvMap.value},set:function(e){void 0!==e&&(this.uniforms.flipEnvMap.value=e)}},reflectivity:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.reflectivity.value},set:function(e){void 0!==e&&(this.uniforms.reflectivity.value=e)}},refractionRatio:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.refractionRatio.value},set:function(e){void 0!==e&&(this.uniforms.refractionRatio.value=e)}},maxMipLevel:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.maxMipLevel.value},set:function(e){void 0!==e&&(this.uniforms.maxMipLevel.value=e)}},aoMap:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.aoMap.value},set:function(e){void 0!==e&&(this.uniforms.aoMap.value=e)}},aoMapIntensity:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.aoMapIntensity.value},set:function(e){void 0!==e&&(this.uniforms.aoMapIntensity.value=e)}},lightMap:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.lightMap.value},set:function(e){void 0!==e&&(this.uniforms.lightMap.value=e)}},lightMapIntensity:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.lightMapIntensity.value},set:function(e){void 0!==e&&(this.uniforms.lightMapIntensity.value=e)}},fogDensity:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.fogDensity.value},set:function(e){void 0!==e&&(this.uniforms.fogDensity.value=e)}},fogNear:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.fogNear.value},set:function(e){void 0!==e&&(this.uniforms.fogNear.value=e)}},fogFar:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.fogFar.value},set:function(e){void 0!==e&&(this.uniforms.fogFar.value=e)}},fogColor:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.fogColor.value},set:function(e){void 0!==e&&this.uniforms.fogColor.value.set(e)}},morphTargets:{enumerable:!0,configurable:!1,get:function(){return n},set:function(e){void 0!==e&&(n=e)}}}),!0!==t){var i=THREE.UniformsUtils.merge([THREE.ShaderLib.basic.uniforms,{}]);for(property in e)switch(property){case"color":i.diffuse.value.set(e[property]);break;default:i.hasOwnProperty(property)&&(i[property].value=e[property])}var r=THREE.ShaderLib.basic.vertexShader,a=THREE.ShaderLib.basic.fragmentShader;this.setVertexShader(r),this.setFragmentShader(a),this.init(i,{},{derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},e)}},THREE.MeshBasicMaterialExt.prototype=Object.create(THREE.MaterialExt.prototype),THREE.MeshBasicMaterialExt.prototype.constructor=THREE.MeshBasicMaterialExt,THREE.MeshBasicMaterialExt.prototype.isMeshBasicMaterialExt=!0,THREE.MeshBasicMaterialExt.prototype.toJSON=function(e){THREE.MaterialExt.prototype.toJSON.call(this,e)},THREE.MeshBasicMaterialExt.prototype.clone=function(){return(new this.constructor).copy(this)},THREE.MeshBasicMaterialExt.prototype.copy=function(e){return THREE.MaterialExt.prototype.copy.call(this,e),this.color=e.color,this.map=void 0===e.map?null:e.map,this.lightMap=void 0===e.lightMap?null:e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=void 0===e.aoMap?null:e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=void 0===e.specularMap?null:e.specularMap,this.alphaMap=void 0===e.alphaMap?null:e.alphaMap,this.envMap=void 0===e.envMap?null:e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this}},function(e,t){THREE.MeshStandardMaterialExt=function(e,t){THREE.MaterialExt.call(this,e,t),this.normalMapType=THREE.TangentSpaceNormalMap,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1;var n=!1,i=!1,r=new THREE.Color(0),a=0;if(Object.defineProperties(this,{color:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.diffuse.value},set:function(e){void 0!==e&&this.uniforms.diffuse.value.set(e)}},diffuse:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.diffuse.value},set:function(e){void 0!==e&&(this.uniforms.diffuse.value=e)}},opacity:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.opacity.value},set:function(e){void 0!==e&&(this.uniforms.opacity.value=e)}},map:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.map.value},set:function(e){void 0!==e&&(this.uniforms.map.value=e)}},uvTransform:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.uvTransform.value},set:function(e){null===this.uniforms.uvTransform.value&&(this.uniforms.uvTransform.value=new THREE.Matrix3),void 0!==e&&this.uniforms.uvTransform.value.copy(e)}},alphaMap:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.alphaMap.value},set:function(e){void 0!==e&&(this.uniforms.alphaMap.value=e)}},envMap:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.envMap.value},set:function(e){void 0!==e&&(this.uniforms.envMap.value=e)}},flipEnvMap:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.flipEnvMap.value},set:function(e){void 0!==e&&(this.uniforms.flipEnvMap.value=e)}},reflectivity:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.reflectivity.value},set:function(e){void 0!==e&&(this.uniforms.reflectivity.value=e)}},refractionRatio:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.refractionRatio.value},set:function(e){void 0!==e&&(this.uniforms.refractionRatio.value=e)}},maxMipLevel:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.maxMipLevel.value},set:function(e){void 0!==e&&(this.uniforms.maxMipLevel.value=e)}},aoMap:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.aoMap.value},set:function(e){void 0!==e&&(this.uniforms.aoMap.value=e)}},aoMapIntensity:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.aoMapIntensity.value},set:function(e){void 0!==e&&(this.uniforms.aoMapIntensity.value=e)}},lightMap:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.lightMap.value},set:function(e){void 0!==e&&(this.uniforms.lightMap.value=e)}},lightMapIntensity:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.lightMapIntensity.value},set:function(e){void 0!==e&&(this.uniforms.lightMapIntensity.value=e)}},emissiveMap:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.emissiveMap.value},set:function(e){void 0!==e&&(this.uniforms.emissiveMap.value=e)}},bumpMap:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.bumpMap.value},set:function(e){void 0!==e&&(this.uniforms.bumpMap.value=e)}},bumpScale:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.bumpScale.value},set:function(e){void 0!==e&&(this.uniforms.bumpScale.value=e)}},normalMap:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.normalMap.value},set:function(e){void 0!==e&&(this.uniforms.normalMap.value=e)}},normalScale:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.normalScale.value},set:function(e){e&&this.uniforms.normalScale.value.copy(e)}},displacementMap:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.displacementMap.value},set:function(e){void 0!==e&&(this.uniforms.displacementMap.value=e)}},displacementScale:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.displacementScale.value},set:function(e){void 0!==e&&(this.uniforms.displacementScale.value=e)}},displacementBias:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.displacementBias.value},set:function(e){void 0!==e&&(this.uniforms.displacementBias.value=e)}},roughnessMap:{enumerable:!0,configurable:!0,get:function(){return this.uniforms.roughnessMap.value},set:function(e){void 0!==e&&(this.uniforms.roughnessMap.value=e)}},metalnessMap:{enumerable:!0,configurable:!0,get:function(){return this.uniforms.metalnessMap.value},set:function(e){void 0!==e&&(this.uniforms.metalnessMap.value=e)}},fogDensity:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.fogDensity.value},set:function(e){void 0!==e&&(this.uniforms.fogDensity.value=e)}},fogNear:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.fogNear.value},set:function(e){void 0!==e&&(this.uniforms.fogNear.value=e)}},fogFar:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.fogFar.value},set:function(e){void 0!==e&&(this.uniforms.fogFar.value=e)}},fogColor:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.fogColor.value},set:function(e){void 0!==e&&this.uniforms.fogColor.value.set(e)}},emissive:{enumerable:!0,configurable:!1,get:function(){return r},set:function(e){void 0!==e&&(r.copy(e),this.uniforms.emissive.value.copy(r.clone().multiplyScalar(this.emissiveIntensity)))}},emissiveIntensity:{enumerable:!0,configurable:!1,get:function(){return a},set:function(e){void 0!==e&&(a=e,this.uniforms.emissive.value.copy(r.clone().multiplyScalar(a)))}},roughness:{enumerable:!0,configurable:!0,get:function(){return this.uniforms.roughness.value},set:function(e){void 0!==e&&(this.uniforms.roughness.value=e)}},metalness:{enumerable:!0,configurable:!0,get:function(){return this.uniforms.metalness.value},set:function(e){void 0!==e&&(this.uniforms.metalness.value=e)}},envMapIntensity:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.envMapIntensity.value},set:function(e){void 0!==e&&(this.uniforms.envMapIntensity.value=e)}},morphTargets:{enumerable:!0,configurable:!1,get:function(){return n},set:function(e){void 0!==e&&(n=e)}},morphNormals:{enumerable:!0,configurable:!1,get:function(){return i},set:function(e){void 0!==e&&(i=e)}}}),!0!==t){var s=THREE.UniformsUtils.merge([THREE.ShaderLib.standard.uniforms,{maxMipLevel:{value:9}}]);for(property in e)switch(property){case"color":s.diffuse.value.set(e[property]);break;default:s.hasOwnProperty(property)&&(s[property].value=e[property])}var o=THREE.ShaderLib.standard.vertexShader,l=THREE.ShaderLib.standard.fragmentShader;this.setVertexShader(o),this.setFragmentShader(l),this.init(s,{STANDARD:""},{derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},e)}},THREE.MeshStandardMaterialExt.prototype=Object.create(THREE.MaterialExt.prototype),THREE.MeshStandardMaterialExt.prototype.constructor=THREE.MeshStandardMaterialExt,THREE.MeshStandardMaterialExt.prototype.isMeshStandardMaterialExt=!0,THREE.MeshStandardMaterialExt.prototype.toJSON=function(e){THREE.MaterialExt.prototype.toJSON.call(this,e)},THREE.MeshStandardMaterialExt.prototype.clone=function(){return(new this.constructor).copy(this)},THREE.MeshStandardMaterialExt.prototype.copy=function(e){return THREE.MaterialExt.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color=e.color,this.roughness=e.roughness,this.metalness=e.metalness,this.map=void 0===e.map?null:e.map,this.lightMap=void 0===e.lightMap?null:e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=void 0===e.aoMap?null:e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive=e.emissive,this.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=void 0===e.bumpMap?null:e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=void 0===e.normalMap?null:e.normalMap,this.normalMapType=e.normalMapType,this.normalScale=void 0===e.normalScale?new THREE.Vector2(1,1):e.normalScale,this.displacementMap=void 0===e.displacementMap?null:e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=void 0===e.roughnessMap?null:e.roughnessMap,this.metalnessMap=void 0===e.metalnessMap?null:e.metalnessMap,this.alphaMap=void 0===e.alphaMap?null:e.alphaMap,this.envMap=void 0===e.envMap?null:e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this}},function(e,t){THREE.MeshPhongMaterialExt=function(e,t){e=e||{},THREE.MeshBasicMaterialExt.call(this,e,!0),this.normalMapType=THREE.TangentSpaceNormalMap;var n=!1,i=new THREE.Color(0),r=0;if(Object.defineProperties(this,{emissiveMap:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.emissiveMap.value},set:function(e){void 0!==e&&(this.uniforms.emissiveMap.value=e)}},bumpMap:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.bumpMap.value},set:function(e){void 0!==e&&(this.uniforms.bumpMap.value=e)}},bumpScale:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.bumpScale.value},set:function(e){void 0!==e&&(this.uniforms.bumpScale.value=e)}},normalMap:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.normalMap.value},set:function(e){void 0!==e&&(this.uniforms.normalMap.value=e)}},normalScale:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.normalScale.value},set:function(e){e&&this.uniforms.normalScale.value.copy(e)}},displacementMap:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.displacementMap.value},set:function(e){void 0!==e&&(this.uniforms.displacementMap.value=e)}},displacementScale:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.displacementScale.value},set:function(e){void 0!==e&&(this.uniforms.displacementScale.value=e)}},displacementBias:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.displacementBias.value},set:function(e){void 0!==e&&(this.uniforms.displacementBias.value=e)}},gradientMap:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.gradientMap.value},set:function(e){void 0!==e&&(this.uniforms.gradientMap.value=e)}},emissive:{enumerable:!0,configurable:!1,get:function(){return i},set:function(e){void 0!==e&&(i.copy(e),this.uniforms.emissive.value.copy(i.clone().multiplyScalar(this.emissiveIntensity)))}},emissiveIntensity:{enumerable:!0,configurable:!1,get:function(){return r},set:function(e){void 0!==e&&(r=e,this.uniforms.emissive.value.copy(i.clone().multiplyScalar(r)))}},specular:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.specular.value},set:function(e){void 0!==e&&(this.uniforms.specular.value=e)}},shininess:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.shininess.value},set:function(e){void 0!==e&&(this.uniforms.shininess.value=e)}},morphNormals:{enumerable:!0,configurable:!1,get:function(){return n},set:function(e){void 0!==e&&(n=e)}},envMapScale:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.envMapScale.value},set:function(e){void 0!==e&&(this.uniforms.envMapScale.value=e)}},enableFresnelDiff:{enumerable:!0,configurable:!1,get:function(){return this.defines.hasOwnProperty("FRESNEL_DIFFUSE")},set:function(e){e?this.defines.FRESNEL_DIFFUSE="":this.defines.hasOwnProperty("FRESNEL_DIFFUSE")&&delete this.defines.FRESNEL_DIFFUSE}},enableFresnelEnv:{enumerable:!0,configurable:!1,get:function(){return this.defines.hasOwnProperty("FRESNEL_ENV")},set:function(e){e?this.defines.FRESNEL_ENV="":this.defines.hasOwnProperty("FRESNEL_ENV")&&delete this.defines.FRESNEL_ENV}},fresnelDiffBias:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.fresnelDiffBias.value},set:function(e){void 0!==e&&(this.uniforms.fresnelDiffBias.value=e)}},fresnelDiffScale:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.fresnelDiffScale.value},set:function(e){void 0!==e&&(this.uniforms.fresnelDiffScale.value=e)}},fresnelDiffPower:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.fresnelDiffPower.value},set:function(e){void 0!==e&&(this.uniforms.fresnelDiffPower.value=e)}},fresnelDiffColorLeft:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.fresnelDiffColorLeft.value},set:function(e){void 0!==e&&this.uniforms.fresnelDiffColorLeft.value.set(e)}},fresnelEnvBias:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.fresnelEnvBias.value},set:function(e){void 0!==e&&(this.uniforms.fresnelEnvBias.value=e)}},fresnelEnvScale:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.fresnelEnvScale.value},set:function(e){void 0!==e&&(this.uniforms.fresnelEnvScale.value=e)}},fresnelEnvPower:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.fresnelEnvPower.value},set:function(e){void 0!==e&&(this.uniforms.fresnelEnvPower.value=e)}}}),!0!==t){var a={PHONG:""},s=THREE.UniformsUtils.merge([THREE.ShaderLib.phong.uniforms,{envMapScale:{value:e.envMapScale||1},fresnelDiffBias:{value:e.fresnelDiffBias||.01},fresnelDiffScale:{value:e.fresnelDiffScale||1},fresnelDiffPower:{value:e.fresnelDiffPower||1},fresnelDiffColorLeft:{value:e.fresnelDiffColorLeft||new THREE.Color(0)},fresnelEnvBias:{value:e.fresnelEnvBias||.01},fresnelEnvScale:{value:e.fresnelDiffScale||1},fresnelEnvPower:{value:e.fresnelDiffPower||1}}]);for(property in e)switch(property){case"color":s.diffuse.value.set(e[property]),delete e[property];break;default:s.hasOwnProperty(property)&&(s[property].value=e[property])}var o=["#define PHONG","varying vec3 vViewPosition;","#ifndef FLAT_SHADED","\tvarying vec3 vNormal;","#endif","#include <common>","#include <uv_pars_vertex>","#include <uv2_pars_vertex>","#include <displacementmap_pars_vertex>","#include <envmap_pars_vertex>","#include <color_pars_vertex>","#include <fog_pars_vertex>","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","#include <shadowmap_pars_vertex>","#include <logdepthbuf_pars_vertex>","#include <clipping_planes_pars_vertex>","#ifdef FRESNEL_DIFFUSE","\tuniform float fresnelDiffBias;","\tuniform float fresnelDiffScale;","\tuniform float fresnelDiffPower;","\tvarying float vReflectionDiffFactor;","#endif","#ifdef FRESNEL_ENV","\tuniform float fresnelEnvBias;","\tuniform float fresnelEnvScale;","\tuniform float fresnelEnvPower;","\tvarying float vReflectionEnvFactor;","#endif","void main() {","\t#include <uv_vertex>","\t#include <uv2_vertex>","\t#include <color_vertex>","\t#include <beginnormal_vertex>","\t#include <morphnormal_vertex>","\t#include <skinbase_vertex>","\t#include <skinnormal_vertex>","\t#include <defaultnormal_vertex>","\t#ifndef FLAT_SHADED","\t\tvNormal = normalize( transformedNormal );","\t#endif","\t#include <begin_vertex>","\t#include <morphtarget_vertex>","\t#include <skinning_vertex>","\t#include <displacementmap_vertex>","\t#include <project_vertex>","\t#include <logdepthbuf_vertex>","\t#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","\t#include <worldpos_vertex>","\t#include <envmap_vertex>","\t#include <shadowmap_vertex>","\t#include <fog_vertex>","\t#if defined(FRESNEL_DIFFUSE) || defined(FRESNEL_ENV)","\t\tvec3 worldNormal = normalize( mat3( modelMatrix[0].xyz, modelMatrix[1].xyz, modelMatrix[2].xyz ) * normal );","\t\t#if defined(USE_ENVMAP) ","\t\t\tvec3 I = worldPosition.xyz - cameraPosition;","\t\t#else","\t\t\tvec3 I =  (modelMatrix * vec4( transformed, 1.0 )).xyz  - cameraPosition;","\t\t#endif","\t#endif","\t#ifdef FRESNEL_DIFFUSE","\t\tvReflectionDiffFactor = fresnelDiffBias + fresnelDiffScale * pow( 1.0 + dot( normalize( I ), worldNormal ), fresnelDiffPower );","\t#endif","\t#ifdef FRESNEL_ENV","\t\tvReflectionEnvFactor = fresnelEnvBias + fresnelEnvScale * pow( 1.0 + dot( normalize( I ), worldNormal ), fresnelEnvPower );","\t#endif","}"].join("\n"),l=["#define PHONG","uniform vec3 diffuse;","uniform vec3 emissive;","uniform vec3 specular;","uniform float shininess;","uniform float opacity;","#include <common>","#include <packing>","#include <dithering_pars_fragment>","#include <color_pars_fragment>","#include <uv_pars_fragment>","#include <uv2_pars_fragment>","#include <map_pars_fragment>","#include <alphamap_pars_fragment>","#include <aomap_pars_fragment>","#include <lightmap_pars_fragment>","#include <emissivemap_pars_fragment>","#include <envmap_pars_fragment>","#include <gradientmap_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_phong_pars_fragment>","#include <shadowmap_pars_fragment>","#include <bumpmap_pars_fragment>","#include <normalmap_pars_fragment>","#include <specularmap_pars_fragment>","#include <logdepthbuf_pars_fragment>","#include <clipping_planes_pars_fragment>","#ifdef FRESNEL_DIFFUSE","\tuniform vec3 fresnelDiffColorLeft;","\tvarying float vReflectionDiffFactor;","#endif","#ifdef FRESNEL_ENV","\tvarying float vReflectionEnvFactor;","#endif","uniform float envMapScale;","void main() {","#include <clipping_planes_fragment>","#ifdef FRESNEL_DIFFUSE","\tvec4 diffuseColor = vec4(mix( diffuse, fresnelDiffColorLeft, vec3( vReflectionDiffFactor ) ), opacity);","#else","\tvec4 diffuseColor = vec4( diffuse, opacity );","#endif","ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","vec3 totalEmissiveRadiance = emissive;","#include <logdepthbuf_fragment>","#include <map_fragment>","#include <color_fragment>","#include <alphamap_fragment>","#include <alphatest_fragment>","#include <specularmap_fragment>","#include <normal_fragment_begin>","#include <normal_fragment_maps>","#include <emissivemap_fragment>","#include <lights_phong_fragment>","#include <lights_fragment_begin>","#include <lights_fragment_maps>","#include <lights_fragment_end>","#include <aomap_fragment>","vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;","#ifdef USE_ENVMAP","\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )","\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );","\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );","\t\t#ifdef ENVMAP_MODE_REFLECTION","\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );","\t\t#else","\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );","\t\t#endif","\t#else","   \t\tvec3 reflectVec = vReflect;","\t#endif","\t#ifdef ENVMAP_TYPE_CUBE","\t\treflectVec *= envMapScale;","\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );","\t#elif defined( ENVMAP_TYPE_EQUIREC )","\t\tvec2 sampleUV;","\t\treflectVec = normalize( reflectVec );","\t\treflectVec *= envMapScale;","\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;","\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;","\t\tvec4 envColor = texture2D( envMap, sampleUV );","\t#elif defined( ENVMAP_TYPE_SPHERE )","\t\treflectVec = normalize( reflectVec );","\t\treflectVec *= envMapScale;","\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );","\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );","\t#else","\t\tvec4 envColor = vec4( 0.0 );","\t#endif","\tenvColor = envMapTexelToLinear( envColor );","\t#ifdef ENVMAP_BLENDING_MULTIPLY","\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );","\t#elif defined( ENVMAP_BLENDING_MIX )","\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );","\t#elif defined( ENVMAP_BLENDING_ADD )","\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;","\t#endif","\t// Fresnel Environment map","\t#ifdef FRESNEL_ENV","\t\toutgoingLight.xyz += envColor.xyz*vec3( vReflectionEnvFactor );","\t#endif","#endif","gl_FragColor = vec4( outgoingLight, diffuseColor.a );","#include <tonemapping_fragment>","#include <encodings_fragment>","#include <fog_fragment>","#include <premultiplied_alpha_fragment>","#include <dithering_fragment>","}"].join("\n");!0===e.enableFresnelDiff&&(a.FRESNEL_DIFFUSE="",delete e.enableFresnelDiff),!0===e.enableFresnelEnv&&(a.FRESNEL_ENV="",delete e.enableFresnelEnv),this.setVertexShader(o),this.setFragmentShader(l),this.init(s,a,{derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},e)}},THREE.MeshPhongMaterialExt.prototype=Object.create(THREE.MeshBasicMaterialExt.prototype),THREE.MeshPhongMaterialExt.prototype.constructor=THREE.MeshPhongMaterialExt,THREE.MeshPhongMaterialExt.prototype.isMeshPhongMaterialExt=!0,THREE.MeshPhongMaterialExt.prototype.toJSON=function(e){THREE.MeshBasicMaterialExt.prototype.toJSON.call(this,e)},THREE.MeshPhongMaterialExt.prototype.clone=function(){return(new this.constructor).copy(this)},THREE.MeshPhongMaterialExt.prototype.copy=function(e){return THREE.MeshBasicMaterialExt.prototype.copy.call(this,e),this.defines={PHONG:""},this.color=e.color,this.specular=e.specular,this.shininess=e.shininess,this.map=void 0===e.map?null:e.map,this.lightMap=void 0===e.lightMap?null:e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=void 0===e.aoMap?null:e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive=e.emissive,this.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=void 0===e.bumpMap?null:e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=void 0===e.normalMap?null:e.normalMap,this.normalMapType=e.normalMapType,this.normalScale=void 0===e.normalScale?new THREE.Vector2(1,1):e.normalScale,this.displacementMap=void 0===e.displacementMap?null:e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=void 0===e.specularMap?null:e.specularMap,this.alphaMap=void 0===e.alphaMap?null:e.alphaMap,this.envMap=void 0===e.envMap?null:e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.envMapScale=e.envMapScale,this.enableFresnelDiff=e.enableFresnelDiff,this.fresnelDiffBias=e.fresnelDiffBias,this.fresnelDiffScale=e.fresnelDiffScale,this.fresnelDiffPower=e.fresnelDiffPower,this.fresnelDiffColorLeft=e.fresnelDiffColorLeft,this.enableFresnelDiff=e.enableFresnelDiff,this.fresnelEnvBias=e.fresnelEnvBias,this.fresnelEnvScale=e.fresnelEnvScale,this.fresnelEnvPower=e.fresnelEnvPower,this}},function(e,t){THREE.MeshPhysicalMaterialExt=function(e,t){if(e=e||{},THREE.MeshStandardMaterialExt.call(this,e,!0),Object.defineProperties(this,{clearCoat:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.clearCoat.value},set:function(e){void 0!==e&&(this.uniforms.clearCoat.value=e)}},clearCoatRoughness:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.clearCoatRoughness.value},set:function(e){void 0!==e&&(this.uniforms.clearCoatRoughness.value=e)}},enableFresnelDiff:{enumerable:!0,configurable:!1,get:function(){return this.defines.hasOwnProperty("FRESNEL_DIFFUSE")},set:function(e){e?this.defines.FRESNEL_DIFFUSE="":this.defines.hasOwnProperty("FRESNEL_DIFFUSE")&&delete this.defines.FRESNEL_DIFFUSE}},enableFresnelEnv:{enumerable:!0,configurable:!1,get:function(){return this.defines.hasOwnProperty("FRESNEL_ENV")},set:function(e){e?this.defines.FRESNEL_ENV="":this.defines.hasOwnProperty("FRESNEL_ENV")&&delete this.defines.FRESNEL_ENV}},fresnelDiffBias:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.fresnelDiffBias.value},set:function(e){void 0!==e&&(this.uniforms.fresnelDiffBias.value=e)}},fresnelDiffScale:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.fresnelDiffScale.value},set:function(e){void 0!==e&&(this.uniforms.fresnelDiffScale.value=e)}},fresnelDiffPower:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.fresnelDiffPower.value},set:function(e){void 0!==e&&(this.uniforms.fresnelDiffPower.value=e)}},fresnelDiffColorLeft:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.fresnelDiffColorLeft.value},set:function(e){void 0!==e&&this.uniforms.fresnelDiffColorLeft.value.set(e)}},fresnelEnvBias:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.fresnelEnvBias.value},set:function(e){void 0!==e&&(this.uniforms.fresnelEnvBias.value=e)}},fresnelEnvScale:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.fresnelEnvScale.value},set:function(e){void 0!==e&&(this.uniforms.fresnelEnvScale.value=e)}},fresnelEnvPower:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.fresnelEnvPower.value},set:function(e){void 0!==e&&(this.uniforms.fresnelEnvPower.value=e)}},enableSpecularGlossiness:{enumerable:!0,configurable:!1,get:function(){return this.defines.hasOwnProperty("USE_SPEC_GLOSS")},set:function(e){e?this.defines.USE_SPEC_GLOSS="":this.defines.hasOwnProperty("USE_SPEC_GLOSS")&&delete this.defines.USE_SPEC_GLOSS}},specularMap:{enumerable:!0,configurable:!0,get:function(){return this.uniforms.specularMap.value},set:function(e){void 0!==e&&(this.uniforms.specularMap.value=e),e?this.defines.USE_SPECULARMAP="":this.defines.hasOwnProperty("USE_SPECULARMAP")&&delete this.defines.USE_SPECULARMAP}},specular:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.specular.value},set:function(e){void 0!==e&&this.uniforms.specular.value.set(e)}},glossinessMap:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.glossinessMap.value},set:function(e){void 0!==e&&(this.uniforms.glossinessMap.value=e),e?this.defines.USE_GLOSSINESSMAP="":this.defines.hasOwnProperty("USE_GLOSSINESSMAP")&&delete this.defines.USE_GLOSSINESSMAP}},glossiness:{enumerable:!0,configurable:!1,get:function(){return this.uniforms.glossiness.value},set:function(e){void 0!==e&&(this.uniforms.glossiness.value=e)}}}),!0!==t){var n=THREE.UniformsUtils.merge([THREE.ShaderLib.physical.uniforms,{fresnelDiffBias:{value:e.fresnelDiffBias||0},fresnelDiffScale:{value:e.fresnelDiffScale||0},fresnelDiffPower:{value:e.fresnelDiffPower||0},fresnelDiffColorLeft:{value:e.fresnelDiffColorLeft||new THREE.Color(0)},fresnelEnvBias:{value:e.fresnelEnvBias||0},fresnelEnvScale:{value:e.fresnelDiffScale||0},fresnelEnvPower:{value:e.fresnelDiffPower||0},specular:{value:e.specular||new THREE.Color(1118481)},specularMap:{value:e.specularMap||null},glossiness:{value:e.glossiness||.5},glossinessMap:{value:e.glossinessMap||null},maxMipLevel:{value:9}}]);for(property in e)switch(property){case"color":n.diffuse.value.set(e[property]);break;default:n.hasOwnProperty(property)&&(n[property].value=e[property])}this.setVertexShader("\n\t\t#define PHYSICAL\n\n\t\tvarying vec3 vViewPosition;\n\n\t\t#ifndef FLAT_SHADED\n            varying vec3 vNormal;\n            #ifdef USE_TANGENT\n                varying vec3 vTangent;\n                varying vec3 vBitangent;\n            #endif\n\t\t#endif\n\t\t#include <common>\n        //#include <uv_pars_vertex>\n        #if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP ) || defined( USE_SPECULARMAP ) || defined( USE_GLOSSINESSMAP )\n            varying vec2 vUv;\n            uniform mat3 uvTransform;\n        #endif\n\t\t#include <uv2_pars_vertex>\n\t\t#include <displacementmap_pars_vertex>\n\t\t#include <color_pars_vertex>\n\t\t#include <fog_pars_vertex>\n\t\t#include <morphtarget_pars_vertex>\n\t\t#include <skinning_pars_vertex>\n\t\t#include <shadowmap_pars_vertex>\n\t\t#include <logdepthbuf_pars_vertex>\n\t\t#include <clipping_planes_pars_vertex>\n\n\t\t#ifdef FRESNEL_DIFFUSE\n            uniform float fresnelDiffBias;\n            uniform float fresnelDiffScale;\n            uniform float fresnelDiffPower;\n            varying float vReflectionDiffFactor;\n\t\t#endif\n\t\t#ifdef FRESNEL_ENV\n            uniform float fresnelEnvBias;\n            uniform float fresnelEnvScale;\n            uniform float fresnelEnvPower;\n            varying float vReflectionEnvFactor;\n\t\t#endif\n\n\t\tvoid main() {\n            //#include <uv_vertex>\n            #if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP ) || defined( USE_SPECULARMAP ) || defined( USE_GLOSSINESSMAP )\n                vUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n            #endif\n\t\t\t#include <uv2_vertex>\n\t\t\t#include <color_vertex>\n\n\t\t\t#include <beginnormal_vertex>\n\t\t\t#include <morphnormal_vertex>\n\t\t\t#include <skinbase_vertex>\n\t\t\t#include <skinnormal_vertex>\n\t\t\t#include <defaultnormal_vertex>\n            #ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n                vNormal = normalize( transformedNormal );\n                #ifdef USE_TANGENT\n                    vTangent = normalize( transformedTangent );\n                    vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n                #endif\n            #endif\n\t\t\t#include <begin_vertex>\n\t\t\t#include <morphtarget_vertex>\n\t\t\t#include <skinning_vertex>\n\t\t\t#include <displacementmap_vertex>\n\t\t\t#include <project_vertex>\n\t\t\t#include <logdepthbuf_vertex>\n\t\t\t#include <clipping_planes_vertex>\n\n\t\t\tvViewPosition = - mvPosition.xyz;\n\n\t\t\t#include <worldpos_vertex>\n\t\t\t#include <shadowmap_vertex>\n\t\t\t#include <fog_vertex>\n\n            // FRESNEL\n            #if defined(FRESNEL_DIFFUSE) || defined(FRESNEL_ENV)\n                vec3 worldNormal = normalize( mat3( modelMatrix[0].xyz, modelMatrix[1].xyz, modelMatrix[2].xyz ) * normal );\n                #if defined(USE_ENVMAP) \n                    vec3 I = worldPosition.xyz - cameraPosition;\n                #else\n                    vec3 I =  (modelMatrix * vec4( transformed, 1.0 )).xyz  - cameraPosition;\n                #endif\n            #endif\n                #ifdef FRESNEL_DIFFUSE\n                    vReflectionDiffFactor = fresnelDiffBias + fresnelDiffScale * pow( 1.0 + dot( normalize( I ), worldNormal ), fresnelDiffPower );\n                #endif\n            #ifdef FRESNEL_ENV\n                vReflectionEnvFactor = fresnelEnvBias + fresnelEnvScale * pow( 1.0 + dot( normalize( I ), worldNormal ), fresnelEnvPower );\n            #endif\n        }\n    "),this.setFragmentShader("\n\t\t#define PHYSICAL\n\n\t\tuniform vec3 diffuse;\n\t\tuniform vec3 emissive;\n        uniform float opacity;\n        \n        #ifndef USE_SPEC_GLOSS\n            uniform float roughness;\n            uniform float metalness;\n        #else\n            uniform vec3 specular;\n            uniform float glossiness;\n        #endif\n\n\t\t#ifndef STANDARD\n\t\t\tuniform float clearCoat;\n\t\t\tuniform float clearCoatRoughness;\n\t\t#endif\n\n\t\tvarying vec3 vViewPosition;\n\n\t\t#ifndef FLAT_SHADED\n\t\t\tvarying vec3 vNormal;\n            #ifdef USE_TANGENT\n                varying vec3 vTangent;\n                varying vec3 vBitangent;\n            #endif\n\t\t#endif\n\n\t\t#include <common>\n\t\t#include <packing>\n\t\t#include <dithering_pars_fragment>\n\t\t#include <color_pars_fragment>\n        //#include <uv_pars_fragment>\n        #if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP ) || defined( USE_SPECULARMAP ) || defined( USE_GLOSSINESSMAP )\n            varying vec2 vUv;\n        #endif\n\t\t#include <uv2_pars_fragment>\n\t\t#include <map_pars_fragment>\n\t\t#include <alphamap_pars_fragment>\n\t\t#include <aomap_pars_fragment>\n\t\t#include <lightmap_pars_fragment>\n\t\t#include <emissivemap_pars_fragment>\n\t\t#include <bsdfs>\n\t\t#include <cube_uv_reflection_fragment>\n\t\t#include <envmap_pars_fragment>\n\t\t#include <envmap_physical_pars_fragment>\n\t\t#include <fog_pars_fragment>\n\t\t#include <lights_pars_begin>\n\t\t#include <lights_physical_pars_fragment>\n\t\t#include <shadowmap_pars_fragment>\n\t\t#include <bumpmap_pars_fragment>\n\t\t#include <normalmap_pars_fragment>\n        #ifndef USE_SPEC_GLOSS\n            #include <roughnessmap_pars_fragment>\n            #include <metalnessmap_pars_fragment>\n        #else\n            #ifdef USE_SPECULARMAP\n        \t    uniform sampler2D specularMap;\n            #endif\n\n            #ifdef USE_GLOSSINESSMAP\n            \tuniform sampler2D glossinessMap;\n            #endif\n        #endif\n\t\t\n\t\t#include <logdepthbuf_pars_fragment>\n\t\t#include <clipping_planes_pars_fragment>\n\n\t\t// FRESNEL\n\t\t#ifdef FRESNEL_DIFFUSE\n\t\t\tuniform vec3 fresnelDiffColorLeft;\n\t\t\tvarying float vReflectionDiffFactor;\n\t\t#endif\n\n\t\t#ifdef FRESNEL_ENV\n\t\t\tvarying float vReflectionEnvFactor;\n\t\t#endif\n\n\t\tvoid main() {\n\t\t\t#include <clipping_planes_fragment>\n\n\t\t\t// Fresnel Diffuse\n\t\t\t#ifdef FRESNEL_DIFFUSE\n\t\t\t\tvec4 diffuseColor = vec4( mix(diffuse, fresnelDiffColorLeft, vec3( vReflectionDiffFactor ) ), opacity);\n\t\t\t#else\n\t\t\t\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t\t\t#endif\n\n\t\t\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t\t\tvec3 totalEmissiveRadiance = emissive;\n\n\t\t\t#include <logdepthbuf_fragment>\n\t\t\t#include <map_fragment>\n\t\t\t#include <color_fragment>\n\t\t\t#include <alphamap_fragment>\n            #include <alphatest_fragment>\n            \n            #ifndef USE_SPEC_GLOSS\n                #include <roughnessmap_fragment>\n                #include <metalnessmap_fragment>\n            #else\n                vec3 specularFactor = specular;\n                #ifdef USE_SPECULARMAP\n                    vec4 texelSpecular = texture2D( specularMap, vUv );\n                    texelSpecular = sRGBToLinear( texelSpecular );\n                    // reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture\n                    specularFactor *= texelSpecular.rgb;\n                #endif\n\n                float glossinessFactor = glossiness;\n                #ifdef USE_GLOSSINESSMAP\n                    vec4 texelGlossiness = texture2D( glossinessMap, vUv );\n                    // reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture\n                    glossinessFactor *= texelGlossiness.a;\n                #endif\n            #endif\n\n\t\t\t#include <normal_fragment_begin>\n\t\t\t#include <normal_fragment_maps>\n\t\t\t#include <emissivemap_fragment>\n\n\t\t\t// accumulation\n\t\t\t//#include <lights_physical_fragment>\n\t\t\tPhysicalMaterial material;\n            #ifndef USE_SPEC_GLOSS\n                material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\n                material.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n            #else\n                material.diffuseColor = diffuseColor.rgb;\n                material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );\n            #endif\n\t\t\t\n\t\t\t#ifdef STANDARD\n\t\t\t\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n\t\t\t#else\n\t\t\t    float reflectivityFactor = reflectivity;\n\t\t\t\t#ifdef FRESNEL_ENV\n\t\t\t\t\treflectivityFactor = reflectivityFactor + vReflectionEnvFactor;\n\t\t\t\t#endif\n                #ifndef USE_SPEC_GLOSS\n                    material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivityFactor ) ), diffuseColor.rgb, metalnessFactor );\n                #else\n                    material.specularColor = specularFactor.rgb;\n                #endif\n\t\t\t\tmaterial.clearCoat = saturate( clearCoat ); // Burley clearcoat model\n\t\t\t\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n\t\t\t#endif\n\t\t\t#include <lights_fragment_begin>\n\t\t\t#include <lights_fragment_maps>\n\t\t\t#include <lights_fragment_end>\n\n\t\t\t// modulation\n\t\t\t#include <aomap_fragment>\n\n\t\t\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n\t\t\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t\t\t#include <tonemapping_fragment>\n\t\t\t#include <encodings_fragment>\n\t\t\t#include <fog_fragment>\n\t\t\t#include <premultiplied_alpha_fragment>\n\t\t\t#include <dithering_fragment>\n        }\n    "),this.init(n,{PHYSICAL:""},{derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},e)}},THREE.MeshPhysicalMaterialExt.prototype=Object.create(THREE.MeshStandardMaterialExt.prototype),THREE.MeshPhysicalMaterialExt.prototype.constructor=THREE.MeshPhysicalMaterialExt,THREE.MeshPhysicalMaterialExt.prototype.isMeshPhysicalMaterialExt=!0,THREE.MeshPhysicalMaterialExt.prototype.toJSON=function(e){THREE.MaterialExt.prototype.toJSON.call(this,e)},THREE.MeshPhysicalMaterialExt.prototype.clone=function(){return(new this.constructor).copy(this)},THREE.MeshPhysicalMaterialExt.prototype.copy=function(e){return THREE.MeshStandardMaterialExt.prototype.copy.call(this,e),this.defines={PHYSICAL:""},this.reflectivity=e.reflectivity,this.clearCoat=void 0===e.clearCoat?0:e.clearCoat,this.clearCoatRoughness=void 0===e.clearCoatRoughness?0:e.clearCoatRoughness,this.enableFresnelDiff=e.enableFresnelDiff,this.fresnelDiffBias=e.fresnelDiffBias,this.fresnelDiffScale=e.fresnelDiffScale,this.fresnelDiffPower=e.fresnelDiffPower,this.fresnelDiffColorLeft=e.fresnelDiffColorLeft,this.enableFresnelEnv=e.enableFresnelEnv,this.fresnelEnvBias=e.fresnelEnvBias,this.fresnelEnvScale=e.fresnelEnvScale,this.fresnelEnvPower=e.fresnelEnvPower,this.enableSpecularGlossiness=void 0===e.enableSpecularGlossiness?void 0!==e.specular||void 0!==e.glossiness:e.enableSpecularGlossiness,this.specular=e.specular,this.specularMap=void 0===e.specularMap?null:e.specularMap,this.glossiness=e.glossiness,this.glossinessMap=void 0===e.specularMap?null:e.glossinessMap,this}}]);

/*! For license information please see index.js.LICENSE.txt */
(function(){var __webpack_modules__={9669:function(e,t,n){e.exports=n(51609)},55448:function(e,t,n){"use strict";var r=n(64867),o=n(36026),i=n(15327),a=n(94097),u=n(84109),c=n(67985),s=n(85061);e.exports=function(e){return new Promise((function(t,l){var f=e.data,p=e.headers;r.isFormData(f)&&delete p["Content-Type"];var d=new XMLHttpRequest;if(e.auth){var h=e.auth.username||"",y=e.auth.password||"";p.Authorization="Basic "+btoa(h+":"+y)}var m=a(e.baseURL,e.url);if(d.open(e.method.toUpperCase(),i(m,e.params,e.paramsSerializer),!0),d.timeout=e.timeout,d.onreadystatechange=function(){if(d&&4===d.readyState&&(0!==d.status||d.responseURL&&0===d.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in d?u(d.getAllResponseHeaders()):null,r={data:e.responseType&&"text"!==e.responseType?d.response:d.responseText,status:d.status,statusText:d.statusText,headers:n,config:e,request:d};o(t,l,r),d=null}},d.onabort=function(){d&&(l(s("Request aborted",e,"ECONNABORTED",d)),d=null)},d.onerror=function(){l(s("Network Error",e,null,d)),d=null},d.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),l(s(t,e,"ECONNABORTED",d)),d=null},r.isStandardBrowserEnv()){var v=n(4372),b=(e.withCredentials||c(m))&&e.xsrfCookieName?v.read(e.xsrfCookieName):void 0;b&&(p[e.xsrfHeaderName]=b)}if("setRequestHeader"in d&&r.forEach(p,(function(e,t){void 0===f&&"content-type"===t.toLowerCase()?delete p[t]:d.setRequestHeader(t,e)})),r.isUndefined(e.withCredentials)||(d.withCredentials=!!e.withCredentials),e.responseType)try{d.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&d.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&d.upload&&d.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){d&&(d.abort(),l(e),d=null)})),void 0===f&&(f=null),d.send(f)}))}},51609:function(e,t,n){"use strict";var r=n(64867),o=n(91849),i=n(30321),a=n(47185);function u(e){var t=new i(e),n=o(i.prototype.request,t);return r.extend(n,i.prototype,t),r.extend(n,t),n}var c=u(n(45655));c.Axios=i,c.create=function(e){return u(a(c.defaults,e))},c.Cancel=n(65263),c.CancelToken=n(14972),c.isCancel=n(26502),c.all=function(e){return Promise.all(e)},c.spread=n(8713),e.exports=c,e.exports.default=c},65263:function(e){"use strict";function t(e){this.message=e}t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},t.prototype.__CANCEL__=!0,e.exports=t},14972:function(e,t,n){"use strict";var r=n(65263);function o(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;e((function(e){n.reason||(n.reason=new r(e),t(n.reason))}))}o.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},o.source=function(){var e;return{token:new o((function(t){e=t})),cancel:e}},e.exports=o},26502:function(e){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},30321:function(e,t,n){"use strict";var r=n(64867),o=n(15327),i=n(80782),a=n(13572),u=n(47185);function c(e){this.defaults=e,this.interceptors={request:new i,response:new i}}c.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=u(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=[a,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)n=n.then(t.shift(),t.shift());return n},c.prototype.getUri=function(e){return e=u(this.defaults,e),o(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],(function(e){c.prototype[e]=function(t,n){return this.request(r.merge(n||{},{method:e,url:t}))}})),r.forEach(["post","put","patch"],(function(e){c.prototype[e]=function(t,n,o){return this.request(r.merge(o||{},{method:e,url:t,data:n}))}})),e.exports=c},80782:function(e,t,n){"use strict";var r=n(64867);function o(){this.handlers=[]}o.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},o.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},o.prototype.forEach=function(e){r.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=o},94097:function(e,t,n){"use strict";var r=n(91793),o=n(7303);e.exports=function(e,t){return e&&!r(t)?o(e,t):t}},85061:function(e,t,n){"use strict";var r=n(80481);e.exports=function(e,t,n,o,i){var a=new Error(e);return r(a,t,n,o,i)}},13572:function(e,t,n){"use strict";var r=n(64867),o=n(18527),i=n(26502),a=n(45655);function u(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return u(e),e.headers=e.headers||{},e.data=o(e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),r.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||a.adapter)(e).then((function(t){return u(e),t.data=o(t.data,t.headers,e.transformResponse),t}),(function(t){return i(t)||(u(e),t&&t.response&&(t.response.data=o(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},80481:function(e){"use strict";e.exports=function(e,t,n,r,o){return e.config=t,n&&(e.code=n),e.request=r,e.response=o,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},47185:function(e,t,n){"use strict";var r=n(64867);e.exports=function(e,t){t=t||{};var n={},o=["url","method","params","data"],i=["headers","auth","proxy"],a=["baseURL","url","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"];r.forEach(o,(function(e){void 0!==t[e]&&(n[e]=t[e])})),r.forEach(i,(function(o){r.isObject(t[o])?n[o]=r.deepMerge(e[o],t[o]):void 0!==t[o]?n[o]=t[o]:r.isObject(e[o])?n[o]=r.deepMerge(e[o]):void 0!==e[o]&&(n[o]=e[o])})),r.forEach(a,(function(r){void 0!==t[r]?n[r]=t[r]:void 0!==e[r]&&(n[r]=e[r])}));var u=o.concat(i).concat(a),c=Object.keys(t).filter((function(e){return-1===u.indexOf(e)}));return r.forEach(c,(function(r){void 0!==t[r]?n[r]=t[r]:void 0!==e[r]&&(n[r]=e[r])})),n}},36026:function(e,t,n){"use strict";var r=n(85061);e.exports=function(e,t,n){var o=n.config.validateStatus;!o||o(n.status)?e(n):t(r("Request failed with status code "+n.status,n.config,null,n.request,n))}},18527:function(e,t,n){"use strict";var r=n(64867);e.exports=function(e,t,n){return r.forEach(n,(function(n){e=n(e,t)})),e}},45655:function(e,t,n){"use strict";var r=n(64867),o=n(16016),i={"Content-Type":"application/x-www-form-urlencoded"};function a(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var u,c={adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(u=n(55448)),u),transformRequest:[function(e,t){return o(t,"Accept"),o(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(a(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)?(a(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};r.forEach(["delete","get","head"],(function(e){c.headers[e]={}})),r.forEach(["post","put","patch"],(function(e){c.headers[e]=r.merge(i)})),e.exports=c},91849:function(e){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},15327:function(e,t,n){"use strict";var r=n(64867);function o(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var i;if(n)i=n(t);else if(r.isURLSearchParams(t))i=t.toString();else{var a=[];r.forEach(t,(function(e,t){null!=e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,(function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),a.push(o(t)+"="+o(e))})))})),i=a.join("&")}if(i){var u=e.indexOf("#");-1!==u&&(e=e.slice(0,u)),e+=(-1===e.indexOf("?")?"?":"&")+i}return e}},7303:function(e){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},4372:function(e,t,n){"use strict";var r=n(64867);e.exports=r.isStandardBrowserEnv()?{write:function(e,t,n,o,i,a){var u=[];u.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&u.push("expires="+new Date(n).toGMTString()),r.isString(o)&&u.push("path="+o),r.isString(i)&&u.push("domain="+i),!0===a&&u.push("secure"),document.cookie=u.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},91793:function(e){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},67985:function(e,t,n){"use strict";var r=n(64867);e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function o(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=o(window.location.href),function(t){var n=r.isString(t)?o(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},16016:function(e,t,n){"use strict";var r=n(64867);e.exports=function(e,t){r.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))}},84109:function(e,t,n){"use strict";var r=n(64867),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,i,a={};return e?(r.forEach(e.split("\n"),(function(e){if(i=e.indexOf(":"),t=r.trim(e.substr(0,i)).toLowerCase(),n=r.trim(e.substr(i+1)),t){if(a[t]&&o.indexOf(t)>=0)return;a[t]="set-cookie"===t?(a[t]?a[t]:[]).concat([n]):a[t]?a[t]+", "+n:n}})),a):a}},8713:function(e){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},64867:function(e,t,n){"use strict";var r=n(91849),o=Object.prototype.toString;function i(e){return"[object Array]"===o.call(e)}function a(e){return void 0===e}function u(e){return null!==e&&"object"==typeof e}function c(e){return"[object Function]"===o.call(e)}function s(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),i(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}e.exports={isArray:i,isArrayBuffer:function(e){return"[object ArrayBuffer]"===o.call(e)},isBuffer:function(e){return null!==e&&!a(e)&&null!==e.constructor&&!a(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:u,isUndefined:a,isDate:function(e){return"[object Date]"===o.call(e)},isFile:function(e){return"[object File]"===o.call(e)},isBlob:function(e){return"[object Blob]"===o.call(e)},isFunction:c,isStream:function(e){return u(e)&&c(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:s,merge:function e(){var t={};function n(n,r){"object"==typeof t[r]&&"object"==typeof n?t[r]=e(t[r],n):t[r]=n}for(var r=0,o=arguments.length;r<o;r++)s(arguments[r],n);return t},deepMerge:function e(){var t={};function n(n,r){"object"==typeof t[r]&&"object"==typeof n?t[r]=e(t[r],n):t[r]="object"==typeof n?e({},n):n}for(var r=0,o=arguments.length;r<o;r++)s(arguments[r],n);return t},extend:function(e,t,n){return s(t,(function(t,o){e[o]=n&&"function"==typeof t?r(t,n):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},1715:function(e,t,n){"use strict";n.d(t,{m:function(){return f}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(78842),o=n(90140),i=n(89539);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function s(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(f,e);var t,n,r,o,a=(r=f,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=l(r);if(o){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return s(this,e)});function f(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(n=a.call(this)).mUpdatable=!1,n.mCommandId=-1,n.mCommandName=e,n.mEditor=t,n}return t=f,n=[{key:"getType",value:function(){return f.TypeRTTI}},{key:"_setEditorRef",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(t||(0,i.isNullOrUndefined)(this.mEditor))&&(this.mEditor=e)}},{key:"_setCommandId",value:function(e){this.mCommandId=e}},{key:"getCommandId",value:function(){return this.mCommandId}},{key:"setCommandName",value:function(e){this.mCommandName=e}},{key:"getCommandName",value:function(){return this.mCommandName}},{key:"setUpdatable",value:function(e){this.mUpdatable=e}},{key:"isUpdatable",value:function(){return this.mUpdatable}},{key:"overridesCommand",value:function(e){return this.isTypeOf(e.getType())}},{key:"update",value:function(e){}}],n&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(r.L);f.TypeRTTI=new o.r("Command",r.L.TypeRTTI)},2311:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.d(t,{I:function(){return o}}),n(69070),n(21703);var o=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mType=t,this.mData=n}var t,n;return t=e,(n=[{key:"getType",value:function(){return this.mType}},{key:"getData",value:function(){return this.mData}}])&&r(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},7999:function(e,t,n){"use strict";n.d(t,{M:function(){return P}}),n(35666),n(41539),n(88674),n(40561),n(15581),n(2490),n(34514),n(54747),n(47941),n(54678),n(38862),n(68309),n(60086),n(69826),n(31672),n(59461),n(85827),n(25387),n(72608),n(34553),n(69070),n(21703);var r=n(29514),o=n(66008),i=n(70456),a=n(70211),u=n(73101),c=n(2311),s=n(14311),l=n(89539),f=n(38217),p=n(99556),d=n(50762),h=n(55830),y=n(41142),m=n(3635),v=n(30082),b=n(75306),g=n(23498),w=n(35572),_=n(9896),O=n(48155),T=n(10288);function R(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function S(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){R(i,r,o,a,u,"next",e)}function u(e){R(i,r,o,a,u,"throw",e)}a(void 0)}))}}function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var P=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mEventsActivity={},this.mMessageActivity={},this.mInterceptors={},this.mSubscriptions=new Array,this.mSceneSettings=new v.n,this.mHelpers={},this.mHelperPickerIcons={},this.mHelpersDisabled=!1,this.mSelectedObject=null,this.mInitializers=new Array,this.mInitialized=!1,this.mOnInitialized=new i.t(1),this.mSyncHash=new d.L,this.mApplicationState={}}var t,n,R,P,x,j,C,k;return t=e,n=[{key:"initializeEditor",value:(k=S(regeneratorRuntime.mark((function e(t,n){var r,o,i=this,a=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>2&&void 0!==a[2]&&a[2],o=a.length>3&&void 0!==a[3]?a[3]:function(){return!0},e.abrupt("return",new Promise((function(e){_.h.getInstance().resetCache(),O.y.getInstance().resetCache(),i.mHelpersDisabled=!0===r,i.mSyncHash.newHash(),i._initSubjects(),i.mInitializers.push(S(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i._initSettings(n));case 1:case"end":return e.stop()}}),e)})))),i.mInitializers.push(S(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i._initRenderer());case 1:case"end":return e.stop()}}),e)})))),i.mInitializers.push(S(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i._initManagers(t));case 1:case"end":return e.stop()}}),e)})))),p.S.executeInOrder(i.mInitializers,(function(){Promise.resolve(o()).then((function(){y.qL.print("initailized complete!!"),i.mSceneManager.buildScene().subscribe((function(e){i.dispatchEvent(s.G.BuildFinished),i.dispatchEvent(s.G.RequestFrame)}),(function(){i.dispatchEvent(s.G.BuildFinished),i.dispatchEvent(s.G.RequestFrame),i.dispatchEvent(s.G.BuildFailed)})),i.dispatchEvent(s.G.Initialized),i.mInitialized=!0,i.mOnInitialized.next(!0),e(!0)}),(function(){}))}))})));case 3:case"end":return e.stop()}}),e)}))),function(e,t){return k.apply(this,arguments)})},{key:"destructEditor",value:function(){this.mInitialized=!1,this.mOnInitialized.error("deinitialized"),this.mOnInitialized=new i.t;var e=this._destruct();this.mInitializers.splice(0),this.mInitializers.push(S(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e);case 1:case"end":return t.stop()}}),t)}))))}},{key:"_destruct",value:(C=S(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var n=function(){y.qL.print("destruct complete!!",t.mHelpers),t.mExecStack.clear(),t.mExecStack.onHistoryChanged.unsubscribe(),t.mExecStack=null,t.mEvents.unsubscribe(),t.mEvents=null,t.mEventsActivity={},t.mMessages.unsubscribe(),t.mMessages=null,t.mMessageActivity={},t.mSubscriptions.splice(0,t.mSubscriptions.length).forEach((function(e){return e.unsubscribe()})),t.mInterceptors={},t.mRenderer.dispose(),t.mRenderer=null,t.mDefaultCamera=null,t.mScene=null,t.mSceneHelpers=null,t.mHelpers={},t.mSelectedObject=null,(0,l.isNullOrUndefined)(t.mSceneDefaultBg)||(t.mSceneDefaultBg.dispose(),t.mSceneDefaultBg=null),(0,l.isNullOrUndefined)(t.mPipelineManager)||(t.mPipelineManager.dispose(),t.mPipelineManager=null),(0,l.isNullOrUndefined)(t.mUiRenderer)||(t.mUiRenderer.dispose(),t.mUiRenderer=null),t.mSyncHash.newHash(),e(!0)};(0,l.isNullOrUndefined)(t.mSceneManager)?n():t.mSceneManager.destruct().subscribe((function(){return n()}),(function(){return n()}))})));case 1:case"end":return e.stop()}}),e)}))),function(){return C.apply(this,arguments)})},{key:"observeInitialized",value:function(){return this.mOnInitialized.pipe((0,r.P)())}},{key:"isInitialized",value:function(){return this.mInitialized}},{key:"_initSettings",value:(j=S(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){if(!(0,l.isNullOrUndefined)(t)&&Object.keys(t).length>0&&!(0,l.isArray)(t)&&!("string"==typeof t||t instanceof String))return n.mSceneSettings.withSceneSettings(t),e(!0);var o=parseFloat(t);!isNaN(o)&&isFinite(o)?g.g.getInstance().resolveCatalogueSettings(t).subscribe((function(t){n.mSceneSettings.withCatalogueSettings(t),e(!0)}),(function(){r("could not download settings from catalogue id: "+JSON.stringify(t))})):r("no settings provided. using default")})));case 1:case"end":return e.stop()}}),e)}))),function(e){return j.apply(this,arguments)})},{key:"_initSubjects",value:function(){this.mEvents=new a.xQ;for(var e=0;e<s.G.MaxTypeValue;e++)this.mEventsActivity[e]=!0;return this.mMessages=new a.xQ,this.mMessageActivity={},!0}},{key:"_initRenderer",value:function(){var e=this,t=this.getDeviceSceneSettings();this.mScene=new THREE.Scene,this.mScene.userData._editorRef=this,this.mScene.userData._sceneBgControlled=!1,this.mSceneHelpers=new THREE.Scene;var n=new THREE.CubeTextureLoader;n.setCrossOrigin("anonymous"),n.setPath(h.E4.assetsUrl+"system/textures/"),n.hash=this.mSyncHash.getHash();var r="cube-grayblue";n.load([r+"-side.png",r+"-side.png",r+"-top.png",r+"-bottom.png",r+"-side.png",r+"-side.png"],(function(t){n.hash===e.mSyncHash.getHash()?(e.mSceneDefaultBg=t,!0!==e.mScene.userData._viewHasBg&&(e.mScene.background=e.mSceneDefaultBg)):t.dispose()}),(function(){}),(function(){})),this.mDefaultCamera=new THREE.PerspectiveCamera(60,1,.25,600),this.mDefaultCamera.name="Camera",this.mDefaultCamera.position.set(10,10,10),this.mDefaultCamera.lookAt(new THREE.Vector3),this.mDefaultCamera.layers.enable(1),this.mDefaultCamera.layers.enable(2),this.mDefaultCamera.layers.enable(3);var o=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),i={alpha:t.alpha,depth:!0,stencil:!0,antialias:t.anti_aliasing,premultipliedAlpha:!0,preserveDrawingBuffer:!0===window.xpvCanvasPreserveDrawingBuffer,powerPreference:"default"},a=o.getContext("webgl2",i)||o.getContext("experimental-webgl",i)||o.getContext("webgl",i);this.mRenderer=new THREE.WebGLRenderer({antialias:t.anti_aliasing,alpha:t.alpha,logarithmicDepthBuffer:!1,preserveDrawingBuffer:!0===window.xpvCanvasPreserveDrawingBuffer,context:a,canvas:o}),this.mRenderer.autoClear=!1;var u=t.clear_color,c=u>>24,s=u>>16&255,p=u>>8&255,d=255&u;switch(c=(c/=127)>1?1:c,this.mRenderer.setClearColor(new THREE.Color(s/255,p/255,d/255),c),this.mRenderer.shadowMap.autoUpdate=!1,t.shadow){case"0":this.mRenderer.shadowMap.enabled=!1;break;case"1":this.mRenderer.shadowMap.enabled=!0,this.mRenderer.shadowMap.type=THREE.BasicShadowMap,this.mRenderer.shadowMap.needsUpdate=!0;break;case"2":this.mRenderer.shadowMap.enabled=!0,this.mRenderer.shadowMap.type=THREE.PCFShadowMap,this.mRenderer.shadowMap.needsUpdate=!0;break;case"3":this.mRenderer.shadowMap.enabled=!0,this.mRenderer.shadowMap.type=THREE.PCFSoftShadowMap,this.mRenderer.shadowMap.needsUpdate=!0}return this.mRenderer.setPixelRatio(window.devicePixelRatio),this.mRenderer.localClippingEnabled=!0,this.mRenderer.toneMapping=THREE.Uncharted2ToneMapping,this.mUiRenderer=new f.K,(0,l.isNullOrUndefined)(THREE.RectAreaLightUniformsLib)||THREE.RectAreaLightUniformsLib.init(),!0}},{key:"_initManagers",value:(x=S(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){n.mExecStack=new u.C(n),n.mPipelineManager=new m.I(n.mRenderer),n.mExecStack.onHistoryChanged.subscribe((function(e){n.dispatchEvent(s.G.HistoryChanged,e)})),n.mSceneManager=t,n.mSceneManager._initApplication(n,n.mScene),n.mSubscriptions.push(n.mSceneManager.registerOnRenderObjectAttached((function(e){n._onObjectAttached(e)})),n.mSceneManager.registerOnRenderObjectDetached((function(e){n._onObjectDetached(e)})),n.mSceneManager.registerOnDispatchAppEvent((function(e){return n._dispatchEvent(e)})),n.mSceneManager.registerOnExecuteAppCommand((function(e){return n.execute(e)})),n.mSceneManager.registerOnDispatchAppMessage((function(e){return n.dispatchMessage(e)}))),e(!0)})));case 1:case"end":return e.stop()}}),e)}))),function(e){return x.apply(this,arguments)})},{key:"updateBeforeRender",value:function(){this.getSceneHelpers().updateMatrixWorld(!1),this.getScene().updateMatrixWorld(!1);var e=this.getSceneManager().getActiveView(),t=(0,l.isNullOrUndefined)(e)||!e.setSceneBackground(this.getScene());t&&!(0,l.isNullOrUndefined)(this.mSceneDefaultBg)?(this.mScene.userData._viewHasBg=!1,this.getScene().background=this.mSceneDefaultBg):t||(this.getScene().userData._viewHasBg=!0);var n=this.getSceneManager();if(!(0,l.isNullOrUndefined)(n)&&!(0,l.isNullOrUndefined)(n.getRootNode())){var r=new w.V(this.getRenderer(),this.getCamera(),this.getScene());n.getRootNode().dispatchMessage(r)}}},{key:"getCamera",value:function(){return this.mDefaultCamera}},{key:"getScene",value:function(){return this.mScene}},{key:"getRenderer",value:function(){return this.mRenderer}},{key:"getUiRenderer",value:function(){return this.mUiRenderer}},{key:"getSceneHelpers",value:function(){return this.mSceneHelpers}},{key:"getSceneManager",value:function(){return this.mSceneManager}},{key:"getPipelineManager",value:function(){return this.mPipelineManager}},{key:"getSettings",value:function(){return this.mSceneSettings}},{key:"getDeviceSceneSettings",value:function(){return this.mSceneSettings.getSceneDeviceSettings((0,T.tq)()?b.i.Mobile:b.i.Desktop)}},{key:"saveAll",value:(P=S(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.deselect(),t=[this.getSceneManager().saveScene(),this.getPipelineManager().saveAll()],e.abrupt("return",new Promise((function(e){p.S.resolveArray(t,(function(t){e(t)}))})));case 3:case"end":return e.stop()}}),e,this)}))),function(){return P.apply(this,arguments)})},{key:"helpers",get:function(){return this.mHelpers}},{key:"addNode",value:function(e){this.mSceneManager.addNode(e).then((function(){}),(function(){})),this.dispatchEvent(s.G.SceneGraphAdded,e)}},{key:"removeNode",value:function(e){null!==e.getParent()&&(this.deselect(),e.getParent().detachChild(e),this.dispatchEvent(s.G.SceneGraphRemoved,e))}},{key:"resetStates",value:function(){this.mApplicationState={}}},{key:"enableState",value:function(e){this.mApplicationState[e]=!0}},{key:"disableState",value:function(e){this.mApplicationState[e]=!1}},{key:"getState",value:function(e){return this.mApplicationState[e]}},{key:"_onObjectAttached",value:function(e){var t=this;!0===e.isObject3D&&e.traverse((function(e){t.addHelper(e)})),this.dispatchEvent(s.G.NodeAdded,e)}},{key:"_onObjectDetached",value:function(e){var t=this;e!==this.mScene&&(!0===e.isObject3D&&e.traverse((function(e){t.removeHelper(e)})),this.dispatchEvent(s.G.NodeRemoved,e))}},{key:"addHelper",value:function(e){if(!this.mHelpersDisabled){var t,n,r=!0;if(e instanceof THREE.Camera)t=new THREE.CameraHelper(e),(n=this.createHelperPicker("assets/system/textures/video-camera.png")).scale.copy(new THREE.Vector3(.5,.5,.5));else if(e instanceof THREE.PointLight)t=new THREE.PointLightHelper(e,1),n=this.createHelperPicker("assets/system/textures/lightbulb-png.png");else if(e instanceof THREE.DirectionalLight)t=new THREE.DirectionalLightHelper(e,1),n=this.createHelperPicker("assets/system/textures/lightbulb-png.png");else if(e instanceof THREE.SpotLight)t=new THREE.SpotLightHelper(e),n=this.createHelperPicker("assets/system/textures/lightbulb-png.png");else if(e instanceof THREE.HemisphereLight)t=new THREE.HemisphereLightHelper(e,1),n=this.createHelperPicker("assets/system/textures/lightbulb-png.png");else if(e instanceof THREE.RectAreaLight)t=new THREE.RectAreaLightHelper(e),e.add(t),(n=this.createHelperPicker("assets/system/textures/lightbulb-png.png")).scale.copy(new THREE.Vector3(.5,.5,.5)),r=!1;else if(e instanceof THREE.SkinnedMesh)t=new THREE.SkeletonHelper(e),n=this.createHelperPicker("assets/system/textures/skeleton-icon.png");else if("clipping"===e.needsHelper){var o=new THREE.PlaneBufferGeometry(1e3,1e3);o.userData={objectRef:e},t=new THREE.Mesh(o,new THREE.MeshBasicMaterial({side:THREE.DoubleSide,color:838099,transparent:!0,opacity:.2}));var i=new THREE.ArrowHelper(new THREE.Vector3(0,0,1),new THREE.Vector3,1,838101);i.name="arrow_helper",t.add(i),t.update=function(){},o.userData.helper=t,o.userData.arrow=i,t.onBeforeRender=function(e,t,n,r,o,i){var a=r.userData.objectRef,u=r.userData.helper,c=r.userData.arrow,s=a.userData.sceneObjectRef;if(!(0,l.isNullOrUndefined)(s)&&s.hasRenderObject()){var f=new THREE.Vector3;a.getWorldPosition(f);var p=a.target,d=new THREE.Vector3;p.getWorldPosition(d),u.position.copy(f.clone()),u.lookAt(d.clone()),c.setLength(d.clone().sub(f.clone()).length())}},(n=this.createHelperPicker("assets/system/textures/Editing-Cut-Filled-icon.png")).scale.copy(new THREE.Vector3(.25,.25,.25)),t.position.copy(e.position)}else{if("drop_area"!==e.needsHelper)return;y.qL.print("adding droparea helper");var a=new THREE.PlaneBufferGeometry(2,2);a.userData={objectRef:e},(t=new THREE.Mesh(a,new THREE.MeshBasicMaterial({side:THREE.DoubleSide,color:16770611,transparent:!0,opacity:.2}))).update=function(){},a.userData.helper=t,t.onBeforeRender=function(e,t,n,r,o,i){var a=r.userData.objectRef,u=r.userData.helper,c=a.userData.sceneObjectRef;if(!(0,l.isNullOrUndefined)(c)&&c.hasRenderObject()){var s=new THREE.Vector3;a.getWorldPosition(s),u.position.copy(s.clone());var f=a.scale.clone();u.scale.copy(f.clone()),u.rotation.copy(a.rotation.clone());var p=u.children.find((function(e){return"picker"===e.name})),d=0===f.x?1:f.x,h=0===f.y?1:f.y,y=0===f.z?1:f.z;p.scale.copy(new THREE.Vector3(.25/d,.25/h,.25/y)),u.updateMatrixWorld()}},(n=this.createHelperPicker("assets/system/icons/dragandrop_icon.png")).scale.copy(new THREE.Vector3(.25,.25,.25)),t.position.copy(e.position)}n.name="picker",n.userData.object=e,t.add(n),r&&this.mSceneHelpers.add(t),this.mHelpers[e.id]=t,this.changeHelperVisibility(t,!1),this.dispatchEvent(s.G.HelperAdded,t)}}},{key:"removeHelper",value:function(e){if(!(0,l.isNullOrUndefined)(this.mHelpers[e.id])){var t=this.mHelpers[e.id];t.parent.remove(t),this.mHelpers[e.id]=null,this.dispatchEvent(s.G.HelperRemoved,t)}}},{key:"changeHelperVisibility",value:function(e,t){(0,l.isNullOrUndefined)(e)||e.traverse((function(e){"picker"===e.name?e.material.visible=!t:(0,l.isUndefined)(e.material)||(e.material.visible=t)}))}},{key:"createHelperPicker",value:function(e){(0,l.isNullOrUndefined)(this.mHelperPickerIcons[e])&&(this.mHelperPickerIcons[e]=(new THREE.TextureLoader).load(e));var t=new THREE.SpriteMaterial({map:this.mHelperPickerIcons[e],color:16777215,depthTest:!1,depthWrite:!1,transparent:!0});return new THREE.Sprite(t)}},{key:"select",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.mSelectedObject!==e&&((0,l.isNullOrUndefined)(this.mSelectedObject)||this.changeHelperVisibility(this.mHelpers[this.mSelectedObject.id],!1),(0,l.isNullOrUndefined)(e)||(y.qL.print("set object visible: ",e.id),this.changeHelperVisibility(this.mHelpers[e.id],!0)),this.mSelectedObject=e,y.qL.print("editor selected object: ",e),this.dispatchEvent(s.G.ObjectSelected,{selection:e,options:t}))}},{key:"deselect",value:function(){this.select(null)}},{key:"getSelectedObject",value:function(){return this.mSelectedObject}},{key:"getSelectedSceneObject",value:function(){var e=this.getSelectedObject();if(!(0,l.isNullOrUndefined)(e))return e.userData.sceneObjectRef}},{key:"focus",value:function(e){this.dispatchEvent(s.G.ObjectFocused,e)}},{key:"activateEventType",value:function(e){this.mEventsActivity[e]=!0}},{key:"deactivateEventType",value:function(e){this.mEventsActivity[e]=!1}},{key:"isEventTypeActive",value:function(e){return this.mEventsActivity[e]}},{key:"observeEvents",value:function(e){var t=this;return this.mEvents.pipe((0,o.h)((function(n){return t.isEventTypeActive(e)&&n.getType()===e})))}},{key:"dispatchEvent",value:function(e,t){this._dispatchEvent(new c.I(e,t))}},{key:"_dispatchEvent",value:function(e){null!==this.mEvents&&(this.mEvents.next(e),this._onEventSent(e.getType(),e.getData()))}},{key:"observeMessages",value:function(e){var t=this;return this.mMessages.pipe((0,o.h)((function(n){return t.isMessageTypeAcitve(e)&&n.getType().isDerivedTypeOf(e)})))}},{key:"activateMessageType",value:function(e){this.mMessageActivity[e.getTypeName()]=!0}},{key:"deactivateMesssageType",value:function(e){this.mMessageActivity[e.getTypeName()]=!1}},{key:"isMessageTypeAcitve",value:function(e){return!1!==this.mMessageActivity[e.getTypeName()]}},{key:"dispatchMessage",value:function(e){this.mMessages.next(e)}},{key:"intercept",value:(R=S(regeneratorRuntime.mark((function e(t,n){var r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,o){if(t in r.mInterceptors&&r.mInterceptors[t].length>0){var i=r.mInterceptors[t].reduce((function(e,t){return t.execute(e)}),n);(0,l.isNull)(i)?o(i):e(i)}else e(n)})));case 1:case"end":return e.stop()}}),e)}))),function(e,t){return R.apply(this,arguments)})},{key:"registerInterceptor",value:function(e,t){return e in this.mInterceptors||(this.mInterceptors[e]=[]),this.mInterceptors[e].push(t),t.cid}},{key:"unregisterInterceptor",value:function(e,t){return this.unregisterInterceptorByCid(e,t.cid)}},{key:"unregisterInterceptorByCid",value:function(e,t){if(e in this.mInterceptors){var n=this.mInterceptors[e].findIndex((function(e){return e.cid===t}));if(n>=0)return this.mInterceptors[e].splice(n,1)[0]}return null}},{key:"_onEventSent",value:function(e,t){switch(e){case s.G.TransformControlChanged:case s.G.ModelAttributeChanged:case s.G.ObjectChanged:case s.G.ObjectSelected:case s.G.ObjectTargetChanged:case s.G.TransformModeChanged:case s.G.TransformTargetMode:case s.G.WindowResized:this.dispatchEvent(s.G.RequestFrame)}switch(e){case s.G.ModelAttributeChanged:case s.G.ObjectChanged:case s.G.ObjectTargetChanged:case s.G.WindowResized:case s.G.BuildFinished:case s.G.BuildUpdated:case s.G.HistoryChanged:case s.G.NodeAdded:case s.G.NodeChanged:case s.G.NodeRemoved:case s.G.SceneGraphChanged:case s.G.MeshChanged:case s.G.OffsetChanged:(0,l.isNullOrUndefined)(this.mRenderer)||(this.mRenderer.shadowMap.needsUpdate=!0)}switch(e){case s.G.SceneGraphAdded:case s.G.SceneGraphRemoved:this.dispatchEvent(s.G.SceneGraphChanged)}}},{key:"execute",value:function(e,t){this.mExecStack.execute(e,t)}},{key:"getExecStack",value:function(){return this.mExecStack}},{key:"undo",value:function(){return this.mExecStack.undo()}},{key:"redo",value:function(){return this.mExecStack.redo()}}],n&&E(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},73101:function(e,t,n){"use strict";n.d(t,{C:function(){return a}}),n(40561),n(69070),n(21703);var r=n(89539),o=n(70211);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mStackDisabled=!1,this.mCommandIdCount=0,this.onHistoryChanged=new o.xQ,this.mEditor=t,this.mUndos=new Array,this.mRedos=new Array,this.mLastCommandTime=new Date}var t,n;return t=e,n=[{key:"disableStack",value:function(){this.mStackDisabled=!0}},{key:"enableStack",value:function(){this.mStackDisabled=!1}},{key:"isEnabled",value:function(){return!1===this.mStackDisabled}},{key:"undoSize",value:function(){return this.mUndos.length}},{key:"redoSize",value:function(){return this.mRedos.length}},{key:"execute",value:function(e,t){var n=e;n._setEditorRef(this.mEditor);var o=this.mUndos.length>0?this.mUndos[this.mUndos.length-1]:null,i=(new Date).getTime()-this.mLastCommandTime.getTime();o&&o.isUpdatable()&&o.overridesCommand(n)&&i<500?(o.update(n),n=o):(this.mUndos.push(n),n._setCommandId(++this.mCommandIdCount)),n.setCommandName((0,r.isNullOrUndefined)(t)?n.getCommandName():t),n.execute(),this.mLastCommandTime=new Date,this.mRedos.splice(0,this.mRedos.length),this.onHistoryChanged.next(n)}},{key:"undo",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.mStackDisabled){var t=this.mUndos.pop();return(0,r.isUndefined)(t)||(t.undo(),this.mRedos.push(t),e&&this.onHistoryChanged.next(t)),t}console.log("exec stack disabled")}},{key:"redo",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.mStackDisabled){var t=this.mRedos.pop();return(0,r.isUndefined)(t)||(t.execute(),this.mUndos.push(t),e&&this.onHistoryChanged.next(t)),t}console.log("exec stack disabled")}},{key:"clear",value:function(){this.mUndos.splice(0,this.mUndos.length),this.mRedos.splice(0,this.mRedos.length),this.mCommandIdCount=0,this.onHistoryChanged.next(null)}},{key:"goToState",value:function(e){if(this.mStackDisabled)console.log("exec stack disabled");else{var t=this.mUndos.length>0?this.mUndos[this.mUndos.length-1]:null;if(null===t||e>t.getCommandId())for(t=this.redo(!1);!(0,r.isUndefined)(t)&&e>t.getCommandId();)t=this.redo(!1);else for(;t=this.mUndos[this.mUndos.length-1],!(0,r.isUndefined)(t)&&e!==t.getCommandId();)t=this.undo(!1);this.onHistoryChanged.next(t)}}}],n&&i(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},96169:function(e,t,n){"use strict";n.d(t,{Gw:function(){return r.G}}),n(1715),n(73101);var r=n(14311);n(23089),n(2311),n(7999)},54598:function(e,t,n){"use strict";n.d(t,{Y:function(){return l}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(1715),o=n(90140);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function c(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(l,e);var t,n,r,o,i=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=s(r);if(o){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return c(this,e)});function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=i.call(this,"Add Object")).mAddingObject=e,t}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}},{key:"execute",value:function(){this.mEditor.addNode(this.mAddingObject)}},{key:"undo",value:function(){this.mEditor.removeNode(this.mAddingObject),this.mEditor.deselect()}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r.m);l.TypeRTTI=new o.r("AddObjectCommand",r.m.TypeRTTI)},91305:function(e,t,n){"use strict";n.d(t,{Ys:function(){return r.Y},Ng:function(){return D.N},aV:function(){return L.a}});var r=n(54598),o=(n(38862),n(41539),n(15581),n(2490),n(34514),n(54747),n(47941),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948),n(1715)),i=n(90140),a=n(89539),u=n(41142);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},l(e,t)}function f(e,t){if(t&&("object"===c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t){return y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},y(e,t)}function m(e,t){if(t&&("object"===d(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(c,e);var t,n,r,o,i=(r=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=p(r);if(o){var n=p(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return f(this,e)});function c(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=i.call(this,"Delete Object")).mDeletedNode=null,t.mDeletedNode=e;var n=t.mDeletedNode.serialize(!1);return t.mSerializedObject=JSON.stringify(n),t}return t=c,(n=[{key:"getType",value:function(){return c.TypeRTTI}},{key:"execute",value:function(){this.mEditor.deselect(),this.mEditor.getSceneManager().deleteNode(this.mDeletedNode)}},{key:"_createNodes",value:function(e,t,n){var r=this;if(!(0,a.isNullOrUndefined)(e)){delete e.object_cid;var o=this.mEditor.getSceneManager().createObject(e.type,e.scene_object_id);Object.keys(e).forEach((function(t){o.setValue(t,e[t])})),null===t?this.mDeletedNode=o:t.attachChild(o),n.push(o),Array.isArray(e.children)&&e.children.forEach((function(e){r._createNodes(e,o,n)}))}}},{key:"undo",value:function(){this.mDeletedNode=null;try{var e=JSON.parse(this.mSerializedObject),t=[];this._createNodes(e,null,t),this.mEditor.addNode(this.mDeletedNode);var n=this.mEditor.getSceneManager();t.forEach((function(e){n.getRenderState().addNewNode(n.getNodeNamespace(e),e)}))}catch(e){u.qL.error("failed to recreate deleted object:",e)}}}])&&s(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(o.m)).TypeRTTI=new i.r("DeleteObjectCommand",o.m.TypeRTTI),(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(c,e);var t,n,r,o,i=(r=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=v(r);if(o){var n=v(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return m(this,e)});function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=i.call(this,"Duplicate Object")).mCreatedNode=null,t.mSerializedObject=e,t}return t=c,(n=[{key:"getType",value:function(){return c.TypeRTTI}},{key:"execute",value:function(){try{var e=JSON.parse(this.mSerializedObject),t=[];this._createNodes(e,null,t),this.mEditor.addNode(this.mCreatedNode);var n=this.mEditor.getSceneManager();t.forEach((function(e){n.getRenderState().addNewNode(n.getNodeNamespace(e),e)}))}catch(e){u.qL.error("failed to duplicate object:",e)}}},{key:"_createNodes",value:function(e,t,n){var r=this;if(!(0,a.isNullOrUndefined)(e)){delete e.scene_object_id,delete e.object_cid;var o=this.mEditor.getSceneManager().createObject(e.type);Object.keys(e).forEach((function(t){o.setValue(t,e[t])})),null===t?this.mCreatedNode=o:t.attachChild(o),n.push(o),Array.isArray(e.children)&&e.children.forEach((function(e){r._createNodes(e,o,n)}))}}},{key:"undo",value:function(){this.mEditor.deselect(),this.mEditor.getSceneManager().deleteNode(this.mCreatedNode),this.mCreatedNode=null}}])&&h(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(o.m)).TypeRTTI=new i.r("DuplicateObjectCommand",o.m.TypeRTTI),n(74819),n(38880);var b=n(14311);function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _(){return _="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=O(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},_.apply(this,arguments)}function O(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=S(e)););return e}function T(e,t){return T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},T(e,t)}function R(e,t){if(t&&("object"===g(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function S(e){return S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},S(e)}function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function x(){return x="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=j(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},x.apply(this,arguments)}function j(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=M(e)););return e}function C(e,t){return C=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},C(e,t)}function k(e,t){if(t&&("object"===E(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function M(e){return M=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},M(e)}(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=S(r);if(o){var n=S(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return R(this,e)});function u(e,t,n,r){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(o=i.call(this,"Set light value")).mObject=e,o.mAttribute=t,o.mValue=n,o.mPrevValue=o.mObject[o.mAttribute],(0,a.isUndefined)(r)||(o.mPrevValue=r),o.setUpdatable(!0),o}return t=u,(n=[{key:"getType",value:function(){return u.TypeRTTI}},{key:"getAttribute",value:function(){return this.mAttribute}},{key:"getValue",value:function(){return this.mValue}},{key:"execute",value:function(){this.mObject[this.mAttribute]=this.mValue;var e=this.mObject.userData.sceneObjectRef;(0,a.isNullOrUndefined)(e)||e.setValue("light_"+this.mAttribute,this.mValue),this.mEditor.dispatchEvent(b.G.ObjectChanged,{name:"light",object:this.mObject})}},{key:"undo",value:function(){this.mObject[this.mAttribute]=this.mPrevValue;var e=this.mObject.userData.sceneObjectRef;(0,a.isNullOrUndefined)(e)||e.setValue("light_"+this.mAttribute,this.mPrevValue),this.mEditor.dispatchEvent(b.G.ObjectChanged,{name:"light",object:this.mObject})}},{key:"overridesCommand",value:function(e){return _(S(u.prototype),"overridesCommand",this).call(this,e)&&this.mAttribute===e.getAttribute()}},{key:"update",value:function(e){this.mValue=e.getValue()}}])&&w(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(o.m)).TypeRTTI=new i.r("SetLightCommand",o.m.TypeRTTI),n(11304),(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&C(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=M(r);if(o){var n=M(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return k(this,e)});function u(e,t,n,r){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(o=i.call(this,"Set object value")).mObject=e,o.mAttribute=t,o.mValue=n,o.mPrevValue=o.mObject[o.mAttribute],(0,a.isUndefined)(r)||(o.mPrevValue=r),o.setUpdatable(!0),o}return t=u,(n=[{key:"getType",value:function(){return u.TypeRTTI}},{key:"getAttribute",value:function(){return this.mAttribute}},{key:"getValue",value:function(){return this.mValue}},{key:"execute",value:function(){this.mObject[this.mAttribute]=this.mValue;var e=this.mObject.userData.sceneObjectRef;(0,a.isNullOrUndefined)(e)||e.setValue(this.mAttribute,this.mValue),this.mEditor.dispatchEvent(b.G.ObjectChanged,{name:this.mAttribute,object:this.mObject})}},{key:"undo",value:function(){this.mObject[this.mAttribute]=this.mPrevValue;var e=this.mObject.userData.sceneObjectRef;(0,a.isNullOrUndefined)(e)||e.setValue(this.mAttribute,this.mPrevValue),this.mEditor.dispatchEvent(b.G.ObjectChanged,{name:this.mAttribute,object:this.mObject})}},{key:"overridesCommand",value:function(e){return x(M(u.prototype),"overridesCommand",this).call(this,e)&&this.mAttribute===e.getAttribute()}},{key:"update",value:function(e){this.mValue=e.getValue()}}])&&P(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(o.m)).TypeRTTI=new i.r("SetObjectValueCommand",o.m.TypeRTTI);var D=n(97841);function A(e){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},A(e)}function I(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function N(){return N="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=V(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},N.apply(this,arguments)}function V(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=B(e)););return e}function U(e,t){return U=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},U(e,t)}function F(e,t){if(t&&("object"===A(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function B(e){return B=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},B(e)}n(69826),n(31672),n(59461),(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&U(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=B(r);if(o){var n=B(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return F(this,e)});function u(e,t,n,r,o,c){var s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(s=i.call(this,"Set Post Effect")).mPostPipeline=e,s.mPipeline=t,s.mEffect=n,s.mCollection=r,s.mAttribute=o,s.mValue=c;var l=s.getData();return(0,a.isNullOrUndefined)(l)||(s.mPrevValue=l[s.mAttribute]),s.setUpdatable(!0),s}return t=u,(n=[{key:"getType",value:function(){return u.TypeRTTI}},{key:"getPipeline",value:function(){return this.mPipeline}},{key:"getCollection",value:function(){return this.mCollection}},{key:"getEffect",value:function(){return this.mEffect}},{key:"getAttribute",value:function(){return this.mAttribute}},{key:"getValue",value:function(){return this.mValue}},{key:"getData",value:function(){var e=this,t=this.mPostPipeline.getPipelines().find((function(t){return t.uuid===e.mPipeline}));if(!(0,a.isNullOrUndefined)(t)){var n=t.effects.find((function(t){return t.uuid===e.mEffect}));if(!(0,a.isNullOrUndefined)(n))return n[this.mCollection]}}},{key:"execute",value:function(){this.mPostPipeline.setEffectValue(this.mPipeline,this.mEffect,this.mCollection,this.mAttribute,this.mValue),this.mEditor.dispatchEvent(b.G.RequestFrame)}},{key:"undo",value:function(){this.mPostPipeline.setEffectValue(this.mPipeline,this.mEffect,this.mCollection,this.mAttribute,this.mPrevValue),this.mEditor.dispatchEvent(b.G.RequestFrame)}},{key:"overridesCommand",value:function(e){if(N(B(u.prototype),"overridesCommand",this).call(this,e)){var t=e;return this.mPipeline===t.getPipeline()&&this.mEffect===t.getEffect()&&this.mCollection===t.getCollection()&&this.mAttribute===t.getAttribute()}return!1}},{key:"update",value:function(e){this.mValue=e.getValue()}}])&&I(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(o.m)).TypeRTTI=new i.r("SetPostEffectCommand",o.m.TypeRTTI);var L=n(50728);function H(e){return H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},H(e)}function z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function q(){return q="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=G(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},q.apply(this,arguments)}function G(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=K(e)););return e}function W(e,t){return W=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},W(e,t)}function Q(e,t){if(t&&("object"===H(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function K(e){return K=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},K(e)}function Y(e){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Y(e)}function Z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function X(){return X="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=J(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},X.apply(this,arguments)}function J(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=te(e)););return e}function $(e,t){return $=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},$(e,t)}function ee(e,t){if(t&&("object"===Y(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function te(e){return te=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},te(e)}function ne(e){return ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ne(e)}function re(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function oe(e,t){return oe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},oe(e,t)}function ie(e,t){if(t&&("object"===ne(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ae(e){return ae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ae(e)}n(59835),(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&W(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=K(r);if(o){var n=K(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Q(this,e)});function u(e,t,n,r){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(o=i.call(this,"Set shadow value")).mObject=e,o.mAttribute=t,o.mValue=n,o.mPrevValue=o.mObject.shadow[o.mAttribute],(0,a.isUndefined)(r)||(o.mPrevValue=r),o.setUpdatable(!0),o}return t=u,(n=[{key:"getType",value:function(){return u.TypeRTTI}},{key:"getAttribute",value:function(){return this.mAttribute}},{key:"getValue",value:function(){return this.mValue}},{key:"execute",value:function(){this.mObject.shadow[this.mAttribute]=this.mValue,(0,a.isNullOrUndefined)(this.mObject.shadow.needsUpdate)||(this.mObject.shadow.needsUpdate=!0);var e=this.mObject.userData.sceneObjectRef;(0,a.isNullOrUndefined)(e)||e.setValue("shadow_"+this.mAttribute,this.mValue),this.mEditor.dispatchEvent(b.G.ObjectChanged,{name:"shadow",object:this.mObject,attribute:this.mAttribute,value:this.mValue})}},{key:"undo",value:function(){this.mObject.shadow[this.mAttribute]=this.mPrevValue;var e=this.mObject.userData.sceneObjectRef;(0,a.isNullOrUndefined)(e)||e.setValue("shadow_"+this.mAttribute,this.mPrevValue),this.mEditor.dispatchEvent(b.G.ObjectChanged,{name:"shadow",object:this.mObject,attribute:this.mAttribute,value:this.mValue})}},{key:"overridesCommand",value:function(e){return q(K(u.prototype),"overridesCommand",this).call(this,e)&&this.mAttribute===e.getAttribute()}},{key:"update",value:function(e){this.mValue=e.getValue()}}])&&z(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(o.m)).TypeRTTI=new i.r("SetShadowCommand",o.m.TypeRTTI),(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=te(r);if(o){var n=te(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return ee(this,e)});function u(e,t,n,r){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(o=i.call(this,"Set shadow camera value")).mObject=e,o.mAttribute=t,o.mValue=n,o.mPrevValue=o.mObject.shadow.camera[o.mAttribute],(0,a.isUndefined)(r)||(o.mPrevValue=r),o.setUpdatable(!0),o}return t=u,(n=[{key:"getType",value:function(){return u.TypeRTTI}},{key:"getAttribute",value:function(){return this.mAttribute}},{key:"getValue",value:function(){return this.mValue}},{key:"execute",value:function(){this.mObject.shadow.camera[this.mAttribute]=this.mValue,(0,a.isNullOrUndefined)(this.mObject.shadow.needsUpdate)||(this.mObject.shadow.needsUpdate=!0);var e=this.mObject.userData.sceneObjectRef;(0,a.isNullOrUndefined)(e)||e.setValue("shadow_camera_"+this.mAttribute,this.mValue),this.mEditor.dispatchEvent(b.G.ObjectChanged,{name:"shadow_camera",object:this.mObject,attribute:this.mAttribute,value:this.mValue})}},{key:"undo",value:function(){this.mObject.shadow.camera[this.mAttribute]=this.mPrevValue;var e=this.mObject.userData.sceneObjectRef;(0,a.isNullOrUndefined)(e)||e.setValue("shadow_camera_"+this.mAttribute,this.mPrevValue),this.mEditor.dispatchEvent(b.G.ObjectChanged,{name:"shadow_camera",object:this.mObject,attribute:this.mAttribute,value:this.mValue})}},{key:"overridesCommand",value:function(e){return X(te(u.prototype),"overridesCommand",this).call(this,e)&&this.mAttribute===e.getAttribute()}},{key:"update",value:function(e){this.mValue=e.getValue()}}])&&Z(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(o.m)).TypeRTTI=new i.r("SetShadowCameraCommand",o.m.TypeRTTI),n(74920),(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oe(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ae(r);if(o){var n=ae(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return ie(this,e)});function u(e,t,n){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(r=i.call(this,"Set ui value")).mObject=e,r.mPrevImagePath=r.mObject.getValue("imagePath");var o=r.mObject.userData.sceneObjectRef;return(0,a.isNullOrUndefined)(o)||(r.mPrevImageId=o.getValue("image")),r.mImageId=t,r.mImagePath=n,r.setUpdatable(!1),r}return t=u,(n=[{key:"getType",value:function(){return u.TypeRTTI}},{key:"execute",value:function(){this.mObject.setValue("imagePath",this.mImagePath);var e=this.mObject.userData.sceneObjectRef;(0,a.isNullOrUndefined)(e)||e.setValue("image",this.mImageId),this.mEditor.dispatchEvent(b.G.ObjectChanged,{name:"image",object:this.mObject})}},{key:"undo",value:function(){this.mObject.setValue("imagePath",this.mPrevImagePath);var e=this.mObject.userData.sceneObjectRef;(0,a.isNullOrUndefined)(e)||e.setValue("image",this.mPrevImageId),this.mEditor.dispatchEvent(b.G.ObjectChanged,{name:"image",object:this.mObject})}}])&&re(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(o.m)).TypeRTTI=new i.r("SetUiImageCommand",o.m.TypeRTTI),n(38e3)},11304:function(e,t,n){"use strict";n.d(t,{X:function(){return d}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(1715),o=n(90140),i=n(14311);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(){return c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=s(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},c.apply(this,arguments)}function s(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}function l(e,t){return l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},l(e,t)}function f(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(s,e);var t,n,r,o,a=(r=s,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=p(r);if(o){var n=p(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return f(this,e)});function s(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(r=a.call(this,"Set model value")).mObject=e,r.mAttribute=t,r.mPrevValue=r.mObject.getValue(r.mAttribute),r.mValue=n,r.setUpdatable(!0),r}return t=s,(n=[{key:"getType",value:function(){return s.TypeRTTI}},{key:"getAttribute",value:function(){return this.mAttribute}},{key:"getValue",value:function(){return this.mValue}},{key:"execute",value:function(){this.mObject.setValue(this.mAttribute,this.mValue),this.mEditor.dispatchEvent(i.G.ModelAttributeChanged,{attribute:this.mAttribute,model:this.mObject})}},{key:"undo",value:function(){this.mObject.setValue(this.mAttribute,this.mPrevValue),this.mEditor.dispatchEvent(i.G.ModelAttributeChanged,{attribute:this.mAttribute,model:this.mObject})}},{key:"overridesCommand",value:function(e){return c(p(s.prototype),"overridesCommand",this).call(this,e)&&this.mAttribute===e.getAttribute()}},{key:"update",value:function(e){this.mValue=e.getValue()}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),s}(r.m);d.TypeRTTI=new o.r("SetModelValueCommand",r.m.TypeRTTI)},97841:function(e,t,n){"use strict";n.d(t,{N:function(){return h}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(1715),o=n(90140),i=n(89539),a=n(14311);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(){return s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=l(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},s.apply(this,arguments)}function l(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}function f(e,t){return f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},f(e,t)}function p(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(l,e);var t,n,r,o,u=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=d(r);if(o){var n=d(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return p(this,e)});function l(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(r=u.call(this,"Set model position")).mObject=e,(0,i.isUndefined)(r.mObject)||(0,i.isUndefined)(t)||(r.mOldPosition=r.mObject.position.clone(),r.mNewPosition=t.clone()),(0,i.isNullOrUndefined)(n)||(r.mOldPosition=n.clone()),r.setUpdatable(!0),r}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}},{key:"getNewPosition",value:function(){return this.mNewPosition}},{key:"execute",value:function(){this.mObject.position.copy(this.mNewPosition),this.mObject.updateMatrixWorld(!0);var e=this.mObject.userData.sceneObjectRef;(0,i.isNullOrUndefined)(e)||e.setValue("position",this.mNewPosition),this.mEditor.dispatchEvent(a.G.ObjectChanged,{name:"position",object:this.mObject})}},{key:"undo",value:function(){this.mObject.position.copy(this.mOldPosition),this.mObject.updateMatrixWorld(!0);var e=this.mObject.userData.sceneObjectRef;(0,i.isNullOrUndefined)(e)||e.setValue("position",this.mOldPosition),this.mEditor.dispatchEvent(a.G.ObjectChanged,{name:"position",object:this.mObject})}},{key:"overridesCommand",value:function(e){return s(d(l.prototype),"overridesCommand",this).call(this,e)}},{key:"update",value:function(e){this.mNewPosition.copy(e.getNewPosition())}}])&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r.m);h.TypeRTTI=new o.r("SetPositionCommand",r.m.TypeRTTI)},50728:function(e,t,n){"use strict";n.d(t,{a:function(){return h}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(1715),o=n(90140),i=n(89539),a=n(14311);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(){return s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=l(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},s.apply(this,arguments)}function l(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}function f(e,t){return f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},f(e,t)}function p(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(l,e);var t,n,r,o,u=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=d(r);if(o){var n=d(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return p(this,e)});function l(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(r=u.call(this,"Set model rotation")).mObject=e,(0,i.isUndefined)(r.mObject)||(0,i.isUndefined)(t)||(r.mOldRotation=r.mObject.rotation.clone(),r.mNewRotation=t.clone()),(0,i.isNullOrUndefined)(n)||(r.mOldRotation=n.clone()),r.setUpdatable(!0),r}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}},{key:"getNewRotation",value:function(){return this.mNewRotation}},{key:"execute",value:function(){this.mObject.rotation.copy(this.mNewRotation),this.mObject.updateMatrixWorld(!0);var e=this.mObject.userData.sceneObjectRef;(0,i.isNullOrUndefined)(e)||e.setValue("rotation",this.mNewRotation),this.mEditor.dispatchEvent(a.G.ObjectChanged,{name:"rotation",object:this.mObject})}},{key:"undo",value:function(){this.mObject.rotation.copy(this.mOldRotation),this.mObject.updateMatrixWorld(!0);var e=this.mObject.userData.sceneObjectRef;(0,i.isNullOrUndefined)(e)||e.setValue("rotation",this.mOldRotation),this.mEditor.dispatchEvent(a.G.ObjectChanged,{name:"rotation",object:this.mObject})}},{key:"overridesCommand",value:function(e){return s(d(l.prototype),"overridesCommand",this).call(this,e)}},{key:"update",value:function(e){this.mNewRotation.copy(e.getNewRotation())}}])&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r.m);h.TypeRTTI=new o.r("SetRotationCommand",r.m.TypeRTTI)},59835:function(e,t,n){"use strict";n.d(t,{U:function(){return h}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(1715),o=n(90140),i=n(89539),a=n(14311);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(){return s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=l(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},s.apply(this,arguments)}function l(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}function f(e,t){return f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},f(e,t)}function p(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(l,e);var t,n,r,o,u=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=d(r);if(o){var n=d(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return p(this,e)});function l(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(r=u.call(this,"Set model scale")).mObject=e,(0,i.isUndefined)(r.mObject)||(0,i.isUndefined)(t)||(r.mOldScale=r.mObject.scale.clone(),r.mNewScale=t.clone()),(0,i.isNullOrUndefined)(n)||(r.mOldScale=n.clone()),r.setUpdatable(!0),r}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}},{key:"getNewScale",value:function(){return this.mNewScale}},{key:"execute",value:function(){this.mObject.scale.copy(this.mNewScale),this.mObject.updateMatrixWorld(!0);var e=this.mObject.userData.sceneObjectRef;(0,i.isNullOrUndefined)(e)||e.setValue("scale",this.mNewScale),this.mEditor.dispatchEvent(a.G.ObjectChanged,{name:"scale",object:this.mObject})}},{key:"undo",value:function(){this.mObject.scale.copy(this.mOldScale),this.mObject.updateMatrixWorld(!0);var e=this.mObject.userData.sceneObjectRef;(0,i.isNullOrUndefined)(e)||e.setValue("scale",this.mOldScale),this.mEditor.dispatchEvent(a.G.ObjectChanged,{name:"scale",object:this.mObject})}},{key:"overridesCommand",value:function(e){return s(d(l.prototype),"overridesCommand",this).call(this,e)}},{key:"update",value:function(e){this.mNewScale.copy(e.getNewScale())}}])&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r.m);h.TypeRTTI=new o.r("SetScaleCommand",r.m.TypeRTTI)},74920:function(e,t,n){"use strict";n.d(t,{V:function(){return h}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(1715),o=n(90140),i=n(89539),a=n(14311);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(){return s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=l(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},s.apply(this,arguments)}function l(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}function f(e,t){return f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},f(e,t)}function p(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(l,e);var t,n,r,o,u=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=d(r);if(o){var n=d(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return p(this,e)});function l(e,t,n){var r;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(r=u.call(this,"Set model target position")).mObject=e,!(0,i.isUndefined)(r.mObject)&&!(0,i.isUndefined)(t)){if(!(0,i.isNullOrUndefined)(r.mObject.target)){var o=r.mObject.target;r.mOldPosition=o.position.clone()}r.mNewPosition=t.clone()}return(0,i.isNullOrUndefined)(n)||(r.mOldPosition=n.clone()),r.setUpdatable(!0),r}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}},{key:"getNewPosition",value:function(){return this.mNewPosition}},{key:"execute",value:function(){var e=!1;if(console.log("update target"),!(0,i.isNullOrUndefined)(this.mObject)&&!(0,i.isNullOrUndefined)(this.mObject.target)){var t=this.mObject.target;t.position.copy(this.mNewPosition),t.updateMatrixWorld(!0),(0,i.isNullOrUndefined)(t.userData.camera)||(e=!0,this.mObject.lookAt(this.mNewPosition),this.mObject.updateMatrixWorld(!0))}var n=this.mObject.userData.sceneObjectRef;(0,i.isNullOrUndefined)(n)||(n.setValue("target",this.mNewPosition),e&&n.setValue("rotation",this.mObject.rotation)),this.mEditor.dispatchEvent(a.G.ObjectTargetChanged,{name:"position",object:this.mObject})}},{key:"undo",value:function(){var e=!1;if(!(0,i.isNullOrUndefined)(this.mObject)&&!(0,i.isNullOrUndefined)(this.mObject.target)){var t=this.mObject.target;t.position.copy(this.mOldPosition),t.updateMatrixWorld(!0),(0,i.isNullOrUndefined)(t.userData.camera)||(e=!0,this.mObject.lookAt(this.mOldPosition),this.mObject.updateMatrixWorld(!0))}var n=this.mObject.userData.sceneObjectRef;(0,i.isNullOrUndefined)(n)||(n.setValue("target",this.mOldPosition),e&&n.setValue("rotation",this.mObject.rotation)),this.mEditor.dispatchEvent(a.G.ObjectTargetChanged,{name:"position",object:this.mObject})}},{key:"overridesCommand",value:function(e){return s(d(l.prototype),"overridesCommand",this).call(this,e)}},{key:"update",value:function(e){this.mNewPosition.copy(e.getNewPosition())}}])&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r.m);h.TypeRTTI=new o.r("SetTargetPositionCommand",r.m.TypeRTTI)},38e3:function(e,t,n){"use strict";n.d(t,{K:function(){return y}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(1715),o=n(90140),i=n(14311),a=n(89539);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(){return l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=f(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},l.apply(this,arguments)}function f(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}function p(e,t){return p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},p(e,t)}function d(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(f,e);var t,n,r,o,u=(r=f,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(r);if(o){var n=h(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return d(this,e)});function f(e,t,n){var r,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4?arguments[4]:void 0;return c(this,f),(r=u.call(this,"Set ui value")).mObject=e,r.mAttribute=t,r.mValue=n,r.mPrevValue=r.mObject.getValue(r.mAttribute),r.mPreApplied=o,(0,a.isUndefined)(i)||(r.mPrevValue=i),r.setUpdatable(!0),r}return t=f,(n=[{key:"getType",value:function(){return f.TypeRTTI}},{key:"getAttribute",value:function(){return this.mAttribute}},{key:"getValue",value:function(){return this.mValue}},{key:"execute",value:function(){!this.mPreApplied&&(0,a.isFunction)(this.mObject.setValue)&&this.mObject.setValue(this.mAttribute,this.mValue),this.mPreApplied=!1;var e=this.mObject.userData.sceneObjectRef;(0,a.isNullOrUndefined)(e)||e.setValue(this.mAttribute,this.mValue),this.mEditor.dispatchEvent(i.G.ObjectChanged,{name:this.mAttribute,object:this.mObject})}},{key:"undo",value:function(){(0,a.isFunction)(this.mObject.setValue)&&this.mObject.setValue(this.mAttribute,this.mPrevValue);var e=this.mObject.userData.sceneObjectRef;(0,a.isNullOrUndefined)(e)||e.setValue(this.mAttribute,this.mPrevValue),this.mEditor.dispatchEvent(i.G.ObjectChanged,{name:this.mAttribute,object:this.mObject})}},{key:"overridesCommand",value:function(e){return l(h(f.prototype),"overridesCommand",this).call(this,e)&&this.mAttribute===e.getAttribute()}},{key:"update",value:function(e){this.mValue=e.getValue()}}])&&s(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(r.m);y.TypeRTTI=new o.r("SetUiValueCommand",r.m.TypeRTTI)},86904:function(e,t,n){"use strict";n(20490),n(24671),n(23937),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(18743),o=n(90140),i=n(35572),a=n(73010),u=n(14311),c=n(11304),s=n(41142);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},p(e,t)}function d(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(y,e);var t,n,r,o,l=(r=y,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(r);if(o){var n=h(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return d(this,e)});function y(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,y),(r=l.call(this,"transformPointComponent")).mTransformControls=null,r.onBeforeRender=function(e){s.qL.print("transform comp before render"),r._initializeTransformer(e.renderer,e.camera,e.scene)},r.mSceneEntity=e,r.mMarkerMesh=t,r.mAttribute=n,r}return t=y,(n=[{key:"getType",value:function(){return y.TypeRTTI}},{key:"_initializeTransformer",value:function(e,t,n){var r=this;null===this.mTransformControls&&(this.mTransformControls=new THREE.TransformControls(t,e.domElement),this.registerMessageHandler(a.c.TypeRTTI,(function(){r.mTransformControls.update()})),this.mTransformControls.addEventListener("change",(function(){var e=r.mTransformControls.object;r.mSceneEntity.getRenderState().dispatchAppEvent(u.G.TransformControlChanged,e),r.mTransformControls.update()})),this.mTransformControls.addEventListener("mouseDown",(function(){var e=r.mTransformControls.object;r.mObjectPositionOnDown=e.position.clone()})),this.mTransformControls.addEventListener("mouseUp",(function(){var e=r.mTransformControls.object;void 0!==e&&"translate"===r.mTransformControls.getMode()&&(r.mObjectPositionOnDown.equals(e.position)||r.mSceneEntity.getRenderState().executeAppCommand(new c.X(r.mSceneEntity,r.mAttribute,e.position)))})),n.add(this.mTransformControls))}},{key:"OnAttached",value:function(){s.qL.print("transform comp attached"),this.registerMessageHandler(i.V.TypeRTTI,this.onBeforeRender)}},{key:"OnDetached",value:function(){this.unregisterMessageHandler(i.V.TypeRTTI),null!==this.mTransformControls&&(this.mTransformControls.dispose(),this.unregisterMessageHandler(a.c.TypeRTTI),this.mTransformControls=null)}},{key:"isAttachable",value:function(e){return e.isDerivedOfTypeName("SceneEntity")}}])&&f(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),y}(r.H)).TypeRTTI=new o.r("TransformPointComponent",r.H.TypeRTTI),n(12254),n(93663)},12254:function(e,t,n){"use strict";n.d(t,{P:function(){return oe}}),n(35666),n(41539),n(15581),n(2490),n(34514),n(54747),n(40561),n(88674),n(91058),n(47941),n(54678),n(56977),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948),n(91038),n(47042),n(68309),n(74916),n(77601);var r=n(70456),o=n(42615),i=n(90964),a=function(){function e(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return e.prototype=Object.create(Error.prototype),e}(),u=n(70655),c=n(17604);var s=function(){function e(e,t,n,r){this.waitFor=e,this.absoluteTimeout=t,this.withObservable=n,this.scheduler=r}return e.prototype.call=function(e,t){return t.subscribe(new l(e,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))},e}(),l=function(e){function t(t,n,r,o,i){var a=e.call(this,t)||this;return a.absoluteTimeout=n,a.waitFor=r,a.withObservable=o,a.scheduler=i,a.scheduleTimeout(),a}return u.ZT(t,e),t.dispatchTimeout=function(e){var t=e.withObservable;e._unsubscribeAndRecycle(),e.add((0,c.ft)(t,new c.IY(e)))},t.prototype.scheduleTimeout=function(){var e=this.action;e?this.action=e.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(t.dispatchTimeout,this.waitFor,this))},t.prototype._next=function(t){this.absoluteTimeout||this.scheduleTimeout(),e.prototype._next.call(this,t)},t.prototype._unsubscribe=function(){this.action=void 0,this.scheduler=null,this.withObservable=null},t}(c.Ds),f=n(64944),p=n(84217),d=n(63438),h=n(94130),y=n(49029),m=n(18743),v=n(41142),b=n(89539),g=n(68009);function w(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return _(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw i}}}}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function O(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function T(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){O(i,r,o,a,u,"next",e)}function u(e){O(i,r,o,a,u,"throw",e)}a(void 0)}))}}function R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var S=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r,o;return t=e,n=[{key:"calculate",value:(o=T(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,o){r.getComponent("materialGroupManager").resolveMaterialGroups().subscribe((function(r){v.qL.print("material price");var o=0;r.getGroups().forEach((function(e){var t=r.getActiveRefModel(e.id);!(0,b.isNullOrUndefined)(t)&&g.F.isNumeric(t.price)&&(o+=+t.price)})),v.qL.print("Calculated material price:",o),t.totals=t.totals||{},t.totals.base=t.totals.base||0,t.totals.base+=o,e({totals:t.totals,models:t.models,catalogue:n.catalogue})}),(function(e){o(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})},{key:"breakDown",value:(r=T(regeneratorRuntime.mark((function e(t,n){var r,o,i,a,u,c,s,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.getComponent("materialGroupManager"),e.next=3,new Promise((function(e,t){r.resolveMaterialGroups().subscribe((function(t){return e(t)}),(function(e){return t(e)}))}));case 3:o=e.sent,i=[],a=o.getGroups(),u=w(a),e.prev=7,u.s();case 9:if((c=u.n()).done){e.next=19;break}if(s=c.value,l=o.getActiveRefModel(s.id),!(0,b.isNullOrUndefined)(l)&&g.F.isNumeric(l.price)){e.next=14;break}return e.abrupt("continue",17);case 14:if(!n.excludePriceZero||0!==l.price){e.next=16;break}return e.abrupt("continue",17);case 16:i.push({id:l.id,price:l.price,name:l.name,material_id:l.material_id,material_name:l.material_name});case 17:e.next=9;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(7),u.e(e.t0);case 24:return e.prev=24,u.f(),e.finish(24);case 27:return e.abrupt("return",{materials:i});case 28:case"end":return e.stop()}}),e,null,[[7,21,24,27]])}))),function(e,t){return r.apply(this,arguments)})},{key:"getBreakDownName",value:function(){return"materials"}}],n&&R(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function E(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?P(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw i}}}}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function x(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function j(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){x(i,r,o,a,u,"next",e)}function u(e){x(i,r,o,a,u,"throw",e)}a(void 0)}))}}function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n(2707),n(92222),n(69826),n(31672),n(59461),n(34553),n(39714),n(57327),n(88449),n(59849),n(68216),n(79433),n(15306),n(24603),n(28450),n(88386),n(69600),n(23123);var k=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mPricingRulesBreakDown=[]}var t,n,r,o,i;return t=e,n=[{key:"calculate",value:(i=j(regeneratorRuntime.mark((function e(t,n,r,o){var i,a,u,c,s,l,f=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.getComponent("attributeManager"),e.next=3,i.resolveAttributeManager().toPromise();case 3:return a=e.sent,u=this.getApplicablePricingGroups(n),e.next=7,this.getModelDescriptor(r,a,o,n);case 7:return c=e.sent,(s=t.totals||{}).base=s.base||0,u.sort((function(e,t){return e.priority-t.priority})),u.forEach((function(e){var t=f.applyPricingRules(e,c,a);Object.keys(t).forEach((function(e){s[e]=s[e]||0,s[e]+=t[e]}))})),l=t.models.concat(c),e.abrupt("return",{totals:s,models:l,catalogue:n.catalogue});case 14:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return i.apply(this,arguments)})},{key:"mapUnitToRatio",value:function(e){if(e)switch(e.toLowerCase()){case"km":return.001;case"hm":return.01;case"dam":return.1;case"m":return 1;case"dm":return 10;case"cm":return 100;case"mm":return 1e3}return 1}},{key:"applyPricingRules",value:function(e,t,n){var r=this,o=this.getApplicablePricingRules(e,t,n);this.mPricingRulesBreakDown=[],o.sort((function(e,t){return e.priority-t.priority}));var i={};o.forEach((function(e){i[e.priority]=i[e.priority]||[],i[e.priority].push(e)}));var a={base:0};return Object.keys(i).forEach((function(e){i[e].forEach((function(e){var t={};g.F.isNumeric(e.adjustment)&&(t.base=parseFloat(e.adjustment)),Array.isArray(e.pricing_rule_adjustment_fields)&&e.pricing_rule_adjustment_fields.forEach((function(e){e.pivot&&g.F.isNumeric(e.pivot.adjustment)&&(t[e.name]=parseFloat(e.pivot.adjustment))}));var o=Object.keys(t),i=0;switch(e.type){case"compound":o.forEach((function(e){a[e]=a[e]||0,a[e]+=t[e],i+=t[e]}));break;case"rate":o.forEach((function(e){a[e]=a[e]||0,a[e]=a[e]*t[e],i+=a[e]*t[e]}));break;case"unit":if(!(0,b.isNullOrUndefined)(e.attribute_id)){var u=n.getAttributeController(e.attribute_id);if(!(0,b.isNullOrUndefined)(u)){var c=u.getValueName();if(g.F.isNumeric(c)){var s=1;if(u.getAttribute().attribute_values.length>0){var l=u.getAttribute().attribute_values[0].attribute_value_valuable;(0,b.isNullOrUndefined)(l)||(s=r.mapUnitToRatio(l.unit))}var f=r.mapUnitToRatio(e.unit),p=parseFloat(c);p*=f/s,o.forEach((function(e){a[e]=a[e]||0,a[e]+=p*t[e],i+=p*t[e]}))}}}}r.mPricingRulesBreakDown.push({id:e.id,sku_pattern:e.sku_pattern,type:e.type,adjustment_price:i,pricing_fields:e.pricing_rule_adjustment_fields})}))})),a}},{key:"getModelDescriptor",value:(o=j(regeneratorRuntime.mark((function e(t,n,r,o){var i,a,u,c,s,l,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.getMaterialGroupManager(),a=t.getComponent("articleListManager"),e.next=4,a.getArticles();case 4:return u=e.sent,c=r.getBatches(),s=new Array,c.forEach((function(e){if(e.getMaterialGroupId()>0){var t=i.getGroup(e.getMaterialGroupId());!(0,b.isNullOrUndefined)(t)&&t.generate_code&&e.getNodes().forEach((function(t){var n=t.models_id,r=u.find((function(e){return e.modelId===n}));r&&s.findIndex((function(t){return t.models_id==n&&t.material_group_id==e.getMaterialGroupId()}))<0&&s.push({models_id:n,models_sku:r.sku,models_name:r.name,models_price:r.price,material_group_id:e.getMaterialGroupId(),material_group_sku:i.getActiveGroupSKU(e.getMaterialGroupId())})}))}})),u.forEach((function(e){s.findIndex((function(t){return t.models_id==e.modelId}))<0&&s.push({models_id:parseInt(e.modelId,10),models_sku:e.sku,models_name:e.name,models_price:e.price,material_group_id:-1,material_group_sku:null})})),v.qL.print("exporting models: ",s),l=n.getAttributeControllers(),f={},l.forEach((function(e){f[e.getAttribute().id]=e.getValueName()})),s.forEach((function(e){var t="";null!==e.models_sku&&(t+=e.models_sku),null!==e.material_group_sku&&(t+=e.material_group_sku),e.price_sku=!(0,b.isNullOrUndefined)(t)&&t.length>0?t.toString():null})),e.abrupt("return",s);case 15:case"end":return e.stop()}}),e)}))),function(e,t,n,r){return o.apply(this,arguments)})},{key:"getApplicablePricingGroups",value:function(e){var t=e.price_matrix||[];return t.filter((function(t){if(!Array.isArray(t.pricing_classes))return!0;var n=t.pricing_classes.filter((function(e){return"catalogue"===e.type}));return 0===n.length||!n.every((function(t){return e.modifier_classes.findIndex((function(e){return e.id===t.id}))<0}))}))}},{key:"getApplicablePricingRules",value:function(e,t,n){var r=this,o=e.pricing_rules||[],i=new Date,a=i.getMonth(),u=i.getDate(),c=i.getFullYear(),s=new Date(c,a,u);o=(o=o.filter((function(e){var t=(0,b.isNullOrUndefined)(e.starts_at)||new Date(e.starts_at.replace(/-/g,"/"))<=s,n=(0,b.isNullOrUndefined)(e.ends_at)||new Date(e.ends_at.replace(/-/g,"/"))>=s;return t&&n}))).filter((function(e){if((0,b.isNullOrUndefined)(e.condition_attribute_id))return!0;var t=n.getAttributeController(e.condition_attribute_id);return(0,b.isNullOrUndefined)(t)?(v.qL.warn("Could not verify condition"),!1):t.compareValue(e.condition_attribute_value)}));var l=new Array,f={};t.forEach((function(e){o.forEach((function(t){r.ruleMatchesModel(t,e)&&(f[t.id]=f[t.id]||0,f[t.id]+=1,l.push(t))}))}));var p={};return l=l.filter((function(e){var t=!0;return g.F.isNumeric(e.components_limit)&&e.components_limit>1&&(t=f[e.id]>=e.components_limit),t&&e.unique&&(t=!0!==p[e.id],p[e.id]=!0),t}))}},{key:"ruleMatchesModel",value:function(e,t){if((0,b.isNullOrUndefined)(t.price_sku))return!1;if((0,b.isNullOrUndefined)(e.sku_pattern))return!0;if("*"===e.sku_pattern)return!0;if(e.sku_pattern===t.price_sku)return!0;var n=!1;try{n=new RegExp("^"+e.sku_pattern.split("*").join(".*")+"$").test(t.price_sku)}catch(e){v.qL.warn("Could not match pattern: ",e)}return n}},{key:"breakDown",value:(r=j(regeneratorRuntime.mark((function e(t,n,r,o){var i,a,u,c,s,l,f,p,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.getComponent("attributeManager"),e.next=3,i.resolveAttributeManager().toPromise();case 3:return a=e.sent,u=this.getApplicablePricingGroups(r),e.next=7,this.getModelDescriptor(t,a,o,r);case 7:c=e.sent,s=[],u.sort((function(e,t){return e.priority-t.priority})),l=E(u),e.prev=11,l.s();case 13:if((f=l.n()).done){e.next=23;break}if(p=f.value,this.applyPricingRules(p,c,a),this.mPricingRulesBreakDown.length){e.next=18;break}return e.abrupt("continue",21);case 18:d=this.mPricingRulesBreakDown,!0===n.excludePriceZero&&(d=this.mPricingRulesBreakDown.filter((function(e){return e.adjustment_price>0}))),d.length&&s.push(d);case 21:e.next=13;break;case 23:e.next=28;break;case 25:e.prev=25,e.t0=e.catch(11),l.e(e.t0);case 28:return e.prev=28,l.f(),e.finish(28);case 31:return e.abrupt("return",{pricing_rules:s});case 32:case"end":return e.stop()}}),e,this,[[11,25,28,31]])}))),function(e,t,n,o){return r.apply(this,arguments)})},{key:"getBreakDownName",value:function(){return"pricing_rules"}}],n&&C(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),M=(n(19601),n(61874),n(9653),n(55830));function D(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function A(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){D(i,r,o,a,u,"next",e)}function u(e){D(i,r,o,a,u,"throw",e)}a(void 0)}))}}function I(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var N=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,n=[{key:"calculate",value:(r=A(regeneratorRuntime.mark((function e(t,n,r,i){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,i){var a=n.catalogue,u=n.settings.api_url;if(!(0,b.isString)(u)||0===u.length)return t.totals=t.totals||{},e({totals:t.totals,models:t.models,catalogue:n.catalogue});var c={product:{id:a.id,url_name:a.url_name,name:a.name,active:a.active||!0,price:a.price||0,sku:a.sku||""},attributes:[],materials:[],components:[]},s=r.getComponent("attributeManager"),l=r.getComponent("materialGroupManager"),f=r.getComponent("articleListManager");(0,o.D)(s.resolveAttributeManager(),l.resolveMaterialGroups()).subscribe(function(){var r=A(regeneratorRuntime.mark((function r(o){var a,s,l,p,d;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!((0,b.isNullOrUndefined)(o)||!Array.isArray(o)||o.length<2)){r.next=2;break}return r.abrupt("return",i());case 2:return a=o[0],s=o[1],l=function(e){return!0===e.visible||!1!==e.visible&&0!==e.visibility},a.getAttributeControllers().forEach((function(e){var t=e.getAttribute(),n=Object.assign({},t);n.visible=l(n),!(0,b.isNullOrUndefined)(n.entity_properties)&&n.entity_properties.length>0&&n.entity_properties.forEach((function(e){!(0,b.isNullOrUndefined)(e.values)&&e.values.length>0&&((0,b.isNullOrUndefined)(e.entity_property_values)||e.entity_property_values.length<=0)&&(e.entity_property_values=e.values)})),c.attributes.push(n)})),s.getGroups().forEach((function(e){var t=s.getActiveRefModel(e.id);if(!(0,b.isNullOrUndefined)(t)){var n=Object.assign({},e);n&&n.materials&&(n.selected_reference_id=t.id),c.materials.push(n)}})),r.next=11,f.getArticles();case 11:r.sent.forEach((function(e){var t={id:e.modelId,type:"configurable",name:e.name,description:e.description,sku:e.sku,price:e.price};c.components.push(t)})),p=M.OE.getInstance().getAcceptLanguage(),d=M.OE.uniqueInstance(),(0,b.isNullOrUndefined)(p)||(d.getHttpInstance().defaults.headers.common["Accept-Language"]=p),d.post(u,c,{timeout:1e4}).then((function(r){try{var o=g.F.isNumeric(r.data.price)?Number.parseFloat(r.data.price):0;v.qL.print("Price over API: ",o),t.totals=t.totals||{},t.totals.base+=o,e({totals:t.totals,models:t.models,catalogue:n.catalogue})}catch(e){v.qL.error("Something went wrong during calculating price over API: ",e),i(e)}})).catch((function(e){v.qL.error("Something went wrong during retrieving price over API: ",e),i(e)}));case 17:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),(function(e){v.qL.error("A manager failed to resolve: ",e),i(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(e,t,n,o){return r.apply(this,arguments)})},{key:"breakDown",value:function(e,t,n,r){}},{key:"getBreakDownName",value:function(){return"price_api"}}],n&&I(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),V=n(79843),U=(n(21249),n(57640),n(9924),n(38862),n(69720),n(89002));function F(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,u=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){u=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(u)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return B(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?B(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function L(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function H(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){L(i,r,o,a,u,"next",e)}function u(e){L(i,r,o,a,u,"throw",e)}a(void 0)}))}}function z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var q=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mCache={}}var t,n,r,o,i,a;return t=e,n=[{key:"getPrice",value:(a=H(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=U.F.Md5("".concat(t,"/").concat(JSON.stringify(n))),e.abrupt("return",this.resolveCache(r,t,n));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"request",value:(i=H(regeneratorRuntime.mark((function e(t,n){var r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=M.E4.makeApiRoute("script_engine/catalogue/".concat(t,"/price/get")),e.next=3,M.OE.getInstance().post(r,n).catch((function(e){return e.response})).then((function(e){return e.data}));case 3:if(!(o=e.sent).error){e.next=6;break}throw o;case 6:return e.abrupt("return",o);case 7:case"end":return e.stop()}}),e)}))),function(e,t){return i.apply(this,arguments)})},{key:"resolveCache",value:(o=H(regeneratorRuntime.mark((function e(t,n,r){var o,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=Date.now(),!(i=this.mCache[t])){e.next=5;break}return i.timestamp=o,e.abrupt("return",i.value);case 5:return a=this.request(n,r),this.mCache[t]={hash:t,timestamp:o,value:a},e.next=9,a;case 9:return this.clearOldCache(),e.abrupt("return",a);case 11:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return o.apply(this,arguments)})},{key:"clearOldCache",value:function(){var t=this,n=e.MAX_CACHE,r=Object.entries(this.mCache);r.length<=n||r.sort((function(e,t){var n=F(e,2)[1];return F(t,2)[1].timestamp-n.timestamp})).splice(n).forEach((function(e){var n=F(e,1)[0];return delete t.mCache[n]}))}}],r=[{key:"getInstance",value:function(){return null===this._instance&&(this._instance=new this),this._instance}}],n&&z(t.prototype,n),r&&z(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function W(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function Q(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){W(i,r,o,a,u,"next",e)}function u(e){W(i,r,o,a,u,"throw",e)}a(void 0)}))}}function K(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}q.MAX_CACHE=100,q._instance=null;var Y=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r,o,i,a,u,c,s,l;return t=e,n=[{key:"calculate",value:(l=Q(regeneratorRuntime.mark((function e(t,n,r,o){var i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.catalogue.id,e.next=3,this.getPrice(i,r);case 3:return this.mPricingFields=e.sent,v.qL.print("Price over script engine: ",this.mPricingFields),e.next=7,this.resolveArticles(r);case 7:return a=e.sent,t.totals=t.totals||{},this.applyPricingFields(this.mPricingFields,t.totals),this.applyArticles(a,t),e.abrupt("return",{totals:t.totals,models:t.models,catalogue:n.catalogue});case 12:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return l.apply(this,arguments)})},{key:"resolveArticles",value:(s=Q(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.getComponent("articleListManager"),e.abrupt("return",n.getArticles());case 2:case"end":return e.stop()}}),e)}))),function(e){return s.apply(this,arguments)})},{key:"applyPricingFields",value:function(e,t){Object.keys(e).forEach((function(n){g.F.isNumeric(e[n])&&(t[n]=t[n]||0,t[n]+=Number.parseFloat(e[n]))}))}},{key:"applyArticles",value:function(e,t){t.models=t.models.concat(e.map((function(e){return{material_group_id:-1,material_group_sku:null,models_id:null,models_name:e.name,models_price:e.price||0,models_sku:e.sku,price_sku:e.sku}})))}},{key:"buildRequestPayload",value:(c=Q(regeneratorRuntime.mark((function e(t){var n,r,o,i,a,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.resolveSerializedAttributes(t),this.resolveSerializedMaterials(t),this.resolveSerializedArticles(t),M.OE.getInstance().getAcceptLanguage()]);case 2:return n=e.sent,s=4,r=function(e){if(Array.isArray(e))return e}(c=n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,u=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){u=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(u)throw o}}return i}}(c,s)||function(e,t){if(e){if("string"==typeof e)return G(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?G(e,t):void 0}}(c,s)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),o=r[0],i=r[1],a=r[2],u=r[3],e.abrupt("return",{attributes:o,materials:i,articles:a,language:u});case 9:case"end":return e.stop()}var c,s}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"resolveSerializedAttributes",value:(u=Q(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.getComponent("attributeManager"),e.next=3,n.resolveAttributeManager().toPromise();case 3:return r=e.sent,e.abrupt("return",r.serialize({discard_hidden:!1,include_keys:!0,calculate_approximations:!1}));case 5:case"end":return e.stop()}}),e)}))),function(e){return u.apply(this,arguments)})},{key:"resolveSerializedMaterials",value:(a=Q(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.getComponent("materialGroupManager"),e.abrupt("return",n.serialize());case 2:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)})},{key:"resolveSerializedArticles",value:(i=Q(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.getComponent("articleListManager"),e.abrupt("return",n.serialize());case 2:case"end":return e.stop()}}),e)}))),function(e){return i.apply(this,arguments)})},{key:"getPrice",value:(o=Q(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.buildRequestPayload(n);case 2:return r=e.sent,e.abrupt("return",q.getInstance().getPrice(t,r));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"breakDown",value:(r=Q(regeneratorRuntime.mark((function e(t,n,r,o){var i,a,u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={totals:{base:0},models:[],catalogue:r.catalogue},e.next=3,this.calculate(i,r,t,o);case 3:return a=e.sent,u={pricingFields:this.mPricingFields},c=Object.assign(a,u),e.abrupt("return",{script_engine:c});case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,n,o){return r.apply(this,arguments)})},{key:"getBreakDownName",value:function(){return"script_engine"}}],n&&K(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Z(e){return Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Z(e)}function X(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function J(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function $(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){J(i,r,o,a,u,"next",e)}function u(e){J(i,r,o,a,u,"throw",e)}a(void 0)}))}}function ee(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function te(e,t){return te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},te(e,t)}function ne(e,t){if(t&&("object"===Z(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function re(e){return re=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},re(e)}var oe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&te(e,t)}(E,e);var t,n,u,c,l,m,w,_,O,T,R=(O=E,T=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=re(O);if(T){var n=re(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return ne(this,e)});function E(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,E),(e=R.call(this,"priceManager")).mSubscriptions=new Array,e.mPriceDataLoader=null,e.mCustomPriceCalculators=[],e.mConfigurableNode=null,e.mPricingSettings=null,e.mPriceMatrix=null,e.mCatalogue=null,e.mCatalogueMeta=null,e}return t=E,n=[{key:"isAttachable",value:function(e){return e.isDerivedOfTypeName("ProductNode")}},{key:"OnAttached",value:function(){}},{key:"OnDetached",value:function(){this.mSubscriptions.splice(0).forEach((function(e){return e.unsubscribe()})),null!==this.mPriceDataLoader&&this.mPriceDataLoader.error("Detached"),this.mPriceDataLoader=null}},{key:"_depResolveConfigurableNode",value:function(){var e,t=this;return this.getParentObject().onConfigurableNodeReady.pipe((7e3,void 0===e&&(e=i.P),function(e,t,n){return void 0===n&&(n=i.P),function(r){var o,i=(o=e)instanceof Date&&!isNaN(+o),a=i?+e-n.now():Math.abs(e);return r.lift(new s(a,i,t,n))}}(7e3,(0,f._)(new a),e)),(0,p.q)(1),(0,d.b)((function(e){return t.mConfigurableNode=e})))}},{key:"_depResolveCatalogueSettings",value:function(){var e=this;return this.getParentObject().getComponent("catalogueMeta").resolveSettings().pipe((0,d.b)((function(t){e.mCatalogueMeta=t.getCatalogueMeta()})))}},{key:"_depLoadCatalogueClasses",value:(_=$(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=t.getParentObject(),o=parseInt(r.getValue("product_id"),10);V.Q.getInstance().resolveBootstrapData(o).pipe((0,p.q)(1)).subscribe((function(n){v.qL.print("bootstrap got catalogue classes");var r=n.getCatalogueClasses(),o=h.FG.getItems(r);t.mModifierClasses=(0,b.isArray)(o)?o:[],e(t.mModifierClasses)}),(function(e){n(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(){return _.apply(this,arguments)})},{key:"_depLoadPricingSettings",value:(w=$(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=t.getParentObject(),o=parseInt(r.getValue("product_id"),10);V.Q.getInstance().resolveBootstrapData(o).pipe((0,p.q)(1)).subscribe((function(n){t.mPricingSettings=n.getPricingSettings(),e(t.mPricingSettings)}),(function(e){n(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(){return w.apply(this,arguments)})},{key:"_depLoadPricingMatrix",value:(m=$(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=t.getParentObject(),o=parseInt(r.getValue("product_id"),10);V.Q.getInstance().resolveBootstrapData(o).pipe((0,p.q)(1)).subscribe((function(n){var r=n.getPricingGroups(),o=h.FG.getItemsWithRelations(r);t.mPriceMatrix=o,e(t.mPriceMatrix)}),(function(e){n(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(){return m.apply(this,arguments)})},{key:"_depLoadCatalogue",value:(l=$(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=t.getParentObject(),o=parseInt(r.getValue("product_id"),10);V.Q.getInstance().resolveBootstrapData(o).pipe((0,p.q)(1)).subscribe((function(n){var r=n.getCatalogue();t.mCatalogue=r,e(t.mCatalogue)}),(function(e){n(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(){return l.apply(this,arguments)})},{key:"_resolvePricingData",value:function(){var e=this;return null===this.mPriceDataLoader&&(this.mPriceDataLoader=new r.t,(0,o.D)(this._depResolveConfigurableNode(),this._depLoadCatalogue(),this._depLoadCatalogueClasses(),this._depLoadPricingSettings(),this._depResolveCatalogueSettings(),this._depLoadPricingMatrix()).pipe((0,p.q)(1)).subscribe((function(){v.qL.print("pricing data finished dependencies"),null!==e.mPriceDataLoader&&e.mPriceDataLoader.next({settings:e.mPricingSettings,catalogue:e.mCatalogue,price_matrix:e.mPriceMatrix,modifier_classes:e.mModifierClasses})}),(function(t){v.qL.error("Resolving pricing data failed: ",t),null!==e.mPriceDataLoader&&(e.mPriceDataLoader.error("Failed resolve pricing data"),e.mPriceDataLoader=null)}))),this.mPriceDataLoader}},{key:"registerPriceCalculator",value:function(e){this.mCustomPriceCalculators.push(e)}},{key:"getApplicableCalculators",value:function(e){var t,n=e.price_calculators,r=[];return(n.attribute_pricing||n.pricing_matrix)&&r.push(new y.BasePriceCalculation),n.attribute_pricing&&r.push(new y.OptionPriceCalculation,new S),n.pricing_matrix&&r.push(new k),n.external_api&&r.push(new N),n.script_engine&&r.push(new Y),r.push.apply(r,function(e){if(Array.isArray(e))return X(e)}(t=this.mCustomPriceCalculators)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return X(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?X(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),r}},{key:"requestPrice",value:(c=$(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){t._resolvePricingData().subscribe((function(r){var o=t.getApplicableCalculators(r.settings);t.requestCompoundPrice(o,(function(t){t.totals=t.totals||{},t.totals.base=t.totals.base||0,Object.keys(t.totals).forEach((function(e){g.F.isNumeric(t.totals[e])&&(t.totals[e]=parseFloat(parseFloat(t.totals[e]).toFixed(2)))})),e(t)}),(function(e){n(e)}),{totals:{base:0},models:[],catalogue:r.catalogue},r,t.getParentObject(),t.mConfigurableNode)}),(function(e){return n(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(){return c.apply(this,arguments)})},{key:"requestCompoundPrice",value:function(e,t,n,r,o,i,a){var u=this;if(0!==e.length){var c=e.shift();Promise.resolve(c.calculate(r,o,i,a)).then((function(r){u.requestCompoundPrice(e,t,n,r,o,i,a)}),(function(e){n(e)}))}else t(r)}},{key:"requestPriceBreakDown",value:(u=$(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){t._resolvePricingData().subscribe((function(n){var r=t.getApplicableCalculators(n.settings);e({calculators:r,pricingData:n,parentObject:t.getParentObject(),configurableNode:t.mConfigurableNode})}),(function(e){return n(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(){return u.apply(this,arguments)})}],n&&ee(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),E}(m.H)},93663:function(e,t,n){"use strict";n.d(t,{I:function(){return d}}),n(41539),n(88674),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(18743),o=n(83348),i=n(22875),a=n(57877),u=n(41142);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},l(e,t)}function f(e,t){if(t&&("object"===c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(h,e);var t,n,r,c,d=(r=h,c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=p(r);if(c){var n=p(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return f(this,e)});function h(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),(e=d.call(this,"processManager")).mResolvePromise=null,e.mLoaded=!1,e.handleDeinitRenderObject=function(t){u.qL.print("process manager component deinit:",e.mProcessManager.getProductNode().getValue("name")),null!==e.mProcessManager&&e.mProcessManager.unload(),e.mLoaded=!1},e}return t=h,(n=[{key:"resolveManager",value:function(){var e=this;if(this.mLoaded)return new Promise((function(t){return t(e.mProcessManager)}));if(u.qL.print("process manager init:",this.mProcessManager.getProductNode().getValue("name")),null!==this.mResolvePromise)return this.mResolvePromise;u.qL.print("process manager load");var t=null,n=null,r=new Promise((function(e,r){t=e,n=r}));return this.mResolvePromise=r,this.mProcessManager.load().then((function(){e.mResolvePromise=null,e.mLoaded=!0,t(e.mProcessManager)}),(function(t){e.mResolvePromise=null,n(t)})),r}},{key:"OnAttached",value:function(){this.mProcessManager=new i.ProcessManager(this.getParentObject()),this.registerMessageHandler(a.y.TypeRTTI,this.handleDeinitRenderObject)}},{key:"OnDetached",value:function(){this.mProcessManager.unload(),this.mProcessManager=null,this.unregisterMessageHandler(a.y.TypeRTTI)}},{key:"isAttachable",value:function(e){return e.isDerivedTypeOf(o.L.TypeRTTI)}}])&&s(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),h}(r.H)},24671:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t){return i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},i(e,t)}function a(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}n.d(t,{T:function(){return c}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var c=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(l,e);var t,n,r,c,s=(r=l,c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=u(r);if(c){var n=u(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return a(this,e)});function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=s.call(this)).mConfigurableNode=e,t}return t=l,(n=[{key:"transformObject",value:function(e){return this.mConfigurableNode}}])&&o(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(n(20490).J)},23937:function(e,t,n){"use strict";n.d(t,{Q:function(){return f}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(20490),o=n(11304),i=n(14311);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function s(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(p,e);var t,n,r,a,f=(r=p,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=l(r);if(a){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return s(this,e)});function p(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),(t=f.call(this)).mAttribute=e,t}return t=p,(n=[{key:"transformObject",value:function(e){return e}},{key:"setPosition",value:function(e,t,n,r){e.execute(new o.X(t.userData.sceneObjectRef,this.mAttribute,n)),e.dispatchEvent(i.G.ObjectChanged,{name:"position",object:t}),setTimeout((function(){return e.dispatchEvent(i.G.RequestFrame)}),300)}},{key:"setRotation",value:function(e,t,n,r){}},{key:"setScale",value:function(e,t,n,r){}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),p}(r.J)},20490:function(e,t,n){"use strict";n.d(t,{J:function(){return u}}),n(69070),n(21703);var r=n(97841),o=n(50728),i=n(59835);function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,(n=[{key:"transformObject",value:function(e){return e}},{key:"setPosition",value:function(e,t,n,o){e.execute(new r.N(t,n,o))}},{key:"setRotation",value:function(e,t,n,r){e.execute(new o.a(t,n,r))}},{key:"setScale",value:function(e,t,n,r){e.execute(new i.U(t,n,r))}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},41805:function(e,t,n){"use strict";n.d(t,{l:function(){return f}}),n(35666),n(68309),n(19601),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(88674),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(90140),o=n(4530);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function s(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(d,e);var t,n,r,o,i,f,p=(i=d,f=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=l(i);if(f){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return s(this,e)});function d(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(n=p.call(this)).middleware=null,n.mAttributeData=e,n.mAttributeManagerComp=t,Array.isArray(n.mAttributeData.attribute_values)||(n.mAttributeData.attribute_values=[]),n}return t=d,n=[{key:"getType",value:function(){return d.TypeRTTI}},{key:"destroy",value:function(){}},{key:"getAttributeType",value:function(){return this.mAttributeData.type}},{key:"resolveProductNode",value:function(){return this.mAttributeManagerComp.getParentObject()}},{key:"broadcastValueChange",value:function(e,t,n,r){var o=this.mAttributeManagerComp,i=this.resolveProductNode(),a=i.getValue("product_id"),u=i.getSceneObjectId(),c=i.getValue("object_uuid"),s=this.getAttribute();o.onAttributeChanged.next({attribute_type:this.getAttributeType(),attribute_id:s.id,attribute_name:s.name,attribute_value_id:e,attribute_value:t,attribute_value_name:this.getValueName(),attribute_slug:s.slug,rebuild:n,product_id:a,product_scene_id:u,product_uuid:c,user_data:r})}},{key:"broadcastAttributeUpdated",value:function(){this.mAttributeManagerComp.onAttributeUpdated.next({attribute:this.getAttribute(),attribute_id:this.mAttributeData.id,attribute_type:this.getAttributeType()})}},{key:"broadcastAttributeModerated",value:function(){var e=this.mAttributeManagerComp,t=this.resolveProductNode(),n=t.getValue("product_id"),r=t.getSceneObjectId(),o=t.getValue("object_uuid");e.onAttributeModerated.next({attribute:this.getAttribute(),attribute_id:this.mAttributeData.id,attribute_type:this.getAttributeType(),product_id:n,product_scene_id:r,product_uuid:o})}},{key:"_getDefaultSetOptions",value:function(e){return Object.assign({emitEvent:!0,rebuild:!0},e||{})}},{key:"visibleOnFrame",get:function(){return!1!==this.mAttributeData.visible_on_frame}},{key:"setVisibility",value:function(e,t){this.mAttributeData.visible=!!this.visibleOnFrame&&e}},{key:"isVisible",value:function(e){return!!this.visibleOnFrame&&("boolean"==typeof this.mAttributeData.visible?this.mAttributeData.visible:0!==this.mAttributeData.visibility&&!1!==this.mAttributeData.visibility)}},{key:"isVisibleInQuote",value:function(){return!!this.visibleOnFrame&&2!==this.mAttributeData.visibility}},{key:"serialize",value:function(e){if(!(!0!==e.discard_hidden||this.isVisible()&&this.isVisibleInQuote()))return null;var t=this.getAttribute(),n={attribute_id:t.id,attribute_name:t.name,attribute_value:this.getValue(),attribute_value_name:this.getValueName()};return e.include_keys&&(n.attribute_value_key=this.getValueKey(),n.attribute_key=t.key),n}},{key:"compareValue",value:function(e){return e===this.getValueName()}},{key:"registerMiddleware",value:function(e){this.middleware?this.middleware.setNext(e):this.middleware=e}},{key:"setNextValue",value:(r=regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.middleware){e.next=4;break}return e.next=3,this.middleware.execute(t);case 3:t=e.sent;case 4:return e.abrupt("return",this.setValue(t,n));case 5:case"end":return e.stop()}}),e,this)})),o=function(){var e=this,t=arguments;return new Promise((function(n,o){var i=r.apply(e,t);function u(e){a(i,n,o,u,c,"next",e)}function c(e){a(i,n,o,u,c,"throw",e)}u(void 0)}))},function(e,t){return o.apply(this,arguments)})},{key:"getValueKey",value:function(){}},{key:"onMaterialUpdated",value:function(e){}}],n&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),d}(o.e3);f.TypeRTTI=new r.r("AttributeController",o.e3.TypeRTTI)},97962:function(e,t,n){"use strict";n.d(t,{v:function(){return g}}),n(35666),n(41539),n(88674),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(41805),o=n(4530),i=n(70456),a=n(37175),u=n(89539),c=n(84217),s=n(87181),l=n(10288);function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function p(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(){return h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=y(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},h.apply(this,arguments)}function y(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=b(e)););return e}function m(e,t){return m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},m(e,t)}function v(e,t){if(t&&("object"===f(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function b(e){return b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},b(e)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(w,e);var t,n,r,o,f,y,g=(f=w,y=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=b(f);if(y){var n=b(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return v(this,e)});function w(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,w),g.call(this,e,t)}return t=w,n=[{key:"getType",value:function(){return w.TypeRTTI}},{key:"resolveSvgTextureController",value:(r=regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){(0,u.isNullOrUndefined)(n.mTextureResolver)||n.mTextureMediaId===t||n.disposeSvgTexture(),n.mTextureMediaId=t,(0,u.isNullOrUndefined)(n.mTextureResolver)&&(n.mTextureResolver=new i.t(1),n.resolveProductNode().getRenderState().getResourceManager().getManager(s.ResourceManagerTypes.TextureManager).then((function(e){e.resolveResourceById(n.mTextureMediaId,(0,l.tq)()?1:0).then((function(e){var t=e.getController();if(t.isTypeOf(a.C.TypeRTTI)){var r=t;n.mTextureResolver.next(r)}else n.mTextureResolver.next(null),n.mTextureResolver.error("Controller is not svg")}),(function(e){n.mTextureResolver.next(null),n.mTextureResolver.error(e)}))}),(function(e){n.mTextureResolver.next(null),n.mTextureResolver.error(e)}))),n.mTextureResolver.pipe((0,c.q)(1)).subscribe((function(t){(0,u.isNullOrUndefined)(t)||t.onTextureReady().pipe((0,c.q)(1)).subscribe((function(){e(t)}),(function(e){r(e)}))}),(function(e){r(e)}))})));case 1:case"end":return e.stop()}}),e)})),o=function(){var e=this,t=arguments;return new Promise((function(n,o){var i=r.apply(e,t);function a(e){p(i,n,o,a,u,"next",e)}function u(e){p(i,n,o,a,u,"throw",e)}a(void 0)}))},function(e){return o.apply(this,arguments)})},{key:"disposeSvgTexture",value:function(){var e=this;(0,u.isNullOrUndefined)(this.mTextureResolver)||(this.mTextureResolver.pipe((0,c.q)(1)).subscribe((function(t){(0,u.isNullOrUndefined)(t)||e.resolveProductNode().getRenderState().getResourceManager().getManager(s.ResourceManagerTypes.TextureManager).then((function(e){e.disposeByKey(t.getTextureKey())}),(function(){}))}),(function(){})),delete this.mTextureResolver)}},{key:"broadcastAttributeUpdated",value:function(){this.setValue(this.getValue(),{emitEvent:!1,rebuild:!0}),h(b(w.prototype),"broadcastAttributeUpdated",this).call(this)}},{key:"destroy",value:function(){h(b(w.prototype),"destroy",this).call(this),this.disposeSvgTexture()}},{key:"onMaterialUpdated",value:function(e){}}],n&&d(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),w}(r.l);g.TypeRTTI=new o.rz("AttributeSvgController",r.l.TypeRTTI)},37072:function(e,t,n){"use strict";var r=n(32305);n.o(r,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return r.AddObjectCommand}}),n.o(r,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return r.AppViewerComponent}}),n.o(r,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return r.SetPositionCommand}}),n.o(r,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return r.SetRotationCommand}}),n(278),n(85762),n(83512)},278:function(e,t,n){"use strict";n.d(t,{V:function(){return a}}),n(74916),n(77601),n(69070),n(21703);var r=n(89539),o=n(55830);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,(n=[{key:"loadMesh",value:function(t,n,i,a,u,c,s,l,f,p){null===e.dracoConfig&&(e.dracoConfig={},(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4)))&&(e.dracoConfig.type="js"),THREE.DRACOLoader.setDecoderConfig(e.dracoConfig),THREE.DRACOLoader.setDecoderPath(o.E4.assetsUrl+"vendors/draco/")),e.dracoLoader.load(t,(function(e){if(n.isInSyncWithHash(f.getHash()))try{var t=(0,r.isNullOrUndefined)(i)?new THREE.MeshBasicMaterial:i,o=new THREE.Mesh(e,t);o.receiveShadow=t.opacity>.5,o.castShadow=t.opacity>.99,s(o)}catch(e){l(e)}else l("out of sync")}),(function(e){(0,r.isFunction)(p)&&p(e.loaded/e.total)}),(function(e){l(e)}))}}])&&i(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();a.dracoLoader=new THREE.DRACOLoader,a.dracoConfig=null},85762:function(e,t,n){"use strict";n.d(t,{u:function(){return i}}),n(66992),n(41539),n(29135),n(48675),n(92990),n(18927),n(33105),n(35035),n(74345),n(7174),n(32846),n(44731),n(77209),n(96319),n(58867),n(37789),n(33739),n(29368),n(14483),n(12056),n(3462),n(30678),n(27462),n(33824),n(55021),n(12974),n(15016),n(8922),n(37380),n(1118),n(5835),n(23767),n(8585),n(8970),n(84444),n(68696),n(44197),n(69070),n(21703);var r=n(89539);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,(n=[{key:"loadMesh",value:function(e,t,n,o,i,a,u,c,s,l){a.load(e,(function(e){if(t.isInSyncWithHash(s.getHash()))try{var o=e,i=new Uint32Array(o,0,8),a=(i[0],i[1]),l=i[2],f=i[3],p=i[4],d=i[5],h=i[6],y=i[7],m=new Float32Array(o,p,a),v=new Float32Array(o,d,a),b=new Float32Array(o,h,a/3*2),g=null;f>1&&(g=new Float32Array(o,h+a/3*2*4,a/3*2));var w=new Uint32Array(o,y,l),_=new THREE.BufferGeometry;_.setIndex(new THREE.BufferAttribute(w,1)),_.addAttribute("position",new THREE.BufferAttribute(m,3)),_.addAttribute("normal",new THREE.BufferAttribute(v,3)),_.addAttribute("uv",new THREE.BufferAttribute(b,2)),null!==g&&_.addAttribute("uv2",new THREE.BufferAttribute(g,2));var O=(0,r.isNullOrUndefined)(n)?new THREE.MeshBasicMaterial:n,T=new THREE.Mesh(_,O);T.receiveShadow=O.opacity>.5,T.castShadow=O.opacity>.99,u(T)}catch(e){c(e)}else c("out of sync")}),(function(e){(0,r.isFunction)(l)&&l(e.loaded/e.total)}),(function(e){c(e)}))}}])&&o(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},32305:function(){},83512:function(e,t,n){"use strict";n.d(t,{j:function(){return a}}),n(74916),n(4723),n(69070),n(21703);var r=n(85762),o=n(278);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mRegexMeshExtension=/.*\.(drc|ebm)$/i,this.mMeshLoaders={ebm:new r.u,drc:new o.V}}var t,n;return t=e,(n=[{key:"_getMeshExtension",value:function(e){var t=e.match(this.mRegexMeshExtension);return t.length>1?t[1]:null}},{key:"loadMesh",value:function(e,t,n,r,o,i,a,u,c,s){var l=this._getMeshExtension(e);null!==l?this.mMeshLoaders[l].loadMesh(e,t,n,r,o,i,a,u,c,s):u("mesh type not recognized")}}])&&i(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},19790:function(e,t,n){"use strict";var r;n.d(t,{D:function(){return r}}),function(e){e.UNBLOCK_DEFAULT_TOUCH="UNBLOCK_DEFAULT_TOUCH",e.SCENE_EDITOR="SCENE_EDITOR"}(r||(r={}))},45689:function(e,t,n){"use strict";var r;n.d(t,{_:function(){return r}}),function(e){e.ACTIVE_CAMERA="ACTIVE_CAMERA",e.FIRST_POSITION="FIRST_POSITION",e.FIT_OBJECT_FRONT="FIT_OBJECT_FRONT",e.FIT_OBJECT_BACK="FIT_OBJECT_BACK",e.FIT_OBJECT_LEFT="FIT_OBJECT_LEFT",e.FIT_OBJECT_RIGHT="FIT_OBJECT_RIGHT",e.FIT_OBJECT_TOP="FIT_OBJECT_TOP",e.FIT_OBJECT_BOTTOM="FIT_OBJECT_BOTTOM",e.CUSTOM_CAMERA_POSITION="CUSTOM_CAMERA_POSITION"}(r||(r={}))},51390:function(e,t,n){"use strict";var r;n.d(t,{S:function(){return r}}),function(e){e.Android="android",e.iOS="ios",e.WindowsPhone="windowsphone",e.MacOS="macos",e.Windows="windows",e.Linux="linux",e.Unknown="unknown"}(r||(r={}))},23089:function(e,t,n){"use strict";var r;n.d(t,{z:function(){return r}}),function(e){e[e.RayPickedSceneObject=0]="RayPickedSceneObject",e[e.RayHoverSceneObject=1]="RayHoverSceneObject",e[e.MaxTypeValue=2]="MaxTypeValue"}(r||(r={}))},14311:function(e,t,n){"use strict";var r;n.d(t,{G:function(){return r}}),function(e){e[e.Initialized=0]="Initialized",e[e.BuildStarted=1]="BuildStarted",e[e.BuildFinished=2]="BuildFinished",e[e.BuildUpdated=3]="BuildUpdated",e[e.BuildFailed=4]="BuildFailed",e[e.BuildFullyLoaded=5]="BuildFullyLoaded",e[e.ViewUpdated=6]="ViewUpdated",e[e.WindowResized=7]="WindowResized",e[e.TransformModeChanged=8]="TransformModeChanged",e[e.TransformTargetMode=9]="TransformTargetMode",e[e.HistoryChanged=10]="HistoryChanged",e[e.SceneGraphAdded=11]="SceneGraphAdded",e[e.SceneGraphRemoved=12]="SceneGraphRemoved",e[e.SceneGraphChanged=13]="SceneGraphChanged",e[e.NodeAdded=14]="NodeAdded",e[e.NodeRemoved=15]="NodeRemoved",e[e.NodeChanged=16]="NodeChanged",e[e.HelperAdded=17]="HelperAdded",e[e.HelperRemoved=18]="HelperRemoved",e[e.ObjectFocused=19]="ObjectFocused",e[e.ObjectSelected=20]="ObjectSelected",e[e.ObjectChanged=21]="ObjectChanged",e[e.ObjectTransformed=22]="ObjectTransformed",e[e.ObjectTargetChanged=23]="ObjectTargetChanged",e[e.ModelAttributeChanged=24]="ModelAttributeChanged",e[e.TransformControlChanged=25]="TransformControlChanged",e[e.TransformControlLock=26]="TransformControlLock",e[e.TransformControlUnLock=27]="TransformControlUnLock",e[e.ZoomChanged=28]="ZoomChanged",e[e.BatchProgress=29]="BatchProgress",e[e.RequestFrame=30]="RequestFrame",e[e.OffsetChanged=31]="OffsetChanged",e[e.MeshChanged=32]="MeshChanged",e[e.ProductOptionChanged=33]="ProductOptionChanged",e[e.ProductQuestionChanged=34]="ProductQuestionChanged",e[e.ProductMaterialChanged=35]="ProductMaterialChanged",e[e.SceneObjectAttached=36]="SceneObjectAttached",e[e.SceneObjectDetached=37]="SceneObjectDetached",e[e.PlaySound=38]="PlaySound",e[e.ProductAttributeUpdated=39]="ProductAttributeUpdated",e[e.ProductArticlesChanged=40]="ProductArticlesChanged",e[e.QrWebAr=41]="QrWebAr",e[e.Warning=42]="Warning",e[e.EnterVR=43]="EnterVR",e[e.ExitVR=44]="ExitVR",e[e.ToolbarVisible=45]="ToolbarVisible",e[e.ToolbarHidden=46]="ToolbarHidden",e[e.Shared=47]="Shared",e[e.ProductAttributeModerated=48]="ProductAttributeModerated",e[e.MaxTypeValue=49]="MaxTypeValue"}(r||(r={}))},95855:function(e,t,n){"use strict";n.d(t,{AddObjectCommand:function(){return d.Ys},SetPositionCommand:function(){return d.Ng},SetRotationCommand:function(){return d.aV}});var r=n(57142);n.o(r,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return r.AddObjectCommand}}),n.o(r,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return r.AppViewerComponent}}),n.o(r,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return r.SetPositionCommand}}),n.o(r,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return r.SetRotationCommand}});var o=n(8942);n.o(o,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return o.AddObjectCommand}}),n.o(o,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return o.AppViewerComponent}}),n.o(o,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return o.SetPositionCommand}}),n.o(o,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return o.SetRotationCommand}});var i=n(77226);n.o(i,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return i.AddObjectCommand}}),n.o(i,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return i.AppViewerComponent}}),n.o(i,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return i.SetPositionCommand}}),n.o(i,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return i.SetRotationCommand}}),n(4530),n(79816);var a=n(49029);n.o(a,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return a.AddObjectCommand}}),n.o(a,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return a.AppViewerComponent}}),n.o(a,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return a.SetPositionCommand}}),n.o(a,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return a.SetRotationCommand}}),n(55830);var u=n(40382);n.o(u,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return u.AddObjectCommand}}),n.o(u,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return u.AppViewerComponent}}),n.o(u,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return u.SetPositionCommand}}),n.o(u,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return u.SetRotationCommand}});var c=n(37072);n.o(c,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return c.AddObjectCommand}}),n.o(c,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return c.AppViewerComponent}}),n.o(c,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return c.SetPositionCommand}}),n.o(c,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return c.SetRotationCommand}}),n(42347);var s=n(87181);n.o(s,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return s.AddObjectCommand}}),n.o(s,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return s.AppViewerComponent}}),n.o(s,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return s.SetPositionCommand}}),n.o(s,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return s.SetRotationCommand}});var l=n(2468);n.o(l,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return l.AddObjectCommand}}),n.o(l,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return l.AppViewerComponent}}),n.o(l,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return l.SetPositionCommand}}),n.o(l,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return l.SetRotationCommand}});var f=n(85765);n.o(f,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return f.AddObjectCommand}}),n.o(f,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return f.AppViewerComponent}}),n.o(f,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return f.SetPositionCommand}}),n.o(f,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return f.SetRotationCommand}}),n(86904);var p=n(42139);n.o(p,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return p.AddObjectCommand}}),n.o(p,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return p.AppViewerComponent}}),n.o(p,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return p.SetPositionCommand}}),n.o(p,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return p.SetRotationCommand}}),n(73995),n(33314),n(27679),n(66092),n(96169);var d=n(91305)},96080:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.d(t,{X:function(){return o}}),n(69070),n(21703);var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._cid=++e._cidCounter}var t,n;return t=e,(n=[{key:"equals",value:function(e){return null!=e&&this._cid===e._cid}},{key:"cid",get:function(){return this._cid}}])&&r(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();o._cidCounter=0},27679:function(e,t,n){"use strict";n(96080),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948)},91942:function(){},1722:function(){},40382:function(e,t,n){"use strict";var r=n(1722);n.o(r,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return r.AddObjectCommand}}),n.o(r,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return r.AppViewerComponent}}),n.o(r,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return r.SetPositionCommand}}),n.o(r,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return r.SetRotationCommand}});var o=n(91942);n.o(o,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return o.AddObjectCommand}}),n.o(o,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return o.AppViewerComponent}}),n.o(o,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return o.SetPositionCommand}}),n.o(o,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return o.SetRotationCommand}})},42347:function(e,t,n){"use strict";n(14433),n(9418),n(27263),n(74419),n(45437),n(20051),n(60603),n(71303),n(45044)},14433:function(e,t,n){"use strict";n.d(t,{i:function(){return d}}),n(41539),n(88674),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(78456),o=n(37852),i=n(90140),a=n(89539),u=n(41142);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},l(e,t)}function f(e,t){if(t&&("object"===c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(c,e);var t,n,r,o,i=(r=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=p(r);if(o){var n=p(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return f(this,e)});function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=i.call(this,"CanvasText")).mText=e,t}return t=c,(n=[{key:"getType",value:function(){return c.TypeRTTI}},{key:"onAttached",value:function(){var e=this.getParent();(0,a.isFunction)(e._setCanvasText)||u.qL.error("Attached ProcessCreateCanvasText to none entity text node parent.")}},{key:"onExecute",value:function(){var e=this;return new Promise((function(t){if(e.isCancelled())t(!1);else{var n=document.createElement("canvas");n.width=256,n.height=128;var r=n.getContext("2d");r.font="16px Arial",r.fillStyle="rgba(255,255,255,0.95)",r.fillText(e.mText,5,25),e.getParent()._setCanvasText(r),t(!0)}}))}}])&&s(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(r.o);d.TypeRTTI=new i.r("JobCreateCanvasText",o.e.TypeRTTI)},9418:function(e,t,n){"use strict";n.d(t,{q:function(){return d}}),n(41539),n(88674),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(78456),o=n(37852),i=n(90140),a=n(89539),u=n(80115);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},l(e,t)}function f(e,t){if(t&&("object"===c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(c,e);var t,n,r,o,i=(r=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=p(r);if(o){var n=p(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return f(this,e)});function c(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),i.call(this,"ProcessLoadModelManager")}return t=c,(n=[{key:"getType",value:function(){return c.TypeRTTI}},{key:"onAttached",value:function(){var e=this.getParent();(0,a.isFunction)(e._onModelManagerLoaded)||console.error("Attached ProcessLoadModelManager to node with no _onModelManagerLoaded function.")}},{key:"onExecute",value:function(){var e=this;return new Promise((function(t,n){if(e.isCancelled())t(!1);else{var r=e.getParent();r.getRenderState().getResourceManager().getManager(u.O.ModelManager).then((function(e){r._onModelManagerLoaded(e),t(!0)}),(function(e){n(e)}))}}))}}])&&s(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(r.o);d.TypeRTTI=new i.r("JobLoadModelManager",o.e.TypeRTTI)},74419:function(e,t,n){"use strict";n.d(t,{e:function(){return h}}),n(41539),n(88674),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(78456),o=n(37852),i=n(90140),a=n(89539),u=n(41142),c=n(48155);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t){return f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},f(e,t)}function p(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(s,e);var t,n,r,o,i=(r=s,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=d(r);if(o){var n=d(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return p(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=i.call(this,"ProcessUpdateCubeMap")).mTextureId=e,t}return t=s,(n=[{key:"getType",value:function(){return s.TypeRTTI}},{key:"onAttached",value:function(){var e=this.getParent();(0,a.isFunction)(e._textureModelReady)||u.qL.error("Attached ProcessLoadTextureModel to node with no _textureModelReady functions.")}},{key:"onExecute",value:function(){var e=this;return new Promise((function(t,n){e.isCancelled()?t(!1):c.y.getInstance().resolveModel(e.mTextureId).then((function(n){e.isCancelled()||(0,a.isNullOrUndefined)(n)?t(!1):(e.getParent()._textureModelReady(e.mTextureId,n),t(!0))}),(function(e){n(e)}))}))}}])&&l(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),s}(r.o);h.TypeRTTI=new i.r("JobLoadTextureModel",o.e.TypeRTTI)},27263:function(e,t,n){"use strict";n.d(t,{y:function(){return h}}),n(35666),n(41539),n(88674),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(78456),o=n(37852),i=n(90140),a=n(89539),u=n(41142);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function s(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t){return f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},f(e,t)}function p(e,t){if(t&&("object"===c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(y,e);var t,n,r,o,i,c,h=(i=y,c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=d(i);if(c){var n=d(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return p(this,e)});function y(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,y),(t=h.call(this,"ProcessLoadTexture")).mTexturePath=e,t}return t=y,n=[{key:"getType",value:function(){return y.TypeRTTI}},{key:"onAttached",value:function(){var e=this.getParent();(0,a.isFunction)(e._onTextureLoaded)||u.qL.error("Attached ProcessLoadTexture to node with no _onTextureLoaded function.")}},{key:"onExecute",value:(r=regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){t.isCancelled()?e(!1):(new THREE.TextureLoader).load(t.mTexturePath,(function(n){t.getParent()._onTextureLoaded(t.mTexturePath,n),e(!0)}),(function(e){}),(function(e){u.qL.error("Failed to load water normal texture: ",e),n(e)}))})));case 1:case"end":return e.stop()}}),e)})),o=function(){var e=this,t=arguments;return new Promise((function(n,o){var i=r.apply(e,t);function a(e){s(i,n,o,a,u,"next",e)}function u(e){s(i,n,o,a,u,"throw",e)}a(void 0)}))},function(){return o.apply(this,arguments)})}],n&&l(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),y}(r.o);h.TypeRTTI=new i.r("JobLoadTexture",o.e.TypeRTTI)},45044:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}}),n(41539),n(88674),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(78456),o=n(37852),i=n(90140),a=n(41142),u=n(83348);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},l(e,t)}function f(e,t){if(t&&("object"===c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(c,e);var t,n,r,o,i=(r=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=p(r);if(o){var n=p(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return f(this,e)});function c(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),i.call(this,"CameraEntity")}return t=c,(n=[{key:"getType",value:function(){return c.TypeRTTI}},{key:"onAttached",value:function(){this.getParent().isDerivedOfTypeName("CameraEntity")||a.qL.print("Attached product node process to none CameraEntity parent.")}},{key:"onExecute",value:function(){var e=this;return new Promise((function(t,n){var r=e.getParent(),o=r.findParentOfType(u.L.TypeRTTI);null!==o&&r.getRenderState().getSceneManager().getApplication().getPipelineManager().preload(o.getValue("product_id")),t(!0)}))}}])&&s(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(r.o);d.TypeRTTI=new i.r("JobUpdateCamera",o.e.TypeRTTI)},45437:function(e,t,n){"use strict";n.d(t,{h:function(){return v}}),n(41539),n(88674),n(69826),n(31672),n(2490),n(59461),n(68309),n(21249),n(57640),n(9924),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(78456),o=n(37852),i=n(90140),a=n(80115),u=n(99556),c=n(41142),s=n(89539),l=n(55830),f=n(82434);function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t){return h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},h(e,t)}function y(e,t){if(t&&("object"===p(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(p,e);var t,n,r,o,i=(r=p,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=m(r);if(o){var n=m(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return y(this,e)});function p(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),i.call(this,"ProcessUpdateConfigurable")}return t=p,(n=[{key:"getType",value:function(){return p.TypeRTTI}},{key:"onAttached",value:function(){this.getParent().isDerivedOfTypeName("ConfigurableNode")||c.qL.error("Attached product node process to none configurable node parent.")}},{key:"_reconfigureBuild",value:function(e,t){c.qL.print("job: reconfigure options"),e._isFirstBuild()&&null!==e._getPreconfiguredOptions()?(e._setFirstBuild(!1),(new f.q).load(e.findParentOfTypeName("ProductNode"),e._getPreconfiguredOptions(),(function(e){})).then((function(){(0,s.isNullOrUndefined)(t)||t()}),(function(e){(0,s.isNullOrUndefined)(t)||t()}))):(0,s.isNullOrUndefined)(t)||t()}},{key:"onExecute",value:function(){var e=this;return new Promise((function(t,n){var r=e.getParent();u.S.completePromise(r.resolveSceneOffsetManager()).then((function(){e.isCancelled()?t(!1):r.getRenderState().getResourceManager().getManager(a.O.MaterialManager).then((function(n){if(e.isCancelled())t(!1);else{r._updateWithMaterialManager(n);var o=r.findParentOfTypeName("ProductNode"),i=o.findParentOfTypeName("ProductNode");if((0,s.isNullOrUndefined)(i))r.loadBatches(e,(function(n){e._reconfigureBuild(r,(function(){t(n)}))}));else{c.qL.print("silently load subproduct node:",o.getRenderObject());var a=o.getRenderObject(),u=null;if(!(0,s.isNullOrUndefined)(a)&&a.isDerivedOfTypeName("ThreedObject")&&r._isFirstBuild()){var f=a.get3DObject().children.find((function(e){return"xpv__product_placeholder"===e.name}));if((0,s.isNullOrUndefined)(f)){c.qL.print("add placeholder",f);var p=o.getValue("place_holder");if((0,s.isNullOrUndefined)(p)){var d=(new THREE.TextureLoader).load(l.E4.assetsUrl+"system/placeholders/product-load.png"),h=new THREE.SpriteMaterial({map:d,color:16777215}),y=new THREE.Sprite(h);y.position.setY(1);var m=0;y.onAfterRender=function(e,t,n){m+=1,y.position.setY(1+.5*Math.cos(m/10)),setTimeout((function(){return o.getRenderState().requestFrame()}),32)},u=y}else try{c.qL.print("run place holder function"),u=p()}catch(e){c.qL.error("failed to run place holder function:",e)}(0,s.isNullOrUndefined)(u)||(u.name="xpv__product_placeholder",a.get3DObject().add(u)),setTimeout((function(){return o.getRenderState().requestFrame()}),32)}}r.loadBatches(e,(function(){(0,s.isNullOrUndefined)(u)||(u.parent.remove(u),u.material.map.dispose(),u=null),e._reconfigureBuild(r,(function(){setTimeout((function(){return o.getRenderState().requestFrame()}),32)}))})),t(!0)}}}),(function(e){n(e)}))}))}))}}])&&d(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),p}(r.o);v.TypeRTTI=new i.r("JobUpdateConfigurable",o.e.TypeRTTI)},20051:function(e,t,n){"use strict";n.d(t,{p:function(){return b}}),n(41539),n(15581),n(2490),n(34514),n(54747),n(88674),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948),n(35666);var r=n(78456),o=n(37852),i=n(90140),a=n(89539),u=n(80115),c=n(41142),s=n(48155);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function f(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function p(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){f(i,r,o,a,u,"next",e)}function u(e){f(i,r,o,a,u,"throw",e)}a(void 0)}))}}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t){return y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},y(e,t)}function m(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(b,e);var t,n,r,o,i,l,f=(i=b,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=v(i);if(l){var n=v(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return m(this,e)});function b(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6;return d(this,b),(e=f.call(this,"ProcessUpdateCubeMap")).mMaxSides=t,e}return t=b,n=[{key:"getType",value:function(){return b.TypeRTTI}},{key:"onAttached",value:function(){var e=this.getParent();(0,a.isFunction)(e._createTextureCube)&&(0,a.isFunction)(e.getTextureIds)&&(0,a.isFunction)(e.getActiveTextures)&&(0,a.isFunction)(e._setTextureCubeImage)&&(0,a.isFunction)(e._updateMaterial)||c.qL.error("Attached ProcessUpdateCubeMap to node with no cubemap functions.")}},{key:"getTexturePath",value:(o=p(regeneratorRuntime.mark((function e(t,n){var r,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.y.getInstance().resolveModel(t);case 2:r=e.sent,o=n>2?2:n<0?0:n;case 5:if(!(o>=0)){e.next=12;break}if(i=r["Lod".concat(o)],(0,a.isNullOrUndefined)(i)||!(i.length>0)){e.next=9;break}return e.abrupt("return",i);case 9:o--,e.next=5;break;case 12:return e.abrupt("return",r.source_url);case 13:case"end":return e.stop()}}),e)}))),function(e,t){return o.apply(this,arguments)})},{key:"updateTextures",value:function(e){for(var t=this,n=this.getParent(),r=n.getTextureIds(),o=n.getActiveTextures(),i=new Array,a=0;a<this.mMaxSides;a++)r[a]!==o[a]&&(null===r[a]&&null!==o[a]?(n.setActiveTextureId(a,null),n._setTextureCubeImage(a,null)):(n.setActiveTextureId(a,r[a]),i.push({index:a,id:r[a]})));var u=i.length;0===u?e():i.forEach((function(n){t.getTexturePath(n.id,0).then((function(r){t.setActiveTexture(n.index,r,(function(){0==--u&&e()}))}),(function(t){c.qL.warn("could not find media model for cubemap at index:",n.index," with id:",n.id),0==--u&&e()}))}))}},{key:"setActiveTexture",value:function(e,t,n){var r=this;this.mImageLoader.load(t,(function(t){var o=r.getParent();null!==o.getActiveTextures()[e]&&o._setTextureCubeImage(e,t),o._updateMaterial(),n(!0)}),void 0,(function(e){n(e)}))}},{key:"onExecute",value:(r=p(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){if(t.isCancelled())e(!1);else{var r=t.getParent();r.getRenderState().getResourceManager().getManager(u.O.TextureManager).then((function(n){t.mTextureManager=n,t.mImageLoader=new THREE.ImageLoader,t.mImageLoader.setCrossOrigin("anonymous"),r._createTextureCube(),t.updateTextures((function(){c.qL.print("update tex skybox done"),e(!0)}))}),(function(e){n(e)}))}})));case 1:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})}],n&&h(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),b}(r.o);b.TypeRTTI=new i.r("JobUpdateCubeMap",o.e.TypeRTTI)},60603:function(e,t,n){"use strict";n.d(t,{O:function(){return _}}),n(41539),n(88674),n(92222),n(91058),n(15581),n(2490),n(34514),n(54747),n(47941),n(39714),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948),n(35666);var r=n(78456),o=n(37852),i=n(90140),a=n(29844),u=n(84758),c=n(41142),s=n(75306),l=n(55830),f=n(9896),p=n(48155),d=n(10288);function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function y(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function m(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){y(i,r,o,a,u,"next",e)}function u(e){y(i,r,o,a,u,"throw",e)}a(void 0)}))}}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function b(e,t){return b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},b(e,t)}function g(e,t){if(t&&("object"===h(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function w(e){return w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},w(e)}var _=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b(e,t)}(O,e);var t,n,r,o,i,h,y,_=(h=O,y=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=w(h);if(y){var n=w(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return g(this,e)});function O(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,O),(t=_.call(this,"ProductNode")).mProductId=e,t}return t=O,n=[{key:"getType",value:function(){return O.TypeRTTI}},{key:"onAttached",value:function(){this.getParent().isDerivedOfTypeName("ProductNode")||c.qL.print("Attached product node process to none product node parent.")}},{key:"handleResponse",value:(i=m(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isCancelled()){e.next=3;break}return n(!1),e.abrupt("return");case 3:return e.next=5,r._handleOnBuildReady(t.data);case 5:n(!0);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return i.apply(this,arguments)})},{key:"resolveFromCache",value:(o=m(regeneratorRuntime.mark((function e(t,n){var r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,o){var i=r.getParent().getComponent("propertyValue");if(i&&!0===i.getValue("disable_bootstrap"))return c.qL.print("API Batch Query Cache is disabled"),o("API Cache is disabled");a.O.uniqueInstance().get("configuration_cache/".concat(t,"/configuration_").concat(n,".json"),{baseURL:l.E4.spacesUrl}).then((function(t){e(t)}),(function(e){o(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(e,t){return o.apply(this,arguments)})},{key:"onExecute",value:(r=m(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){c.qL.print("job product node");var r=t.getParent();r.getComponent("processManager").resolveManager().then((function(){r.getComponent("attributeManager").resolveAttributeManager().subscribe((function(o){r.getComponent("catalogueMeta").resolveSettings().subscribe((function(i){if(t.isCancelled())return e(!1);var l=t.mProductId;f.h.getInstance().preloadCatalogue(+l),p.y.getInstance().preloadCatalogue(+l);var h=o.buildQueryParams(),y=i.getSceneDeviceSettings((0,d.tq)()?s.i.Mobile:s.i.Desktop),v=parseInt(y.compression,10),b="";Object.keys(h).forEach((function(e){b+="".concat(e,":").concat(h[e],"/")}));var g="".concat(l,"/").concat(i.getGraphRevId(),"/").concat(i.getSceneRevId(),"/").concat(v,"/").concat(b),w=u.V.hashStr(g).toString();c.qL.print("request configuration with hash path: ",g),t.resolveFromCache(l,w).then(function(){var n=m(regeneratorRuntime.mark((function n(o){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.handleResponse(o,e,r);case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),(function(){a.O.getInstance().post("scene_object/batch/".concat(t.mProductId),{id:l,attributes:h,nodes:!0,hash:w,compression:v}).then(function(){var n=m(regeneratorRuntime.mark((function n(o){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.handleResponse(o,e,r);case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),(function(e){c.qL.error("Product node failed to download scene:",e),n("Product node failed to download scene:".concat(e))}))}))}),(function(e){c.qL.error("Product node failed to download catalogue meta:",e),n("Product node failed to download catalogue meta:".concat(e))}))}),(function(e){c.qL.error("Failed to load product options:",e),n("Failed to load product options.")}))}),(function(e){c.qL.error("Failed to load process manager: ",e),n("Failed to load process manager")}))})));case 1:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})}],n&&v(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),O}(r.o);_.TypeRTTI=new i.r("JobUpdateProduct",o.e.TypeRTTI)},71303:function(e,t,n){"use strict";n.d(t,{T:function(){return f}}),n(41539),n(88674),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(78456),o=n(37852),i=n(90140);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function s(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=l(r);if(o){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return s(this,e)});function a(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.call(this,"SceneObject")}return t=a,(n=[{key:"getType",value:function(){return a.TypeRTTI}},{key:"onExecute",value:function(){return new Promise((function(e,t){e(!0)}))}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(r.o);f.TypeRTTI=new i.r("JobUpdateSceneObject",o.e.TypeRTTI)},79816:function(e,t,n){"use strict";n.d(t,{GY:function(){return i.G},HF:function(){return i.H},Nk:function(){return c.N},Xk:function(){return u.X},ng:function(){return o.n},u1:function(){return a.u},xS:function(){return r.x}}),n(68511),n(38531),n(73010);var r=n(36298),o=(n(73046),n(73463),n(16839),n(79241)),i=n(70258),a=(n(46863),n(35572),n(27109),n(13420),n(94110),n(43706)),u=(n(82417),n(85715)),c=n(73462);n(52557),n(16011),n(83194)},68511:function(e,t,n){"use strict";n.d(t,{f:function(){return l}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(97748),o=n(90140);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function c(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(l,e);var t,n,r,o,i=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=s(r);if(o){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return c(this,e)});function l(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),i.call(this)}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r.v);l.TypeRTTI=new o.r("MessageAfterViewInit",r.v.TypeRTTI)},38531:function(e,t,n){"use strict";n.d(t,{c:function(){return l}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(90140),o=n(97748);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function c(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(l,e);var t,n,r,o,i=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=s(r);if(o){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return c(this,e)});function l(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),i.call(this)}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(o.v);l.TypeRTTI=new r.r("MessageCameraAnimated",o.v.TypeRTTI)},73010:function(e,t,n){"use strict";n.d(t,{c:function(){return l}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(90140),o=n(97748);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function c(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(l,e);var t,n,r,o,i=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=s(r);if(o){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return c(this,e)});function l(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),i.call(this)}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(o.v);l.TypeRTTI=new r.r("MessageControlsMoved",o.v.TypeRTTI)},57877:function(e,t,n){"use strict";n.d(t,{y:function(){return l}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(90140),o=n(97748);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function c(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(l,e);var t,n,r,o,i=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=s(r);if(o){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return c(this,e)});function l(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),i.call(this)}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(o.v);l.TypeRTTI=new r.r("MessageDeinitRenderObject",o.v.TypeRTTI)},36298:function(e,t,n){"use strict";n.d(t,{x:function(){return l}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(97748),o=n(90140);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function c(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(l,e);var t,n,r,o,i=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=s(r);if(o){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return c(this,e)});function l(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(r=i.call(this)).mName=e,r.mScreenPosition=t,r.mData=n,r}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}},{key:"name",get:function(){return this.mName}},{key:"data",get:function(){return this.mData}},{key:"position",get:function(){return this.mScreenPosition}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r.v);l.TypeRTTI=new o.r("MessageDrag",r.v.TypeRTTI)},73046:function(e,t,n){"use strict";n.d(t,{y:function(){return f}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(97748),o=n(90140);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function s(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(f,e);var t,n,r,o,i=(r=f,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=l(r);if(o){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return s(this,e)});function f(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return a(this,f),(n=i.call(this)).mName=e,n.mIsDroppedInDropZone=t,n.mData=r,n}return t=f,(n=[{key:"getType",value:function(){return f.TypeRTTI}},{key:"name",get:function(){return this.mName}},{key:"data",get:function(){return this.mData}},{key:"isDroppedInDropZone",get:function(){return this.mIsDroppedInDropZone}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(r.v);f.TypeRTTI=new o.r("MessageDropZone",r.v.TypeRTTI)},73463:function(e,t,n){"use strict";n.d(t,{j:function(){return f}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(97748),o=n(90140);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function s(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(f,e);var t,n,r,o,i=(r=f,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=l(r);if(o){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return s(this,e)});function f(e,t){var n,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return a(this,f),(n=i.call(this)).fitPosition=e,n.targetObject=t,n.animate=r,n}return t=f,(n=[{key:"getType",value:function(){return f.TypeRTTI}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(r.v);f.TypeRTTI=new o.r("MessageFitCamera",r.v.TypeRTTI)},16839:function(e,t,n){"use strict";n.d(t,{H:function(){return l}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(90140),o=n(97748);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function c(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(l,e);var t,n,r,o,i=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=s(r);if(o){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return c(this,e)});function l(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),i.call(this)}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(o.v);l.TypeRTTI=new r.r("MessageInitRenderObject",o.v.TypeRTTI)},94498:function(e,t,n){"use strict";n.d(t,{u:function(){return l}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(97748),o=n(90140);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function c(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(l,e);var t,n,r,o,i=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=s(r);if(o){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return c(this,e)});function l(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(r=i.call(this)).mMaterialModelId=e,r.mSharedKey=t,r.mSceneObjectId=n,r}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}},{key:"materialModelId",get:function(){return this.mMaterialModelId}},{key:"sharedKey",get:function(){return this.mSharedKey}},{key:"sceneObjectId",get:function(){return this.mSceneObjectId}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r.v);l.TypeRTTI=new o.r("MessageMaterialOverwrite",r.v.TypeRTTI)},79241:function(e,t,n){"use strict";n.d(t,{n:function(){return l}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(97748),o=n(90140);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function c(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(l,e);var t,n,r,o,i=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=s(r);if(o){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return c(this,e)});function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=i.call(this)).mName=e,n.mEvent=t,n}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}},{key:"name",get:function(){return this.mName}},{key:"event",get:function(){return this.mEvent}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r.v);l.TypeRTTI=new o.r("MessageMouse",r.v.TypeRTTI)},70258:function(e,t,n){"use strict";n.d(t,{G:function(){return p},H:function(){return r}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r,o=n(97748),i=n(90140);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},s(e,t)}function l(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}!function(e){e[e.NONE=0]="NONE",e[e.PUSH_CONTROLLER=1]="PUSH_CONTROLLER",e[e.POP_CONTROLLER=2]="POP_CONTROLLER"}(r||(r={}));var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(p,e);var t,n,o,i,a=(o=p,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=f(o);if(i){var n=f(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return l(this,e)});function p(e,t){var n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.NONE,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,c=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return u(this,p),(n=a.call(this)).origin=e,n.dir=t,n.action=o,n.delta=i,n.forceUpdate=c,n}return t=p,(n=[{key:"getType",value:function(){return p.TypeRTTI}}])&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),p}(o.v);p.TypeRTTI=new i.r("MessageMoveCamera",o.v.TypeRTTI)},49575:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(97748),o=n(90140);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function s(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(f,e);var t,n,r,o,i=(r=f,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=l(r);if(o){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return s(this,e)});function f(e,t,n,r){var o,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return a(this,f),(o=i.call(this)).product_scene_id=e,o.product_scene_uuid=t,o.attribute_id=n,o.option_id=u,o.visible=r,o}return t=f,(n=[{key:"getType",value:function(){return f.TypeRTTI}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(r.v);f.TypeRTTI=new o.r("MessageOptionVisibility",r.v.TypeRTTI)},46863:function(e,t,n){"use strict";n.d(t,{r:function(){return l}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(97748),o=n(90140);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function c(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(l,e);var t,n,r,o,i=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=s(r);if(o){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return c(this,e)});function l(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(r=i.call(this)).renderer=e,r.camera=t,r.scene=n,r}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r.v);l.TypeRTTI=new o.r("MessagePostrender",r.v.TypeRTTI)},35572:function(e,t,n){"use strict";n.d(t,{V:function(){return l}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(97748),o=n(90140);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function c(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(l,e);var t,n,r,o,i=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=s(r);if(o){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return c(this,e)});function l(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(r=i.call(this)).renderer=e,r.camera=t,r.scene=n,r}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r.v);l.TypeRTTI=new o.r("MessagePrerender",r.v.TypeRTTI)},27109:function(e,t,n){"use strict";n.d(t,{G:function(){return l}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(97748),o=n(90140);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function c(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(l,e);var t,n,r,o,i=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=s(r);if(o){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return c(this,e)});function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=i.call(this)).item_id=e,n.visible=t,n}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r.v);l.TypeRTTI=new o.r("MessagePriceVisibility",r.v.TypeRTTI)},13420:function(e,t,n){"use strict";n.d(t,{f:function(){return l}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(97748),o=n(90140);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function c(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(l,e);var t,n,r,o,i=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=s(r);if(o){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return c(this,e)});function l(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(r=i.call(this)).renderer=e,r.camera=t,r.scene=n,r}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r.v);l.TypeRTTI=new o.r("MessageRenderPosteffects",r.v.TypeRTTI)},94110:function(e,t,n){"use strict";n.d(t,{K:function(){return l}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(97748),o=n(90140);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function c(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(l,e);var t,n,r,o,i=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=s(r);if(o){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return c(this,e)});function l(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(r=i.call(this)).renderer=e,r.camera=t,r.scene=n,r}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r.v);l.TypeRTTI=new o.r("MessageRender",r.v.TypeRTTI)},43706:function(e,t,n){"use strict";n.d(t,{u:function(){return f}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(97748),o=n(90140);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function s(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(f,e);var t,n,r,o,i=(r=f,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=l(r);if(o){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return s(this,e)});function f(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return a(this,f),(t=i.call(this)).camId=e,t.animate=n,t.openView=r,t}return t=f,(n=[{key:"getType",value:function(){return f.TypeRTTI}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(r.v);f.TypeRTTI=new o.r("MessageSelectCameraId",r.v.TypeRTTI)},82417:function(e,t,n){"use strict";n.d(t,{U:function(){return l}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(97748),o=n(90140);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function c(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(l,e);var t,n,r,o,i=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=s(r);if(o){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return c(this,e)});function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=i.call(this)).viewId=e,t}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r.v);l.TypeRTTI=new o.r("MessageSelectViewId",r.v.TypeRTTI)},85715:function(e,t,n){"use strict";n.d(t,{X:function(){return l}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(97748),o=n(90140);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function c(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(l,e);var t,n,r,o,i=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=s(r);if(o){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return c(this,e)});function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=i.call(this)).key=e,n.value=t,n}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r.v);l.TypeRTTI=new o.r("MessageSetValue",r.v.TypeRTTI)},73462:function(e,t,n){"use strict";n.d(t,{N:function(){return l}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(97748),o=n(90140);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function c(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(l,e);var t,n,r,o,i=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=s(r);if(o){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return c(this,e)});function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=i.call(this)).mWidth=e,n.mHeight=t,n}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}},{key:"width",get:function(){return this.mWidth}},{key:"height",get:function(){return this.mHeight}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r.v);l.TypeRTTI=new o.r("MessageSizechange",r.v.TypeRTTI)},52557:function(e,t,n){"use strict";n.d(t,{E:function(){return l}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(97748),o=n(90140);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function c(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(l,e);var t,n,r,o,i=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=s(r);if(o){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return c(this,e)});function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=i.call(this)).save=e,n.reset=t,n}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r.v);l.TypeRTTI=new o.r("MessageStateControls",r.v.TypeRTTI)},16011:function(e,t,n){"use strict";n.d(t,{I:function(){return l}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(97748),o=n(90140);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function c(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(l,e);var t,n,r,o,i=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=s(r);if(o){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return c(this,e)});function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=i.call(this)).mDelta=1,t.mDelta=e,t}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}},{key:"delta",get:function(){return this.mDelta}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r.v);l.TypeRTTI=new o.r("MessageViewupdate",r.v.TypeRTTI)},83194:function(e,t,n){"use strict";n.d(t,{S:function(){return p}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(97748),o=n(90140),i=n(78842);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},s(e,t)}function l(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(p,e);var t,n,r,o,a=(r=p,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=f(r);if(o){var n=f(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return l(this,e)});function p(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.L.TypeRTTI;return u(this,p),(t=a.call(this)).visible=e,t.object_type=n,t}return t=p,(n=[{key:"getType",value:function(){return p.TypeRTTI}}])&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),p}(r.v);p.TypeRTTI=new o.r("MessageVisibility",r.v.TypeRTTI)},84900:function(){},85887:function(){},79039:function(){},57142:function(e,t,n){"use strict";n.d(t,{ModelProduct:function(){return r.a}});var r=n(50666),o=n(62573);n.o(o,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return o.AddObjectCommand}}),n.o(o,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return o.AppViewerComponent}}),n.o(o,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return o.SetPositionCommand}}),n.o(o,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return o.SetRotationCommand}});var i=n(59221);n.o(i,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return i.AddObjectCommand}}),n.o(i,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return i.AppViewerComponent}}),n.o(i,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return i.SetPositionCommand}}),n.o(i,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return i.SetRotationCommand}});var a=n(22242);n.o(a,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return a.AddObjectCommand}}),n.o(a,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return a.AppViewerComponent}}),n.o(a,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return a.SetPositionCommand}}),n.o(a,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return a.SetRotationCommand}});var u=n(35470);n.o(u,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return u.AddObjectCommand}}),n.o(u,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return u.AppViewerComponent}}),n.o(u,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return u.SetPositionCommand}}),n.o(u,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return u.SetRotationCommand}});var c=n(41185);n.o(c,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return c.AddObjectCommand}}),n.o(c,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return c.AppViewerComponent}}),n.o(c,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return c.SetPositionCommand}}),n.o(c,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return c.SetRotationCommand}});var s=n(84900);n.o(s,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return s.AddObjectCommand}}),n.o(s,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return s.AppViewerComponent}}),n.o(s,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return s.SetPositionCommand}}),n.o(s,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return s.SetRotationCommand}});var l=n(35714);n.o(l,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return l.AddObjectCommand}}),n.o(l,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return l.AppViewerComponent}}),n.o(l,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return l.SetPositionCommand}}),n.o(l,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return l.SetRotationCommand}});var f=n(37876);n.o(f,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return f.AddObjectCommand}}),n.o(f,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return f.AppViewerComponent}}),n.o(f,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return f.SetPositionCommand}}),n.o(f,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return f.SetRotationCommand}});var p=n(79039);n.o(p,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return p.AddObjectCommand}}),n.o(p,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return p.AppViewerComponent}}),n.o(p,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return p.SetPositionCommand}}),n.o(p,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return p.SetRotationCommand}});var d=n(85887);n.o(d,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return d.AddObjectCommand}}),n.o(d,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return d.AppViewerComponent}}),n.o(d,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return d.SetPositionCommand}}),n.o(d,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return d.SetRotationCommand}});var h=n(47234);n.o(h,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return h.AddObjectCommand}}),n.o(h,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return h.AppViewerComponent}}),n.o(h,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return h.SetPositionCommand}}),n.o(h,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return h.SetRotationCommand}})},22242:function(){},59221:function(){},50666:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.d(t,{a:function(){return o}}),n(68309),n(82526),n(41817),n(69070),n(21703);var o=function(){function e(t,n,r,o,i,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mModelId=t,this.mName=n,this.mDescription=r,this.mSKU=o,this.mPrice=i,this.mSyncHash=a}var t,n;return t=e,(n=[{key:"setSyncHash",value:function(e){this.mSyncHash=e}},{key:"getSyncHash",value:function(){return this.mSyncHash}},{key:"isInSyncWithHash",value:function(e){return this.mSyncHash===e}},{key:"modelId",get:function(){return this.mModelId}},{key:"name",get:function(){return this.mName}},{key:"description",get:function(){return this.mDescription}},{key:"sku",get:function(){return this.mSKU}},{key:"price",get:function(){return this.mPrice}},{key:"serialize",value:function(){return{modelId:this.modelId,name:this.name,description:this.description,sku:this.sku,price:this.price}}},{key:"onAttached",value:function(){}},{key:"onDetached",value:function(){}}])&&r(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},62573:function(){},41185:function(){},37876:function(){},58539:function(){},9001:function(){},37004:function(){},11802:function(){},83268:function(){},47234:function(e,t,n){"use strict";var r=n(58539);n.o(r,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return r.AddObjectCommand}}),n.o(r,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return r.AppViewerComponent}}),n.o(r,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return r.SetPositionCommand}}),n.o(r,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return r.SetRotationCommand}});var o=n(9001);n.o(o,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return o.AddObjectCommand}}),n.o(o,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return o.AppViewerComponent}}),n.o(o,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return o.SetPositionCommand}}),n.o(o,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return o.SetRotationCommand}});var i=n(37004);n.o(i,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return i.AddObjectCommand}}),n.o(i,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return i.AppViewerComponent}}),n.o(i,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return i.SetPositionCommand}}),n.o(i,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return i.SetRotationCommand}});var a=n(11802);n.o(a,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return a.AddObjectCommand}}),n.o(a,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return a.AppViewerComponent}}),n.o(a,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return a.SetPositionCommand}}),n.o(a,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return a.SetRotationCommand}});var u=n(83268);n.o(u,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return u.AddObjectCommand}}),n.o(u,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return u.AppViewerComponent}}),n.o(u,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return u.SetPositionCommand}}),n.o(u,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return u.SetRotationCommand}});var c=n(95219);n.o(c,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return c.AddObjectCommand}}),n.o(c,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return c.AppViewerComponent}}),n.o(c,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return c.SetPositionCommand}}),n.o(c,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return c.SetRotationCommand}});var s=n(17001);n.o(s,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return s.AddObjectCommand}}),n.o(s,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return s.AppViewerComponent}}),n.o(s,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return s.SetPositionCommand}}),n.o(s,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return s.SetRotationCommand}});var l=n(5866);n.o(l,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return l.AddObjectCommand}}),n.o(l,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return l.AppViewerComponent}}),n.o(l,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return l.SetPositionCommand}}),n.o(l,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return l.SetRotationCommand}})},95219:function(){},17001:function(){},5866:function(e,t,n){"use strict";var r=n(3713);n.o(r,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return r.AddObjectCommand}}),n.o(r,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return r.AppViewerComponent}}),n.o(r,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return r.SetPositionCommand}}),n.o(r,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return r.SetRotationCommand}});var o=n(54112);n.o(o,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return o.AddObjectCommand}}),n.o(o,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return o.AppViewerComponent}}),n.o(o,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return o.SetPositionCommand}}),n.o(o,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return o.SetRotationCommand}})},54112:function(){},3713:function(){},18743:function(e,t,n){"use strict";n.d(t,{H:function(){return l}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(90140),o=n(56635);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function c(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(l,e);var t,n,r,o,i=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=s(r);if(o){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return c(this,e)});function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=i.call(this)).mComponentName=e,t}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}},{key:"getComponentName",value:function(){return this.mComponentName}},{key:"getParentObject",value:function(){return this.mParentObject}},{key:"_setObject",value:function(e){this.mParentObject=e}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(o.l);l.TypeRTTI=new r.r("Component",o.l.TypeRTTI)},78842:function(e,t,n){"use strict";n.d(t,{L:function(){return p}}),n(41539),n(15581),n(2490),n(34514),n(54747),n(34553),n(40561),n(69826),n(31672),n(59461),n(57327),n(88449),n(59849),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(90140),o=n(56635),i=n(18743),a=n(41142);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},s(e,t)}function l(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(p,e);var t,n,r,o,u=(r=p,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=f(r);if(o){var n=f(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return l(this,e)});function p(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),(e=u.call(this)).mComponents=new Array,e}return t=p,(n=[{key:"getType",value:function(){return p.TypeRTTI}},{key:"catchUnhandledMessage",value:function(e){this.dispatchMessageToComponents(e)}},{key:"dispatchMessageToComponents",value:function(e){this.mComponents.forEach((function(t){t.dispatchMessage(e)}))}},{key:"addComponent",value:function(e){return e.getParentObject()?(a.qL.error("Component is already assignned"),!1):e.isAttachable(this.getType())?this.getComponent(e.getComponentName())?(a.qL.error("Object already contains component:",e.getComponentName()),!1):(e._setObject(this),this.mComponents.push(e),e.OnAttached(),!0):(a.qL.error("can not attach component ",e.getType().getTypeName()," to object ",this.getType().getTypeName()),!1)}},{key:"removeComponent",value:function(e){var t=this.mComponents.findIndex((function(t){return t.getComponentName()===e}));return t>=0&&(this.mComponents[t].OnDetached(),this.mComponents[t]._setObject(null),this.mComponents.splice(t,1),!0)}},{key:"removeComponents",value:function(e){var t=this;this.getComponents(e).forEach((function(e){t.removeComponent(e.getComponentName())}))}},{key:"removeAllComponents",value:function(){this.removeComponents(i.H.TypeRTTI)}},{key:"getComponent",value:function(e){return this.mComponents.find((function(t){return t.getComponentName()===e}))}},{key:"getComponents",value:function(e){return this.mComponents.filter((function(t){return t.isDerivedTypeOf(e)}))}}])&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),p}(o.l);p.TypeRTTI=new r.r("BaseObject",o.l.TypeRTTI)},4530:function(e,t,n){"use strict";n.d(t,{H6:function(){return i.H},e3:function(){return o.e},rz:function(){return r.r}});var r=n(90140),o=n(37852),i=(n(97748),n(56635),n(18743));n(78456),n(78842),n(15840)},78456:function(e,t,n){"use strict";n.d(t,{B:function(){return r},o:function(){return y}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r,o=n(29514),i=n(89539),a=n(37852),u=n(90140),c=n(41142),s=n(70456);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},p(e,t)}function d(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}!function(e){e[e.Idle=0]="Idle",e[e.Working=1]="Working",e[e.Done=2]="Done",e[e.Cancelled=3]="Cancelled",e[e.Failed=4]="Failed"}(r||(r={}));var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(y,e);var t,n,a,u,l=(a=y,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(a);if(u){var n=h(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return d(this,e)});function y(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,y),(t=l.call(this)).mParent=null,t.mReusable=!1,t.mCancelled=!1,t.mStatus=r.Idle,t.mJobComplete=!1,t.mNextProcess=null,t.mName=e,t}return t=y,(n=[{key:"getType",value:function(){return y.TypeRTTI}},{key:"getParent",value:function(){return this.mParent}},{key:"setReusable",value:function(e){this.mReusable=e}},{key:"isReusable",value:function(){return this.mReusable}},{key:"isAttached",value:function(){return!(0,i.isNullOrUndefined)(this.mParent)}},{key:"getStatus",value:function(){return this.mStatus}},{key:"attach",value:function(e){return this.isAttached()&&(this.detach(),c.qL.warn("Reattaching process:",this.mName," of type:",this.getType().getTypeName())),this.mParent=e,this.onAttached(),this.mSubject=new s.t,this.mSubject.pipe((0,o.P)())}},{key:"detach",value:function(){this.mCancelled=!0,this.onDetached(),this.mParent=null}},{key:"cancel",value:function(){this.mCancelled=!0,null!==this.mNextProcess&&this.mNextProcess.cancel()}},{key:"kill",value:function(){this.mCancelled=!0,this.failJob("killed"),null!==this.mNextProcess&&this.mNextProcess.kill()}},{key:"isCancelled",value:function(){return this.mCancelled}},{key:"execute",value:function(){var e=this;return this.isAttached()?this.isCancelled()?(this.mStatus=r.Cancelled,void this.failJob("cancelled process")):(this.mStatus!==r.Idle&&c.qL.warn("Executing process:",this.mName," of Type: ",this.getType().getTypeName()," with status: ",r[this.mStatus]),this.mStatus=r.Working,this.mCancelled=!1,void this.onExecute().then((function(t){e.mStatus=t?r.Done:r.Cancelled,e.finishJob(t)})).catch((function(t){e.mStatus=r.Failed,e.failJob(t)}))):(c.qL.error("Trying to execute unattached process:",this.mName," of Type: ",this.getType().getTypeName()," with status: ",r[this.mStatus]),void this.failJob("unattached process"))}},{key:"observeSubject",value:function(){return this.mSubject.pipe((0,o.P)())}},{key:"setNextProcess",value:function(e){return null!==this.mNextProcess?this.mNextProcess.setNextProcess(e):(this.mNextProcess=e,this)}},{key:"getNextProcess",value:function(){return this.mNextProcess}},{key:"getLastProcess",value:function(){return null!==this.getNextProcess()?this.getNextProcess().getLastProcess():this}},{key:"finishJob",value:function(e){this.mJobComplete||(this.mJobComplete=!0,this.mSubject.next(e))}},{key:"failJob",value:function(e){this.mJobComplete||(this.mJobComplete=!0,this.mSubject.error(e))}},{key:"onAttached",value:function(){}},{key:"onDetached",value:function(){}}])&&f(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),y}(a.e);y.TypeRTTI=new u.r("Job",a.e.TypeRTTI)},56635:function(e,t,n){"use strict";n.d(t,{l:function(){return f}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(90140),o=n(37852),i=n(41142);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function s(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(f,e);var t,n,r,o,a=(r=f,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=l(r);if(o){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return s(this,e)});function f(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(e=a.call(this)).mMessageHandlers={},e}return t=f,(n=[{key:"getType",value:function(){return f.TypeRTTI}},{key:"registerMessageHandler",value:function(e,t){this.handlesMessageType(e)?i.qL.error("Failed to re-register message handler:",e.getTypeName()):this.mMessageHandlers[e.getTypeName()]=t}},{key:"unregisterMessageHandler",value:function(e){this.handlesMessageType(e)&&delete this.mMessageHandlers[e.getTypeName()]}},{key:"dispatchMessage",value:function(e){if(!e.isDismissed())if(this.handlesMessageType(e.getType())){var t=this.mMessageHandlers[e.getType().getTypeName()];"handle"in t?(t.before&&t.before(e),e.isDismissed()||t.handle(e),!e.isDismissed()&&t.after&&t.after(e)):t(e)}else this.catchUnhandledMessage(e)}},{key:"catchUnhandledMessage",value:function(e){}},{key:"handlesMessageType",value:function(e){return e.getTypeName()in this.mMessageHandlers}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(o.e);f.TypeRTTI=new r.r("BaseMessageHandler",o.e.TypeRTTI)},97748:function(e,t,n){"use strict";n.d(t,{v:function(){return l}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(90140),o=n(37852);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function c(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(l,e);var t,n,r,o,i=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=s(r);if(o){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return c(this,e)});function l(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(e=i.call(this)).mDismissed=!1,e}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}},{key:"dismiss",value:function(){this.mDismissed=!0}},{key:"isDismissed",value:function(){return this.mDismissed}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(o.e);l.TypeRTTI=new r.r("Message",o.e.TypeRTTI)},37852:function(e,t,n){"use strict";n.d(t,{e:function(){return c}}),n(69070),n(21703);var r=n(90140),o=n(89002),i=n(89539),a=n(41142);function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mObjectId=++e.ObjectIdCount,this.mObjectUUID=o.F.guid()}var t,n;return t=e,(n=[{key:"getType",value:function(){return e.TypeRTTI}},{key:"id",get:function(){return this.getObjectId()}},{key:"uuid",get:function(){return this.mObjectUUID}},{key:"getObjectId",value:function(){return this.mObjectId}},{key:"getObjectUUID",value:function(){return this.mObjectUUID}},{key:"_setObjectUUID",value:function(e){!(0,i.isNullOrUndefined)(e)&&"null"!==e&&e.length>16?this.mObjectUUID=e:a.qL.warn("tying to set object '"+this.mObjectId+"' uuid to invalid value: ",e)}},{key:"isTypeName",value:function(e){return this.getType().isTypeName(e)}},{key:"isDerivedOfTypeName",value:function(e){return this.getType().isDerivedOfTypeName(e)}},{key:"isTypeOf",value:function(e){return this.getType().isTypeOf(e)}},{key:"isDerivedTypeOf",value:function(e){return this.getType().isDerivedTypeOf(e)}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();c.TypeRTTI=new r.r("RttiObject"),c.ObjectIdCount=0},90140:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.d(t,{r:function(){return o}}),n(69070),n(21703);var o=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mTypeName=t,this.mParentClass=n}var t,n;return t=e,(n=[{key:"getTypeName",value:function(){return this.mTypeName}},{key:"isTypeName",value:function(e){return e===this.mTypeName}},{key:"isDerivedOfTypeName",value:function(e){return!!this.isTypeName(e)||void 0!==this.getParent()&&this.getParent().isDerivedOfTypeName(e)}},{key:"isTypeOf",value:function(e){return this.mTypeName==e.getTypeName()}},{key:"isDerivedTypeOf",value:function(e){return!!this.isTypeOf(e)||void 0!==this.getParent()&&this.getParent().isDerivedTypeOf(e)}},{key:"getParent",value:function(){return this.mParentClass}}])&&r(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},15840:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.d(t,{$:function(){return o}}),n(69070),n(21703);var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,(n=[{key:"setSyncHash",value:function(e){this.mSyncHash=e}},{key:"getSyncHash",value:function(){return this.mSyncHash}},{key:"isInSyncWithHash",value:function(e){return this.mSyncHash===e}}])&&r(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},85765:function(e,t,n){"use strict";var r=n(19699);n.o(r,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return r.AddObjectCommand}}),n.o(r,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return r.AppViewerComponent}}),n.o(r,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return r.SetPositionCommand}}),n.o(r,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return r.SetRotationCommand}}),n(86835),n(82630),n(82924),n(36588),n(1025),n(46538),n(17876),n(23346),n(94753),n(87411),n(11342),n(2503)},19699:function(e,t,n){"use strict";var r=n(69980);n.o(r,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return r.AddObjectCommand}}),n.o(r,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return r.AppViewerComponent}}),n.o(r,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return r.SetPositionCommand}}),n.o(r,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return r.SetRotationCommand}});var o=n(71530);n.o(o,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return o.AddObjectCommand}}),n.o(o,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return o.AppViewerComponent}}),n.o(o,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return o.SetPositionCommand}}),n.o(o,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return o.SetRotationCommand}});var i=n(26487);n.o(i,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return i.AddObjectCommand}}),n.o(i,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return i.AppViewerComponent}}),n.o(i,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return i.SetPositionCommand}}),n.o(i,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return i.SetRotationCommand}})},69980:function(){},26487:function(){},71530:function(){},82924:function(e,t,n){"use strict";n.d(t,{u:function(){return f}}),n(69600),n(54678),n(91058),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(86835),o=n(89539),i=n(41142);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function s(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(p,e);var t,n,r,a,f=(r=p,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=l(r);if(a){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return s(this,e)});function p(e,t,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),f.call(this,e,t,n)}return t=p,(n=[{key:"createEffect",value:function(){this.mCamera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),this.mScene=new THREE.Scene,this.recreateMaterial(),this.mQuad=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),null),this.mQuad.frustumCulled=!1,this.mScene.add(this.mQuad)}},{key:"recreateMaterial",value:function(){(0,o.isNullOrUndefined)(this.mMaterial)||this.mMaterial.dispose();var e={defines:{BLUR_RADIUS:(0,o.isNullOrUndefined)(this.mModel.defines.BLUR_RADIUS)?8:this.mModel.defines.BLUR_RADIUS.value},uniforms:{tDiffuse:{value:null},tPosition:{value:null},invTexSize:{value:new THREE.Vector2(1/this.mRenderWidth,1/this.mRenderHeight)},Sigma:{value:(0,o.isNullOrUndefined)(this.mModel.uniforms.Sigma)?.5:this.mModel.uniforms.Sigma.value},g_Sharpness:{value:(0,o.isNullOrUndefined)(this.mModel.uniforms.g_Sharpness)?5.2:this.mModel.uniforms.g_Sharpness.value},CameraFar:{value:100}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform sampler2D tPosition;","uniform vec2 invTexSize;","uniform float Sigma;","uniform float CameraFar;","uniform float g_Sharpness;","varying vec2 vUv;","#include <packing>","float getDepthVs(vec2 uv){","vec4 sampleDepth = texture2D(tPosition, uv);","float depth = unpackRGBAToDepth(sampleDepth)*CameraFar;","return depth;","}","vec4 BlurFunction(vec2 uv, float r, vec4 center_c, float center_d, inout float w_total){","vec4  c = texture2D( tDiffuse, uv );","float d = getDepthVs(uv);","float BlurFalloff = 1.0 / (2.0*Sigma*Sigma);","float ddiff = (d - center_d) * g_Sharpness;","float w = exp2(-r*r*BlurFalloff - ddiff*ddiff);","w_total += w;","return c*w;","}","void main() {","#ifdef HORIZONTAL","const vec2 blurMultiplyVec\t= vec2(1.0, 0.0);","float texelScale = invTexSize.x;","#endif","#ifdef VERTICAL","const vec2 blurMultiplyVec\t= vec2(0.0, 1.0);","float texelScale = invTexSize.y;","#endif","vec4  center_c = texture2D( tDiffuse, vUv);","float center_d = getDepthVs(vUv);","vec4  c_total = center_c;","float w_total = 1.0;","for (int r = 1; r <= BLUR_RADIUS; ++r){","float fr = float(r);","vec2 uv = vUv + (texelScale*blurMultiplyVec) * fr;","c_total += BlurFunction(uv, fr, center_c, center_d, w_total);","}","for (int r = 1; r <= BLUR_RADIUS; ++r){","float fr = float(r);","vec2 uv = vUv - (texelScale*blurMultiplyVec) * fr;","c_total += BlurFunction(uv, fr, center_c, center_d, w_total);","}","gl_FragColor = c_total/w_total;","}"].join("\n")};(0,o.isNullOrUndefined)(this.mModel.attributes.direction)||("horizontal"===this.mModel.attributes.direction.value?e.defines.HORIZONTAL=!0:e.defines.VERTICAL=!0),i.qL.print("creating bilateral blur for: ",e.defines),this.mMaterial=new THREE.ShaderMaterial(e)}},{key:"dispose",value:function(){this.mScene.remove(this.mQuad),this.mScene.remove(this.mCamera),this.mMaterial.dispose(),this.mQuad.geometry.dispose(),this.mQuad=null,this.mScene=null,this.mCamera=null,this.mMaterial=null}},{key:"getMeta",value:function(){return p.EffectMeta}},{key:"render",value:function(e,t,n,r){this.mQuad.material=this.mMaterial,(0,o.isNullOrUndefined)(r)?e.render(this.mScene,this.mCamera):(e.setRenderTarget(r),e.clear(!0,!0,!1),e.render(this.mScene,this.mCamera),e.setRenderTarget(null))}},{key:"discard",value:function(){}},{key:"setUniform",value:function(e,t){switch(e){case"Sigma":case"g_Sharpness":case"CameraFar":return this.mMaterial.uniforms[e].value=parseFloat(t),!0;case"invTexSize":this.mMaterial.uniforms[e].value=t.clone();break;default:this.mMaterial.uniforms[e].value=t}return!0}},{key:"setDefine",value:function(e,t){return"BLUR_RADIUS"===e&&(this.mMaterial.defines.BLUR_RADIUS=parseInt(t,10),this.mMaterial.defines.needsUpdate=!0,this.mMaterial.needsUpdate=!0,!0)}},{key:"setAttribute",value:function(e,t){return"direction"===e&&(this.recreateMaterial(),!0)}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),p}(r.c);f.EffectMeta={type:"BilateralFilter",defines:[{type:"int",name:"BLUR_RADIUS",value:8}],uniforms:[{name:"tDiffuse",value:null,type:"render_texture"},{name:"tPosition",value:null,type:"render_texture"},{type:"render_texture_texel",name:"invTexSize"},{name:"Sigma",type:"float",value:4},{name:"g_Sharpness",type:"float",value:.1},{type:"camera_far",name:"CameraFar"}],attributes:[{name:"direction",type:"selection",value:"horizontal",options:"vertical|horizontal"}]}},36588:function(e,t,n){"use strict";n.d(t,{i:function(){return f}}),n(69600),n(54678),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(86835),o=n(89539),i=n(41142);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function s(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(p,e);var t,n,r,a,f=(r=p,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=l(r);if(a){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return s(this,e)});function p(e,t,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),f.call(this,e,t,n)}return t=p,(n=[{key:"createEffect",value:function(){this.mCamera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),this.mScene=new THREE.Scene,this.recreateMaterial(),this.mQuad=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),null),this.mQuad.frustumCulled=!1,this.mScene.add(this.mQuad)}},{key:"recreateMaterial",value:function(){(0,o.isNullOrUndefined)(this.mMaterial)||this.mMaterial.dispose();var e={defines:{},uniforms:{tDiffuse:{value:null},tOverlay:{value:null},Factor:{value:(0,o.isNullOrUndefined)(this.mModel.uniforms.Factor)?1:this.mModel.uniforms.Factor.value}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform sampler2D tOverlay;","uniform float Factor;","varying vec2 vUv;","float blendOverlay(float engine, float blend) {","return engine<0.5?(2.0*engine*blend):(1.0-2.0*(1.0-engine)*(1.0-blend));","}","void main() {","vec3 engine = texture2D(tDiffuse, vUv).xyz;","vec3 blend = texture2D(tOverlay, vUv).xyz;","vec3 fragmentColor;","#ifdef screen","fragmentColor = 1.0-((1.0-engine)*(1.0-blend));","#elif defined(overlay)","fragmentColor = vec3(blendOverlay(engine.r,blend.r),blendOverlay(engine.g,blend.g),blendOverlay(engine.b,blend.b));","#elif defined(multiply)","fragmentColor = engine*blend;","#elif defined(add)","fragmentColor = min(engine+blend,1.0);","#else","fragmentColor = engine;","#endif","gl_FragColor = vec4( mix(engine, fragmentColor, Factor) , 1.0);","}"].join("\n")};(0,o.isNullOrUndefined)(this.mModel.attributes.function)||(e.defines[this.mModel.attributes.function.value]=!0),i.qL.print("creating blend for: ",e.defines),this.mMaterial=new THREE.ShaderMaterial(e)}},{key:"dispose",value:function(){this.mScene.remove(this.mQuad),this.mScene.remove(this.mCamera),this.mMaterial.dispose(),this.mQuad.geometry.dispose(),this.mQuad=null,this.mScene=null,this.mCamera=null,this.mMaterial=null}},{key:"getMeta",value:function(){return p.EffectMeta}},{key:"render",value:function(e,t,n,r){this.mQuad.material=this.mMaterial,(0,o.isNullOrUndefined)(r)?e.render(this.mScene,this.mCamera):(e.setRenderTarget(r),e.clear(!0,!0,!1),e.render(this.mScene,this.mCamera),e.setRenderTarget(null))}},{key:"discard",value:function(){}},{key:"setUniform",value:function(e,t){switch(e){case"Factor":return this.mMaterial.uniforms[e].value=parseFloat(t),!0;case"tDiffuse":case"tOverlay":return this.mMaterial.uniforms[e].value=t,!0}return!1}},{key:"setDefine",value:function(e,t){return!1}},{key:"setAttribute",value:function(e,t){return"function"===e&&(this.recreateMaterial(),!0)}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),p}(r.c);f.EffectMeta={type:"Blend",uniforms:[{name:"tDiffuse",value:null,type:"render_texture"},{name:"tOverlay",value:null,type:"render_texture"},{name:"Factor",type:"float",value:1}],attributes:[{name:"function",type:"selection",value:"screen",options:"screen|overlay|multiply|add"}]}},4297:function(e,t,n){"use strict";n.d(t,{j:function(){return f}}),n(69600),n(56977),n(54678),n(91058),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(86835),o=n(89539),i=n(41142);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function s(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(p,e);var t,n,r,a,f=(r=p,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=l(r);if(a){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return s(this,e)});function p(e,t,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),f.call(this,e,t,n)}return t=p,(n=[{key:"createEffect",value:function(){this.mCamera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),this.mScene=new THREE.Scene,this.mQuad=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),null),this.mQuad.frustumCulled=!1,this.mScene.add(this.mQuad)}},{key:"recreateMaterial",value:function(){(0,o.isNullOrUndefined)(this.mLuminosityMaterial)||this.mLuminosityMaterial.dispose();var e={uniforms:{tDiffuse:{type:"t",value:null},luminosityThreshold:{type:"f",value:this.mModel.uniforms.luminosityThreshold.value},smoothWidth:{type:"f",value:this.mModel.uniforms.smoothWidth.value},defaultOpacity:{type:"f",value:this.mModel.uniforms.defaultOpacity.value}},vertexShader:["varying vec2 vUv;","void main() {"," vUv = uv;"," gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float defaultOpacity;","uniform float luminosityThreshold;","uniform float smoothWidth;","varying vec2 vUv;","void main() {"," vec4 texel = texture2D( tDiffuse, vUv );"," vec3 luma = vec3( 0.299, 0.587, 0.114 );"," float v = dot( texel.xyz, luma );"," vec4 outputColor = vec4(0.0, 0.0, 0.0, defaultOpacity);"," float alpha = smoothstep(luminosityThreshold, luminosityThreshold + smoothWidth, v);"," gl_FragColor =  mix(outputColor, texel, alpha);","}"].join("\n")};i.qL.print("creating luminosity for: ",e),this.mLuminosityMaterial=new THREE.ShaderMaterial(e),(0,o.isNullOrUndefined)(this.mConvolutionMaterial)||this.mConvolutionMaterial.dispose();var t={defines:{KERNEL_SIZE_FLOAT:""+parseFloat(this.mModel.attributes.kernel.value).toFixed(2),KERNEL_SIZE_INT:parseInt(this.mModel.attributes.kernel.value,10)},uniforms:{tDiffuse:{value:this.mPingRenderTarget.texture},uImageIncrement:{value:new THREE.Vector2},cKernel:{value:this.buildKernel(this.mModel.attributes.sigma.value)}},vertexShader:["uniform vec2 uImageIncrement;","varying vec2 vUv;","void main() {"," vUv = uv - ( ( KERNEL_SIZE_FLOAT - 1.0 ) / 2.0 ) * uImageIncrement;"," gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float cKernel[ KERNEL_SIZE_INT ];","uniform sampler2D tDiffuse;","uniform vec2 uImageIncrement;","varying vec2 vUv;","void main() {"," vec2 imageCoord = vUv;"," vec4 sum = vec4( 0.0, 0.0, 0.0, 0.0 );"," for( int i = 0; i < KERNEL_SIZE_INT; i ++ ) {"," sum += texture2D( tDiffuse, imageCoord ) * cKernel[ i ];"," imageCoord += uImageIncrement;","}","gl_FragColor = sum;","}"].join("\n")};i.qL.print("creating convolution for: ",t),this.mConvolutionMaterial=new THREE.ShaderMaterial(t),(0,o.isNullOrUndefined)(this.mCopyShader)||this.mCopyShader.dispose();var n={uniforms:{tDiffuse:{value:null},tOverlay:{value:this.mPingRenderTarget.texture},intensity:{value:this.mModel.uniforms.intensity.value}},vertexShader:["varying vec2 vUv;","void main() {"," vUv = uv;"," gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform sampler2D tOverlay;","uniform float intensity;","varying vec2 vUv;","void main() {"," vec3 engine = texture2D(tDiffuse, vUv).xyz;"," vec3 blend = texture2D(tOverlay, vUv).xyz;"," gl_FragColor = vec4( mix(engine, min(engine+blend, 1.0), intensity) , 1.0);","}"].join("\n")};this.mCopyShader=new THREE.ShaderMaterial(n)}},{key:"getMeta",value:function(){return p.EffectMeta}},{key:"ready",value:function(){return!(0,o.isNullOrUndefined)(this.mPingRenderTarget)&&!(0,o.isNullOrUndefined)(this.mPongRenderTarget)&&!(0,o.isNullOrUndefined)(this.mLuminosityMaterial)}},{key:"discard",value:function(){}},{key:"dispose",value:function(){this.mScene.remove(this.mQuad),this.mScene.remove(this.mCamera),this.mConvolutionMaterial.dispose(),this.mLuminosityMaterial.dispose(),this.mCopyShader.dispose(),this.mQuad.geometry.dispose(),this.mQuad=null,this.mScene=null,this.mCamera=null,this.mConvolutionMaterial=null,this.mLuminosityMaterial=null,this.mCopyShader=null}},{key:"updateRender",value:function(e,t,n,r){((0,o.isNullOrUndefined)(this.mConvolutionMaterial)||(0,o.isNullOrUndefined)(this.mLuminosityMaterial)||(0,o.isNullOrUndefined)(this.mCopyShader))&&this.recreateMaterial()}},{key:"render",value:function(e,t,n,r){this.mQuad.material=this.mLuminosityMaterial,e.setRenderTarget(this.mPingRenderTarget),e.clear(!0,!0,!1),e.render(this.mScene,this.mCamera),this.mQuad.material=this.mConvolutionMaterial,this.mConvolutionMaterial.uniforms.uImageIncrement.value.copy(new THREE.Vector2(.5/this.mPingRenderTarget.width,0)),this.mConvolutionMaterial.uniforms.tDiffuse.value=this.mPingRenderTarget.texture,this.mConvolutionMaterial.needsUpdate=!0,e.setRenderTarget(this.mPongRenderTarget),e.clear(!0,!0,!1),e.render(this.mScene,this.mCamera),this.mQuad.material=this.mConvolutionMaterial,this.mConvolutionMaterial.uniforms.uImageIncrement.value.copy(new THREE.Vector2(0,.5/this.mPingRenderTarget.height)),this.mConvolutionMaterial.uniforms.tDiffuse.value=this.mPongRenderTarget.texture,this.mConvolutionMaterial.needsUpdate=!0,e.setRenderTarget(this.mPingRenderTarget),e.clear(!0,!0,!1),e.render(this.mScene,this.mCamera),e.setRenderTarget(null),this.mQuad.material=this.mCopyShader,this.mCopyShader.uniforms.tOverlay.value=this.mPingRenderTarget.texture,this.mCopyShader.needsUpdate=!0,(0,o.isNullOrUndefined)(r)?e.render(this.mScene,this.mCamera):(e.setRenderTarget(r),e.clear(!0,!0,!1),e.render(this.mScene,this.mCamera),e.setRenderTarget(null))}},{key:"buildKernel",value:function(e){var t,n,r,o,i,a,u=this.mModel.attributes.kernel.value,c=2*Math.ceil(3*e)+1;for(c>u&&(c=u),o=.5*(c-1),n=new Array(c),r=0,t=0;t<c;++t)n[t]=(i=t-o,a=e,Math.exp(-i*i/(2*a*a))),r+=n[t];for(t=0;t<c;++t)n[t]/=r;return n}},{key:"setAttribute",value:function(e,t){switch(e){case"sigma":return(0,o.isNullOrUndefined)(this.mConvolutionMaterial)||(this.mConvolutionMaterial.uniforms.cKernel.value=this.buildKernel(t)),!0;case"kernel":return this.mConvolutionMaterial.defines.KERNEL_SIZE_FLOAT=""+parseFloat(t).toFixed(2),this.mConvolutionMaterial.defines.KERNEL_SIZE_INT=parseInt(t,10),this.mConvolutionMaterial.defines.needsUpdate=!0,this.mConvolutionMaterial.uniforms.cKernel.value=this.buildKernel(this.mModel.attributes.sigma.value),this.mConvolutionMaterial.needsUpdate=!0,!0}return!1}},{key:"setDefine",value:function(e,t){return!1}},{key:"setUniform",value:function(e,t){switch(e){case"luminosityThreshold":case"smoothWidth":case"defaultOpacity":return(0,o.isNullOrUndefined)(this.mLuminosityMaterial)||(this.mLuminosityMaterial.uniforms[e].value=parseFloat(t),this.mLuminosityMaterial.needsUpdate=!0),!0;case"intensity":return(0,o.isNullOrUndefined)(this.mCopyShader)||(this.mCopyShader.uniforms.intensity.value=parseFloat(t),this.mCopyShader.needsUpdate=!0),!0;case"tDiffuse":return(0,o.isNullOrUndefined)(this.mLuminosityMaterial)||(this.mLuminosityMaterial.uniforms[e].value=t,this.mLuminosityMaterial.needsUpdate=!0),(0,o.isNullOrUndefined)(this.mCopyShader)||(this.mCopyShader.uniforms[e].value=t,this.mCopyShader.needsUpdate=!0),!0;case"pingRenderTarget":return this.mPingRenderTarget=t,!0;case"pongRenderTarget":return this.mPongRenderTarget=t,!0}return!1}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),p}(r.c);f.EffectMeta={type:"Bloom",uniforms:[{name:"pingRenderTarget",type:"render_target"},{name:"pongRenderTarget",type:"render_target"},{name:"tDiffuse",value:null,type:"render_texture"},{name:"luminosityThreshold",type:"float",value:1},{name:"smoothWidth",type:"float",value:1},{name:"defaultOpacity",type:"float",value:0},{name:"intensity",type:"float",value:1}],attributes:[{name:"kernel",type:"float",value:25},{name:"sigma",type:"float",value:4}]}},96788:function(e,t,n){"use strict";n.d(t,{K:function(){return f}}),n(69600),n(54678),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(86835),o=n(89539),i=n(41142);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function s(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(p,e);var t,n,r,a,f=(r=p,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=l(r);if(a){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return s(this,e)});function p(e,t,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),f.call(this,e,t,n)}return t=p,(n=[{key:"createEffect",value:function(){this.mCamera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),this.mScene=new THREE.Scene,this.recreateMaterial(),this.mQuad=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),null),this.mQuad.frustumCulled=!1,this.mScene.add(this.mQuad)}},{key:"recreateMaterial",value:function(){(0,o.isNullOrUndefined)(this.mMaterial)||this.mMaterial.dispose();var e={defines:{},uniforms:{tDiffuse:{value:null},tPosition:{value:null},TexelSize:{value:new THREE.Vector2(1/this.mRenderWidth,1/this.mRenderHeight)},focus:{value:(0,o.isNullOrUndefined)(this.mModel.uniforms.focus)?1:this.mModel.uniforms.focus.value},aspect:{value:1},aperture:{value:(0,o.isNullOrUndefined)(this.mModel.uniforms.aperture)?.025:this.mModel.uniforms.aperture.value},maxblur:{value:(0,o.isNullOrUndefined)(this.mModel.uniforms.maxblur)?1:this.mModel.uniforms.maxblur.value},nearClip:{value:.1},farClip:{value:1e3}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","varying vec2 vUv;","uniform sampler2D tDiffuse;","uniform sampler2D tPosition;","uniform vec2 TexelSize;","uniform float maxblur;","uniform float aperture;","uniform float nearClip;","uniform float farClip;","uniform float focus;","uniform float aspect;","#include <packing>","float reconstructDepth(vec2 uv){"," vec4 sampleDepth = texture2D(tPosition, uv);"," return unpackRGBAToDepth(sampleDepth);","}","void main() {","vec2 aspectcorrect = vec2( 1.0, aspect ) * TexelSize;","float viewZ = perspectiveDepthToViewZ( reconstructDepth( vUv ), nearClip, farClip );","float factor = ( focus + viewZ );","vec2 dofblur = vec2 ( clamp( factor * aperture, -maxblur, maxblur ) );","vec2 dofblur9 = dofblur * 0.9;","vec2 dofblur7 = dofblur * 0.7;","vec2 dofblur4 = dofblur * 0.4;","vec4 col = vec4( 0.0 );","col += texture2D( tDiffuse, vUv.xy );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur );","col += texture2D( tDiffuse, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur );","col += texture2D( tDiffuse, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur );","col += texture2D( tDiffuse, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur );","col += texture2D( tDiffuse, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur );","col += texture2D( tDiffuse, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur );","col += texture2D( tDiffuse, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur );","col += texture2D( tDiffuse, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tDiffuse, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tDiffuse, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tDiffuse, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tDiffuse, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur7 );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur7 );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur7 );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur7 );","col += texture2D( tDiffuse, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur7 );","col += texture2D( tDiffuse, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur7 );","col += texture2D( tDiffuse, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur7 );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur7 );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur4 );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.4,   0.0  ) * aspectcorrect ) * dofblur4 );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur4 );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur4 );","col += texture2D( tDiffuse, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur4 );","col += texture2D( tDiffuse, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur4 );","col += texture2D( tDiffuse, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur4 );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur4 );","gl_FragColor = col / 41.0;","gl_FragColor.a = 1.0;","}"].join("\n")};i.qL.print("creating bokeh for: ",e),this.mMaterial=new THREE.ShaderMaterial(e)}},{key:"getMeta",value:function(){return p.EffectMeta}},{key:"discard",value:function(){}},{key:"dispose",value:function(){this.mScene.remove(this.mQuad),this.mScene.remove(this.mCamera),this.mMaterial.dispose(),this.mQuad.geometry.dispose(),this.mQuad=null,this.mScene=null,this.mCamera=null,this.mMaterial=null}},{key:"render",value:function(e,t,n,r){this.mQuad.material=this.mMaterial,(0,o.isNullOrUndefined)(r)?e.render(this.mScene,this.mCamera):(e.setRenderTarget(r),e.clear(!0,!0,!1),e.render(this.mScene,this.mCamera),e.setRenderTarget(null))}},{key:"setAttribute",value:function(e,t){return!1}},{key:"setDefine",value:function(e,t){return!1}},{key:"setUniform",value:function(e,t){switch(e){case"focus":case"aperture":case"maxblur":case"aspect":case"nearClip":case"farClip":return this.mMaterial.uniforms[e].value=parseFloat(t),this.mMaterial.needsUpdate=!0,!0;case"tDiffuse":case"tPosition":return this.mMaterial.uniforms[e].value=t,this.mMaterial.needsUpdate=!0,!0;default:this.mMaterial.uniforms[e].value=t}return!1}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),p}(r.c);f.EffectMeta={type:"Bokeh",uniforms:[{name:"tDiffuse",type:"render_texture"},{type:"render_texture",name:"tPosition"},{type:"render_texture_texel",name:"TexelSize"},{name:"focus",type:"float",value:1},{name:"aperture",type:"float",value:.025},{name:"maxblur",type:"float",value:1},{name:"aspect",type:"camera_aspect"},{type:"camera_near",name:"nearClip"},{type:"camera_far",name:"farClip"}]}},49782:function(e,t,n){"use strict";n.d(t,{f:function(){return f}}),n(69600),n(54678),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(86835),o=n(89539),i=n(41142);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function s(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(p,e);var t,n,r,a,f=(r=p,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=l(r);if(a){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return s(this,e)});function p(e,t,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),f.call(this,e,t,n)}return t=p,(n=[{key:"createEffect",value:function(){this.mCamera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),this.mScene=new THREE.Scene,this.recreateMaterial(),this.mQuad=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),null),this.mQuad.frustumCulled=!1,this.mScene.add(this.mQuad)}},{key:"recreateMaterial",value:function(){(0,o.isNullOrUndefined)(this.mMaterial)||this.mMaterial.dispose();var e={defines:{},uniforms:{tDiffuse:{value:null},tPosition:{value:null},TexelSize:{value:new THREE.Vector2(1/this.mRenderWidth,1/this.mRenderHeight)},focusDistance:{value:this.mModel.uniforms.focusDistance.value},focusRange:{value:this.mModel.uniforms.focusRange.value},focusStop:{value:this.mModel.uniforms.focusStop.value},maxblur:{value:(0,o.isNullOrUndefined)(this.mModel.uniforms.maxblur)?.025:this.mModel.uniforms.maxblur.value},aspect:{value:1},nearClip:{value:.1},farClip:{value:1e3}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","varying vec2 vUv;","uniform sampler2D tDiffuse;","uniform sampler2D tPosition;","uniform vec2 TexelSize;","uniform float focusDistance;","uniform float focusRange;","uniform float focusStop;","uniform float maxblur;","uniform float nearClip;","uniform float farClip;","uniform float aspect;","#include <packing>","float reconstructDepth(vec2 uv){"," vec4 sampleDepth = texture2D(tPosition, uv);"," return unpackRGBAToDepth(sampleDepth);","}","void main() {","float depth = reconstructDepth( vUv ) * (farClip - nearClip);","float coc = (depth - focusDistance) / max(focusRange, 1.0);","coc = clamp(coc, -1.0, 1.0);","if (coc < 0.0) {"," coc *= -clamp(focusStop, 0.0, 1.0);","}"," vec4 col = vec4( 0.0 );","vec2 aspectcorrect = vec2( 1.0, aspect );","vec2 dofblur = TexelSize*(maxblur)*coc;","vec2 dofblur9 = dofblur * 0.9;","vec2 dofblur7 = dofblur * 0.7;","vec2 dofblur4 = dofblur * 0.4;","col += texture2D( tDiffuse, vUv.xy );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur );","col += texture2D( tDiffuse, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur );","col += texture2D( tDiffuse, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur );","col += texture2D( tDiffuse, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur );","col += texture2D( tDiffuse, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur );","col += texture2D( tDiffuse, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur );","col += texture2D( tDiffuse, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur );","col += texture2D( tDiffuse, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tDiffuse, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tDiffuse, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tDiffuse, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tDiffuse, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur9 );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur7 );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur7 );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur7 );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur7 );","col += texture2D( tDiffuse, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur7 );","col += texture2D( tDiffuse, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur7 );","col += texture2D( tDiffuse, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur7 );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur7 );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur4 );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.4,   0.0  ) * aspectcorrect ) * dofblur4 );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur4 );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur4 );","col += texture2D( tDiffuse, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur4 );","col += texture2D( tDiffuse, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur4 );","col += texture2D( tDiffuse, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur4 );","col += texture2D( tDiffuse, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur4 );"," gl_FragColor = (col / 41.0);"," gl_FragColor.a = 1.0;","}"].join("\n")};i.qL.print("creating Bokeh2 for: ",e),this.mMaterial=new THREE.ShaderMaterial(e)}},{key:"getMeta",value:function(){return p.EffectMeta}},{key:"discard",value:function(){}},{key:"dispose",value:function(){this.mScene.remove(this.mQuad),this.mScene.remove(this.mCamera),this.mMaterial.dispose(),this.mQuad.geometry.dispose(),this.mQuad=null,this.mScene=null,this.mCamera=null,this.mMaterial=null}},{key:"render",value:function(e,t,n,r){this.mQuad.material=this.mMaterial,(0,o.isNullOrUndefined)(r)?e.render(this.mScene,this.mCamera):(e.setRenderTarget(r),e.clear(!0,!0,!1),e.render(this.mScene,this.mCamera),e.setRenderTarget(null))}},{key:"setAttribute",value:function(e,t){return!1}},{key:"setDefine",value:function(e,t){return!1}},{key:"setUniform",value:function(e,t){switch(e){case"focusDistance":case"focusRange":case"focusStop":case"maxblur":case"farClip":case"nearClip":case"aspect":return this.mMaterial.uniforms[e].value=parseFloat(t),this.mMaterial.needsUpdate=!0,!0;case"tDiffuse":case"tPosition":return this.mMaterial.uniforms[e].value=t,this.mMaterial.needsUpdate=!0,!0;default:this.mMaterial.uniforms[e].value=t}return!1}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),p}(r.c);f.EffectMeta={type:"Bokeh2",uniforms:[{name:"tDiffuse",type:"render_texture"},{type:"render_texture",name:"tPosition"},{type:"render_texture_texel",name:"TexelSize"},{name:"focusDistance",type:"float",value:5},{name:"focusRange",type:"float",value:8},{name:"focusStop",type:"float",value:1},{name:"maxblur",type:"float",value:10},{name:"aspect",type:"camera_aspect"},{type:"camera_near",name:"nearClip"},{type:"camera_far",name:"farClip"}]}},49848:function(e,t,n){"use strict";n.d(t,{H:function(){return f}}),n(69600),n(54678),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(86835),o=n(89539),i=n(41142);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function s(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(p,e);var t,n,r,a,f=(r=p,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=l(r);if(a){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return s(this,e)});function p(e,t,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),f.call(this,e,t,n)}return t=p,(n=[{key:"createEffect",value:function(){this.mCamera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),this.mScene=new THREE.Scene,this.recreateMaterial(),this.mQuad=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),null),this.mQuad.frustumCulled=!1,this.mScene.add(this.mQuad)}},{key:"recreateMaterial",value:function(){(0,o.isNullOrUndefined)(this.mMaterial)||this.mMaterial.dispose();var e={defines:{},uniforms:{tDiffuse:{value:null},gamma:{value:(0,o.isNullOrUndefined)(this.mModel.uniforms.gamma)?1:this.mModel.uniforms.gamma.value},brightness:{value:(0,o.isNullOrUndefined)(this.mModel.uniforms.brightness)?0:this.mModel.uniforms.brightness.value},contrast:{value:(0,o.isNullOrUndefined)(this.mModel.uniforms.contrast)?1:this.mModel.uniforms.contrast.value},hue:{value:(0,o.isNullOrUndefined)(this.mModel.uniforms.hue)?0:this.mModel.uniforms.hue.value},saturation:{value:(0,o.isNullOrUndefined)(this.mModel.uniforms.saturation)?0:this.mModel.uniforms.saturation.value}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float gamma;","uniform float brightness;","uniform float contrast;","uniform float hue;","uniform float saturation;","varying vec2 vUv;","void main() {","vec4 fragmentColor = texture2D(tDiffuse, vUv);","fragmentColor.rgb = vec3(pow(abs(fragmentColor.r), gamma),pow(abs(fragmentColor.g), gamma),pow(abs(fragmentColor.b), gamma));","float angle = hue * 3.14159265;","float s = sin(angle), c = cos(angle);","vec3 weights = (vec3(2.0 * c, -sqrt(3.0) * s - c, sqrt(3.0) * s - c) + 1.0) / 3.0;","float len = length(fragmentColor.rgb);","fragmentColor.rgb = vec3(","dot(fragmentColor.rgb, weights.xyz),","dot(fragmentColor.rgb, weights.zxy),","dot(fragmentColor.rgb, weights.yzx)",");","float average = (fragmentColor.r + fragmentColor.g + fragmentColor.b) / 3.0;","if (saturation > 0.0) {","fragmentColor.rgb += (average - fragmentColor.rgb) * (1.0 - 1.0 / (1.001 - saturation));","} else {","fragmentColor.rgb += (average - fragmentColor.rgb) * (-saturation);","}","fragmentColor.rgb = (fragmentColor.rgb - 0.5) * contrast + 0.5 + brightness;","gl_FragColor = fragmentColor;","}"].join("\n")};i.qL.print("creating color correction for: ",e.defines),this.mMaterial=new THREE.ShaderMaterial(e)}},{key:"getMeta",value:function(){return p.EffectMeta}},{key:"discard",value:function(){}},{key:"dispose",value:function(){this.mScene.remove(this.mQuad),this.mScene.remove(this.mCamera),this.mMaterial.dispose(),this.mQuad.geometry.dispose(),this.mQuad=null,this.mScene=null,this.mCamera=null,this.mMaterial=null}},{key:"render",value:function(e,t,n,r){this.mQuad.material=this.mMaterial,(0,o.isNullOrUndefined)(r)?e.render(this.mScene,this.mCamera):(e.setRenderTarget(r),e.clear(!0,!0,!1),e.render(this.mScene,this.mCamera),e.setRenderTarget(null))}},{key:"setAttribute",value:function(e,t){return!1}},{key:"setDefine",value:function(e,t){return!1}},{key:"setUniform",value:function(e,t){switch(e){case"gamma":case"brightness":case"contrast":case"hue":case"saturation":return this.mMaterial.uniforms[e].value=parseFloat(t),this.mMaterial.needsUpdate=!0,!0;case"tDiffuse":return this.mMaterial.uniforms[e].value=t,this.mMaterial.needsUpdate=!0,!0}return!1}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),p}(r.c);f.EffectMeta={type:"ColorCorrection",uniforms:[{name:"tDiffuse",value:null,type:"render_texture"},{name:"gamma",type:"float",value:1},{name:"brightness",type:"float",value:0},{name:"contrast",type:"float",value:1},{name:"hue",type:"float",value:0},{name:"saturation",type:"float",value:0}]}},1025:function(e,t,n){"use strict";n.d(t,{q:function(){return l}}),n(69600),n(54678),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(86835),o=n(89539);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function c(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(f,e);var t,n,r,i,l=(r=f,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=s(r);if(i){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return c(this,e)});function f(e,t,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),l.call(this,e,t,n)}return t=f,(n=[{key:"createEffect",value:function(){this.mMaterial=new THREE.ShaderMaterial({uniforms:{Far:{value:100}},vertexShader:["varying float vDepth;","void main() {","vec4 modelPosition = modelViewMatrix * vec4( position, 1.0 );","vDepth =  -modelPosition.z;","gl_Position = projectionMatrix * modelPosition;","}"].join("\n"),fragmentShader:["vec4 PackFloatToRGBA( float aValue ){","vec4 _bitSh = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);","vec4 _bitMsk = vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);","vec4 _pack = fract(aValue * _bitSh);","_pack -= _pack.xxyz * _bitMsk;","return _pack;","}","#include <packing>","varying float vDepth;","uniform float Far;","void main (){","gl_FragColor = packDepthToRGBA(vDepth/Far);","}"].join("\n")}),this.mMaterial.blending=THREE.NoBlending,this.mMaterial.depthPacking=THREE.RGBADepthPacking}},{key:"getMeta",value:function(){return f.EffectMeta}},{key:"dispose",value:function(){this.mMaterial.dispose()}},{key:"render",value:function(e,t,n,r){var i=t.overrideMaterial;t.overrideMaterial=this.mMaterial;var a=n.layers.mask;n.layers.set(2),(0,o.isNullOrUndefined)(r)?e.render(t,n):(e.setRenderTarget(r),e.clear(!0,!0,!1),e.render(t,n),e.setRenderTarget(null)),n.layers.mask=a,t.overrideMaterial=i}},{key:"discard",value:function(){}},{key:"setUniform",value:function(e,t){if("Far"===e){var n=parseFloat(t);return isNaN(n)&&console.warn("Given post depth effect Far uniform is not float."),this.mMaterial.uniforms.Far.value=parseFloat(t),this.mMaterial.needsUpdate=!0,!0}return!1}},{key:"setDefine",value:function(e,t){return!1}},{key:"setAttribute",value:function(e,t){return!1}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(r.c);l.EffectMeta={type:"DepthRender",uniforms:[{type:"camera_far",name:"Far"}]}},46538:function(e,t,n){"use strict";n(69070),n(21703),n(1025),n(23346),n(87411),n(94753),n(11342),n(82924),n(36588),n(17876),n(49848),n(96658),n(96788),n(49782),n(26744),n(4297)},17876:function(e,t,n){"use strict";n.d(t,{G:function(){return f}}),n(91058),n(69600),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(86835),o=n(89539),i=n(41142);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function s(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(p,e);var t,n,r,a,f=(r=p,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=l(r);if(a){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return s(this,e)});function p(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),(r=f.call(this,e,t,n)).mRenderResolution=2,r.mRenderStep=0,r.mReady=!1,r.mRenderResolution=parseInt(e.attributes.resolution.value,10),r.mRenderResolution=isNaN(r.mRenderResolution)?2:r.mRenderResolution,r}return t=p,(n=[{key:"createEffect",value:function(){this.mOrthoCamera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),this.mPerspectiveCamera=new THREE.PerspectiveCamera(60,1,.01,1e3),this.mScene=new THREE.Scene,this.recreateMaterial(),this.mQuad=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),this.mMaterial),this.mQuad.frustumCulled=!1,this.mScene.add(this.mQuad)}},{key:"recreateMaterial",value:function(){(0,o.isNullOrUndefined)(this.mMaterial)||this.mMaterial.dispose();var e={defines:{},uniforms:{tDiffuse:{value:null},texSize:{value:new THREE.Vector2(1,1)}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec2 texSize;","uniform int boxSize;","varying vec2 vUv;","float BSpline( float x )","{"," float f = x;"," if( f < 0.0 )"," {","   f = -f;"," }"," if( f >= 0.0 && f <= 1.0 )"," {","   return ( 2.0 / 3.0 ) + ( 0.5 ) * ( f* f * f ) - (f*f);"," }","   else if( f > 1.0 && f <= 2.0 )"," {","   return 1.0 / 6.0 * pow( ( 2.0 - f  ), 3.0 );"," }"," return 1.0;","}","float CatMullRom( float x )","{","  const float B = 0.0;","  const float C = 0.5;","  float f = x;","  if( f < 0.0 )","  {","    f = -f;","  }","  if( f < 1.0 )","  {","    return ( ( 12.0 - 9.0 * B - 6.0 * C ) * ( f * f * f ) +","      ( -18.0 + 12.0 * B + 6.0 *C ) * ( f * f ) +","      ( 6.0 - 2.0 * B ) ) / 6.0;","  }","  else if( f >= 1.0 && f < 2.0 )","  {","    return ( ( -B - 6.0 * C ) * ( f * f * f )","      + ( 6.0 * B + 30.0 * C ) * ( f *f ) +","      ( - ( 12.0 * B ) - 48.0 * C  ) * f +","      8.0 * B + 24.0 * C)/ 6.0;","  }","  else","  {","    return 0.0;","  }","}","\n        float BellFunc( float x )\n        {\n          float f = ( x / 2.0 ) * 1.5; // Converting -2 to +2 to -1.5 to +1.5\n          if( f > -1.5 && f < -0.5 )\n          {\n            return( 0.5 * pow(f + 1.5, 2.0));\n          }\n          else if( f > -0.5 && f < 0.5 )\n          {\n            return 3.0 / 4.0 - ( f * f );\n          }\n          else if( ( f > 0.5 && f < 1.5 ) )\n          {\n            return( 0.5 * pow(f - 1.5, 2.0));\n          }\n          return 0.0;\n        }\n        ","vec4 BiCubic( sampler2D textureSampler, vec2 TexCoord )","{"," float texelSizeX = 1.0 / texSize.x; //size of one texel "," float texelSizeY = 1.0 / texSize.y; //size of one texel "," vec4 nSum = vec4( 0.0, 0.0, 0.0, 0.0 );"," vec4 nDenom = vec4( 0.0, 0.0, 0.0, 0.0 );"," float a = fract( TexCoord.x * texSize.x ); // get the decimal part"," float b = fract( TexCoord.y * texSize.y ); // get the decimal part"," for( int m = LEFT_PIXEL; m <= RIGHT_PIXEL; m++ )"," {","  for( int n =LEFT_PIXEL; n <= RIGHT_PIXEL; n++)","   {","     vec4 vecData = texture2D(textureSampler,","     TexCoord + vec2(texelSizeX * (float( m )),","     texelSizeY * (float( n ))));","#if defined(FUNC_CatMullRom)","     float f  = CatMullRom( float( m ) - a );","#elif defined(FUNC_BellFunc)","     float f  = BellFunc( float( m ) - a );","#elif defined(FUNC_Box)","     float f  = 1.0;","#else ","     float f  = BSpline( float( m ) - a );","#endif","     vec4 vecCooef1 = vec4( f,f,f,f );","#if defined(FUNC_CatMullRom)","     float f1 = CatMullRom ( -( float( n ) - b ) );","#elif defined(FUNC_BellFunc)","     float f1 = BellFunc ( -( float( n ) - b ) );","#elif defined(FUNC_Box)","     float f1  = 1.0;","#else ","     float f1 = BSpline ( -( float( n ) - b ) );","#endif","     vec4 vecCoeef2 = vec4( f1, f1, f1, f1 );","     nSum = nSum + ( vecData * vecCoeef2 * vecCooef1  );","     nDenom = nDenom + (( vecCoeef2 * vecCooef1 ));","   }"," }"," return nSum / nDenom;","}","void main() {","gl_FragColor = vec4( BiCubic(tDiffuse, vUv).xyz, 1.0);","}"].join("\n")},t=(0,o.isNullOrUndefined)(this.mModel.attributes.function)?"BSpline":this.mModel.attributes.function.value;e.defines["FUNC_"+t]=!0;var n=(0,o.isNullOrUndefined)(this.mModel.attributes.resolution)?1:parseInt(this.mModel.attributes.resolution.value,10)/2;e.defines.LEFT_PIXEL=-n,e.defines.RIGHT_PIXEL=n+1,i.qL.print("building material: ",e),this.mMaterial=new THREE.ShaderMaterial(e),(0,o.isNullOrUndefined)(this.mQuad)||(this.mQuad.material=this.mMaterial)}},{key:"dispose",value:function(){this.mScene.remove(this.mQuad),this.mScene.remove(this.mOrthoCamera),this.mScene.remove(this.mPerspectiveCamera),this.mMaterial.dispose(),this.mQuad.geometry.dispose(),this.mQuad=null,this.mScene=null,this.mPerspectiveCamera=null,this.mOrthoCamera=null,this.mMaterial=null}},{key:"getMeta",value:function(){return p.EffectMeta}},{key:"ready",value:function(){return this.mReady}},{key:"updateRender",value:function(e,t,n,r){if((0,o.isNullOrUndefined)(this.mRenderTarget))this.mReady=!0;else{if(0===this.mRenderStep)if(this.mRenderer=e,this.mExpandSize=new THREE.Vector2,this.mMultiViewPosition=new THREE.Vector2,this.mTargetViewPosition=new THREE.Vector2,this.mPrevHStep=0,this.mPPrevHStep=-1,(0,o.isNullOrUndefined)(r)){var i=e.getSize();this.mRendererPrevWidth=i.width,this.mRendererPrevHeight=i.height}else this.mRendererTarget=r,this.mRendererPrevWidth=this.mRendererTarget.width,this.mRendererPrevHeight=this.mRendererTarget.height;var a=this.mRendererPrevWidth,u=this.mRendererPrevHeight,c=a/this.mRenderResolution,s=u/this.mRenderResolution,l=c-Math.floor(c),f=s-Math.floor(s);c-=l,s-=f;var p=this.mRenderResolution*this.mRenderResolution,d=this.mRenderStep/this.mRenderResolution,h=Math.floor(d),y=(d-h)*this.mRenderResolution;this.mExpandSize.x+=l;var m=!1;this.mPPrevHStep!==h&&(m=!0,this.mPPrevHStep=h,this.mExpandSize.y+=f);var v=this.mRenderTarget.width*this.mRenderResolution,b=this.mRenderTarget.height*this.mRenderResolution,g=this.mRenderTarget.width,w=this.mRenderTarget.height;y===this.mRenderResolution-1?g+=this.mExpandSize.x:g-=l,h===this.mRenderResolution-1?w+=this.mExpandSize.y:w-=f;var _=!1;this.mPrevHStep!==h&&(_=!0,this.mPrevHStep=h,this.mMultiViewPosition.y+=this.mRenderTarget.height-f),this.mPerspectiveCamera.copy(n),this.mPerspectiveCamera.layers.set(0),this.mPerspectiveCamera.layers.enable(1),this.mPerspectiveCamera.clearViewOffset(),this.mPerspectiveCamera.setViewOffset(v,b,this.mMultiViewPosition.x,this.mMultiViewPosition.y,g,w),this.mPerspectiveCamera.updateProjectionMatrix(),e.setRenderTarget(this.mRenderTarget),e.clear(!1,!0,!1),e.render(t,this.mPerspectiveCamera),e.setRenderTarget(null),y===this.mRenderResolution-1?this.mMultiViewPosition.x=0:this.mMultiViewPosition.x+=this.mRenderTarget.width-l;var O=c,T=s;y===this.mRenderResolution-1&&(O+=this.mExpandSize.x,this.mExpandSize.x=0),h===this.mRenderResolution-1&&(T+=this.mExpandSize.y),this.mMaterial.uniforms.tDiffuse.value=this.mRenderTarget.texture,this.mMaterial.uniforms.texSize.value=new THREE.Vector2(this.mRenderTarget.width,this.mRenderTarget.height),(0,o.isNullOrUndefined)(this.mRendererTarget)?(_&&(this.mTargetViewPosition.y+=T),e.setViewport(this.mTargetViewPosition.x,this.mTargetViewPosition.y,O,T),e.setScissor(this.mTargetViewPosition.x,this.mTargetViewPosition.y,O,T),e.setScissorTest(!0),e.clear(!1,!0,!0),e.render(this.mScene,this.mOrthoCamera)):(m&&(this.mTargetViewPosition.y+=T),this.mRendererTarget.viewport=new THREE.Vector4(this.mTargetViewPosition.x,this.mRendererPrevHeight-this.mTargetViewPosition.y,O,T),this.mRendererTarget.scissor=new THREE.Vector4(this.mTargetViewPosition.x,this.mRendererPrevHeight-this.mTargetViewPosition.y,O,T),this.mRendererTarget.scissorTest=!0,e.setRenderTarget(r),e.clear(!0,!0,!0),e.render(this.mScene,this.mOrthoCamera),e.setRenderTarget(null)),y===this.mRenderResolution-1?this.mTargetViewPosition.x=0:this.mTargetViewPosition.x+=O,this.resetViewports(),++this.mRenderStep>=p&&(this.discard(),this.mReady=!0)}}},{key:"render",value:function(e,t,n,r){if(this.discard(),(0,o.isNullOrUndefined)(this.mRenderTarget)){var i=n.layers.mask;n.layers.set(0),n.layers.enable(1),(0,o.isNullOrUndefined)(r)?e.render(t,n):(e.setRenderTarget(r),e.clear(!0,!0,!1),e.render(t,n),e.setRenderTarget(null)),n.layers.mask=i}}},{key:"discard",value:function(){this.resetViewports(),this.mReady=!1,this.mRenderStep=0,this.mRendererTarget=null,this.mRenderer=null,this.mExpandSize=new THREE.Vector2,this.mMultiViewPosition=new THREE.Vector2,this.mTargetViewPosition=new THREE.Vector2,this.mPrevHStep=0,this.mPPrevHStep=-1}},{key:"resetViewports",value:function(){(0,o.isNullOrUndefined)(this.mRenderer)||((0,o.isNullOrUndefined)(this.mRendererTarget)?(this.mRenderer.setViewport(0,0,this.mRendererPrevWidth,this.mRendererPrevHeight),this.mRenderer.setScissor(0,0,this.mRendererPrevWidth,this.mRendererPrevHeight),this.mRenderer.setScissorTest(!1)):(this.mRendererTarget.viewport=new THREE.Vector4(0,0,this.mRendererPrevWidth,this.mRendererPrevHeight),this.mRendererTarget.scissor=new THREE.Vector4(0,0,this.mRendererPrevWidth,this.mRendererPrevHeight),this.mRendererTarget.scissorTest=!1))}},{key:"setUniform",value:function(e,t){return"tRenderTarget"===e&&(this.mRenderTarget=t,!0)}},{key:"setDefine",value:function(e,t){return!1}},{key:"setAttribute",value:function(e,t){switch(i.qL.print("set attribute: ",e,"to",t),e){case"resolution":return this.mRenderResolution=parseInt(t,10),i.qL.print("Change resolution on model: ",this.mModel),this.recreateMaterial(),!0;case"function":return i.qL.print("Change function on model: ",this.mModel),this.recreateMaterial(),!0}return!1}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),p}(r.c);f.EffectMeta={type:"HighResRender",uniforms:[{name:"tRenderTarget",value:null,type:"render_target"}],attributes:[{name:"resolution",type:"selection",value:"2",options:"2|4"},{name:"function",type:"selection",value:"BSpline",options:"BSpline|CatMullRom|BellFunc|Box"}]}},23346:function(e,t,n){"use strict";n.d(t,{H:function(){return l}}),n(69600),n(54678),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(86835),o=n(89539);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function c(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(f,e);var t,n,r,i,l=(r=f,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=s(r);if(i){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return c(this,e)});function f(e,t,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),l.call(this,e,t,n)}return t=f,(n=[{key:"createEffect",value:function(){this.mMaterial=new THREE.ShaderMaterial({uniforms:{ssreflection:{value:0}},vertexShader:["varying vec3 vNormal;","void main() {","vNormal = (normalMatrix * normal).xyz;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float ssreflection;","varying vec3 vNormal;","void main (){","vec3 normalOut = normalize(vNormal);","gl_FragColor = vec4((normalOut*0.5) + vec3(0.5, 0.5, 0.5), ssreflection);","}"].join("\n")}),this.mMaterial.blending=THREE.NoBlending,this.mMaterial.depthPacking=THREE.RGBADepthPacking}},{key:"dispose",value:function(){this.mMaterial.dispose()}},{key:"getMeta",value:function(){return f.EffectMeta}},{key:"render",value:function(e,t,n,r){var i=t.overrideMaterial;t.overrideMaterial=this.mMaterial;var a=n.layers.mask;n.layers.set(3),(0,o.isNullOrUndefined)(r)?e.render(t,n):(e.setRenderTarget(r),e.clear(!0,!0,!1),e.render(t,n),e.setRenderTarget(null)),n.layers.mask=a,t.overrideMaterial=i}},{key:"discard",value:function(){}},{key:"setUniform",value:function(e,t){return"ssreflection"===e&&(this.mMaterial.uniforms.ssreflection.value=parseFloat(t),this.mMaterial.needsUpdate=!0,!0)}},{key:"setDefine",value:function(e,t){return!1}},{key:"setAttribute",value:function(e,t){return!1}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(r.c);l.EffectMeta={type:"NormalRender",uniforms:[{type:"float",name:"ssreflection",value:0}]}},94753:function(e,t,n){"use strict";n.d(t,{Y:function(){return l}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(86835),o=n(89539);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function c(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(f,e);var t,n,r,i,l=(r=f,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=s(r);if(i){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return c(this,e)});function f(e,t,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),l.call(this,e,t,n)}return t=f,(n=[{key:"createEffect",value:function(){}},{key:"dispose",value:function(){}},{key:"render",value:function(e,t,n,r){var i=n.layers.mask;n.layers.set(0),n.layers.enable(1),(0,o.isNullOrUndefined)(r)?e.render(t,n):(e.setRenderTarget(r),e.clear(!0,!0,!1),e.render(t,n),e.setRenderTarget(null)),n.layers.mask=i}},{key:"discard",value:function(){}},{key:"setUniform",value:function(e,t){return!1}},{key:"setDefine",value:function(e,t){return!1}},{key:"setAttribute",value:function(e,t){return!1}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(r.c);l.EffectMeta={type:"RenderPass"}},26744:function(e,t,n){"use strict";n.d(t,{P:function(){return f}}),n(91058),n(69600),n(74916),n(15306),n(21249),n(57640),n(9924),n(60086),n(54678),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(86835),o=n(89539),i=n(41142);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function s(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(p,e);var t,n,r,a,f=(r=p,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=l(r);if(a){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return s(this,e)});function p(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),(r=f.call(this,e,t,n)).lights={},r.mCurrentLightState=null,r}return t=p,(n=[{key:"createEffect",value:function(){this.mUniformCache={},this.mCamera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),this.mScene=new THREE.Scene,this.mQuad=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),null),this.mQuad.frustumCulled=!1,this.mScene.add(this.mQuad)}},{key:"recreateMaterial",value:function(){if(!(0,o.isNullOrUndefined)(this.mCurrentLightState)){(0,o.isNullOrUndefined)(this.mMaterial)||this.mMaterial.dispose();var e=THREE.UniformsUtils.merge([THREE.UniformsLib.lights,{tDiffuse:{value:(0,o.isNullOrUndefined)(this.mUniformCache.tDiffuse)?null:this.mUniformCache.tDiffuse},tPosition:{value:(0,o.isNullOrUndefined)(this.mUniformCache.tPosition)?null:this.mUniformCache.tPosition},tNormal:{value:(0,o.isNullOrUndefined)(this.mUniformCache.tNormal)?null:this.mUniformCache.tNormal},sNoise:{value:(0,o.isNullOrUndefined)(this.mUniformCache.sNoise)?null:this.mUniformCache.sNoise},TexelSize:{value:(0,o.isNullOrUndefined)(this.mUniformCache.TexelSize)?new THREE.Vector2(1/this.mRenderWidth,1/this.mRenderHeight):this.mUniformCache.TexelSize},SamplingRadius:{value:(0,o.isNullOrUndefined)(this.mModel.uniforms.SamplingRadius)?4:this.mModel.uniforms.SamplingRadius.value},CameraFar:{value:(0,o.isNullOrUndefined)(this.mUniformCache.CameraFar)?100:this.mUniformCache.CameraFar},CameraNear:{value:(0,o.isNullOrUndefined)(this.mUniformCache.CameraNear)?1:this.mUniformCache.CameraNear},CameraFov:{value:(0,o.isNullOrUndefined)(this.mUniformCache.CameraFov)?45:this.mUniformCache.CameraFov},RightTop:{value:(0,o.isNullOrUndefined)(this.mUniformCache.RightTop)?new THREE.Vector2:this.mUniformCache.RightTop},uIntensity:{value:(0,o.isNullOrUndefined)(this.mModel.uniforms.uIntensity)?1:this.mModel.uniforms.uIntensity.value},viewInverseMatrix:{value:(0,o.isNullOrUndefined)(this.mUniformCache.viewInverseMatrix)?new THREE.Matrix4:this.mUniformCache.viewInverseMatrix},projScale:{value:(0,o.isNullOrUndefined)(this.mUniformCache.projScale)?500:this.mUniformCache.projScale}}]),t={defines:{RE_Direct:!0,NUM_SAMPLES:(0,o.isNullOrUndefined)(this.mModel.defines.NUM_SAMPLES)?12:parseInt(this.mModel.defines.NUM_SAMPLES.value,10),NUM_SPIRAL_TURNS:(0,o.isNullOrUndefined)(this.mModel.defines.NUM_SPIRAL_TURNS)?5:parseInt(this.mModel.defines.NUM_SPIRAL_TURNS.value,10)},uniforms:e,vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","vec4 modelViewProjPosition = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","gl_Position = modelViewProjPosition;","}"].join("\n"),fragmentShader:["#include <common>","#include <packing>","uniform sampler2D tDiffuse;","uniform sampler2D sNoise;","uniform sampler2D tPosition;","uniform sampler2D tNormal;","uniform float SamplingRadius;","uniform vec2 TexelSize;","uniform float CameraFar;","uniform float CameraNear;","uniform float CameraFov;","uniform vec2 RightTop;","uniform float uIntensity;","uniform mat4 viewInverseMatrix;","uniform float projScale;","varying vec2 vUv;","\n        //shadow matrices\n        #ifdef USE_SHADOWMAP\n          #if NUM_DIR_LIGHTS > 0\n            uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n          #endif\n        \n          #if NUM_SPOT_LIGHTS > 0\n            uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n          #endif\n          \n          #if NUM_POINT_LIGHTS > 0\n            uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n          #endif\n        #endif\n        ","\n        //light pars\n        uniform vec3 ambientLightColor;\n        \n        #if NUM_DIR_LIGHTS > 0\n          struct DirectionalLight {\n            vec3 direction;\n            vec3 color;\n        \n            int shadow;\n            float shadowBias;\n            float shadowRadius;\n            vec2 shadowMapSize;\n          };\n        \n          uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n        #endif\n        \n        #if NUM_POINT_LIGHTS > 0\n          struct PointLight {\n            vec3 position;\n            vec3 color;\n            float distance;\n            float decay;\n        \n            int shadow;\n            float shadowBias;\n            float shadowRadius;\n            vec2 shadowMapSize;\n            float shadowCameraNear;\n            float shadowCameraFar;\n          };\n        \n          uniform PointLight pointLights[ NUM_POINT_LIGHTS ];        \n        #endif\n        \n        #if NUM_SPOT_LIGHTS > 0\n          struct SpotLight {\n            vec3 position;\n            vec3 direction;\n            vec3 color;\n            float distance;\n            float decay;\n            float coneCos;\n            float penumbraCos;\n        \n            int shadow;\n            float shadowBias;\n            float shadowRadius;\n            vec2 shadowMapSize;\n          };\n        \n          uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n        #endif\n        \n        #if NUM_RECT_AREA_LIGHTS > 0\n          struct RectAreaLight {\n            vec3 color;\n            vec3 position;\n            vec3 halfWidth;\n            vec3 halfHeight;\n          };\n        \n          // Pre-computed values of LinearTransformedCosine approximation of BRDF\n          // BRDF approximation Texture is 64x64\n          uniform sampler2D ltc_1; // RGBA Float\n          uniform sampler2D ltc_2; // RGBA Float\n        \n          uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n        #endif\n        \n        #if NUM_HEMI_LIGHTS > 0\n          struct HemisphereLight {\n            vec3 direction;\n            vec3 skyColor;\n            vec3 groundColor;\n          };\n        \n          uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n        #endif\n        ","\n        //shadow map\n        #ifdef USE_SHADOWMAP\n          #if NUM_DIR_LIGHTS > 0\n            uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n          #endif\n        \n          #if NUM_SPOT_LIGHTS > 0\n            uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n          #endif\n          \n          #if NUM_POINT_LIGHTS > 0\n            uniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n          #endif\n        \n          float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n            return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n          }\n        \n          float texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n            const vec2 offset = vec2( 0.0, 1.0 );\n        \n            vec2 texelSize = vec2( 1.0 ) / size;\n            vec2 centroidUV = floor( uv * size + 0.5 ) / size;\n        \n            float lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n            float lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n            float rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n            float rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n        \n            vec2 f = fract( uv * size + 0.5 );\n        \n            float a = mix( lb, lt, f.y );\n            float b = mix( rb, rt, f.y );\n            float c = mix( a, b, f.x );\n        \n            return c;\n          }\n        \n          float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n            float shadow = 1.0;\n        \n            shadowCoord.xyz /= shadowCoord.w;\n            shadowCoord.z += shadowBias;\n        \n            // if ( something && something ) breaks ATI OpenGL shader compiler\n            // if ( all( something, something ) ) using this instead\n        \n            bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n            bool inFrustum = all( inFrustumVec );\n        \n            bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n        \n            bool frustumTest = all( frustumTestVec );\n        \n            if ( frustumTest ) {\n            #if defined( SHADOWMAP_TYPE_PCF )\n        \n              vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n        \n              float dx0 = - texelSize.x * shadowRadius;\n              float dy0 = - texelSize.y * shadowRadius;\n              float dx1 = + texelSize.x * shadowRadius;\n              float dy1 = + texelSize.y * shadowRadius;\n        \n              shadow = (\n                texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n                texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n                texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n                texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n                texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n                texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n                texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n                texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n                texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n              ) * ( 1.0 / 9.0 );\n        \n            #elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n        \n              vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n        \n              float dx0 = - texelSize.x * shadowRadius;\n              float dy0 = - texelSize.y * shadowRadius;\n              float dx1 = + texelSize.x * shadowRadius;\n              float dy1 = + texelSize.y * shadowRadius;\n        \n              shadow = (\n                texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n                texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n                texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n                texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n                texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n                texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n                texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n                texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n                texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n              ) * ( 1.0 / 9.0 );\n        \n            #else // no percentage-closer filtering:\n        \n              shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n        \n            #endif\n            }\n        \n            return shadow;\n          }\n          \n          // cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D\n          // vector suitable for 2D texture mapping. This code uses the following layout for the\n          // 2D texture:\n          //\n          // xzXZ\n          //  y Y\n          //\n          // Y - Positive y direction\n          // y - Negative y direction\n          // X - Positive x direction\n          // x - Negative x direction\n          // Z - Positive z direction\n          // z - Negative z direction\n          //\n          // Source and test bed:\n          // https://gist.github.com/tschw/da10c43c467ce8afd0c4\n        \n          vec2 cubeToUV( vec3 v, float texelSizeY ) {\n            // Number of texels to avoid at the edge of each square\n        \n            vec3 absV = abs( v );\n        \n            // Intersect unit cube\n        \n            float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n            absV *= scaleToCube;\n        \n            // Apply scale to avoid seams\n        \n            // two texels less per square (one texel will do for NEAREST)\n            v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n        \n            // Unwrap\n        \n            // space: -1 ... 1 range for each square\n            //\n            // #X##\t\tdim    := ( 4 , 2 )\n            //  # #\t\tcenter := ( 1 , 1 )\n        \n            vec2 planar = v.xy;\n        \n            float almostATexel = 1.5 * texelSizeY;\n            float almostOne = 1.0 - almostATexel;\n        \n            if ( absV.z >= almostOne ) {\n        \n              if ( v.z > 0.0 )\n                planar.x = 4.0 - v.x;\n        \n            } else if ( absV.x >= almostOne ) {\n        \n              float signX = sign( v.x );\n              planar.x = v.z * signX + 2.0 * signX;\n        \n            } else if ( absV.y >= almostOne ) {\n        \n              float signY = sign( v.y );\n              planar.x = v.x + 2.0 * signY + 2.0;\n              planar.y = v.z * signY - 2.0;\n        \n            }\n        \n            // Transform to UV space\n        \n            // scale := 0.5 / dim\n            // translate := ( center + 0.5 ) / dim\n            return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n          }\n        \n          float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n            vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n        \n            // for point lights, the uniform @vShadowCoord is re-purposed to hold\n            // the vector from the light to the world-space position of the fragment.\n            vec3 lightToPosition = shadowCoord.xyz;\n        \n            // dp = normalized distance from light to fragment position\n            float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?\n            dp += shadowBias;\n        \n            // bd3D = base direction 3D\n            vec3 bd3D = normalize( lightToPosition );\n        \n            #if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n        \n              vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n        \n              return (\n                texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n                texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n                texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n                texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n                texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n                texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n                texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n                texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n                texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n              ) * ( 1.0 / 9.0 );\n        \n            #else // no percentage-closer filtering\n        \n              return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n        \n            #endif\n          }\n        #endif\n        ","vec3 reconstructPosition(vec2 uv){"," vec2 ndc = uv*2.0 - vec2(1.0, 1.0);"," vec4 sampleDepth = texture2D(tPosition, uv);"," float modelDepth = unpackRGBAToDepth(sampleDepth);"," vec2 pnear = ndc * RightTop;"," float pz = -modelDepth*CameraFar;"," return vec3(-pz*pnear.x / CameraNear, -pz*pnear.y / CameraNear, pz);","}","vec3 tapLocation(int sampleNumber, float spinAngle, out float radiusSS) {"," float alpha = (float(sampleNumber) + 0.5) * (1.0 / float(NUM_SAMPLES));"," float angle = alpha * (float(NUM_SPIRAL_TURNS) * 6.28) + spinAngle;"," radiusSS = alpha;"," return vec3(cos(angle), sin(angle), 1.0);","}","\n        vec3 LightFactor(vec4 neighborWP){\n          vec3 lightFactor = vec3(1.0, 1.0, 1.0);\n          // Spotlights: NUM_SPOT_LIGHTS\n          // Directionals: NUM_DIR_LIGHTS\n          // Points: NUM_POINT_LIGHTS\n          #if ( NUM_SPOT_LIGHTS > 0 )\n            SpotLight spotLight;\n            vec4 spotShadowCoord;\n            \n            #pragma unroll_loop\n            for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n              spotLight = spotLights[ i ];\n              \n              spotShadowCoord = spotShadowMatrix[ i ] * neighborWP;\n          \n              #ifdef USE_SHADOWMAP\n                lightFactor *= spotLight.color * (bool(spotLight.shadow) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, spotShadowCoord ) : 1.0);\n                //spotShadowCoord.xyz /= spotShadowCoord.w;\n                //float shadowDepth = unpackRGBAToDepth( texture2D( spotShadowMap[ i ], vUv ) );\n                //directLight.color = (spotShadowCoord.z+0.00001) > shadowDepth?vec3(0.0, 0.0, 0.0):vec3(1.0, 1.0, 1.0);\n                //directLight.color = vec3(shadowDepth, shadowDepth, shadowDepth);\n              #endif\n            }\n          #endif\n          \n          #if ( NUM_DIR_LIGHTS > 0 )\n            DirectionalLight directionalLight;\n            vec4 directionalShadowCoord;\n            \n            #pragma unroll_loop\n            for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n              directionalLight = directionalLights[ i ];\n              \n              directionalShadowCoord = directionalShadowMatrix[ i ] * neighborWP;\n              \n              #ifdef USE_SHADOWMAP\n                lightFactor *= directionalLight.color * (bool(directionalLight.shadow) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, directionalShadowCoord ) : 1.0);\n              #endif\n            }\n          #endif\n          \n          return lightFactor;\n        }\n        ","void main() {","vec3 originVS = reconstructPosition(vUv);","vec4 originWP = viewInverseMatrix * vec4(originVS, 1.0);","vec4 sampleNoise = texture2D(sNoise, vUv*(TexelSize*30000.0));","vec4 normalPack = texture2D(tNormal, vUv);","vec3 normalUnpack = (normalPack.xyz*2.0) - vec3(1.0, 1.0, 1.0);","vec3 normalVS = normalize(normalUnpack);","const float epsilon = 0.05;","float randomPatternRotationAngle = 2.0 * 3.14159265359 * (sampleNoise.x);","float sampleRadiusSS  = 0.0;","float radiusWS  = 0.0;","float occlusion = 0.0;","radiusWS = SamplingRadius;","\n        vec3 envLightFactor = vec3(0.0, 0.0, 0.0);\n        for(int si=0; si < NUM_SAMPLES; si++){\n            //pick a pixel\n            float radiusSS;\n            vec3 unitOffset = tapLocation(si, randomPatternRotationAngle, radiusSS);\n            unitOffset *= radiusSS * radiusWS;\n            \n            //check if the neighbor is facing us?\n            vec3 positionNeighbor = originWP.rgb + (unitOffset);\n            vec3 positionToNeighbor = positionNeighbor - originVS;\n            float neighborFacingFactor = clamp(dot(normalize(positionToNeighbor), normalVS), 0.0, 1.0);\n            \n            //get shadow factor of neighbor\n            vec3 neighborLightFactor = LightFactor(vec4(positionNeighbor, 1.0)) * neighborFacingFactor;\n            \n            //decrease as distance increases\n            envLightFactor += neighborLightFactor * ((float(NUM_SAMPLES) - float(si)) / float(NUM_SAMPLES+1));\n        }\n        envLightFactor /= float(NUM_SAMPLES);\n        \n        #ifdef RENDER_REFLECTION\n          gl_FragColor.rgb = envLightFactor * uIntensity;\n        #else\n          vec4 fragmentColor =  texture2D(tDiffuse, vUv);\n          //fragmentColor.rgb += envLightFactor * uIntensity;\n          \n          gl_FragColor = vec4(1.0-((1.0-(fragmentColor.rgb))*(1.0-(envLightFactor * uIntensity))), 1.0);;\n        #endif\n        ","}"].join("\n").replace(/NUM_DIR_LIGHTS/g,this.mCurrentLightState.directional.length).replace(/NUM_SPOT_LIGHTS/g,this.mCurrentLightState.spot.length).replace(/NUM_RECT_AREA_LIGHTS/g,this.mCurrentLightState.rectArea.length).replace(/NUM_POINT_LIGHTS/g,this.mCurrentLightState.point.length).replace(/NUM_HEMI_LIGHTS/g,this.mCurrentLightState.hemi.length),lights:!1};if(this.mShadowMapsEnabled){t.defines.USE_SHADOWMAP=!0;var n="SHADOWMAP_TYPE_BASIC";this.mShadowMapsType===THREE.PCFShadowMap?n="SHADOWMAP_TYPE_PCF":this.mShadowMapsType===THREE.PCFSoftShadowMap&&(n="SHADOWMAP_TYPE_PCF_SOFT"),t.defines[n]=!0}(0,o.isNullOrUndefined)(this.mModel.attributes.render)||("Reflection"===this.mModel.attributes.render.value?t.defines.RENDER_REFLECTION=!0:t.defines.RENDER_COLOR=!0),i.qL.print("creating RSM for: ",t),this.mMaterial=new THREE.ShaderMaterial(t)}}},{key:"getMeta",value:function(){return p.EffectMeta}},{key:"discard",value:function(){}},{key:"dispose",value:function(){this.mScene.remove(this.mQuad),this.mScene.remove(this.mCamera),this.mMaterial.dispose(),this.mQuad.geometry.dispose(),this.mQuad=null,this.mScene=null,this.mCamera=null,this.mMaterial=null,this.mCurrentLightState=null,this.mUniformCache=null}},{key:"updateRender",value:function(e,t,n,r){var a=[],u=[];t.traverseVisible((function(e){!0===e.isLight&&(a.push(e),e.castShadow&&u.push(e))}));var c={hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};this.setupLightState(a,u,n,c),i.qL.print("light state: ",c),((0,o.isNullOrUndefined)(this.mCurrentLightState)||this.mCurrentLightState.hash!==c.hash)&&(this.mCurrentLightState=c,this.mShadowMapsEnabled=e.shadowMap.enabled,this.mShadowMapsType=e.shadowMap.type,this.recreateMaterial()),this.mMaterial.uniforms.ambientLightColor.value=c.ambient,this.mMaterial.uniforms.directionalLights.value=c.directional,this.mMaterial.uniforms.spotLights.value=c.spot,this.mMaterial.uniforms.rectAreaLights.value=c.rectArea,this.mMaterial.uniforms.pointLights.value=c.point,this.mMaterial.uniforms.hemisphereLights.value=c.hemi,this.mMaterial.uniforms.directionalShadowMap.value=c.directionalShadowMap,this.mMaterial.uniforms.directionalShadowMatrix.value=c.directionalShadowMatrix,this.mMaterial.uniforms.spotShadowMap.value=c.spotShadowMap,this.mMaterial.uniforms.spotShadowMatrix.value=c.spotShadowMatrix,this.mMaterial.uniforms.pointShadowMap.value=c.pointShadowMap,this.mMaterial.uniforms.pointShadowMatrix.value=c.pointShadowMatrix,this.mMaterial.needsUpdate=!0}},{key:"ready",value:function(){return!(0,o.isNullOrUndefined)(this.mCurrentLightState)}},{key:"render",value:function(e,t,n,r){this.updateRender(e,t,n,r),this.mQuad.material=this.mMaterial,(0,o.isNullOrUndefined)(r)?e.render(this.mScene,this.mCamera):(e.setRenderTarget(r),e.clear(!0,!0,!1),e.render(this.mScene,this.mCamera),e.setRenderTarget(null))}},{key:"lightCashe",value:function(e){if(void 0!==this.lights[e.id])return this.lights[e.id];var t;switch(e.type){case"DirectionalLight":t={direction:new THREE.Vector3,color:new THREE.Color,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new THREE.Vector2};break;case"SpotLight":t={position:new THREE.Vector3,direction:new THREE.Vector3,color:new THREE.Color,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new THREE.Vector2};break;case"PointLight":t={position:new THREE.Vector3,color:new THREE.Color,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new THREE.Vector2,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":t={direction:new THREE.Vector3,skyColor:new THREE.Color,groundColor:new THREE.Color};break;case"RectAreaLight":t={color:new THREE.Color,position:new THREE.Vector3,halfWidth:new THREE.Vector3,halfHeight:new THREE.Vector3}}return this.lights[e.id]=t,t}},{key:"setupLightState",value:function(e,t,n,r){for(var o=new THREE.Vector3,i=new THREE.Matrix4,a=new THREE.Matrix4,u=0,c=0,s=0,l=0,f=0,p=0,d=0,h=0,y=n.matrixWorldInverse,m=0,v=e.length;m<v;m++){var b=e[m],g=b.color,w=b.intensity,_=b.distance,O=b.shadow&&b.shadow.map?b.shadow.map.texture:null;if(b.isAmbientLight)u+=g.r*w,c+=g.g*w,s+=g.b*w;else if(b.isDirectionalLight){var T=this.lightCashe(b);if(T.color.copy(b.color).multiplyScalar(b.intensity),T.direction.setFromMatrixPosition(b.matrixWorld),o.setFromMatrixPosition(b.target.matrixWorld),T.direction.sub(o),T.direction.transformDirection(y),T.shadow=b.castShadow,b.castShadow){var R=b.shadow;T.shadowBias=R.bias,T.shadowRadius=R.radius,T.shadowMapSize=R.mapSize}r.directionalShadowMap[l]=O,r.directionalShadowMatrix[l]=b.shadow.matrix,r.directional[l]=T,l++}else if(b.isSpotLight){var S=this.lightCashe(b);if(S.position.setFromMatrixPosition(b.matrixWorld),S.position.applyMatrix4(y),S.color.copy(g).multiplyScalar(w),S.distance=_,S.direction.setFromMatrixPosition(b.matrixWorld),o.setFromMatrixPosition(b.target.matrixWorld),S.direction.sub(o),S.direction.transformDirection(y),S.coneCos=Math.cos(b.angle),S.penumbraCos=Math.cos(b.angle*(1-b.penumbra)),S.decay=0===b.distance?0:b.decay,S.shadow=b.castShadow,b.castShadow){var E=b.shadow;S.shadowBias=E.bias,S.shadowRadius=E.radius,S.shadowMapSize=E.mapSize}r.spotShadowMap[p]=O,r.spotShadowMatrix[p]=b.shadow.matrix,r.spot[p]=S,p++}else if(b.isRectAreaLight){var P=this.lightCashe(b);P.color.copy(g).multiplyScalar(w),P.position.setFromMatrixPosition(b.matrixWorld),P.position.applyMatrix4(y),a.identity(),i.copy(b.matrixWorld),i.premultiply(y),a.extractRotation(i),P.halfWidth.set(.5*b.width,0,0),P.halfHeight.set(0,.5*b.height,0),P.halfWidth.applyMatrix4(a),P.halfHeight.applyMatrix4(a),r.rectArea[d]=P,d++}else if(b.isPointLight){var x=this.lightCashe(b);if(x.position.setFromMatrixPosition(b.matrixWorld),x.position.applyMatrix4(y),x.color.copy(b.color).multiplyScalar(b.intensity),x.distance=b.distance,x.decay=0===b.distance?0:b.decay,x.shadow=b.castShadow,b.castShadow){var j=b.shadow;x.shadowBias=j.bias,x.shadowRadius=j.radius,x.shadowMapSize=j.mapSize,x.shadowCameraNear=j.camera.near,x.shadowCameraFar=j.camera.far}r.pointShadowMap[f]=O,r.pointShadowMatrix[f]=b.shadow.matrix,r.point[f]=x,f++}else if(b.isHemisphereLight){var C=this.lightCashe(b);C.direction.setFromMatrixPosition(b.matrixWorld),C.direction.transformDirection(y),C.direction.normalize(),C.skyColor.copy(b.color).multiplyScalar(w),C.groundColor.copy(b.groundColor).multiplyScalar(w),r.hemi[h]=C,h++}}r.ambient[0]=u,r.ambient[1]=c,r.ambient[2]=s,r.directional.length=l,r.spot.length=p,r.rectArea.length=d,r.point.length=f,r.hemi.length=h,r.hash=l+","+f+","+p+","+d+","+h+","+t.length}},{key:"setAttribute",value:function(e,t){return"render"===e&&(this.recreateMaterial(),!0)}},{key:"setDefine",value:function(e,t){switch(e){case"NUM_SAMPLES":case"NUM_SPIRAL_TURNS":return this.mMaterial.defines[e]=parseInt(t,10),this.mMaterial.defines.needsUpdate=!0,this.mMaterial.needsUpdate=!0,!0}return!1}},{key:"setUniform",value:function(e,t){switch(e){case"SamplingRadius":case"CameraFar":case"CameraNear":case"CameraFov":case"uIntensity":case"projScale":return this.mUniformCache[e]=parseFloat(t),(0,o.isNullOrUndefined)(this.mMaterial)||(this.mMaterial.uniforms[e].value=this.mUniformCache[e]),!0;case"TexelSize":case"RightTop":case"viewInverseMatrix":return this.mUniformCache[e]=t,(0,o.isNullOrUndefined)(this.mMaterial)||this.mMaterial.uniforms[e].value.copy(this.mUniformCache[e]),!0;case"tDiffuse":case"tPosition":case"tNormal":case"sNoise":return this.mUniformCache[e]=t,(0,o.isNullOrUndefined)(this.mMaterial)||(this.mMaterial.uniforms[e].value=this.mUniformCache[e],this.mMaterial.needsUpdate=!0),!0}return!1}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),p}(r.c);f.EffectMeta={type:"Reflective shadow",defines:[{type:"int",name:"NUM_SAMPLES",value:11},{type:"int",name:"NUM_SPIRAL_TURNS",value:5}],uniforms:[{name:"tDiffuse",value:null,type:"render_texture"},{type:"render_texture",name:"tPosition"},{type:"render_texture_texel",name:"TexelSize"},{type:"render_texture",name:"tNormal"},{type:"system_texture",name:"sNoise",value:"voronoi-noise.jpg"},{type:"float",name:"SamplingRadius",value:5},{type:"camera_near",name:"CameraNear"},{type:"camera_far",name:"CameraFar"},{type:"camera_fov",name:"CameraFov"},{type:"frustum_rt",name:"RightTop"},{type:"viewInvMatrix",name:"viewInverseMatrix"},{type:"float",name:"uIntensity",value:1},{type:"projection_scale",name:"projScale"}],attributes:[{name:"render",type:"selection",value:"Reflection",options:"Reflection|Color"}]}},87411:function(e,t,n){"use strict";n.d(t,{f:function(){return f}}),n(91058),n(69600),n(54678),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(86835),o=n(89539),i=n(41142);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function s(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(p,e);var t,n,r,a,f=(r=p,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=l(r);if(a){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return s(this,e)});function p(e,t,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),f.call(this,e,t,n)}return t=p,(n=[{key:"createEffect",value:function(){this.mCamera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),this.mScene=new THREE.Scene,this.recreateMaterial(),this.mQuad=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),null),this.mQuad.frustumCulled=!1,this.mScene.add(this.mQuad)}},{key:"recreateMaterial",value:function(){(0,o.isNullOrUndefined)(this.mMaterial)||this.mMaterial.dispose();var e={defines:{NUM_SAMPLES:(0,o.isNullOrUndefined)(this.mModel.defines.NUM_SAMPLES)?12:parseInt(this.mModel.defines.NUM_SAMPLES.value,10),NUM_SPIRAL_TURNS:(0,o.isNullOrUndefined)(this.mModel.defines.NUM_SPIRAL_TURNS)?5:parseInt(this.mModel.defines.NUM_SPIRAL_TURNS.value,10)},uniforms:{tDiffuse:{value:null},tPosition:{value:null},tNormal:{value:null},sNoise:{value:null},TexelSize:{value:new THREE.Vector2(1/this.mRenderWidth,1/this.mRenderHeight)},OccluderBias:{value:(0,o.isNullOrUndefined)(this.mModel.uniforms.OccluderBias)?.005:this.mModel.uniforms.OccluderBias.value},SamplingRadius:{value:(0,o.isNullOrUndefined)(this.mModel.uniforms.SamplingRadius)?4:this.mModel.uniforms.SamplingRadius.value},CameraFar:{value:100},CameraNear:{value:1},CameraFov:{value:45},RightTop:{value:new THREE.Vector2},uIntensity:{value:(0,o.isNullOrUndefined)(this.mModel.uniforms.uIntensity)?1:this.mModel.uniforms.uIntensity.value},projScale:{value:500}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","vec4 modelViewProjPosition = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","gl_Position = modelViewProjPosition;","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform sampler2D sNoise;","uniform sampler2D tPosition;","uniform sampler2D tNormal;","uniform float OccluderBias;","uniform float SamplingRadius;","uniform vec2 TexelSize;","uniform float CameraFar;","uniform float CameraNear;","uniform float CameraFov;","uniform vec2 RightTop;","uniform float uIntensity;","uniform float projScale;","varying vec2 vUv;","#include <packing>","vec3 reconstructPosition(vec2 uv){","//uv += vec2(TexelSize.x, -TexelSize.y)*0.5;","vec2 ndc = uv*2.0 - vec2(1.0, 1.0);","vec4 sampleDepth = texture2D(tPosition, uv);","float modelDepth = unpackRGBAToDepth(sampleDepth);","vec2 pnear = ndc * RightTop;","float pz = -modelDepth*CameraFar;","return vec3(-pz*pnear.x / CameraNear, -pz*pnear.y / CameraNear, pz);","}","vec2 tapLocation(int sampleNumber, float spinAngle, out float radiusSS) {","float alpha = (float(sampleNumber) + 0.5) * (1.0 / float(NUM_SAMPLES));","float angle = alpha * (float(NUM_SPIRAL_TURNS) * 6.28) + spinAngle;","radiusSS = alpha;","return vec2(cos(angle), sin(angle));","}","vec3 getOffsetPositionVS(vec2 uv, vec2 unitOffset, float radiusSS) {","uv = uv + radiusSS * unitOffset * (TexelSize*1.0);","return reconstructPosition(uv);","}","float sampleAO(vec2 uv, vec3 positionVS, vec3 normalVS, float sampleRadiusSS,int tapIndex, float rotationAngle){"," const float epsilon = 0.05;"," float radius2 = SamplingRadius * SamplingRadius;"," float radiusSS;"," vec2 unitOffset = tapLocation(tapIndex, rotationAngle, radiusSS);"," radiusSS *= sampleRadiusSS;"," vec3 Q = getOffsetPositionVS(uv, unitOffset, radiusSS);"," vec3 v = Q - positionVS;"," float vv = dot(v, v);"," float vn = dot(v, normalVS) - OccluderBias;"," float f = max(radius2 - vv, 0.0) / radius2;"," return f * f * f * max(vn / (epsilon + vv), 0.0);","}","void main() {","vec4 sampleNoise = texture2D(sNoise, vUv*(TexelSize*30000.0));","vec3 originVS = reconstructPosition(vUv);","if(-originVS.z > (CameraFar - 1.0)){","gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);","return;","}","vec4 normalPack = texture2D(tNormal, vUv);","vec3 normalUnpack = (normalPack.xyz*2.0) - vec3(1.0, 1.0, 1.0);","vec3 normalVS = normalize(normalUnpack);","float randomPatternRotationAngle = 2.0 * 3.14159265359 * (sampleNoise.x);","float radiusSS  = 0.0;","float radiusWS  = 0.0;","float occlusion = 0.0;","radiusWS = SamplingRadius;","radiusSS = projScale * radiusWS / (originVS.z);","for (int i = 0; i < NUM_SAMPLES; ++i) {","occlusion += sampleAO(vUv, originVS, normalVS, radiusSS, i, randomPatternRotationAngle);","}","occlusion = 1.0 - occlusion / (4.0 * float(NUM_SAMPLES));","occlusion = clamp(pow(occlusion, 1.0 + uIntensity), 0.0, 1.0);","#ifdef RENDER_AO","gl_FragColor = vec4(occlusion, occlusion, occlusion, 1.0);","#else","vec4 albedo =  texture2D(tDiffuse, vUv);","gl_FragColor = vec4(albedo.rgb * occlusion, 1.0);","#endif","}"].join("\n")};(0,o.isNullOrUndefined)(this.mModel.attributes.render)||("AO"===this.mModel.attributes.render.value?e.defines.RENDER_AO=!0:e.defines.RENDER_COLOR=!0),i.qL.print("Create SAO material: ",e),this.mMaterial=new THREE.ShaderMaterial(e)}},{key:"getMeta",value:function(){return p.EffectMeta}},{key:"dispose",value:function(){this.mScene.remove(this.mQuad),this.mScene.remove(this.mCamera),this.mMaterial.dispose(),this.mQuad.geometry.dispose(),this.mQuad=null,this.mScene=null,this.mCamera=null,this.mMaterial=null}},{key:"render",value:function(e,t,n,r){this.mQuad.material=this.mMaterial,(0,o.isNullOrUndefined)(r)?e.render(this.mScene,this.mCamera):(e.setRenderTarget(r),e.clear(!0,!0,!1),e.render(this.mScene,this.mCamera),e.setRenderTarget(null))}},{key:"discard",value:function(){}},{key:"ready",value:function(){return!(0,o.isNullOrUndefined)(this.mMaterial.uniforms.sNoise.value)&&!0===this.mMaterial.uniforms.sNoise.value.ready}},{key:"setUniform",value:function(e,t){switch(e){case"OccluderBias":case"SamplingRadius":case"CameraFar":case"CameraNear":case"CameraFov":case"uIntensity":case"projScale":this.mMaterial.uniforms[e].value=parseFloat(t);break;case"RightTop":this.mMaterial.uniforms[e].value.copy(t);break;default:this.mMaterial.uniforms[e].value=t}return!0}},{key:"setDefine",value:function(e,t){switch(e){case"NUM_SAMPLES":case"NUM_SPIRAL_TURNS":return this.mMaterial.defines[e]=parseInt(t,10),this.mMaterial.defines.needsUpdate=!0,this.mMaterial.needsUpdate=!0,!0}return!1}},{key:"setAttribute",value:function(e,t){return"render"===e&&(this.recreateMaterial(),!0)}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),p}(r.c);f.EffectMeta={type:"AmbientSAO",defines:[{type:"int",name:"NUM_SAMPLES",value:11},{type:"int",name:"NUM_SPIRAL_TURNS",value:5}],uniforms:[{type:"render_texture",name:"tDiffuse"},{type:"render_texture",name:"tPosition"},{type:"render_texture_texel",name:"TexelSize"},{type:"render_texture",name:"tNormal"},{type:"system_texture",name:"sNoise",value:"voronoi-noise.jpg"},{type:"float",name:"OccluderBias",value:.005},{type:"float",name:"SamplingRadius",value:5},{type:"camera_near",name:"CameraNear"},{type:"camera_far",name:"CameraFar"},{type:"camera_fov",name:"CameraFov"},{type:"frustum_rt",name:"RightTop"},{type:"float",name:"uIntensity",value:1},{type:"projection_scale",name:"projScale"}],attributes:[{name:"render",type:"selection",value:"AO",options:"AO|Color"}]}},11342:function(e,t,n){"use strict";n.d(t,{W:function(){return l}}),n(69600),n(54678),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(86835),o=n(89539);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function c(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(f,e);var t,n,r,i,l=(r=f,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=s(r);if(i){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return c(this,e)});function f(e,t,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),l.call(this,e,t,n)}return t=f,(n=[{key:"createEffect",value:function(){this.mCamera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),this.mScene=new THREE.Scene,this.mMaterial=new THREE.ShaderMaterial({uniforms:{tDiffuse:{value:null},tPosition:{value:null},tNormal:{value:null},sNoise:{value:null},TexelSize:{value:new THREE.Vector2(1/this.mRenderWidth,1/this.mRenderHeight)},CameraFar:{value:100},CameraNear:{value:1},RightTop:{value:new THREE.Vector2},viewInverseMatrix:{value:new THREE.Matrix4},projection:{value:new THREE.Matrix4},screen:{value:new THREE.Vector2}},vertexShader:["varying vec2 vUv;","void main() {","vec4 modelViewProjPosition = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","vUv = modelViewProjPosition.xy/modelViewProjPosition.w;vUv.xy = vUv.xy * 0.5 + 0.5;","gl_Position = modelViewProjPosition;","}"].join("\n"),fragmentShader:["#define Scale vec3(.8, .8, .8)","#define K 19.19","uniform sampler2D tDiffuse;","uniform sampler2D tPosition;","uniform sampler2D tNormal;","uniform sampler2D sNoise;","uniform vec2 TexelSize;","uniform float CameraFar;","uniform float CameraNear;","uniform vec2 RightTop;","uniform vec2 screen;","uniform mat4 viewInverseMatrix;","uniform mat4 projectionMatrix;","uniform mat4 projection;","varying vec2 vUv;","#include <packing>","vec3 reconstructPosition(vec2 uv){","vec2 ndc = uv*2.0 - vec2(1.0, 1.0);","vec4 sampleDepth = texture2D(tPosition, uv);","float modelDepth = unpackRGBAToDepth(sampleDepth);","vec2 pnear = ndc * RightTop;","float pz = -modelDepth*CameraFar;","return vec3(-pz*pnear.x / CameraNear, -pz*pnear.y / CameraNear, pz);","}","float reconstructDepth(vec2 uv){","vec4 sampleDepth = texture2D(tPosition, uv);","float modelDepth = unpackRGBAToDepth(sampleDepth);","float pz = -modelDepth*CameraFar;","return pz;","}","const float step = 0.1;","const float minRayStep = 0.1;","const int maxSteps = 64;","const int numBinarySearchSteps = 10;","const float reflectionSpecularFalloffExponent = 3.0;","vec3 fresnelSchlick(float cosTheta, vec3 F0){","return F0 + (1.0 - F0) * pow(1.0 - cosTheta, 5.0);","}","vec3 hash(vec3 a){","a = fract(a * Scale);","a += dot(a, a.yxz + K);","return fract((a.xxy + a.yxx)*a.zyx);","}","vec3 BinarySearch(inout vec3 dir, inout vec3 hitCoord, inout float dDepth){","float depth;","vec4 projectedCoord;","for(int i = 0; i < numBinarySearchSteps; i++){","projectedCoord = projection * vec4(hitCoord, 1.0);","projectedCoord.xy /= projectedCoord.w;","projectedCoord.xy = projectedCoord.xy * 0.5 + 0.5;","depth = reconstructDepth(projectedCoord.xy);","dDepth = hitCoord.z - depth;","dir *= 0.5;","if(dDepth > 0.0)","  hitCoord += dir;","else","  hitCoord -= dir;","}","projectedCoord = projection * vec4(hitCoord, 1.0);","projectedCoord.xy /= projectedCoord.w;","projectedCoord.xy = projectedCoord.xy * 0.5 + 0.5;","return vec3(projectedCoord.xy, depth);","}","vec4 RayMarch(vec3 dir, inout vec3 hitCoord, out float dDepth){","dir *= step;","float depth;","int steps;","vec4 projectedCoord;","for(int i = 0; i < maxSteps; i++){","hitCoord += dir;","projectedCoord = projection * vec4(hitCoord, 1.0);","projectedCoord.xy /= projectedCoord.w;","projectedCoord.xy = projectedCoord.xy * 0.5 + 0.5;","depth = reconstructDepth(projectedCoord.xy);","if(-depth > (CameraFar-1.0)) continue;","dDepth = hitCoord.z - depth;","if((dir.z - dDepth) < 1.0){"," if(dDepth <= 0.0){","   vec4 Result;","   Result = vec4(BinarySearch(dir, hitCoord, dDepth), 1.0);","   return Result;"," }","}","steps+=1;","}","return vec4(projectedCoord.xy, depth, 0.0);","}","void main(){","vec4 normalPack = texture2D(tNormal, vUv);","float reflectivity = normalPack.w;","if(reflectivity < 0.0001) { gl_FragColor = texture2D(tDiffuse, vUv); return;}","vec3 viewNormal = (normalPack.xyz*2.0) - vec3(1.0, 1.0, 1.0);","vec3 viewPos = reconstructPosition(vUv);","vec3 albedo = texture2D(tDiffuse, vUv).rgb;","vec3 reflected = normalize(reflect(normalize(viewPos), normalize(viewNormal)));","vec3 reflection = vec3(0.0, 0.0, 0.0);","for(int r=0; r < 4; r++){","vec3 hitPos = viewPos;","float dDepth;","vec3 wp = vec3(viewInverseMatrix * vec4(viewPos, 1.0));","vec3 jitt = mix(vec3(0.0), vec3(hash(wp)), 0.5);","vec4 sampleNoise = texture2D(sNoise, vec2(float(r)*0.1) + vUv*10.0);","vec3 noise = ((sampleNoise.xyz*2.0) - vec3(1.0, 1.0, 1.0))*(0.4);","vec4 coords = RayMarch((noise+reflected* max(minRayStep, -viewPos.z)), hitPos, dDepth);","if(coords.w < 0.1) continue;","vec2 dCoords = smoothstep(0.2, 0.6, abs(vec2(0.5, 0.5) - coords.xy));","float screenEdgefactor = clamp(2.0 - (dCoords.x + dCoords.y), 0.0, 1.0);","float ReflectionMultiplier = pow(reflectivity, reflectionSpecularFalloffExponent) * screenEdgefactor * -(reflected.z*2.0);","vec3 F0 = albedo*0.5;","vec3 Fresnel = fresnelSchlick(max(dot(normalize(viewNormal), normalize(viewPos)), 0.0), F0);","float hitDistance = 1.0 - (length(vUv.xy - coords.xy) * (-viewPos.z*0.8));","vec3 SSR = texture2D(tDiffuse, coords.xy).rgb * clamp(ReflectionMultiplier, 0.1, 0.9) * Fresnel;","reflection += SSR;","}","reflection = reflection*0.25;","vec3 blendColor = 1.0-((1.0-albedo)*(1.0-(reflection)));","gl_FragColor =  vec4(blendColor, 1.0);","}"].join("\n")}),this.mQuad=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),null),this.mQuad.frustumCulled=!1,this.mScene.add(this.mQuad)}},{key:"getMeta",value:function(){return f.EffectMeta}},{key:"dispose",value:function(){this.mScene.remove(this.mQuad),this.mScene.remove(this.mCamera),this.mMaterial.dispose(),this.mQuad.geometry.dispose(),this.mQuad=null,this.mScene=null,this.mCamera=null,this.mMaterial=null}},{key:"render",value:function(e,t,n,r){this.mQuad.material=this.mMaterial,(0,o.isNullOrUndefined)(r)?e.render(this.mScene,this.mCamera):(e.setRenderTarget(r),e.clear(!0,!0,!1),e.render(this.mScene,this.mCamera),e.setRenderTarget(null))}},{key:"discard",value:function(){}},{key:"ready",value:function(){return!(0,o.isNullOrUndefined)(this.mMaterial.uniforms.sNoise.value)&&!0===this.mMaterial.uniforms.sNoise.value.ready}},{key:"setUniform",value:function(e,t){switch(e){case"CameraFar":case"CameraNear":this.mMaterial.uniforms[e].value=parseFloat(t);break;case"screen":case"RightTop":this.mMaterial.uniforms[e].value.copy(t);break;default:this.mMaterial.uniforms[e].value=t}return!0}},{key:"setDefine",value:function(e,t){return!1}},{key:"setAttribute",value:function(e,t){return!1}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(r.c);l.EffectMeta={type:"ScreenSpaceReflection",uniforms:[{type:"render_texture",name:"tDiffuse"},{type:"render_texture",name:"tPosition"},{type:"render_texture_texel",name:"TexelSize"},{type:"render_texture",name:"tNormal"},{type:"system_texture",name:"sNoise",value:"voronoi-noise.jpg"},{type:"camera_near",name:"CameraNear"},{type:"camera_far",name:"CameraFar"},{type:"frustum_rt",name:"RightTop"},{type:"viewInvMatrix",name:"viewInverseMatrix"},{type:"projection",name:"projection"},{type:"screen",name:"screen"}]}},96658:function(e,t,n){"use strict";n.d(t,{D:function(){return f}}),n(69600),n(54678),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(86835),o=n(89539),i=n(41142);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function s(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(p,e);var t,n,r,a,f=(r=p,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=l(r);if(a){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return s(this,e)});function p(e,t,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),f.call(this,e,t,n)}return t=p,(n=[{key:"createEffect",value:function(){this.mCamera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),this.mScene=new THREE.Scene,this.recreateMaterial(),this.mQuad=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),null),this.mQuad.frustumCulled=!1,this.mScene.add(this.mQuad)}},{key:"recreateMaterial",value:function(){(0,o.isNullOrUndefined)(this.mMaterial)||this.mMaterial.dispose();var e={defines:{},uniforms:{tDiffuse:{value:null},offset:{value:(0,o.isNullOrUndefined)(this.mModel.uniforms.offset)?1:this.mModel.uniforms.offset.value},darkness:{value:(0,o.isNullOrUndefined)(this.mModel.uniforms.darkness)?0:this.mModel.uniforms.darkness.value}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float offset;","uniform float darkness;","varying vec2 vUv;","void main() {","vec4 fragmentColor = texture2D(tDiffuse, vUv);","vec2 uv = ( vUv - vec2( 0.5 ) ) * vec2( offset );","gl_FragColor = vec4( mix( fragmentColor.rgb, vec3( 1.0 - darkness ), dot( uv, uv ) ), fragmentColor.a );","}"].join("\n")};i.qL.print("creating color correction for: ",e.defines),this.mMaterial=new THREE.ShaderMaterial(e)}},{key:"getMeta",value:function(){return p.EffectMeta}},{key:"discard",value:function(){}},{key:"dispose",value:function(){this.mScene.remove(this.mQuad),this.mScene.remove(this.mCamera),this.mMaterial.dispose(),this.mQuad.geometry.dispose(),this.mQuad=null,this.mScene=null,this.mCamera=null,this.mMaterial=null}},{key:"render",value:function(e,t,n,r){this.mQuad.material=this.mMaterial,(0,o.isNullOrUndefined)(r)?(i.qL.print("Vignette render"),e.render(this.mScene,this.mCamera)):(e.setRenderTarget(r),e.clear(!0,!0,!1),e.render(this.mScene,this.mCamera),e.setRenderTarget(null))}},{key:"setAttribute",value:function(e,t){return!1}},{key:"setDefine",value:function(e,t){return!1}},{key:"setUniform",value:function(e,t){switch(e){case"offset":case"darkness":return this.mMaterial.uniforms[e].value=parseFloat(t),this.mMaterial.needsUpdate=!0,!0;case"tDiffuse":return this.mMaterial.uniforms[e].value=t,this.mMaterial.needsUpdate=!0,!0}return!1}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),p}(r.c);f.EffectMeta={type:"Vignette",uniforms:[{name:"tDiffuse",value:null,type:"render_texture"},{name:"offset",type:"float",value:1},{name:"darkness",type:"float",value:1}]}},86835:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.d(t,{c:function(){return o}}),n(69070),n(21703);var o=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.enabled=!0,this.mModel=t,this.mRenderWidth=n,this.mRenderHeight=r,this.createEffect()}var t,n;return t=e,(n=[{key:"getMeta",value:function(){return null}},{key:"getModel",value:function(){return this.mModel}},{key:"setSize",value:function(e,t){this.mRenderWidth=e,this.mRenderHeight=t}},{key:"updateRender",value:function(e,t,n,r){}},{key:"ready",value:function(){return!0}},{key:"setValue",value:function(e,t){return this.setUniform(e,t)||this.setDefine(e,t)||this.setAttribute(e,t)}},{key:"setRenderTarget",value:function(e){this.mModel.target=e}},{key:"getRenderTarget",value:function(){return this.mModel.target}},{key:"getEffectUUID",value:function(){return this.mModel.uuid}}])&&r(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},2503:function(e,t,n){"use strict";n.d(t,{_:function(){return S}}),n(41539),n(15581),n(2490),n(34514),n(54747),n(47941),n(69826),n(31672),n(59461),n(40561),n(88674),n(2707),n(68216),n(79433),n(68309),n(69070),n(21703);var r=n(84217),o=n(82630),i=n(1025),a=n(23346),u=n(87411),c=n(89539),s=n(94753),l=n(11342),f=n(82924),p=n(36588),d=n(99556),h=n(17876),y=n(29844),m=n(49848),v=n(96658),b=n(96788),g=n(49782),w=n(26744),_=n(4297),O=n(28810),T=n(79843);function R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var S=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mLoader=null,this.mRenderTargets={},this.mActivePipeline=null,this.mEffects=new Array,this.mActiveRenderIndex=0,this.mRendering=!1,this.mSystemTextures={},this.mProductId=t,this.mPipelines=new Array,this.mRenderer=n,this.mWidth=this.mRenderer.domElement.width,this.mHeight=this.mRenderer.domElement.height}var t,n;return t=e,n=[{key:"dispose",value:function(){var e=this;this.clearPipeline(),Object.keys(this.mSystemTextures).forEach((function(t){return e.mSystemTextures[t].dispose()})),this.mSystemTextures={}}},{key:"getPipelines",value:function(){return this.mPipelines}},{key:"activatePipeline",value:function(e){this.clearPipeline(),this.mActivePipeline=e;var t=this.mPipelines.find((function(t){return t.uuid===e}));this._loadPipeline(t)}},{key:"getActivePipelineUUID",value:function(){return this.mActivePipeline}},{key:"clearPipeline",value:function(){var e=this;this.discard(),this.mActivePipeline=null,Object.keys(this.mRenderTargets).forEach((function(t){return e.mRenderTargets[t].dispose()})),this.mRenderTargets={},this.mEffects.splice(0,this.mEffects.length).forEach((function(e){return e.dispose()}))}},{key:"_resolvePipelines",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return null!==this.mLoader?this.mLoader:!t&&this.mPipelines.length>0?this:(this.mLoader=new Promise((function(t,n){T.Q.getInstance().resolveBootstrapData(+e.mProductId).pipe((0,r.q)(1)).subscribe((function(n){e.mPipelines=n.getPostPipelines(),t(e)}),(function(e){n(e)}))})),d.S.completePromise(this.mLoader).then((function(){e.mLoader=null})),this.mLoader)}},{key:"_loadPipeline",value:function(e){var t=this;(0,c.isNullOrUndefined)(e)||(Array.isArray(e.renderTextures)&&e.renderTextures.forEach((function(e){t.mRenderTargets[e.uuid]=new o.M(e.type,e.sizing,e.resolution_x,e.resolution_y,t.mWidth,t.mHeight)})),Array.isArray(e.effects)&&(e.effects.sort((function(e,t){return e.position-t.position})),e.effects.forEach((function(e){var n=null;switch(e.type){case i.q.EffectMeta.type:n=new i.q(e,t.mWidth,t.mHeight);break;case a.H.EffectMeta.type:n=new a.H(e,t.mWidth,t.mHeight);break;case u.f.EffectMeta.type:n=new u.f(e,t.mWidth,t.mHeight);break;case s.Y.EffectMeta.type:n=new s.Y(e,t.mWidth,t.mHeight);break;case l.W.EffectMeta.type:n=new l.W(e,t.mWidth,t.mHeight);break;case f.u.EffectMeta.type:n=new f.u(e,t.mWidth,t.mHeight);break;case p.i.EffectMeta.type:n=new p.i(e,t.mWidth,t.mHeight);break;case m.H.EffectMeta.type:n=new m.H(e,t.mWidth,t.mHeight);break;case h.G.EffectMeta.type:n=new h.G(e,t.mWidth,t.mHeight);break;case v.D.EffectMeta.type:n=new v.D(e,t.mWidth,t.mHeight);break;case b.K.EffectMeta.type:n=new b.K(e,t.mWidth,t.mHeight);break;case g.f.EffectMeta.type:n=new g.f(e,t.mWidth,t.mHeight);break;case w.P.EffectMeta.type:n=new w.P(e,t.mWidth,t.mHeight);break;case _.j.EffectMeta.type:n=new _.j(e,t.mWidth,t.mHeight)}null!==n&&t.addEffect(n,!1)}))))}},{key:"savePipeline",value:function(){var e=this;return new Promise((function(t,n){y.O.getInstance().put("catalogue/"+e.mProductId+"/post_pipelines/sync",{pipelines:e.mPipelines}).then((function(r){r.data&&!0===r.data.saved?t(e):n("unknown server error")}),(function(e){n("connection error")}))}))}},{key:"addEffect",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t&&e.setSize(this.mWidth,this.mHeight),this.mEffects.push(e)}},{key:"setSize",value:function(e,t){var n=this;this.mWidth===e&&this.mHeight===t||(this.mWidth=e,this.mHeight=t,Object.keys(this.mRenderTargets).forEach((function(r){return n.mRenderTargets[r].setSize(e,t)})),this.mEffects.forEach((function(n){return n.setSize(e,t)})))}},{key:"setEffectValue",value:function(e,t,n,r,o){var i=this.mPipelines.find((function(t){return t.uuid===e}));if(!(0,c.isNullOrUndefined)(i)){var a=i.effects.find((function(e){return e.uuid===t}));if(!(0,c.isNullOrUndefined)(a)){var u=a[n];(0,c.isNullOrUndefined)(u)||(u[r].value=o)}}e===this.mActivePipeline&&this.updateEffectValue(t,n,r,o)}},{key:"updateEffectValue",value:function(e,t,n,r){this.mEffects.every((function(o){if(o.getEffectUUID()===e){switch(t){case"uniforms":o.setUniform(n,r);break;case"defines":o.setDefine(n,r);break;case"attributes":o.setAttribute(n,r)}return!1}return!0}))}},{key:"updateUniforms",value:function(e,t,n){var r=this,o=this.mRenderer,i=n.far,a=n.near,u=n.fov,s=n.aspect,l=Math.tan(u*Math.PI/180/2)*a,f=l*s,p=new THREE.Vector2(f,l),d=new THREE.Vector2;o.getSize(d);var h=d.y/(.3*u),y=(new THREE.Matrix4).getInverse(n.projectionMatrix),m=n.matrixWorld.clone(),v=new THREE.Vector2(d.x,d.y);this.mEffects.forEach((function(e){var t=e.getMeta();(0,c.isNullOrUndefined)(t)||Array.isArray(t.uniforms)&&t.uniforms.forEach((function(t){switch(t.type){case"camera_near":e.setUniform(t.name,a);break;case"camera_far":e.setUniform(t.name,i);break;case"camera_aspect":e.setUniform(t.name,s);break;case"camera_fov":e.setUniform(t.name,u);break;case"frustum_rt":e.setUniform(t.name,p);break;case"screen":e.setUniform(t.name,v);break;case"projection_scale":e.setUniform(t.name,h);break;case"viewInvMatrix":e.setUniform(t.name,m);break;case"projInvMatrix":e.setUniform(t.name,y);break;case"projection":e.setUniform(t.name,n.projectionMatrix);break;case"render_texture":case"render_target":case"render_texture_texel":var o=e.getModel();if(!(0,c.isUndefined)(o.uniforms)&&!(0,c.isUndefined)(o.uniforms[t.name])){var l=o.uniforms[t.name].value,f=r.mRenderTargets[l];(0,c.isNullOrUndefined)(f)||("render_texture"===t.type?e.setUniform(t.name,f.getRenderTarget().texture):"render_texture_texel"===t.type?e.setUniform(t.name,new THREE.Vector2(1,1).divide(f.getSize())):"render_target"===t.type&&e.setUniform(t.name,f.getRenderTarget()))}break;case"system_texture":var d=e.getModel();if(!(0,c.isUndefined)(d.uniforms)&&!(0,c.isUndefined)(d.uniforms[t.name])){var b=d.uniforms[t.name].value,g=r._getSystemTexture(b);(0,c.isNullOrUndefined)(g)||e.setUniform(t.name,g)}}}))}))}},{key:"_getSystemTexture",value:function(e){var t=this,n=null;switch(e){case"noise-128.png":n=O.E.assetsUrl+"system/textures/noise-128.png";break;case"normal-test.png":n=O.E.assetsUrl+"system/textures/normal-test.png";break;case"voronoi-noise.jpg":n=O.E.assetsUrl+"system/textures/voronoi-noise.jpg"}return null!==n?((0,c.isNullOrUndefined)(this.mSystemTextures[n])&&(this.mSystemTextures[n]=(new THREE.TextureLoader).load(n,(function(){t.mSystemTextures[n].ready=!0})),this.mSystemTextures[n].wrapS=THREE.RepeatWrapping,this.mSystemTextures[n].wrapT=THREE.RepeatWrapping),this.mSystemTextures[n]):null}},{key:"discard",value:function(){this.mRendering&&this.mActiveRenderIndex<this.mEffects.length&&this.mEffects[this.mActiveRenderIndex].discard(),this.mRendering=!1,this.mActiveRenderIndex=0}},{key:"render",value:function(e,t,n){if(0!==this.mEffects.length&&null!==this.mActivePipeline){0===this.mActiveRenderIndex&&(this.mRendering=!0),this.updateUniforms(e,t,n);var r=this.mEffects[this.mActiveRenderIndex];if(r.enabled)if(r.ready()){var o=r.getRenderTarget(),i=null;!(0,c.isNullOrUndefined)(o)&&o.length>0&&(i=this.mRenderTargets[o].getRenderTarget()),r.render(e,t,n,i),this.requestNextFrame(e,t,n)}else{this.mActiveRenderIndex-=1;var a=r.getRenderTarget(),u=null;!(0,c.isNullOrUndefined)(a)&&a.length>0&&(u=this.mRenderTargets[a].getRenderTarget()),r.updateRender(e,t,n,u),this.requestNextFrame(e,t,n)}else this.requestNextFrame(e,t,n)}}},{key:"requestNextFrame",value:function(e,t,n){var r=this;this.mActiveRenderIndex<this.mEffects.length-1?(this.mActiveRenderIndex+=1,window.requestAnimationFrame((function(o){r&&r.mRendering&&r.render(e,t,n)}))):(this.mActiveRenderIndex=0,this.mRendering=!1)}}],n&&R(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},82630:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.d(t,{M:function(){return o}}),n(60086),n(69070),n(21703);var o=function(){function e(t,n,r,o,i,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mRenderTarget=null,this.mDataType=t,this.mSizing=n,this.mResolution=new THREE.Vector2(r,o),this.mSize=new THREE.Vector2(0,0),this.setSize(i,a)}var t,n;return t=e,(n=[{key:"dispose",value:function(){this.mRenderTarget.dispose(),this.mRenderTarget=null}},{key:"setSize",value:function(e,t){var n=this.mSize.clone();switch(this.mSizing){case"fixed":this.mSize.set(this.mResolution.x,this.mResolution.y);break;case"ratio":this.mSize.set(e*this.mResolution.x*window.devicePixelRatio,t*this.mResolution.y*window.devicePixelRatio)}if(null===this.mRenderTarget){var r=THREE.UnsignedByteType;switch(this.mDataType){case"UnsignedByteType":r=THREE.UnsignedByteType;break;case"ByteType":r=THREE.ByteType;break;case"ShortType":r=THREE.ShortType;break;case"IntType":r=THREE.IntType;break;case"UnsignedIntType":r=THREE.UnsignedIntType;break;case"FloatType":r=THREE.FloatType;break;case"HalfFloatType":r=THREE.HalfFloatType}console.log("create render texture size: ",this.mSize),console.log("window pixel ratio: ",window.devicePixelRatio);var o={minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,type:r,anisotropy:8};this.mRenderTarget=new THREE.WebGLRenderTarget(this.mSize.x,this.mSize.y,o)}else n.sub(this.mSize).lengthSq()>1&&this.mRenderTarget.setSize(this.mSize.x,this.mSize.y)}},{key:"getSize",value:function(){return this.mSize}},{key:"getRenderTarget",value:function(){return this.mRenderTarget}}])&&r(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},80981:function(e,t,n){"use strict";n.d(t,{c:function(){return c},H:function(){return p}}),n(35666),n(41539),n(88674),n(69070),n(21703);var r=n(41142),o=n(89539);function i(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function u(e){i(a,r,o,u,c,"next",e)}function c(e){i(a,r,o,u,c,"throw",e)}u(void 0)}))}}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i,c;return t=e,n=[{key:"calculate",value:(c=a(regeneratorRuntime.mark((function e(t,n,i,a){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var i=n.catalogue,a=0;(0,o.isNumber)(i.price)&&(a=+i.price),r.qL.print("base price"),t.totals=t.totals||{},t.totals.base=t.totals.base||0,t.totals.base+=a,e({totals:t.totals,models:t.models,catalogue:n.catalogue})})));case 1:case"end":return e.stop()}}),e)}))),function(e,t,n,r){return c.apply(this,arguments)})},{key:"getBreakDownName",value:function(){return"base"}},{key:"breakDown",value:(i=a(regeneratorRuntime.mark((function e(t,n,r,i){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var t=r.catalogue,n=0;(0,o.isNumber)(t.price)&&(n=+t.price),e({base:n})})));case 1:case"end":return e.stop()}}),e)}))),function(e,t,n,r){return i.apply(this,arguments)})}],n&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),s=(n(15581),n(2490),n(34514),n(54747),n(69826),n(31672),n(59461),n(54678),n(68309),n(68009));function l(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var p=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r,i;return t=e,n=[{key:"calculate",value:function(e,t,n,r){return new Promise((function(r,i){n.getComponent("attributeManager").resolveAttributeManager().subscribe((function(n){var i=n.getAttributeControllers(),a=0;i.forEach((function(e){if("question"===e.getAttributeType()&&e.isVisible()){var t=e.getAttribute();if(!(0,o.isNullOrUndefined)(t.selected_value_id)){var n=t.attribute_values.find((function(e){return e.id==t.selected_value_id}));!(0,o.isNullOrUndefined)(n)&&s.F.isNumeric(n.price)&&(a+=parseFloat(n.price))}}})),e.totals=e.totals||{},e.totals.base=e.totals.base||0,e.totals.base+=a,r({totals:e.totals,models:e.models,catalogue:t.catalogue})}),(function(e){i(e)}))}))}},{key:"breakDown",value:(r=regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){t.getComponent("attributeManager").resolveAttributeManager().subscribe((function(t){var r=t.getAttributeControllers(),i=[];r.forEach((function(e){if("question"===e.getAttributeType()&&e.isVisible()){var t=e.getAttribute();if(!(0,o.isNullOrUndefined)(t.selected_value_id)){var r=t.attribute_values.find((function(e){return e.id==t.selected_value_id}));!(0,o.isNullOrUndefined)(r)&&s.F.isNumeric(r.price)&&(!0===n.excludePriceZero&&0===r.price||i.push({attribute_id:t.id,attribute_name:t.name,attribute_key:t.key,attribute_value_id:r.id,attribute_value_name:r.name,attribute_value_key:r.key,attribute_value_price:r.price}))}}})),e({attributes:i})}),(function(e){return r(e)}))})));case 1:case"end":return e.stop()}}),e)})),i=function(){var e=this,t=arguments;return new Promise((function(n,o){var i=r.apply(e,t);function a(e){l(i,n,o,a,u,"next",e)}function u(e){l(i,n,o,a,u,"throw",e)}a(void 0)}))},function(e,t){return i.apply(this,arguments)})},{key:"getBreakDownName",value:function(){return"attributes"}}],n&&f(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},49029:function(e,t,n){"use strict";n.d(t,{BasePriceCalculation:function(){return o.c},OptionPriceCalculation:function(){return o.H}});var r=n(23671);n.o(r,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return r.AddObjectCommand}}),n.o(r,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return r.AppViewerComponent}}),n.o(r,"BasePriceCalculation")&&n.d(t,{BasePriceCalculation:function(){return r.BasePriceCalculation}}),n.o(r,"OptionPriceCalculation")&&n.d(t,{OptionPriceCalculation:function(){return r.OptionPriceCalculation}}),n.o(r,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return r.SetPositionCommand}}),n.o(r,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return r.SetRotationCommand}});var o=n(80981),i=n(87369);n.o(i,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return i.AddObjectCommand}}),n.o(i,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return i.AppViewerComponent}}),n.o(i,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return i.SetPositionCommand}}),n.o(i,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return i.SetRotationCommand}})},23671:function(e,t,n){"use strict";var r=n(76313);n.o(r,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return r.AddObjectCommand}}),n.o(r,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return r.AppViewerComponent}}),n.o(r,"BasePriceCalculation")&&n.d(t,{BasePriceCalculation:function(){return r.BasePriceCalculation}}),n.o(r,"OptionPriceCalculation")&&n.d(t,{OptionPriceCalculation:function(){return r.OptionPriceCalculation}}),n.o(r,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return r.SetPositionCommand}}),n.o(r,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return r.SetRotationCommand}});var o=n(16100);n.o(o,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return o.AddObjectCommand}}),n.o(o,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return o.AppViewerComponent}}),n.o(o,"BasePriceCalculation")&&n.d(t,{BasePriceCalculation:function(){return o.BasePriceCalculation}}),n.o(o,"OptionPriceCalculation")&&n.d(t,{OptionPriceCalculation:function(){return o.OptionPriceCalculation}}),n.o(o,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return o.SetPositionCommand}}),n.o(o,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return o.SetRotationCommand}});var i=n(64893);n.o(i,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return i.AddObjectCommand}}),n.o(i,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return i.AppViewerComponent}}),n.o(i,"BasePriceCalculation")&&n.d(t,{BasePriceCalculation:function(){return i.BasePriceCalculation}}),n.o(i,"OptionPriceCalculation")&&n.d(t,{OptionPriceCalculation:function(){return i.OptionPriceCalculation}}),n.o(i,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return i.SetPositionCommand}}),n.o(i,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return i.SetRotationCommand}});var a=n(64404);n.o(a,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return a.AddObjectCommand}}),n.o(a,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return a.AppViewerComponent}}),n.o(a,"BasePriceCalculation")&&n.d(t,{BasePriceCalculation:function(){return a.BasePriceCalculation}}),n.o(a,"OptionPriceCalculation")&&n.d(t,{OptionPriceCalculation:function(){return a.OptionPriceCalculation}}),n.o(a,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return a.SetPositionCommand}}),n.o(a,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return a.SetRotationCommand}})},64893:function(){},64404:function(){},76313:function(){},16100:function(){},6870:function(){},38492:function(){},68785:function(){},87369:function(e,t,n){"use strict";var r=n(6870);n.o(r,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return r.AddObjectCommand}}),n.o(r,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return r.AppViewerComponent}}),n.o(r,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return r.SetPositionCommand}}),n.o(r,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return r.SetRotationCommand}});var o=n(69409);n.o(o,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return o.AddObjectCommand}}),n.o(o,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return o.AppViewerComponent}}),n.o(o,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return o.SetPositionCommand}}),n.o(o,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return o.SetRotationCommand}});var i=n(28584);n.o(i,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return i.AddObjectCommand}}),n.o(i,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return i.AppViewerComponent}}),n.o(i,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return i.SetPositionCommand}}),n.o(i,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return i.SetRotationCommand}});var a=n(3594);n.o(a,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return a.AddObjectCommand}}),n.o(a,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return a.AppViewerComponent}}),n.o(a,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return a.SetPositionCommand}}),n.o(a,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return a.SetRotationCommand}});var u=n(47801);n.o(u,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return u.AddObjectCommand}}),n.o(u,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return u.AppViewerComponent}}),n.o(u,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return u.SetPositionCommand}}),n.o(u,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return u.SetRotationCommand}});var c=n(35714);n.o(c,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return c.AddObjectCommand}}),n.o(c,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return c.AppViewerComponent}}),n.o(c,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return c.SetPositionCommand}}),n.o(c,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return c.SetRotationCommand}});var s=n(47300);n.o(s,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return s.AddObjectCommand}}),n.o(s,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return s.AppViewerComponent}}),n.o(s,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return s.SetPositionCommand}}),n.o(s,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return s.SetRotationCommand}});var l=n(74451);n.o(l,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return l.AddObjectCommand}}),n.o(l,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return l.AppViewerComponent}}),n.o(l,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return l.SetPositionCommand}}),n.o(l,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return l.SetRotationCommand}}),n(81385);var f=n(58475);n.o(f,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return f.AddObjectCommand}}),n.o(f,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return f.AppViewerComponent}}),n.o(f,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return f.SetPositionCommand}}),n.o(f,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return f.SetRotationCommand}});var p=n(67143);n.o(p,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return p.AddObjectCommand}}),n.o(p,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return p.AppViewerComponent}}),n.o(p,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return p.SetPositionCommand}}),n.o(p,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return p.SetRotationCommand}}),n(79997);var d=n(35470);n.o(d,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return d.AddObjectCommand}}),n.o(d,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return d.AppViewerComponent}}),n.o(d,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return d.SetPositionCommand}}),n.o(d,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return d.SetRotationCommand}});var h=n(74970);n.o(h,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return h.AddObjectCommand}}),n.o(h,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return h.AppViewerComponent}}),n.o(h,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return h.SetPositionCommand}}),n.o(h,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return h.SetRotationCommand}}),n(10024);var y=n(38492);n.o(y,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return y.AddObjectCommand}}),n.o(y,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return y.AppViewerComponent}}),n.o(y,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return y.SetPositionCommand}}),n.o(y,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return y.SetRotationCommand}});var m=n(68785);n.o(m,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return m.AddObjectCommand}}),n.o(m,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return m.AppViewerComponent}}),n.o(m,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return m.SetPositionCommand}}),n.o(m,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return m.SetRotationCommand}})},69409:function(){},28584:function(){},3594:function(){},47801:function(){},35714:function(){},47300:function(){},74451:function(){},81385:function(e,t,n){"use strict";n(21703),n(69070)},58475:function(){},67143:function(){},79997:function(e,t,n){"use strict";n(21703),n(69070)},35470:function(){},74970:function(){},10024:function(e,t,n){"use strict";n(21703),n(69070)},56027:function(e,t,n){"use strict";n.d(t,{f:function(){return f}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(78842),o=n(90140),i=n(41142);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function s(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(f,e);var t,n,r,o,a=(r=f,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=l(r);if(o){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return s(this,e)});function f(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(e=a.call(this)).mNeedsUpdate=!0,e.mAutoDiposeGeometry=!0,e}return t=f,(n=[{key:"getType",value:function(){return f.TypeRTTI}},{key:"needsUpdate",get:function(){return this.mNeedsUpdate},set:function(e){this.mNeedsUpdate=e}},{key:"autoDisposeGeometry",get:function(){return this.mAutoDiposeGeometry},set:function(e){this.mAutoDiposeGeometry=e}},{key:"dispose",value:function(){}},{key:"onAttached",value:function(e){}},{key:"onDetached",value:function(e){}},{key:"onAttachRoot",value:function(e){i.qL.print("on attach to root!",e)}},{key:"onDetachRoot",value:function(e){}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(r.L);f.TypeRTTI=new o.r("BaseRenderObject",r.L.TypeRTTI)},65214:function(e,t,n){"use strict";n.d(t,{N:function(){return v}}),n(35666),n(41539),n(88674),n(15581),n(2490),n(34514),n(54747),n(40561),n(92222),n(91058),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r,o=n(89539),i=n(15840),a=n(83512),u=n(24671),c=n(28810);!function(e){e[e.Albedo=2]="Albedo",e[e.Depth=4]="Depth",e[e.Normal=8]="Normal",e[e.All=511]="All"}(r||(r={}));var s=n(9896),l=n(41142);function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function p(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t){return h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},h(e,t)}function y(e,t){if(t&&("object"===f(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(w,e);var t,n,i,f,v,b,g=(v=w,b=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=m(v);if(b){var n=m(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return y(this,e)});function w(e,t,n,r,o,i,u,c){var s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,w),(s=g.call(this)).mMaterial=null,s.mFailed=!1,s.mLiveSubscriptions=[],s.mLoadProgress=0,s.mSharedKeyOverwrite={},s.mMeshSource=e,s.mNodes=t,s.mParent=n,s.mMaterialId=r,s.mMaterialGroupId=o,s.mOffsetSet=i,s.mSyncHash=u,s.mMaterialManager=c,s.mMeshLoader=new a.j,s}return t=w,n=[{key:"isReady",value:function(){return!!this.mMesh||this.mFailed}},{key:"getLoadProgress",value:function(){return this.mLoadProgress}},{key:"isAttached",value:function(){return!!this.mMesh&&!(0,o.isNullOrUndefined)(this.mMesh.parent)}},{key:"getAttachment",value:function(){return this.mMesh}},{key:"getMesh",value:function(){return this.mMesh}},{key:"getMeshSource",value:function(){return this.mMeshSource}},{key:"getOffsetNodes",value:function(){return this.mOffsetSet}},{key:"getNodes",value:function(){return this.mNodes}},{key:"getMaterial",value:function(){return this.mMaterial}},{key:"getMaterialId",value:function(){return this.mMaterialId}},{key:"getMaterialGroupId",value:function(){return this.mMaterialGroupId}},{key:"clearHighLights",value:function(){(0,o.isNullOrUndefined)(this.mMultiMaterial)||(this.mMultiMaterial[1].dispose(),this.mMultiMaterial=null,(0,o.isNullOrUndefined)(this.mMesh)||(this.mMesh.geometry.clearGroups(),this.mMesh.material=this.mMaterial,this.mMesh.material.needsUpdate=!0))}},{key:"addHighlight",value:function(e,t,n){if(this.mMesh){if((0,o.isNullOrUndefined)(this.mMultiMaterial)){var r=new THREE.MeshBasicMaterial({color:65280,opacity:.5,transparent:!0});this.mMultiMaterial=[this.mMaterial,r],this.mMesh.material=this.mMultiMaterial,this.mMesh.material.needsUpdate=!0}this.mMesh.geometry.addGroup(e,t,n?1:0)}}},{key:"load",value:(i=regeneratorRuntime.mark((function e(t,n){var r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,o){r.mMesh?e(r.mMesh):r._loadMaterial(t,e,o,n)})));case 1:case"end":return e.stop()}}),e)})),f=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=i.apply(e,t);function a(e){p(o,n,r,a,u,"next",e)}function u(e){p(o,n,r,a,u,"throw",e)}a(void 0)}))},function(e,t){return f.apply(this,arguments)})},{key:"attach",value:function(e){if(this.mMesh){var t=this.mParent,n=t.findParentOfTypeName("ProductNode"),r=n.findParentOfTypeName("ProductNode");(0,o.isNullOrUndefined)(r)||(t=n),this.mMesh.userData.sceneObjectRef=t;var i=t.getRenderObject().get3DObject();this.mMesh.userData.transforms=new u.T(i),e.add(this.mMesh),this._updateClippingPlanes(),this.mParent.getRenderState().onRenderObjectAttached.next(this.mMesh),this.mMaterialGroupManager&&this.mLiveSubscriptions.push(this.mMaterialGroupManager.onMaterialChanged.subscribe(this._handleMaterialGroupChange.bind(this)))}}},{key:"dispose",value:function(e){this.mMesh&&(this.mParent.getRenderState().onRenderObjectDetached.next(this.mMesh),(0,o.isNullOrUndefined)(this.mMesh.parent)||this.mMesh.parent.remove(this.mMesh),(0,o.isNullOrUndefined)(this.mMesh.userData.transforms)||(delete this.mMesh.userData.transforms,this.mMesh.userData.transforms=null),this.mMesh.geometry.dispose(),delete this.mMesh),this.mLiveSubscriptions.splice(0).forEach((function(e){return e.unsubscribe()})),delete this.mMaterialGroupManager,this.mMaterial&&(this.mMaterialManager.disposeMaterialById(this.mMaterialId,e),this.mMaterial=null)}},{key:"_updateClippingPlanes",value:function(){if(this.mMesh&&!(0,o.isNullOrUndefined)(this.mMesh.material)){var e=this.mParent.getRenderState().getClippingPlanes(),t=this.mParent.findParentOfTypeName("ProductNode").getValue("clipping_plane");(0,o.isNullOrUndefined)(t)||(e=e.concat([t])),this.mMesh.material.clippingPlanes=e,this.mMesh.material.clipping=e.length>0,this.mMesh.material.clipShadows=e.length>0}}},{key:"_loadMaterial",value:function(e,t,n,r){var i=this,a=this.mParent.findParentOfTypeName("ProductNode"),u=void 0;this.mMaterialGroupId>=0?a.getComponent("materialGroupManager").resolveMaterialGroups().subscribe((function(a){if(i.isInSyncWithHash(r.getHash())){i.mMaterialGroupManager=a;var c=a.getActiveMaterial(i.mMaterialGroupId);(0,o.isNullOrUndefined)(c)||(i.mMaterialId=c),i._resolveMaterial(e,t,n,r,u)}else i.mFailed=!0,n("out of sync")}),(function(){i._resolveMaterial(e,t,n,r,u)})):this._resolveMaterial(e,t,n,r,u)}},{key:"_resolveMaterial",value:function(e,t,n,r,i){var a=this,u=this.mParent.findParentOfTypeName("ProductNode"),c=u.getValue("clipping_plane");void 0!==i||(0,o.isNullOrUndefined)(c)||(i=u.getSceneObjectId()),this.mMaterialId in this.mSharedKeyOverwrite&&(i=this.mSharedKeyOverwrite[this.mMaterialId]),this.mMaterialManager.resolveMaterialById(this.mMaterialId,(function(o){a.isInSyncWithHash(r.getHash())?(a.mMaterial=o,a._loadMesh(o,e,t,n,r,i)):(a._failedToLoad(i),n("out of sync"))}),i).then((function(){a.mMaterialId in a.mSharedKeyOverwrite&&a.mSharedKeyOverwrite[a.mMaterialId]!==i&&a.updateMaterialOverwrite(a.mSharedKeyOverwrite[a.mMaterialId])}),(function(e){l.qL.warn("Failed to resolve material",e)}))}},{key:"_loadMesh",value:function(e,t,n,r,i,a){var u=this;this.mLoadProgress=0,this.mMeshLoader.loadMesh(c.E.cacheUrl+this.mMeshSource,this,e,this.mMaterialId,this.mMaterialManager,t,(function(e){u.mLoadProgress=1,u.mMesh=e,s.h.getInstance().resolveModel(u.mMaterialId).then((function(e){u.mMesh&&!(0,o.isNullOrUndefined)(e)&&(u.mMesh.userData.material={ssrl:e.ssrl},(0,o.isNullOrUndefined)(e.render_order)||(u.mMesh.renderOrder=e.render_order),u._applyCameraLayer(u.mMesh,e.camera_layer),u.mMesh.onBeforeRender=function(t,n,r,i,a,c){if(!(0,o.isNullOrUndefined)(a)&&!0===a.isShaderMaterial&&!(0,o.isNullOrUndefined)(a.uniforms.ssreflection)){a.uniforms.ssreflection.value=u.mMesh.userData.material.ssrl;var s=a.program;(0,o.isNullOrUndefined)(s)||s.getUniforms().setValue(t.getContext(),"ssreflection",e.ssrl)}var l=a.userData||{};!0===l.cameraLayerNeedsUpdate&&(l.cameraLayer=l.cameraLayer||511,u._applyCameraLayer(u.mMesh,l.cameraLayer))}),u.mMaterialId in u.mSharedKeyOverwrite&&u.mSharedKeyOverwrite[u.mMaterialId]!==a&&u.updateMaterialOverwrite(u.mSharedKeyOverwrite[u.mMaterialId])}),(function(){}))}),(function(e){u._failedToLoad(),r(e)}),i,(function(e){u.mLoadProgress=e}))}},{key:"_applyCameraLayer",value:function(e,t){var n=parseInt(t,10);n=isNaN(n)?511:n,e.layers.mask=0,n&r.Albedo?e.layers.enable(1):e.layers.disable(1),n&r.Depth?e.layers.enable(2):e.layers.disable(2),n&r.Normal?e.layers.enable(3):e.layers.disable(3)}},{key:"_handleMaterialGroupChange",value:function(e){var t=this;if(e.id==this.mMaterialGroupId){var n=this.mParent.findParentOfTypeName("ProductNode"),r=n?n.getSceneObjectId():void 0;this.mMaterial&&this.mMaterialManager.disposeMaterialById(this.mMaterialId,r),this.mMaterial=null,this.mParent.getRenderState().requestFrame(),e.material_id in this.mSharedKeyOverwrite&&(r=this.mSharedKeyOverwrite[e.material_id]),this.mLoadingMaterialId=e.material_id,this.mMaterialManager.resolveMaterialById(e.material_id,(function(n){t.mMesh&&!(0,o.isNullOrUndefined)(n)&&t.mLoadingMaterialId===e.material_id?(t.mMaterialId=e.material_id,t.mMesh.material=t.mMaterial=n,s.h.getInstance().resolveModel(t.mMaterialId).then((function(e){!(0,o.isNullOrUndefined)(e)&&t.mMesh&&(t.mMesh.userData.material={ssrl:e.ssrl})}),(function(){})),t._updateClippingPlanes(),t.mParent.getRenderState().requestFrame()):t.mMaterialManager.disposeMaterialById(t.mMaterialId,r),t.mMaterialId in t.mSharedKeyOverwrite&&t.mSharedKeyOverwrite[t.mMaterialId]!==r&&t.updateMaterialOverwrite(t.mSharedKeyOverwrite[t.mMaterialId])}),r).then((function(){}),(function(){}))}}},{key:"_failedToLoad",value:function(e){this.mFailed=!0,this.mMaterialManager.disposeMaterialById(this.mMaterialId,e)}},{key:"updateMaterialOverwrite",value:function(e){var t=this;void 0!==e&&this.mMaterialManager.disposeMaterialById(this.mMaterialId,void 0),this.mMaterialManager.resolveMaterialById(this.mMaterialId,void 0,e).then((function(e){t.mMaterial=e,t.mMaterial.needsUpdate=!0,t.mMesh&&(t.mMesh.material=t.mMaterial)}),(function(){}))}},{key:"setMaterialOverwrite",value:function(e,t){void 0!==t&&(this.mSharedKeyOverwrite[e]=t),this.mMaterialId===e&&this.isAttached()&&this.updateMaterialOverwrite(t)}},{key:"getSharedKeyOverwriteMaterial",value:function(){return this.mSharedKeyOverwrite[this.mMaterialId]}}],n&&d(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),w}(i.$);v.unloadedMaterial=new THREE.MeshBasicMaterial({transparent:!0,opacity:.7,color:"#FFFFFF"})},74478:function(e,t,n){"use strict";n.d(t,{N:function(){return f}}),n(60086),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(90140),o=n(89539),i=n(37526);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function s(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(f,e);var t,n,r,i,a=(r=f,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=l(r);if(i){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return s(this,e)});function f(e,t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),n=a.call(this,e,t);var r=new THREE.Vector3;e.getWorldPosition(r);var o=r.clone().negate().normalize(),i=r.length();return n.mPlane=new THREE.Plane(o,i),n}return t=f,(n=[{key:"getType",value:function(){return f.TypeRTTI}},{key:"getClippingPlane",value:function(){return this.mPlane}},{key:"updatePlane",value:function(){this.get3DObject().updateMatrixWorld(!1);var e=new THREE.Vector3;this.get3DObject().getWorldPosition(e);var t=this.get3DObject().target,n=new THREE.Vector3;t.getWorldPosition(n);var r=e.clone().sub(n);r.normalize(),this.mPlane.setFromNormalAndCoplanarPoint(r,e)}},{key:"onAttached",value:function(e){this.parent.getRenderState().addGlobalClipper(this.mPlane,this.get3DObject().id);var t=this.m3DObject.target;(0,o.isUndefined)(t)||this._attachToRoot(t,e),this.updatePlane()}},{key:"onDetached",value:function(e){this.parent.getRenderState().removeGlobalClipper(this.get3DObject().id);var t=this.m3DObject.target;(0,o.isUndefined)(t)||(0,o.isNullOrUndefined)(t.parent)||t.parent.remove(t)}},{key:"_attachToRoot",value:function(e,t){t&&(0,o.isNullOrUndefined)(t.parent)?t.add(e):t&&!(0,o.isNullOrUndefined)(t.parent)&&this._attachToRoot(e,t.parent)}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(i.m);f.TypeRTTI=new r.r("GlobalClippingObject",i.m.TypeRTTI)},73995:function(e,t,n){"use strict";n(50762),n(95516),n(56027),n(65214),n(37526),n(74478),n(50409),n(99672)},95516:function(e,t,n){"use strict";n.d(t,{r:function(){return l}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(90140),o=n(56027);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function c(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(l,e);var t,n,r,o,i=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=s(r);if(o){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return c(this,e)});function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=i.call(this)).mParentNode=e,t}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}},{key:"parent",get:function(){return this.mParentNode}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(o.f);l.TypeRTTI=new r.r("RenderObject",o.f.TypeRTTI)},50762:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.d(t,{L:function(){return o}}),n(41539),n(39714),n(69070),n(21703);var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.newHash()}var t,n;return t=e,(n=[{key:"getHash",value:function(){return this.mHash}},{key:"newHash",value:function(){return this.mHash=this._guid(),this.mHash}},{key:"_guid",value:function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()+e._gid_count++}}])&&r(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();o._gid_count=1},50409:function(e,t,n){"use strict";n.d(t,{Q:function(){return p}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(90140),o=n(37526),i=n(89539);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},s(e,t)}function l(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(p,e);var t,n,r,o,a=(r=p,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=f(r);if(o){var n=f(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return l(this,e)});function p(){return u(this,p),a.apply(this,arguments)}return t=p,(n=[{key:"getType",value:function(){return p.TypeRTTI}},{key:"onAttached",value:function(e){var t=this.m3DObject.target;(0,i.isUndefined)(t)||this._attachToParent(t,e)}},{key:"onDetached",value:function(e){var t=this.m3DObject.target;(0,i.isUndefined)(t)||(0,i.isNullOrUndefined)(t.parent)||t.parent.remove(t)}},{key:"_attachToParent",value:function(e,t){t&&(0,i.isNullOrUndefined)(t.parent)?t.add(e):t&&!(0,i.isNullOrUndefined)(t.parent)&&t.parent.add(e)}}])&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),p}(o.m);p.TypeRTTI=new r.r("ThreedObjectWithTarget",o.m.TypeRTTI)},37526:function(e,t,n){"use strict";n.d(t,{m:function(){return h}}),n(41539),n(15581),n(2490),n(34514),n(54747),n(21249),n(57640),n(9924),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(95516),o=n(90140),i=n(89539),a=n(14311),u=n(83194),c=n(41142);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t){return f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},f(e,t)}function p(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(h,e);var t,n,r,o,s=(r=h,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=d(r);if(o){var n=d(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return p(this,e)});function h(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),(n=s.call(this,t)).m3DObject=e,n.registerMessageHandler(u.S.TypeRTTI,(function(e){(0,i.isNullOrUndefined)(n.m3DObject)||(n.m3DObject.visible=e.visible)})),n}return t=h,(n=[{key:"getType",value:function(){return h.TypeRTTI}},{key:"get3DObject",value:function(){return this.m3DObject}},{key:"add",value:function(e){if(e.isDerivedTypeOf(h.TypeRTTI)){var t=e.get3DObject();t?(this.m3DObject.add(t),e.onAttached(this.m3DObject)):c.qL.warn("trying to add uninitialized 3D Object")}else{var n=this.parent.getParent();null!==n?n.getRenderObject().add(e):e.onAttachRoot(this)}}},{key:"remove",value:function(e){if(e.isDerivedTypeOf(h.TypeRTTI)){var t=e.get3DObject();t?(this.m3DObject.remove(t),e.onDetached(this.m3DObject)):c.qL.warn("trying to remove uninitialized 3D Object")}else{var n=this.parent.getParent();null!==n?n.getRenderObject().remove(e):e.onDetachRoot(this)}}},{key:"isAttached",value:function(){return!(0,i.isNullOrUndefined)(this.m3DObject)&&!(0,i.isNullOrUndefined)(this.m3DObject.parent)}},{key:"attach",value:function(){this.m3DObject.userData.sceneObjectRef=this.parent;var e=this.parent.getParent();if(null!==e){var t=e.getRenderObject();t&&t.add(this)}else this.parent.getRenderState().getSceneManager().getRenderScene().add(this.m3DObject),this.onAttached(this.parent.getRenderState().getSceneManager().getRenderScene());this.parent.getRenderState().onRenderObjectAttached.next(this.m3DObject)}},{key:"detach",value:function(){if(c.qL.print("detach threed"),this.isAttached()){this.parent.getRenderState().onRenderObjectDetached.next(this.m3DObject);var e=this.parent.getParent();if(null!==e){var t=e.getRenderObject();t&&t.remove(this)}else{var n=this.m3DObject.parent;n.remove(this.m3DObject),this.onDetached(n)}this.m3DObject.userData.sceneObjectRef=null}}},{key:"setNodesUpdated",value:function(){this.isAttached()&&this.parent.getRenderState().dispatchAppEvent(a.G.NodeChanged,this.m3DObject)}},{key:"dispose",value:function(){this._dispose(this.m3DObject)}},{key:"_dispose",value:function(e){var t=this,n=e.children;n&&n instanceof Array&&n.forEach((function(e){t._dispose(e)})),e.shadow&&e.shadow.map&&e.shadow.map.dispose(),this.autoDisposeGeometry&&!(0,i.isNullOrUndefined)(e.geometry)&&e.geometry.dispose()}}])&&l(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),h}(r.r);h.TypeRTTI=new o.r("ThreedObject",r.r.TypeRTTI)},99672:function(e,t,n){"use strict";n.d(t,{p:function(){return d}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(95516),o=n(90140),i=n(89539),a=n(14311),u=n(41142);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},l(e,t)}function f(e,t){if(t&&("object"===c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(d,e);var t,n,r,o,c=(r=d,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=p(r);if(o){var n=p(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return f(this,e)});function d(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(n=c.call(this,t)).m2DObject=e,n}return t=d,(n=[{key:"getType",value:function(){return d.TypeRTTI}},{key:"get2DObject",value:function(){return this.m2DObject}},{key:"add",value:function(e){if(e.isDerivedTypeOf(d.TypeRTTI)){var t=e.get2DObject();t?(this.m2DObject.add(t.element),e.onAttached(this.m2DObject)):u.qL.warn("trying to add uninitialized 2D Object")}else{var n=this.parent.getParent();null!==n?n.getRenderObject().add(e):e.onAttachRoot(this)}}},{key:"remove",value:function(e){if(e.isDerivedTypeOf(d.TypeRTTI)){var t=e.get2DObject();t?(this.m2DObject.remove(t.element),e.onDetached(this.m2DObject)):u.qL.warn("trying to remove uninitialized 2D Object")}else{var n=this.parent.getParent();null!==n?n.getRenderObject().remove(e):e.onDetachRoot(this)}}},{key:"isAttached",value:function(){return!(0,i.isNullOrUndefined)(this.m2DObject)&&this.m2DObject.hasParent()}},{key:"attach",value:function(){this.m2DObject.userData.sceneObjectRef=this.parent;var e=this.parent.getParent();if(null!==e){var t=e.getRenderObject();t&&t.add(this)}else{var n=this.parent.getRenderState().getSceneManager().getRenderScene().userData._editorRef.getUiRenderer();n.add(this.m2DObject.element),this.onAttached(n.renderDom)}this.parent.getRenderState().onRenderObjectAttached.next(this.m2DObject)}},{key:"detach",value:function(){if(u.qL.print("detach twod"),this.isAttached()){this.parent.getRenderState().onRenderObjectDetached.next(this.m2DObject);var e=this.parent.getParent();if(null!==e){var t=e.getRenderObject();t&&t.remove(this)}else{var n=this.parent.getRenderState().getSceneManager().getRenderScene().userData._editorRef.getUiRenderer();n.remove(this.m2DObject.element),this.onDetached(n.renderDom)}this.m2DObject.userData.sceneObjectRef=null}}},{key:"onAttachRoot",value:function(e){var t=this.parent.getRenderState().getSceneManager().getRenderScene().userData._editorRef.getUiRenderer();t.add(this.m2DObject.element),this.onAttached(t.renderDom)}},{key:"onDetachRoot",value:function(e){var t=this.parent.getRenderState().getSceneManager().getRenderScene().userData._editorRef.getUiRenderer();t.remove(this.m2DObject.element),this.onDetached(t.renderDom)}},{key:"setNodesUpdated",value:function(){this.isAttached()&&this.parent.getRenderState().dispatchAppEvent(a.G.NodeChanged,this.m2DObject)}},{key:"dispose",value:function(){this.m2DObject.dispose()}}])&&s(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),d}(r.r);d.TypeRTTI=new o.r("TwodObject",r.r.TypeRTTI)},32469:function(e,t,n){"use strict";n.d(t,{E:function(){return s}}),n(35666),n(41539),n(88674),n(66992),n(78783),n(33948),n(21249),n(57640),n(9924),n(82481),n(69070),n(21703);var r=n(41142),o=n(59342),i=n(89539);function a(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function u(e){a(i,r,o,u,c,"next",e)}function c(e){a(i,r,o,u,c,"throw",e)}u(void 0)}))}}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mImageSource=null,this.mDefaultTexture=null,this.mDefaultTextureSet=!1,this.mImageWidth=0,this.mImageHeight=0,this.mMaterialId=-1,this.mMaterialManager=t}var t,n,a,s;return t=e,n=[{key:"update",value:(s=u(regeneratorRuntime.mark((function e(t,n,r){var a,u,c,s,l,f,p,d,h,y,m,v=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c=!1,s=[],l=r?r.getSceneObjectId():void 0,this.mMaterialId&&-1!==this.mMaterialId&&this.mMaterialId!==t.material_id?s.push(new Promise((function(e,t){v.mMaterialManager.resolveMaterialById(v.mMaterialId,(function(t){e(t)}),l,void 0,r).then((function(){}),(function(t){e(null)}))}))):s.push(Promise.resolve(null)),this.mMaterialId=t.material_id,s.push(new Promise((function(e){v.mMaterialManager.resolveMaterialById(t.material_id,(function(t){e(t)}),l,void 0,r).then((function(){}),(function(){e(null)}))}))),e.next=9,Promise.all(s);case 9:if(f=e.sent,p=f[0],a=f[1],p&&(u=p.map,p.map=this.mDefaultTexture,p.needsUpdate=!0,this.mDefaultTextureSet=!1,c=!0),a){e.next=15;break}return e.abrupt("return");case 15:if(this.mDefaultTextureSet||(this.mDefaultTextureSet=!0,this.mDefaultTexture=a.map),c&&(a.map=u,a.transparent=!0),u||(u=a.map),d=(0,i.isNullOrUndefined)(n.image_source)?t.image_source:n.image_source,h=(0,i.isNullOrUndefined)(n.repeat_type)?t.repeat_type:n.repeat_type,y=(0,i.isNullOrUndefined)(n.size)?t.size_type:n.size,d){e.next=28;break}a.map=this.mDefaultTexture,u=null,this.mImageRepeatType=void 0,this.mImageSizeType=void 0,e.next=40;break;case 28:if(null!==this.mImageSource&&this.mImageSource===d&&h===this.mImageRepeatType&&y===this.mImageSizeType){e.next=40;break}return this.mImageRepeatType=h,this.mImageSizeType=y,e.next=33,this.buildTexture(t,n,a,d);case 33:m=e.sent,u=m.texture,this.mImageWidth=m.width,this.mImageHeight=m.height,a.map=u,a.transparent=!0,a.opacity<o.M.EPS&&(a.opacity=1);case 40:this.mImageSource=d,this.recalculate(t,n,u,this.mImageWidth,this.mImageHeight),a.needsUpdate=!0,e.next=48;break;case 45:e.prev=45,e.t0=e.catch(0),a&&(a.map&&a.map.dispose(),a.map=null,a.transparent=!0,a.needsUpdate=!0);case 48:case"end":return e.stop()}}),e,this,[[0,45]])}))),function(e,t,n){return s.apply(this,arguments)})},{key:"destroy",value:function(){this.mImageSource=null}},{key:"buildTexture",value:(a=u(regeneratorRuntime.mark((function t(n,o,a,u){var c=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,s){if(!a||!u)return s();var l=a.map;l&&l!=c.mDefaultTexture&&(l.dispose(),l=null);var f=document.createElement("img");f.setAttribute("crossorigin","anonymous"),f.addEventListener("load",(function(){var r=document.createElement("canvas");r.setAttribute("crossorigin","anonymous"),r.style.display="none";var a=r.getContext("2d"),u=(0,i.isNullOrUndefined)(o.repeat_type)?n.repeat_type:o.repeat_type,c="clamp"===u?e.TRANSPARENT_PIXELS:0;r.width=e.IMAGE_COPY_SIZE,r.height=e.IMAGE_COPY_SIZE,a.drawImage(f,c,c,r.width-2*c,r.height-2*c),(l=new THREE.Texture(r)).wrapS="clamp"===u?THREE.ClampToEdgeWrapping:THREE.RepeatWrapping,l.wrapT="clamp"===u?THREE.ClampToEdgeWrapping:THREE.RepeatWrapping,l.magFilter=THREE.NearestFilter,l.minFilter=THREE.NearestFilter,l.anisotropy=0,l.needsUpdate=!0;var s=f.width,p=f.height;t({texture:l,width:s,height:p})})),f.addEventListener("error",(function(e){r.qL.error(e),s()})),f.src=u})));case 1:case"end":return t.stop()}}),t)}))),function(e,t,n,r){return a.apply(this,arguments)})},{key:"recalculate",value:function(t,n,r,o,a){if(t&&n&&r){var u=t.ratio,c=(0,i.isNullOrUndefined)(n.size)?t.size_type:n.size,s=o||1,l=a||1,f=Array.isArray(n.offset)&&!(0,i.isNullOrUndefined)(n.offset[0])?n.offset[0]:t.offset_x,p=Array.isArray(n.offset)&&!(0,i.isNullOrUndefined)(n.offset[1])?n.offset[1]:t.offset_y,d=(0,i.isNullOrUndefined)(n.rotation)?t.rotation:n.rotation,h=(0,i.isNullOrUndefined)(n.scale)?t.scale:n.scale,y=u,m=(0,i.isNullOrUndefined)(n.repeat_type)?t.repeat_type:n.repeat_type,v=1/e.IMAGE_COPY_SIZE,b="clamp"===m?e.TRANSPARENT_PIXELS:0,g=new THREE.Vector2(1,1),w=(s>l?1:s/l)/y,_=(s>l?l/s:1)/1,O=1,T=1;switch(c){case"contain":var R=1,S=1;w>_?(R=1,S=_/w):(S=1,R=w/_),O=1/R,T=1/S;break;case"cover":var E=1,P=1;w<_?(E=1,P=_/w):(P=1,E=w/_),O=1/E,T=1/P}var x=(1+v)/(1-v*b*2);g.set(O/x/h,T/x/h);var j=new THREE.Vector2(-f,p).multiplyScalar(.01).multiply(new THREE.Vector2(O,T));r.offset=j,r.center=new THREE.Vector2(.5-j.x,.5-j.y),r.rotation=-THREE.Math.degToRad(d),r.repeat=g.clone(),r.needsUpdate=!0}}}],n&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();s.TRANSPARENT_PIXELS=4,s.IMAGE_COPY_SIZE=1024},15615:function(e,t,n){"use strict";n(83396),n(32469),n(47600),n(37175);var r=n(23556);n.o(r,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return r.AddObjectCommand}}),n.o(r,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return r.AppViewerComponent}}),n.o(r,"ResourceManagerService")&&n.d(t,{ResourceManagerService:function(){return r.ResourceManagerService}}),n.o(r,"ResourceManagerTypes")&&n.d(t,{ResourceManagerTypes:function(){return r.ResourceManagerTypes}}),n.o(r,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return r.SetPositionCommand}}),n.o(r,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return r.SetRotationCommand}})},23556:function(e,t,n){"use strict";var r=n(56252);n.o(r,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return r.AddObjectCommand}}),n.o(r,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return r.AppViewerComponent}}),n.o(r,"ResourceManagerService")&&n.d(t,{ResourceManagerService:function(){return r.ResourceManagerService}}),n.o(r,"ResourceManagerTypes")&&n.d(t,{ResourceManagerTypes:function(){return r.ResourceManagerTypes}}),n.o(r,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return r.SetPositionCommand}}),n.o(r,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return r.SetRotationCommand}}),n(16308),n(50366),n(824),n(95787)},16308:function(e,t,n){"use strict";n.d(t,{n:function(){return c}}),n(69070),n(21703),n(41539),n(88674),n(35666);var r=n(824),o=n(95787),i=n(41142);function a(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i.qL.print("TextToImageController: Attribute version:",n.version),2===n.version?this.mController=new o.Q(t):this.mController=new r.m(t)}var t,n,c,s;return t=e,n=[{key:"update",value:(c=regeneratorRuntime.mark((function e(t,n,r,o){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.mController.update(t,n,r,o));case 1:case"end":return e.stop()}}),e,this)})),s=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=c.apply(e,t);function i(e){a(o,n,r,i,u,"next",e)}function u(e){a(o,n,r,i,u,"throw",e)}i(void 0)}))},function(e,t,n,r){return s.apply(this,arguments)})},{key:"destroy",value:function(){this.mController.destroy()}},{key:"getTextWidth",value:function(e,t,n){return this.mController.getTextWidth(e,t,n)}},{key:"requestFrameSubject",value:function(){return this.mController.requestFrameSubject}}],n&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},824:function(e,t,n){"use strict";n.d(t,{m:function(){return m}}),n(35666),n(21249),n(57640),n(9924),n(41539),n(15581),n(2490),n(34514),n(54747),n(92222),n(88674),n(74916),n(34553),n(68309),n(15306),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(47941),n(82526),n(57327),n(88449),n(59849),n(38880),n(49337),n(33321),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(41142),o=n(89539);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){s(i,r,o,a,u,"next",e)}function u(e){s(i,r,o,a,u,"throw",e)}a(void 0)}))}}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t){return d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},d(e,t)}function h(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(v,e);var t,n,i,a,c,s,m=(c=v,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=y(c);if(s){var n=y(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return h(this,e)});function v(){return f(this,v),m.apply(this,arguments)}return t=v,n=[{key:"update",value:(a=l(regeneratorRuntime.mark((function e(t,n,o,i){var a,u,c,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.resolveContext(t,n,o),u=i?i.getSceneObjectId():void 0,e.prev=2,e.next=5,this.loadFont(a.symbol.font,a.symbol.fileUrl);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),r.qL.warn("Failed to inject font:",e.t0);case 10:return e.prev=10,e.next=13,this.buildTexture(a);case 13:return c=e.sent,e.next=16,this.mMaterialManager.resolveMaterialById(t.material_id,(function(e){null!==e&&(e.map=c[0],"carved"!==t.engraving&&"relief"!==t.engraving||(e.bumpMap=c[1],e.bumpScale=t.engraving_scale/100||.002),e.transparent=!0,e.opacity<1e-5&&(e.opacity=1),e.needsUpdate=!0,s.requestFrameSubject.next())}),u,void 0,i);case 16:e.next=21;break;case 18:e.prev=18,e.t1=e.catch(10),r.qL.error(e.t1);case 21:case"end":return e.stop()}}),e,this,[[2,7],[10,18]])}))),function(e,t,n,r){return a.apply(this,arguments)})},{key:"destroy",value:function(){this.mDiffuseCanvas&&this.mDiffuseCanvas.remove(),this.mDiffuseTexture&&(this.mDiffuseTexture.dispose(),delete this.mDiffuseTexture),this.mNormalTexture&&(this.mNormalTexture.dispose(),delete this.mNormalTexture)}},{key:"buildEngraving",value:function(e,t,n,r,i){(0,o.isNullOrUndefined)(this.mNormalTexture)&&(this.mNormalCanvas=document.createElement("canvas"),this.mNormalCanvas.style.display="none",document.body.appendChild(this.mNormalCanvas),this.mNormalTexture=new THREE.Texture(this.mNormalCanvas));var a=this.mNormalTexture.image.getContext("2d");return a.clearRect(0,0,a.canvas.width,a.canvas.height),a.canvas.width=.5*t,a.canvas.height=.5*i.image.height,e.forEach((function(e){a.font="".concat(.5*r,"px '").concat(e.font,"'"),a.textAlign=n,a.textBaseline=i.text.baseline,"relief"===i.engraving.type?(a.fillStyle="#f3f3f3",a.shadowColor="#181818",a.shadowBlur=2,a.strokeStyle="#181818",a.lineWidth=1,a.strokeText(e.text,.5*e.left,.5*e.top)):(a.fillStyle="#181818",a.shadowColor="#bababa",a.shadowBlur=i.engraving.outline,a.strokeStyle="#bababa",a.lineWidth=.5*i.engraving.outline),a.fillText(e.text,.5*e.left,.5*e.top)})),this.mNormalTexture.needsUpdate=!0,this.mNormalTexture}},{key:"buildTexture",value:(i=l(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var r=t.textValue,i=t.font.family,a=t.font.size,u=[],c=0;if(!(0,o.isNullOrUndefined)(t.symbol.font)&&t.symbol.font.length>0&&!(0,o.isNullOrUndefined)(t.symbol.list)&&t.symbol.list.length>0)for(var s,l=/(&(.*?);)/gi,f=function(){if(s.index>c){var e=s.index-c;u.push({text:r.substr(c,e),font:i,left:0,top:0,width:0})}var n=s[2],o=t.symbol.list.findIndex((function(e){return e.name===n}));o>=0&&t.symbol.list[o].enabled&&u.push({text:t.symbol.list[o].glyph_tag,font:t.symbol.font,left:0,top:0,width:0}),c=s.index+s[0].length};null!==(s=l.exec(r));)f();if(c<r.length&&u.push({text:r.substr(c,r.length-c),font:i,left:0,top:0,width:0}),!(0,o.isNullOrUndefined)(t.symbol.left)&&t.symbol.left.length>0&&!(0,o.isNullOrUndefined)(t.symbol.list)&&t.symbol.list.length>0){var p=t.symbol.list.findIndex((function(e){return e.name===t.symbol.left}));p>=0&&t.symbol.list[p].enabled&&u.unshift({text:t.symbol.list[p].glyph_tag,font:t.symbol.font,left:0,top:0,width:0})}if(!(0,o.isNullOrUndefined)(t.symbol.right)&&t.symbol.right.length>0&&!(0,o.isNullOrUndefined)(t.symbol.list)&&t.symbol.list.length>0){var d=t.symbol.list.findIndex((function(e){return e.name===t.symbol.right}));d>=0&&t.symbol.list[d].enabled&&u.push({text:t.symbol.list[d].glyph_tag,font:t.symbol.font,left:0,top:0,width:0})}(0,o.isNullOrUndefined)(n.mDiffuseTexture)&&(n.mDiffuseCanvas=document.createElement("canvas"),n.mDiffuseCanvas.style.display="none",document.body.appendChild(n.mDiffuseCanvas),n.mDiffuseTexture=new THREE.Texture(n.mDiffuseCanvas),n.mDiffuseTexture.wrapS=THREE.ClampToEdgeWrapping,n.mDiffuseTexture.wrapT=THREE.ClampToEdgeWrapping,t.options.disableAntiAliasing&&(n.mDiffuseTexture.anisotropy=0,n.mDiffuseTexture.magFilter=THREE.NearestFilter,n.mDiffuseTexture.minFilter=THREE.NearestFilter));var h=n.mDiffuseTexture.image.getContext("2d");h.clearRect(0,0,h.canvas.width,h.canvas.height);var y=1-a,m=t.image.padding+t.image.height*y,v=t.image.height*t.image.widthRatio;h.canvas.width=v,h.canvas.height=t.image.height;var b,g=Math.max(t.image.height-m,0),w=Math.max(t.image.height-2*t.image.padding,0),_=0,O=0;b="alphabetic"===t.text.baseline?.5*t.image.height+.5*w:.5*g+.5*m,u.forEach((function(e){h.font="".concat(g,"px '").concat(e.font,"'"),h.textAlign="left",h.textBaseline="middle";var t=h.measureText(e.text);e.width=t.width+0,_+=e.width}));var T="left";switch(t.text.align){case"left":T="left",O=0;break;case"center":T="left",O=.5*v-.5*_;break;case"right":T="right",O=v}var R=O;n.DEBUG&&(h.strokeStyle="#800080",h.strokeRect(10,0,v-20,b),h.strokeStyle="#ff6a00",h.beginPath(),h.moveTo(10,b),h.lineTo(v-10,b),h.lineWidth=1,h.stroke()),u.forEach((function(e){e.top=b,e.left=R,"right"===t.text.align?R-=e.width:R+=e.width})),u.forEach((function(e){t.text.outline>0&&(h.strokeStyle=t.text.outlineColor,h.lineWidth=t.text.outline,h.strokeText(e.text,e.left,e.top)),h.font="".concat(g,"px '").concat(e.font,"'"),h.textAlign=T,h.textBaseline=t.text.baseline,h.fillStyle=t.text.color,h.fillText(e.text,e.left,e.top)})),n.DEBUG&&(h.strokeStyle="#ff0000",h.beginPath(),h.moveTo(0,.5*t.image.height),h.lineTo(v,.5*t.image.height),h.lineWidth=2,h.stroke(),h.strokeStyle="#ff0000",h.strokeRect(0,0,v,t.image.height),h.strokeStyle="#0000ff",h.strokeRect(0,0,v,t.image.padding),h.strokeRect(0,t.image.height-t.image.padding,v,t.image.padding)),n.mDiffuseTexture.needsUpdate=!0;var S=[];if(S.push(n.mDiffuseTexture),"carved"===t.engraving.type||"relief"===t.engraving.type){var E=n.buildEngraving(u,v,T,g,t);S.push(E)}else S.push(null);return e(S)})));case 1:case"end":return e.stop()}}),e)}))),function(e){return i.apply(this,arguments)})},{key:"getTextWidth",value:function(e,t,n){var r=this.resolveContext(e,t,n),o=document.createElement("span"),i=document.createElement("style");o.id="xpv-text-measuring",o.textContent=r.textValue,i.textContent="\n            span#xpv-text-measuring {\n                position: fixed;\n                top: 1px;\n                left: 1px;\n                visibility: hidden;\n                padding: 0;\n                border-width: 0;\n                transform: translate(-100%, -100%);\n                white-space: nowrap;\n                font-size: ".concat(16*r.font.size,"px;\n                font-family: '").concat(r.font.family,"';\n            }\n            span#xpv-text-measuring::before,\n            span#xpv-text-measuring::after { content: none; }\n        "),o.appendChild(i),document.body.appendChild(o);var a=o.getBoundingClientRect().width;return document.body.removeChild(o),a}},{key:"resolveContext",value:function(e,t,n){var r={textValue:(0,o.isNullOrUndefined)(t.value)?e.value||"":t.value,image:{height:e.height||512,widthRatio:e.width_ratio||2.5,padding:e.padding_y||e.padding||0},text:{outline:e.outline||0,color:e.color||"#ffffff",outlineColor:e.outline_color||"#ffffff",align:t.position||e.position||"center",transform:e.text_transform||"none",autoResize:e.auto_resize||!1,resizeThreshold:e.resize_threshold||6,baseline:e.text_baseline||"middle"},font:{size:t.size||1,family:t.font||e.available_fonts&&e.available_fonts[0]||"Arial"},symbol:{font:e.symbol_font||"",list:e.symbol_list||[],fileUrl:e.symbol_file_url,left:t.symbol_left||null,right:t.symbol_right||null},options:u({disableAntiAliasing:!1},n),engraving:{type:e.engraving||"none",outline:e.engraving_outline||0,scale:e.engraving_scale||1}};return r.textValue=function(e){switch(r.text.transform){case"lowercase":return e.toLowerCase();case"capitalize":return e.replace(/(^| )[a-z]/g,(function(e){return e.toUpperCase()}));case"uppercase":return e.toUpperCase();default:return e}}(r.textValue),r.text.autoResize&&(r.font.size*=Math.min(1,r.text.resizeThreshold/r.textValue.length)),r}}],n&&p(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),v}(n(50366).Y)},95787:function(e,t,n){"use strict";n.d(t,{Q:function(){return b}}),n(35666),n(21249),n(57640),n(9924),n(66992),n(41539),n(88674),n(78783),n(33948),n(15581),n(2490),n(34514),n(54747),n(92222),n(74916),n(34553),n(68309),n(15306),n(51532),n(10072),n(23042),n(99137),n(71957),n(96306),n(103),n(74592),n(58276),n(35082),n(12813),n(18222),n(38563),n(50336),n(7512),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(47941),n(82526),n(57327),n(88449),n(59849),n(38880),n(49337),n(33321),n(41817),n(32165);var r=n(41142),o=n(89539),i=n(50366),a=n(68009);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function p(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){f(i,r,o,a,u,"next",e)}function u(e){f(i,r,o,a,u,"throw",e)}a(void 0)}))}}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t){return y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},y(e,t)}function m(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(b,e);var t,n,i,u,c,l,f=(c=b,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=v(c);if(l){var n=v(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return m(this,e)});function b(){return d(this,b),f.apply(this,arguments)}return t=b,n=[{key:"update",value:(u=p(regeneratorRuntime.mark((function e(t,n,o,i){var u,c,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=this.resolveContext(t,n,o),c=i?i.getSceneObjectId():void 0,e.prev=2,e.next=5,this.mMaterialManager.resolveMaterialById(t.material_id,function(){var e=p(regeneratorRuntime.mark((function e(n){var o,i,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:return o=!a.F.isNonEmptyString(u.font.family)||s.isFontLoaded(u.font.family),i=!a.F.isNonEmptyString(u.symbol.font)||s.isFontLoaded(u.symbol.font),o&&i||(c=s.createInvisibleTexture(),n.map=c,n.transparent=!0,n.needsUpdate=!0,s.requestFrameSubject.next()),e.prev=5,e.next=8,Promise.all([s.loadFont(u.symbol.font,u.symbol.fileUrl),s.loadFont(u.font.family)]);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(5),r.qL.error("Failed to load font:",e.t0);case 13:return e.next=15,s.buildTexture(u);case 15:l=e.sent,n.map=l[0],"carved"!==t.engraving&&"relief"!==t.engraving||(n.bumpMap=l[1],n.bumpScale=t.engraving_scale/100||.002),n.transparent=!0,n.opacity<1e-5&&(n.opacity=1),n.needsUpdate=!0,s.requestFrameSubject.next();case 22:case"end":return e.stop()}}),e,null,[[5,10]])})));return function(t){return e.apply(this,arguments)}}(),c,void 0,i);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),r.qL.error(e.t0);case 10:case"end":return e.stop()}}),e,this,[[2,7]])}))),function(e,t,n,r){return u.apply(this,arguments)})},{key:"destroy",value:function(){this.mDiffuseCanvas&&this.mDiffuseCanvas.remove(),this.mDiffuseTexture&&(this.mDiffuseTexture.dispose(),delete this.mDiffuseTexture),this.mNormalTexture&&(this.mNormalTexture.dispose(),delete this.mNormalTexture)}},{key:"buildEngraving",value:function(e,t,n,r,i){(0,o.isNullOrUndefined)(this.mNormalTexture)&&(this.mNormalCanvas=document.createElement("canvas"),this.mNormalCanvas.style.display="none",this.mNormalCanvas.style.letterSpacing="0px",this.mNormalCanvas.style.lineHeight="0px",document.body.appendChild(this.mNormalCanvas),this.mNormalTexture=new THREE.Texture(this.mNormalCanvas));var a=this.mNormalTexture.image.getContext("2d");return a.clearRect(0,0,a.canvas.width,a.canvas.height),a.canvas.width=.5*t,a.canvas.height=.5*i.image.height,e.forEach((function(e){a.font="normal normal normal ".concat(.5*r,"px/0px '").concat(e.fontFamily,"'"),a.textAlign=n,a.textBaseline="alphabetic","relief"===i.engraving.type?(a.fillStyle="#f3f3f3",a.shadowColor="#181818",a.shadowBlur=2,a.strokeStyle="#181818",a.lineWidth=1,a.strokeText(e.text,.5*e.x,.5*e.y)):(a.fillStyle="#181818",a.shadowColor="#bababa",a.shadowBlur=i.engraving.outline,a.strokeStyle="#bababa",a.lineWidth=.5*i.engraving.outline),a.fillText(e.text,.5*e.x,.5*e.y)})),this.mNormalTexture.needsUpdate=!0,this.mNormalTexture}},{key:"buildTexture",value:(i=p(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var r=t.textValue,i=t.font.family,a=Math.max(0,t.font.size),u=t.image.height*t.image.widthRatio,c=t.image.height,s=[],l=0;if(!(0,o.isNullOrUndefined)(t.symbol.font)&&t.symbol.font.length>0&&!(0,o.isNullOrUndefined)(t.symbol.list)&&t.symbol.list.length>0)for(var f,p=/(&(.*?);)/gi,d=function(){if(f.index>l){var e=f.index-l;s.push({text:r.substr(l,e),fontFamily:i})}var n=f[2],o=t.symbol.list.findIndex((function(e){return e.name===n}));o>=0&&t.symbol.list[o].enabled&&s.push({text:t.symbol.list[o].glyph_tag,fontFamily:t.symbol.font}),l=f.index+f[0].length};null!==(f=p.exec(r));)d();if(l<r.length&&s.push({text:r.substr(l,r.length-l),fontFamily:i}),!(0,o.isNullOrUndefined)(t.symbol.left)&&t.symbol.left.length>0&&!(0,o.isNullOrUndefined)(t.symbol.list)&&t.symbol.list.length>0){var h=t.symbol.list.findIndex((function(e){return e.name===t.symbol.left}));h>=0&&t.symbol.list[h].enabled&&s.unshift({text:t.symbol.list[h].glyph_tag,fontFamily:t.symbol.font})}if(!(0,o.isNullOrUndefined)(t.symbol.right)&&t.symbol.right.length>0&&!(0,o.isNullOrUndefined)(t.symbol.list)&&t.symbol.list.length>0){var y=t.symbol.list.findIndex((function(e){return e.name===t.symbol.right}));y>=0&&t.symbol.list[y].enabled&&s.push({text:t.symbol.list[y].glyph_tag,fontFamily:t.symbol.font})}(0,o.isNullOrUndefined)(n.mDiffuseTexture)&&(n.mDiffuseCanvas=document.createElement("canvas"),n.mDiffuseCanvas.style.display="none",n.mDiffuseCanvas.style.letterSpacing="0px",n.mDiffuseCanvas.style.lineHeight="0px",document.body.appendChild(n.mDiffuseCanvas),n.mDiffuseTexture=new THREE.Texture(n.mDiffuseCanvas),n.mDiffuseTexture.wrapS=THREE.ClampToEdgeWrapping,n.mDiffuseTexture.wrapT=THREE.ClampToEdgeWrapping,t.options.disableAntiAliasing&&(n.mDiffuseTexture.anisotropy=0,n.mDiffuseTexture.magFilter=THREE.NearestFilter,n.mDiffuseTexture.minFilter=THREE.NearestFilter));var m=n.mDiffuseTexture.image.getContext("2d");m.clearRect(0,0,m.canvas.width,m.canvas.height);var v=Math.max(c-2*t.image.padding_y,0)*a,b=n.resolveFontMetrics(t.font.family);m.canvas.width=u,m.canvas.height=c;var g,w=0,_=b.height*(v/b.fontSize),O=0,T=b.baselineHeight*(v/b.fontSize);if(s.forEach((function(e){m.font="normal normal normal ".concat(v,"px/0px '").concat(e.fontFamily,"'"),m.textAlign="left",m.textBaseline="alphabetic";var t=m.measureText(e.text);e.width=t.width+0,e.height=_,w+=e.width})),t.text.autoResize&&"bounding_box"===t.text.autoResizeType){var R=Math.max(0,u-2*t.image.padding_x);if(R<w){var S=R/w;w=R,_*=S,v*=S,T*=S,s.forEach((function(e){e.width*=S,e.height*=S}))}}g="alphabetic"===t.text.baseline?c-t.image.padding_y:.5*c+T;var E="left";switch(t.text.align){case"left":E="left",O=t.image.padding_x;break;case"center":E="left",O=.5*u-.5*w;break;case"right":E="left",O=u-t.image.padding_x-w}var P=O;s.forEach((function(e){e.x=P,e.y=g,P+=e.width})),s.forEach((function(e){if(n.DEBUG){var r=e.x,o="alphabetic"===t.text.baseline?g-e.height:.5*c-.5*e.height;m.strokeStyle="#800080",m.strokeRect(r,o,e.width,e.height),m.strokeStyle="#ffd700",m.beginPath(),m.moveTo(t.image.padding_x,g),m.lineTo(u-t.image.padding_x,g),m.lineWidth=1,m.stroke()}m.font="normal normal normal ".concat(v,"px/0px '").concat(e.fontFamily,"'"),m.textAlign=E,m.textBaseline="alphabetic",t.text.outline>0&&(m.strokeStyle=t.text.outlineColor,m.lineWidth=t.text.outline,m.strokeText(e.text,e.x,e.y)),m.fillStyle=t.text.color,m.fillText(e.text,e.x,e.y)})),n.DEBUG&&(m.strokeStyle="#ff0000",m.beginPath(),m.moveTo(0,.5*c),m.lineTo(u,.5*c),m.lineWidth=2,m.stroke(),m.strokeStyle="#ff0000",m.strokeRect(0,0,u,c),m.strokeStyle="#0000ff",m.strokeRect(t.image.padding_x,0,u-2*t.image.padding_x,t.image.padding_y),m.strokeRect(t.image.padding_x,c-t.image.padding_y,u-2*t.image.padding_x,t.image.padding_y),m.strokeRect(0,0,t.image.padding_x,c),m.strokeRect(u-t.image.padding_x,0,t.image.padding_x,c)),n.mDiffuseTexture.needsUpdate=!0;var x=[];if(x.push(n.mDiffuseTexture),"carved"===t.engraving.type||"relief"===t.engraving.type){var j=n.buildEngraving(s,u,E,v,t);x.push(j)}else x.push(null);return e(x)})));case 1:case"end":return e.stop()}}),e)}))),function(e){return i.apply(this,arguments)})},{key:"getTextWidth",value:function(e,t,n){var r=this.resolveContext(e,t,n),o=document.createElement("span"),i=document.createElement("style");o.id="xpv-text-measuring",o.textContent=r.textValue,i.textContent="\n            span#xpv-text-measuring {\n                position: fixed;\n                top: 1px;\n                left: 1px;\n                visibility: hidden;\n                padding: 0;\n                border-width: 0;\n                transform: translate(-100%, -100%);\n                white-space: nowrap;\n                font-size: ".concat(16*r.font.size,"px;\n                font-family: '").concat(r.font.family,"';\n            }\n            span#xpv-text-measuring::before,\n            span#xpv-text-measuring::after { content: none; }\n        "),o.appendChild(i),document.body.appendChild(o);var a=o.getBoundingClientRect().width;return document.body.removeChild(o),a}},{key:"calculateTextMetrics",value:function(e,t,n){var r=n,i=4*t,a=4*t,u={left:0,right:i,top:0,bottom:a};(0,o.isNullOrUndefined)(this.mTextMetricsCanvas)&&(this.mTextMetricsCanvas=document.createElement("canvas"),this.mTextMetricsCanvas.style.display="none",this.mTextMetricsCanvas.style.letterSpacing="normal",this.mTextMetricsCanvas.style.lineHeight="0px",document.body.appendChild(this.mTextMetricsCanvas));var c=this.mTextMetricsCanvas.getContext("2d",{alpha:!1});c.canvas.width=i,c.canvas.height=a,c.fillStyle="#ffffff",c.fillRect(0,0,i,a),c.font="normal normal normal ".concat(t,"px/0px '").concat(e,"'"),c.textAlign="left",c.textBaseline="alphabetic",c.fillStyle="#000000";for(var s=.33*i,l=.5*a+.33*t,f=0;f<r.length;f++)c.fillText(r[f],s,l);for(var p=c.getImageData(0,0,i,a).data,d=i,h=a,y=-1,m=-1,v=!1,b=0;b<a;b++){v=!1;for(var g=0;g<i;g++){var w=b*(4*i)+4*g;p[w]+p[w+1]+p[w+2]===0&&(v=!0,g<d&&(d=g),g>y&&(y=g))}v&&(b<h&&(h=b),b>m&&(m=b))}return u.left=d<i?d:0,u.top=h<a?h:0,u.right=y>0?y+1:i,u.bottom=m>0?m+1:a,{width:u.right-u.left,height:u.bottom-u.top}}},{key:"resolveFontMetrics",value:function(e){if(!b.sFontMetrics.has(e)){var t=b.sFontSize,n=this.calculateTextMetrics(e,t,"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890.:,;'\"(!?)+-*/=@"),r=this.calculateTextMetrics(e,t,"eo");b.sFontMetrics.set(e,{fontSize:t,width:n.width,height:n.height,baselineHeight:.5*r.height})}return b.sFontMetrics.get(e)}},{key:"resolveContext",value:function(e,t,n){var r={textValue:(0,o.isNullOrUndefined)(t.value)?e.value||"":t.value,image:{height:e.height||512,widthRatio:e.width_ratio||2.5,padding_x:e.padding_x||0,padding_y:e.padding_y||0},text:{outline:e.outline||0,color:e.color||"#ffffff",outlineColor:e.outline_color||"#ffffff",align:t.position||e.position||"center",transform:e.text_transform||"none",autoResize:e.auto_resize||!1,autoResizeType:e.auto_resize_type||"character",resizeThreshold:e.resize_threshold||6,baseline:e.text_baseline||"middle"},font:{size:t.size||1,family:t.font||e.available_fonts&&e.available_fonts[0]||"Arial"},symbol:{font:e.symbol_font||"",list:e.symbol_list||[],fileUrl:e.symbol_file_url,left:t.symbol_left||null,right:t.symbol_right||null},options:s({disableAntiAliasing:!1},n),engraving:{type:e.engraving||"none",outline:e.engraving_outline||0,scale:e.engraving_scale||1}};return r.textValue=function(e){switch(r.text.transform){case"lowercase":return e.toLowerCase();case"capitalize":return e.replace(/(^| )[a-z]/g,(function(e){return e.toUpperCase()}));case"uppercase":return e.toUpperCase();default:return e}}(r.textValue),r.text.autoResize&&"character"===r.text.autoResizeType&&(r.font.size*=Math.min(1,r.text.resizeThreshold/r.textValue.length)),r}},{key:"createInvisibleTexture",value:function(){if((0,o.isNullOrUndefined)(b.sTransparentTexture)){var e=document.createElement("canvas");e.style.display="none",e.style.backgroundColor="transparent",e.width=1,e.height=1,document.body.appendChild(e),b.sTransparentTexture=new THREE.Texture(e),b.sTransparentTexture.wrapS=THREE.ClampToEdgeWrapping,b.sTransparentTexture.wrapT=THREE.ClampToEdgeWrapping,e.getContext("2d",{alpha:!0}).clearRect(0,0,e.width,e.height),b.sTransparentTexture.needsUpdate=!0}return b.sTransparentTexture}}],n&&h(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),b}(i.Y);b.sFontSize=128,b.sFontMetrics=new Map},56252:function(){},50366:function(e,t,n){"use strict";n.d(t,{Y:function(){return s}}),n(35666),n(41539),n(88674),n(19601),n(92222),n(26699),n(69070),n(21703);var r=n(70211),o=n(70456),i=n(68009),a=n(41142);function u(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.DEBUG=!1,this.requestFrameSubject=new r.xQ,this.mMaterialManager=t}var t,n,s,l;return t=e,n=[{key:"loadFont",value:(s=regeneratorRuntime.mark((function t(n){var r,u=this,c=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=c.length>1&&void 0!==c[1]?c[1]:"",t.abrupt("return",new Promise((function(t){if(!i.F.isNonEmptyString(n))return t(!1);var c=u.resolveFontName(n);if(void 0===e.sFontLoader[c]){if(e.sFontLoader[c]={finished:!1,subject:new o.t(1)},i.F.isNonEmptyString(r)&&u.createLink(n,r),u.createSpan(n),u.isFontAvailable(n))return e.sFontLoader[c].finished=!0,e.sFontLoader[c].subject.next(!0),e.sFontLoader[c].subject.complete(),void t(!0);a.qL.print("Font not available! Using FontFaceObserver to load font.."),new FontFaceObserver(n,{weight:400,style:"normal",stretch:"normal"}).load(null,1500).then((function(){e.sFontLoader[c].finished=!0,e.sFontLoader[c].subject.next(!0),e.sFontLoader[c].subject.complete()}),(function(t){a.qL.error("Failed to load font:",t),e.sFontLoader[c].finished=!0,e.sFontLoader[c].subject.next(!1),e.sFontLoader[c].subject.complete()}))}e.sFontLoader[c].subject.subscribe((function(){t(!0)}),(function(e){a.qL.error(e),t(!1)}))})));case 2:case"end":return t.stop()}}),t)})),l=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=s.apply(e,t);function i(e){u(o,n,r,i,a,"next",e)}function a(e){u(o,n,r,i,a,"throw",e)}i(void 0)}))},function(e){return l.apply(this,arguments)})},{key:"createSpan",value:function(e){var t=this.resolveFontName(e)+"_preload";if(!document.getElementById(t)){var n=document.createElement("span");n.id=t,n.textContent="Preload font: "+e,Object.assign(n.style,{position:"fixed",opacity:"0","pointer-events":"none","font-family":"'".concat(e,"'")}),document.body.appendChild(n)}}},{key:"createLink",value:function(e,t){var n=this.resolveFontName(e);if(!document.getElementById(n)){var r="\n                @font-face {\n                    font-family: '".concat(e,"';\n                    src: url('").concat(t,"') format('truetype');\n                }\n            "),o=document.createElement("link");o.setAttribute("id",n),o.setAttribute("rel","stylesheet"),o.setAttribute("href","data:text/css;charset=UTF-8,"+encodeURIComponent(r)),document.head.appendChild(o)}}},{key:"resolveFontName",value:function(e){return"$__font__".concat(e)}},{key:"isFontLoaded",value:function(t){var n=this.resolveFontName(t);return e.sFontLoader[n]&&e.sFontLoader[n].finished}},{key:"isFontAvailable",value:function(e){return document.fonts&&document.fonts.check('normal normal 16px "'.concat(e,'"'))?(a.qL.print("Font installed locally! [using experiment api]"),!0):!(document.fonts||!["arial","calibri","comic sans","comic sans ms","consolas","courier","courier new","georgia","garamond","helvetica","impact","tahoma","trebuchet ms","monospace","sans-serif","serif","times","times new roman","verdana","wingdings"].includes(e.toLowerCase())||(a.qL.print("Font installed locally! [using custom list]"),0))}}],n&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();s.sFontLoader={}},47600:function(e,t,n){"use strict";n.d(t,{o:function(){return y}}),n(74916),n(64765),n(41539),n(15581),n(2490),n(34514),n(54747),n(47941),n(88674),n(77601),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(83396),o=n(89539),i=n(41142),a=n(68009),u=n(4530),c=n(37175),s=n(70456);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},p(e,t)}function d(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(m,e);var t,n,r,u,l,y=(u=m,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(u);if(l){var n=h(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return d(this,e)});function m(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,m),(n=y.call(this,e)).mTextureReady=new s.t(1),n.mImageLoader=t,n}return t=m,r=[{key:"isSupported",value:function(e){return a.F.isValidURL(e)&&/\.(jpg|jpeg|png)$/gm.test(e)}}],(n=[{key:"getType",value:function(){return c.C.TypeRTTI}},{key:"getTexture",value:function(){return this.mTexture}},{key:"onTextureReady",value:function(){return this.mTextureReady}},{key:"loadTexture",value:function(e,t,n){var r=this;return this.mTexture=new THREE.Texture,this.mImageLoader.load(e,(function(i){var a=e.search(/\.(jpg|jpeg)$/)>0||0===e.search(/^data:image\/jpeg/);r.mTexture.format=a?THREE.RGBFormat:THREE.RGBAFormat,r.mTexture.image=i,r.mTexture.wrapS=THREE.RepeatWrapping,r.mTexture.wrapT=THREE.RepeatWrapping,r.mTexture.anisotropy=4,(0,o.isNullOrUndefined)(t)||Object.keys(t).forEach((function(e){e in r.mTexture&&(r.mTexture[e]=t[e])})),r.mTexture.needsUpdate=!0,n(Promise.resolve(r.mTexture)),r.mTextureReady.next(r.mTexture)}),(function(){}),(function(e){i.qL.error(e),n(Promise.reject(e)),r.mTextureReady.error("Failed to load the texture"),r.mTextureReady.next(null)})),this.mTexture}},{key:"unload",value:function(){this.mTexture.dispose(),this.mTexture=void 0,this.mTextureReady.unsubscribe(),this.mTextureReady=new s.t(1)}}])&&f(t.prototype,n),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),m}(r.M);y.TypeRTTI=new u.rz("TextureSVGController",r.M.TypeRTTI)},37175:function(e,t,n){"use strict";n.d(t,{C:function(){return x}}),n(35666),n(82481),n(41539),n(88674),n(47042),n(78783),n(66992),n(33948),n(34553),n(40561),n(69720),n(39714),n(69600),n(21249),n(57640),n(9924),n(74916),n(77601),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(91038),n(68309);var r=n(83396),o=n(41142),i=n(89539),a=n(68009),u=n(4530),c=n(70456),s=n(48155),l=n(64520),f=(n(57327),n(88449),n(2490),n(59849),n(85827),n(25387),n(72608),n(49743),n(48675),n(92990),n(18927),n(33105),n(35035),n(74345),n(7174),n(32846),n(44731),n(77209),n(96319),n(58867),n(37789),n(33739),n(29368),n(14483),n(12056),n(3462),n(30678),n(27462),n(33824),n(55021),n(12974),n(15016),n(8922),n(37380),n(1118),n(5835),n(23767),n(8585),n(8970),n(84444),n(68696),n(91058),n(4192));function p(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function d(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){p(i,r,o,a,u,"next",e)}function u(e){p(i,r,o,a,u,"throw",e)}a(void 0)}))}}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var y=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r,o,i,a;return t=e,null,n=[{key:"create",value:function(e,t,n,r){var o=new RgbQuant({initColors:4096,method:2,boxSize:[64,64],colors:void 0!==r.maxColors?r.maxColors||1:256,minHueCols:0,dithKern:null,dithSerp:!1,colorDist:"manhattan"}),i=document.createElement("canvas");i.style.display="none",i.style.background="transparent",document.body.appendChild(i),i.width=t,i.height=n;var a=i.getContext("2d");if(!a)throw new Error("Unable to create context");a.imageSmoothingEnabled=!1,a.imageSmoothingQuality="high";var u=t*(e.width<=e.height?e.width/e.height:1),c=n*(e.width>e.height?e.height/e.width:1);return a.clearRect(0,0,i.width,i.height),a.drawImage(e,0,0,e.width,e.height,0,0,u,c),{rgbQuant:o,canvas:i,context:a,originalImage:e,palette:void 0,colorRegions:void 0,reduced:0}}},{key:"destroy",value:function(e){e.palette&&delete e.palette,e.colorRegions&&delete e.colorRegions,e.context&&delete e.context,e.canvas&&(e.canvas.remove(),delete e.canvas),e.originalImage&&delete e.originalImage,e.rgbQuant&&delete e.rgbQuant}},{key:"scanImage",value:(a=d(regeneratorRuntime.mark((function t(n){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.sLibsLoaded){t.next=2;break}throw new Error("Palletization engine should be created before usage.");case 2:if(n.rgbQuant.sample(n.originalImage),r=n.rgbQuant.palette(!0)){t.next=6;break}throw new Error("Unable to build palette.");case 6:n.palette=r,n.rgbQuant.palLocked=!0,n.colorRegions=r.filter((function(e){return!!e})).map((function(e){var t=[e[0]/255,e[1]/255,e[2]/255];return"#".concat((new THREE.Color).fromArray(t).getHexString())}));case 9:case"end":return t.stop()}}),t)}))),function(e){return a.apply(this,arguments)})},{key:"reduceColors",value:(i=d(regeneratorRuntime.mark((function t(n){var r,o,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.sLibsLoaded){t.next=2;break}throw new Error("Palletization engine should be created before usage.");case 2:if(r=n.rgbQuant.reduce(n.canvas,1,void 0,void 0)){t.next=5;break}throw new Error("Unable to quantizes image.");case 5:o=new Uint8ClampedArray(r),i=new ImageData(o,n.canvas.width,n.canvas.height),n.context.clearRect(0,0,n.canvas.width,n.canvas.height),n.context.putImageData(i,0,0),n.reduced+=1;case 10:case"end":return t.stop()}}),t)}))),function(e){return i.apply(this,arguments)})},{key:"overridePalette",value:(o=d(regeneratorRuntime.mark((function t(n,r){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.sLibsLoaded){t.next=2;break}throw new Error("Palletization engine should be created before usage.");case 2:if(n.colorRegions.length===r.paletteOverride.length){t.next=4;break}throw new Error("Given palette override is not in sync as palette.");case 4:return t.abrupt("return",{outputImage:n.canvas});case 5:case"end":return t.stop()}}),t)}))),function(e,t){return o.apply(this,arguments)})},{key:"isLibLoaded",value:function(){return e.sLibsLoaded}},{key:"loadLibraries",value:(r=d(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.sLibsLoadingPromise||(e.sLibsLoadingPromise=new Promise((function(t,n){f.W.loadScript("https://cdn.jsdelivr.net/npm/rgbquant@1.1.2/src/rgbquant.min.js").then((function(){e.sLibsLoaded=!0,t()}),(function(t){e.sLibsLoaded=!1,n(t)}))}))),t.abrupt("return",e.sLibsLoadingPromise);case 2:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})},{key:"unloadLibraries",value:function(){e.sLibsLoaded=!0}},{key:"hex2rgb",value:function(e){var t="#"===e[0]?e.substring(1):e;return 3===t.length?[parseInt(String(17*parseInt(t[0],16)),10),parseInt(String(17*parseInt(t[1],16)),10),parseInt(String(17*parseInt(t[2],16)),10)]:6===t.length?[parseInt(String(parseInt(t[0]+t[1],16)),10),parseInt(String(parseInt(t[2]+t[3],16)),10),parseInt(String(parseInt(t[4]+t[5],16)),10)]:[0,0,0]}}],n&&h(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();y.sLibsLoaded=!1;var m,v=n(10288);function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function g(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=w(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw i}}}}function w(e,t){if(e){if("string"==typeof e)return _(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(e,t):void 0}}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function O(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function T(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){O(i,r,o,a,u,"next",e)}function u(e){O(i,r,o,a,u,"throw",e)}a(void 0)}))}}function R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function S(e,t){return S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},S(e,t)}function E(e,t){if(t&&("object"===b(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function P(e){return P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},P(e)}!function(e){e[e.Tablet=2048]="Tablet",e[e.Desktop=2048]="Desktop",e[e.Mobile=1024]="Mobile"}(m||(m={}));var x=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&S(e,t)}(I,e);var t,n,r,u,f,p,d,h,b,O,x,j,C,k,M,D,A=(M=I,D=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=P(M);if(D){var n=P(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return E(this,e)});function I(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,I),(t=A.call(this,e)).mTextureReady=new c.t(1),t.mediaService=s.y.getInstance(),t}return t=I,n=[{key:"getType",value:function(){return I.TypeRTTI}},{key:"getTexture",value:function(){return this.mTexture}},{key:"onTextureReady",value:function(){return this.mTextureReady}},{key:"loadTexture",value:function(e,t,n){var r=this;return this.svgEngine=new l.S,this.mTexture=new THREE.Texture,this.mTexture.format=THREE.RGBAFormat,this.mTexture.anisotropy=4,this.loadSVGFile(e).then(function(){var e=T(regeneratorRuntime.mark((function e(t){var o,i,a,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.svgEngine.create(t,I.RENDER_RESOLUTION);case 2:o=e.sent,i=o.width,a=o.height,u=o.canvas,r.svgEngine.render(),r.mTexture.image=u,r.mTexture.repeat.set(i/I.RENDER_RESOLUTION,a/I.RENDER_RESOLUTION),r.mTexture.offset.set(0,1-a/I.RENDER_RESOLUTION),r.mTexture.needsUpdate=!0,n(Promise.resolve(r.mTexture)),r.mTextureReady.next(r.mTexture);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){(0,o.vU)(e),n(Promise.reject(e)),r.mTextureReady.error("Failed to load the texture"),r.mTextureReady.next(null)})),this.mTexture}},{key:"getBoundaries",value:(k=T(regeneratorRuntime.mark((function e(t){var n,r=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]&&r[1],e.abrupt("return",this.svgEngine.getBoundaries(t,n));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return k.apply(this,arguments)})},{key:"getBoundariesSync",value:function(e,t,n){return this.svgEngine.getBoundariesSync(e,t,n)}},{key:"getCanvasBoundaries",value:function(){return this.svgEngine.getCanvasBoundaries()}},{key:"checkPointInsideObject",value:function(e,t,n,r){return this.svgEngine.checkPointInsideObject(e,t,n,r)}},{key:"updatePalette",value:(C=T(regeneratorRuntime.mark((function e(t,n,r){var o,i,a,u,c,s,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(y.isLibLoaded()){e.next=3;break}return e.next=3,y.loadLibraries();case 3:if(o=r.palletization_max_colors||1,this.mImagePalette||(this.mImagePalette=y.create(t,I.RENDER_RESOLUTION,I.RENDER_RESOLUTION,{maxColors:o})),this.mImagePalette.palette){e.next=9;break}return e.next=8,y.scanImage(this.mImagePalette);case 8:this.mImagePalette.colorRegions&&(n.palletization_palette=this.mImagePalette.colorRegions.slice(0));case 9:if(0!==this.mImagePalette.reduced){e.next=12;break}return e.next=12,y.reduceColors(this.mImagePalette);case 12:for(i=this.mImagePalette.colorRegions,a=n.palletization_palette_override||[],u=[],c=0;c<i.length;c++)s=i[c],c<a.length&&a[c]&&(s=a[c]),u.push(s);return e.next=18,y.overridePalette(this.mImagePalette,{paletteOverride:u});case 18:return l=e.sent,e.abrupt("return",{palletizedImage:this.mImagePalette.canvas,outputImage:l.outputImage,palette:i});case 20:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return C.apply(this,arguments)})},{key:"updateImage",value:(j=T(regeneratorRuntime.mark((function e(t,n,r,o){var a,u,c,s,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.svgEngine.resolveObject(t,r.clipping_element);case 2:if(a=e.sent,u=this.getSourceFromMedia(n),c=this.getCoverageType(r,o),(0,i.isNullOrUndefined)(r)||(0,i.isNullOrUndefined)(a)){e.next=10;break}return s=r.offset[0],l=r.offset[1],e.next=10,this.svgEngine.updateImageProperties(a,u,c,s,l,o.offset_unit,r.rotation,r.scale);case 10:return e.abrupt("return",this.renderTexture());case 11:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return j.apply(this,arguments)})},{key:"updateCanvas",value:(x=T(regeneratorRuntime.mark((function e(t,n,r){var o,i,a,u,c,s,l,f,p=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.svgEngine.getGroupWrapped(n,t);case 2:if(o=e.sent){e.next=5;break}return e.abrupt("return",null);case 5:d=o.group._objects,i=function(e){if(Array.isArray(e))return _(e)}(d)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(d)||w(d)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),a=g(r.canvas.objects),e.prev=7,c=regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.value,(n=i.findIndex((function(e){return e.id===t.id})))>=0&&i.splice(n,1),e.next=5,p.svgEngine.upSertObjectToGroupOnCanvas(t,o.group);case 5:case"end":return e.stop()}}),e)})),a.s();case 10:if((u=a.n()).done){e.next=14;break}return e.delegateYield(c(),"t0",12);case 12:e.next=10;break;case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(7),a.e(e.t1);case 19:return e.prev=19,a.f(),e.finish(19);case 22:s=g(i);try{for(s.s();!(l=s.n()).done;)f=l.value,this.svgEngine.removeFromGroup(f,n)}catch(e){s.e(e)}finally{s.f()}return e.abrupt("return",this.renderTexture());case 25:case"end":return e.stop()}var d}),e,this,[[7,16,19,22]])}))),function(e,t,n){return x.apply(this,arguments)})},{key:"updateVisibility",value:(O=T(regeneratorRuntime.mark((function e(t){var n,r,o,i,a,u,c,s,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0,r=Object.entries(t);case 1:if(!(n<r.length)){e.next=27;break}return f=r[n],p=2,o=function(e){if(Array.isArray(e))return e}(f)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,u=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){u=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(u)throw o}}return i}}(f,p)||w(f,p)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),i=o[0],a=o[1],e.next=5,this.svgEngine.resolveObjectsLike(i);case 5:u=e.sent,c=g(u),e.prev=7,c.s();case 9:if((s=c.n()).done){e.next=16;break}return(l=s.value).visible=a,e.next=14,this.svgEngine.updateElementProperty(l,"visible",a);case 14:e.next=9;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(7),c.e(e.t0);case 21:return e.prev=21,c.f(),e.finish(21);case 24:n++,e.next=1;break;case 27:return e.abrupt("return",this.renderTexture());case 28:case"end":return e.stop()}var f,p}),e,this,[[7,18,21,24]])}))),function(e){return O.apply(this,arguments)})},{key:"updatePattern",value:(b=T(regeneratorRuntime.mark((function e(t,n,r){var o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.svgEngine.resolveObject(t);case 2:return o=e.sent,i=this.getSourceFromMedia(n),e.next=6,this.svgEngine.updatePattern(o,i,r.scale);case 6:return e.abrupt("return",this.renderTexture());case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return b.apply(this,arguments)})},{key:"updateText",value:(h=T(regeneratorRuntime.mark((function e(t,n,r){var o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.svgEngine.resolveObject(t,n.clipping_element);case 2:return o=e.sent,i=n.text,e.next=6,this.svgEngine.updateTextProperty(o,i,n.multiline,n.size,n.font,n.scale,n.rotation,n.offset,r.offset_unit,n.color,n.styles,n.align);case 6:return e.abrupt("return",this.renderTexture());case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return h.apply(this,arguments)})},{key:"updateElement",value:(d=T(regeneratorRuntime.mark((function e(t,n){var r,o,a,u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.svgEngine.resolveObjectsLike(t);case 2:if(r=e.sent,!(0,i.isNullOrUndefined)(n.value)){e.next=5;break}return e.abrupt("return",this.renderTexture());case 5:o="style."===n.attribute.substr(0,6)?n.attribute.substring(6):n.attribute,a=g(r),e.prev=7,a.s();case 9:if((u=a.n()).done){e.next=15;break}return c=u.value,e.next=13,this.svgEngine.updateElementProperty(c,o,n.value);case 13:e.next=9;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(7),a.e(e.t0);case 20:return e.prev=20,a.f(),e.finish(20);case 23:return e.abrupt("return",this.renderTexture());case 24:case"end":return e.stop()}}),e,this,[[7,17,20,23]])}))),function(e,t){return d.apply(this,arguments)})},{key:"updateGradient",value:(p=T(regeneratorRuntime.mark((function e(t,n){var r,o,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.svgEngine.resolveObjectsLike(t,n.clipping_element);case 2:r=e.sent,o=g(r),e.prev=4,o.s();case 6:if((i=o.n()).done){e.next=12;break}return a=i.value,e.next=10,this.svgEngine.updateGradientProperty(a,n.primary_color,n.secondary_color,n.direction);case 10:e.next=6;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),o.e(e.t0);case 17:return e.prev=17,o.f(),e.finish(17);case 20:return e.abrupt("return",this.renderTexture());case 21:case"end":return e.stop()}}),e,this,[[4,14,17,20]])}))),function(e,t){return p.apply(this,arguments)})},{key:"unload",value:function(){this.mTexture.dispose(),this.mTexture=void 0,this.mTextureReady.unsubscribe(),this.mTextureReady=new c.t(1),this.svgEngine.destroy(),delete this.svgEngine,this.mImagePalette&&(y.destroy(this.mImagePalette),delete this.mImagePalette)}},{key:"getCurrentRawTextFromObject",value:(f=T(regeneratorRuntime.mark((function e(t,n){var r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.svgEngine.resolveObject(t,n.clipping_element);case 2:return r=e.sent,(o=this.svgEngine.initTextObject(r,n.multiline)).element.set({text:n.text.toString()}),e.abrupt("return",o.element._textLines.map((function(e){return e.join("")})).join("\n")||n.text);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return f.apply(this,arguments)})},{key:"getSourceFromMedia",value:function(e){return"string"==typeof e||(0,i.isNullOrUndefined)(e)?e:e.source_url}},{key:"getCoverageType",value:function(e,t){return(0,i.isNullOrUndefined)(e)||(0,i.isNullOrUndefined)(e.size)?(0,i.isNullOrUndefined)(t)||(0,i.isNullOrUndefined)(t.size_type)?"cover":t.size_type:e.size}},{key:"renderTexture",value:function(){var e=this;return this.throttleTextureHandle||(this.throttleTextureHandle=window.setTimeout((function(){delete e.throttleTextureHandle,e.svgEngine.render(),e.mTexture.needsUpdate=!0}),16)),this.mTexture}},{key:"loadSVGFile",value:(u=T(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){window.fetch(t,{method:"GET",mode:"cors",cache:"no-cache",credentials:"omit",redirect:"follow"}).then((function(t){if(!n.mTexture||!n.svgEngine)return r("Texture is unloaded");t&&t.ok?e(t.text()):r("Could not download SVG file")}),(function(e){r(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(e){return u.apply(this,arguments)})}],r=[{key:"isSupported",value:function(e){return a.F.isValidURL(e)&&/\.(svg)$/gm.test(e)}},{key:"setRenderResolution",value:function(){return(0,v.Em)()?m.Tablet:(0,v.tq)()?m.Mobile:m.Desktop}}],n&&R(t.prototype,n),r&&R(t,r),Object.defineProperty(t,"prototype",{writable:!1}),I}(r.M);x.TypeRTTI=new u.rz("TextureSVGController",r.M.TypeRTTI),x.RENDER_RESOLUTION=x.setRenderResolution()},83396:function(e,t,n){"use strict";n.d(t,{M:function(){return s}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(4530);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},a(e,t)}function u(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function c(e){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},c(e)}var s=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}(f,e);var t,n,r,o,s,l=(o=f,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=c(o);if(s){var n=c(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return u(this,e)});function f(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(t=l.call(this)).mTextureKey=e,t}return t=f,r=[{key:"isSupported",value:function(e){return!1}}],(n=[{key:"getType",value:function(){return f.TypeRTTI}},{key:"getTextureKey",value:function(){return this.mTextureKey}}])&&i(t.prototype,n),r&&i(t,r),Object.defineProperty(t,"prototype",{writable:!1}),f}(r.e3);s.TypeRTTI=new r.rz("TextureController")},50217:function(e,t,n){"use strict";n.d(t,{KX:function(){return i.K},VY:function(){return o.V}});var r,o=n(72519),i=n(34668);!function(e){e.aliceblue="#f0f8ff",e.antiquewhite="#faebd7",e.aqua="#00ffff",e.aquamarine="#7fffd4",e.azure="#f0ffff",e.beige="#f5f5dc",e.bisque="#ffe4c4",e.black="#000000",e.blanchedalmond="#ffebcd",e.blue="#0000ff",e.blueviolet="#8a2be2",e.brown="#a52a2a",e.burlywood="#deb887",e.cadetblue="#5f9ea0",e.chartreuse="#7fff00",e.chocolate="#d2691e",e.coral="#ff7f50",e.cornflowerblue="#6495ed",e.cornsilk="#fff8dc",e.crimson="#dc143c",e.cyan="#00ffff",e.darkblue="#00008b",e.darkcyan="#008b8b",e.darkgoldenrod="#b8860b",e.darkgray="#a9a9a9",e.darkgreen="#006400",e.darkgrey="#a9a9a9",e.darkkhaki="#bdb76b",e.darkmagenta="#8b008b",e.darkolivegreen="#556b2f",e.darkorange="#ff8c00",e.darkorchid="#9932cc",e.darkred="#8b0000",e.darksalmon="#e9967a",e.darkseagreen="#8fbc8f",e.darkslateblue="#483d8b",e.darkslategray="#2f4f4f",e.darkslategrey="#2f4f4f",e.darkturquoise="#00ced1",e.darkviolet="#9400d3",e.deeppink="#ff1493",e.deepskyblue="#00bfff",e.dimgray="#696969",e.dimgrey="#696969",e.dodgerblue="#1e90ff",e.firebrick="#b22222",e.floralwhite="#fffaf0",e.forestgreen="#228b22",e.fuchsia="#ff00ff",e.gainsboro="#dcdcdc",e.ghostwhite="#f8f8ff",e.goldenrod="#daa520",e.gold="#ffd700",e.gray="#808080",e.green="#008000",e.greenyellow="#adff2f",e.grey="#808080",e.honeydew="#f0fff0",e.hotpink="#ff69b4",e.indianred="#cd5c5c",e.indigo="#4b0082",e.ivory="#fffff0",e.khaki="#f0e68c",e.lavenderblush="#fff0f5",e.lavender="#e6e6fa",e.lawngreen="#7cfc00",e.lemonchiffon="#fffacd",e.lightblue="#add8e6",e.lightcoral="#f08080",e.lightcyan="#e0ffff",e.lightgoldenrodyellow="#fafad2",e.lightgray="#d3d3d3",e.lightgreen="#90ee90",e.lightgrey="#d3d3d3",e.lightpink="#ffb6c1",e.lightsalmon="#ffa07a",e.lightseagreen="#20b2aa",e.lightskyblue="#87cefa",e.lightslategray="#778899",e.lightslategrey="#778899",e.lightsteelblue="#b0c4de",e.lightyellow="#ffffe0",e.lime="#00ff00",e.limegreen="#32cd32",e.linen="#faf0e6",e.magenta="#ff00ff",e.maroon="#800000",e.mediumaquamarine="#66cdaa",e.mediumblue="#0000cd",e.mediumorchid="#ba55d3",e.mediumpurple="#9370db",e.mediumseagreen="#3cb371",e.mediumslateblue="#7b68ee",e.mediumspringgreen="#00fa9a",e.mediumturquoise="#48d1cc",e.mediumvioletred="#c71585",e.midnightblue="#191970",e.mintcream="#f5fffa",e.mistyrose="#ffe4e1",e.moccasin="#ffe4b5",e.navajowhite="#ffdead",e.navy="#000080",e.oldlace="#fdf5e6",e.olive="#808000",e.olivedrab="#6b8e23",e.orange="#ffa500",e.orangered="#ff4500",e.orchid="#da70d6",e.palegoldenrod="#eee8aa",e.palegreen="#98fb98",e.paleturquoise="#afeeee",e.palevioletred="#db7093",e.papayawhip="#ffefd5",e.peachpuff="#ffdab9",e.peru="#cd853f",e.pink="#ffc0cb",e.plum="#dda0dd",e.powderblue="#b0e0e6",e.purple="#800080",e.rebeccapurple="#663399",e.red="#ff0000",e.rosybrown="#bc8f8f",e.royalblue="#4169e1",e.saddlebrown="#8b4513",e.salmon="#fa8072",e.sandybrown="#f4a460",e.seagreen="#2e8b57",e.seashell="#fff5ee",e.sienna="#a0522d",e.silver="#c0c0c0",e.skyblue="#87ceeb",e.slateblue="#6a5acd",e.slategray="#708090",e.slategrey="#708090",e.snow="#fffafa",e.springgreen="#00ff7f",e.steelblue="#4682b4",e.tan="#d2b48c",e.teal="#008080",e.thistle="#d8bfd8",e.tomato="#ff6347",e.turquoise="#40e0d0",e.violet="#ee82ee",e.wheat="#f5deb3",e.white="#ffffff",e.whitesmoke="#f5f5f5",e.yellow="#ffff00",e.yellowgreen="#9acd32"}(r||(r={}))},34668:function(e,t,n){"use strict";var r;n.d(t,{K:function(){return r}}),function(e){e.DIFFUSE="DiffuseMap",e.ALPHA="AlphaMap",e.ENVIRONMENT="EnvironmentMap",e.BUMP="BumpMap",e.DISPLACEMENT="DisplacementMap",e.NORMAL="NormalMap",e.METALNESS="MetalnessMap",e.ROUGHNESS="RoughnessMap",e.AO="AOMap",e.LIGHTMAP="LightMap",e.EMISSIVE="EmissiveMap",e.GLOSSINESS="GlossinessMap"}(r||(r={}))},72519:function(e,t,n){"use strict";var r;n.d(t,{V:function(){return r}}),function(e){e[e.Unloaded=0]="Unloaded",e[e.InProgress=1]="InProgress",e[e.Ready=2]="Ready",e[e.Error=3]="Error"}(r||(r={}))},87181:function(e,t,n){"use strict";n.d(t,{MaterialMapEnum:function(){return r.KX},ResourceManagerService:function(){return a.t},ResourceManagerTypes:function(){return a.O}});var r=n(50217),o=n(77226);n.o(o,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return o.AddObjectCommand}}),n.o(o,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return o.AppViewerComponent}}),n.o(o,"ResourceManagerService")&&n.d(t,{ResourceManagerService:function(){return o.ResourceManagerService}}),n.o(o,"ResourceManagerTypes")&&n.d(t,{ResourceManagerTypes:function(){return o.ResourceManagerTypes}}),n.o(o,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return o.SetPositionCommand}}),n.o(o,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return o.SetRotationCommand}}),n(77195);var i=n(15615);n.o(i,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return i.AddObjectCommand}}),n.o(i,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return i.AppViewerComponent}}),n.o(i,"ResourceManagerService")&&n.d(t,{ResourceManagerService:function(){return i.ResourceManagerService}}),n.o(i,"ResourceManagerTypes")&&n.d(t,{ResourceManagerTypes:function(){return i.ResourceManagerTypes}}),n.o(i,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return i.SetPositionCommand}}),n.o(i,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return i.SetRotationCommand}});var a=n(80115)},77226:function(e,t,n){"use strict";var r=n(97279);n.o(r,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return r.AddObjectCommand}}),n.o(r,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return r.AppViewerComponent}}),n.o(r,"ResourceManagerService")&&n.d(t,{ResourceManagerService:function(){return r.ResourceManagerService}}),n.o(r,"ResourceManagerTypes")&&n.d(t,{ResourceManagerTypes:function(){return r.ResourceManagerTypes}}),n.o(r,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return r.SetPositionCommand}}),n.o(r,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return r.SetRotationCommand}});var o=n(4007);n.o(o,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return o.AddObjectCommand}}),n.o(o,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return o.AppViewerComponent}}),n.o(o,"ResourceManagerService")&&n.d(t,{ResourceManagerService:function(){return o.ResourceManagerService}}),n.o(o,"ResourceManagerTypes")&&n.d(t,{ResourceManagerTypes:function(){return o.ResourceManagerTypes}}),n.o(o,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return o.SetPositionCommand}}),n.o(o,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return o.SetRotationCommand}});var i=n(55306);n.o(i,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return i.AddObjectCommand}}),n.o(i,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return i.AppViewerComponent}}),n.o(i,"ResourceManagerService")&&n.d(t,{ResourceManagerService:function(){return i.ResourceManagerService}}),n.o(i,"ResourceManagerTypes")&&n.d(t,{ResourceManagerTypes:function(){return i.ResourceManagerTypes}}),n.o(i,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return i.SetPositionCommand}}),n.o(i,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return i.SetRotationCommand}});var a=n(74505);n.o(a,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return a.AddObjectCommand}}),n.o(a,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return a.AppViewerComponent}}),n.o(a,"ResourceManagerService")&&n.d(t,{ResourceManagerService:function(){return a.ResourceManagerService}}),n.o(a,"ResourceManagerTypes")&&n.d(t,{ResourceManagerTypes:function(){return a.ResourceManagerTypes}}),n.o(a,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return a.SetPositionCommand}}),n.o(a,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return a.SetRotationCommand}});var u=n(29215);n.o(u,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return u.AddObjectCommand}}),n.o(u,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return u.AppViewerComponent}}),n.o(u,"ResourceManagerService")&&n.d(t,{ResourceManagerService:function(){return u.ResourceManagerService}}),n.o(u,"ResourceManagerTypes")&&n.d(t,{ResourceManagerTypes:function(){return u.ResourceManagerTypes}}),n.o(u,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return u.SetPositionCommand}}),n.o(u,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return u.SetRotationCommand}});var c=n(50080);n.o(c,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return c.AddObjectCommand}}),n.o(c,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return c.AppViewerComponent}}),n.o(c,"ResourceManagerService")&&n.d(t,{ResourceManagerService:function(){return c.ResourceManagerService}}),n.o(c,"ResourceManagerTypes")&&n.d(t,{ResourceManagerTypes:function(){return c.ResourceManagerTypes}}),n.o(c,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return c.SetPositionCommand}}),n.o(c,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return c.SetRotationCommand}});var s=n(60564);n.o(s,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return s.AddObjectCommand}}),n.o(s,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return s.AppViewerComponent}}),n.o(s,"ResourceManagerService")&&n.d(t,{ResourceManagerService:function(){return s.ResourceManagerService}}),n.o(s,"ResourceManagerTypes")&&n.d(t,{ResourceManagerTypes:function(){return s.ResourceManagerTypes}}),n.o(s,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return s.SetPositionCommand}}),n.o(s,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return s.SetRotationCommand}});var l=n(98877);n.o(l,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return l.AddObjectCommand}}),n.o(l,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return l.AppViewerComponent}}),n.o(l,"ResourceManagerService")&&n.d(t,{ResourceManagerService:function(){return l.ResourceManagerService}}),n.o(l,"ResourceManagerTypes")&&n.d(t,{ResourceManagerTypes:function(){return l.ResourceManagerTypes}}),n.o(l,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return l.SetPositionCommand}}),n.o(l,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return l.SetRotationCommand}});var f=n(26887);n.o(f,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return f.AddObjectCommand}}),n.o(f,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return f.AppViewerComponent}}),n.o(f,"ResourceManagerService")&&n.d(t,{ResourceManagerService:function(){return f.ResourceManagerService}}),n.o(f,"ResourceManagerTypes")&&n.d(t,{ResourceManagerTypes:function(){return f.ResourceManagerTypes}}),n.o(f,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return f.SetPositionCommand}}),n.o(f,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return f.SetRotationCommand}});var p=n(4833);n.o(p,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return p.AddObjectCommand}}),n.o(p,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return p.AppViewerComponent}}),n.o(p,"ResourceManagerService")&&n.d(t,{ResourceManagerService:function(){return p.ResourceManagerService}}),n.o(p,"ResourceManagerTypes")&&n.d(t,{ResourceManagerTypes:function(){return p.ResourceManagerTypes}}),n.o(p,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return p.SetPositionCommand}}),n.o(p,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return p.SetRotationCommand}});var d=n(34069);n.o(d,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return d.AddObjectCommand}}),n.o(d,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return d.AppViewerComponent}}),n.o(d,"ResourceManagerService")&&n.d(t,{ResourceManagerService:function(){return d.ResourceManagerService}}),n.o(d,"ResourceManagerTypes")&&n.d(t,{ResourceManagerTypes:function(){return d.ResourceManagerTypes}}),n.o(d,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return d.SetPositionCommand}}),n.o(d,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return d.SetRotationCommand}});var h=n(21114);n.o(h,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return h.AddObjectCommand}}),n.o(h,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return h.AppViewerComponent}}),n.o(h,"ResourceManagerService")&&n.d(t,{ResourceManagerService:function(){return h.ResourceManagerService}}),n.o(h,"ResourceManagerTypes")&&n.d(t,{ResourceManagerTypes:function(){return h.ResourceManagerTypes}}),n.o(h,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return h.SetPositionCommand}}),n.o(h,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return h.SetRotationCommand}})},4007:function(){},97279:function(){},74505:function(){},29215:function(){},26887:function(){},50080:function(){},4833:function(){},98877:function(){},60564:function(){},34069:function(){},21114:function(){},55306:function(){},77195:function(e,t,n){"use strict";n(60674),n(36805),n(78026)},36805:function(e,t,n){"use strict";n.d(t,{P:function(){return P}}),n(35666),n(41539),n(88674),n(15581),n(2490),n(34514),n(54747),n(47941),n(9653),n(34553),n(57327),n(88449),n(59849),n(82772),n(21703),n(38862),n(69070);var r=n(89539),o=n(29844),i=(n(40561),n(68309),n(84217)),a=n(50217),u=n(9896),c=n(70456),s=(n(54678),n(91058),n(42615)),l=n(41142),f=n(48155),p=n(10288);function d(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var y=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o,a;return t=e,null,n=[{key:"parseModel",value:function(t,n,o,a){var u=this,c=new Array;Object.keys(n).forEach((function(r){u.mapKey(r)in t&&c.push(e.setMaterialProperty(t,r,n[r],o))})),(0,s.D)(c).pipe((0,i.q)(1)).subscribe((function(){(0,r.isNullOrUndefined)(a)||a(n)}),(function(e){(0,r.isNullOrUndefined)(a)||a(null)})),t.needsUpdate=!0}},{key:"setMaterialProperty",value:(o=regeneratorRuntime.mark((function t(n,o,i,a){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,u){switch(o=e.mapKey(o)){case"id":case"uuid":case"type":default:return t(!1);case"shading":return"flatshading"===i.toLowerCase()&&(n.flatShading=!0),"smoothshading"===i.toLowerCase()&&(n.flatShading=!1),t(!0);case"side":return"backside"===i.toLowerCase()&&(n.side=THREE.BackSide),"frontside"===i.toLowerCase()&&(n.side=THREE.FrontSide),"doubleside"===i.toLowerCase()&&(n.side=THREE.DoubleSide),t(!0);case"combine":return"multiply"===i.toLowerCase()&&(n[o]=THREE.MultiplyOperation),"mixoperation"===i.toLowerCase()&&(n[o]=THREE.MixOperation),"addoperation"===i.toLowerCase()&&(n[o]=THREE.AddOperation),t(!0);case"blending":switch(i.toLowerCase()){case"normalblending":n[o]=THREE.NormalBlending;break;case"additiveblending":n[o]=THREE.AdditiveBlending;break;case"subtractiveblending":n[o]=THREE.SubtractiveBlending;break;case"multiplyblending":n[o]=THREE.MultiplyBlending}return t(!0);case"depthTest":case"depthWrite":case"fog":case"premultipliedAlpha":case"transparent":case"wireframe":case"enableFresnelDiff":case"enableFresnelEnv":case"enableSpecularGlossiness":return n[o]=!0===i||"1"==i||"true"==i,t(!0);case"alphaTest":case"opacity":case"aoMapIntensity":case"lightMapIntensity":case"envMapIntensity":case"reflectivity":case"refractionRatio":case"wireframeLinewidth":case"emissiveIntensity":case"bumpScale":case"displacementScale":case"displacementBias":case"shininess":case"metalness":case"roughness":case"clearCoat":case"clearCoatRoughness":case"envMapScale":case"fresnelDiffScale":case"fresnelDiffBias":case"fresnelDiffPower":case"fresnelEnvBias":case"fresnelEnvScale":case"fresnelEnvPower":case"glossiness":var c=parseFloat(i);return n[o]=isNaN(c)?0:c,t(!0);case"normalScale":var s=parseFloat(i);return s=isNaN(s)?1:s,n[o]=new THREE.Vector2(s,s),t(!0);case"color":case"emissive":case"specular":case"fresnelDiffColorLeft":var d=parseInt(i,10),h=255&d,y=d>>8&255,m=d>>16&255;n[o]=new THREE.Color(m/255,y/255,h/255),t(!0);break;case"alphaMap":case"aoMap":case"lightMap":case"map":case"specularMap":case"emissiveMap":case"bumpMap":case"displacementMap":case"normalMap":case"metalnessMap":case"roughnessMap":case"gradientMap":case"glossinessMap":return(0,r.isNullOrUndefined)(n[o])||(a.disposeTexture(n[o]),n[o]=null),(0,r.isNullOrUndefined)(i)?t(!1):void a.resolveResourceById(i,(0,p.tq)()?1:0,{},(function(e){n[o]=e,t(!0)})).then((function(){}),(function(){}));case"envMap":return(0,r.isNullOrUndefined)(n[o])||(a.disposeTexture(n[o]),n[o]=null),(0,r.isNullOrUndefined)(i)?t(!1):void f.y.getInstance().resolveModel(i).then((function(e){var u=e.name,c=THREE.EquirectangularReflectionMapping;(0,r.isString)(u)&&-1!==u.indexOf("enable_refraction_e")&&(c=THREE.EquirectangularRefractionMapping),a.resolveResourceById(i,0,{mapping:c},(function(e){n[o]=e,n.needsUpdate=!0,t(!0)})).then((function(){}),(function(){}))}),(function(e){t(!1)})).then((function(){}),(function(){}));case"camera_layer":return n.userData=n.userData||{},n.userData.cameraLayer=i,n.userData.cameraLayerNeedsUpdate=!0,l.qL.print("setting camera layer: ",n),t(!0)}u("detected property key is not returning a resolve")})));case 1:case"end":return t.stop()}}),t)})),a=function(){var e=this,t=arguments;return new Promise((function(n,r){var i=o.apply(e,t);function a(e){d(i,n,r,a,u,"next",e)}function u(e){d(i,n,r,a,u,"throw",e)}a(void 0)}))},function(e,t,n,r){return a.apply(this,arguments)})},{key:"mapKey",value:function(e){switch(e){case"alpha_test":return"alphaTest";case"depth_test":return"depthTest";case"depth_write":return"depthWrite";case"premultiplied_alpha":return"premultipliedAlpha";case"alpha_map":return"alphaMap";case"ao_map":return"aoMap";case"ao_map_intensity":return"aoMapIntensity";case"env_map":return"envMap";case"light_map":return"lightMap";case"light_map_intensity":return"lightMapIntensity";case"refraction_ratio":return"refractionRatio";case"specular_map":return"specularMap";case"wireframe_line_width":return"wireframeLinewidth";case"emissive_map":return"emissiveMap";case"emissive_map_intensity":case"emissive_intensity":return"emissiveIntensity";case"bump_map":return"bumpMap";case"bump_scale":return"bumpScale";case"displacement_map":return"displacementMap";case"displacement_scale":return"displacementScale";case"displacement_bias":return"displacementBias";case"normal_map":return"normalMap";case"normal_scale":return"normalScale";case"clear_coat":return"clearCoat";case"clear_coat_roughness":return"clearCoatRoughness";case"env_map_intensity":return"envMapIntensity";case"metalness_map":return"metalnessMap";case"roughness_map":return"roughnessMap";case"env_map_scale":return"envMapScale";case"enable_fresnel_diff":return"enableFresnelDiff";case"fresnel_diff_bias":return"fresnelDiffBias";case"fresnel_diff_scale":return"fresnelDiffScale";case"fresnel_diff_power":return"fresnelDiffPower";case"fresnel_diff_color_left":return"fresnelDiffColorLeft";case"enable_fresnel_env":return"enableFresnelEnv";case"fresnel_env_bias":return"fresnelEnvBias";case"fresnel_env_scale":return"fresnelEnvScale";case"fresnel_env_power":return"fresnelEnvPower";case"enable_specular_glossiness":return"enableSpecularGlossiness";case"glossiness_map":return"glossinessMap";case"gradient_map":return"gradientMap"}return e}},{key:"disposeMaterial",value:function(e,t){Object.keys(e).forEach((function(n){switch(n){case"alphaMap":case"aoMap":case"envMap":case"lightMap":case"map":case"specularMap":case"emissiveMap":case"bumpMap":case"displacementMap":case"normalMap":case"metalnessMap":case"roughnessMap":case"gradientMap":case"glossinessMap":(0,r.isNullOrUndefined)(e[n])||t.disposeTexture(e[n])}})),e.dispose()}}],n&&h(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),m=n(34668),v=n(99556),b=n(89002);function g(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function w(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){g(i,r,o,a,u,"next",e)}function u(e){g(i,r,o,a,u,"throw",e)}a(void 0)}))}}function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var O=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mState=a.VY.Unloaded,this.mReferenceCount=0,this.mReadySubscriptions=[],this.mMapOverwrite=[],this.mId=t,this.mForcedType=r,this.mTextureManager=n}var t,n,o,s,l,f;return t=e,n=[{key:"setColorOverwrite",value:function(e){this.mColorOverwrite=e,this.applyColorOverwrite((0,r.isNullOrUndefined)(this.mColorOverwrite)?new THREE.Color:this.mColorOverwrite)}},{key:"setMapOverwrite",value:(f=w(regeneratorRuntime.mark((function e(t,n){var o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,i){if((0,r.isNullOrUndefined)(t))return i("incorrect type");var a=o.mMapOverwrite.findIndex((function(e){return e.type===t}));a>=0?o.mMapOverwrite[a].textureId=n:(o.mMapOverwrite.push({type:t,textureId:n}),a=o.mMapOverwrite.length-1),o.applyMapOverwrite(t,o.mMapOverwrite[a].textureId).then((function(t){e(t)}),(function(e){i(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(e,t){return f.apply(this,arguments)})},{key:"applyColorOverwrite",value:function(e){(0,r.isNullOrUndefined)(this.mMaterial)||(this.mMaterial.color=e,this.mMaterial.needsUpdate=!0)}},{key:"applyMapOverwrite",value:(l=w(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,r.isNullOrUndefined)(t)){e.next=2;break}throw new Error("incorrect type");case 2:if(!(0,r.isNullOrUndefined)(this.mMaterial)){e.next=4;break}throw new Error("material is not ready");case 4:return e.next=6,this.applyMapOverwriteTexture(this.mMaterial,t,(0,r.isNullOrUndefined)(n)?null:n);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return l.apply(this,arguments)})},{key:"applyMapOverwriteTexture",value:(s=w(regeneratorRuntime.mark((function e(t,n,r){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,null===(o=this.getMaterialMapTypeName(n))){e.next=7;break}return e.next=5,y.setMaterialProperty(t,o,r,this.mTextureManager);case 5:return t.needsUpdate=!0,e.abrupt("return",t[o]);case 7:e.next=11;break;case 9:e.prev=9,e.t0=e.catch(0);case 11:return e.abrupt("return",null);case 12:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(e,t,n){return s.apply(this,arguments)})},{key:"getMaterialMapTypeName",value:function(e){switch(e){case m.K.DIFFUSE:return"map";case m.K.ALPHA:return"alphaMap";case m.K.ENVIRONMENT:return"envMap";case m.K.BUMP:return"bumpMap";case m.K.DISPLACEMENT:return"displacementMap";case m.K.NORMAL:return"normalMap";case m.K.METALNESS:return"metalnessMap";case m.K.ROUGHNESS:return"roughnessMap";case m.K.AO:return"aoMap";case m.K.LIGHTMAP:return"lightMap";case m.K.EMISSIVE:return"emissiveMap";case m.K.GLOSSINESS:return"glossinessMap";default:return null}}},{key:"resolveMaterial",value:(o=w(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,o){if(!(0,r.isNullOrUndefined)(t))switch(n.mState){case a.VY.Unloaded:case a.VY.InProgress:n.mReadySubscriptions.push(t);break;case a.VY.Ready:t(n.mMaterial);break;case a.VY.Error:t(null)}return n.mState===a.VY.Ready?(n.mReferenceCount+=1,e(n.mMaterial)):n.mState===a.VY.Error?o("Failed to resolve material id: ".concat(n.mId)):((0,r.isNullOrUndefined)(n.mMaterialLoader)&&(n.mState=a.VY.InProgress,n.mMaterialLoader=new c.t(1),u.h.getInstance().resolveModel(n.mId).then((function(e){n.mModel=e,n.mMaterialLoader.next(n._createMaterial())}),(function(e){n.mState=a.VY.Error,n._dispatchFinalize(n.mMaterial),n.mMaterialLoader.error(e)}))),void n.mMaterialLoader.pipe((0,i.q)(1)).subscribe((function(t){n.mReferenceCount+=1,e(t)}),(function(e){o(e)})))})));case 1:case"end":return e.stop()}}),e)}))),function(e){return o.apply(this,arguments)})},{key:"_dispatchFinalize",value:function(e){this.mReadySubscriptions.splice(0).forEach((function(t){return t(e)}))}},{key:"_createMaterial",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.mMaterial=new(THREE[(0,r.isNullOrUndefined)(this.mForcedType)?this.mModel.type:this.mForcedType])({}),this.mMaterial.name="res_id:".concat(this.mId),y.parseModel(this.mMaterial,this.mModel,this.mTextureManager,(function(){if(e.mState!==a.VY.Unloaded)if((0,r.isNullOrUndefined)(e.mColorOverwrite)||e.applyColorOverwrite(e.mColorOverwrite),!(0,r.isNullOrUndefined)(e.mMapOverwrite)&&e.mMapOverwrite.length>0){for(var n=[],o=0;o<e.mMapOverwrite.length;o++)n.push(e.applyMapOverwrite(e.mMapOverwrite[o].type,e.mMapOverwrite[o].textureId));v.S.resolveArray(n,(function(){e.mState=a.VY.Ready,t&&e._dispatchFinalize(e.mMaterial)}))}else e.mState=a.VY.Ready,t&&e._dispatchFinalize(e.mMaterial)})),this.mMaterial}},{key:"dispose",value:function(e){return this.mReferenceCount-=1,this.mReferenceCount=Math.max(this.mReferenceCount,0),!(0!==this.mReferenceCount&&!e||((0,r.isNullOrUndefined)(this.mMaterial)||(y.disposeMaterial(this.mMaterial,this.mTextureManager),delete this.mMaterial),this.mModel=null,this._dispatchFinalize(this.mMaterial),this.mState=a.VY.Unloaded,0))}},{key:"clone",value:function(){var t=this,n=new e(this.mId,this.mTextureManager,this.mForcedType);return n.mColorOverwrite=this.mColorOverwrite?this.mColorOverwrite.clone():void 0,n.mMapOverwrite=JSON.parse(JSON.stringify(this.mMapOverwrite)),this.mModel?(n.mModel=JSON.parse(JSON.stringify(this.mModel)),n.mMaterial=this.mMaterial?this.mMaterial.clone():void 0,n.mMaterial?(n.mState=a.VY.InProgress,n.mMaterial.uuid=b.F.uuidV4(),y.parseModel(n.mMaterial,n.mModel,this.mTextureManager,(function(){if(n.mState!==a.VY.Unloaded){(0,r.isNullOrUndefined)(n.mColorOverwrite)||n.applyColorOverwrite(n.mColorOverwrite),t.mMapOverwrite&&0!==t.mMapOverwrite.length||(n.mState=a.VY.Ready);for(var e=[],o=0;o<t.mMapOverwrite.length;o++)e.push(n.applyMapOverwrite(n.mMapOverwrite[o].type,n.mMapOverwrite[o].textureId));v.S.resolveArray(e,(function(){n.mState=a.VY.Ready}))}}))):n.mState=this.mState):(n.mMaterial=this.mMaterial?this.mMaterial.clone():void 0,n.mState=this.mState),n.mReferenceCount=0,n}}],n&&_(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),T=n(94498);function R(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function S(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){R(i,r,o,a,u,"next",e)}function u(e){R(i,r,o,a,u,"throw",e)}a(void 0)}))}}function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var P=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mMaterials={},this.mColorOverwrites={},this.mMapOverwrites={},this.mTextureManager=t,this.mMaterials[e._sharedKey]={},this.mMapOverwrites[e._sharedKey]={},this.mColorOverwrites[e._sharedKey]={}}var t,n,i,a,u,c,s,f,p,d;return t=e,n=[{key:"getTextureManager",value:function(){return this.mTextureManager}},{key:"loadLibrary",value:(d=S(regeneratorRuntime.mark((function e(){var t,n=this,r=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]&&r[0],e.abrupt("return",new Promise((function(e){t&&(l.qL.print("cleanup materials"),n.cleanup()),e(n)})));case 2:case"end":return e.stop()}}),e)}))),function(){return d.apply(this,arguments)})},{key:"cleanup",value:function(){var t=this;Object.keys(this.mMaterials).forEach((function(e){var n=Number(e);Object.keys(t.mMaterials[n]).forEach((function(e){var r=Number(e);t.disposeMaterialById(r,n,!0)}))})),this.mMaterials={},this.mMaterials[e._sharedKey]={}}},{key:"setColorOverwrite",value:function(t,n,o){var i=o?o.getSceneObjectId():e._sharedKey;if(this.mColorOverwrites[i]||(this.mColorOverwrites[i]={}),!(0,r.isNullOrUndefined)(n)&&0!==n.length||(0,r.isNullOrUndefined)(this.mColorOverwrites[i][t]))try{var a=new THREE.Color(n);this.mColorOverwrites[i][t]=a}catch(e){}else this.mColorOverwrites[i][t]=void 0;var u=this.mColorOverwrites[i][t]||new THREE.Color;this.applyColorOverwrite(t,u,o)}},{key:"setMapOverwrite",value:(p=S(regeneratorRuntime.mark((function t(n,o,i,a){var u=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,c){if((0,r.isNullOrUndefined)(o))return c("incorrect type");var s=a?a.getSceneObjectId():e._sharedKey;u.mMapOverwrites[s]||(u.mMapOverwrites[s]={}),u.mMapOverwrites[s][n]||(u.mMapOverwrites[s][n]=[]);var l=u.mMapOverwrites[s][n].findIndex((function(e){return e.type===o}));if(((0,r.isNullOrUndefined)(i)||i<0)&&!(0,r.isNullOrUndefined)(u.mMapOverwrites[s][n][l]))l>=0&&delete u.mMapOverwrites[s][n][l].textureId;else try{l>=0?u.mMapOverwrites[s][n][l].textureId=i:(u.mMapOverwrites[s][n].push({type:o,textureId:i}),l=u.mMapOverwrites[s][n].length-1)}catch(e){}var f=u.mMapOverwrites[s][n][l].textureId;void 0!==f&&u.applyMapOverwrite(n,o,f,a).then((function(e){t(e)}),(function(e){c(e)}))})));case 1:case"end":return t.stop()}}),t)}))),function(e,t,n,r){return p.apply(this,arguments)})},{key:"applyColorOverwrite",value:function(t,n,r){var o=r?r.getSceneObjectId():e._sharedKey;this.mMaterials[o]||(this.mMaterials[o]={}),this.resolveResourcePool(t,o,r),this.mMaterials[o]&&this.mMaterials[o][t]&&this.mMaterials[o][t].setColorOverwrite(n)}},{key:"applyMapOverwrite",value:(f=S(regeneratorRuntime.mark((function t(n,r,o,i){var a=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,u){var c=i?i.getSceneObjectId():e._sharedKey,s=[];a.mMaterials[c]||(a.mMaterials[c]={}),a.resolveResourcePool(n,c,i),a.mMaterials[c][n]&&s.push(S(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a.mMaterials[c][n].setMapOverwrite(r,o));case 1:case"end":return e.stop()}}),e)})))),v.S.executeInOrder(s,(function(e,n){e.length>0?t(e[0]):u(n.length>0?n[0]:"Nothing to apply")}))})));case 1:case"end":return t.stop()}}),t)}))),function(e,t,n,r){return f.apply(this,arguments)})},{key:"saveModel",value:(s=S(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var i=["id","uuid","name","type","alpha_test","blending","depth_test","depth_write","fog","lights","opacity","premultiplied_alpha","shading","side","transparent","ssrl","render_order","resource_folder_id"],a={};Object.keys(t).filter((function(e){return-1!==i.indexOf(e)})).forEach((function(e){(0,r.isUndefined)(t[e])||(a[e]=t[e])})),a.properties={id:t.properties_id},Object.keys(t).filter((function(e){return-1===i.indexOf(e)})).forEach((function(e){a.properties[e]=t[e]})),((0,r.isNull)(a.resource_folder_id)||!(0,r.isUndefined)(a.resource_folder_id)&&a.resource_folder_id<0)&&delete a.resource_folder_id,o.O.getInstance().patch("material/".concat(t.id),a).then((function(){e(!0)}),(function(e){return n(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(e){return s.apply(this,arguments)})},{key:"deleteModel",value:(c=S(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.deleteModelById(t.id));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"deleteModelById",value:(u=S(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){o.O.getInstance().delete("material/".concat(t)).then((function(){e(!0)}),(function(e){n(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(e){return u.apply(this,arguments)})},{key:"resolveMaterialResourceById",value:(a=S(regeneratorRuntime.mark((function t(n,o,i,a,u){var c=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,s){if((0,r.isNullOrUndefined)(n))return(0,r.isNullOrUndefined)(o)||o(null),s("material id is null");var l=[],f=(0,r.isNullOrUndefined)(i)?e._sharedKey:i;if(f in c.mMaterials||(c.mMaterials[f]={}),!(n in c.mMaterials[f])&&(c.resolveResourcePool(n,f,u),n in c.mMaterials[f]||(c.mMaterials[f][n]=new O(n,c.mTextureManager,a)),c.mColorOverwrites[f]&&c.mColorOverwrites[f][n]&&c.mMaterials[f][n].setColorOverwrite(c.mColorOverwrites[f][n]),c.mMapOverwrites[f]&&c.mMapOverwrites[f][n]))for(var p=0;p<c.mMapOverwrites[f][n].length;p++){var d=c.mMapOverwrites[f][n][p].type,h=c.mMapOverwrites[f][n][p].textureId;l.push(c.mMaterials[f][n].setMapOverwrite(d,h))}v.S.resolveArray(l,(function(){t(c.mMaterials[f][n])}))})));case 1:case"end":return t.stop()}}),t)}))),function(e,t,n,r,o){return a.apply(this,arguments)})},{key:"resolveMaterialById",value:(i=S(regeneratorRuntime.mark((function e(t,n,r,o,i){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.resolveMaterialResourceById(t,n,r,o,i);case 2:if(a=e.sent){e.next=5;break}throw new Error("Material resource model not found");case 5:return e.abrupt("return",a.resolveMaterial(n));case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r,o){return i.apply(this,arguments)})},{key:"disposeMaterialById",value:function(t,n){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=void 0!==n?n:e._sharedKey;this.mMaterials&&!(0,r.isNullOrUndefined)(t)&&i&&(this.mMaterials[i]&&t in this.mMaterials[i]?(this.mMaterials[i][t].dispose(o)&&i in this.mMaterials&&t in this.mMaterials[i]&&delete this.mMaterials[i][t],i!==e._sharedKey&&i in this.mMaterials&&0===Object.keys(this.mMaterials[i]).length&&delete this.mMaterials[i]):i!==e._sharedKey&&this.mMaterials[e._sharedKey]&&t in this.mMaterials[e._sharedKey]&&this.mMaterials[e._sharedKey][t].dispose(o)&&delete this.mMaterials[e._sharedKey][t])}},{key:"resolveResourcePool",value:function(t,n,r){n!==e._sharedKey&&(!(t in this.mMaterials[n])&&t in this.mMaterials[e._sharedKey]?(this.mMaterials[n][t]=this.mMaterials[e._sharedKey][t].clone(),e._sharedKey in this.mColorOverwrites&&!(n in this.mColorOverwrites)&&(this.mColorOverwrites[n]=JSON.parse(JSON.stringify(this.mColorOverwrites[e._sharedKey]))),e._sharedKey in this.mMapOverwrites&&!(n in this.mMapOverwrites)&&(this.mMapOverwrites[n]=JSON.parse(JSON.stringify(this.mMapOverwrites[e._sharedKey]))),r&&r.dispatchMessage(new T.u(t,n,r.getSceneObjectId()))):t in this.mMaterials[e._sharedKey]||(n in this.mMaterials||(this.mMaterials[n]={}),n in this.mColorOverwrites||(this.mColorOverwrites[n]={}),n in this.mMapOverwrites||(this.mMapOverwrites[n]={}),r&&r.dispatchMessage(new T.u(t,n,r.getSceneObjectId()))))}}],n&&E(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();P._sharedKey=2147483647},78026:function(e,t,n){"use strict";n.d(t,{B:function(){return c}}),n(41539),n(15581),n(2490),n(34514),n(54747),n(47941),n(88674),n(21249),n(57640),n(9924),n(34553),n(40561),n(69070),n(21703);var r=n(89539),o=n(72519),i=n(29844),a=n(94130);function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mModels={},this.mThreedModels={},this.mState=o.V.Unloaded,this.mPromiseInProgress=null,this.mMaterialManager=t}var t,n;return t=e,n=[{key:"cleanup",value:function(){var e=this;Object.keys(this.mThreedModels).forEach((function(t){for(var n=e.mThreedModels[t],r=n.length-1;r>=0;r++)e.disposeModel(n[r].instance)})),this.mThreedModels={}}},{key:"loadLibrary",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(t)this.mModels={};else{if(this.mState===o.V.Ready)return this;if(null!==this.mPromiseInProgress)return this.mPromiseInProgress}return this.mState=o.V.InProgress,this.mPromiseInProgress=new Promise((function(t,n){i.O.getInstance().get("threed_model").then((function(r){e.mState=o.V.Ready,e.mPromiseInProgress=null;try{var i=a.FG.getItems(r.data);e.mModels={},i.forEach((function(t){e.mModels[t.id]=t})),t(e)}catch(t){e.mState=o.V.Error,n("failed to parse resources model")}}),(function(t){e.mState=o.V.Error,e.mPromiseInProgress=null,n("connection error:"+t)}))})),this.mPromiseInProgress}},{key:"getModels",value:function(){return this.mModels}},{key:"getModelsAsArray",value:function(){var e=this;return Object.keys(this.mModels).map((function(t){return e.mModels[t]}))}},{key:"addModel",value:function(e){return this.mModels[e.id]=e,this.mModels[e.id]}},{key:"getModel",value:function(e){return this.mModels[e]}},{key:"saveModel",value:function(e){var t=this;return new Promise((function(n,r){t.addModel(e),i.O.getInstance().patch("threed_model",e).then((function(e){n(!0)}),(function(e){return r(e)}))}))}},{key:"deleteModel",value:function(e){return this.deleteModelById(e.id)}},{key:"deleteModelById",value:function(e){var t=this;return new Promise((function(n,r){i.O.getInstance().delete("threed_model"+e).then((function(r){e in t.mModels&&delete t.mModels[e],n(!0)}),(function(e){r(e)}))}))}},{key:"resolveModelById",value:function(e,t){if(e in this.mThreedModels){var n=new THREE.Group;if(n.userData._threedModelsId=e,this.mThreedModels[e].state===o.V.Ready){var i=this._cloneModel(e);return n.add(i),this.mThreedModels[e].instances.push({instance:n}),(0,r.isNullOrUndefined)(t)||t(n),n}return this.mThreedModels[e].instances.push({instance:n,onReady:t}),n}return this._createModel(e,t)}},{key:"_createModel",value:function(e,t){var n=this;if(!(e in this.mModels))return null;var u=new THREE.Group;u.userData._threedModelsId=e,this.mThreedModels[e]={state:o.V.InProgress,instances:[{instance:u,onReady:t}],materials:[]};var c=this.mModels[e];return i.O.getInstance().get("threed_model/"+c.id).then((function(t){if(c.id in n.mThreedModels)try{var o=a.FG.getItem(t.data),i={};!(0,r.isUndefined)(o.materials)&&o.materials instanceof Array&&o.materials.forEach((function(t){"MultiMaterial"===t.type?t.materials instanceof Array&&(i[t.uuid]=new THREE.MultiMaterial,t.materials.forEach((function(r){n.mMaterialManager.resolveMaterialById(r.material_id).then((function(e){i[t.uuid].materials.push(e)})),n.mThreedModels[e].materials.push(r.material_id)}))):(n.mMaterialManager.resolveMaterialById(t.material_id).then((function(e){i[t.uuid]=e})),n.mThreedModels[e].materials.push(t.material_id))}));var u=new THREE.ObjectLoader,s=u.parseGeometries(o.geometries),l=u.parseObject(o.object,s,i);n._markModelReady(e,l)}catch(t){n._markModelError(e)}}),(function(t){n._markModelError(e)})),u}},{key:"_markModelReady",value:function(e,t){if(e in this.mThreedModels){this.mThreedModels[e].state=o.V.Ready;for(var n=0;n<this.mThreedModels[e].instances.length;n++){var i=this.mThreedModels[e].instances[n];0===n?i.instance.add(t):i.instance.add(this._cloneModel(e)),(0,r.isNullOrUndefined)(i.onReady)||(i.onReady(i.instance),i.onReady=null)}}}},{key:"_cloneModel",value:function(e){return e in this.mThreedModels&&this.mThreedModels[e].instances.length>0&&this.mThreedModels[e].instances[0].instance.children.length>0?this.mThreedModels[e].instances[0].instance.children[0].clone():null}},{key:"_markModelError",value:function(e){if(e in this.mThreedModels){this.mThreedModels[e].state=o.V.Error;for(var t=0;t<this.mThreedModels[e].instances.length;t++){var n=this.mThreedModels[e].instances[t];(0,r.isNullOrUndefined)(n.onReady)||(n.onReady(null),n.onReady=null)}}}},{key:"disposeModel",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=e.userData._threedModelsId;if(console.log("dipose model id:",o),!(0,r.isNullOrUndefined)(o)&&o in this.mThreedModels){var i=this.mThreedModels[o].instances.findIndex((function(t){return t.instance.id===e.id}));if(console.log("dipose instance id:",i),i>=0){var a=this.mThreedModels[o].instances[i];n&&this._disposeObject3D(a.instance),(0,r.isNullOrUndefined)(a.onReady)||(a.onReady(null),a.onReady=null),this.mThreedModels[o].instances.splice(i,1)}0===this.mThreedModels[o].instances.length&&(console.log("dipose materials and unload",this.mThreedModels[o].materials),this.mThreedModels[o].materials.splice(0,this.mThreedModels[o].materials.length).forEach((function(e){t.mMaterialManager.disposeMaterialById(e)})),delete this.mThreedModels[o])}}},{key:"_disposeObject3D",value:function(e){var t=this,n=e.children;n&&n instanceof Array&&n.forEach((function(e){t._disposeObject3D(e)})),(0,r.isNullOrUndefined)(e.geometry)||e.geometry.dispose()}}],n&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},60674:function(e,t,n){"use strict";n.d(t,{I:function(){return w}}),n(35666),n(41539),n(88674),n(15581),n(2490),n(34514),n(54747),n(47941),n(92222),n(38862),n(68216),n(79433),n(69070),n(21703);var r=n(89539),o=(n(40561),n(64211),n(41874),n(84217)),i=n(50217),a=n(70456),u=n(48155),c=n(41142),s=n(37175),l=n(47600);function f(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var h=function(){function e(t,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;p(this,e),this.mState=i.VY.Unloaded,this.mReferenceCount=0,this.mReadySubscriptions=[],this.mFactoryControllers=[l.o,s.C],this.mId=t,this.mLod=Math.max(0,Math.min(2,a)),this.mTextureProperties=o,this.mTextureKey=r,this.mImageLoader=n}var t,n,h,y;return t=e,n=[{key:"getTextureKey",value:function(){return this.mTextureKey}},{key:"getTexture",value:function(){return(0,r.isNullOrUndefined)(this.mController)?null:this.mController.getTexture()}},{key:"getController",value:function(){return this.mController}},{key:"resolveTexture",value:(h=regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,c){if(!(0,r.isNullOrUndefined)(t))switch(n.mState){case i.VY.Unloaded:case i.VY.InProgress:n.mReadySubscriptions.push(t);break;case i.VY.Ready:t(n.getTexture());break;case i.VY.Error:t(null)}return(0,r.isNullOrUndefined)(n.mController)?n.mState===i.VY.Error?c("Failed to resolve media id:".concat(n.mId)):((0,r.isNullOrUndefined)(n.mMediaLoader)&&(n.mState=i.VY.InProgress,n.mMediaLoader=new a.t(1),u.y.getInstance().resolveModel(n.mId).then((function(e){n.mModel=e;var t=n._createTexture();(0,r.isNullOrUndefined)(t)?(n.mState=i.VY.Error,n._dispatchFinalize(t),n.mMediaLoader.error("No controllers can handle this type of image")):n.mMediaLoader.next(t)}),(function(e){n.mState=i.VY.Error,n._dispatchFinalize(n.getTexture()),n.mMediaLoader.error(e)}))),void n.mMediaLoader.pipe((0,o.q)(1)).subscribe((function(t){n.mReferenceCount+=1,e(t)}),(function(e){c(e)}))):(n.mReferenceCount+=1,e(n.getTexture()))})));case 1:case"end":return e.stop()}}),e)})),y=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=h.apply(e,t);function i(e){f(o,n,r,i,a,"next",e)}function a(e){f(o,n,r,i,a,"throw",e)}i(void 0)}))},function(e){return y.apply(this,arguments)})},{key:"_dispatchFinalize",value:function(e){this.mReadySubscriptions.splice(0).forEach((function(t){return t(e)}))}},{key:"_createTexture",value:function(){var e=this;(0,r.isNullOrUndefined)(this.mController)||(c.qL.warn("_createTexture() called on existing texture resource. Disposing the old texture"),this.dispose(!0));for(var t=null,n=this.mLod;n>=0;n--){var o=encodeURI(this.mModel["lod".concat(n,"_url")]);if(!(0,r.isNullOrUndefined)(o)&&o.length>0){t=o;break}}return(0,r.isNullOrUndefined)(t)&&(t=this.mModel.source_url),this.mFactoryControllers.some((function(n){return!!n.isSupported(t)&&(e.mController=new n(e.mTextureKey,e.mImageLoader),e.mController.loadTexture(t,e.mTextureProperties,(function(n){n.then((function(n){e.mState!==i.VY.Unloaded?(e.mState=i.VY.Ready,e._dispatchFinalize(n)):(c.qL.error("Texture ".concat(t," has finished loading after disposal of ResourceManager.")),e.dispose(!0),e._dispatchFinalize(null))}),(function(t){c.qL.error(t),e.mState=i.VY.Error,e._dispatchFinalize(null)}))})),!0)})),this.getTexture()}},{key:"dispose",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.mReferenceCount-=1,this.mReferenceCount=this.mReferenceCount<0?0:this.mReferenceCount,!(0!==this.mReferenceCount&&!e||((0,r.isNullOrUndefined)(this.mController)||(this.mController.unload(),this.mController=void 0),this._dispatchFinalize(null),this.mState=i.VY.Unloaded,0))}}],n&&d(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),y=n(55830),m=n(89002);function v(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function b(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){v(i,r,o,a,u,"next",e)}function u(e){v(i,r,o,a,u,"throw",e)}a(void 0)}))}}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var w=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mTextures={},THREE.ImageUtils.crossOrigin="",this.mImageLoader=new THREE.ImageLoader(THREE.DefaultLoadingManager),this.mImageLoader.setCrossOrigin("")}var t,n,o,i,a,u,s;return t=e,n=[{key:"loadLibrary",value:(s=b(regeneratorRuntime.mark((function e(){var t,n=this,r=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]&&r[0],e.abrupt("return",new Promise((function(e,r){t&&(c.qL.print("cleanup texture cache..."),n.cleanup()),e(n)})));case 2:case"end":return e.stop()}}),e)}))),function(){return s.apply(this,arguments)})},{key:"saveModel",value:(u=b(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){y.OE.getInstance().patch("media/".concat(t.id),t).then((function(t){e(!0)}),(function(e){return n(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(e){return u.apply(this,arguments)})},{key:"deleteModel",value:(a=b(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.deleteModelById(t.id));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"deleteModelById",value:(i=b(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){y.OE.getInstance().delete("media/".concat(t)).then((function(t){e(!0)}),(function(e){n(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(e){return i.apply(this,arguments)})},{key:"cleanup",value:function(){var e=this;Object.keys(this.mTextures).forEach((function(t){return e.mTextures[t].dispose()})),this.mTextures={}}},{key:"resolveResourceById",value:(o=b(regeneratorRuntime.mark((function e(t,n){var o,i,a=this,u=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=u.length>2&&void 0!==u[2]?u[2]:{},i=u.length>3?u[3]:void 0,e.abrupt("return",new Promise((function(e,u){var c=a._getIdPath(t,n,o);(0,r.isNullOrUndefined)(a.mTextures[c])&&(a.mTextures[c]=new h(t,a.mImageLoader,c,o,n)),a.mTextures[c].resolveTexture(i).then((function(t){e(a.mTextures[c])}),(function(e){u(e)}))})));case 3:case"end":return e.stop()}}),e)}))),function(e,t){return o.apply(this,arguments)})},{key:"_getIdPath",value:function(e,t,n){return"".concat(e,"/").concat(t,"/").concat(m.F.Md5(JSON.stringify(n)))}},{key:"disposeTexture",value:function(e){var t=this,n=null;return Object.keys(this.mTextures).every((function(o){var i=t.mTextures[o].getTexture();return!(!(0,r.isNullOrUndefined)(i)&&i.uuid===e.uuid&&(n=o,1))})),null!==n?this.mTextures[n].dispose()&&delete this.mTextures[n]:e.dispose(),!0}},{key:"disposeResource",value:function(e){var t=e.getTextureKey();return this.disposeByKey(t)}},{key:"disposeByKey",value:function(e){return!(!(e in this.mTextures)||!this.mTextures[e].dispose()||(delete this.mTextures[e],0))}}],n&&g(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},80115:function(e,t,n){"use strict";n.d(t,{O:function(){return r},t:function(){return f}}),n(35666),n(41539),n(88674),n(69070),n(21703);var r,o=n(36805),i=n(60674),a=n(78026),u=n(99556);function c(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){c(i,r,o,a,u,"next",e)}function u(e){c(i,r,o,a,u,"throw",e)}a(void 0)}))}}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}!function(e){e[e.TextureManager=0]="TextureManager",e[e.MaterialManager=1]="MaterialManager",e[e.ModelManager=2]="ModelManager"}(r||(r={}));var f=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mTextureManager=new i.I,this.mMaterialManager=new o.P(this.mTextureManager),this.mModelManager=new a.B(this.mMaterialManager),this.mDirty={}}var t,n,c,f,p,d,h;return t=e,n=[{key:"setDirty",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e?this.mDirty[e]=t:(this.mDirty[r.MaterialManager]=t,this.mDirty[r.TextureManager]=t,this.mDirty[r.ModelManager]=t)}},{key:"isDirty",value:function(e){return e?!0===this.mDirty[e]:!0===this.mDirty[r.TextureManager]||!0===this.mDirty[r.MaterialManager]||!0===this.mDirty[r.ModelManager]}},{key:"getManager",value:(h=s(regeneratorRuntime.mark((function e(t){var n,o=this,i=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]&&i[1],e.abrupt("return",new Promise((function(e,i){var a=[];switch(t){case r.ModelManager:a.unshift(s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",o._resolveModelManager(n));case 1:case"end":return e.stop()}}),e)}))));break;case r.MaterialManager:a.unshift(s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",o._resolveMaterialManager(n));case 1:case"end":return e.stop()}}),e)}))));break;case r.TextureManager:a.unshift(s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",o._resolveTextureManager(n));case 1:case"end":return e.stop()}}),e)}))))}u.S.executeInOrder(a,(function(n,a){if(a.length>0)return i(a);switch(t){case r.ModelManager:e(o.mModelManager);break;case r.MaterialManager:e(o.mMaterialManager);break;case r.TextureManager:e(o.mTextureManager);break;default:i("unknown type: ".concat(t))}}))})));case 2:case"end":return e.stop()}}),e)}))),function(e){return h.apply(this,arguments)})},{key:"_resolveTextureManager",value:(d=s(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,o){var i=t||n.isDirty(r.TextureManager);n.setDirty(r.TextureManager,!1),Promise.resolve(n.mTextureManager.loadLibrary(i)).then((function(){e(!0)}),(function(e){o(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(e){return d.apply(this,arguments)})},{key:"_resolveMaterialManager",value:(p=s(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,o){var i=t||n.isDirty(r.MaterialManager);n.setDirty(r.MaterialManager,!1),Promise.resolve(n.mMaterialManager.loadLibrary(i)).then((function(){e(!0)}),(function(e){o(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(e){return p.apply(this,arguments)})},{key:"_resolveModelManager",value:(f=s(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,o){var i=t||n.isDirty(r.ModelManager);n.setDirty(r.ModelManager),Promise.resolve(n.mModelManager.loadLibrary(i)).then((function(){e(!0)}),(function(e){o(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(e){return f.apply(this,arguments)})}],c=[{key:"getInstance",value:function(){return this.sInstance||(this.sInstance=new e),this.sInstance}}],n&&l(t.prototype,n),c&&l(t,c),Object.defineProperty(t,"prototype",{writable:!1}),e}()},64520:function(e,t,n){"use strict";n.d(t,{S:function(){return p}}),n(35666),n(41539),n(15581),n(2490),n(34514),n(54747),n(69826),n(31672),n(59461),n(21249),n(57640),n(9924),n(24603),n(28450),n(74916),n(88386),n(39714),n(15306),n(77601),n(43290),n(88674),n(19601),n(34553),n(69070),n(21703),n(47042),n(68309),n(91038),n(78783),n(82526),n(41817),n(32165),n(66992),n(33948);var r,o=n(4192),i=n(68009),a=n(41142);function u(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw i}}}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function s(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){s(i,r,o,a,u,"next",e)}function u(e){s(i,r,o,a,u,"throw",e)}a(void 0)}))}}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}!function(e){e.LeftRight="left_right",e.TopBottom="top_bottom"}(r||(r={}));var p=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mObjectCache=[],this.mSvgCanvasGroups=[]}var t,n,c,s,p,d,h,y,m,v,b,g,w,_,O,T,R,S,E,P,x;return t=e,n=[{key:"create",value:(x=l(regeneratorRuntime.mark((function e(t,n){var r,o,a,u,c,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadLibrary();case 2:if(this.resetObjectCache(),this.createDocumentCanvas(n,n),this.mSvgCanvas=new fabric.StaticCanvas(this.mDocCanvas,{enableRetinaScaling:!1,width:n,height:n}),!i.F.isValidURL(t)&&!i.F.isBase64(t)){e.next=11;break}return e.next=8,this.loadSVGFromUrl(t);case 8:e.t0=e.sent,e.next=14;break;case 11:return e.next=13,this.loadSVGFromString(t);case 13:e.t0=e.sent;case 14:return r=e.t0,o=r.objects,a=r.options,u=this.getPlaceholders(t),o.forEach((function(e){var t=u.find((function(t){return t===e.id}));e.set("visible",e.get("visible")&&!t)})),c=fabric.util.groupSVGElements(o,a),this.mSvgGroup="group"===c.type?c:new fabric.Group([c],a),this.mSvgGroup.width>this.mSvgGroup.height?this.mSvgGroup.scaleToWidth(n):this.mSvgGroup.scaleToHeight(n),this.mSvgCanvas.add(this.mSvgGroup),this.mSvgCanvas.renderAll(),this.mObjectCache=o.map((function(e){return{group:s.mSvgGroup,element:e,visible:!0}})),e.abrupt("return",{width:this.mSvgGroup.getScaledWidth(),height:this.mSvgGroup.getScaledHeight(),canvas:this.mDocCanvas});case 26:case"end":return e.stop()}}),e,this)}))),function(e,t){return x.apply(this,arguments)})},{key:"destroy",value:function(){this.mSvgCanvas&&(this.mSvgCanvas.clear(),this.mSvgCanvas.dispose(),delete this.mSvgCanvas),this.mSvgGroup&&delete this.mSvgGroup,this.mDocCanvas&&void 0!==this.mDocCanvas.parentNode&&null!==this.mDocCanvas.parentNode&&this.mDocCanvas.parentNode.removeChild&&this.mDocCanvas.parentNode.removeChild(this.mDocCanvas),delete this.mDocCanvas,this.resetObjectCache()}},{key:"resolveObject",value:(P=l(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this.mObjectCache.find((function(e){return e.element.id==t})))){e.next=5;break}return e.next=4,this.createClipping(r,n);case 4:r=e.sent;case 5:return e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return P.apply(this,arguments)})},{key:"resolveObjectsLike",value:(E=l(regeneratorRuntime.mark((function e(t,n){var r,o,i,a,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=new RegExp("^"+t.replace(/\*/g,".*")+"$","i"),o=[],i=u(this.mObjectCache),e.prev=3,i.s();case 5:if((a=i.n()).done){e.next=15;break}if(c=a.value,!r.test(c.element.id)){e.next=13;break}return e.t0=o,e.next=11,this.createClipping(c,n);case 11:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 13:e.next=5;break;case 15:e.next=20;break;case 17:e.prev=17,e.t2=e.catch(3),i.e(e.t2);case 20:return e.prev=20,i.f(),e.finish(20);case 23:return e.abrupt("return",o);case 24:case"end":return e.stop()}}),e,this,[[3,17,20,23]])}))),function(e,t){return E.apply(this,arguments)})},{key:"getBoundaries",value:(S=l(regeneratorRuntime.mark((function e(t){var n,r,o,i,a,u=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]&&u[1],e.next=3,this.resolveObject(t);case 3:if((r=e.sent)&&r.element){e.next=6;break}return e.abrupt("return",null);case 6:return o=r.element,i={left:o.left*o.scaleX,top:o.top*o.scaleY,width:o.width*o.scaleX,height:o.height*o.scaleY},n&&(a=o.getObjectScaling(),i.localScaleX=o.scaleX,i.localScaleY=o.scaleY,i.scaleX=a.scaleX,i.scaleY=a.scaleY),e.abrupt("return",i);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return S.apply(this,arguments)})},{key:"getBoundariesSync",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(t){var o=this.mSvgCanvasGroups.find((function(e){return e.id===t}));if(!o)return;n=o.group.getObjects().find((function(t){return t.id==e}))}else{var i=this.mObjectCache.find((function(t){return t.element.id==e}));if(!i)return;n=i.element}if(n){r&&n.setCoords();var a=n.getObjectScaling(),u=n.getCoords(),c=n.getBoundingRect();return{left:n.left,top:n.top,width:n.width,height:n.height,coords:{tl:u[0],tr:u[1],br:u[2],bl:u[3]},angle:n.angle,scaleX:n.scaleX,scaleY:n.scaleY,worldScaleX:a.scaleX,worldScaleY:a.scaleY,bbox:{min:{x:c.left,y:c.top},max:{x:c.left+c.width,y:c.top+c.height}}}}}},{key:"getCanvasBoundaries",value:function(){if(!this.mSvgCanvas)return null;var e=this.mSvgCanvas.getCenter(),t=this.mSvgCanvas.getWidth(),n=this.mSvgCanvas.getHeight();return{left:e.left-.5*t,top:e.top-.5*n,width:t,height:n}}},{key:"updateImageProperties",value:(R=l(regeneratorRuntime.mark((function e(t,n,r,o,i,a,u,c){var s,l,f,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=this.initImageObject(t),e.next=3,this.setImageSource(s,n,r);case 3:(s=e.sent).element.set({scaleX:s.sx*c*s.fit,scaleY:s.sy*c*s.fit}).rotate(s.angle+u),l=this.applyContainerOffset(s,a,o,i),f=l.offsetX,p=l.offsetY,s.element.set({top:s.top+p,left:s.left+f});case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r,o,i,a,u){return R.apply(this,arguments)})},{key:"updatePattern",value:(T=l(regeneratorRuntime.mark((function e(t,n,r){var o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.patternSrc!==n){e.next=2;break}return e.abrupt("return");case 2:return t.patternSrc=n,t.pattern&&(t.pattern.clear(),t.pattern.dispose(),delete t.pattern),e.next=6,this.loadImageFromUrl(n);case 6:o=e.sent,i=r||1,o.set({scaleX:i,scaleY:i}),t.pattern=new fabric.StaticCanvas(null,{enableRetinaScaling:!1}),t.pattern.add(o),t.pattern.setDimensions({width:o.getScaledWidth(),height:o.getScaledHeight()}),t.pattern.renderAll(),t.element.set("fill",new fabric.Pattern({source:t.pattern.getElement(),repeat:"repeat",crossOrigin:"anonymous"}));case 14:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return T.apply(this,arguments)})},{key:"updateTextProperty",value:(O=l(regeneratorRuntime.mark((function e(t,n,r,o,a,u,c,s,l,f,p,d){var h,y,m,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:h=this.initTextObject(t,r),i.F.isNumeric(o)&&h.element.set("fontSize",o),a&&h.element.set("fontFamily",a),f&&h.element.set("fill",f),h.element.set({text:n.toString(),textAlign:d,visible:h.visible,scaleX:h.sx*u,scaleY:h.sy*u,styles:p}).rotate(h.angle+c),y=this.applyContainerOffset(h,l,s[0],s[1]),m=y.offsetX,v=y.offsetY,h.element.set({top:h.top+v,left:h.left+m});case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r,o,i,a,u,c,s,l,f){return O.apply(this,arguments)})},{key:"updateGradientProperty",value:(_=l(regeneratorRuntime.mark((function e(t,n,o,i){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=new fabric.Gradient({type:"linear",gradientUnits:"percentage",coords:i===r.LeftRight?{x1:0,y1:0,x2:1,y2:0}:{x1:0,y1:0,x2:0,y2:1},colorStops:[{offset:0,color:n},{offset:1,color:o}]}),t.element.set("fill",a);case 2:case"end":return e.stop()}}),e)}))),function(e,t,n,r){return _.apply(this,arguments)})},{key:"updateElementProperty",value:(w=l(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.element.set(n,r);case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return w.apply(this,arguments)})},{key:"render",value:function(){this.mSvgCanvas&&this.mSvgCanvas.renderAll()}},{key:"upSertObjectToGroupOnCanvas",value:(g=l(regeneratorRuntime.mark((function t(n,r){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,o=r._objects.find((function(e){return e.id===n.id}))){t.next=13;break}t.t0=n.type,t.next="image"===t.t0?6:"i-text"===t.t0?10:12;break;case 6:return t.next=8,this.loadImageFromUrl(n.imageSrc||"");case 8:return o=t.sent,t.abrupt("break",12);case 10:return o=e.createNewFabricText(n),t.abrupt("break",12);case 12:r.add(o);case 13:if(!o){t.next=21;break}t.t1=n.type,t.next="image"===t.t1?17:"i-text"===t.t1?19:21;break;case 17:return o.setOptions({scaleX:n.scaleX,scaleY:n.scaleY,top:n.top+r.clipPath.top,left:n.left+r.clipPath.left,angle:n.angle,id:n.id,fileName:n.fileName}),t.abrupt("break",21);case 19:return o.setOptions({scaleX:n.scaleX,scaleY:n.scaleY,top:n.top+r.clipPath.top,left:n.left+r.clipPath.left,angle:n.angle,id:n.id,text:n.text?n.text.toString():"",fontFamily:n.fontFamily,fill:n.fill||"#000000"}),t.abrupt("break",21);case 21:t.next=26;break;case 23:t.prev=23,t.t2=t.catch(0),a.qL.error(t.t2);case 26:case"end":return t.stop()}}),t,this,[[0,23]])}))),function(e,t){return g.apply(this,arguments)})},{key:"getPlaceholders",value:function(e){var t=document.createElement("div");t.innerHTML=e;var n=t.querySelectorAll("[data-hide],[data-placeholder]"),r=[];return n.forEach((function(e){(e.hasAttribute("data-hide")||"true"===e.getAttribute("data-placeholder"))&&r.push(e.id)})),r}},{key:"getGroupWrapped",value:(b=l(regeneratorRuntime.mark((function e(t,n){var r,o,i,a,u=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.mSvgCanvasGroups.find((function(e){return e.id===t})),!r){e.next=3;break}return e.abrupt("return",r);case 3:if(o=this.mObjectCache.find((function(e){return e.element.id===n}))){e.next=6;break}return e.abrupt("return",null);case 6:return e.next=8,new Promise((function(e){return o.element.clone((function(t){u.mSvgCanvas._objects.length>0&&u.mSvgCanvas._objects[0].remove(o.element);var n=u.createNewSvgGroup();n.clipPath=t,e(n)}))}));case 8:return(i=e.sent).remove(i.getObjects()),a={group:i,id:t},this.mSvgCanvasGroups.push(a),this.mSvgCanvas.add(a.group),e.abrupt("return",a);case 14:case"end":return e.stop()}}),e,this)}))),function(e,t){return b.apply(this,arguments)})},{key:"removeFromGroup",value:function(e,t){var n=this.mSvgCanvasGroups.find((function(e){return e.id===t}));n&&n.group.remove(e)}},{key:"rotate2dVector",value:function(e,t){if(2!==e.length)return e;var n=.0174533*t,r=Math.cos(n),o=Math.sin(n);return[r*e[0]-o*e[1],o*e[0]+r*e[1]]}},{key:"rotateSize",value:function(e,t,n){var r=this.rotate2dVector([e,t],n);return{width:Math.abs(r[0]),height:Math.abs(r[1])}}},{key:"applyContainerOffset",value:function(e,t,n,r){var o=n,i=r;if("percentage"!==t||!e.element||!e.hasClipping)return{offsetX:o,offsetY:i};var a=this.rotateSize(e.element.getScaledWidth(),e.element.getScaledHeight(),e.angle||0),u=this.rotateSize(e.group.clipPath.getScaledWidth(),e.group.clipPath.getScaledHeight(),e.group.clipPath.angle);return{offsetX:o=(u.width+.5*(a.width-u.width))*(o/100),offsetY:i=(u.height+.5*(a.height-u.height))*(i/100)}}},{key:"loadImageSource",value:(v=l(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.element.set({crossOrigin:"anonymous"}),t.element.setSrc(i.F.makeUrlUnique(n),(function(){t.element.set({dirty:!0}),e()}),{crossOrigin:"anonymous"})})));case 1:case"end":return e.stop()}}),e)}))),function(e,t){return v.apply(this,arguments)})},{key:"setImageSource",value:(m=l(regeneratorRuntime.mark((function e(t,n,r){var o,i,a,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n||t.src!==n){e.next=2;break}return e.abrupt("return",t);case 2:return t.src=n,e.next=5,this.loadImageSource(t,n);case 5:if(n&&0!==n.length){e.next=8;break}return t.fit=1,e.abrupt("return",t);case 8:o=t.element.width<.001?.001:t.element.width,i=t.element.height<.001?.001:t.element.height,a=t.width/o,u=t.height/i,e.t0=r,e.next="contain"===e.t0?15:"cover"===e.t0?17:19;break;case 15:return t.fit=u>a?a:u,e.abrupt("break",19);case 17:return t.fit=u>a?u:a,e.abrupt("break",19);case 19:return e.abrupt("return",t);case 20:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return m.apply(this,arguments)})},{key:"initImageObject",value:function(e){if(e.init)return e;var t=e.element,n=this.rotate2dVector([.5*t.getScaledWidth(),.5*t.getScaledHeight()],t.angle);return(e=Object.assign(e,{init:!0,width:t.getScaledWidth(),height:t.getScaledHeight(),sx:1,sy:1,angle:t.angle,top:t.top+n[1],left:t.left+n[0],fit:1,src:null})).element.set({visible:e.visible,originX:"center",originY:"center"}),e}},{key:"loadImageFromUrl",value:(y=l(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){fabric.Image.fromURL(i.F.makeUrlUnique(t),(function(t){e(t)}),{crossOrigin:"anonymous"})})));case 1:case"end":return e.stop()}}),e)}))),function(e){return y.apply(this,arguments)})},{key:"initTextObject",value:function(e,t){if(e.init)return e;var n=e.element,r=this.rotate2dVector([(.5*n.width+.5*n.strokeWidth)*n.scaleX,(.5*n.height+.5*n.strokeWidth)*n.scaleY],n.angle);if(e=Object.assign(e,{init:!0,top:n.top+r[1],left:n.left+r[0],angle:n.angle,sx:n.scaleX,sy:n.scaleY}),n.set({originX:"center",originY:"center",fill:n.fill,top:e.top,left:e.left}).setCoords(),!t)return e;var o=new fabric.Textbox("",{id:n.id,fontSize:16,fill:n.fill,originX:"center",originY:"center"});return this.copyWorldDefinition(n,o),e.group.remove(n),e.group.add(o),e.element=o,e}},{key:"createNewSvgGroup",value:function(){var e=new fabric.Group;return this.copyWorldDefinition(this.mSvgGroup,e),e}},{key:"getRootGroup",value:function(){return this.mSvgGroup}},{key:"getObjects",value:function(){return this.mObjectCache}},{key:"getCanvas",value:function(){return this.mDocCanvas}},{key:"getSvgCanvas",value:function(){return this.mSvgCanvas}},{key:"createClipping",value:(h=l(regeneratorRuntime.mark((function e(t,n){var r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&!t.hasClipping){e.next=2;break}return e.abrupt("return",t);case 2:return e.abrupt("return",new Promise((function(e){var o=t.element,i=r.mObjectCache.findIndex((function(e){return e.element.id==n})),a=r.mObjectCache[i].element;a.set("visible",!1),a.clone((function(n){n.set("visible",!0),r.mSvgGroup.remove(o);var i=r.createNewSvgGroup();i.clipPath=n,i.add(o),r.mSvgCanvas.add(i),t.hasClipping=!0,t.group=i,e(t)}))})));case 3:case"end":return e.stop()}}),e)}))),function(e,t){return h.apply(this,arguments)})},{key:"copyWorldDefinition",value:function(e,t){["aCoords","oCoords","width","height","scaleX","scaleY","zoomX","zoomY","minX","minY","viewBoxHeight","viewBoxWidth","lineCoords"].forEach((function(n){void 0!==t[n]&&void 0!==e[n]&&(t[n]=e[n])}))}},{key:"resetObjectCache",value:function(){this.mObjectCache=[]}},{key:"loadLibrary",value:(d=l(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"!=typeof fabric){e.next=2;break}return e.abrupt("return",o.W.loadScript("https://cdn.jsdelivr.net/npm/fabric@4.6.0/dist/fabric.min.js"));case 2:case"end":return e.stop()}}),e)}))),function(){return d.apply(this,arguments)})},{key:"createDocumentCanvas",value:function(e,t){this.mDocCanvas=document.createElement("canvas"),this.mDocCanvas.width=e,this.mDocCanvas.height=t,this.mDocCanvas.style.background="transparent",this.mDocCanvas.style.display="none",document.body.appendChild(this.mDocCanvas)}},{key:"loadSVGFromString",value:(p=l(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){fabric.loadSVGFromString(t,(function(t,n){return e({objects:t,options:n})}))})));case 1:case"end":return e.stop()}}),e)}))),function(e){return p.apply(this,arguments)})},{key:"loadSVGFromUrl",value:(s=l(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){fabric.loadSVGFromURL(t,(function(t,n){return e({objects:t,options:n})}))})));case 1:case"end":return e.stop()}}),e)}))),function(e){return s.apply(this,arguments)})},{key:"checkPointInsideObject",value:function(e,t,n,r){var o;if(r){var i=this.mSvgCanvasGroups.find((function(e){return e.id===r}));if(!i)return!1;o=i.group.getObjects().find((function(e){return e.id==n}))}else{var a=this.mObjectCache.find((function(e){return e.element.id==n}));if(!a)return!1;o=a.element}return!!o&&o.containsPoint(new fabric.Point(e,t),void 0,!1,!0)}}],c=[{key:"createNewFabricText",value:function(e){return new fabric.Text(e.text?e.text.toString():"",{fontSize:e.fontSize||16,fontFamily:e.fontFamily})}}],n&&f(t.prototype,n),c&&f(t,c),Object.defineProperty(t,"prototype",{writable:!1}),e}()},66389:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{$:function(){return ActionArithmeticOperationProcess}});var core_js_modules_es_array_index_of_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(82772),core_js_modules_es_array_index_of_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_array_index_of_js__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(74916),core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(15306),core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es_regexp_test_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(77601),core_js_modules_es_regexp_test_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es_regexp_test_js__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es_object_set_prototype_of_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(68304),core_js_modules_es_object_set_prototype_of_js__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es_object_set_prototype_of_js__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_es_object_get_prototype_of_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(30489),core_js_modules_es_object_get_prototype_of_js__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_es_object_get_prototype_of_js__WEBPACK_IMPORTED_MODULE_5__),core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(41539),core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_6__),core_js_modules_es_reflect_to_string_tag_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(81299),core_js_modules_es_reflect_to_string_tag_js__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(core_js_modules_es_reflect_to_string_tag_js__WEBPACK_IMPORTED_MODULE_7__),core_js_modules_es_reflect_construct_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(12419),core_js_modules_es_reflect_construct_js__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(core_js_modules_es_reflect_construct_js__WEBPACK_IMPORTED_MODULE_8__),core_js_modules_es_error_cause_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(21703),core_js_modules_es_error_cause_js__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(core_js_modules_es_error_cause_js__WEBPACK_IMPORTED_MODULE_9__),core_js_modules_es_object_define_property_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(69070),core_js_modules_es_object_define_property_js__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(core_js_modules_es_object_define_property_js__WEBPACK_IMPORTED_MODULE_10__),core_js_modules_es_symbol_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(82526),core_js_modules_es_symbol_js__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(core_js_modules_es_symbol_js__WEBPACK_IMPORTED_MODULE_11__),core_js_modules_es_symbol_description_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(41817),core_js_modules_es_symbol_description_js__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(core_js_modules_es_symbol_description_js__WEBPACK_IMPORTED_MODULE_12__),core_js_modules_es_symbol_iterator_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(32165),core_js_modules_es_symbol_iterator_js__WEBPACK_IMPORTED_MODULE_13___default=__webpack_require__.n(core_js_modules_es_symbol_iterator_js__WEBPACK_IMPORTED_MODULE_13__),core_js_modules_es_array_iterator_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(66992),core_js_modules_es_array_iterator_js__WEBPACK_IMPORTED_MODULE_14___default=__webpack_require__.n(core_js_modules_es_array_iterator_js__WEBPACK_IMPORTED_MODULE_14__),core_js_modules_es_string_iterator_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(78783),core_js_modules_es_string_iterator_js__WEBPACK_IMPORTED_MODULE_15___default=__webpack_require__.n(core_js_modules_es_string_iterator_js__WEBPACK_IMPORTED_MODULE_15__),core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(33948),core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_16___default=__webpack_require__.n(core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_16__),_core_process_object__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(74120),_core_process_event__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(26566),util__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(89539),util__WEBPACK_IMPORTED_MODULE_19___default=__webpack_require__.n(util__WEBPACK_IMPORTED_MODULE_19__),_utils_variables_class__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(68009),_services_syslog_service__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(41142);function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return _setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},_setPrototypeOf(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var n,r=_getPrototypeOf(e);if(t){var o=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){if(t&&("object"===_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},_getPrototypeOf(e)}var ActionArithmeticOperationProcess=function(_ProcessObject){_inherits(ActionArithmeticOperationProcess,_ProcessObject);var _super=_createSuper(ActionArithmeticOperationProcess);function ActionArithmeticOperationProcess(){return _classCallCheck(this,ActionArithmeticOperationProcess),_super.apply(this,arguments)}return _createClass(ActionArithmeticOperationProcess,[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"resolveEventType",value:function(e){return e.data.attribute_type||e.type}},{key:"onHandleInPort",value:function onHandleInPort(aEvent){_services_syslog_service__WEBPACK_IMPORTED_MODULE_21__.qL.print("Rule: Handle arithmetic operation");var arithmeticOperation=null;(0,util__WEBPACK_IMPORTED_MODULE_19__.isNullOrUndefined)(this.getMetadata().arithmetic_operation)||(arithmeticOperation=this.getMetadata().arithmetic_operation);var outPortName="fail",inputValue=null;switch(this.resolveEventType(aEvent)){case"operable_numbers_input":case"text_to_image":case"text_input":inputValue=aEvent.data.attribute_value_name;break;default:inputValue=aEvent.data.value}if(null!==arithmeticOperation&&_utils_variables_class__WEBPACK_IMPORTED_MODULE_20__.F.isNumeric(inputValue))for(;arithmeticOperation.indexOf("{value}")>=0;)arithmeticOperation=arithmeticOperation.replace("{value}",inputValue);if(null!==arithmeticOperation&&/^([\d\(\)\+\-\.\*><=/%!\:+\s\?])+$/.test(arithmeticOperation))try{inputValue=eval(arithmeticOperation),outPortName="result"}catch(e){_services_syslog_service__WEBPACK_IMPORTED_MODULE_21__.qL.error("Unable to process arithmetic rule.",e),outPortName="fail"}return[new _core_process_event__WEBPACK_IMPORTED_MODULE_18__.q("input",{value:inputValue},this,outPortName)]}}]),ActionArithmeticOperationProcess}(_core_process_object__WEBPACK_IMPORTED_MODULE_17__.s)},42973:function(e,t,n){"use strict";n.d(t,{$$:function(){return r.$},HT:function(){return p},jx:function(){return w},Z7:function(){return P},M_:function(){return I},vO:function(){return q},eI:function(){return J},g7:function(){return ae},JQ:function(){return de},qB:function(){return we},ge:function(){return Pe},wh:function(){return Ie},Py:function(){return He},z2:function(){return Ze},o2:function(){return ot},SH:function(){return yt},h:function(){return Tt},QB:function(){return On},eF:function(){return kt},Wc:function(){return Ht},WB:function(){return Yt},NX:function(){return rn},hM:function(){return pn},zj:function(){return jn},XV:function(){return Nn},lp:function(){return Qn},io:function(){return er},k9:function(){return ur},cG:function(){return hr},HM:function(){return _r},MC:function(){return xr},fY:function(){return Ir},Km:function(){return Hr},z4:function(){return Yr}});var r=n(66389),o=(n(91058),n(41539),n(15581),n(2490),n(34514),n(54747),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948),n(74120)),i=n(89539);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},s(e,t)}function l(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(p,e);var t,n,r,o,a=(r=p,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=f(r);if(o){var n=f(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return l(this,e)});function p(){return u(this,p),a.apply(this,arguments)}return t=p,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t=[];if(!(0,i.isNullOrUndefined)(this.getMetadata().value_input_list))try{t=JSON.parse(this.getMetadata().value_input_list)}catch(e){}var n="disabled";(0,i.isNullOrUndefined)(this.getMetadata().minmax_min_change_type)||(n=this.getMetadata().minmax_min_change_type);var r="disabled";(0,i.isNullOrUndefined)(this.getMetadata().minmax_max_change_type)||(r=this.getMetadata().minmax_max_change_type);var o=null;(0,i.isNullOrUndefined)(this.getMetadata().minmax_min_change_value)||(o=this.getMetadata().minmax_min_change_value);var a=null;(0,i.isNullOrUndefined)(this.getMetadata().minmax_max_change_value)||(a=this.getMetadata().minmax_max_change_value);var u=0;return(0,i.isNullOrUndefined)(this.getMetadata().operand_value)||(u=parseInt(this.getMetadata().operand_value,10)),this.getProcessManager().getProductNode().getComponent("attributeManager").resolveAttributeManager().subscribe((function(e){t.forEach((function(t){var c=e.getAttributeController(t);if(!(0,i.isNullOrUndefined)(c)){var s=c.getAttribute(),l=s.attribute_values;if(l.length>0){var f=l[0];switch(s.type){case"text_input":var p=f.attribute_value_valuable;switch(n){case"null":p.min=null;break;case"update":p.min=o}switch(r){case"null":p.max=null;break;case"update":p.max=a}c.broadcastAttributeUpdated();break;case"operable_numbers_input":var d=f.attribute_value_valuable;if(u<d.operands.length){switch(n){case"null":d.operands[u].min_value=null;break;case"update":d.operands[u].min_value=o}switch(r){case"null":d.operands[u].max_value=null;break;case"update":d.operands[u].max_value=a}}c.broadcastAttributeUpdated()}}}}))}),(function(e){})),[]}}])&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),p}(o.s),d=(n(19601),n(41142));function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e,t){return v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},v(e,t)}function b(e,t){if(t&&("object"===h(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function g(e){return g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},g(e)}var w=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=g(r);if(o){var n=g(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return b(this,e)});function a(){return y(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){try{var t=this.getMetadata().value_string||"DEBUG";d.qL.info("[".concat(t,"]"),e)}catch(e){d.qL.error("Debug node encountered an error.",e)}return[Object.assign(e,{client:this,outPort:"forward"})]}}])&&m(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(o.s);function _(e){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_(e)}function O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function R(e,t){return R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},R(e,t)}function S(e,t){if(t&&("object"===_(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function E(e){return E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},E(e)}n(88674);var P=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&R(e,t)}(u,e);var t,n,r,o,a=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=E(r);if(o){var n=E(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return S(this,e)});function u(){return O(this,u),a.apply(this,arguments)}return t=u,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t=parseInt(this.getMetadata().value_selected_question,10),n={};try{n=JSON.parse(this.getMetadata().value_selected_options)}catch(e){}var r="all";if((0,i.isNullOrUndefined)(this.getMetadata().option_disabled_condition)||(r=this.getMetadata().option_disabled_condition),!(0,i.isNullOrUndefined)(t)){var o=this.getProcessManager().getProductNode().getComponent("attributeManager");return new Promise((function(e,a){o.resolveAttributeManager().subscribe((function(o){var a=o.getAttributeController(t);if(!(0,i.isNullOrUndefined)(a)){var u=a.getAttribute();(0,i.isNullOrUndefined)(u)||u.attribute_values.forEach((function(e){var t=!0;switch(r){case"enabled":t=!0===n[e.id]&&!0!==e.disabled;break;case"disabled":t=!0!==n[e.id]&&!0===e.disabled}if(t){var o=!0===n[e.id];a.setDisabled(o,{option_id:e.id}),a.broadcastAttributeUpdated()}})),e([])}}),(function(e){a(e)}))}))}return[]}}])&&T(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(o.s),x=n(26566);function j(e){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},j(e)}function C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function M(e,t){return M=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},M(e,t)}function D(e,t){if(t&&("object"===j(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function A(e){return A=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},A(e)}var I=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&M(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=A(r);if(o){var n=A(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return D(this,e)});function a(){return C(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){return[new x.q(e.type,e.data,this,"forward")]}}])&&k(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(o.s),N=(n(40561),n(29514)),V=n(70211);function U(e){return U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},U(e)}function F(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function L(e,t){return L=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},L(e,t)}function H(e,t){if(t&&("object"===U(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function z(e){return z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},z(e)}var q=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&L(e,t)}(u,e);var t,n,r,o,a=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=z(r);if(o){var n=z(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return H(this,e)});function u(){var e;return F(this,u),(e=a.apply(this,arguments)).mSubscriptions=new Array,e.onOffsetManagerSubject=null,e.mSceneOffsetManager=null,e}return t=u,(n=[{key:"onInit",value:function(){var e=this,t=this.getProcessManager().getProductNode();this.onOffsetManagerSubject=new V.xQ,this.mSubscriptions.push(t.onConfigurableNodeReady.subscribe((function(t){t.resolveSceneOffsetManager().then((function(t){null!==e.mSubscriptions&&null===e.mSceneOffsetManager&&(e.mSceneOffsetManager=t,e.onOffsetManagerSubject.next(t))}),(function(t){null===e.mSceneOffsetManager&&null!==e.onOffsetManagerSubject&&e.onOffsetManagerSubject.error("failed to get offset manager")}))})))}},{key:"onDestroy",value:function(){null!==this.onOffsetManagerSubject&&this.onOffsetManagerSubject.error("destroyed"),this.onOffsetManagerSubject=null,this.mSubscriptions.splice(0,this.mSubscriptions.length).forEach((function(e){return e.unsubscribe()})),this.mSubscriptions=null}},{key:"onHandleInPort",value:function(e){var t=this,n=this.getMetadata().value_offset;if(!(0,i.isNullOrUndefined)(n)){if(null===this.mSceneOffsetManager)return new Promise((function(e,r){t.onOffsetManagerSubject.pipe((0,N.P)()).subscribe((function(){t.mSceneOffsetManager.hideOffsetNode(n),e([])}),(function(e){r(e)}))}));this.mSceneOffsetManager.hideOffsetNode(n)}return[]}}])&&B(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(o.s),G=n(49575);function W(e){return W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},W(e)}function Q(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function K(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Y(e,t){return Y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Y(e,t)}function Z(e,t){if(t&&("object"===W(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function X(e){return X=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},X(e)}var J=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Y(e,t)}(u,e);var t,n,r,o,a=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=X(r);if(o){var n=X(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Z(this,e)});function u(){return Q(this,u),a.apply(this,arguments)}return t=u,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t=this.getMetadata().value_question;if(!(0,i.isNullOrUndefined)(t)){var n=this.getProcessManager().getProductNode();n.getRenderState().dispatchAppMessage(new G.Z(n.getSceneObjectId(),n.getObjectUUID(),t,!1))}return[]}}])&&K(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(o.s),$=n(14311);function ee(e){return ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ee(e)}function te(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ne(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function re(e,t){return re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},re(e,t)}function oe(e,t){if(t&&("object"===ee(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ie(e){return ie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ie(e)}var ae=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&re(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ie(r);if(o){var n=ie(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return oe(this,e)});function a(){return te(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t=this.getMetadata().value_text;return this.getProcessManager().getProductNode().getRenderState().getSceneManager().getApplication().dispatchEvent($.G.Warning,{type:"warning",message:t}),[]}}])&&ne(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(o.s);function ue(e){return ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ue(e)}function ce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function se(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function le(e,t){return le=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},le(e,t)}function fe(e,t){if(t&&("object"===ue(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function pe(e){return pe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},pe(e)}var de=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&le(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=pe(r);if(o){var n=pe(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return fe(this,e)});function a(){return ce(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t=this.getMetadata().value_text;return this.getProcessManager().getProductNode().getRenderState().getSceneManager().getApplication().dispatchEvent($.G.Warning,{type:"toast",message:t}),[]}}])&&se(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(o.s);function he(e){return he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},he(e)}function ye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function me(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ve(e,t){return ve=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ve(e,t)}function be(e,t){if(t&&("object"===he(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ge(e){return ge=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ge(e)}var we=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ve(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ge(r);if(o){var n=ge(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return be(this,e)});function a(){return ye(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t=this.getMetadata().value_text;return this.getProcessManager().getProductNode().getRenderState().getSceneManager().getApplication().dispatchEvent($.G.Warning,{type:"info",message:t}),[]}}])&&me(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(o.s);function _e(e){return _e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_e(e)}function Oe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Te(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Re(e,t){return Re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Re(e,t)}function Se(e,t){if(t&&("object"===_e(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ee(e){return Ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ee(e)}var Pe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Re(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ee(r);if(o){var n=Ee(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Se(this,e)});function a(){return Oe(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(){var e=this.getMetadata();return this.getProcessManager().getProductNode().getRenderState().getSceneManager().getApplication().dispatchEvent($.G.PlaySound,e.sound),[]}}])&&Te(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(o.s),xe=n(27109);function je(e){return je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},je(e)}function Ce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ke(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Me(e,t){return Me=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Me(e,t)}function De(e,t){if(t&&("object"===je(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ae(e){return Ae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ae(e)}var Ie=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Me(e,t)}(u,e);var t,n,r,o,a=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ae(r);if(o){var n=Ae(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return De(this,e)});function u(){return Ce(this,u),a.apply(this,arguments)}return t=u,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t=this.getMetadata().value_matgroup_id,n="hidden"!==this.getMetadata().price_visibility;return(0,i.isNullOrUndefined)(t)||this.getProcessManager().getProductNode().getRenderState().dispatchAppMessage(new xe.G(t,n)),[]}}])&&ke(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(o.s);function Ne(e){return Ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ne(e)}function Ve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ue(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fe(e,t){return Fe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Fe(e,t)}function Be(e,t){if(t&&("object"===Ne(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Le(e){return Le=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Le(e)}var He=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Fe(e,t)}(u,e);var t,n,r,o,a=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Le(r);if(o){var n=Le(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Be(this,e)});function u(){var e;return Ve(this,u),(e=a.apply(this,arguments)).mSubscriptions=new Array,e.onOffsetManagerSubject=null,e.mSceneOffsetManager=null,e.mAnimationHandler=null,e}return t=u,n=[{key:"onInit",value:function(){var e=this,t=this.getProcessManager().getProductNode();this.onOffsetManagerSubject=new V.xQ,this.mSubscriptions.push(t.onConfigurableNodeReady.subscribe((function(t){t.resolveSceneOffsetManager().then((function(t){null!==e.mSubscriptions&&null===e.mSceneOffsetManager&&(e.mSceneOffsetManager=t,e.onOffsetManagerSubject.next(t))}),(function(t){null===e.mSceneOffsetManager&&null!==e.onOffsetManagerSubject&&e.onOffsetManagerSubject.error("failed to get offset manager")}))})))}},{key:"onDestroy",value:function(){(0,i.isNullOrUndefined)(this.onOffsetManagerSubject)||this.onOffsetManagerSubject.error("destroyed"),this.onOffsetManagerSubject=null,this.mSubscriptions.splice(0,this.mSubscriptions.length).forEach((function(e){return e.unsubscribe()})),this.mSubscriptions=null,null!==this.mAnimationHandler&&clearTimeout(this.mAnimationHandler)}},{key:"playRotation",value:function(e,t,n){var r=this,o=this.mSceneOffsetManager.getOffsetRotation(e);return new Promise((function(a,u){if((0,i.isNullOrUndefined)(o))return u("offset id note found:"+e);r._animateFrames(e,o.clone(),t,n,(function(){a([])}))}))}},{key:"_animateFrames",value:function(e,t,n,r,o){var i=this,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(this.mAnimationHandler=null,a>1)return this.mSceneOffsetManager.setOffsetRotation(e,n),void o();var u=new THREE.Quaternion;THREE.Quaternion.slerp(t,n,u,a),this.mSceneOffsetManager.setOffsetRotation(e,u);var c=a+.016/r;this.mAnimationHandler=setTimeout((function(){return i._animateFrames(e,t,n,r,o,c)}),16)}},{key:"onHandleInPort",value:function(e){var t=this,n=this.getMetadata().value_offset,r=this.getMetadata().value_speed;r=(0,i.isNullOrUndefined)(r)?0:r;var o=this.getMetadata().value_vec_x;o=(0,i.isNullOrUndefined)(o)?0:o;var a=this.getMetadata().value_vec_y;a=(0,i.isNullOrUndefined)(a)?0:a;var u=this.getMetadata().value_vec_z;if(u=(0,i.isNullOrUndefined)(u)?0:u,!(0,i.isNullOrUndefined)(n)){var c=new THREE.Euler(THREE.Math.degToRad(o),THREE.Math.degToRad(a),THREE.Math.degToRad(u)),s=(new THREE.Quaternion).setFromEuler(c);return d.qL.print("rotate offset: ",n,s,"speed: ",r),null!==this.mSceneOffsetManager?this.playRotation(n,s,r):new Promise((function(e,o){t.onOffsetManagerSubject.pipe((0,N.P)()).subscribe((function(){t.playRotation(n,s,r).then((function(t){e(t)}),(function(e){o(e)}))}),(function(e){o(e)}))}))}return[]}}],n&&Ue(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(o.s),ze=n(79816);function qe(e){return qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qe(e)}function Ge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function We(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qe(e,t){return Qe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Qe(e,t)}function Ke(e,t){if(t&&("object"===qe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ye(e){return Ye=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ye(e)}var Ze=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Qe(e,t)}(u,e);var t,n,r,o,a=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ye(r);if(o){var n=Ye(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Ke(this,e)});function u(){return Ge(this,u),a.apply(this,arguments)}return t=u,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t=this.getMetadata().value_camera,n="no"!==this.getMetadata().camera_openview;return(0,i.isNullOrUndefined)(t)||this.getProcessManager().getProductNode().getRenderState().dispatchAppMessage(new ze.u1(t,!0,n)),[]}}])&&We(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(o.s);function Xe(e){return Xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xe(e)}function Je(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function $e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function et(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tt(e,t){return tt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},tt(e,t)}function nt(e,t){if(t&&("object"===Xe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function rt(e){return rt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},rt(e)}n(35666);var ot=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tt(e,t)}(u,e);var t,n,r,o,a=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=rt(r);if(o){var n=rt(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return nt(this,e)});function u(){return $e(this,u),a.apply(this,arguments)}return t=u,n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t=this,n=[];if(!(0,i.isNullOrUndefined)(this.getMetadata().select_color_edit_list))try{n=JSON.parse(this.getMetadata().select_color_edit_list)}catch(e){}return n&&n.length>0?new Promise((function(e,r){t.getProcessManager().getProductNode().getComponent("attributeManager").resolveAttributeManager().subscribe(function(){var t,r=(t=regeneratorRuntime.mark((function t(r){var o,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=[],n.forEach((function(e){var t=e.question_id||null,n=e.color_id||null;if(!(0,i.isNullOrUndefined)(t)&&!(0,i.isNullOrUndefined)(n)){var a=r.getValue(t);(0,i.isNullOrUndefined)(a)||a.attribute_value_id==n||o.push({q:t,o:n})}})),a=0;case 3:if(!(a<o.length)){t.next=9;break}return t.next=6,r.setValue(o[a].q,o[a].o,{emitEvent:!0,rebuild:a===o.length-1});case 6:a++,t.next=3;break;case 9:e([]);case 10:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(e){Je(i,r,o,a,u,"next",e)}function u(e){Je(i,r,o,a,u,"throw",e)}a(void 0)}))});return function(e){return r.apply(this,arguments)}}(),(function(e){r(e)}))})):[]}}],n&&et(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(o.s),it=(n(74916),n(23123),n(4723),n(69826),n(63202)),at=n(84217);function ut(e){return ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ut(e)}function ct(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function st(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){ct(i,r,o,a,u,"next",e)}function u(e){ct(i,r,o,a,u,"throw",e)}a(void 0)}))}}function lt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ft(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pt(e,t){return pt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},pt(e,t)}function dt(e,t){if(t&&("object"===ut(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ht(e){return ht=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ht(e)}var yt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pt(e,t)}(c,e);var t,n,r,o,a,u=(o=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ht(o);if(a){var n=ht(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return dt(this,e)});function c(){return lt(this,c),u.apply(this,arguments)}return t=c,n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t=this;d.qL.print("select options");var n=[];if((0,i.isNullOrUndefined)(this.getMetadata().value_option_list))(0,i.isNullOrUndefined)(this.getMetadata().value_option)||n.push(this.getMetadata().value_option);else try{n=JSON.parse(this.getMetadata().value_option_list)}catch(e){d.qL.print("Failed to parse select option rule:",e)}var r=[];if(n.forEach((function(e){var t=e.split(":");if(2===t.length||3===t.length)try{var n=null;if(3===t.length){var o=t[2].match(/^(\d+)\((.*)\)$/);3===o.length&&(n=o[2])}var a=r.find((function(e){return e.product_uuid===n}));(0,i.isNullOrUndefined)(a)&&(a={product_uuid:n,option_list:[]},r.push(a)),a.option_list.push({question_id:parseInt(t[0],10),option_id:t[1]})}catch(e){d.qL.error("failed to read select option rule: ",e)}})),r.length>0){var o=[];return r.forEach((function(e){o.push(t.applyAttribute(e.product_uuid,e.option_list))})),new Promise((function(e,t){if(0===o.length)return e([]);(0,it.aj)(o).pipe((0,at.q)(1)).subscribe((function(t){e([])}),(function(e){t(e)}))}))}return[]}},{key:"applyAttribute",value:(r=st(regeneratorRuntime.mark((function e(t,n){var r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,o){var a=null;if((0,i.isNullOrUndefined)(t))a=r.getProcessManager().getProductNode();else{var u=r.getProcessManager().getProductNode().getRenderState().getSceneManager().findNodesOfTypeName("ProductNode",(function(e){return e.getValue("object_uuid")===t}));u.length>0&&(a=u[0])}if(null===a)return o("product with uuid '"+t+"' not found");a.getComponent("attributeManager").resolveAttributeManager().subscribe(function(){var t=st(regeneratorRuntime.mark((function t(r){var o,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=[],n.forEach((function(e){var t=r.getValue(e.question_id);(0,i.isNullOrUndefined)(t)||t.attribute_value_id==e.option_id||o.push({q:e.question_id,o:e.option_id})})),a=0;case 3:if(!(a<o.length)){t.next=9;break}return t.next=6,r.setValue(o[a].q,o[a].o,{emitEvent:!0,rebuild:a===o.length-1});case 6:a++,t.next=3;break;case 9:e(!0);case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),(function(e){o(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(e,t){return r.apply(this,arguments)})}],n&&ft(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(o.s),mt=n(82417);function vt(e){return vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vt(e)}function bt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wt(e,t){return wt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},wt(e,t)}function _t(e,t){if(t&&("object"===vt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ot(e){return Ot=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ot(e)}var Tt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wt(e,t)}(u,e);var t,n,r,o,a=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ot(r);if(o){var n=Ot(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return _t(this,e)});function u(){return bt(this,u),a.apply(this,arguments)}return t=u,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t=this.getMetadata().value_view;return(0,i.isNullOrUndefined)(t)||(d.qL.print("select view id: ",t),this.getProcessManager().getProductNode().getRenderState().dispatchAppMessage(new mt.U(t))),[]}}])&&gt(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(o.s),Rt=(n(54678),n(68009));function St(e){return St="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},St(e)}function Et(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xt(e,t){return xt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},xt(e,t)}function jt(e,t){if(t&&("object"===St(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ct(e){return Ct=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ct(e)}var kt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xt(e,t)}(u,e);var t,n,r,o,a=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ct(r);if(o){var n=Ct(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return jt(this,e)});function u(){return Et(this,u),a.apply(this,arguments)}return t=u,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t=[];if(!(0,i.isNullOrUndefined)(this.getMetadata().value_input_list))try{t=JSON.parse(this.getMetadata().value_input_list)}catch(e){}var n="min";(0,i.isNullOrUndefined)(this.getMetadata().selected_range)||(n=this.getMetadata().selected_range);var r=0;(0,i.isNullOrUndefined)(this.getMetadata().operand_value)||(r=parseInt(this.getMetadata().operand_value,10));var o=null;switch(e.data.attribute_type){case"operable_numbers_input":case"text_to_image":case"text_input":o=e.data.attribute_value_name;break;default:o=e.data.value}return o=Rt.F.isNumeric(o)?parseFloat(o):null,this.getProcessManager().getProductNode().getComponent("attributeManager").resolveAttributeManager().subscribe((function(e){t.forEach((function(t){var a=e.getAttributeController(t);if(!(0,i.isNullOrUndefined)(a)){var u=a.getAttribute(),c=u.attribute_values;if(c.length>0){var s=c[0];switch(u.type){case"text_input":var l=s.attribute_value_valuable;switch(n){case"min":l.min=o;break;case"max":l.max=o}a.broadcastAttributeUpdated();break;case"operable_numbers_input":var f=s.attribute_value_valuable;if(r<f.operands.length)switch(n){case"min":f.operands[r].min_value=o;break;case"max":f.operands[r].max_value=o}a.broadcastAttributeUpdated()}}}}))}),(function(){})),[]}}])&&Pt(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(o.s);function Mt(e){return Mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mt(e)}function Dt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=At(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw i}}}}function At(e,t){if(e){if("string"==typeof e)return It(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?It(e,t):void 0}}function It(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Nt(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function Vt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ut(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ft(e,t){return Ft=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ft(e,t)}function Bt(e,t){if(t&&("object"===Mt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Lt(e){return Lt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Lt(e)}n(76373),n(9653),n(15306),n(56977),n(47042),n(68309),n(91038),n(77601);var Ht=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ft(e,t)}(u,e);var t,n,r,o,a=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Lt(r);if(o){var n=Lt(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Bt(this,e)});function u(){return Vt(this,u),a.apply(this,arguments)}return t=u,n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t=this,n=[];if(!(0,i.isNullOrUndefined)(this.getMetadata().value_input_list))try{n=JSON.parse(this.getMetadata().value_input_list)}catch(e){d.qL.error(e)}var r=e.data.value,o=[],a=this.transformNewValue(r);return this.getProcessManager().getProductNode().getComponent("attributeManager").resolveAttributeManager().subscribe(function(){var e,r=(e=regeneratorRuntime.mark((function e(r){var i,u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=Dt(n),e.prev=1,i.s();case 3:if((u=i.n()).done){e.next=10;break}return c=u.value,e.next=7,r.setValue(c,a);case 7:o.push(new x.q("input",{attribute_id:c,value:a},t,"input_id"));case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),i.e(e.t0);case 15:return e.prev=15,i.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[1,12,15,18]])})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Nt(i,r,o,a,u,"next",e)}function u(e){Nt(i,r,o,a,u,"throw",e)}a(void 0)}))});return function(e){return r.apply(this,arguments)}}(),(function(e){d.qL.error(e)})),o}},{key:"transformNewValue",value:function(e){var t="string"==typeof e||"number"==typeof e?e:"",n=this.getMetadata().value_text||"";if(!n)return"";var r,o,i=Dt(function(e){if(Array.isArray(e))return It(e)}(o=n.matchAll(/{value(?:\|(\d+))?}/gi))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(o)||At(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());try{for(i.s();!(r=i.n()).done;){var a=r.value,u=a[0],c=Math.max(Number(a[1])||0,0);n=Rt.F.isNumeric(t)?n.replace(u,Number(t).toFixed(c)):n.replace(u,String(t))}}catch(e){i.e(e)}finally{i.f()}return n}}],n&&Ut(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(o.s);function zt(e){return zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zt(e)}function qt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wt(e,t){return Wt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Wt(e,t)}function Qt(e,t){if(t&&("object"===zt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Kt(e){return Kt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Kt(e)}var Yt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Wt(e,t)}(u,e);var t,n,r,o,a=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Kt(r);if(o){var n=Kt(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Qt(this,e)});function u(){return qt(this,u),a.apply(this,arguments)}return t=u,(n=[{key:"onDestroy",value:function(){}},{key:"onInit",value:function(){}},{key:"onHandleInPort",value:function(e){var t=this.getMetadata().value_node_id;if((0,i.isNullOrUndefined)(t))return[];var n=this.getProcessManager().getProductNode(),r=n.getRenderState().getSceneManager().findNode(t);if(!(0,i.isNullOrUndefined)(r)){var o=this.getValue(e.data);o=this.fixFloat(o),r.setValue("title",o)}return n.getRenderState().requestFrame(),[]}},{key:"getValue",value:function(e){switch(e.attribute_type){case"operable_numbers_input":case"text_to_image":case"text_input":return e.attribute_value_name}return(0,i.isNullOrUndefined)(e.value)?"":e.value}},{key:"fixFloat",value:function(e){var t=Number(e);return isNaN(t)||t*Math.pow(10,2)%1==0?e:t.toFixed(2)}}])&&Gt(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(o.s),Zt=n(87181);function Xt(e){return Xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xt(e)}function Jt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function en(e,t){return en=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},en(e,t)}function tn(e,t){if(t&&("object"===Xt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function nn(e){return nn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},nn(e)}var rn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&en(e,t)}(u,e);var t,n,r,o,a=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=nn(r);if(o){var n=nn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return tn(this,e)});function u(){return Jt(this,u),a.apply(this,arguments)}return t=u,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t;try{t=JSON.parse(this.getMetadata().material_reference)}catch(e){}var n=this.getMetadata().material_hex_color;if(!(0,i.isNullOrUndefined)(t)&&Rt.F.isNumeric(t.material_id)&&(0,i.isString)(n)){var r=this.getProcessManager().getProductNode();r.getRenderState().getResourceManager().getManager(Zt.ResourceManagerTypes.MaterialManager).then((function(e){var o=(0,i.isString)(n)&&n.length>0?n.substr(0,7):"";e.setColorOverwrite(t.material_id,o,r)}),(function(){}))}return[]}}])&&$t(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(o.s),on=n(99556);function an(e){return an="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},an(e)}function un(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function sn(e,t){return sn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},sn(e,t)}function ln(e,t){if(t&&("object"===an(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function fn(e){return fn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},fn(e)}var pn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sn(e,t)}(u,e);var t,n,r,o,a=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=fn(r);if(o){var n=fn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return ln(this,e)});function u(){var e;return un(this,u),(e=a.apply(this,arguments)).mSubscriptions=new Array,e.onMatManagerSubject=null,e.mMaterialGroupManager=null,e}return t=u,(n=[{key:"onInit",value:function(){var e=this;this.onMatManagerSubject=new V.xQ;var t=this.getProcessManager().getProductNode().getComponent("materialGroupManager");this.mSubscriptions.push(t.resolveMaterialGroups().subscribe((function(t){null!==e.mSubscriptions&&null===e.mMaterialGroupManager&&(e.mMaterialGroupManager=t,e.onMatManagerSubject.next(t))}),(function(){null===e.mMaterialGroupManager&&null!==e.onMatManagerSubject&&e.onMatManagerSubject.error("Failed to get material manager")})))}},{key:"onDestroy",value:function(){null!==this.onMatManagerSubject&&this.onMatManagerSubject.error("destroyed"),this.onMatManagerSubject=null,this.mSubscriptions.splice(0).forEach((function(e){return e.unsubscribe()})),this.mSubscriptions=null}},{key:"onHandleInPort",value:function(){var e=this,t=null,n=null,r=null;try{(0,i.isNullOrUndefined)(this.getMetadata().value_mat_or_matgroup_mat_value)?(0,i.isNullOrUndefined)(this.getMetadata().material_reference)||(t=JSON.parse(this.getMetadata().material_reference)):t=JSON.parse(this.getMetadata().value_mat_or_matgroup_mat_value),(0,i.isNullOrUndefined)(this.getMetadata().value_mat_or_matgroup_group_value)||(n=JSON.parse(this.getMetadata().value_mat_or_matgroup_group_value)),r=JSON.parse(this.getMetadata().material_maps)}catch(e){d.qL.error(e)}if(!(0,i.isNullOrUndefined)(r)&&(0,i.isArray)(r)){var o=this.getProcessManager().getProductNode();if(!(0,i.isNullOrUndefined)(t)&&Rt.F.isNumeric(t.material_id)&&o.getRenderState().getResourceManager().getManager(Zt.ResourceManagerTypes.MaterialManager).then((function(e){for(var n=[],i=0;i<r.length;i++)n.push(e.setMapOverwrite(t.material_id,r[i].type,r[i].textureId,o));on.S.resolveArray(n,(function(){d.qL.print("Texture on material applied using material-map-rule!"),o.getRenderState().requestFrame()}))}),(function(){d.qL.error("Rule: Set Material Map: Material Manager not found!")})),!(0,i.isNullOrUndefined)(n)){if(null===this.mMaterialGroupManager)return new Promise((function(t,i){e.onMatManagerSubject.pipe((0,N.P)()).subscribe((function(){for(var i=[],a=0;a<r.length;a++)i.push(e.mMaterialGroupManager.setMapOverwrite(n,r[a].type,r[a].textureId,o));on.S.resolveArray(i,(function(){return d.qL.print("Texture on material group applied using (promise) material-group-map-rule!"),o.getRenderState().requestFrame(),t([])}))}),(function(e){return i(e)}))}));for(var a=[],u=0;u<r.length;u++)a.push(this.mMaterialGroupManager.setMapOverwrite(n,r[u].type,r[u].textureId,o));on.S.resolveArray(a,(function(){d.qL.print("Texture on material group applied using material-group-map-rule!"),o.getRenderState().requestFrame()}))}}return[]}}])&&cn(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(o.s);function dn(e){return dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dn(e)}function hn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function yn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hn(Object(n),!0).forEach((function(t){mn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function mn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gn(e,t){return gn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},gn(e,t)}function wn(e,t){if(t&&("object"===dn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function _n(e){return _n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},_n(e)}n(47941),n(57327),n(88449),n(59849),n(38880),n(49337),n(33321);var On=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gn(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=_n(r);if(o){var n=_n(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return wn(this,e)});function a(){return vn(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t=this.getMetadata().value_question,n=this.getMetadata().color;if(!t||!n)return[];var r=this.getProcessManager().getProductNode().getComponent("attributeManager");return new Promise((function(o,i){r.resolveAttributeManager().subscribe((function(r){var i=r.getAttributeController(t);i.setValue(yn(yn({},i.getValue()),{},mn({},n.type,e.data.value))),o([])}),(function(e){return i(e)}))}))}}])&&bn(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(o.s);function Tn(e){return Tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tn(e)}function Rn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Sn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function En(e,t){return En=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},En(e,t)}function Pn(e,t){if(t&&("object"===Tn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function xn(e){return xn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},xn(e)}var jn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&En(e,t)}(u,e);var t,n,r,o,a=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=xn(r);if(o){var n=xn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Pn(this,e)});function u(){var e;return Rn(this,u),(e=a.apply(this,arguments)).mSubscriptions=new Array,e.onMatManagerSubject=null,e.mMaterialGroupManager=null,e}return t=u,(n=[{key:"onInit",value:function(){var e=this;this.onMatManagerSubject=new V.xQ;var t=this.getProcessManager().getProductNode().getComponent("materialGroupManager");this.mSubscriptions.push(t.resolveMaterialGroups().subscribe((function(t){null!==e.mSubscriptions&&null===e.mMaterialGroupManager&&(e.mMaterialGroupManager=t,e.onMatManagerSubject.next(t))}),(function(t){null===e.mMaterialGroupManager&&null!==e.onMatManagerSubject&&e.onMatManagerSubject.error("Failed to get material manager")})))}},{key:"onDestroy",value:function(){null!==this.onMatManagerSubject&&this.onMatManagerSubject.error("destroyed"),this.onMatManagerSubject=null,this.mSubscriptions.splice(0,this.mSubscriptions.length).forEach((function(e){return e.unsubscribe()})),this.mSubscriptions=null}},{key:"setMaterials",value:function(e){var t=this;e.forEach((function(e){if(e.length>0){var n=e.split(":");2==n.length&&t.mMaterialGroupManager.setActiveMaterial(n[0],n[1])}}))}},{key:"onHandleInPort",value:function(e){var t=this,n=[];if((0,i.isNullOrUndefined)(this.getMetadata().value_matgroup_list))(0,i.isNullOrUndefined)(this.getMetadata().value_matgroup)||n.push(this.getMetadata().value_matgroup);else try{n=JSON.parse(this.getMetadata().value_matgroup_list)}catch(e){}return null===this.mMaterialGroupManager?new Promise((function(e,r){t.onMatManagerSubject.pipe((0,N.P)()).subscribe((function(){t.setMaterials(n),e([])}),(function(e){r(e)}))})):(this.setMaterials(n),[])}}])&&Sn(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(o.s);function Cn(e){return Cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cn(e)}function kn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Mn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Dn(e,t){return Dn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Dn(e,t)}function An(e,t){if(t&&("object"===Cn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function In(e){return In=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},In(e)}var Nn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Dn(e,t)}(u,e);var t,n,r,o,a=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=In(r);if(o){var n=In(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return An(this,e)});function u(){var e;return kn(this,u),(e=a.apply(this,arguments)).mSubscriptions=new Array,e.onOffsetManagerSubject=null,e.mSceneOffsetManager=null,e.mAnimationHandler=null,e}return t=u,n=[{key:"onInit",value:function(){var e=this,t=this.getProcessManager().getProductNode();this.onOffsetManagerSubject=new V.xQ,this.mSubscriptions.push(t.onConfigurableNodeReady.subscribe((function(t){t.resolveSceneOffsetManager().then((function(t){null!==e.mSubscriptions&&null===e.mSceneOffsetManager&&(e.mSceneOffsetManager=t,e.onOffsetManagerSubject.next(t))}),(function(t){null===e.mSceneOffsetManager&&null!==e.onOffsetManagerSubject&&e.onOffsetManagerSubject.error("failed to get offset manager")}))})))}},{key:"onDestroy",value:function(){null!==this.onOffsetManagerSubject&&this.onOffsetManagerSubject.error("destroyed"),this.onOffsetManagerSubject=null,this.mSubscriptions.splice(0,this.mSubscriptions.length).forEach((function(e){return e.unsubscribe()})),this.mSubscriptions=null}},{key:"playMovement",value:function(e,t,n,r){var o=this,a=this.mSceneOffsetManager.getOffsetVector(e,t);return new Promise((function(u,c){if((0,i.isNullOrUndefined)(a))return c("offset id not found:"+e);r<=0?(o.mSceneOffsetManager.setOffset(e,t,n),u([])):o._animateFrames(e,t,a.clone(),n,r,(function(){u([])}))}))}},{key:"_animateFrames",value:function(e,t,n,r,o,i){var a=this,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;if(this.mAnimationHandler=null,u>1)return this.mSceneOffsetManager.setOffset(e,t,r),void i();var c=new THREE.Vector3;c.lerpVectors(n,r,u),this.mSceneOffsetManager.setOffset(e,t,c);var s=u+.016/o;this.mAnimationHandler=setTimeout((function(){return a._animateFrames(e,t,n,r,o,i,s)}),16)}},{key:"onHandleInPort",value:function(e){var t=this,n=this.getMetadata().value_offset,r=this.getMetadata().value_speed||0,o=this.getMetadata().value_level;o=(0,i.isNullOrUndefined)(o)?0:o;var a=this.getMetadata().value_vec_x;a=(0,i.isNullOrUndefined)(a)?0:a;var u=this.getMetadata().value_vec_y;u=(0,i.isNullOrUndefined)(u)?0:u;var c=this.getMetadata().value_vec_z;if(c=(0,i.isNullOrUndefined)(c)?0:c,!(0,i.isNullOrUndefined)(n)){var s=new THREE.Vector3(a,u,c);return null!==this.mSceneOffsetManager?this.playMovement(n,o,s,r):new Promise((function(e,i){t.onOffsetManagerSubject.pipe((0,N.P)()).subscribe((function(){t.playMovement(n,o,s,r).then((function(t){e(t)}),(function(e){i(e)}))}),(function(e){i(e)}))}))}return[]}}],n&&Mn(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(o.s);function Vn(e){return Vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vn(e)}function Un(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Fn(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw i}}}}function Fn(e,t){if(e){if("string"==typeof e)return Bn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Bn(e,t):void 0}}function Bn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ln(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function Hn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qn(e,t){return qn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},qn(e,t)}function Gn(e,t){if(t&&("object"===Vn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Wn(e){return Wn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Wn(e)}var Qn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qn(e,t)}(u,e);var t,n,r,o,a=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Wn(r);if(o){var n=Wn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Gn(this,e)});function u(){return Hn(this,u),a.apply(this,arguments)}return t=u,n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t=this,n=[];if(!(0,i.isNullOrUndefined)(this.getMetadata().value_input_list))try{n=JSON.parse(this.getMetadata().value_input_list)}catch(e){}var r=0;(0,i.isNullOrUndefined)(this.getMetadata().operand_value)||(r=parseInt(this.getMetadata().operand_value,10));var o=[];return this.getProcessManager().getProductNode().getComponent("attributeManager").resolveAttributeManager().subscribe(function(){var i,a=(i=regeneratorRuntime.mark((function i(a){var u,c,s,l,f,p,d,h,y;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:u=e.data?e.data.value:void 0,c=t.getMetadata().value_text,s=t.transformNewValue(c,u),l=Rt.F.isNumeric(s)?Number(s):void 0,f=Un(n),i.prev=5,f.s();case 7:if((p=f.n()).done){i.next=17;break}return d=p.value,h=Number(d),(y={})[r]={value:l},i.next=14,a.setValue(h,y);case 14:o.push(new x.q("input",{attribute_id:h,value:l},t,"input_id"));case 15:i.next=7;break;case 17:i.next=22;break;case 19:i.prev=19,i.t0=i.catch(5),f.e(i.t0);case 22:return i.prev=22,f.f(),i.finish(22);case 25:case"end":return i.stop()}}),i,null,[[5,19,22,25]])})),function(){var e=this,t=arguments;return new Promise((function(n,r){var o=i.apply(e,t);function a(e){Ln(o,n,r,a,u,"next",e)}function u(e){Ln(o,n,r,a,u,"throw",e)}a(void 0)}))});return function(e){return a.apply(this,arguments)}}(),(function(e){d.qL.error(e)})),o}},{key:"transformNewValue",value:function(e,t){var n,r=null!=t?t:"";if(e){var o,i=Un(function(e){if(Array.isArray(e))return Bn(e)}(n=e.matchAll(/{value(?:\|(\d+))?}/gi))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||Fn(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());try{for(i.s();!(o=i.n()).done;){var a=o.value,u=a[0],c=Math.max(Number(a[1])||0,0);e=Rt.F.isNumeric(r)?e.replace(u,Number(r).toFixed(c)):e.replace(u,String(r))}}catch(e){i.e(e)}finally{i.f()}return e}}}],n&&zn(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(o.s);function Kn(e){return Kn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kn(e)}function Yn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Xn(e,t){return Xn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Xn(e,t)}function Jn(e,t){if(t&&("object"===Kn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function $n(e){return $n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},$n(e)}var er=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xn(e,t)}(u,e);var t,n,r,o,a=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=$n(r);if(o){var n=$n(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Jn(this,e)});function u(){return Yn(this,u),a.apply(this,arguments)}return t=u,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t="";if("string"===e.type||"input"===e.type)switch(e.data.attribute_type){case"operable_numbers_input":case"text_to_image":case"text_input":t+=e.data.attribute_value_name;break;default:t+=(0,i.isNullOrUndefined)(e.data.value)?"":e.data.value}return t+=this.getMetadata().value_text,[new x.q("string",{value:t},this,"text")]}}])&&Zn(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(o.s);function tr(e){return tr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tr(e)}function nr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function or(e,t){return or=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},or(e,t)}function ir(e,t){if(t&&("object"===tr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ar(e){return ar=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ar(e)}var ur=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&or(e,t)}(u,e);var t,n,r,o,a=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ar(r);if(o){var n=ar(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return ir(this,e)});function u(){var e;return nr(this,u),(e=a.apply(this,arguments)).mSubscriptions=new Array,e.onOffsetManagerSubject=null,e.mSceneOffsetManager=null,e}return t=u,(n=[{key:"onInit",value:function(){var e=this,t=this.getProcessManager().getProductNode();this.onOffsetManagerSubject=new V.xQ,this.mSubscriptions.push(t.onConfigurableNodeReady.subscribe((function(t){t.resolveSceneOffsetManager().then((function(t){null!==e.mSubscriptions&&null===e.mSceneOffsetManager&&(e.mSceneOffsetManager=t,e.onOffsetManagerSubject.next(t))}),(function(t){null===e.mSceneOffsetManager&&null!==e.onOffsetManagerSubject&&e.onOffsetManagerSubject.error("failed to get offset manager")}))})))}},{key:"onDestroy",value:function(){null!==this.onOffsetManagerSubject&&this.onOffsetManagerSubject.error("destroyed"),this.onOffsetManagerSubject=null,this.mSubscriptions.splice(0,this.mSubscriptions.length).forEach((function(e){return e.unsubscribe()})),this.mSubscriptions=null}},{key:"onHandleInPort",value:function(e){var t=this,n=this.getMetadata().value_offset;if(!(0,i.isNullOrUndefined)(n)){if(null===this.mSceneOffsetManager)return new Promise((function(e,r){t.onOffsetManagerSubject.pipe((0,N.P)()).subscribe((function(){t.mSceneOffsetManager.showOffsetNode(n),e([])}),(function(e){r(e)}))}));this.mSceneOffsetManager.showOffsetNode(n)}return[]}}])&&rr(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(o.s);function cr(e){return cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cr(e)}function sr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fr(e,t){return fr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},fr(e,t)}function pr(e,t){if(t&&("object"===cr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function dr(e){return dr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},dr(e)}var hr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fr(e,t)}(u,e);var t,n,r,o,a=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=dr(r);if(o){var n=dr(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return pr(this,e)});function u(){return sr(this,u),a.apply(this,arguments)}return t=u,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t=this.getMetadata().value_question;if(!(0,i.isNullOrUndefined)(t)){var n=this.getProcessManager().getProductNode();n.getRenderState().dispatchAppMessage(new G.Z(n.getSceneObjectId(),n.getObjectUUID(),t,!0))}return[]}}])&&lr(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(o.s);function yr(e){return yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yr(e)}function mr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function br(e,t){return br=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},br(e,t)}function gr(e,t){if(t&&("object"===yr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function wr(e){return wr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},wr(e)}var _r=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&br(e,t)}(u,e);var t,n,r,o,a=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=wr(r);if(o){var n=wr(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return gr(this,e)});function u(){return mr(this,u),a.apply(this,arguments)}return t=u,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t=null;if((0,i.isNullOrUndefined)(this.getMetadata().value_update_attribute_id)||(t=parseInt(this.getMetadata().value_update_attribute_id,10)),null===t)return[];var n=null;(0,i.isNullOrUndefined)(this.getMetadata().value_update_attribute_name)||(n=this.getMetadata().value_update_attribute_name);var r=null;if(!(0,i.isNullOrUndefined)(this.getMetadata().value_update_attribute_valuable))try{var o=JSON.parse(this.getMetadata().value_update_attribute_valuable);r=o}catch(e){}return this.getProcessManager().getProductNode().getComponent("attributeManager").resolveAttributeManager().subscribe((function(e){var o=e.getAttributeController(t);if(!(0,i.isNullOrUndefined)(o)){var a=o.getAttribute();(0,i.isNullOrUndefined)(n)||(a.name=n),(0,i.isNullOrUndefined)(r)||(a.attribute_values=a.attribute_values||[],0===a.attribute_values.length&&a.attribute_values.push({attribute_value_valuable:{}}),a.attribute_values[0].attribute_value_valuable=Object.assign(a.attribute_values[0].attribute_value_valuable,r)),o.broadcastAttributeUpdated()}}),(function(e){})),[]}}])&&vr(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(o.s);function Or(e){return Or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Or(e)}function Tr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Sr(e,t){return Sr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Sr(e,t)}function Er(e,t){if(t&&("object"===Or(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Pr(e){return Pr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Pr(e)}var xr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Sr(e,t)}(u,e);var t,n,r,o,a=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Pr(r);if(o){var n=Pr(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Er(this,e)});function u(){return Tr(this,u),a.apply(this,arguments)}return t=u,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t=this.getMetadata().value_selected_color_question,n={};try{n=JSON.parse(this.getMetadata().value_selected_colors)}catch(e){}var r="all";if((0,i.isNullOrUndefined)(this.getMetadata().visibility_condition)||(r=this.getMetadata().visibility_condition),!(0,i.isNullOrUndefined)(t)){var o=this.getProcessManager().getProductNode();return new Promise((function(e,a){o.getComponent("attributeManager").resolveAttributeManager().subscribe((function(o){var a=o.getAttributeController(t),u=a.getAttribute();(0,i.isNullOrUndefined)(u)||u.attribute_values[0].attribute_value_valuable.colors.forEach((function(e){var t=!0;switch(r){case"visible":t=!0!==n[e.color];break;case"hidden":t=!0===n[e.color]}t&&(a.setVisibility(!n[e.color],{color:e.color}),a.broadcastAttributeUpdated())})),e([])}),(function(e){a(e)}))}))}return[]}}])&&Rr(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(o.s);function jr(e){return jr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jr(e)}function Cr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Mr(e,t){return Mr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Mr(e,t)}function Dr(e,t){if(t&&("object"===jr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ar(e){return Ar=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ar(e)}var Ir=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Mr(e,t)}(u,e);var t,n,r,o,a=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ar(r);if(o){var n=Ar(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Dr(this,e)});function u(){var e;return Cr(this,u),(e=a.apply(this,arguments)).mSubscriptions=new Array,e.mMaterialGroupManager=null,e}return t=u,(n=[{key:"onInit",value:function(){var e=this;this.onMatManagerSubject=new V.xQ;var t=this.getProcessManager().getProductNode().getComponent("materialGroupManager");this.mSubscriptions.push(t.resolveMaterialGroups().subscribe((function(t){null!==e.mSubscriptions&&null===e.mMaterialGroupManager&&(e.mMaterialGroupManager=t,e.onMatManagerSubject.next(t))}),(function(t){null===e.mMaterialGroupManager&&null!==e.onMatManagerSubject&&e.onMatManagerSubject.error("Failed to get material manager")})))}},{key:"onDestroy",value:function(){(0,i.isNullOrUndefined)(this.onMatManagerSubject)||this.onMatManagerSubject.error("destroyed"),this.onMatManagerSubject=null,this.mSubscriptions.splice(0,this.mSubscriptions.length).forEach((function(e){return e.unsubscribe()})),this.mSubscriptions=null}},{key:"onHandleInPort",value:function(e){var t=this;return null!==this.mMaterialGroupManager?(this.runVisibilityCheck(),[]):new Promise((function(e,n){t.onMatManagerSubject.pipe((0,N.P)()).subscribe((function(){t.runVisibilityCheck(),e([])}),(function(e){n(e)}))}))}},{key:"runVisibilityCheck",value:function(){var e=this,t=this.getMetadata().value_selected_material,n={};try{n=JSON.parse(this.getMetadata().value_selected_matrefs)}catch(e){}var r="all";if((0,i.isNullOrUndefined)(this.getMetadata().visibility_condition)||(r=this.getMetadata().visibility_condition),!(0,i.isNullOrUndefined)(t)){var o=this.mMaterialGroupManager.getGroupReferencesByGroupId(t);(0,i.isNullOrUndefined)(o)||o.forEach((function(o){var i=!0;switch(r){case"visible":i=!0!==n[o.id];break;case"hidden":i=!0===n[o.id]}i&&e.mMaterialGroupManager.setMaterialVisibilityByGroupId(t,o.id,!0!==n[o.id])}))}}}])&&kr(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(o.s);function Nr(e){return Nr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nr(e)}function Vr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ur(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fr(e,t){return Fr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Fr(e,t)}function Br(e,t){if(t&&("object"===Nr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Lr(e){return Lr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Lr(e)}n(21249),n(57640),n(9924),n(26699),n(31672),n(59461);var Hr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Fr(e,t)}(u,e);var t,n,r,o,a=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Lr(r);if(o){var n=Lr(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Br(this,e)});function u(){return Vr(this,u),a.apply(this,arguments)}return t=u,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"getVisibilityAttributes",value:function(e){if("question"===e.type)return e.attribute_values.map((function(e){return e.id}));if(["svg_image_selector","svg_element","svg_element_selector"].includes(e.type))try{return e.attribute_values[0].attribute_value_valuable.attributes.map((function(e){return e.key}))}catch(e){d.qL.print("failed to get svg attribute keys: ",e)}return[]}},{key:"onHandleInPort",value:function(e){var t=this,n=this.getMetadata().value_selected_question,r={};try{r=JSON.parse(this.getMetadata().value_selected_options)}catch(e){d.qL.error("Failed to parse selected options: ",e)}var o="all";if((0,i.isNullOrUndefined)(this.getMetadata().visibility_condition)||(o=this.getMetadata().visibility_condition),!(0,i.isNullOrUndefined)(n)){var a=this.getProcessManager().getProductNode();return new Promise((function(e,u){a.getComponent("attributeManager").resolveAttributeManager().subscribe((function(u){var c=u.getRawAttributes().find((function(e){return e.id==n}));(0,i.isNullOrUndefined)(c)||t.getVisibilityAttributes(c).forEach((function(e){var t=!0;switch(o){case"visible":t=!0!==r[e];break;case"hidden":t=!0===r[e]}t&&a.getRenderState().dispatchAppMessage(new G.Z(a.getSceneObjectId(),a.getObjectUUID(),n,!0!==r[e],e))})),e([])}),(function(e){u(e)}))}))}return[]}}])&&Ur(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(o.s);function zr(e){return zr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zr(e)}function qr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wr(e,t){return Wr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Wr(e,t)}function Qr(e,t){if(t&&("object"===zr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Kr(e){return Kr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Kr(e)}var Yr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Wr(e,t)}(u,e);var t,n,r,o,a=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Kr(r);if(o){var n=Kr(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Qr(this,e)});function u(){return qr(this,u),a.apply(this,arguments)}return t=u,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t={};try{t=JSON.parse(this.getMetadata().value_selected_question)}catch(e){}var n="all";if((0,i.isNullOrUndefined)(this.getMetadata().visibility_condition)||(n=this.getMetadata().visibility_condition),Object.keys(t).length>0){var r=this.getProcessManager().getProductNode();return new Promise((function(e,o){r.getComponent("attributeManager").resolveAttributeManager().subscribe((function(o){o.getRawAttributes().forEach((function(e){var o=!0;switch(n){case"visible":o=!0!==t[e.id];break;case"hidden":o=!0===t[e.id]}o&&r.getRenderState().dispatchAppMessage(new G.Z(r.getSceneObjectId(),r.getObjectUUID(),e.id,!0!==t[e.id]))})),e([])}),(function(e){o(e)}))}))}return[]}}])&&Gr(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(o.s)},26432:function(e,t,n){"use strict";n.d(t,{wW:function(){return d},nS:function(){return j},sM:function(){return O},Eg:function(){return N},Hi:function(){return z},Rt:function(){return Z},hw:function(){return re},S9:function(){return le},dl:function(){return be},Vc:function(){return Se},HB:function(){return Me},uX:function(){return Be},Rs:function(){return Qe}}),n(91058),n(41539),n(15581),n(2490),n(34514),n(54747),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(74120),o=n(26566),i=n(89539),a=n(41142);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},l(e,t)}function f(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(h,e);var t,n,r,u,d=(r=h,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=p(r);if(u){var n=p(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return f(this,e)});function h(){return c(this,h),d.apply(this,arguments)}return t=h,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t=this,n=[];if(!(0,i.isNullOrUndefined)(this.getMetadata().value_input_list))try{n=JSON.parse(this.getMetadata().value_input_list)}catch(e){}var r=0;(0,i.isNullOrUndefined)(this.getMetadata().operand_value)||(r=parseInt(this.getMetadata().operand_value,10));var u="min";(0,i.isNullOrUndefined)(this.getMetadata().selected_range)||(u=this.getMetadata().selected_range);var c=[];return this.getProcessManager().getProductNode().getComponent("attributeManager").resolveAttributeManager().subscribe((function(e){a.qL.print("fetch input min max"),n.forEach((function(n){var s=e.getAttribute(n);if(!(0,i.isNullOrUndefined)(s)&&(0,i.isArray)(s.attribute_values)&&s.attribute_values.length>0)if("operable_numbers_input"===s.type){var l=s.attribute_values[0].attribute_value_valuable;if(!(0,i.isNullOrUndefined)(l)&&(0,i.isArray)(l.operands)&&r<l.operands.length){var f=l.operands[r];a.qL.print("operand minmax:",f),c.push(new o.q("input",{attribute_id:n,value:"min"===u?f.min_value:f.max_value},t,"value"))}}else if("text_input"===s.type){var p=s.attribute_values[0].attribute_value_valuable;(0,i.isNullOrUndefined)(p)||(a.qL.print("input minmax:",p),c.push(new o.q("input",{attribute_id:n,value:"min"===u?p.min:p.max},t,"value")))}}))}),(function(e){})),c}}])&&s(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),h}(r.s);function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function y(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function m(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){y(i,r,o,a,u,"next",e)}function u(e){y(i,r,o,a,u,"throw",e)}a(void 0)}))}}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e,t){return g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},g(e,t)}function w(e,t){if(t&&("object"===h(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function _(e){return _=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},_(e)}n(35666),n(33161),n(9653),n(44048),n(57327),n(88449),n(59849),n(88674),n(85827),n(25387),n(72608);var O=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}(f,e);var t,n,r,i,u,c,s,l=(c=f,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=_(c);if(s){var n=_(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return w(this,e)});function f(){return v(this,f),l.apply(this,arguments)}return t=f,n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:(u=m(regeneratorRuntime.mark((function e(t){var n,r,i,u,c,s,l,f,p,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=this.getMetadata().selected_text_input,Number.isInteger(n)?(r=[n],i="maximum"):(r=n.selection||[],i=n.calculation||"maximum"),e.next=5,this.getAttributeManager();case 5:for(u=e.sent,c=[],s=0;s<r.length;s++)l=Number(r[s].id),f=Number(r[s].factor),c[s]=this.resolveAttributeWidth(u,l,Number.isNaN(f)?1:f);return e.next=10,Promise.all(c);case 10:p=e.sent.filter((function(e){return void 0!==e})),e.t0=i,e.next="minimum"===e.t0?14:"average"===e.t0?16:19;break;case 14:return d=p.reduce((function(e,t){return Math.min(e,t)})),e.abrupt("break",21);case 16:return d=p.reduce((function(e,t){return e+t})),d/=p.length,e.abrupt("break",21);case 19:return d=p.reduce((function(e,t){return Math.max(e,t)})),e.abrupt("break",21);case 21:return e.abrupt("return",[new o.q("number",{value:d},this,"value")]);case 24:return e.prev=24,e.t1=e.catch(0),a.qL.error("Unable to process rule.",e.t1),e.abrupt("return",[]);case 28:case"end":return e.stop()}}),e,this,[[0,24]])}))),function(e){return u.apply(this,arguments)})},{key:"resolveAttributeWidth",value:(i=m(regeneratorRuntime.mark((function e(t,n){var r,o,i,a,u,c=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=c.length>2&&void 0!==c[2]?c[2]:1,!isNaN(n)){e.next=3;break}return e.abrupt("return",void 0);case 3:return o=t.getAttributeController(n),e.next=6,o.getResourceController();case 6:return i=e.sent,a=o.resolveValuable(),u=o.getValue(),e.abrupt("return",i.getTextWidth(a,u)*r);case 10:case"end":return e.stop()}}),e)}))),function(e,t){return i.apply(this,arguments)})},{key:"getAttributeManager",value:(r=m(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.getProcessManager().getProductNode(),e.abrupt("return",t.getComponent("attributeManager").resolveAttributeManager().toPromise());case 2:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})}],n&&b(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(r.s);function T(e){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T(e)}function R(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function E(e,t){return E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},E(e,t)}function P(e,t){if(t&&("object"===T(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function x(e){return x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},x(e)}var j=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E(e,t)}(s,e);var t,n,r,u,c=(r=s,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=x(r);if(u){var n=x(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return P(this,e)});function s(){return R(this,s),c.apply(this,arguments)}return t=s,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t=this,n=[];if(!(0,i.isNullOrUndefined)(this.getMetadata().value_input_list))try{n=JSON.parse(this.getMetadata().value_input_list)}catch(e){}var r=0;(0,i.isNullOrUndefined)(this.getMetadata().operand_value)||(r=parseInt(this.getMetadata().operand_value,10));var u=[];return this.getProcessManager().getProductNode().getComponent("attributeManager").resolveAttributeManager().subscribe((function(e){a.qL.print("fetch operand values"),n.forEach((function(n){var c=e.getAttribute(n);if(!(0,i.isNullOrUndefined)(c)&&"operable_numbers_input"===c.type&&(0,i.isArray)(c.attribute_values)&&c.attribute_values.length>0){var s=c.attribute_values[0].attribute_value_valuable;if(!(0,i.isNullOrUndefined)(s)&&(0,i.isArray)(s.operands)&&r<s.operands.length){var l=s.operands[r];a.qL.print("operand value:",l),u.push(new o.q("input",{attribute_id:n,value:l.value},t,"value"))}}}))}),(function(e){})),u}}])&&S(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),s}(r.s);function C(e){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}function k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function D(e,t){return D=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},D(e,t)}function A(e,t){if(t&&("object"===C(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function I(e){return I=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},I(e)}var N=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&D(e,t)}(c,e);var t,n,r,a,u=(r=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=I(r);if(a){var n=I(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return A(this,e)});function c(){return k(this,c),u.apply(this,arguments)}return t=c,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t=this,n=this.getMetadata().value_question;if((0,i.isNullOrUndefined)(n))return[];var r=this.getProcessManager().getProductNode().getComponent("attributeManager");return new Promise((function(e,a){r.resolveAttributeManager().subscribe((function(r){var a=r.getValue(n);(0,i.isNullOrUndefined)(a)&&e([]),e([new o.q("input",{attribute_id:n,value:a.value},t,"value")])}),(function(e){return a(e)}))}))}}])&&M(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(r.s);function V(e){return V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},V(e)}function U(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function F(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function B(e,t){return B=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},B(e,t)}function L(e,t){if(t&&("object"===V(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function H(e){return H=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},H(e)}var z=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&B(e,t)}(c,e);var t,n,r,a,u=(r=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=H(r);if(a){var n=H(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return L(this,e)});function c(){return U(this,c),u.apply(this,arguments)}return t=c,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t=this,n=[];if(!(0,i.isNullOrUndefined)(this.getMetadata().value_input_list))try{n=JSON.parse(this.getMetadata().value_input_list)}catch(e){}var r=[];return this.getProcessManager().getProductNode().getComponent("attributeManager").resolveAttributeManager().subscribe((function(e){n.forEach((function(n){var a=e.getValueName(n);(0,i.isNullOrUndefined)(a)||r.push(new o.q("input",{attribute_id:n,value:a},t,"value"))}))}),(function(e){})),r}}])&&F(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(r.s);function q(e){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},q(e)}function G(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function W(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Q(e,t){return Q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Q(e,t)}function K(e,t){if(t&&("object"===q(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Y(e){return Y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Y(e)}var Z=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Q(e,t)}(c,e);var t,n,r,i,u=(r=c,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Y(r);if(i){var n=Y(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return K(this,e)});function c(){return G(this,c),u.apply(this,arguments)}return t=c,(n=[{key:"onInit",value:function(){var e=this,t=this.getProcessManager().getProductNode();this.mProductId=t.getValue("product_id");var n=t.getComponent("attributeManager");this.mSubscription=n.onAttributeChanged.subscribe((function(t){var n=t.attribute_type;"text_input"!==n&&"text_to_image"!==n&&"operable_numbers_input"!==n||e.feedInPort(new o.q("input",t,e,"input_id"))}))}},{key:"onDestroy",value:function(){this.mSubscription.unsubscribe()}},{key:"onHandleInPort",value:function(e){return a.qL.print("input changed process:",e),[e]}}])&&W(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(r.s);function X(e){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},X(e)}function J(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ee(e,t){return ee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ee(e,t)}function te(e,t){if(t&&("object"===X(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ne(e){return ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ne(e)}n(40561);var re=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ee(e,t)}(u,e);var t,n,r,i,a=(r=u,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ne(r);if(i){var n=ne(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return te(this,e)});function u(){var e;return J(this,u),(e=a.apply(this,arguments)).mSubscriptions=new Array,e}return t=u,(n=[{key:"onInit",value:function(){var e=this,t=this.getProcessManager().getProductNode().getComponent("materialGroupManager");this.mSubscriptions.push(t.resolveMaterialGroups().subscribe((function(t){e.mSubscriptions.push(t.onMaterialChanged.subscribe((function(t){e.feedInPort(new o.q("matgroup",t,e,"material"))})))}),(function(e){})))}},{key:"onDestroy",value:function(){this.mSubscriptions.splice(0,this.mSubscriptions.length).forEach((function(e){return e.unsubscribe()})),this.mSubscriptions=null}},{key:"onHandleInPort",value:function(e){return[e]}}])&&$(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(r.s);function oe(e){return oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oe(e)}function ie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ue(e,t){return ue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ue(e,t)}function ce(e,t){if(t&&("object"===oe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function se(e){return se=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},se(e)}var le=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ue(e,t)}(u,e);var t,n,r,i,a=(r=u,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=se(r);if(i){var n=se(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return ce(this,e)});function u(){var e;return ie(this,u),(e=a.apply(this,arguments)).mSubscriptions=new Array,e}return t=u,(n=[{key:"onInit",value:function(){var e=this,t=this.getProcessManager().getProductNode().getComponent("attributeManager");this.mSubscriptions.push(t.resolveAttributeManager().subscribe((function(t){e.mSubscriptions.push(t.onAttributeChanged.subscribe((function(t){e.feedInPort(new o.q("options",t,e,"options"))})))})))}},{key:"onDestroy",value:function(){this.mSubscriptions.splice(0).forEach((function(e){return e.unsubscribe()}))}},{key:"onHandleInPort",value:function(e){return[e]}}])&&ae(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(r.s),fe=n(14311);function pe(e){return pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pe(e)}function de(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function he(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ye(e,t){return ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ye(e,t)}function me(e,t){if(t&&("object"===pe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ve(e){return ve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ve(e)}var be=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ye(e,t)}(c,e);var t,n,r,i,u=(r=c,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ve(r);if(i){var n=ve(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return me(this,e)});function c(){return de(this,c),u.apply(this,arguments)}return t=c,(n=[{key:"onInit",value:function(){var e=this,t=this.getProcessManager().getProductNode();this.mProductId=t.getValue("product_id"),this.mProductSceneId=t.getSceneObjectId(),this.mSubscription=t.getRenderState().getSceneManager().getApplication().observeEvents(fe.G.ProductQuestionChanged).subscribe((function(t){var n=t.getData();n.visible&&n.product_scene_id==e.mProductSceneId&&e.feedInPort(new o.q("question_id",n.question,e,"question_id"))}))}},{key:"onDestroy",value:function(){this.mSubscription.unsubscribe()}},{key:"onHandleInPort",value:function(e){return a.qL.print("question changed process:",e),[e]}}])&&he(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(r.s);function ge(e){return ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ge(e)}function we(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Oe(e,t){return Oe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Oe(e,t)}function Te(e,t){if(t&&("object"===ge(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Re(e){return Re=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Re(e)}var Se=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Oe(e,t)}(c,e);var t,n,r,i,u=(r=c,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Re(r);if(i){var n=Re(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Te(this,e)});function c(){return we(this,c),u.apply(this,arguments)}return t=c,(n=[{key:"onInit",value:function(){var e=this;this.mSubscription=this.getProcessManager().getProductNode().getRenderState().getSceneManager().getApplication().observeEvents(fe.G.BuildUpdated).subscribe((function(){a.qL.print("event change epv.broadBuildUpdated"),e.feedInPort(new o.q("boolean",!0,e,"change"))}))}},{key:"onDestroy",value:function(){this.mSubscription.unsubscribe()}},{key:"onHandleInPort",value:function(e){return[e]}}])&&_e(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(r.s);function Ee(e){return Ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ee(e)}function Pe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function je(e,t){return je=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},je(e,t)}function Ce(e,t){if(t&&("object"===Ee(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ke(e){return ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ke(e)}var Me=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&je(e,t)}(u,e);var t,n,r,i,a=(r=u,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ke(r);if(i){var n=ke(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Ce(this,e)});function u(){return Pe(this,u),a.apply(this,arguments)}return t=u,(n=[{key:"onInit",value:function(){var e=this;this.mSubscription=this.getProcessManager().onLoadFinished.subscribe((function(t){t&&e.feedInPort(new o.q("boolean",t,e,"ready"))}))}},{key:"onDestroy",value:function(){this.mSubscription.unsubscribe()}},{key:"onHandleInPort",value:function(e){return[e]}}])&&xe(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(r.s),De=(n(54678),n(68009));function Ae(e){return Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ae(e)}function Ie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ne(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ve(e,t){return Ve=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ve(e,t)}function Ue(e,t){if(t&&("object"===Ae(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Fe(e){return Fe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Fe(e)}var Be=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ve(e,t)}(s,e);var t,n,r,u,c=(r=s,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Fe(r);if(u){var n=Fe(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Ue(this,e)});function s(){return Ie(this,s),c.apply(this,arguments)}return t=s,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t=this,n=[];if(!(0,i.isNullOrUndefined)(this.getMetadata().value_input_list))try{n=JSON.parse(this.getMetadata().value_input_list)}catch(e){}var r=0;(0,i.isNullOrUndefined)(this.getMetadata().operand_value)||(r=parseInt(this.getMetadata().operand_value,10));var u=[];return this.getProcessManager().getProductNode().getComponent("attributeManager").resolveAttributeManager().subscribe((function(e){a.qL.print("sum operand values"),n.forEach((function(n){var c=e.getAttribute(n);if(!(0,i.isNullOrUndefined)(c)&&"operable_numbers_input"===c.type&&(0,i.isArray)(c.attribute_values)&&c.attribute_values.length>0){var s=c.attribute_values[0].attribute_value_valuable;if(!(0,i.isNullOrUndefined)(s)&&(0,i.isArray)(s.operands)&&r<s.operands.length){for(var l=0,f=0;f<=r;f++){var p=s.operands[f].value;De.F.isNumeric(p)&&(l+=parseFloat(p))}a.qL.print("operand sum:",l),u.push(new o.q("input",{attribute_id:n,value:l},t,"value"))}}}))}),(function(e){})),u}}])&&Ne(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),s}(r.s);function Le(e){return Le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Le(e)}function He(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ze(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qe(e,t){return qe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},qe(e,t)}function Ge(e,t){if(t&&("object"===Le(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function We(e){return We=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},We(e)}var Qe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qe(e,t)}(u,e);var t,n,r,i,a=(r=u,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=We(r);if(i){var n=We(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Ge(this,e)});function u(){return He(this,u),a.apply(this,arguments)}return t=u,(n=[{key:"onInit",value:function(){var e=this;this.mSubscription=this.getProcessManager().getProductNode().getRenderState().getSceneManager().getApplication().getUiRenderer().onUiSelected.subscribe((function(t){e.feedInPort(new o.q("ui",t,e,"click"))}))}},{key:"onDestroy",value:function(){this.mSubscription.unsubscribe()}},{key:"onHandleInPort",value:function(e){return[e]}}])&&ze(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(r.s)},98442:function(e,t,n){"use strict";n.d(t,{ON:function(){return p},el:function(){return O},nX:function(){return j},ov:function(){return F},Iy:function(){return $},zU:function(){return ae},nf:function(){return W},fF:function(){return de},I0:function(){return we},pt:function(){return Pe},w2:function(){return Ae},Zx:function(){return Le},Yv:function(){return Ke},Yn:function(){return tt},NO:function(){return ct},U1:function(){return yt}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(74120),o=n(26566),i=n(89539);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},s(e,t)}function l(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(d,e);var t,n,r,a,p=(r=d,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=f(r);if(a){var n=f(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return l(this,e)});function d(){return u(this,d),p.apply(this,arguments)}return t=d,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t=this.getMetadata().value_camera;return(0,i.isNullOrUndefined)(t)||t!=this.getProcessManager().getProductNode().getRenderState().getSceneManager().getApplication().getSceneManager().getActiveCameraId()?[new o.q("number",t,this,"no")]:[new o.q("number",t,this,"yes")]}}])&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),d}(r.s),d=(n(15581),n(2490),n(34514),n(54747),n(40561),n(88674),n(74916),n(23123),n(91058),n(29514)),h=n(70211),y=n(68009);function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e,t){return g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},g(e,t)}function w(e,t){if(t&&("object"===m(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function _(e){return _=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},_(e)}var O=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}(c,e);var t,n,r,a,u=(r=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=_(r);if(a){var n=_(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return w(this,e)});function c(){var e;return v(this,c),(e=u.apply(this,arguments)).mSubscriptions=new Array,e.onMatManagerSubject=null,e.mMaterialGroupManager=null,e}return t=c,(n=[{key:"onInit",value:function(){var e=this;this.onMatManagerSubject=new h.xQ;var t=this.getProcessManager().getProductNode().getComponent("materialGroupManager");this.mSubscriptions.push(t.resolveMaterialGroups().subscribe((function(t){null!==e.mSubscriptions&&null===e.mMaterialGroupManager&&(e.mMaterialGroupManager=t,e.onMatManagerSubject.next(t))}),(function(t){null===e.mMaterialGroupManager&&null!==e.onMatManagerSubject&&e.onMatManagerSubject.error("Failed to get material manager")})))}},{key:"onDestroy",value:function(){null!==this.onMatManagerSubject&&this.onMatManagerSubject.error("destroyed"),this.onMatManagerSubject=null,this.mSubscriptions.splice(0,this.mSubscriptions.length).forEach((function(e){return e.unsubscribe()})),this.mSubscriptions=null}},{key:"onHandleInPort",value:function(e){var t=this,n=[];if((0,i.isNullOrUndefined)(this.getMetadata().value_matgroup_list))(0,i.isNullOrUndefined)(this.getMetadata().value_matgroup)||n.push(this.getMetadata().value_matgroup);else try{n=JSON.parse(this.getMetadata().value_matgroup_list)}catch(e){}var r="any";return(0,i.isNullOrUndefined)(this.getMetadata().option_condition)||(r=this.getMetadata().option_condition),null!==this.mMaterialGroupManager?this.decideActiveMaterial(n,r,e.data):new Promise((function(o,i){t.onMatManagerSubject.pipe((0,d.P)()).subscribe((function(){o(t.decideActiveMaterial(n,r,e.data))}),(function(e){i(e)}))}))}},{key:"decideActiveMaterial",value:function(e,t,n){var r=this,i=0,a=0;e.forEach((function(e){i+=1;var t=e.split(":");2==t.length&&y.F.isNumeric(t[0])&&y.F.isNumeric(t[1])&&r.mMaterialGroupManager.getActiveRefId(parseInt(t[0],10))==parseInt(t[1],10)&&(a+=1)}));var u="no";switch(t){case"any":a>0&&(u="yes");break;case"all":a===i&&(u="yes");break;case"none":0===a&&(u="yes")}return[new o.q("matgroup",n,this,u)]}}])&&b(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(r.s);function T(e){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T(e)}function R(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function E(e,t){return E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},E(e,t)}function P(e,t){if(t&&("object"===T(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function x(e){return x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},x(e)}n(60086);var j=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E(e,t)}(c,e);var t,n,r,a,u=(r=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=x(r);if(a){var n=x(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return P(this,e)});function c(){var e;return R(this,c),(e=u.apply(this,arguments)).mSubscriptions=new Array,e.onOffsetManagerSubject=null,e.mSceneOffsetManager=null,e}return t=c,(n=[{key:"onInit",value:function(){var e=this,t=this.getProcessManager().getProductNode();this.onOffsetManagerSubject=new h.xQ,this.mSubscriptions.push(t.onConfigurableNodeReady.subscribe((function(t){t.resolveSceneOffsetManager().then((function(t){null!==e.mSubscriptions&&null===e.mSceneOffsetManager&&(e.mSceneOffsetManager=t,e.onOffsetManagerSubject.next(t))}),(function(t){null===e.mSceneOffsetManager&&null!==e.onOffsetManagerSubject&&e.onOffsetManagerSubject.error("failed to get offset manager")}))})))}},{key:"onDestroy",value:function(){null!==this.onOffsetManagerSubject&&this.onOffsetManagerSubject.error("destroyed"),this.onOffsetManagerSubject=null,this.mSubscriptions.splice(0,this.mSubscriptions.length).forEach((function(e){return e.unsubscribe()})),this.mSubscriptions=null}},{key:"onHandleInPort",value:function(e){var t=this,n=this.getMetadata().value_offset,r=this.getMetadata().value_level;r=(0,i.isNullOrUndefined)(r)?0:r;var a=this.getMetadata().value_vec_x;a=(0,i.isNullOrUndefined)(a)?0:a;var u=this.getMetadata().value_vec_y;u=(0,i.isNullOrUndefined)(u)?0:u;var c=this.getMetadata().value_vec_z;if(c=(0,i.isNullOrUndefined)(c)?0:c,!(0,i.isNullOrUndefined)(n)&&n.length>0){var s=new THREE.Vector3(a,u,c);return null!==this.mSceneOffsetManager?this.decideVectorSame(n,r,s,e.data):new Promise((function(o,i){t.onOffsetManagerSubject.pipe((0,d.P)()).subscribe((function(){o(t.decideVectorSame(n,r,s,e.data))}),(function(e){i(e)}))}))}return[new o.q(e.type,e.data,this,"no")]}},{key:"decideVectorSame",value:function(e,t,n,r){var a=this.mSceneOffsetManager.getOffsetVector(e,t),u=!1;return(0,i.isNullOrUndefined)(a)||(u=n.sub(a).lengthSq()<1),[new o.q("offsets",r,this,u?"yes":"no")]}}])&&S(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(r.s),C=(n(4723),n(69826),n(57327),n(88449),n(59849),n(63202)),k=n(84217),M=n(41142);function D(e){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D(e)}function A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function I(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function N(e,t){return N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},N(e,t)}function V(e,t){if(t&&("object"===D(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function U(e){return U=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},U(e)}var F=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&N(e,t)}(c,e);var t,n,r,a,u=(r=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=U(r);if(a){var n=U(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return V(this,e)});function c(){return A(this,c),u.apply(this,arguments)}return t=c,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t=this;M.qL.print("check active options");var n=[];if((0,i.isNullOrUndefined)(this.getMetadata().value_option_list))(0,i.isNullOrUndefined)(this.getMetadata().value_option)||n.push(this.getMetadata().value_option);else try{n=JSON.parse(this.getMetadata().value_option_list)}catch(e){}var r=[];n.forEach((function(e){var t=e.split(":");if(2===t.length||3===t.length)try{var n=null;if(3===t.length){var o=t[2].match(/^(\d+)\((.*)\)$/);3===o.length&&(n=o[2])}var a=r.find((function(e){return e.product_uuid===n}));(0,i.isNullOrUndefined)(a)&&(a={product_uuid:n,option_list:[]},r.push(a)),a.option_list.push({question_id:parseInt(t[0],10),option_id:parseInt(t[1],10)})}catch(e){}}));var a="any";(0,i.isNullOrUndefined)(this.getMetadata().option_condition)||(a=this.getMetadata().option_condition);var u=[];return r.forEach((function(e){u.push(t.checkAttributeCondition(e.product_uuid,e.option_list,a))})),new Promise((function(n,r){if(0===u.length)return r("not products");(0,C.aj)(u).pipe((0,k.q)(1)).subscribe((function(r){var i=r.length,u=r.filter((function(e){return!0===e})).length,c="no";switch(a){case"any":u>0&&(c="yes");break;case"all":case"none":u===i&&(c="yes")}n([new o.q(e.type,e.data,t,c)])}),(function(e){r(e)}))}))}},{key:"checkAttributeCondition",value:function(e,t,n){var r=this;return new Promise((function(o,a){var u=null;if((0,i.isNullOrUndefined)(e))u=r.getProcessManager().getProductNode();else{var c=r.getProcessManager().getProductNode().getRenderState().getSceneManager().findNodesOfTypeName("ProductNode",(function(t){return t.getValue("object_uuid")===e}));c.length>0&&(u=c[0])}if(null===u)return a("product with uuid '"+e+"' not found");u.getComponent("attributeManager").resolveAttributeManager().subscribe((function(e){var r=0,a=0;t.forEach((function(t){r+=1;var n=e.getValue(t.question_id);(0,i.isNullOrUndefined)(n)||n.attribute_value_id!=t.option_id||(a+=1)}));var u=!1;switch(n){case"any":a>0&&(u=!0);break;case"all":a===r&&(u=!0);break;case"none":0===a&&(u=!0)}o(u)}),(function(e){a(e)}))}))}}])&&I(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(r.s);function B(e){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},B(e)}function L(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function H(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function z(e,t){return z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},z(e,t)}function q(e,t){if(t&&("object"===B(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function G(e){return G=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},G(e)}var W=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&z(e,t)}(c,e);var t,n,r,a,u=(r=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=G(r);if(a){var n=G(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return q(this,e)});function c(){return L(this,c),u.apply(this,arguments)}return t=c,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t=this.getMetadata().value_question;return(0,i.isNullOrUndefined)(t)||t!=e.data.attribute_id?[new o.q("attribute_id",e.data,this,"no")]:[new o.q("attribute_id",e.data,this,"yes")]}}])&&H(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(r.s);function Q(e){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Q(e)}function K(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Z(e,t){return Z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Z(e,t)}function X(e,t){if(t&&("object"===Q(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function J(e){return J=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},J(e)}var $=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Z(e,t)}(c,e);var t,n,r,a,u=(r=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=J(r);if(a){var n=J(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return X(this,e)});function c(){return K(this,c),u.apply(this,arguments)}return t=c,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t=this.getProcessManager().getProductNode().getRenderState().getSceneManager().getApplication(),n="no";return(0,i.isNullOrUndefined)(t)||!0===t.getState("reconfigure")&&(n="yes"),[new o.q(e.type,e.data,this,n)]}}])&&Y(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(r.s);function ee(e){return ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ee(e)}function te(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ne(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function re(e,t){return re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},re(e,t)}function oe(e,t){if(t&&("object"===ee(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ie(e){return ie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ie(e)}var ae=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&re(e,t)}(c,e);var t,n,r,a,u=(r=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ie(r);if(a){var n=ie(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return oe(this,e)});function c(){return te(this,c),u.apply(this,arguments)}return t=c,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t=this.getMetadata().value_view,n=this.getProcessManager().getProductNode().getRenderState().getSceneManager().getApplication().getSceneManager().getActiveView();return(0,i.isNullOrUndefined)(t)||(0,i.isNullOrUndefined)(n)||t!=n.getSceneObjectId()?[new o.q("number",t,this,"no")]:[new o.q("number",t,this,"yes")]}}])&&ne(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(r.s);function ue(e){return ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ue(e)}function ce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function se(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function le(e,t){return le=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},le(e,t)}function fe(e,t){if(t&&("object"===ue(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function pe(e){return pe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},pe(e)}var de=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&le(e,t)}(c,e);var t,n,r,a,u=(r=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=pe(r);if(a){var n=pe(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return fe(this,e)});function c(){return ce(this,c),u.apply(this,arguments)}return t=c,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t=this.getMetadata().value_string;return(0,i.isNullOrUndefined)(e.data)||e.data.attribute_value_name!=t?[new o.q(e.type,e.data,this,"no")]:[new o.q(e.type,e.data,this,"yes")]}}])&&se(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(r.s);function he(e){return he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},he(e)}function ye(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function me(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ve(e,t){return ve=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ve(e,t)}function be(e,t){if(t&&("object"===he(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ge(e){return ge=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ge(e)}var we=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ve(e,t)}(c,e);var t,n,r,a,u=(r=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ge(r);if(a){var n=ge(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return be(this,e)});function c(){return ye(this,c),u.apply(this,arguments)}return t=c,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t=[];if(!(0,i.isNullOrUndefined)(this.getMetadata().value_input_list))try{t=JSON.parse(this.getMetadata().value_input_list)}catch(e){}var n="any";(0,i.isNullOrUndefined)(this.getMetadata().option_condition)||(n=this.getMetadata().option_condition);var r=0,a=0;"input"===e.type&&t.forEach((function(t){r+=1,e.data.attribute_id==t&&(a+=1)}));var u="no";switch(n){case"any":a>0&&(u="yes");break;case"all":a===r&&(u="yes");break;case"none":0===a&&(u="yes")}return[new o.q(e.type,e.data,this,u)]}}])&&me(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(r.s);function _e(e){return _e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_e(e)}function Oe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Te(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Re(e,t){return Re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Re(e,t)}function Se(e,t){if(t&&("object"===_e(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ee(e){return Ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ee(e)}var Pe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Re(e,t)}(c,e);var t,n,r,a,u=(r=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ee(r);if(a){var n=Ee(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Se(this,e)});function c(){return Oe(this,c),u.apply(this,arguments)}return t=c,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t=[];if((0,i.isNullOrUndefined)(this.getMetadata().value_matgroup_list))(0,i.isNullOrUndefined)(this.getMetadata().value_matgroup)||t.push(this.getMetadata().value_matgroup);else try{t=JSON.parse(this.getMetadata().value_matgroup_list)}catch(e){}var n="any";(0,i.isNullOrUndefined)(this.getMetadata().option_condition)||(n=this.getMetadata().option_condition);var r=0,a=0;"matgroup"===e.type&&t.forEach((function(t){r+=1;var n=t.split(":");2===n.length&&e.data.id==n[0]&&e.data.ref_id==n[1]&&(a+=1)}));var u="no";switch(n){case"any":a>0&&(u="yes");break;case"all":a===r&&(u="yes");break;case"none":0===a&&(u="yes")}return[new o.q(e.type,e.data,this,u)]}}])&&Te(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(r.s);function xe(e){return xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xe(e)}function je(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ke(e,t){return ke=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ke(e,t)}function Me(e,t){if(t&&("object"===xe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function De(e){return De=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},De(e)}n(54678);var Ae=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ke(e,t)}(u,e);var t,n,r,i,a=(r=u,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=De(r);if(i){var n=De(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Me(this,e)});function u(){return je(this,u),a.apply(this,arguments)}return t=u,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t=parseFloat(this.getMetadata().compare_value)||0,n=this.getMetadata().compare_function||"=",r=this.getValue(e),i=this.compare(t,n,r)?"yes":"no",a=e.type,u=e.data;return[new o.q(a,u,this,i)]}},{key:"getValue",value:function(e){var t=e.type,n=e.data;switch(t){case"input":return this.getValueFromInput(n);case"number":return n.value;default:return NaN}}},{key:"getValueFromInput",value:function(e){switch(e.attribute_type){case"operable_numbers_input":case"text_to_image":case"text_input":return parseFloat(e.attribute_value_name);default:return parseFloat(e.value)}}},{key:"compare",value:function(e,t,n){switch(t){case"=":case"==":return e==n;case">":return e>n;case"<":return e<n;case">=":return e>=n;case"<=":return e<=n;case"!=":return e!=n;default:return!1}}}])&&Ce(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(r.s);function Ie(e){return Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ie(e)}function Ne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ue(e,t){return Ue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ue(e,t)}function Fe(e,t){if(t&&("object"===Ie(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Be(e){return Be=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Be(e)}var Le=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ue(e,t)}(c,e);var t,n,r,a,u=(r=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Be(r);if(a){var n=Be(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Fe(this,e)});function c(){return Ne(this,c),u.apply(this,arguments)}return t=c,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t=this;M.qL.print("check options");var n=[];if((0,i.isNullOrUndefined)(this.getMetadata().value_option_list))(0,i.isNullOrUndefined)(this.getMetadata().value_option)||n.push(this.getMetadata().value_option);else try{n=JSON.parse(this.getMetadata().value_option_list)}catch(e){}var r=[];n.forEach((function(e){var t=e.split(":");if(2===t.length||3===t.length)try{var n=null;if(3===t.length){var o=t[2].match(/^(\d+)\((.*)\)$/);3===o.length&&(n=o[2])}var a=r.find((function(e){return e.product_uuid===n}));(0,i.isNullOrUndefined)(a)&&(a={product_uuid:n,option_list:[]},r.push(a)),a.option_list.push({question_id:parseInt(t[0],10),option_id:parseInt(t[1],10)})}catch(e){}}));var a="any";(0,i.isNullOrUndefined)(this.getMetadata().option_condition)||(a=this.getMetadata().option_condition);var u=[];return r.forEach((function(n){u.push(t.checkAttributeSelected(n.product_uuid,n.option_list,a,e))})),new Promise((function(n,r){if(0==u.length)return r("no products");(0,C.aj)(u).pipe((0,k.q)(1)).subscribe((function(r){var i=r.length,u=r.filter((function(e){return!0===e})).length,c="no";switch(a){case"any":u>0&&(c="yes");break;case"all":case"none":u===i&&(c="yes")}n([new o.q(e.type,e.data,t,c)])}),(function(e){r(e)}))}))}},{key:"checkAttributeSelected",value:function(e,t,n,r){var o=this;return new Promise((function(a,u){var c=null;if((0,i.isNullOrUndefined)(e))c=o.getProcessManager().getProductNode();else{var s=o.getProcessManager().getProductNode().getRenderState().getSceneManager().findNodesOfTypeName("ProductNode",(function(t){return t.getValue("object_uuid")===e}));s.length>0&&(c=s[0])}if(null===c)return u("product with uuid '"+e+"' not found");var l=0,f=0;if("options"===r.type){var p=r.data;M.qL.print("comparing option condition against event: ",p),t.forEach((function(e){l+=1,e.question_id==p.attribute_id&&e.option_id==p.attribute_value_id&&(f+=1)}))}var d=!1;switch(n){case"any":f>0&&(d=!0);break;case"all":f===l&&(d=!0);break;case"none":0===f&&(d=!0)}a(d)}))}}])&&Ve(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(r.s);function He(e){return He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},He(e)}function ze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ge(e,t){return Ge=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ge(e,t)}function We(e,t){if(t&&("object"===He(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Qe(e){return Qe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Qe(e)}var Ke=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ge(e,t)}(c,e);var t,n,r,a,u=(r=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Qe(r);if(a){var n=Qe(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return We(this,e)});function c(){return ze(this,c),u.apply(this,arguments)}return t=c,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t=this.getMetadata().value_question;return(0,i.isNullOrUndefined)(t)||t!=e.data?[new o.q("question_id",e.data,this,"no")]:[new o.q("question_id",e.data,this,"yes")]}}])&&qe(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(r.s);function Ye(e){return Ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ye(e)}function Ze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Je(e,t){return Je=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Je(e,t)}function $e(e,t){if(t&&("object"===Ye(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function et(e){return et=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},et(e)}n(34553);var tt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Je(e,t)}(c,e);var t,n,r,a,u=(r=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=et(r);if(a){var n=et(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return $e(this,e)});function c(){return Ze(this,c),u.apply(this,arguments)}return t=c,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){try{var t=JSON.parse(this.getMetadata().value_string_list);if(!(0,i.isUndefined)(t)&&t.findIndex((function(t){return t===e.data}))>=0)return[new o.q("string",e.data,this,"yes")]}catch(e){}return[new o.q("string",e.data,this,"no")]}}])&&Xe(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(r.s);function nt(e){return nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nt(e)}function rt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ot(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function it(e,t){return it=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},it(e,t)}function at(e,t){if(t&&("object"===nt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ut(e){return ut=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ut(e)}var ct=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&it(e,t)}(c,e);var t,n,r,a,u=(r=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ut(r);if(a){var n=ut(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return at(this,e)});function c(){return rt(this,c),u.apply(this,arguments)}return t=c,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t=this.getMetadata().value_string;return(0,i.isUndefined)(t)||t!==e.data?[new o.q("string",e.data,this,"no")]:[new o.q("string",e.data,this,"yes")]}}])&&ot(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(r.s);function st(e){return st="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},st(e)}function lt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ft(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pt(e,t){return pt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},pt(e,t)}function dt(e,t){if(t&&("object"===st(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ht(e){return ht=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ht(e)}var yt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pt(e,t)}(c,e);var t,n,r,a,u=(r=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ht(r);if(a){var n=ht(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return dt(this,e)});function c(){return lt(this,c),u.apply(this,arguments)}return t=c,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t=[];if(!(0,i.isNullOrUndefined)(this.getMetadata().value_object_list))try{t=JSON.parse(this.getMetadata().value_object_list)}catch(e){}var n="any";(0,i.isNullOrUndefined)(this.getMetadata().option_condition)||(n=this.getMetadata().option_condition);var r=0,a=0;if("ui"===e.type){var u=e.data;t.forEach((function(e){r+=1,e==u.getSceneObject().getSceneObjectId()&&(a+=1)}))}var c="no";switch(n){case"any":a>0&&(c="yes");break;case"all":a===r&&(c="yes");break;case"none":0===a&&(c="yes")}return[new o.q(e.type,e.data,this,c)]}}])&&ft(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(r.s)},22875:function(e,t,n){"use strict";n.d(t,{ProcessManager:function(){return o.U}}),n(66276);var r=n(68626);n.o(r,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return r.AddObjectCommand}}),n.o(r,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return r.AppViewerComponent}}),n.o(r,"ProcessManager")&&n.d(t,{ProcessManager:function(){return r.ProcessManager}}),n.o(r,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return r.SetPositionCommand}}),n.o(r,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return r.SetRotationCommand}}),n(26566);var o=n(7772);n(74120),n(30780)},66276:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}n.d(t,{C:function(){return i}}),n(21703),n(69070);var i=o((function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.client=t,this.outPort=n,this.target=r,this.inPort=o}))},26566:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}n.d(t,{q:function(){return i}}),n(21703),n(69070);var i=o((function e(t,n,r,o,i,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=t,this.data=n,this.client=r,this.outPort=o,this.target=i,this.inPort=a}))},30780:function(e,t,n){"use strict";n.d(t,{f:function(){return Q}}),n(47941),n(41539),n(15581),n(2490),n(34514),n(54747),n(68309),n(69070),n(21703);var r=n(42973),o=n(26432),i=n(98442),a=(n(35666),n(88674),n(68304),n(30489),n(81299),n(12419),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948),n(74120)),u=n(26566),c=n(41142);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function l(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t){return d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},d(e,t)}function h(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(m,e);var t,n,r,o,i,a,s=(i=m,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=y(i);if(a){var n=y(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return h(this,e)});function m(){var e;return f(this,m),(e=s.apply(this,arguments)).mDebounceTimout=null,e}return t=m,n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:(r=regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){c.qL.print("called debounce"),null!==n.mDebounceTimout&&(c.qL.print("debounced"),clearTimeout(n.mDebounceTimout)),c.qL.print("wait another: ",n.getMetadata().value_mstime),n.mDebounceTimout=setTimeout((function(){n.mDebounceTimout=null,c.qL.print("debounce run func"),e([new u.q(t.type,t.data,n,"forward")])}),n.getMetadata().value_mstime||0)})));case 1:case"end":return e.stop()}}),e)})),o=function(){var e=this,t=arguments;return new Promise((function(n,o){var i=r.apply(e,t);function a(e){l(i,n,o,a,u,"next",e)}function u(e){l(i,n,o,a,u,"throw",e)}a(void 0)}))},function(e){return o.apply(this,arguments)})}],n&&p(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),m}(a.s);function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function w(e,t){return w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},w(e,t)}function _(e,t){if(t&&("object"===v(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function O(e){return O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},O(e)}var T=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=O(r);if(o){var n=O(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return _(this,e)});function a(){return b(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"onHandleInPort",value:function(e){var t=this;return new Promise((function(n){setTimeout((function(){n([new u.q(e.type,e.data,t,"forward")])}),t.getMetadata().value_mstime||0)}))}}])&&g(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(a.s),R=(n(47042),n(91038),n(74916),n(77601),n(19601),n(89002));function S(){window.location.href.startsWith("data:text/html,<script>")&&(window.URL=window.URL||window.webkitURL,window.xpvJail={workers:{},handleJailMessage:function(e,t){var n=t.data,r=n.type,o=n.content;switch(r){case"function-call":window.parent.postMessage({messageId:t.data.messageId,scriptId:e,sandboxId:window.xpvJail.workers[e].sandbox,type:r,content:o},"*");break;case"finished":window.xpvJail.killScript(e),window.xpvJail.workers[e].resolver(o),delete window.xpvJail.workers[e]}},runScriptInJail:function(e,t,n,r,o){var i=this.constructJail(e,o,r,n);return new Promise((function(r,o){try{if(!window.Worker)return void o({cause:"web-workers-not-supported"});var a=new Worker(function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"application/javascript";try{t=new Blob([e],{type:n})}catch(n){window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder;var r=new BlobBuilder;r.append(e),t=r.getBlob()}return window.URL.createObjectURL(t)}(i));window.xpvJail.workers[e]={executor:a,resolver:function(e){r(e)},rejector:o,sandbox:t};var u=function(e){var t=e;if(!(e instanceof ErrorEvent)){if("error"!==e.data.type)return;t=e.data.content}console.warn("[jail] Went wrong in jail",n),o(t)};a.addEventListener("error",u),a.addEventListener("message",u),a.addEventListener("message",window.xpvJail.handleJailMessage.bind(null,e))}catch(e){o(e)}}))},killScript:function(e){void 0!==window.xpvJail.workers[e]&&(window.xpvJail.workers[e].executor.onerror=void 0,window.xpvJail.workers[e].executor.onmessage=void 0,window.xpvJail.workers[e].executor.terminate())},constructJail:function(e,t,n,r){var o="<script>/* runs inside the worker */\n                var _app = {\n                    scriptId: '10000000-1000-4000-8000-100000000000',\n                    _flyingMessages: {},\n                    postMessageWithResult(type, content = undefined) {\n                        var uuidv4 = function() {\n                            var crypto = self.crypto || self.msCrypto || false;\n                            if (crypto) {\n                                return ('' + 1e7 + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, function(c) {\n                                    return Number(c) ^ (crypto.getRandomValues(new Uint8Array(1))[0] & (15 >> (Number(c) / 4)));\n                                }).toString(16);\n                            } else {\n                                return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n                                    const r = (Math.random() * 16) | 0, v = c == 'x' ? r : (r & 0x3) | 0x8;\n                                    return v.toString(16);\n                                });\n                            }\n                        };\n                        var id = uuidv4();\n                        while (this._flyingMessages[id] !== undefined) {\n                            id = uuidv4();\n                        }\n                        this._flyingMessages[id] = null; /* ensure no-one else gets this key. */\n                        return new Promise(function(resolve, reject) {\n                            this._flyingMessages[id] = function(msgContent, success = true) {\n                                return success ? resolve(msgContent) : reject(msgContent);\n                            };\n                            self.postMessage({\n                                scriptId: this.scriptId,\n                                messageId: id,\n                                type,\n                                content\n                            });\n                        });\n                    },\n                    postMessage(type, content = undefined) { self.postMessage({ type, content }); },\n                    message(content) { this.postMessage('message', content); },\n                    handleIncomingMessage(message) {\n                        var { id, success, content } = message.data;\n                        var resolver = this._flyingMessages[id];\n                        if (resolver) resolver(content, success || false);\n                    },\n                    ready() { this.postMessage('ready'); },\n                    result(value) { this.postMessage('finished', value); },\n                };\n                self.addEventListener('message', function(msg) {\n                    return _app.handleIncomingMessage(msg);\n                });\n                _app.ready();\n            ";o=o.substr(o.indexOf("<script>")+8);for(var i="_app.scriptId = '".concat(e,"';\n"),a=0;a<t.length;a++){var u=t[a];i+="_app.".concat(u," = function() {\n")+"\tlet args = Array.prototype.slice.call(arguments);\n"+"\treturn this.postMessageWithResult('function-call',{name:'".concat(u,"', arguments: args});")+"};\n"}var c="const _ctx = ".concat(JSON.stringify(n),";");return"".concat(o,";\n").concat(i,";\n").concat(c,";\n").concat(r,";\n                Promise.resolve(run())\n                    .catch(function(error) { return _app.postMessage('error', error); })\n                    .then(function(result) { return _app.result(result); });")}},window.addEventListener("message",(function(e){var t=e.data;switch(t.type){case"run-script":window.xpvJail.runScriptInJail(t.messageId,t.sandboxId,atob(t.content.code),t.content.context,t.content.interactions).then((function(n){var r={messageId:t.messageId,type:"script-finished",content:n};window.parent.postMessage(r,e.origin)}));break;case"kill-script":window.xpvJail.killScript(t.content);break;case"function-result":window.xpvJail.workers[t.scriptId]?window.xpvJail.workers[t.scriptId].executor.postMessage({id:t.messageId,success:!0,content:t.content}):console.warn("[jail] Worker doesn't exist anymore, did you forget to await a function result?")}})),window.parent.postMessage({type:"ready"},"*"))}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function P(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function x(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){P(i,r,o,a,u,"next",e)}function u(e){P(i,r,o,a,u,"throw",e)}a(void 0)}))}}function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n(23157),n(60285),n(41637),n(82772),n(38862),n(92222),n(75505),n(87714),n(82801),n(1174);var C=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var t=e.generateUniqueUuidForObject(e.interactions);e.interactions[t]={},this.sandboxId=t,e.sandbox||(e.ready=new Promise((function(t){return e.flyingMessages.ready=t})),e.sandbox=document.createElement("iframe"),e.sandbox.setAttribute("sandbox","allow-scripts"),e.sandbox.style.display="none",e.sandbox.src="data:text/html,<script>(".concat(S,")()<\/script>"),window.addEventListener("message",(function(t){t.source===e.sandbox.contentWindow&&e.messageListener(t.data)})),document.body.appendChild(e.sandbox))}var t,n,r,o,i;return t=e,n=[{key:"executeScript",value:(i=x(regeneratorRuntime.mark((function t(n){var r,o,i=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:{},o=i.length>2&&void 0!==i[2]?i[2]:200,t.abrupt("return",e.sendResponseExpectingMessage({sandboxId:this.sandboxId,type:"run-script",content:{code:n,context:r,interactions:Object.keys(e.interactions[this.sandboxId]||{})}},o));case 3:case"end":return t.stop()}}),t,this)}))),function(e){return i.apply(this,arguments)})},{key:"registerInteractions",value:function(t){e.interactions[this.sandboxId]=t}}],r=[{key:"generateUniqueUuidForObject",value:function(e){for(var t=R.F.uuidV4();void 0!==e[t];)c.qL.warn("Uuid collision detected... generating another one."),t=R.F.uuidV4();return t}},{key:"messageListener",value:function(t){var n,r;"function-call"!==t.type?("script-finished"===t.type&&void 0!==t.messageId&&(e.flyingMessages[t.messageId](t.content),delete e.flyingMessages[t.messageId]),"ready"===t.type&&(c.qL.print("[jail] Ready to be used!"),e.flyingMessages.ready(t.content),delete e.flyingMessages.ready)):Promise.resolve((n=e.interactions[t.sandboxId])[t.content.name].apply(n,(r=t.content.arguments,function(e){if(Array.isArray(e))return E(e)}(r)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||function(e,t){if(e){if("string"==typeof e)return E(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?E(e,t):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))).then((function(n){var r={sandboxId:t.sandboxId,scriptId:t.scriptId,messageId:t.messageId,type:"function-result",content:n};e.sendMessage(r)}))}},{key:"sendMessage",value:function(t){e.sandbox.contentWindow.postMessage(t,"*")}},{key:"sendResponseExpectingMessage",value:(o=x(regeneratorRuntime.mark((function t(n){var r,o,i=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:200,o=e.generateUniqueUuidForObject(e.flyingMessages),e.flyingMessages[o]=null,t.next=5,e.ready;case 5:return t.abrupt("return",new Promise((function(t,i){var a=Object.assign(n,{messageId:o}),u=window.setTimeout((function(){i("Script didn't finish in time\n"),e.sendMessage({sandboxId:n.sandboxId,type:"kill-script",content:o}),delete e.flyingMessages[o]}),r);e.flyingMessages[o]=function(e){window.clearTimeout(u),t(e)},e.sandbox.contentWindow.postMessage(a,"*")})));case 6:case"end":return t.stop()}}),t)}))),function(e){return o.apply(this,arguments)})}],n&&j(t.prototype,n),r&&j(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();C.flyingMessages={},C.interactions={};var k=n(70211),M=n(94072),D=n(47746),A=n(84217);function I(e){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I(e)}function N(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return V(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?V(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw i}}}}function V(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function U(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function F(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){U(i,r,o,a,u,"next",e)}function u(e){U(i,r,o,a,u,"throw",e)}a(void 0)}))}}function B(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function L(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function H(e,t){return H=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},H(e,t)}function z(e,t){if(t&&("object"===I(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function q(e){return q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},q(e)}var G=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&H(e,t)}(l,e);var t,n,r,o,i,a,s=(i=l,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=q(i);if(a){var n=q(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return z(this,e)});function l(){var e;return B(this,l),(e=s.apply(this,arguments)).flow=new k.xQ,e}return t=l,n=[{key:"onInit",value:function(){}},{key:"onDestroy",value:function(){}},{key:"executeInSandbox",value:(o=F(regeneratorRuntime.mark((function e(t){var n,r,o,i,a,s,l,f,p,d,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getMetadata().script||"",r=new C,e.prev=2,i=this.getProcessManager().getProductNode(),a=i.getComponent("attributeManager"),e.next=7,a.resolveAttributeManager().toPromise();case 7:s=e.sent,l=[],f=s.getAttributeControllers(),p=N(f);try{for(p.s();!(d=p.n()).done;)h=d.value,l.push(h.getAttribute())}catch(e){p.e(e)}finally{p.f()}return e.next=14,r.executeScript(n,{nodeInput:t.data,attributes:l},3e4);case 14:o=e.sent,e.next=20;break;case 17:e.prev=17,e.t0=e.catch(2),c.qL.error(e.t0);case 20:return e.abrupt("return",[new u.q("all",{value:o},this,"output")]);case 21:case"end":return e.stop()}}),e,this,[[2,17]])}))),function(e){return o.apply(this,arguments)})},{key:"onHandleInPort",value:(r=F(regeneratorRuntime.mark((function e(t){var n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Promise((function(e){var t;r.flow.pipe((t=function(e){return(0,M.D)(r.executeInSandbox(e))},(0,D.zg)(t,undefined,1)),(0,A.q)(1)).subscribe((function(t){e(t)}))})),this.flow.next(t),e.abrupt("return",n);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})}],n&&L(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(a.s);function W(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Q=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"processes",value:function(){var t={};return Object.keys(e).forEach((function(n){var r=e[n];void 0!==r&&("string"==typeof r.name||r.name instanceof String)&&(t[r.name]=r.process)})),t}}],null&&W(t.prototype,null),n&&W(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();Q.CHECKS_ACTION_HIDE_OFFSET={name:"checks/action/hide-offset",process:r.vO},Q.ACTIONS_HIDE_QUESTION={name:"actions/hide/question",process:r.eI},Q.ACTIONS_MESSAGE_ALERT={name:"actions/message/alert",process:r.g7},Q.ACTIONS_MESSAGE_TOAST={name:"actions/message/toast",process:r.JQ},Q.ACTIONS_MESSAGE_WARNING={name:"actions/message/warning",process:r.qB},Q.ACTIONS_ROTATE_OFFSET={name:"actions/rotate/offset",process:r.Py},Q.ACTIONS_SELECT_CAMERA={name:"actions/select/camera",process:r.z2},Q.ACTIONS_SELECT_VIEW={name:"actions/select/view",process:r.h},Q.ACTIONS_SELECT_OPTION={name:"actions/select/option",process:r.SH},Q.ACTIONS_SELECT_COLOR={name:"actions/select/color",process:r.o2},Q.ACTIONS_SET_MATGROUP={name:"actions/set/matgroup",process:r.zj},Q.ACTIONS_SET_OFFSET={name:"actions/set/offset",process:r.XV},Q.CHECKS_ACTION_SHOW_OFFSET={name:"checks/action/show-offset",process:r.k9},Q.ACTIONS_SHOW_QUESTION={name:"actions/show/question",process:r.cG},Q.ACTIONS_VISIBILITY_COLOR={name:"actions/visibility/color",process:r.MC},Q.ACTIONS_VISIBILITY_MATGROUP={name:"actions/visibility/material",process:r.fY},Q.ACTIONS_VISIBILITY_OPTIONS={name:"actions/visibility/option",process:r.Km},Q.ACTIONS_VISIBILITY_QUESTION={name:"actions/visibility/question",process:r.z4},Q.ACTIONS_VISIBILITY_MATPRICE={name:"actions/visibility/matprice",process:r.wh},Q.ACTIONS_DISABLE_OPTIONS={name:"actions/visibility/disable-option",process:r.Z7},Q.ACTIONS_PLAY_SOUND={name:"actions/play/sound",process:r.ge},Q.BROADCAST_MATGROUP={name:"broadcast/matgroup",process:o.hw},Q.BROADCAST_OPTION={name:"broadcast/option",process:o.S9},Q.BROADCAST_QUESTION={name:"broadcast/question",process:o.dl},Q.BROADCAST_SCENE_BUILT={name:"broadcast/scene/built",process:o.Vc},Q.BROADCAST_SCENE_INITIALIZED={name:"broadcast/scene/initialized",process:o.HB},Q.BROADCAST_UI_CLICKED={name:"broadcast/ui/clicked",process:o.Rs},Q.BROADCAST_INPUT={name:"boardcast/input",process:o.Rt},Q.BROADCAST_OPERABLE_VALUE={name:"broadcast/operation",process:o.nS},Q.BROADCAST_VALUE={name:"broadcast/value",process:o.Eg},Q.BROADCAST_VALUE_NAME={name:"broadcast/value-name",process:o.Hi},Q.BROADCAST_OPERABLE_SUM={name:"sum/operation",process:o.uX},Q.BORADCAST_INPUT_MIN_MAX={name:"broadcast/minmax",process:o.wW},Q.BROADCAST_TEXT_WIDTH={name:"broadcast/text-width",process:o.sM},Q.CHECKS_ACTIVE_CAMERA={name:"checks/active-camera",process:i.ON},Q.CHECKS_ACTIVE_VIEW={name:"checks/active-view",process:i.zU},Q.CHECKS_ACTIVE_MATGROUP={name:"checks/active-matgroup",process:i.el},Q.CHECKS_ACTIVE_OFFSET={name:"checks/active-offset",process:i.nX},Q.CHECKS_ACTIVE_OPTION={name:"checks/active-option",process:i.ov},Q.CHECKS_LIST={name:"checks/list",process:i.Yn},Q.CHECKS_MAT_REFERENCE={name:"checks/matref",process:i.pt},Q.CHECKS_OPTION={name:"checks/option",process:i.Zx},Q.CHECKS_QUESTION={name:"checks/question",process:i.Yv},Q.CHECKS_INPUT={name:"checks/input",process:i.I0},Q.CHECKS_OPERABLE_VALUE={name:"checks/operation",process:i.w2},Q.CHECKS_STRING={name:"checks/string",process:i.NO},Q.CHECKS_ATTRIBUTE_TRIGGERED={name:"checks/attribute-triggered",process:i.nf},Q.CHECKS_ATTRIBUTE_VALUE_NAME={name:"checks/attribute-value-name",process:i.fF},Q.CHECKS_UI={name:"checks/ui",process:i.U1},Q.CHECKS_ACTIVE_RECONFIGURE={name:"checks/reconfigure",process:i.Iy},Q.ACTIONS_FORWARD={name:"action/forward",process:r.M_},Q.ACTIONS_SET_LINE_TITLE={name:"action/set-line-title",process:r.WB},Q.ACTIONS_SET_INPUT={name:"action/set-input",process:r.Wc},Q.ACTIONS_SET_COLOR={name:"action/set-color",process:r.NX},Q.ACTIONS_SET_MAP={name:"action/set-map",process:r.hM},Q.ACTIONS_SET_GRADIENT_COLOR={name:"action/set-gradient-color",process:r.QB},Q.ACTIONS_SET_OPERABLE={name:"action/set-operable",process:r.lp},Q.ACTIONS_CHANGE_INPUT_MINMAX={name:"action/change-minmax",process:r.HT},Q.ACTIONS_UPDATE_ATTRIBUTE={name:"action/update-attribute",process:r.HM},Q.ACTIONS_SET_INPUT_MINMAX={name:"action/set-minmax",process:r.eF},Q.ACTIONS_SET_TEXT={name:"action/set-text",process:r.io},Q.ACTIONS_ARITHMETIC={name:"action/arithmetic",process:r.$$},Q.ACTIONS_EXECUTE_SCRIPT={name:"action/script-execute",process:G},Q.UTIL_DEBUG={name:"util/debug",process:r.jx},Q.UTIL_DEBOUNCE={name:"util/debounce",process:m},Q.UTIL_TIMEOUT={name:"util/timeout",process:T}},7772:function(e,t,n){"use strict";n.d(t,{U:function(){return f}}),n(41539),n(88674),n(15581),n(2490),n(34514),n(54747),n(40561),n(69826),n(31672),n(59461),n(69070),n(21703);var r=n(84217),o=n(66276),i=n(89539),a=n(70211),u=n(30780),c=n(41142),s=n(79843);function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var f=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mProcesses=new Array,this.mConnections=new Array,this.mNodeFactories={},this.mLoadhash=0,this.onLoadFinished=new a.xQ,this.mNodeFactories=u.f.processes(),this.mProductNode=t}var t,n;return t=e,(n=[{key:"load",value:function(){var e=this,t=++this.mLoadhash;return new Promise((function(n,o){s.Q.getInstance().resolveBootstrapData(+e.mProductNode.getValue("product_id")).pipe((0,r.q)(1)).subscribe((function(r){if(t!==e.mLoadhash)throw"cancelled";try{r.getRules().forEach((function(t){e._loadGraph(t)})),e.onLoadFinished.next(!0)}catch(t){return e.onLoadFinished.next(!1),o(t)}n(e)}),(function(t){e.onLoadFinished.next(!1),o(t)}))}))}},{key:"_loadGraph",value:function(e){var t=this,n=e.processes;Array.isArray(n)&&n.forEach((function(e){var n=(0,i.isNullOrUndefined)(e.meta)?{}:e.meta;t.addNode(e.pid,e.component,n)}));var r=e.connections;Array.isArray(r)&&r.forEach((function(e){var n=(0,i.isNullOrUndefined)(e.meta)?{}:e.meta;(0,i.isNullOrUndefined)(e.source_data)?t.addEdge(e.source_pid,e.source_port,e.target_pid,e.target_port,n):t.addInitial(e.source_data,e.target_pid,e.target_port,n)}))}},{key:"unload",value:function(){++this.mLoadhash,this.mProcesses.splice(0,this.mProcesses.length).forEach((function(e){return e.onDestroy()})),this.mConnections.splice(0,this.mConnections.length)}},{key:"getProductNode",value:function(){return this.mProductNode}},{key:"addNode",value:function(e,t,n){var r=this.mNodeFactories[t];if(!(0,i.isNullOrUndefined)(r)){var o=new r(e,this,n);this.mProcesses.push(o),o.onInit()}}},{key:"addEdge",value:function(e,t,n,r,a){var u=this.mProcesses.find((function(t){return t.getPid()===e})),s=this.mProcesses.find((function(e){return e.getPid()===n}));(0,i.isNullOrUndefined)(u)||(0,i.isNullOrUndefined)(s)?c.qL.error("failed to add edge: ",u,s):(u.attachOutPort(t,s,r),s.attachInPort(r,u,t),this.mConnections.push(new o.C(u,t,s,r)))}},{key:"addInitial",value:function(e,t,n,r){}}])&&l(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},68626:function(){},74120:function(e,t,n){"use strict";n.d(t,{s:function(){return d}}),n(34553),n(40561),n(47941),n(21249),n(57640),n(9924),n(41539),n(88674),n(15581),n(2490),n(34514),n(54747),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(66276),o=n(89539),i=n(26566),a=n(90140),u=n(78842);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},l(e,t)}function f(e,t){if(t&&("object"===c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(d,e);var t,n,a,u,c=(a=d,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=p(a);if(u){var n=p(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return f(this,e)});function d(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(r=c.call(this)).mInPorts={},r.mOutPorts={},r.mPid=e,r.mMeta=n,r.mProcessManager=t,r}return t=d,(n=[{key:"getType",value:function(){return d.TypeRTTI}},{key:"getPid",value:function(){return this.mPid}},{key:"getMetadata",value:function(){return this.mMeta}},{key:"getProcessManager",value:function(){return this.mProcessManager}},{key:"attachInPort",value:function(e,t,n){return(0,o.isNullOrUndefined)(this.mInPorts[e])&&(this.mInPorts[e]=new Array),this.mInPorts[e].push(new r.C(t,n,this,e)),this.mInPorts[e].length-1}},{key:"detachInPort",value:function(e,t,n){if((0,o.isNullOrUndefined)(this.mInPorts[e]))return null;var r=this.mInPorts[e].findIndex((function(e){return e.client.getObjectId()===t.getObjectId()&&n===e.outPort}));return r>=0?this.detachInPortAtIndex(e,r):null}},{key:"detachInPortAtIndex",value:function(e,t){if((0,o.isNullOrUndefined)(this.mInPorts[e]))return null;var n=this.mInPorts[e].splice(t,1);return n.length>0?n[0].client:null}},{key:"attachOutPort",value:function(e,t,n){return(0,o.isNullOrUndefined)(this.mOutPorts[e])&&(this.mOutPorts[e]=new Array),this.mOutPorts[e].push(new r.C(this,e,t,n)),this.mOutPorts[e].length-1}},{key:"detachOutPort",value:function(e,t,n){if((0,o.isNullOrUndefined)(this.mOutPorts[e]))return null;var r=this.mOutPorts[e].findIndex((function(e){return e.target.getObjectId()===t.getObjectId()&&n===e.inPort}));return r>=0?this.detachOutPortAtIndex(e,r):null}},{key:"detachOutPortAtIndex",value:function(e,t){if((0,o.isNullOrUndefined)(this.mOutPorts[e]))return null;var n=this.mOutPorts[e].splice(t,1);return n.length>0?n[0].target:null}},{key:"getInPorts",value:function(){return Object.keys(this.mInPorts)}},{key:"getInPortProcesses",value:function(e){return this.getInConnections(e).map((function(e){return e.client}))}},{key:"getInConnections",value:function(e){return(0,o.isNullOrUndefined)(this.mInPorts[e])?[]:this.mInPorts[e]}},{key:"getOutPorts",value:function(){return Object.keys(this.mOutPorts)}},{key:"getOutPortProcesses",value:function(e){return this.getOutPortConnections(e).map((function(e){return e.target}))}},{key:"getOutPortConnections",value:function(e){return(0,o.isNullOrUndefined)(this.mOutPorts[e])?[]:this.mOutPorts[e]}},{key:"feedInPort",value:function(e){var t=this;Promise.resolve(this.onHandleInPort(e)).then((function(e){e.forEach((function(e){t.getOutPortConnections(e.outPort).forEach((function(t){t.target.feedInPort(new i.q(e.type,e.data,e.client,e.outPort,t.target,t.inPort))}))}))}),(function(e){}))}}])&&s(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),d}(u.L);d.TypeRTTI=new a.r("ProcessObject",u.L.TypeRTTI)},2468:function(e,t,n){"use strict";var r=n(22875);n.o(r,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return r.AddObjectCommand}}),n.o(r,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return r.AppViewerComponent}}),n.o(r,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return r.SetPositionCommand}}),n.o(r,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return r.SetRotationCommand}}),n(42973),n(98442),n(26432)},20732:function(e,t,n){"use strict";n.d(t,{x:function(){return v}}),n(54678),n(91058),n(41539),n(39714),n(68309),n(19601),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r,o=n(45355),i=n(90140),a=n(50409);!function(e){e[e.NoToneMapping=0]="NoToneMapping",e[e.LinearToneMapping=1]="LinearToneMapping",e[e.ReinhardToneMapping=2]="ReinhardToneMapping",e[e.Uncharted2ToneMapping=3]="Uncharted2ToneMapping",e[e.CineonToneMapping=4]="CineonToneMapping"}(r||(r={}));var u=n(89539),c=n(59342),s=n(67574);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(){return p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=d(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},p.apply(this,arguments)}function d(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=m(e)););return e}function h(e,t){return h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},h(e,t)}function y(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(d,e);var t,n,o,i,l=(o=d,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=m(o);if(i){var n=m(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return y(this,e)});function d(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(n=l.call(this,e,t)).mNear=.1,n.mFar=1e3,n.mFov=45,n.mController=0,n.mPipeline=null,n.mMaxZoom=1e3,n.mMinZoom=0,n.mLockPan=!1,n.mLockUpHemisphere=!1,n.mTarget=new THREE.Vector3,n.mToneMappingType=r[r.Uncharted2ToneMapping],n.mToneMappingExposure=1,n.mToneMappingWhitePoint=1,n.mMinAzimuthAngle=null,n.mMaxAzimuthAngle=null,n.mMinPolarAngle=0,n.mMaxPolarAngle=3.14159265359,n.mDirection=s.o.Theta,n.mDampFactor=null,n.mRotationSpeed=.1,n}return t=d,(n=[{key:"getType",value:function(){return d.TypeRTTI}},{key:"setValue",value:function(e,t){switch(e){case"near":return this.mNear=parseFloat(t),!0;case"far":return this.mFar=parseFloat(t),!0;case"fov":return this.mFov=parseFloat(t),!0;case"cam_controller":return this.mController=parseInt(t,10),!0;case"pipeline":return this.mPipeline=t,!0;case"target":return this.mTarget=t.clone(),!0;case"cam_target_x":case"target_x":return this.mTarget.x=parseFloat(t),!0;case"cam_target_y":case"target_y":return this.mTarget.y=parseFloat(t),!0;case"cam_target_z":case"target_z":return this.mTarget.z=parseFloat(t),!0;case"max_zoom":return this.mMaxZoom=parseFloat(t),!0;case"min_zoom":return this.mMinZoom=parseFloat(t),!0;case"pan_disabled":return this.mLockPan=!0===t||"1"==t,!0;case"lockup_hemisphere":return this.mLockUpHemisphere=!0===t||"1"==t,!0;case"tonemapping_type":return this.mToneMappingType=t,!0;case"tonemapping_exposure":return this.mToneMappingExposure=parseFloat(t),!0;case"tonemapping_whitepoint":return this.mToneMappingWhitePoint=parseFloat(t),!0;case"min_azimuth_angle":return this.mMinAzimuthAngle=(0,u.isNullOrUndefined)(t)||!(0,u.isNumber)(t)?-1/0:t,!0;case"max_azimuth_angle":return this.mMaxAzimuthAngle=(0,u.isNullOrUndefined)(t)||!(0,u.isNumber)(t)?1/0:t,!0;case"min_polar_angle":return this.mMinPolarAngle=c.M.Clamp(t,0,3.14159265359,0),!0;case"max_polar_angle":return this.mMaxPolarAngle=c.M.Clamp(t,0,3.14159265359,3.14159265359),!0;case"direction":return this.mDirection=parseInt(t,10),!0;case"damp_factor":return this.mDampFactor=(0,u.isNullOrUndefined)(t)||!(0,u.isNumber)(t)?null:t,!0;case"rotation_speed":return this.mRotationSpeed=(0,u.isNullOrUndefined)(t)||!(0,u.isNumber)(t)?null:t,!0}return p(m(d.prototype),"setValue",this).call(this,e,t)}},{key:"getValue",value:function(e){var t=p(m(d.prototype),"getValue",this).call(this,e);if(null!==t)return t;switch(e){case"near":return this.mNear;case"far":return this.mFar;case"fov":return this.mFov;case"cam_controller":return this.mController;case"pipeline":return this.mPipeline;case"target":return this.mTarget;case"cam_target_x":case"target_x":return this.mTarget.x;case"cam_target_y":case"target_y":return this.mTarget.y;case"cam_target_z":case"target_z":return this.mTarget.z;case"max_zoom":return this.mMaxZoom;case"min_zoom":return this.mMinZoom;case"pan_disabled":return this.mLockPan;case"lockup_hemisphere":return this.mLockUpHemisphere;case"tonemapping_type":return this.mToneMappingType;case"tonemapping_exposure":return this.mToneMappingExposure;case"tonemapping_whitepoint":return this.mToneMappingWhitePoint;case"min_azimuth_angle":return(0,u.isNullOrUndefined)(this.mMinAzimuthAngle)||!(0,u.isNumber)(this.mMinAzimuthAngle)?-1/0:this.mMinAzimuthAngle;case"max_azimuth_angle":return(0,u.isNullOrUndefined)(this.mMaxAzimuthAngle)||!(0,u.isNumber)(this.mMaxAzimuthAngle)?1/0:this.mMaxAzimuthAngle;case"min_polar_angle":return c.M.Clamp(this.mMinPolarAngle,0,3.14159265359,0);case"max_polar_angle":return c.M.Clamp(this.mMaxPolarAngle,0,3.14159265359,3.14159265359);case"direction":return parseInt(this.mDirection.toString(),10);case"damp_factor":return(0,u.isNullOrUndefined)(this.mDampFactor)||!(0,u.isNumber)(this.mDampFactor)?null:this.mDampFactor;case"rotation_speed":return(0,u.isNullOrUndefined)(this.mRotationSpeed)||!(0,u.isNumber)(this.mRotationSpeed)?null:this.mRotationSpeed}return null}},{key:"createRenderObject",value:function(){var e=this.getRenderState().getFromGarbage(this.getGarbageHash());(0,u.isNullOrUndefined)(e)?e=new THREE.PerspectiveCamera(this.mFov,1,this.mNear,this.mFar):(e.fov=this.mFov,e.aspect=1,e.near=this.mNear,e.far=this.mFar,e.updateProjectionMatrix()),e.name=this.mName,e.position.copy(this.mPosition),e.rotation.copy(this.mRotation),e.scale.copy(this.mScale);var t=new THREE.Object3D;return t.position.copy(this.mTarget.clone()),t.userData.camera=e,e.target=t,new a.Q(e,this)}},{key:"getGarbageHash",value:function(){return this.getType().getTypeName()}},{key:"serialize",value:function(e){var t=Object.assign(p(m(d.prototype),"serialize",this).call(this,e),{type:"camera_perspective"});return t.properties=Object.assign(t.properties,{near:this.mNear,far:this.mFar,fov:this.mFov,cam_controller:this.mController,pipeline:this.mPipeline,cam_target_x:this.mTarget.x,cam_target_y:this.mTarget.y,cam_target_z:this.mTarget.z,max_zoom:this.mMaxZoom,min_zoom:this.mMinZoom,pan_disabled:this.mLockPan,lockup_hemisphere:this.mLockUpHemisphere,tonemapping_type:this.mToneMappingType,tonemapping_exposure:this.mToneMappingExposure,tonemapping_whitepoint:this.mToneMappingWhitePoint,min_azimuth_angle:(0,u.isNullOrUndefined)(this.mMinAzimuthAngle)||this.mMinAzimuthAngle===-1/0||!(0,u.isNumber)(this.mMinAzimuthAngle)?null:this.mMinAzimuthAngle,max_azimuth_angle:(0,u.isNullOrUndefined)(this.mMaxAzimuthAngle)||this.mMaxAzimuthAngle===1/0||!(0,u.isNumber)(this.mMaxAzimuthAngle)?null:this.mMaxAzimuthAngle,min_polar_angle:c.M.Clamp(this.mMinPolarAngle,0,3.14159265359,0),max_polar_angle:c.M.Clamp(this.mMaxPolarAngle,0,3.14159265359,3.14159265359),direction:parseInt(this.mDirection.toString(),10),damp_factor:(0,u.isNullOrUndefined)(this.mDampFactor)||!(0,u.isNumber)(this.mDampFactor)?null:this.mDampFactor,rotation_speed:(0,u.isNullOrUndefined)(this.mRotationSpeed)||!(0,u.isNumber)(this.mRotationSpeed)?null:this.mRotationSpeed}),t}}])&&f(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),d}(o.g);v.TypeRTTI=new i.r("CameraEntityPerspective",o.g.TypeRTTI)},45355:function(e,t,n){"use strict";n.d(t,{g:function(){return f}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(80353),o=n(90140),i=n(45044);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function s(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(f,e);var t,n,r,o,a=(r=f,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=l(r);if(o){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return s(this,e)});function f(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),a.call(this,e,t)}return t=f,(n=[{key:"getType",value:function(){return f.TypeRTTI}},{key:"createBuildProcess",value:function(){return new i.Z}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(r.u);f.TypeRTTI=new o.r("CameraEntity",r.u.TypeRTTI)},24098:function(e,t,n){"use strict";n.d(t,{w:function(){return T}}),n(35666),n(41539),n(15581),n(2490),n(34514),n(54747),n(47941),n(74916),n(23123),n(68309),n(19601),n(88674),n(21249),n(57640),n(9924),n(91058),n(57327),n(88449),n(59849),n(34553),n(9653),n(40561),n(69600),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(84217),o=n(90140),i=n(65214),a=n(50762),u=n(89539),c=n(67988),s=n(45437),l=n(44795),f=n(99556),p=n(14311),d=n(41142);function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function y(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function m(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){y(i,r,o,a,u,"next",e)}function u(e){y(i,r,o,a,u,"throw",e)}a(void 0)}))}}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function b(){return b="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=g(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},b.apply(this,arguments)}function g(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=O(e)););return e}function w(e,t){return w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},w(e,t)}function _(e,t){if(t&&("object"===h(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function O(e){return O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},O(e)}var T=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w(e,t)}(T,e);var t,n,o,c,h,y,g=(h=T,y=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=O(h);if(y){var n=O(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return _(this,e)});function T(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,T),(n=g.call(this,e,t)).mSyncHashHelper=new a.L,n.mBatches={},n.mBatchProgress=null,n.mSceneOffsetManager=null,n.mOffsetNodes={},n.mLiveSubscriptions=new Array,n.mPreconfiguredOptions=null,n.mFirstBuild=!0,n.mSharedKeyOverwrite={},n._handleOffsetChange=function(e){var t="$_expivi_offset_".concat(e.id);Object.keys(n.mOffsetNodes).forEach((function(r){for(var o=n.mOffsetNodes[r],i=r.split("/").length-1;i>0;)o=o.parent,i--;o.traverse((function(n){if(n.name===t){var r=new THREE.Vector3,o=new THREE.Quaternion,i=new THREE.Vector3;e.matrix.clone().decompose(r,o,i),n.position.copy(r),n.quaternion.copy(o),n.scale.copy(i)}}))})),n.getRenderState().dispatchAppEvent(p.G.OffsetChanged),n.getRenderState().requestFrame()},n._handleOffsetVisibility=function(e){var t="$_expivi_offset_".concat(e.id);d.qL.print("change node visibility: ",e.visible),Object.keys(n.mOffsetNodes).forEach((function(r){n.mOffsetNodes[r].traverse((function(n){n.name===t&&(n.visible=e.visible)}))})),n.getRenderState().dispatchAppEvent(p.G.OffsetChanged),n.getRenderState().requestFrame()},n._handleMaterialGroupChange=function(e){d.qL.print("handle material changed"),n.getRenderState().dispatchAppEvent(p.G.ProductMaterialChanged,Object.assign({product_uuid:n.findParentOfTypeName("ProductNode").getObjectUUID()},e))},n.mFileLoader=new THREE.FileLoader,n.mFileLoader.setResponseType("arraybuffer"),n}return t=T,n=[{key:"getType",value:function(){return T.TypeRTTI}},{key:"_setServices",value:function(e){this.mProductId=e,null===this.mSceneOffsetManager&&(this.mSceneOffsetManager=new l.Z(this.mProductId))}},{key:"_setPreconfiguredOptions",value:function(e){this.mPreconfiguredOptions=e}},{key:"_getPreconfiguredOptions",value:function(){return this.mPreconfiguredOptions}},{key:"setValue",value:function(e,t){return b(O(T.prototype),"setValue",this).call(this,e,t)}},{key:"getValue",value:function(e){var t=b(O(T.prototype),"getValue",this).call(this,e);return null!==t?t:"product_id"===e?this.mProductId:null}},{key:"resolveSceneOffsetManager",value:(c=m(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){t.mSceneOffsetManager._resolveOffsets().pipe((0,r.q)(1)).subscribe((function(){e(t.mSceneOffsetManager)}),(function(e){n(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(){return c.apply(this,arguments)})},{key:"setMeshList",value:function(e){this.mMeshList=e;var t=this.getRenderObject();null!==t&&(t.needsUpdate=!0)}},{key:"clearHightlights",value:function(){var e=this;Object.keys(this.mBatches).forEach((function(t){e.mBatches[t].clearHighLights()}))}},{key:"getBatches",value:function(){var e=this;return Object.keys(this.mBatches).map((function(t){return e.mBatches[t]}))}},{key:"_setFirstBuild",value:function(e){this.mFirstBuild=e}},{key:"_isFirstBuild",value:function(){return this.mFirstBuild}},{key:"highlightActiveModel",value:function(e){var t=this,n=new Array;if(this.mMeshList&&this.mMeshList instanceof Array){var r=new Array;this.mMeshList.forEach((function(t){var n=t.batch+t.material_id;t.nodes&&t.nodes instanceof Array&&t.nodes.forEach((function(t){var o=t.models_id;e==o&&r.push({batchId:n,id:parseInt(t.scene_object_id,10),start:parseInt(t.batch_offset,10),count:parseInt(t.index_count,10)})}))})),Object.keys(this.mBatches).forEach((function(e){t.mBatches[e].clearHighLights();var o=r.filter((function(t){return t.batchId===e}));if(o.length>0){var i=t.mMeshList.filter((function(t){return t.batch+t.material_id===e}));i.length>0&&i[0].nodes.forEach((function(n){var r=o.findIndex((function(e){return e.id==n.scene_object_id}));t.mBatches[e].addHighlight(parseInt(n.batch_offset,10),parseInt(n.index_count,10),r>=0)}));var a=t.mBatches[e].getMesh();if(!(0,u.isNullOrUndefined)(a)){a.updateMatrixWorld(!0);var c=a.geometry,s=new THREE.Box3,l=c.getIndex(),f=c.getAttribute("position");o.forEach((function(e){for(var t=e.start;t<e.start+e.count;t++){var n=l.array[t],r=new THREE.Vector3(f.array[3*n],f.array[3*n+1],f.array[3*n+2]);s.expandByPoint(r)}}));var p=new THREE.Vector3;s.getCenter(p);var d=new THREE.Sphere;s.getBoundingSphere(d);var h=2*d.radius;h>0&&n.push({position:p,radius:h,mesh:a})}}}))}return n}},{key:"createBatchNode",value:function(e,t,n,r,o,a,u,c){return new i.N(e,t,n,r,o,a,u,c)}},{key:"syncBatches",value:(o=m(regeneratorRuntime.mark((function e(t,n){var r,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.mSyncHashHelper.newHash(),n&&n instanceof Array&&n.forEach((function(e){var t=e.batch+e.material_id;t in o.mBatches?o.mBatches[t].setSyncHash(o.mSyncHashHelper.getHash()):(o.mBatches[t]=o.createBatchNode(e.batch,e.nodes,o,e.material_id,e.material_group,e.offset_groups_set,o.mSyncHashHelper.getHash(),o.mMaterialManager),Object.keys(o.mSharedKeyOverwrite).forEach((function(e){var n=Number(e);o.mBatches[t].setMaterialOverwrite(n,o.mSharedKeyOverwrite[n])})),o.mBatches[t].load(o.mFileLoader,o.mSyncHashHelper).catch((function(e){d.qL.warn("failed to load batch file: ",e)})))})),null===this.mBatchProgress){e.next=4;break}return e.abrupt("return",this.mBatchProgress);case 4:return r=new Promise((function(e){o._resolveWhenBatchesReady(e)})),this.mBatchProgress=r,r.then((function(){o.mBatchProgress=null,o._clearOutOfSync()}),(function(){})),e.abrupt("return",r);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"_clearOutOfSync",value:function(){var e=this,t=new Array,n=this.findParentOfTypeName("ProductNode").getSceneObjectId();Object.keys(this.mBatches).forEach((function(r){var o=e.mBatches[r];o.isInSyncWithHash(e.mSyncHashHelper.getHash())||(o.dispose(n),t.push(r))})),t.forEach((function(t){delete e.mBatches[t]}))}},{key:"_resolveWhenBatchesReady",value:function(e){var t=this,n=0,r=0,o=0;Object.keys(this.mBatches).forEach((function(e){n+=1,o+=t.mBatches[e].getLoadProgress(),t.mBatches[e].isReady()&&(r+=1)})),this.getRenderState().dispatchAppEvent(p.G.BatchProgress,n>0?o/n:0),n===r?(d.qL.print("all resolved!!"),e(!0)):setTimeout((function(){t._resolveWhenBatchesReady(e)}),100)}},{key:"createBuildProcess",value:function(){return new s.h}},{key:"initRenderObject",value:function(){var e=this;b(O(T.prototype),"initRenderObject",this).call(this);var t=this.findParentOfTypeName("ProductNode").getComponent("materialGroupManager");return this.mLiveSubscriptions.push(this.mSceneOffsetManager.onOffsetChanged.subscribe(this._handleOffsetChange),this.mSceneOffsetManager.onOffsetVisibility.subscribe(this._handleOffsetVisibility),t.resolveMaterialGroups().subscribe((function(t){e.mLiveSubscriptions.push(t.onMaterialChanged.subscribe(e._handleMaterialGroupChange))}))),!0}},{key:"deinitRenderObject",value:function(){d.qL.print("deinit configurable node"),this.mFirstBuild=!0,this.mSyncHashHelper.newHash(),this._clearOutOfSync(),null!==this.mSceneOffsetManager&&this.mSceneOffsetManager.unload(),this.mLiveSubscriptions.splice(0,this.mLiveSubscriptions.length).forEach((function(e){return e.unsubscribe()})),this.mOffsetNodes={},b(O(T.prototype),"deinitRenderObject",this).call(this)}},{key:"finalizeRenderObjectBuild",value:function(){}},{key:"loadBatches",value:function(e,t){var n=this;this.syncBatches(e,this.mMeshList).then((function(){var e=new Array,r=0;Object.keys(n.mBatches).forEach((function(t){if(!n.mBatches[t].isAttached()){var o=new Promise((function(e){setTimeout((function(){var r=n.mBatches[t];(0,u.isNullOrUndefined)(r)||n._attachBatchToScene(r),e(n.mBatches[t])}),r)}));r+=1,e.push(o)}})),f.S.resolveArray(e,(function(e){n.getRenderState().dispatchAppEvent(p.G.MeshChanged),n.getRenderState().requestFrame(),(0,u.isNullOrUndefined)(t)||t(!0)}))}),(function(){}))}},{key:"_attachBatchToScene",value:function(e){var t=this,n=this.getRenderObject().get3DObject(),r=e.getOffsetNodes();if(r.length>0){var o=r.join("/");o in this.mOffsetNodes?n=this.mOffsetNodes[o]:(r.forEach((function(e){var r=n.getObjectByName("$_expivi_offset_".concat(e));(0,u.isNullOrUndefined)(r)&&((r=new THREE.Group).name="$_expivi_offset_".concat(e),r.visible=t.mSceneOffsetManager.getOffsetVisibility(e),n.add(r));var o=t.mSceneOffsetManager.getAbsoluteOffsetMatrix(e);if(!(0,u.isNullOrUndefined)(o)){var i=new THREE.Vector3,a=new THREE.Quaternion,c=new THREE.Vector3;o.decompose(i,a,c),r.position.copy(i),r.quaternion.copy(a),r.scale.copy(c)}n=r})),this.mOffsetNodes[o]=n)}e.attach(n)}},{key:"_updateWithMaterialManager",value:function(e){this.mMaterialManager=e,this.hasRenderObject()||this._createOrResolveRenderObject(),this.getRenderObject().isAttached()||this.getRenderObject().attach()}},{key:"serialize",value:function(e){return Object.assign(b(O(T.prototype),"serialize",this).call(this,e),{type:"configurable"})}},{key:"notifyMaterialOverwrite",value:function(e,t){var n=this;this.mSharedKeyOverwrite[e]=t,Object.keys(this.mBatches).forEach((function(r){n.mBatches[r].setMaterialOverwrite(e,t)}))}}],n&&v(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),T}(c.B);T.TypeRTTI=new o.r("ConfigurableNode",c.B.TypeRTTI)},47405:function(e,t,n){"use strict";n.d(t,{M:function(){return g}}),n(54678),n(68309),n(19601),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(90140),o=n(37526),i=n(80353);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function s(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=l(r);if(o){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return s(this,e)});function a(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.call(this,e,t)}return t=a,(n=[{key:"getType",value:function(){return a.TypeRTTI}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(i.u);function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(){return h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=y(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},h.apply(this,arguments)}function y(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=b(e)););return e}function m(e,t){return m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},m(e,t)}function v(e,t){if(t&&("object"===p(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function b(e){return b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},b(e)}f.TypeRTTI=new r.r("ControllerEntity",i.u.TypeRTTI);var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(u,e);var t,n,r,i,a=(r=u,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=b(r);if(i){var n=b(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return v(this,e)});function u(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(n=a.call(this,e,t)).mCellWidth=1,n.mCellHeight=1,n}return t=u,(n=[{key:"getType",value:function(){return u.TypeRTTI}},{key:"setValue",value:function(e,t){switch(e){case"cell_width":return this.mCellWidth=parseFloat(t),!0;case"cell_height":return this.mCellHeight=parseFloat(t),!0}return h(b(u.prototype),"setValue",this).call(this,e,t)}},{key:"getValue",value:function(e){var t=h(b(u.prototype),"getValue",this).call(this,e);if(null!==t)return t;switch(e){case"cell_width":return this.mCellWidth;case"cell_height":return this.mCellHeight;case"cell_size":return this.getCellSize()}return null}},{key:"getCellSize",value:function(){return{width:this.mCellWidth,height:this.mCellHeight}}},{key:"createRenderObject",value:function(){var e=new THREE.PlaneBufferGeometry(2,2),t=new THREE.Mesh(e,new THREE.MeshPhongMaterial({color:15987699,side:THREE.DoubleSide,visible:!1}));return t.name="drop_area",t.castShadow=!1,t.receiveShadow=this.mReceiveShadow,t.position.copy(this.mPosition),t.rotation.copy(this.mRotation),t.scale.copy(this.mScale),t.userData.needsHelper="drop_area",t.needsHelper="drop_area",new o.m(t,this)}},{key:"serialize",value:function(e){var t=Object.assign(h(b(u.prototype),"serialize",this).call(this,e),{type:"drop_area"});return t.properties=Object.assign(t.properties,{cell_width:this.mCellWidth,cell_height:this.mCellHeight}),t}}])&&d(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(f);g.TypeRTTI=new r.r("ControllerEntityGridArea",f.TypeRTTI)},33314:function(e,t,n){"use strict";n.d(t,{Cx:function(){return i.C},Ln:function(){return s.L},Re:function(){return l.R},dG:function(){return o.d},gR:function(){return r.g},mX:function(){return u.m},p2:function(){return c.p},v6:function(){return a.v}}),n(50753),n(92354),n(67988),n(80353);var r=n(45355),o=(n(20732),n(83937),n(55601)),i=n(74826),a=n(504),u=n(24848),c=n(83014),s=(n(24418),n(11706),n(99791),n(1897),n(60216),n(85913),n(10470),n(42116),n(24098),n(83348)),l=(n(2168),n(57348),n(48709),n(8614),n(87974),n(52121),n(64569),n(48425),n(16499),n(20349),n(8790),n(76101),n(74897));n(12673),n(8438)},55601:function(e,t,n){"use strict";n.d(t,{d:function(){return d}}),n(68309),n(19601),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(90140),o=n(83937),i=n(37526);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(){return c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=s(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},c.apply(this,arguments)}function s(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}function l(e,t){return l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},l(e,t)}function f(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(s,e);var t,n,r,o,a=(r=s,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=p(r);if(o){var n=p(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return f(this,e)});function s(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),a.call(this,e,t)}return t=s,(n=[{key:"getType",value:function(){return s.TypeRTTI}},{key:"createRenderObject",value:function(){var e=new THREE.Color(this.mColor).getHex(),t=this.mIntensity,n=new THREE.AmbientLight(e,t);return n.name="Ambient Light",n.position.copy(this.mPosition.clone()),new i.m(n,this)}},{key:"serialize",value:function(e){return Object.assign(c(p(s.prototype),"serialize",this).call(this,e),{type:"ambientLight"})}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),s}(o.J);d.TypeRTTI=new r.r("LightEntityAmbient",o.J.TypeRTTI)},74826:function(e,t,n){"use strict";n.d(t,{C:function(){return h}}),n(54678),n(19601),n(68309),n(92222),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(90140),o=n(83937),i=n(50409),a=n(89539);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(){return s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=l(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},s.apply(this,arguments)}function l(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}function f(e,t){return f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},f(e,t)}function p(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(l,e);var t,n,r,o,u=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=d(r);if(o){var n=d(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return p(this,e)});function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=u.call(this,e,t)).mTarget=new THREE.Vector3,n}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}},{key:"setValue",value:function(e,t){switch(e){case"target":return this.mTarget=t.clone(),!0;case"target_x":return this.mTarget.x=parseFloat(t),!0;case"target_y":return this.mTarget.y=parseFloat(t),!0;case"target_z":return this.mTarget.z=parseFloat(t),!0}return s(d(l.prototype),"setValue",this).call(this,e,t)}},{key:"getValue",value:function(e){var t=s(d(l.prototype),"getValue",this).call(this,e);if(null!==t)return t;switch(e){case"target":return this.mTarget;case"target_x":return this.mTarget.x;case"target_y":return this.mTarget.y;case"target_z":return this.mTarget.z}return null}},{key:"serialize",value:function(e){var t=Object.assign(s(d(l.prototype),"serialize",this).call(this,e),{type:"directionalLight"});return t.properties=Object.assign(t.properties,{target_x:this.mTarget.x,target_y:this.mTarget.y,target_z:this.mTarget.z}),t}},{key:"createRenderObject",value:function(){var e=new THREE.Color(this.mColor),t=e.getHex(),n=this.mIntensity,r=new THREE.Object3D;r.position.copy(this.mTarget.clone());var o=this.getRenderState().getFromGarbage(this.getGarbageHash());return(0,a.isNullOrUndefined)(o)?o=new THREE.DirectionalLight(t,n):(o.intensity=n,o.color=e,o.needsUpdate=!0),o.name="Directional Light",o.target=r,o.position.copy(this.mPosition.clone()),o.castShadow=this.mCastShadow,o.shadow.mapSize.width=1024,o.shadow.mapSize.height=1024,o.shadow.bias=this.getValue("shadow_bias"),o.shadow.camera.near=this.getValue("shadow_camera_near"),o.shadow.camera.far=this.getValue("shadow_camera_far"),new i.Q(o,this)}},{key:"getGarbageHash",value:function(){return"".concat(this.getType().getTypeName(),"/").concat(this.mCastShadow)}},{key:"getGarbageTime",value:function(){return 500}}])&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(o.J);h.TypeRTTI=new r.r("LightEntityDirectional",o.J.TypeRTTI)},504:function(e,t,n){"use strict";n.d(t,{v:function(){return h}}),n(19601),n(68309),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(90140),o=n(83937),i=n(37526),a=n(89539);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(){return s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=l(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},s.apply(this,arguments)}function l(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}function f(e,t){return f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},f(e,t)}function p(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(l,e);var t,n,r,o,u=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=d(r);if(o){var n=d(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return p(this,e)});function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=u.call(this,e,t)).mGroundColor="#ffffff",n}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}},{key:"setValue",value:function(e,t){return"light_groundColor"===e?((0,a.isUndefined)(t.isColor)?this.mGroundColor=t:this.mGroundColor="#"+t.getHexString(),!0):s(d(l.prototype),"setValue",this).call(this,e,t)}},{key:"getValue",value:function(e){var t=s(d(l.prototype),"getValue",this).call(this,e);return null!==t?t:"light_groundColor"===e?new THREE.Color(this.mGroundColor):null}},{key:"serialize",value:function(e){var t=Object.assign(s(d(l.prototype),"serialize",this).call(this,e),{type:"hemisphereLight"});return t.properties=Object.assign(t.properties,{light_groundColor:"#"+new THREE.Color(this.mGroundColor).getHexString()}),t}},{key:"createRenderObject",value:function(){var e=new THREE.Color(this.mColor).getHex(),t=new THREE.Color(this.mGroundColor).getHex(),n=this.mIntensity,r=new THREE.HemisphereLight(e,t,n);return r.name="Hemisphere Light",r.position.copy(this.mPosition.clone()),new i.m(r,this)}}])&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(o.J);h.TypeRTTI=new r.r("LightEntityHemisphere",o.J.TypeRTTI)},24848:function(e,t,n){"use strict";n.d(t,{m:function(){return h}}),n(54678),n(19601),n(68309),n(92222),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(90140),o=n(83937),i=n(37526),a=n(89539);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(){return s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=l(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},s.apply(this,arguments)}function l(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}function f(e,t){return f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},f(e,t)}function p(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(l,e);var t,n,r,o,u=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=d(r);if(o){var n=d(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return p(this,e)});function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=u.call(this,e,t)).mDistance=0,n.mDecay=1,n}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}},{key:"setValue",value:function(e,t){switch(e){case"light_distance":return this.mDistance=parseFloat(t),!0;case"light_decay":return this.mDecay=parseFloat(t),!0}return s(d(l.prototype),"setValue",this).call(this,e,t)}},{key:"getValue",value:function(e){var t=s(d(l.prototype),"getValue",this).call(this,e);if(null!==t)return t;switch(e){case"light_distance":return this.mDistance;case"light_decay":return this.mDecay}return null}},{key:"serialize",value:function(e){var t=Object.assign(s(d(l.prototype),"serialize",this).call(this,e),{type:"pointLight"});return t.properties=Object.assign(t.properties,{light_distance:this.mDistance,light_decay:this.mDecay}),t}},{key:"createRenderObject",value:function(){var e=new THREE.Color(this.mColor),t=e.getHex(),n=this.mIntensity,r=this.mDistance,o=this.mDecay,u=this.getRenderState().getFromGarbage(this.getGarbageHash());return(0,a.isNullOrUndefined)(u)?u=new THREE.PointLight(t,n,r,o):(u.intensity=n,u.decay=o,u.distance=r,u.color=e,u.needsUpdate=!0),u.name="Point Light",u.position.copy(this.mPosition.clone()),u.castShadow=this.mCastShadow,u.shadow.bias=this.getValue("shadow_bias"),u.shadow.camera.near=this.getValue("shadow_camera_near"),u.shadow.camera.far=this.getValue("shadow_camera_far"),new i.m(u,this)}},{key:"getGarbageHash",value:function(){return"".concat(this.getType().getTypeName(),"/").concat(this.mCastShadow)}},{key:"getGarbageTime",value:function(){return 500}}])&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(o.J);h.TypeRTTI=new r.r("LightEntityPoint",o.J.TypeRTTI)},83014:function(e,t,n){"use strict";n.d(t,{p:function(){return h}}),n(54678),n(19601),n(68309),n(92222),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(90140),o=n(83937),i=n(50409),a=n(89539);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(){return s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=l(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},s.apply(this,arguments)}function l(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}function f(e,t){return f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},f(e,t)}function p(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(l,e);var t,n,r,o,u=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=d(r);if(o){var n=d(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return p(this,e)});function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=u.call(this,e,t)).mDistance=0,n.mAngle=.1*Math.PI,n.mPenumbra=0,n.mDecay=1,n.mTarget=new THREE.Vector3,n}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}},{key:"setValue",value:function(e,t){switch(e){case"light_distance":return this.mDistance=parseFloat(t),!0;case"light_angle":return this.mAngle=parseFloat(t),!0;case"light_penumbra":return this.mPenumbra=parseFloat(t),!0;case"light_decay":return this.mDecay=parseFloat(t),!0;case"target":return this.mTarget=t.clone(),!0;case"target_x":return this.mTarget.x=parseFloat(t),!0;case"target_y":return this.mTarget.y=parseFloat(t),!0;case"target_z":return this.mTarget.z=parseFloat(t),!0}return s(d(l.prototype),"setValue",this).call(this,e,t)}},{key:"getValue",value:function(e){var t=s(d(l.prototype),"getValue",this).call(this,e);if(null!==t)return t;switch(e){case"light_distance":return this.mDistance;case"light_angle":return this.mAngle;case"light_penumbra":return this.mPenumbra;case"light_decay":return this.mDecay;case"target":return this.mTarget;case"target_x":return this.mTarget.x;case"target_y":return this.mTarget.y;case"target_z":return this.mTarget.z}return null}},{key:"serialize",value:function(e){var t=Object.assign(s(d(l.prototype),"serialize",this).call(this,e),{type:"spotLight"});return t.properties=Object.assign(t.properties,{light_distance:this.mDistance,light_angle:this.mAngle,light_penumbra:this.mPenumbra,light_decay:this.mDecay,target_x:this.mTarget.x,target_y:this.mTarget.y,target_z:this.mTarget.z}),t}},{key:"createRenderObject",value:function(){var e=new THREE.Color(this.mColor),t=e.getHex(),n=this.mIntensity,r=this.mDistance,o=this.mAngle,u=this.mPenumbra,c=this.mDecay,s=new THREE.Object3D;s.position.copy(this.mTarget.clone());var l=this.getRenderState().getFromGarbage(this.getGarbageHash());return(0,a.isNullOrUndefined)(l)?((l=new THREE.SpotLight(t,n,r,o,u,c)).shadow.mapSize.width=1024,l.shadow.mapSize.height=1024):(l.angle=o,l.decay=c,l.penumbra=u,l.distance=r,l.intensity=n,l.color=e,l.needsUpdate=!0),l.name="Spot Light",l.target=s,l.position.copy(this.mPosition.clone()),l.castShadow=this.mCastShadow,l.shadow.bias=this.getValue("shadow_bias"),l.shadow.camera.near=this.getValue("shadow_camera_near"),l.shadow.camera.far=this.getValue("shadow_camera_far"),new i.Q(l,this)}},{key:"getGarbageHash",value:function(){return"".concat(this.getType().getTypeName(),"/").concat(this.mCastShadow)}},{key:"getGarbageTime",value:function(){return 500}}])&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(o.J);h.TypeRTTI=new r.r("LightEntitySpot",o.J.TypeRTTI)},83937:function(e,t,n){"use strict";n.d(t,{J:function(){return d}}),n(19601),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(80353),o=n(90140),i=n(89539);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(){return c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=s(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},c.apply(this,arguments)}function s(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}function l(e,t){return l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},l(e,t)}function f(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(s,e);var t,n,r,o,a=(r=s,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=p(r);if(o){var n=p(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return f(this,e)});function s(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(n=a.call(this,e,t)).mColor="#ffffff",n.mIntensity=1,n.mShadowBias=0,n.mShadowCameraNear=.1,n.mShadowCameraFar=500,n}return t=s,(n=[{key:"getType",value:function(){return s.TypeRTTI}},{key:"setValue",value:function(e,t){switch(e){case"light_color":return(0,i.isUndefined)(t.isColor)?this.mColor=t:this.mColor="#"+t.getHexString(),!0;case"light_intensity":return this.mIntensity=t,!0;case"shadow_bias":return this.mShadowBias=t,!0;case"shadow_camera_near":return this.mShadowCameraNear=t,!0;case"shadow_camera_far":return this.mShadowCameraFar=t,!0}return c(p(s.prototype),"setValue",this).call(this,e,t)}},{key:"getValue",value:function(e){var t=c(p(s.prototype),"getValue",this).call(this,e);if(null!==t)return t;switch(e){case"light_color":return new THREE.Color(this.mColor);case"light_intensity":return this.mIntensity;case"shadow_bias":return this.mShadowBias;case"shadow_camera_near":return this.mShadowCameraNear;case"shadow_camera_far":return this.mShadowCameraFar}return null}},{key:"serialize",value:function(e){var t=c(p(s.prototype),"serialize",this).call(this,e);return t.properties=Object.assign(t.properties,{light_color:"#"+new THREE.Color(this.mColor).getHexString(),light_intensity:this.mIntensity,shadow_bias:this.mShadowBias,shadow_camera_near:this.mShadowCameraNear,shadow_camera_far:this.mShadowCameraFar}),t}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),s}(r.u);d.TypeRTTI=new o.r("LightEntity",r.u.TypeRTTI)},11706:function(e,t,n){"use strict";n.d(t,{Y:function(){return y}}),n(91058),n(68309),n(19601),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(90140),o=n(37526),i=n(24418),a=n(89539),u=n(9418);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(){return l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=f(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},l.apply(this,arguments)}function f(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}function p(e,t){return p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},p(e,t)}function d(e,t){if(t&&("object"===c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(f,e);var t,n,r,i,c=(r=f,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(r);if(i){var n=h(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return d(this,e)});function f(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(n=c.call(this,e,t)).mModelGroup=null,n}return t=f,(n=[{key:"getType",value:function(){return f.TypeRTTI}},{key:"setValue",value:function(e,t){return"model_id"===e?(this.mModelId=parseInt(t,10),!0):l(h(f.prototype),"setValue",this).call(this,e,t)}},{key:"getValue",value:function(e){var t=l(h(f.prototype),"getValue",this).call(this,e);return null!==t?t:"model_id"===e?this.mModelId:null}},{key:"createBuildProcess",value:function(){return new u.q}},{key:"_onModelManagerLoaded",value:function(e){this.mModelManager=e}},{key:"createRenderObject",value:function(){var e=this,t=this.mModelManager.getModel(this.mModelId);return this.mModelGroup=this.mModelManager.resolveModelById(this.mModelId,(function(t){t.traverse((function(e){if(!0===e.isMesh||!0===e.isSkinnedMesh){var t=!0;(0,a.isUndefined)(e.material)||(t=e.material.opacity>.99),e.castShadow=t}})),e.hasRenderObject()&&e.getRenderObject().setNodesUpdated()})),this.mModelGroup.name=t.Name,this.mModelGroup.castShadow=this.mCastShadow,this.mModelGroup.receiveShadow=this.mReceiveShadow,this.mModelGroup.position.copy(this.mPosition),this.mModelGroup.rotation.copy(this.mRotation),this.mModelGroup.scale.copy(this.mScale),new o.m(this.mModelGroup,this)}},{key:"deinitRenderObject",value:function(){this.hasRenderObject()&&(this.getRenderObject().autoDisposeGeometry=!1),null!==this.mModelGroup&&(this.mModelManager.disposeModel(this.mModelGroup),this.mModelGroup=null),l(h(f.prototype),"deinitRenderObject",this).call(this)}},{key:"serialize",value:function(e){return Object.assign(l(h(f.prototype),"serialize",this).call(this,e),{type:"meshModel",model_id:this.mModelId})}}])&&s(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(i.l);y.TypeRTTI=new r.r("MeshEntityModel",i.l.TypeRTTI)},24418:function(e,t,n){"use strict";n.d(t,{l:function(){return l}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(80353),o=n(90140);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function c(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(l,e);var t,n,r,o,i=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=s(r);if(o){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return c(this,e)});function l(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),i.call(this,e,t)}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r.u);l.TypeRTTI=new o.r("MeshEntity",r.u.TypeRTTI)},1897:function(e,t,n){"use strict";n.d(t,{X:function(){return d}}),n(68309),n(19601),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(99791),o=n(90140),i=n(37526);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(){return c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=s(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},c.apply(this,arguments)}function s(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}function l(e,t){return l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},l(e,t)}function f(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(s,e);var t,n,r,o,a=(r=s,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=p(r);if(o){var n=p(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return f(this,e)});function s(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),a.call(this,e,t)}return t=s,(n=[{key:"getType",value:function(){return s.TypeRTTI}},{key:"createRenderObject",value:function(){var e=new THREE.BoxBufferGeometry(1,1,1),t=new THREE.Mesh(e,new THREE.MeshStandardMaterial);return t.name="Box",t.castShadow=this.mCastShadow,t.receiveShadow=this.mReceiveShadow,t.position.copy(this.mPosition),t.rotation.copy(this.mRotation),t.scale.copy(this.mScale),new i.m(t,this)}},{key:"serialize",value:function(e){return Object.assign(c(p(s.prototype),"serialize",this).call(this,e),{type:"box"})}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),s}(r.D);d.TypeRTTI=new o.r("PrimitiveEntityBox",r.D.TypeRTTI)},60216:function(e,t,n){"use strict";n.d(t,{j:function(){return b}}),n(54678),n(91058),n(41539),n(39714),n(19601),n(60086),n(21249),n(57640),n(9924),n(68309),n(88674),n(66342),n(62962),n(2490),n(23748),n(38862),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(99791),o=n(90140),i=n(37526),a=n(89539),u=n(35572),c=n(23937),s=n(41142),l=n(68009);function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(){return d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=h(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},d.apply(this,arguments)}function h(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=v(e)););return e}function y(e,t){return y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},y(e,t)}function m(e,t){if(t&&("object"===f(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(h,e);var t,n,r,o,f=(r=h,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=v(r);if(o){var n=v(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return m(this,e)});function h(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),(n=f.call(this,e,t)).mPointA=new THREE.Vector3,n.mPointB=new THREE.Vector3,n.mSpriteOffset=new THREE.Vector3,n.mMarkerA=null,n.mMarkerB=null,n.mMarkerMaterial=null,n.mLineMaterial=null,n.mLineMesh=null,n.mLineGeometry=null,n.mLineColor="000000",n.mMeshLine=null,n.mResolution=new THREE.Vector2,n.mTitle=null,n.mLabel={},n.mSpriteNode=null,n.onBeforeRender=function(e){n._updateMaterial(e.renderer,e.camera,e.scene)},n.setValue("label",{}),n}return t=h,n=[{key:"getType",value:function(){return h.TypeRTTI}},{key:"setValue",value:function(e,t){switch(e){case"point_a":return t.isVector3?this.mPointA.copy(t):(0,a.isArray)(t)&&this.mPointA.fromArray(t),this.updateLine(),!0;case"point_b":return t.isVector3?this.mPointB.copy(t):(0,a.isArray)(t)&&this.mPointB.fromArray(t),this.updateLine(),!0;case"point_a_x":return this.mPointA.setX(parseFloat(t)),this.updateLine(),!0;case"point_a_y":return this.mPointA.setY(parseFloat(t)),this.updateLine(),!0;case"point_a_z":return this.mPointA.setZ(parseFloat(t)),this.updateLine(),!0;case"point_b_x":return this.mPointB.setX(parseFloat(t)),this.updateLine(),!0;case"point_b_y":return this.mPointB.setY(parseFloat(t)),this.updateLine(),!0;case"point_b_z":return this.mPointB.setZ(parseFloat(t)),this.updateLine(),!0;case"inv_point_a":return this.setWorldPosition(t,this.mPointA),this.updateLine(),!0;case"inv_point_b":return this.setWorldPosition(t,this.mPointB),this.updateLine(),!0;case"sprite_offset":return t.isVector3?this.mSpriteOffset.copy(t):(0,a.isArray)(t)&&this.mSpriteOffset.fromArray(t),this.updateLine(),!0;case"inv_sprite_offset":return this.setOffsetPosition(t),this.updateLine(),!0;case"line_color":return(0,a.isUndefined)(t.isColor)?this.mLineColor=t:this.mLineColor="#"+t.getHexString(),this.updateLine(),!0;case"color":return(0,a.isUndefined)(t.isColor)?this.mLabel.color=t:this.mLabel.color="#"+t.getHexString(),this.updateText(),!0;case"fontSize":return this.mLabel.fontSize=parseInt(t,10),this.updateText(),!0;case"spriteScale":return this.mLabel.spriteScale=parseFloat(t),this.updateText(),!0;case"title":var n="";try{n=t.toString()}catch(e){}return this.mTitle=n,this.mLabel.title=n,this.updateText(),!0;case"label":try{var r;r=(0,a.isString)(t)?JSON.parse(t):t,this.mLabel=Object.assign({title:this.mTitle||"title",margin:0,color:"#0b0004",fontSize:32,spriteScale:1},r),this.updateText()}catch(e){return!1}return!0}return d(v(h.prototype),"setValue",this).call(this,e,t)}},{key:"getValue",value:function(e){var t=d(v(h.prototype),"getValue",this).call(this,e);if(null!==t)return t;switch(e){case"point_a":return this.mPointA;case"point_b":return this.mPointB;case"point_a_x":return this.mPointA.x;case"point_a_y":return this.mPointA.y;case"point_a_z":return this.mPointA.z;case"point_b_x":return this.mPointB.x;case"point_b_y":return this.mPointB.y;case"point_b_z":return this.mPointB.z;case"marker_point_a":return this.mMarkerA;case"marker_point_b":return this.mMarkerB;case"sprite_offset":return this.mSpriteOffset;case"line_color":return new THREE.Color(this.mLineColor);case"title":return this.mLabel.title;case"color":return new THREE.Color(this.mLabel.color);case"fontSize":return this.mLabel.fontSize;case"spriteScale":return this.mLabel.spriteScale;case"label":return this.mLabel}return null}},{key:"setWorldPosition",value:function(e,t){var n=new THREE.Matrix4;this.mLineMesh.parent&&n.getInverse(this.mLineMesh.parent.matrixWorld),e.applyMatrix4(n),t.copy(e)}},{key:"setOffsetPosition",value:function(e){var t=this._getSpritePosition(!1);this.mSpriteOffset.copy(e.sub(t))}},{key:"updateLine",value:function(){if(null!==this.mLineMesh){s.qL.print("update point a: ",this.mPointA),s.qL.print("update point b: ",this.mPointB),this.mLineGeometry.vertices[0].copy(this.mPointA),this.mLineGeometry.vertices[1].copy(this.mPointB),this.mMeshLine.setGeometry(this.mLineGeometry,(function(){return 1}));var e=this.mMeshLine.geometry;this.mLineMesh.geometry.dispose(),this.mLineMesh.geometry=e,this.mLineMesh.geometry.computeBoundingSphere(),this.mLineMesh.updateMatrix(),this.mMarkerA.position.copy(this.mPointA),this.mMarkerB.position.copy(this.mPointB),(0,a.isNullOrUndefined)(this.mLineMaterial)||(this.mLineMaterial.color=this.getValue("line_color"),this.mLineMaterial.needsUpdate=!0),(0,a.isNullOrUndefined)(this.mMarkerMaterial)||(this.mMarkerMaterial.color=this.getValue("line_color"),this.mMarkerMaterial.needsUpdate=!0),null!==this.mSpriteNode&&this.mSpriteNode.position.copy(this._getSpritePosition())}}},{key:"updateText",value:function(){if(null!==this.mLineMesh)if(!(0,a.isNullOrUndefined)(this.mLabel.title)&&this.mLabel.title.length>0){if(null===this.mSpriteNode)this.mSpriteNode=this._makeSpriteNode(),this.mLineMesh.parent&&this.mLineMesh.parent.add(this.mSpriteNode);else{this.mSpriteNode.material.map.text=this.mLabel.title,this.mSpriteNode.material.map.fontSize=this.getValue("fontSize"),this.mSpriteNode.material.color=this.getValue("color"),this.mSpriteNode.material.map&&"function"==typeof this.mSpriteNode.material.map.redraw&&this.mSpriteNode.material.map.redraw();var e=1;!(0,a.isNullOrUndefined)(this.mSpriteNode.material.map)&&l.F.isNumeric(this.mSpriteNode.material.map.image.height)&&(e=this.mSpriteNode.material.map.image.width/this.mSpriteNode.material.map.image.height),this.mSpriteNode.scale.setX(e).setY(1).multiplyScalar(.05*this.getValue("spriteScale")),this.mSpriteNode.updateMatrixWorld()}this.mSpriteNode.position.copy(this._getSpritePosition())}else null!==this.mSpriteNode&&(this.mSpriteNode.material.map.dispose(),this.mSpriteNode.material.dispose(),this.mSpriteNode.parent.remove(this.mSpriteNode),this.mSpriteNode=null)}},{key:"_updateMaterial",value:function(e,t,n){if(this.hasRenderObject()&&null!==this.mLineMaterial){var r=e,o=new THREE.Vector2;if(r.getSize(o),o.distanceTo(this.mResolution)>.001){this.mResolution.copy(o),this.mLineMaterial.uniforms.resolution.value.copy(this.mResolution);var i=t;this.mLineMaterial.uniforms.near=i.near,this.mLineMaterial.uniforms.far=i.far,this.mLineMaterial.needsUpdate=!0,this.getRenderState().requestFrame()}}}},{key:"_getSpritePosition",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.mPointA.clone().add(this.mPointB.clone().sub(this.mPointA).normalize().multiplyScalar(.5*this.mPointB.distanceTo(this.mPointA))).add(e?this.mSpriteOffset:new THREE.Vector3)}},{key:"_makeSpriteNode",value:function(){var e=new THREE.TextTexture({align:"center",fillStyle:"#ffffff",fontFamily:"Arial, Helvetica, sans-serif",fontSize:this.getValue("fontSize"),fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",lineGap:.15,padding:.25,strokeStyle:"#ffffff",strokeWidth:0,text:this.mLabel.title}),t=new THREE.SpriteMaterial({map:e,color:this.getValue("color"),transparent:!0,depthTest:!0}),n=new THREE.Sprite(t);e.redraw();var r=1;!(0,a.isNullOrUndefined)(e.image)&&l.F.isNumeric(e.image.height)&&(r=e.image.width/e.image.height);var o=this.getValue("spriteScale");return n.scale.setX(r).multiplyScalar(.05*o),n.userData.sceneObjectRef=this,n.userData.transforms=new c.Q("inv_sprite_offset"),n}},{key:"createRenderObject",value:function(){var e=new THREE.Group;return this.mMarkerMaterial=new THREE.MeshBasicMaterial({color:this.getValue("line_color"),depthTest:!0,depthWrite:!0}),this.mMarkerA=new THREE.Mesh(new THREE.SphereGeometry(.006,16,16),this.mMarkerMaterial),this.mMarkerA.name="$__xpv_line_marker_a",this.mMarkerA.position.copy(this.mPointA),this.mMarkerB=this.mMarkerA.clone(),this.mMarkerB.name="$__xpv_line_marker_b",this.mMarkerB.position.copy(this.mPointB),this.mMarkerA.userData.sceneObjectRef=this,this.mMarkerB.userData.sceneObjectRef=this,this.mMarkerA.userData.transforms=new c.Q("point_a"),this.mMarkerB.userData.transforms=new c.Q("point_b"),e.add(this.mMarkerA),e.add(this.mMarkerB),this.mLineGeometry=new THREE.Geometry,this.mLineGeometry.vertices.push(this.mPointA),this.mLineGeometry.vertices.push(this.mPointB),this.mMeshLine=new MeshLine,this.mMeshLine.setGeometry(this.mLineGeometry,(function(){return 1})),this.mLineMaterial=new MeshLineMaterial({color:this.getValue("line_color"),sizeAttenuation:1,lineWidth:.005,transparent:!0,depthWrite:!0,side:THREE.DoubleSide}),this.mLineMesh=new THREE.Mesh(this.mMeshLine.geometry,this.mLineMaterial),this.mLineMesh.name="$__xpv_line",e.add(this.mLineMesh),!(0,a.isNullOrUndefined)(this.mLabel.title)&&this.mLabel.title.length>0&&(this.mSpriteNode=this._makeSpriteNode(),this.mSpriteNode.position.copy(this._getSpritePosition()),e.add(this.mSpriteNode)),e.castShadow=this.mCastShadow,e.receiveShadow=this.mReceiveShadow,e.position.copy(this.mPosition),e.scale.copy(this.mScale),this.registerMessageHandler(u.V.TypeRTTI,this.onBeforeRender),new i.m(e,this)}},{key:"deinitRenderObject",value:function(){this.hasRenderObject()&&(this.mMarkerA.geometry.dispose(),this.mMarkerB.geometry.dispose(),this.mLineGeometry.dispose(),this.mLineMesh.geometry.dispose(),this.mLineMaterial.dispose(),this.mMarkerMaterial.dispose(),null!==this.mSpriteNode&&this.mSpriteNode.material.dispose(),delete this.mMarkerA.userData.transforms,delete this.mMarkerA.userData.transforms,this.unregisterMessageHandler(u.V.TypeRTTI)),this.mMarkerA=this.mMarkerB=this.mLineMesh=this.mMeshLine=this.mLineGeometry=this.mSpriteNode=null,d(v(h.prototype),"deinitRenderObject",this).call(this)}},{key:"serialize",value:function(e){var t=Object.assign(d(v(h.prototype),"serialize",this).call(this,e),{type:"line"});return t.properties=Object.assign(t.properties,{point_a:this.mPointA.toArray(),point_b:this.mPointB.toArray(),sprite_offset:this.mSpriteOffset.toArray(),line_color:"#"+new THREE.Color(this.mLineColor).getHexString(),label:JSON.stringify({title:this.mLabel.title,color:"#"+new THREE.Color(this.mLabel.color).getHexString(),fontSize:this.mLabel.fontSize,spriteScale:this.mLabel.spriteScale})}),t}}],n&&p(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),h}(r.D);b.TypeRTTI=new o.r("PrimitiveEntityLine",r.D.TypeRTTI)},85913:function(e,t,n){"use strict";n.d(t,{N:function(){return h}}),n(68309),n(19601),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(99791),o=n(90140),i=n(37526),a=n(89539);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(){return s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=l(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},s.apply(this,arguments)}function l(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}function f(e,t){return f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},f(e,t)}function p(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(l,e);var t,n,r,o,u=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=d(r);if(o){var n=d(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return p(this,e)});function l(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),u.call(this,e,t)}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}},{key:"createRenderObject",value:function(){var e=new THREE.PlaneBufferGeometry(2,2),t=new THREE.Mesh(e,new THREE.MeshPhongMaterial({color:15987699}));return t.name="Plane",t.castShadow=this.mCastShadow,t.receiveShadow=this.mReceiveShadow,t.position.copy(this.mPosition),t.rotation.copy(this.mRotation),t.scale.copy(this.mScale),t.layers.enable(3),t.onBeforeRender=function(e,t,n,r,o,i){if(!(0,a.isNullOrUndefined)(o)&&!0===o.isShaderMaterial&&!(0,a.isNullOrUndefined)(o.uniforms.ssreflection)){o.uniforms.ssreflection.value=1;var u=o.program;(0,a.isUndefined)(u)||u.getUniforms().setValue(e.getContext(),"ssreflection",1)}},t.onAfterRender=function(e,t,n,r,o,i){if(!(0,a.isNullOrUndefined)(o)&&!0===o.isShaderMaterial&&!(0,a.isNullOrUndefined)(o.uniforms.ssreflection)){o.uniforms.ssreflection.value=0;var u=o.program;(0,a.isUndefined)(u)||u.getUniforms().setValue(e.getContext(),"ssreflection",0)}},new i.m(t,this)}},{key:"serialize",value:function(e){return Object.assign(s(d(l.prototype),"serialize",this).call(this,e),{type:"plane"})}}])&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r.D);h.TypeRTTI=new o.r("PrimitiveEntityPlane",r.D.TypeRTTI)},10470:function(e,t,n){"use strict";n.d(t,{f:function(){return h}}),n(68309),n(19601),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(99791),o=n(90140),i=n(37526),a=n(41142);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(){return s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=l(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},s.apply(this,arguments)}function l(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}function f(e,t){return f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},f(e,t)}function p(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(l,e);var t,n,r,o,u=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=d(r);if(o){var n=d(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return p(this,e)});function l(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),u.call(this,e,t)}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}},{key:"createRenderObject",value:function(){var e=new THREE.SphereBufferGeometry(1),t=new THREE.Mesh(e,new THREE.MeshStandardMaterial);return t.name="Sphere",t.castShadow=this.mCastShadow,t.receiveShadow=this.mReceiveShadow,a.qL.print("sphere pos:",this.mPosition),t.position.copy(this.mPosition),t.rotation.copy(this.mRotation),t.scale.copy(this.mScale),new i.m(t,this)}},{key:"serialize",value:function(e){return Object.assign(s(d(l.prototype),"serialize",this).call(this,e),{type:"sphere"})}}])&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r.D);h.TypeRTTI=new o.r("PrimitiveEntitySphere",r.D.TypeRTTI)},42116:function(e,t,n){"use strict";n.d(t,{Y:function(){return h}}),n(19601),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(99791),o=n(90140),i=n(37526),a=n(14433);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(){return s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=l(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},s.apply(this,arguments)}function l(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}function f(e,t){return f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},f(e,t)}function p(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(l,e);var t,n,r,o,u=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=d(r);if(o){var n=d(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return p(this,e)});function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=u.call(this,e,t)).mTextTexture=null,n.mSpriteMaterial=null,n}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}},{key:"createRenderObject",value:function(){this.mSpriteMaterial=new THREE.SpriteMaterial({map:this.mTextTexture,color:16777215});var e=new THREE.Sprite(this.mSpriteMaterial);return new i.m(e,this)}},{key:"createBuildProcess",value:function(){return new a.i("Hello world!")}},{key:"_setCanvasText",value:function(e){this.mTextTexture=new THREE.Texture(e),this.mTextTexture.needsUpdate=!0}},{key:"deinitRenderObject",value:function(){null!==this.mTextTexture&&(this.mTextTexture.dispose(),this.mTextTexture=null),null!==this.mSpriteMaterial&&(this.mSpriteMaterial.dispose(),this.mSpriteMaterial=null),s(d(l.prototype),"deinitRenderObject",this).call(this)}},{key:"serialize",value:function(e){return Object.assign(s(d(l.prototype),"serialize",this).call(this,e),{type:"text"})}}])&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r.D);h.TypeRTTI=new o.r("PrimitiveEntityText",r.D.TypeRTTI)},99791:function(e,t,n){"use strict";n.d(t,{D:function(){return l}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(80353),o=n(90140);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function c(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(l,e);var t,n,r,o,i=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=s(r);if(o){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return c(this,e)});function l(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),i.call(this,e,t)}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r.u);l.TypeRTTI=new o.r("PrimitiveEntity",r.u.TypeRTTI)},83348:function(e,t,n){"use strict";n.d(t,{L:function(){return R}}),n(35666),n(41539),n(15581),n(2490),n(34514),n(54747),n(40561),n(34553),n(68309),n(19601),n(9653),n(47941),n(92222),n(57327),n(88449),n(59849),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(88674),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(67988),o=n(90140),i=n(50762),a=n(24098),u=n(70456),c=n(89539),s=n(60603),l=n(37852),f=n(41142),p=n(85715),d=n(14311),h=n(94498);function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function m(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(){return g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=w(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},g.apply(this,arguments)}function w(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=T(e)););return e}function _(e,t){return _=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},_(e,t)}function O(e,t){if(t&&("object"===y(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function T(e){return T=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},T(e)}var R=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_(e,t)}(S,e);var t,n,r,o,y,w,R=(y=S,w=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=T(y);if(w){var n=T(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return O(this,e)});function S(e,t,n){var r,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return v(this,S),(r=R.call(this,e,t)).mHashHelper=new i.L,r.mProductIdChanged=!1,r.mSubscriptions=[],r.onConfigurableNodeReady=new u.t(1),r.mSharedKeyOverwrite={},r._handleOptionsChanged=function(e){null!==r.getRenderObject()&&(r.getRenderObject().needsUpdate=!0)},r._handleArticlesChanged=function(e){r.getRenderState().dispatchAppEvent(d.G.ProductArticlesChanged,e)},(0,c.isNullOrUndefined)(n)||(r.mProductId=n),r.mIsBundled=o,r.mPreconfiguredOptions=a,r.registerMessageHandler(h.u.TypeRTTI,(function(e){r.mSceneObjectId===e.sceneObjectId&&(r.mSharedKeyOverwrite[e.materialModelId]=e.sceneObjectId,r.isConfigurableNodeLoaded()&&r._resolveConfigurableNode().notifyMaterialOverwrite(e.materialModelId,e.sceneObjectId),r.dispatchMessageToComponents(e))})),r}return t=S,n=[{key:"getType",value:function(){return S.TypeRTTI}},{key:"dispose",value:function(){this.unregisterMessageHandler(h.u.TypeRTTI),this.mSubscriptions.splice(0).forEach((function(e){return e.subscription.unsubscribe()}))}},{key:"onBeforeParseChildren",value:function(){return!1}},{key:"onBeforeSerializeChildren",value:function(){return!1}},{key:"onBeforeParseCreate",value:function(e){return"product"!==e&&"reference_product"!==e||!this.mIsBundled}},{key:"addComponent",value:function(e){var t=g(T(S.prototype),"addComponent",this).call(this,e);if(t){var n;switch(e.getComponentName()){case"attributeManager":n=e.onAttributeChanged.subscribe(this._handleOptionsChanged);break;case"articleListManager":n=e.onModelsChanged.subscribe(this._handleArticlesChanged)}void 0!==n&&this.mSubscriptions.push({name:e.getComponentName(),subscription:n})}return t}},{key:"removeComponent",value:function(e){var t=g(T(S.prototype),"removeComponent",this).call(this,e);if(t){var n=this.mSubscriptions.findIndex((function(t){return t.name===e}));n>=0&&this.mSubscriptions.splice(n,1).forEach((function(e){return e.subscription.unsubscribe()}))}return t}},{key:"serialize",value:function(e,t){var n=Object.assign(g(T(S.prototype),"serialize",this).call(this,e,t),{type:"product"});return n.properties=Object.assign(n.properties,{product_id:this.mProductId}),n}},{key:"setValue",value:function(e,t){switch(e){case"product_id":return this.mProductId=Number(t),this.mProductIdChanged=!0,this.dispatchMessageToComponents(new p.X("product_id",this.mProductId)),!0;case"temporary_uid":return this.mTemporaryUId=t,!0;case"placeHolder":case"place_holder":return this.mFuncLoaderPlaceHolder=t,!0;case"clipping_plane":if((0,c.isNullOrUndefined)(t))this.mClippingPlane=null;else if((0,c.isString)(t))try{var n=JSON.parse(t);this.mClippingPlane=(new THREE.Plane).setFromNormalAndCoplanarPoint((new THREE.Vector3).fromArray(n.normal),(new THREE.Vector3).fromArray(n.point))}catch(e){f.qL.warn("Failed to parse the set clipping value:",t),this.mClippingPlane=null}else(0,c.isFunction)(t.clone)&&(this.mClippingPlane=t.clone());return!0}return g(T(S.prototype),"setValue",this).call(this,e,t)}},{key:"getValue",value:function(e){var t=g(T(S.prototype),"getValue",this).call(this,e);if(null!==t)return t;switch(e){case"product_id":return this.mProductId;case"temporary_uid":return this.mTemporaryUId;case"place_holder":case"placeHolderFunction":return this.mFuncLoaderPlaceHolder;case"clipping_plane":return this.mClippingPlane}return null}},{key:"isBundled",value:function(){return this.mIsBundled}},{key:"createBuildProcess",value:function(){return new s.O(this.mProductId)}},{key:"_handleOnBuildReady",value:(r=regeneratorRuntime.mark((function e(t){var n,r,o,i,a,u,s,l=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,f.qL.print("Product node handel build ready!"),this.mHashHelper.newHash(),n=this.getComponent("articleListManager"),e.next=6,n.syncObjectModels(t.models);case 6:r=this._resolveSceneHierarchy(t.nodes),f.qL.print("resolved hierarchy: ",r),r=0===r.length?this._createDefaultNodes():this._checkForDefaultView(r),o={children:r},i=this.findParentOfTypeName("ProductNode"),(0,c.isNullOrUndefined)(i)&&(o.name="Product Node"),a=!this.isConfigurableNodeLoaded(),this.parse(o,this.mHashHelper.getHash(),!0),u=this._resolveConfigurableNode(),a&&Object.keys(this.mSharedKeyOverwrite).forEach((function(e){var t=Number(e);u.notifyMaterialOverwrite(t,l.mSharedKeyOverwrite[t])})),u._setPreconfiguredOptions(this.mPreconfiguredOptions),u.setMeshList(t.batches),this.onConfigurableNodeReady.next(u),(0,c.isNullOrUndefined)(this.getRenderState().getActiveViewInfo())&&(s=this.getChildrenDerivedOfTypeName("ViewNode")).length>0&&this.getRenderState()._setActiveViewId(this.getSceneObjectId(),s[0].getValue("view_id")),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(0),f.qL.error("Product node failed to read scene:",e.t0);case 25:case"end":return e.stop()}}),e,this,[[0,22]])})),o=function(){var e=this,t=arguments;return new Promise((function(n,o){var i=r.apply(e,t);function a(e){m(i,n,o,a,u,"next",e)}function u(e){m(i,n,o,a,u,"throw",e)}a(void 0)}))},function(e){return o.apply(this,arguments)})},{key:"getProductNodeNamespace",value:function(){var e="/".concat(this.getValue("product_id"),"/"),t=[];for(t.push(this.getParent());t.length>0;){var n=t.shift();if((0,c.isNullOrUndefined)(n))break;n.isDerivedTypeOf(S.TypeRTTI)&&(e="/".concat(n.getValue("product_id")).concat(e)),t.push(n.getParent())}return e}},{key:"_resolveSceneHierarchy",value:function(e){var t=this.getRenderState(),n=this.getProductNodeNamespace();return t.getNewNodes(n).forEach((function(t){e.push(t.serialize(!1))})),(e=e.filter((function(e){return!t.isNodeDeleted(n,e.scene_object_id)}))).forEach((function(e){var r=t.isNodeMoved(n,e.scene_object_id);null!==r&&(e.parent_id=-1==r?null:r)})),this._generateHierarchy(e)}},{key:"_generateHierarchy",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=[];return e.forEach((function(o){(o.parent_id==n||null===n&&o.parent_id===t.getSceneObjectId())&&(o.children=t._generateHierarchy(e,o.scene_object_id),r.push(o))})),r}},{key:"_resolveConfigurableNode",value:function(){var e,t=this.getChildrenDerivedTypeOf(a.w.TypeRTTI);return t.length>0?e=t[0]:((e=this.getRenderState().getSceneManager().createObject("configurable")).setValue("name","Configurable"),e.setValue("object_lock",!0),this.attachChildAtIndex(e,0)),f.qL.print("Configurable set service"),e.setValue("object_lock",!0),e._setServices(this.mProductId),e}},{key:"isConfigurableNodeLoaded",value:function(){return this.getChildrenDerivedTypeOf(a.w.TypeRTTI).length>0}},{key:"_checkForDefaultView",value:function(e){var t=this,n=!1,r=new Array;for(e.forEach((function(e){return r.push(e)}));!n&&r.length>0;){var o=r.shift();"view"===o.type?n=!0:void 0!==o.children&&o.children.forEach((function(e){return r.push(e)}))}if(!n){f.qL.print("create default view");var i=-++l.e.ObjectIdCount,a={type:"view",name:"Default",scene_object_id:i,children:[]},u=[a];return e.forEach((function(e){"configurable"!==e.type&&((0,c.isNullOrUndefined)(e.parent_id)||e.parent_id<0)?(e.parent_id=i,a.children.push(e),t.getRenderState().setNodeMoved(t.getProductNodeNamespace(),e.scene_object_id,i)):u.push(e)})),u}return e}},{key:"_createDefaultNodes",value:function(){return[{type:"view",name:"Default",children:[{type:"hemisphereLight",name:"Hemisphere Light",position_y:10}]}]}}],n&&b(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),S}(r.B);R.TypeRTTI=new o.r("ProductNode",r.B.TypeRTTI)},50753:function(e,t,n){"use strict";n.d(t,{n:function(){return s}}),n(34553),n(40561),n(69826),n(41539),n(31672),n(2490),n(59461),n(21249),n(57640),n(9924),n(47941),n(91058),n(69070),n(21703);var r=n(70211),o=n(89539),i=n(14311),a=n(2311),u=n(41142);function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mClippingPlanes=new Array,this.mNewNodes={},this.mDeleteNodes={},this.mMovedNodes={},this.mGarbageCollectionId=0,this.mGarbageCollection=[],this.mSceneManager=t,this.mResourceManager=n,this.onRenderObjectAttached=new r.xQ,this.onRenderObjectDetached=new r.xQ,this.onDispatchAppEvent=new r.xQ,this.onDispatchAppMessage=new r.xQ,this.onExecuteAppCommand=new r.xQ,this.onClipperAttached=new r.xQ,this.onClipperDetached=new r.xQ}var t,n;return t=e,n=[{key:"getSceneManager",value:function(){return this.mSceneManager}},{key:"getResourceManager",value:function(){return this.mResourceManager}},{key:"getActiveViewInfo",value:function(){return this.mActiveViewInfo}},{key:"_createNewNodesIfNotExists",value:function(e){this.mNewNodes[e]=this.mNewNodes[e]||new Array}},{key:"_createDeletedNodesIfNotExists",value:function(e){this.mDeleteNodes[e]=this.mDeleteNodes[e]||{}}},{key:"_createMovedNodesIfNotExists",value:function(e){this.mMovedNodes[e]=this.mMovedNodes[e]||{}}},{key:"trashItem",value:function(e,t,n,r){var i=this,a=++this.mGarbageCollectionId,c={hash:e,id:a,item:t,trashFunc:r,garbageHandle:setTimeout((function(){var e=i.mGarbageCollection.findIndex((function(e){return e.id===a}));if(e>=0){var t=i.mGarbageCollection[e];(0,o.isNullOrUndefined)(t.trashFunc)||t.trashFunc(t.item),u.qL.print("Auto disposing item from garbage: ",t),i.mGarbageCollection.splice(e,1)}}),n<0?0:n)};u.qL.print("trashing item: ",c),this.mGarbageCollection.push(c)}},{key:"getFromGarbage",value:function(e){var t=this.mGarbageCollection.findIndex((function(t){return t.hash===e}));if(t>=0){var n=this.mGarbageCollection[t];return this.mGarbageCollection.splice(t,1),clearTimeout(n.garbageHandle),u.qL.print("Item restored from garbage: ",n),n.item}}},{key:"resetNodeStates",value:function(){this.mNewNodes={},this.mDeleteNodes={},this.mMovedNodes={}}},{key:"dispatchAppEvent",value:function(e,t){this.onDispatchAppEvent.next(new a.I(e,t))}},{key:"dispatchAppMessage",value:function(e){this.onDispatchAppMessage.next(e)}},{key:"executeAppCommand",value:function(e){this.onExecuteAppCommand.next(e)}},{key:"requestFrame",value:function(){this.dispatchAppEvent(i.G.RequestFrame)}},{key:"addNewNode",value:function(e,t){this._createNewNodesIfNotExists(e),this._createDeletedNodesIfNotExists(e);var n=this.mNewNodes[e].find((function(e){return e.getObjectId()===t.getObjectId()}));(0,o.isUndefined)(n)&&this.mNewNodes[e].push(t),!0===this.mDeleteNodes[e][t.getSceneObjectId()]&&delete this.mDeleteNodes[e][t.getSceneObjectId()]}},{key:"addGlobalClipper",value:function(e,t){var n=e;n.referenceId=t,this.mClippingPlanes.findIndex((function(e){return e.referenceId===t}))<0&&(this.mClippingPlanes.push(n),this.onClipperAttached.next(n))}},{key:"removeGlobalClipper",value:function(e){var t=this.mClippingPlanes.findIndex((function(t){return t.referenceId===e}));if(t>=0){var n=this.mClippingPlanes.splice(t,1)[0];this.onClipperDetached.next(n)}}},{key:"getNewNodes",value:function(e){return this._createNewNodesIfNotExists(e),this.mNewNodes[e]}},{key:"getClippingPlanes",value:function(){return this.mClippingPlanes}},{key:"getDeletedNodes",value:function(e){return this._createDeletedNodesIfNotExists(e),Object.keys(this.mDeleteNodes[e]).map((function(e){return parseInt(e,10)}))}},{key:"isNodeDeleted",value:function(e,t){return this._createDeletedNodesIfNotExists(e),!0===this.mDeleteNodes[e][t]}},{key:"isNodeMoved",value:function(e,t){return this._createMovedNodesIfNotExists(e),(0,o.isNullOrUndefined)(this.mMovedNodes[e][t])?null:this.mMovedNodes[e][t]}},{key:"setNodeDeleted",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this._createNewNodesIfNotExists(e),this._createDeletedNodesIfNotExists(e),t<0){var r=this.mNewNodes[e].findIndex((function(e){return-e.id==t}));r>=0&&this.mNewNodes[e].splice(r,1)}else this.mDeleteNodes[e][t]=n}},{key:"setNodeMoved",value:function(e,t,n){this._createMovedNodesIfNotExists(e),this.mMovedNodes[e][t]=n}},{key:"_setActiveViewId",value:function(e,t){this.mActiveViewInfo={product_scene_id:e,view_id:t}}}],n&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},80353:function(e,t,n){"use strict";n.d(t,{u:function(){return l}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(67988),o=n(90140);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function c(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(l,e);var t,n,r,o,i=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=s(r);if(o){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return c(this,e)});function l(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),i.call(this,e,t)}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r.B);l.TypeRTTI=new o.r("SceneEntity",r.B.TypeRTTI)},12673:function(e,t,n){"use strict";n.d(t,{g:function(){return Il}}),n(92222),n(41539),n(15581),n(2490),n(34514),n(54747),n(69070),n(21703);var r=n(67988),o=n(80353),i=n(74897),a=n(83014),u=n(24848),c=n(504),s=n(74826),l=n(55601),f=(n(68309),n(19601),n(54678),n(68304),n(30489),n(81299),n(12419),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948),n(90140)),p=n(83937),d=n(37526);function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(){return m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=v(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},m.apply(this,arguments)}function v(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=w(e)););return e}function b(e,t){return b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},b(e,t)}function g(e,t){if(t&&("object"===h(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function w(e){return w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},w(e)}var _=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=w(r);if(o){var n=w(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return g(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e,t)).mWidth=10,n.mHeight=10,n}return t=a,(n=[{key:"getType",value:function(){return a.TypeRTTI}},{key:"createRenderObject",value:function(){var e=new THREE.Color(this.mColor).getHex(),t=this.mIntensity,n=new THREE.RectAreaLight(e,t,this.mWidth,this.mHeight);return n.name="Rect Area Light",n.position.copy(this.mPosition),n.rotation.copy(this.mRotation),new d.m(n,this)}},{key:"serialize",value:function(e){var t=Object.assign(m(w(a.prototype),"serialize",this).call(this,e),{type:"rectAreaLight"});return t.properties=Object.assign(t.properties,{light_width:new THREE.Color(this.mWidth),light_height:new THREE.Color(this.mWidth)}),t}},{key:"setValue",value:function(e,t){switch(e){case"light_width":return this.mWidth=parseFloat(t),!0;case"light_height":return this.mHeight=parseFloat(t),!0}return m(w(a.prototype),"setValue",this).call(this,e,t)}},{key:"getValue",value:function(e){var t=m(w(a.prototype),"getValue",this).call(this,e);if(null!==t)return t;switch(e){case"light_width":case"light_height":return this.mWidth}return null}}])&&y(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(p.J);_.TypeRTTI=new f.r("LightEntityRectArea",p.J.TypeRTTI);var O=n(10470),T=n(85913),R=n(1897),S=n(20732),E=n(52121),P=n(11706),x=n(48709),j=n(57348),C=n(42116),k=n(8614),M=n(87974),D=n(24098),A=n(74478);function I(e){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I(e)}function N(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function V(){return V="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=U(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},V.apply(this,arguments)}function U(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=L(e)););return e}function F(e,t){return F=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},F(e,t)}function B(e,t){if(t&&("object"===I(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function L(e){return L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},L(e)}var H=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&F(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=L(r);if(o){var n=L(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return B(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e,t)).mTarget=new THREE.Vector3(0,0,1),n}return t=a,(n=[{key:"getType",value:function(){return a.TypeRTTI}},{key:"setValue",value:function(e,t){switch(e){case"position_x":case"position_y":case"position_z":case"position":this.updatePlane();break;case"target":return this.mTarget=t.clone(),this.updatePlane(),!0;case"clip_target_x":case"target_x":return this.mTarget.x=parseFloat(t),this.updatePlane(),!0;case"clip_target_y":case"target_y":return this.mTarget.y=parseFloat(t),this.updatePlane(),!0;case"clip_target_z":case"target_z":return this.mTarget.z=parseFloat(t),this.updatePlane(),!0}return V(L(a.prototype),"setValue",this).call(this,e,t)}},{key:"getValue",value:function(e){var t=V(L(a.prototype),"getValue",this).call(this,e);if(null!==t)return t;switch(e){case"target":return this.mTarget;case"target_x":return this.mTarget.x;case"target_y":return this.mTarget.y;case"target_z":return this.mTarget.z}return null}},{key:"finalizeRenderObjectBuild",value:function(){this.updatePlane()}},{key:"createRenderObject",value:function(){var e=new THREE.Object3D;e.position.copy(this.mPosition.clone());var t=new THREE.Object3D;return t.position.copy(this.mTarget.clone()),e.name=this.mName,e.target=t,e.needsHelper="clipping",new A.N(e,this)}},{key:"updatePlane",value:function(){this.hasRenderObject()&&this.getRenderObject().updatePlane()}},{key:"serialize",value:function(e){var t=Object.assign(V(L(a.prototype),"serialize",this).call(this,e),{type:"global_clipper"});return t.properties=Object.assign(t.properties,{clip_target_x:this.mTarget.x,clip_target_y:this.mTarget.y,clip_target_z:this.mTarget.z}),t}}])&&N(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(o.u);H.TypeRTTI=new f.r("ClippingEntity",o.u.TypeRTTI);var z=n(16499),q=n(20349),G=n(8790),W=n(76101),Q=n(60216),K=n(89539),Y=n(83348),Z=n(12254),X=n(93663),J=n(18743),$=n(57877),ee=n(41142),te=n(23498);function ne(e){return ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ne(e)}function re(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function oe(e,t){return oe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},oe(e,t)}function ie(e,t){if(t&&("object"===ne(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ae(e){return ae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ae(e)}var ue=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oe(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ae(r);if(o){var n=ae(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return ie(this,e)});function a(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(e=i.call(this,"catalogueMeta")).handleDeinitRenderObject=function(t){e.dispose()},e}return t=a,(n=[{key:"resolveSettings",value:function(){var e=this.getParentObject().getValue("product_id");return ee.qL.print("resolve settings for: ",e),te.g.getInstance().resolveCatalogueSettings(e)}},{key:"OnAttached",value:function(){this.registerMessageHandler($.y.TypeRTTI,this.handleDeinitRenderObject)}},{key:"OnDetached",value:function(){this.dispose(),this.unregisterMessageHandler($.y.TypeRTTI)}},{key:"isAttachable",value:function(e){return e.isDerivedTypeOf(Y.L.TypeRTTI)}},{key:"dispose",value:function(){var e=this.getParentObject().getValue("product_id");te.g.getInstance().disposeCatalogue(e)}}])&&re(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(J.H);function ce(e){return ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ce(e)}function se(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function le(){return le="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=fe(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},le.apply(this,arguments)}function fe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=he(e)););return e}function pe(e,t){return pe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},pe(e,t)}function de(e,t){if(t&&("object"===ce(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function he(e){return he=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},he(e)}var ye=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pe(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=he(r);if(o){var n=he(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return de(this,e)});function a(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.call(this,e,t)}return t=a,(n=[{key:"getType",value:function(){return a.TypeRTTI}},{key:"serialize",value:function(e){return Object.assign(le(he(a.prototype),"serialize",this).call(this,e),{type:"group"})}}])&&se(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(o.u);ye.TypeRTTI=new f.r("GroupEntity",o.u.TypeRTTI),n(35666),n(39714),n(40561),n(88674),n(38862),n(2707),n(47941),n(73210),n(74916),n(15306),n(69826),n(31672),n(59461),n(21249),n(57640),n(9924);var me=n(70211),ve=n(42615),be=n(64944),ge=n(70456),we=n(63438),_e=n(84217),Oe=n(47746),Te=n(29514),Re=n(4530),Se=n(94130),Ee=(n(68216),n(79433),n(91058),n(41805)),Pe=n(68009);function xe(e){return xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xe(e)}function je(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ce(){return Ce="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=ke(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Ce.apply(this,arguments)}function ke(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ae(e)););return e}function Me(e,t){return Me=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Me(e,t)}function De(e,t){if(t&&("object"===xe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ae(e){return Ae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ae(e)}var Ie=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Me(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ae(r);if(o){var n=Ae(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return De(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e,t)).mValueMutations={},n.mAttributeData.attribute_values.sort((function(e,t){var n=e.attribute_value_valuable,r=t.attribute_value_valuable;return n.position-r.position})),n}return t=a,n=[{key:"getType",value:function(){return a.TypeRTTI}},{key:"getAttribute",value:function(){return this.updateValues(),this.mAttributeData}},{key:"resolveValueMutation",value:function(e){if(!(0,K.isNullOrUndefined)(e)){if((0,K.isNullOrUndefined)(this.mValueMutations[e])){var t=this.mAttributeData.attribute_values.find((function(t){return t.id==e}));(0,K.isUndefined)(t)||(this.mValueMutations[e]={selected:!1,visible:0!==t.visibility,disabled:!0===t.disabled})}return this.mValueMutations[e]}}},{key:"updateValues",value:function(){var e=this;this.mAttributeData.attribute_values.forEach((function(t){var n=e.resolveValueMutation(t.id);t.visible=n.visible,t.disabled=n.disabled}));var t=this.getValue(),n=(0,K.isNullOrUndefined)(t.attribute_value_id)?null:t.attribute_value_id;this.mAttributeData.selected_value_id=n,this.mAttributeData.selected_value_value=t}},{key:"setValue",value:function(e,t){var n=this,r=e;if(!Pe.F.isNumeric(e)){var o="string"==typeof e?e.toLowerCase():e,i=this.mAttributeData.attribute_values.find((function(e){return"string"==typeof e.name&&e.name.toLowerCase()===o}));(0,K.isNullOrUndefined)(i)||(r=i.id)}Object.keys(this.mValueMutations).forEach((function(e){n.mValueMutations[e].selected=!1}));var a=this.resolveValueMutation(r);if((0,K.isUndefined)(a))ee.qL.warn("trying to select none existing value ".concat(r," in question@setValue"));else{a.selected=!0,this.updateValues();var u=this._getDefaultSetOptions(t);u.emitEvent&&this.broadcastValueChange(r,this.getValue(),u.rebuild,u.userData)}}},{key:"setValueByKey",value:function(e,t){var n="string"==typeof e?e.toLowerCase():e,r=this.mAttributeData.attribute_values.find((function(e){return"string"==typeof e.key&&e.key.toLowerCase()===n}));(0,K.isNullOrUndefined)(r)||this.setValue(r.id,t)}},{key:"compareValue",value:function(e){return e==this.getValue().attribute_value_id}},{key:"getValue",value:function(){var e=this,t={attribute_value_id:null};if(Object.keys(this.mValueMutations).every((function(n){return!e.mValueMutations[n].selected||(t.attribute_value_id=parseInt(n,10),!1)})),null!==t.attribute_value_id)return t;var n=this.mAttributeData.attribute_values.find((function(e){return!0===e.default}));return(0,K.isUndefined)(n)?this.mAttributeData.attribute_values.length>0?{attribute_value_id:this.mAttributeData.attribute_values[0].id}:{attribute_value_id:null}:{attribute_value_id:n.id}}},{key:"getValueName",value:function(){var e=this.getValue();if((0,K.isNullOrUndefined)(e.attribute_value_id))return"";var t=this.mAttributeData.attribute_values.find((function(t){return t.id==e.attribute_value_id}));return(0,K.isNullOrUndefined)(t)?"":t.name}},{key:"getValueKey",value:function(){var e=this.getValue(),t=this.mAttributeData.attribute_values.find((function(t){return t.id===e.attribute_value_id}));if(!(0,K.isNullOrUndefined)(t))return t.key}},{key:"resetValue",value:function(e){var t=this,n=this._getDefaultSetOptions(e);Object.keys(this.mValueMutations).forEach((function(e){var r=!1!==t.mValueMutations[e].selected;t.mValueMutations[e].selected=!1,n.emitEvent&&r&&t.broadcastValueChange(parseInt(e,10),!1,n.rebuild)}))}},{key:"isVisibleInQuote",value:function(){if(!Ce(Ae(a.prototype),"isVisibleInQuote",this).call(this))return!1;var e=this.getValue(),t=this.mAttributeData.attribute_values.find((function(t){return t.id===e.attribute_value_id}));return!t||2!==t.visibility}},{key:"setVisibility",value:function(e,t){if(!this.visibleOnFrame)return Ce(Ae(a.prototype),"setVisibility",this).call(this,!1);if(t&&!(0,K.isNullOrUndefined)(t.option_id)){var n=this.resolveValueMutation(t.option_id);n&&(n.visible=e)}else Ce(Ae(a.prototype),"setVisibility",this).call(this,e,t)}},{key:"setDisabled",value:function(e,t){if(!(0,K.isNullOrUndefined)(t)&&!(0,K.isNullOrUndefined)(t.option_id)){var n=this.resolveValueMutation(t.option_id);(0,K.isUndefined)(n)||(n.disabled=e)}}},{key:"getQueryParam",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t={},n=this.getValue();if(!(0,K.isNullOrUndefined)(n.attribute_value_id)){var r=!1;e&&(this.isVisible()&&!1!==this.resolveValueMutation(n.attribute_value_id).visible||(r=!0)),r||(t[this.mAttributeData.id]=n.attribute_value_id)}return t}},{key:"parse",value:function(e,t){(0,K.isNullOrUndefined)(e)||(0,K.isUndefined)(e.attribute_value_id)||this.setValue(e.attribute_value_id,t)}}],n&&je(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(Ee.l);function Ne(e){return Ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ne(e)}function Ve(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ue(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fe(){return Fe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=Be(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Fe.apply(this,arguments)}function Be(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ze(e)););return e}function Le(e,t){return Le=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Le(e,t)}function He(e,t){if(t&&("object"===Ne(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ze(e){return ze=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ze(e)}Ie.TypeRTTI=new f.r("AttributeQuestionController",Ee.l.TypeRTTI);var qe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Le(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ze(r);if(o){var n=ze(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return He(this,e)});function a(e,t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);var r=(n=i.call(this,e,t)).mAttributeManagerComp._getMaterialGroupManager();return(0,K.isNullOrUndefined)(r)||(n.mStreamMaterialChanges=r.onMaterialChanged.subscribe((function(e){n.resolveMaterialGroupId()===e.id&&n.updateValues()}))),n}return t=a,n=[{key:"getType",value:function(){return a.TypeRTTI}},{key:"destroy",value:function(){(0,K.isNullOrUndefined)(this.mStreamMaterialChanges)||this.mStreamMaterialChanges.unsubscribe(),Fe(ze(a.prototype),"destroy",this).call(this)}},{key:"getAttribute",value:function(){return this.updateValues(),this.mAttributeData}},{key:"resolveMaterialGroupId",value:function(){if(this.mAttributeData&&this.mAttributeData.attribute_values.length>0){var e=this.mAttributeData.attribute_values[0].attribute_value_valuable;if(!(0,K.isNullOrUndefined)(e)&&Pe.F.isNumeric(e.material_group_id))return e.material_group_id}return null}},{key:"updateValues",value:function(){var e=this.resolveMaterialGroupId();if(null!==e){var t=this.mAttributeManagerComp._getMaterialGroupManager();(0,K.isNullOrUndefined)(t)||(this.mAttributeData.attribute_values[0].attribute_value_valuable.material_group=t.getGroup(e))}this.mAttributeData.selected_value_id=this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,this.mAttributeData.selected_value_value=this.getValue()}},{key:"setValue",value:function(e,t){var n=this.mAttributeManagerComp._getMaterialGroupManager();if(!(0,K.isNullOrUndefined)(n)){var r=e;if(!Pe.F.isNumeric(e)&&"string"==typeof e){ee.qL.print("Setting material group reference via name on group: ".concat(this.resolveMaterialGroupId()));var o=n.getGroup(this.resolveMaterialGroupId());if(!(0,K.isNullOrUndefined)(o.materials)){var i=e.toLowerCase(),a=o.materials.find((function(e){return"string"==typeof e.name&&e.name.toLowerCase()===i}))||o.materials.find((function(e){return"string"==typeof e.material_name&&e.material_name.toLowerCase()===i}));(0,K.isNullOrUndefined)(a)||(r=a.id)}}var u=!(0,K.isNullOrUndefined)(t)&&!0===t.emitEvent;n.setActiveMaterial(this.resolveMaterialGroupId(),r,u)}this.updateValues();var c=this._getDefaultSetOptions(t);if(c.emitEvent){var s=this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,l=(0,K.isNullOrUndefined)(n)?null:n.getActiveRefId(this.resolveMaterialGroupId());this.broadcastValueChange(s,l,c.rebuild)}}},{key:"setValueByKey",value:function(e,t){var n=this.mAttributeManagerComp._getMaterialGroupManager();if(!(0,K.isNullOrUndefined)(n)){ee.qL.print("Setting material group reference via key on group: ".concat(this.resolveMaterialGroupId()));var r=n.getGroup(this.resolveMaterialGroupId());if(!(0,K.isNullOrUndefined)(r.materials)){var o=e.toLowerCase(),i=r.materials.find((function(e){return"string"==typeof e.sku&&e.sku.toLowerCase()===o}));(0,K.isNullOrUndefined)(i)||this.setValue(i.id,t)}}}},{key:"getValue",value:function(){var e=this.mAttributeManagerComp._getMaterialGroupManager();return{material_id:(0,K.isNullOrUndefined)(e)?null:e.getActiveRefId(this.resolveMaterialGroupId())}}},{key:"getValueName",value:function(){var e=this.mAttributeManagerComp._getMaterialGroupManager();if((0,K.isNullOrUndefined)(e))return null;var t=e.getActiveRefModel(this.resolveMaterialGroupId());return(0,K.isNullOrUndefined)(t)?null:!(0,K.isNullOrUndefined)(t.name)&&t.name.length>0?t.name:t.material_name}},{key:"getValueKey",value:function(){var e=this.mAttributeManagerComp._getMaterialGroupManager();if(!(0,K.isNullOrUndefined)(e)){var t=e.getGroup(this.resolveMaterialGroupId());if(!(0,K.isNullOrUndefined)(t.materials)){var n=this.getValue(),r=t.materials.find((function(e){return e.id===n.material_id}));if(!(0,K.isNullOrUndefined)(r))return r.sku}}}},{key:"resetValue",value:function(e){var t=this.mAttributeManagerComp._getMaterialGroupManager();if(!(0,K.isNullOrUndefined)(t)){var n=!(0,K.isNullOrUndefined)(e)&&!0===e.emitEvent;t.resetActiveMaterial(this.resolveMaterialGroupId(),n)}var r=this._getDefaultSetOptions(e);if(r.emitEvent){var o=this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,i=(0,K.isNullOrUndefined)(t)?null:t.getActiveRefId(this.resolveMaterialGroupId());this.broadcastValueChange(o,i,r.rebuild)}}},{key:"isVisibleInQuote",value:function(){if(!Fe(ze(a.prototype),"isVisibleInQuote",this).call(this))return!1;var e=this.getValue(),t=this.mAttributeManagerComp._getMaterialGroupManager();if(!(0,K.isNullOrUndefined)(t)){var n=t.getGroup(this.resolveMaterialGroupId());if(n&&Array.isArray(n.materials)){var r=n.materials.find((function(t){return t.id===e.material_id}));if(!(0,K.isNullOrUndefined)(r))return 2!=r.visible}}return!0}},{key:"setVisibility",value:function(e,t){if(!this.visibleOnFrame)return Fe(ze(a.prototype),"setVisibility",this).call(this,!1);if(t&&!(0,K.isNullOrUndefined)(t.option_id)){var n=this.mAttributeManagerComp._getMaterialGroupManager();null!==this.resolveMaterialGroupId()&&Pe.F.isNumeric(t.option_id)&&n.setMaterialVisibility(this.resolveMaterialGroupId(),t.option_id,e)}else Fe(ze(a.prototype),"setVisibility",this).call(this,e,t)}},{key:"getQueryParam",value:function(){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!0===e?Ve({},this.mAttributeData.id,"".concat(this.getValue().material_id)):{}}},{key:"parse",value:function(e,t){(0,K.isNullOrUndefined)(e)||(0,K.isUndefined)(e.material_id)||this.setValue(e.material_id,t)}}],n&&Ue(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(Ee.l);qe.TypeRTTI=new f.r("AttributeMatgroupController",Ee.l.TypeRTTI),n(34553),n(9653);var Ge=n(80115);function We(e){return We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},We(e)}function Qe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ke(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ye(){return Ye="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=Ze(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Ye.apply(this,arguments)}function Ze(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=$e(e)););return e}function Xe(e,t){return Xe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Xe(e,t)}function Je(e,t){if(t&&("object"===We(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function $e(e){return $e=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},$e(e)}var et=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xe(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=$e(r);if(o){var n=$e(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Je(this,e)});function a(e,t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e,t)).mValueMutations={},n.mValue={value:""};var r=n.resolveValuable();if(r){Array.isArray(r.colors)||(r.colors=[]);var o=r.colors.findIndex((function(e){return!0===e.default}));o>=0&&n.setValue(r.colors[o].color)}return n}return t=a,n=[{key:"getType",value:function(){return a.TypeRTTI}},{key:"getAttribute",value:function(){return this.updateValues(),this.mAttributeData}},{key:"updateValues",value:function(){var e=this,t=this.resolveValuable();t&&t.colors.forEach((function(t){var n=e.resolveValueMutation(t.color);t.visible=n.visible})),this.mAttributeData.selected_value_id=this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,this.mAttributeData.selected_value_value=this.getValue()}},{key:"setValue",value:function(e,t){var n=this;this.mValue.value=e;var r=this.resolveValuable();if(r)if(Pe.F.isNumeric(r.material_group_id)){var o=this.mAttributeManagerComp._getMaterialGroupManager(),i=(0,K.isString)(this.mValue.value)&&this.mValue.value.length>0?this.mValue.value.substr(0,7):"",a=this.resolveProductNode();o.setColorOverwrite(r.material_group_id,i,a)}else if(Pe.F.isNumeric(r.material_id)){var u=this.resolveProductNode();u.getRenderState().getResourceManager().getManager(Ge.O.MaterialManager).then((function(e){var t=(0,K.isString)(n.mValue.value)&&n.mValue.value.length>0?n.mValue.value.substr(0,7):"",o=Number(r.material_id);e.setColorOverwrite(o,t,u)}),(function(){}))}this.updateValues();var c=this._getDefaultSetOptions(t);c.emitEvent&&this.broadcastValueChange(this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,this.mValue,c.rebuild)}},{key:"setValueByKey",value:function(e,t){this.setValue(e,t)}},{key:"getValue",value:function(){return this.mValue}},{key:"getValueName",value:function(){var e=this,t=this.mValue.value,n=this.resolveValuable();if(n){n.colors=n.colors||[];var r=n.colors.find((function(t){return t.color===e.mValue.value}));(0,K.isNullOrUndefined)(r)||(t=r.name)}return t}},{key:"resetValue",value:function(e){this.mValue.value="";var t=this._getDefaultSetOptions(e);t.emitEvent&&this.broadcastValueChange(this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,this.mValue,t.rebuild)}},{key:"resolveValuable",value:function(){return this.mAttributeData&&this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].attribute_value_valuable:null}},{key:"getQueryParam",value:function(){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!0===e?Qe({},this.mAttributeData.id,this.getValueName()):{}}},{key:"parse",value:function(e,t){(0,K.isNullOrUndefined)(e)||(0,K.isUndefined)(e.value)||this.setValue(e.value,t)}},{key:"setVisibility",value:function(e,t){if(!this.visibleOnFrame)return Ye($e(a.prototype),"setVisibility",this).call(this,!1);if(t&&!(0,K.isNullOrUndefined)(t.color)){var n=this.resolveValueMutation(t.color);n&&(n.visible=e)}else Ye($e(a.prototype),"setVisibility",this).call(this,e,t)}},{key:"resolveValueMutation",value:function(e){if(!(0,K.isNullOrUndefined)(e)){if((0,K.isNullOrUndefined)(this.mValueMutations[e])){var t=this.mAttributeData.attribute_values[0].attribute_value_valuable.colors.find((function(t){return t.color===e}));(0,K.isUndefined)(t)||(this.mValueMutations[e]={visible:t.visible})}return this.mValueMutations[e]}}}],n&&Ke(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(Ee.l);et.TypeRTTI=new f.r("AttributeColorController",Ee.l.TypeRTTI);var tt=n(87181);function nt(e){return nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nt(e)}function rt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ot(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function it(e,t){return it=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},it(e,t)}function at(e,t){if(t&&("object"===nt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ut(e){return ut=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ut(e)}var ct=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&it(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ut(r);if(o){var n=ut(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return at(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e,t)).mValue={value:""},n}return t=a,n=[{key:"getType",value:function(){return a.TypeRTTI}},{key:"getAttribute",value:function(){return this.updateValues(),this.mAttributeData}},{key:"updateValues",value:function(){this.mAttributeData.selected_value_id=this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,this.mAttributeData.selected_value_value=this.getValue()}},{key:"setValue",value:function(e,t){var n=this;this.mValue.value=e;var r=this.resolveValuable();if(null!==r&&Pe.F.isNumeric(r.material_id)){var o=this.resolveProductNode();o.getRenderState().getResourceManager().getManager(tt.ResourceManagerTypes.MaterialManager).then((function(e){var t=Pe.F.isString(n.mValue.value)&&n.mValue.value.length>0?n.mValue.value.substr(0,7):"";e.setColorOverwrite(r.material_id,t,o)}),(function(e){}))}this.updateValues();var i=this._getDefaultSetOptions(t);i.emitEvent&&this.broadcastValueChange(this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,this.mValue,i.rebuild)}},{key:"setValueByKey",value:function(e,t){this.setValue(e,t)}},{key:"getValue",value:function(){return this.mValue}},{key:"getValueName",value:function(){return this.mValue.value}},{key:"resetValue",value:function(e){this.mValue.value="";var t=this._getDefaultSetOptions(e);t.emitEvent&&this.broadcastValueChange(this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,this.mValue,t.rebuild)}},{key:"resolveValuable",value:function(){return this.mAttributeData&&this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].attribute_value_valuable:null}},{key:"getQueryParam",value:function(){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!0===e?rt({},this.mAttributeData.id,this.getValueName()):{}}},{key:"parse",value:function(e,t){(0,K.isNullOrUndefined)(e)||(0,K.isUndefined)(e.value)||this.setValue(e.value,t)}}],n&&ot(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(Ee.l);ct.TypeRTTI=new f.r("AttributeColorPickerController",Ee.l.TypeRTTI),n(77601),n(4723),n(47042),n(56977),n(26699);var st=n(94072),lt=n(32469),ft=n(74379),pt=n(5631),dt=n(36277),ht=n(70655),yt=n(55709),mt=n(17604);function vt(e,t){return t?function(n){return n.pipe(vt((function(n,r){return(0,st.D)(e(n,r)).pipe((0,yt.U)((function(e,o){return t(n,e,r,o)})))})))}:function(t){return t.lift(new bt(e))}}var bt=function(){function e(e){this.project=e}return e.prototype.call=function(e,t){return t.subscribe(new gt(e,this.project))},e}(),gt=function(e){function t(t,n){var r=e.call(this,t)||this;return r.project=n,r.hasSubscription=!1,r.hasCompleted=!1,r.index=0,r}return ht.ZT(t,e),t.prototype._next=function(e){this.hasSubscription||this.tryNext(e)},t.prototype.tryNext=function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(e){return void this.destination.error(e)}this.hasSubscription=!0,this._innerSub(t)},t.prototype._innerSub=function(e){var t=new mt.IY(this),n=this.destination;n.add(t);var r=(0,mt.ft)(e,t);r!==t&&n.add(r)},t.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete(),this.unsubscribe()},t.prototype.notifyNext=function(e){this.destination.next(e)},t.prototype.notifyError=function(e){this.destination.error(e)},t.prototype.notifyComplete=function(){this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},t}(mt.Ds),wt=n(10979),_t=n(23884);function Ot(e){return function(t){return t.lift(new Tt(e))}}var Tt=function(){function e(e){this.callback=e}return e.prototype.call=function(e,t){return t.subscribe(new Rt(e,this.callback))},e}(),Rt=function(e){function t(t,n){var r=e.call(this,t)||this;return r.add(new _t.w(n)),r}return ht.ZT(t,e),t}(wt.L);function St(e){return function(t){return n=function(){var n=new me.xQ;return t.pipe((0,dt.P)((function(){return n}),{leading:!0,trailing:!0}),vt((function(t,r){return(0,st.D)(e(t,r)).pipe(Ot((function(){return n.next()})))})))},new ft.y((function(e){var t;try{t=n()}catch(t){return void e.error(t)}return(t?(0,st.D)(t):(0,pt.c)()).subscribe(e)}));var n}}function Et(e){return Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Et(e)}function Pt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jt(){return jt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=Ct(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},jt.apply(this,arguments)}function Ct(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Dt(e)););return e}function kt(e,t){return kt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},kt(e,t)}function Mt(e,t){if(t&&("object"===Et(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Dt(e){return Dt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Dt(e)}var At=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kt(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Dt(r);if(o){var n=Dt(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Mt(this,e)});function a(e,t){var n;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e,t)).mValue={image_source:"",offset:[0,0],ratio:1,repeat_type:"clamp",size:"contain",rotation:0,scale:1},n.mImageUploadEvent=new me.xQ,(0,K.isArray)(n.mAttributeData.attribute_values)&&n.mAttributeData.attribute_values.length>0){var r=n.mAttributeData.attribute_values[0].attribute_value_valuable||{};n.mValue.image_source=r.image_source||n.mValue.image_source,n.mValue.ratio=(0,K.isNullOrUndefined)(r.ratio)?n.mValue.ratio:r.ratio,n.mValue.size=r.size_type||n.mValue.size,n.mValue.repeat_type=r.repeat_type||n.mValue.repeat_type,(0,K.isNullOrUndefined)(r.offset_x)||(0,K.isNullOrUndefined)(r.offset_y)||(n.mValue.offset=[r.offset_x,r.offset_y]),n.mValue.rotation=(0,K.isNullOrUndefined)(r.rotation)?n.mValue.rotation:r.rotation,n.mValue.scale=(0,K.isNullOrUndefined)(r.scale)?n.mValue.scale:r.scale}return n}return t=a,n=[{key:"getType",value:function(){return a.TypeRTTI}},{key:"destroy",value:function(){(0,K.isNullOrUndefined)(this.mImageUploadResolver)||(this.mImageUploadResolver.pipe((0,_e.q)(1)).subscribe((function(e){e.destroy()})),this.mImageUploadResolver.unsubscribe(),this.mImageUploadEvent.unsubscribe(),delete this.mImageUploadResolver)}},{key:"getAttribute",value:function(){return this.updateValues(!1),this.mAttributeData}},{key:"broadcastAttributeUpdated",value:function(){this.updateValues(),jt(Dt(a.prototype),"broadcastAttributeUpdated",this).call(this)}},{key:"updateValues",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(Array.isArray(this.mAttributeData.attribute_values)&&this.mAttributeData.attribute_values.length>0){var t=this.mAttributeData.attribute_values[0],n=t.attribute_value_valuable||{};Pe.F.isNumeric(n.ratio)&&(this.mValue.ratio=n.ratio)}this.mAttributeData.selected_value_id=this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,this.mAttributeData.selected_value_value=this.getValue(),e&&this.updateMaterial()}},{key:"setValue",value:function(e,t){(0,K.isString)(e)||(this.mValue=Object.assign(this.mValue,e));var n=(0,K.isString)(e)?e:e.image_source;if(!(0,K.isNullOrUndefined)(n)){var r=n.length;if(/@offset:(.*?);/.test(n)){var o=n.match(/@offset:(.*?);/);r=r>o.index?o.index:r;var i=o[1],a=null;try{a=JSON.parse(i)}catch(e){}Array.isArray(a)&&a.length>1&&(this.mValue.offset=[a[0],a[1]])}if(/@rotation:(.*?);/.test(n)){var u=n.match(/@rotation:(.*?);/),c=u[1];r=r>u.index?u.index:r;var s=parseInt(c,10);isNaN(s)||(this.mValue.rotation=s)}if(/@scale:(.*?);/.test(n)){var l=n.match(/@scale:(.*?);/),f=l[1];r=r>l.index?l.index:r;var p=parseFloat(f);isNaN(p)||(this.mValue.scale=p)}r>0&&(n=n.slice(0,r)),this.mValue.image_source=n.trim()}this.updateValues();var d=this._getDefaultSetOptions(t);d.emitEvent&&this.broadcastValueChange(this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,this.mValue,d.rebuild)}},{key:"setValueByKey",value:function(e,t){this.setValue(e,t)}},{key:"getValue",value:function(){return this.mValue}},{key:"getValueName",value:function(){var e=(0,K.isArray)(this.mValue.offset)&&this.mValue.offset.length>1?"[".concat(this.mValue.offset.map((function(e){return Number(e).toFixed(2)})),"]"):"[0,0]",t=(0,K.isNullOrUndefined)(this.mValue.rotation)?"0":"".concat(this.mValue.rotation),n=(0,K.isNullOrUndefined)(this.mValue.scale)?"0":"".concat(Number(this.mValue.scale).toFixed(2));return!(0,K.isNullOrUndefined)(this.mValue.image_source)&&this.mValue.image_source.length>0?"".concat(this.mValue.image_source," @offset:").concat(e,"; @rotation:").concat(t,"; @scale:").concat(n,";"):""}},{key:"resetValue",value:function(e){this.mValue.image_source="";var t=this._getDefaultSetOptions(e);t.emitEvent&&this.broadcastValueChange(this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,this.mValue,t.rebuild)}},{key:"resolveValuable",value:function(){return this.mAttributeData&&this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].attribute_value_valuable:null}},{key:"getQueryParam",value:function(){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!0===e?Pt({},this.mAttributeData.id,this.getValueName()):{}}},{key:"parse",value:function(e,t){(0,K.isNullOrUndefined)(e)||(0,K.isUndefined)(e.image_source)||this.setValue(e,t)}},{key:"updateMaterial",value:function(){var e=this,t=this.resolveValuable();(0,K.isNullOrUndefined)(this.mImageUploadResolver)&&(this.mImageUploadResolver=new ge.t(1),this.resolveProductNode().getRenderState().getResourceManager().getManager(Ge.O.MaterialManager).then((function(t){e.mImageUploadResolver.next(new lt.E(t)),e.mImageUploadResolver.complete()}),(function(t){e.mImageUploadResolver.error(t)})),this.mImageUploadEvent.pipe(St((function(){return(0,st.D)(new Promise((function(n){var r=JSON.parse(JSON.stringify(t)),o=JSON.parse(JSON.stringify(e.mValue));e.mImageUploadResolver.pipe((0,_e.q)(1)).subscribe((function(t){t.update(r,o,e.resolveProductNode()).then((function(){n()}),(function(e){ee.qL.warn("Failed to update image upload:",e),n()}))}),(function(e){ee.qL.warn("Failed to retrieve material manager:",e),n()}))})))}))).subscribe((function(){ee.qL.print("Image upload updated."),e.resolveProductNode().getRenderState().requestFrame()}),(function(e){ee.qL.warn("Failed to update image upload (pipeline):",e)}))),this.mImageUploadEvent.next()}},{key:"onMaterialUpdated",value:function(e){var t=this.resolveValuable().material_id;e.materialModelId===t&&this.visibleOnFrame&&![0,3].includes(this.mAttributeData.visibility)&&this.mAttributeData.visible&&this.updateMaterial()}}],n&&xt(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(Ee.l);function It(e){return It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},It(e)}function Nt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Vt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ut(e,t){return Ut=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ut(e,t)}function Ft(e,t){if(t&&("object"===It(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Bt(e){return Bt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Bt(e)}At.TypeRTTI=new f.r("AttributeImageUploadController",Ee.l.TypeRTTI);var Lt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ut(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Bt(r);if(o){var n=Bt(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Ft(this,e)});function a(e,t){var n;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e,t)).mValue={value:""},n.mAttributeData.attribute_values.length){var r=n.mAttributeData.attribute_values[0].attribute_value_valuable;(0,K.isNullOrUndefined)(r)||(0,K.isNullOrUndefined)(r.value)||(n.mValue.value=r.value)}return n}return t=a,n=[{key:"getType",value:function(){return a.TypeRTTI}},{key:"getAttribute",value:function(){return this.updateValues(),this.mAttributeData}},{key:"updateValues",value:function(){this.mAttributeData.selected_value_id=this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,this.mAttributeData.selected_value_value=this.getValue()}},{key:"setValue",value:function(e,t){(0,K.isString)(e)?this.mValue.value=e:this.mValue=Object.assign(this.mValue,e),this.updateValues();var n=this._getDefaultSetOptions(t);if(n.emitEvent){var r=this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null;this.broadcastValueChange(r,this.mValue,n.rebuild)}}},{key:"setValueByKey",value:function(e,t){this.setValue(e,t)}},{key:"compareValue",value:function(e){return e==this.getValue().value}},{key:"getValue",value:function(){return this.mValue}},{key:"getValueName",value:function(){return this.getValue().value}},{key:"resetValue",value:function(e){this.mValue.value="";var t=this._getDefaultSetOptions(e);if(t.emitEvent){var n=this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null;this.broadcastValueChange(n,this.mValue,t.rebuild)}}},{key:"getQueryParam",value:function(){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!0===e?Nt({},this.mAttributeData.id,this.getValueName()):{}}},{key:"parse",value:function(e,t){(0,K.isNullOrUndefined)(e)||(0,K.isUndefined)(e.value)||this.setValue(e.value,t)}}],n&&Vt(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(Ee.l);Lt.TypeRTTI=new f.r("AttributeTextInputController",Ee.l.TypeRTTI);var Ht=n(16308),zt=/[#*0-9]\uFE0F?\u20E3|[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23ED-\u23EF\u23F1\u23F2\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB\u25FC\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692\u2694-\u2697\u2699\u269B\u269C\u26A0\u26A7\u26AA\u26B0\u26B1\u26BD\u26BE\u26C4\u26C8\u26CF\u26D1\u26D3\u26E9\u26F0-\u26F5\u26F7\u26F8\u26FA\u2702\u2708\u2709\u270F\u2712\u2714\u2716\u271D\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u27A1\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B55\u3030\u303D\u3297\u3299]\uFE0F?|[\u261D\u270C\u270D](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?|[\u270A\u270B](?:\uD83C[\uDFFB-\uDFFF])?|[\u23E9-\u23EC\u23F0\u23F3\u25FD\u2693\u26A1\u26AB\u26C5\u26CE\u26D4\u26EA\u26FD\u2705\u2728\u274C\u274E\u2753-\u2755\u2795-\u2797\u27B0\u27BF\u2B50]|\u26F9(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|\u2764\uFE0F?(?:\u200D(?:\uD83D\uDD25|\uD83E\uDE79))?|\uD83C(?:[\uDC04\uDD70\uDD71\uDD7E\uDD7F\uDE02\uDE37\uDF21\uDF24-\uDF2C\uDF36\uDF7D\uDF96\uDF97\uDF99-\uDF9B\uDF9E\uDF9F\uDFCD\uDFCE\uDFD4-\uDFDF\uDFF5\uDFF7]\uFE0F?|[\uDF85\uDFC2\uDFC7](?:\uD83C[\uDFFB-\uDFFF])?|[\uDFC3\uDFC4\uDFCA](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDFCB\uDFCC](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDCCF\uDD8E\uDD91-\uDD9A\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF84\uDF86-\uDF93\uDFA0-\uDFC1\uDFC5\uDFC6\uDFC8\uDFC9\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF8-\uDFFF]|\uDDE6\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF]|\uDDE7\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF]|\uDDE8\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF]|\uDDE9\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF]|\uDDEA\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA]|\uDDEB\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7]|\uDDEC\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE]|\uDDED\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA]|\uDDEE\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9]|\uDDEF\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5]|\uDDF0\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF]|\uDDF1\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE]|\uDDF2\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF]|\uDDF3\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF]|\uDDF4\uD83C\uDDF2|\uDDF5\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE]|\uDDF6\uD83C\uDDE6|\uDDF7\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC]|\uDDF8\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF]|\uDDF9\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF]|\uDDFA\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF]|\uDDFB\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA]|\uDDFC\uD83C[\uDDEB\uDDF8]|\uDDFD\uD83C\uDDF0|\uDDFE\uD83C[\uDDEA\uDDF9]|\uDDFF\uD83C[\uDDE6\uDDF2\uDDFC]|\uDFF3\uFE0F?(?:\u200D(?:\u26A7\uFE0F?|\uD83C\uDF08))?|\uDFF4(?:\u200D\u2620\uFE0F?|\uDB40\uDC67\uDB40\uDC62\uDB40(?:\uDC65\uDB40\uDC6E\uDB40\uDC67|\uDC73\uDB40\uDC63\uDB40\uDC74|\uDC77\uDB40\uDC6C\uDB40\uDC73)\uDB40\uDC7F)?)|\uD83D(?:[\uDC08\uDC26](?:\u200D\u2B1B)?|[\uDC3F\uDCFD\uDD49\uDD4A\uDD6F\uDD70\uDD73\uDD76-\uDD79\uDD87\uDD8A-\uDD8D\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA\uDECB\uDECD-\uDECF\uDEE0-\uDEE5\uDEE9\uDEF0\uDEF3]\uFE0F?|[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC6B-\uDC6D\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDC8F\uDC91\uDCAA\uDD7A\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC](?:\uD83C[\uDFFB-\uDFFF])?|[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD74\uDD90](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?|[\uDC00-\uDC07\uDC09-\uDC14\uDC16-\uDC25\uDC27-\uDC3A\uDC3C-\uDC3E\uDC40\uDC44\uDC45\uDC51-\uDC65\uDC6A\uDC79-\uDC7B\uDC7D-\uDC80\uDC84\uDC88-\uDC8E\uDC90\uDC92-\uDCA9\uDCAB-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDDA4\uDDFB-\uDE2D\uDE2F-\uDE34\uDE37-\uDE44\uDE48-\uDE4A\uDE80-\uDEA2\uDEA4-\uDEB3\uDEB7-\uDEBF\uDEC1-\uDEC5\uDED0-\uDED2\uDED5-\uDED7\uDEDC-\uDEDF\uDEEB\uDEEC\uDEF4-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uDC15(?:\u200D\uD83E\uDDBA)?|\uDC3B(?:\u200D\u2744\uFE0F?)?|\uDC41\uFE0F?(?:\u200D\uD83D\uDDE8\uFE0F?)?|\uDC68(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDC68\uDC69]\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFE])))?))?|\uDC69(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?[\uDC68\uDC69]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?|\uDC69\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?))|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFE])))?))?|\uDC6F(?:\u200D[\u2640\u2642]\uFE0F?)?|\uDD75(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|\uDE2E(?:\u200D\uD83D\uDCA8)?|\uDE35(?:\u200D\uD83D\uDCAB)?|\uDE36(?:\u200D\uD83C\uDF2B\uFE0F?)?)|\uD83E(?:[\uDD0C\uDD0F\uDD18-\uDD1F\uDD30-\uDD34\uDD36\uDD77\uDDB5\uDDB6\uDDBB\uDDD2\uDDD3\uDDD5\uDEC3-\uDEC5\uDEF0\uDEF2-\uDEF8](?:\uD83C[\uDFFB-\uDFFF])?|[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD4\uDDD6-\uDDDD](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDDDE\uDDDF](?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD0D\uDD0E\uDD10-\uDD17\uDD20-\uDD25\uDD27-\uDD2F\uDD3A\uDD3F-\uDD45\uDD47-\uDD76\uDD78-\uDDB4\uDDB7\uDDBA\uDDBC-\uDDCC\uDDD0\uDDE0-\uDDFF\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC2\uDECE-\uDEDB\uDEE0-\uDEE8]|\uDD3C(?:\u200D[\u2640\u2642]\uFE0F?|\uD83C[\uDFFB-\uDFFF])?|\uDDD1(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFC-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFD-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFD\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFE]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?))?|\uDEF1(?:\uD83C(?:\uDFFB(?:\u200D\uD83E\uDEF2\uD83C[\uDFFC-\uDFFF])?|\uDFFC(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFD-\uDFFF])?|\uDFFD(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])?|\uDFFE(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFD\uDFFF])?|\uDFFF(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFE])?))?)/g,qt=function(e){return(0,K.isNullOrUndefined)(e)?e:String(e).replace(zt,"")};function Gt(e){return Gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gt(e)}function Wt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Qt(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function Kt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Yt(){return Yt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=Zt(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Yt.apply(this,arguments)}function Zt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=$t(e)););return e}function Xt(e,t){return Xt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Xt(e,t)}function Jt(e,t){if(t&&("object"===Gt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function $t(e){return $t=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},$t(e)}var en=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xt(e,t)}(c,e);var t,n,r,o,i,a,u=(i=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=$t(i);if(a){var n=$t(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Jt(this,e)});function c(e,t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(n=u.call(this,e,t)).mValue={value:""},n.mTextToImageEvent=new me.xQ;var r=n.resolveValuable(),o=null!=r?r.value:"";return n.mMeta=n.mAttributeData&&n.mAttributeData.meta||{},n.setValue(o),n}return t=c,n=[{key:"getType",value:function(){return c.TypeRTTI}},{key:"destroy",value:function(){(0,K.isNullOrUndefined)(this.mTextToImageResolver)||(this.mTextToImageResolver.pipe((0,_e.q)(1)).subscribe((function(e){e.destroy()})),this.mTextToImageResolver.unsubscribe(),this.mTextToImageEvent.unsubscribe(),delete this.mTextToImageResolver)}},{key:"getResourceController",value:(r=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.mTextToImageResolver.pipe((0,_e.q)(1)).toPromise());case 1:case"end":return e.stop()}}),e,this)})),o=function(){var e=this,t=arguments;return new Promise((function(n,o){var i=r.apply(e,t);function a(e){Qt(i,n,o,a,u,"next",e)}function u(e){Qt(i,n,o,a,u,"throw",e)}a(void 0)}))},function(){return o.apply(this,arguments)})},{key:"broadcastAttributeUpdated",value:function(){this.setValue(this.getValue()),Yt($t(c.prototype),"broadcastAttributeUpdated",this).call(this)}},{key:"getAttribute",value:function(){return this.updateValues(!1),this.mAttributeData}},{key:"updateValues",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.mAttributeData.selected_value_id=this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,this.mAttributeData.selected_value_value=this.getValue(),e&&this.updateMaterial()}},{key:"setValue",value:function(e,t){(0,K.isString)(e)||(this.mValue=Object.assign(this.mValue,e));var n=(0,K.isString)(e)?e:e.value;if(n=qt(n),!(0,K.isNullOrUndefined)(n)){var r=n.length;if(/@size:(\d+\.?\d*);?/.test(n)){var o=n.match(/@size:(\d+\.?\d*)x?;?/),i=o[1];r=r>o.index?o.index:r;var a=parseFloat(i);isNaN(a)||(this.mValue.size=a)}if(/@font:'?"?(.*?)'?"?;?$/.test(n)){var u=n.match(/@font:'?"?(.*?)'?"?;?$/);r=r>u.index?u.index:r;var c=u[1];c.length>1&&(this.mValue.font=c)}r>0&&(r!==n.length&&(r-=1),n=n.slice(0,r)),this.mValue.value=n}this.updateValues();var s=this._getDefaultSetOptions(t);s.emitEvent&&this.broadcastValueChange(this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,this.mValue,s.rebuild)}},{key:"setValueByKey",value:function(e,t){this.setValue(e,t)}},{key:"getValue",value:function(){return this.mValue}},{key:"getValueName",value:function(){var e=this.resolveValuable(),t=this.mValue.font||e&&e.available_fonts&&e.available_fonts[0]||"Arial",n=(0,K.isNullOrUndefined)(this.mValue.size)?"1.00":"".concat(Number(this.mValue.size).toFixed(2));return!(0,K.isNullOrUndefined)(this.mValue.value)&&this.mValue.value.length>0?"".concat(this.mValue.value," @size:").concat(n,"; @font:").concat(t,";"):""}},{key:"resetValue",value:function(e){this.mValue={value:""};var t=this._getDefaultSetOptions(e);t.emitEvent&&this.broadcastValueChange(this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,this.mValue,t.rebuild)}},{key:"getQueryParam",value:function(){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!0===e?Wt({},this.mAttributeData.id,this.getValueName()):{}}},{key:"parse",value:function(e,t){(0,K.isNullOrUndefined)(e)||(0,K.isUndefined)(e.value)||this.setValue(e,t)}},{key:"resolveValuable",value:function(){return this.mAttributeData&&this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].attribute_value_valuable:null}},{key:"updateMaterial",value:function(){var e=this,t=this.resolveValuable();(0,K.isNullOrUndefined)(this.mTextToImageResolver)&&(this.mTextToImageResolver=new ge.t(1),this.resolveProductNode().getRenderState().getResourceManager().getManager(Ge.O.MaterialManager).then((function(t){var n=new Ht.n(t,e.mAttributeData);n.requestFrameSubject().subscribe((function(){e.resolveProductNode().getRenderState().requestFrame()})),e.mTextToImageResolver.next(n),e.mTextToImageResolver.complete()}),(function(t){e.mTextToImageResolver.error(t)})),this.mTextToImageEvent.pipe(St((function(){return(0,st.D)(new Promise((function(n){var r=JSON.parse(JSON.stringify(t)),o=JSON.parse(JSON.stringify(e.mValue)),i=JSON.parse(JSON.stringify(e.mMeta));e.mTextToImageResolver.pipe((0,_e.q)(1)).subscribe((function(t){t.update(r,o,i,e.resolveProductNode()).then((function(){n()}),(function(e){ee.qL.warn("Failed to update text to image: ",e),n()}))}),(function(e){ee.qL.warn("Failed to retrieve material manager:",e),n()}))})))}))).subscribe((function(){ee.qL.print("Text to image updated"),e.resolveProductNode().getRenderState().requestFrame()}),(function(e){ee.qL.warn("Failed to update text to image (pipeline):",e)}))),this.mTextToImageEvent.next()}},{key:"onMaterialUpdated",value:function(e){var t=this.resolveValuable().material_id;e.materialModelId===t&&this.mAttributeData.visible&&0!==this.mAttributeData.visibility&&3!==this.mAttributeData.visibility&&this.updateMaterial()}}],n&&Kt(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(Ee.l);function tn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}en.TypeRTTI=new f.r("AttributeTextToImageController",Ee.l.TypeRTTI);var nn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,(n=[{key:"applyMinMax",value:function(e,t){return Pe.F.isNumeric(e)?(e=Pe.F.isNumeric(t.min_value)&&e<t.min_value?t.min_value:e,e=Pe.F.isNumeric(t.max_value)&&e>t.max_value?t.max_value:e):null}}])&&tn(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function rn(e){return rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rn(e)}function on(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function an(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function un(e,t){return un=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},un(e,t)}function cn(e,t){if(t&&("object"===rn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function sn(e){return sn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},sn(e)}var ln=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&un(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=sn(r);if(o){var n=sn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return cn(this,e)});function a(){return on(this,a),i.apply(this,arguments)}return t=a,n=[{key:"calculate",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if((0,K.isArray)(e)){var r=0,o=e.every((function(e){if(Pe.F.isNumeric(e.value)){var o=parseFloat(e.value);return n&&(o=t.applyMinMax(o,e)),r+=o,!0}return!1}));if(o)return r}return null}}],n&&an(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(nn);function fn(e){return fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fn(e)}function pn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hn(e,t){return hn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},hn(e,t)}function yn(e,t){if(t&&("object"===fn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function mn(e){return mn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},mn(e)}var vn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hn(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=mn(r);if(o){var n=mn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return yn(this,e)});function a(){return pn(this,a),i.apply(this,arguments)}return t=a,n=[{key:"calculate",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if((0,K.isArray)(e)){var r=null,o=e.every((function(e){if(Pe.F.isNumeric(e.value)){var o=parseFloat(e.value);return n&&(o=t.applyMinMax(o,e)),null===r?r=o:r*=o,!0}return!1}));if(o)return r}return null}}],n&&dn(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(nn);function bn(e){return bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bn(e)}function gn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _n(e,t){return _n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},_n(e,t)}function On(e,t){if(t&&("object"===bn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Tn(e){return Tn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Tn(e)}var Rn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_n(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Tn(r);if(o){var n=Tn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return On(this,e)});function a(){return gn(this,a),i.apply(this,arguments)}return t=a,n=[{key:"calculate",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if((0,K.isArray)(e)){var r=null,o=e.every((function(e){if(Pe.F.isNumeric(e.value)){var o=parseFloat(e.value);return n&&(o=t.applyMinMax(o,e)),null===r?r=o:0===o?r=0:r/=o,!0}return!1}));if(o)return r}return null}}],n&&wn(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(nn);function Sn(e){return Sn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sn(e)}function En(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xn(e,t){return xn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},xn(e,t)}function jn(e,t){if(t&&("object"===Sn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Cn(e){return Cn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Cn(e)}var kn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xn(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Cn(r);if(o){var n=Cn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return jn(this,e)});function a(){return En(this,a),i.apply(this,arguments)}return t=a,n=[{key:"calculate",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if((0,K.isArray)(e)){var r=null,o=e.every((function(e){if(Pe.F.isNumeric(e.value)){var o=parseFloat(e.value);return n&&(o=t.applyMinMax(o,e)),null===r?r=o:r-=o,!0}return!1}));if(o)return r}return null}}],n&&Pn(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(nn);function Mn(e){return Mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mn(e)}function Dn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function An(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function In(e,t){return In=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},In(e,t)}function Nn(e,t){if(t&&("object"===Mn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Vn(e){return Vn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Vn(e)}var Un=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&In(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Vn(r);if(o){var n=Vn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Nn(this,e)});function a(){return Dn(this,a),i.apply(this,arguments)}return t=a,n=[{key:"calculate",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if((0,K.isArray)(e)){var r=0,o=e.every((function(e){if(Pe.F.isNumeric(e.value)){var o=parseFloat(e.value);return n&&(o=t.applyMinMax(o,e)),r+=o,r*=r,!0}return!1}));if(o)return r}return null}}],n&&An(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(nn);function Fn(e){return Fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fn(e)}function Bn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ln(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Hn(e,t){return Hn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Hn(e,t)}function zn(e,t){if(t&&("object"===Fn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function qn(e){return qn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},qn(e)}var Gn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Hn(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=qn(r);if(o){var n=qn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return zn(this,e)});function a(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Bn(this,a),(e=i.call(this)).mUseDiameter=t,e.mHalfCircle=n,e}return t=a,n=[{key:"calculate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if((0,K.isArray)(e)&&e.length>0){var n=e[0].value;if(!Pe.F.isNumeric(n))return null;t&&(n=this.applyMinMax(n,e[0])),this.mUseDiameter&&(n*=.5);var r=n*n*3.14159265359;return this.mHalfCircle&&(r*=.5),r}return null}}],n&&Ln(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(nn);function Wn(e){return Wn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wn(e)}function Qn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Kn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Yn(e,t){return Yn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Yn(e,t)}function Zn(e,t){if(t&&("object"===Wn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Xn(e){return Xn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Xn(e)}var Jn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Yn(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Xn(r);if(o){var n=Xn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Zn(this,e)});function a(){return Qn(this,a),i.apply(this,arguments)}return t=a,n=[{key:"calculate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if((0,K.isArray)(e)&&e.length>=3){var n=e[0].value;if(!Pe.F.isNumeric(n))return null;t&&(n=this.applyMinMax(n,e[0]));var r=e[1].value;if(!Pe.F.isNumeric(r))return null;t&&(r=this.applyMinMax(r,e[1]));var o=e[2].value;if(!Pe.F.isNumeric(o))return null;t&&(o=this.applyMinMax(o,e[2]));var i=n+r,a=o*i*.5;return a}return null}}],n&&Kn(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(nn);function $n(e){return $n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$n(e)}function er(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function nr(e,t){return nr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},nr(e,t)}function rr(e,t){if(t&&("object"===$n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function or(e){return or=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},or(e)}var ir=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nr(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=or(r);if(o){var n=or(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return rr(this,e)});function a(){return er(this,a),i.apply(this,arguments)}return t=a,n=[{key:"calculate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if((0,K.isArray)(e)&&e.length>=2){var n=e[0].value;if(!Pe.F.isNumeric(n))return null;t&&(n=this.applyMinMax(n,e[0]));var r=e[1].value;if(!Pe.F.isNumeric(r))return null;t&&(r=this.applyMinMax(r,e[1]));var o=r*n*.5;return o}return null}}],n&&tr(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(nn);function ar(e){return ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ar(e)}function ur(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function sr(e,t){return sr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},sr(e,t)}function lr(e,t){if(t&&("object"===ar(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function fr(e){return fr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},fr(e)}var pr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sr(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=fr(r);if(o){var n=fr(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return lr(this,e)});function a(){return ur(this,a),i.apply(this,arguments)}return t=a,n=[{key:"calculate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if((0,K.isArray)(e)&&e.length>=3){var n=e[0].value;if(!Pe.F.isNumeric(n))return null;t&&(n=this.applyMinMax(n,e[0]));var r=e[1].value;if(!Pe.F.isNumeric(r))return null;t&&(r=this.applyMinMax(r,e[1]));var o=e[2].value;if(!Pe.F.isNumeric(o))return null;t&&(o=this.applyMinMax(o,e[2]));var i=.5*(n+r)*o;return i}return null}}],n&&cr(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(nn);function dr(e){return dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dr(e)}function hr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function mr(e,t){return mr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},mr(e,t)}function vr(e,t){if(t&&("object"===dr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function br(e){return br=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},br(e)}var gr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mr(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=br(r);if(o){var n=br(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return vr(this,e)});function a(){return hr(this,a),i.apply(this,arguments)}return t=a,n=[{key:"calculate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if((0,K.isArray)(e)&&e.length>=3){var n=e[0].value;if(!Pe.F.isNumeric(n))return null;t&&(n=this.applyMinMax(n,e[0]));var r=e[1].value;if(!Pe.F.isNumeric(r))return null;t&&(r=this.applyMinMax(r,e[1]));var o=e[2].value;if(!Pe.F.isNumeric(o))return null;t&&(o=this.applyMinMax(o,e[2]));var i=n*o,a=(r-n)*o*.5,u=i+a;return u}return null}}],n&&yr(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(nn);function wr(e){return wr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wr(e)}function _r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Or(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Tr(e,t){return Tr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Tr(e,t)}function Rr(e,t){if(t&&("object"===wr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Sr(e){return Sr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Sr(e)}var Er=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Tr(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Sr(r);if(o){var n=Sr(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Rr(this,e)});function a(){return _r(this,a),i.apply(this,arguments)}return t=a,n=[{key:"calculate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if((0,K.isArray)(e)&&e.length>=3){var n=e[0].value;if(!Pe.F.isNumeric(n))return null;t&&(n=this.applyMinMax(n,e[0]));var r=e[1].value;if(!Pe.F.isNumeric(r))return null;t&&(r=this.applyMinMax(r,e[1]));var o=e[2].value;if(!Pe.F.isNumeric(o))return null;t&&(o=this.applyMinMax(o,e[2]));var i=n+r,a=o*i;return a}return null}}],n&&Or(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(nn);function Pr(e){return Pr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pr(e)}function xr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Cr(e,t){return Cr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Cr(e,t)}function kr(e,t){if(t&&("object"===Pr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Mr(e){return Mr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Mr(e)}var Dr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Cr(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Mr(r);if(o){var n=Mr(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return kr(this,e)});function a(){return xr(this,a),i.apply(this,arguments)}return t=a,n=[{key:"calculate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if((0,K.isArray)(e)&&e.length>=3){var n=e[0].value;if(!Pe.F.isNumeric(n))return null;t&&(n=this.applyMinMax(n,e[0]));var r=e[1].value;if(!Pe.F.isNumeric(r))return null;t&&(r=this.applyMinMax(r,e[1]));var o=e[2].value;if(!Pe.F.isNumeric(o))return null;t&&(o=this.applyMinMax(o,e[2]));var i=n>r?n:r,a=o*i;return a}return null}}],n&&jr(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(nn);function Ar(e){return Ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ar(e)}function Ir(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Nr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vr(){return Vr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=Ur(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Vr.apply(this,arguments)}function Ur(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Lr(e)););return e}function Fr(e,t){return Fr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Fr(e,t)}function Br(e,t){if(t&&("object"===Ar(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Lr(e){return Lr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Lr(e)}var Hr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Fr(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Lr(r);if(o){var n=Lr(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Br(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e,t)).mOperationController=null,n.mDefaultOperands=null,n.mValue={operands:[],calculated_value:null},n.updateValueOperands(),n}return t=a,n=[{key:"getType",value:function(){return a.TypeRTTI}},{key:"updateValueOperands",value:function(){this.mOperationController=null,this.mValue.operands=[];var e=this.mAttributeData.attribute_values;if(e.length>0){var t=e[0].attribute_value_valuable;(0,K.isArray)(t.operands)&&(this.mDefaultOperands=JSON.parse(JSON.stringify(t.operands)),this.mValue.operands=t.operands,this.mValue.operands.forEach((function(e){Pe.F.isNumeric(e.value)?e.value=parseFloat(e.value):e.value=null,Pe.F.isNumeric(e.min_value)?e.min_value=parseFloat(e.min_value):e.min_value=null,Pe.F.isNumeric(e.max_value)?e.max_value=parseFloat(e.max_value):e.max_value=null}))),!(0,K.isNullOrUndefined)(t.operation)&&t.operation.length>0&&this.createOperationController(t.operation)}this.updateCalculatedValue()}},{key:"createOperationController",value:function(e){if(!(0,K.isNullOrUndefined)(e)&&e.length>0)switch(e){case"add":this.mOperationController=new ln;break;case"multiply":this.mOperationController=new vn;break;case"divide":this.mOperationController=new Rn;break;case"subtract":this.mOperationController=new kn;break;case"squared":this.mOperationController=new Un;break;case"circle_area":this.mOperationController=new Gn(!1,!1);break;case"half_circle_area":this.mOperationController=new Gn(!1,!0);break;case"circle_area_d":this.mOperationController=new Gn(!0,!1);break;case"half_circle_area_d":this.mOperationController=new Gn(!0,!0);break;case"triangle_area":case"parallelogram_area":this.mOperationController=new Jn;break;case"right_triangle_area":case"symmetric_triangle_area":this.mOperationController=new ir;break;case"trapezium_area":this.mOperationController=new pr;break;case"rect_bevelled_long_area":case"rect_bevelled_short_area":this.mOperationController=new gr;break;case"max_length_area":this.mOperationController=new Dr;break;case"composite_length_area":this.mOperationController=new Er}}},{key:"broadcastAttributeUpdated",value:function(){this.updateValueOperands(),Vr(Lr(a.prototype),"broadcastAttributeUpdated",this).call(this)}},{key:"updateCalculatedValue",value:function(){this.mValue.calculated_value=null,(0,K.isNullOrUndefined)(this.mOperationController)||(this.mValue.calculated_value=this.mOperationController.calculate(this.mValue.operands,!1))}},{key:"getAttribute",value:function(){return this.updateValues(),this.mAttributeData}},{key:"updateValues",value:function(){this.mAttributeData.selected_value_id=this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,this.mAttributeData.selected_value_value=this.getValue()}},{key:"setValue",value:function(e,t){var n=this;(0,K.isNullOrUndefined)(e)||Object.keys(e).forEach((function(t){if(Pe.F.isNumeric(t)){var r=parseInt(t,10);Pe.F.isNumeric(e[t].value)&&r<n.mValue.operands.length&&(n.mValue.operands[r].value=parseFloat(e[t].value))}})),this.updateCalculatedValue(),this.updateValues();var r=this._getDefaultSetOptions(t);r.emitEvent&&this.broadcastValueChange(this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,this.mValue,r.rebuild)}},{key:"setValueByKey",value:function(e,t){this.setValue(e,t)}},{key:"compareValue",value:function(e){return e==this.getValue().calculated_value}},{key:"getValue",value:function(){return this.updateCalculatedValue(),this.mValue}},{key:"getValueName",value:function(){return this.updateCalculatedValue(),(0,K.isNullOrUndefined)(this.mValue.calculated_value)?"":this.mValue.calculated_value.toString()}},{key:"resetValue",value:function(e){this.mValue.calculated_value=null,(0,K.isNullOrUndefined)(this.mDefaultOperands)?(0,K.isArray)(this.mValue.operands)&&this.mValue.operands.forEach((function(e){return e.value=null})):this.mValue.operands=JSON.parse(JSON.stringify(this.mDefaultOperands));var t=this._getDefaultSetOptions(e);t.emitEvent&&this.broadcastValueChange(this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,this.mValue,t.rebuild)}},{key:"getQueryParam",value:function(){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!0===e?Ir({},this.mAttributeData.id,this.getValueName()):{}}},{key:"parse",value:function(e,t){if(ee.qL.print("parsing operable with: ",e),!(0,K.isNullOrUndefined)(e)&&(0,K.isArray)(e.operands)){var n={};e.operands.forEach((function(e,t){n[t]=e})),this.setValue(n,t)}}}],n&&Nr(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(Ee.l);Hr.TypeRTTI=new f.r("AttributeOperableNumbersInputController",Ee.l.TypeRTTI);var zr=n(79816);function qr(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function Gr(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){qr(i,r,o,a,u,"next",e)}function u(e){qr(i,r,o,a,u,"throw",e)}a(void 0)}))}}function Wr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Qr=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mProductAttributeManager=t}var t,n,r,o;return t=e,n=[{key:"onAttributeChanged",get:function(){return this.mProductAttributeManager.onAttributeChanged}},{key:"onAttributeUpdated",get:function(){return this.mProductAttributeManager.onAttributeUpdated}},{key:"onAttributeModerated",get:function(){return this.mProductAttributeManager.onAttributeModerated}},{key:"getMaterialGroupManager",value:function(){return this.mProductAttributeManager._getMaterialGroupManager()}},{key:"hasAttribute",value:function(e){this.mProductAttributeManager._hasAttribute(e)}},{key:"getRawAttributes",value:function(){return this.mProductAttributeManager._getRawAttributes()}},{key:"getAttributes",value:function(){return this.mProductAttributeManager._getAttributes()}},{key:"cloneAttributes",value:function(){return this.mProductAttributeManager._cloneAttributes()}},{key:"getAttribute",value:function(e){return this.mProductAttributeManager._getAttribute(e)}},{key:"getAttributeByName",value:function(e){return this.mProductAttributeManager._getAttributeByName(e)}},{key:"getAttributeControllers",value:function(){return this.mProductAttributeManager._getAttributeControllers()}},{key:"getAttributeController",value:function(e){return this.mProductAttributeManager._getAttributeController(e)}},{key:"getAttributeControllerByName",value:function(e){return this.mProductAttributeManager._getAttributeControllerByName(e)}},{key:"setValue",value:(o=Gr(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.mProductAttributeManager._setValue(t,n,r);case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return o.apply(this,arguments)})},{key:"getValue",value:function(e){return this.mProductAttributeManager._getValue(e)}},{key:"getValueName",value:function(e){return this.mProductAttributeManager._getValueName(e)}},{key:"resetValue",value:function(e,t){this.mProductAttributeManager._resetValue(e,t)}},{key:"setValueByName",value:(r=Gr(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.mProductAttributeManager._setValueByName(t,n,r);case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"getValueByName",value:function(e){return this.mProductAttributeManager._getValueByName(e)}},{key:"setValueByKey",value:function(e,t,n){this.mProductAttributeManager._setValueByKey(e,t,n)}},{key:"getValueByKey",value:function(e){return this.mProductAttributeManager._getValueByKey(e)}},{key:"getValueNameByName",value:function(e){return this.mProductAttributeManager._getValueNameByName(e)}},{key:"resetValueByName",value:function(e,t){this.mProductAttributeManager._resetValueByName(e,t)}},{key:"resetAllValues",value:function(e){return this.mProductAttributeManager._resetAllValues(e)}},{key:"setVisibility",value:function(e,t,n){this.mProductAttributeManager._setVisibility(e,t,n)}},{key:"setVisibilityByName",value:function(e,t,n){this.mProductAttributeManager._setVisibilityByName(e,t,n)}},{key:"isVisible",value:function(e,t){return this.mProductAttributeManager._isVisible(e,t)}},{key:"buildQueryParams",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.mProductAttributeManager._buildQueryParams(e,t)}},{key:"serialize",value:function(e){return this.mProductAttributeManager._serialize(e)}},{key:"parse",value:function(e,t){this.mProductAttributeManager._parse(e,t)}},{key:"hashConfiguration",value:function(){return this.mProductAttributeManager._hashConfiguration()}}],n&&Wr(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Kr=n(14311),Yr=n(49575);function Zr(e){return Zr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zr(e)}function Xr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Jr(e,t){return Jr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Jr(e,t)}function $r(e,t){if(t&&("object"===Zr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function eo(e){return eo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},eo(e)}var to=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Jr(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=eo(r);if(o){var n=eo(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return $r(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e,t)).mValue="",n}return t=a,(n=[{key:"getType",value:function(){return a.TypeRTTI}},{key:"getAttribute",value:function(){return this.mAttributeData.selected_value_id=this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,this.mAttributeData.selected_value_value=this.getValue(),this.mAttributeData}},{key:"setValue",value:function(e,t){this.mValue=e;var n=this._getDefaultSetOptions(t);n.emitEvent&&this.broadcastValueChange(this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,this.mValue,n.rebuild)}},{key:"setValueByKey",value:function(e,t){this.setValue(e,t)}},{key:"getValue",value:function(){return this.mValue}},{key:"getValueName",value:function(){return this.mValue}},{key:"resetValue",value:function(e){this.mValue="";var t=this._getDefaultSetOptions(e);t.emitEvent&&this.broadcastValueChange(this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,this.mValue,t.rebuild)}},{key:"getQueryParam",value:function(){return{}}},{key:"parse",value:function(e,t){}},{key:"serialize",value:function(e){return null}}])&&Xr(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(Ee.l);to.TypeRTTI=new f.r("AttributeSeparatorController",Ee.l.TypeRTTI);var no=n(79843),ro=(n(57327),n(88449),n(59849),n(49337),n(33321),n(97962));function oo(e){return oo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oo(e)}function io(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ao(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?io(Object(n),!0).forEach((function(t){uo(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):io(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function uo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function co(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function so(){return so="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=lo(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},so.apply(this,arguments)}function lo(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ho(e)););return e}function fo(e,t){return fo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},fo(e,t)}function po(e,t){if(t&&("object"===oo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ho(e){return ho=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ho(e)}var yo=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fo(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ho(r);if(o){var n=ho(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return po(this,e)});function a(e,t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e,t)).mValue={name:"",attribute:"",key:"",media_id:null,svg_element:null};var r=n.resolveValuable();if(!(0,K.isNullOrUndefined)(r)&&!(0,K.isNullOrUndefined)(r.attributes)&&r.attributes.length>0){var o=r.attributes.find((function(e){return Pe.F.isTrue(e.default)}));(0,K.isNullOrUndefined)(o)?n.setValue(r.attributes[0].key):n.setValue(o.key)}return n}return t=a,(n=[{key:"getType",value:function(){return a.TypeRTTI}},{key:"getAttribute",value:function(){return this.updateValues(),this.mAttributeData}},{key:"updateValues",value:function(){this.mAttributeData.selected_value_id=this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,this.mAttributeData.selected_value_value=this.getValue()}},{key:"setValue",value:function(e,t){var n=this;if((0,K.isString)(e)){var r=this.mAttributeData.attribute_values[0].attribute_value_valuable,o=r.attributes.find((function(t){return t.key===e}));o&&(this.mValue={key:o.key,media_id:r.media_id,svg_element:r.svg_element,name:o.name,attribute:o.attribute,value:o.value})}else this.mValue=ao(ao({},this.mValue),e);this.updateValues();var i=this.resolveValuable();null!==i?this.resolveSvgTextureController(i.media_id).then((function(e){e.updateElement(i.svg_element,n.getValue()).then((function(){n.broadcast(t)}),(function(){n.broadcast(t)}))}),(function(){n.broadcast(t)})):this.broadcast(t)}},{key:"broadcast",value:function(e){var t=this._getDefaultSetOptions(e);t.emitEvent&&this.broadcastValueChange(this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,this.mValue,t.rebuild)}},{key:"setValueByKey",value:function(e,t){this.setValue(e,t)}},{key:"compareValue",value:function(e){return e==this.getValue().value}},{key:"getValue",value:function(){if(this.mAttributeData.attribute_values.length>0){var e=this.mAttributeData.attribute_values[0].attribute_value_valuable;(0,K.isNullOrUndefined)(e)||(this.mValue.media_id=e.media_id,this.mValue.svg_element=e.svg_element)}return this.mValue}},{key:"getValueName",value:function(){return this.getValue().name}},{key:"resetValue",value:function(e){this.mValue.name="",this.mValue.attribute="",this.mValue.key="",delete this.mValue.value;var t=this._getDefaultSetOptions(e);t.emitEvent&&this.broadcastValueChange(this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,this.mValue,t.rebuild)}},{key:"setVisibility",value:function(e,t){if(!this.visibleOnFrame)return so(ho(a.prototype),"setVisibility",this).call(this,!1);if(t&&!(0,K.isNullOrUndefined)(t.option_id))try{var n=this.mAttributeData.attribute_values[0].attribute_value_valuable.attributes.find((function(e){return e.key===t.option_id}));n&&(n.visible=e)}catch(e){ee.qL.print("failed to get svg valuable: ",e)}else so(ho(a.prototype),"setVisibility",this).call(this,e,t)}},{key:"getQueryParam",value:function(){return{}}},{key:"parse",value:function(e,t){(0,K.isNullOrUndefined)(e)||this.setValue(e,t)}},{key:"resolveValuable",value:function(){return this.mAttributeData&&this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].attribute_value_valuable:null}}])&&co(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(ro.v);yo.TypeRTTI=new f.r("AttributeSvgElementController",ro.v.TypeRTTI),n(69600),n(69720),n(91038);var mo=n(89002),vo=n(59342);function bo(e){return bo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bo(e)}function go(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=wo(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw i}}}}function wo(e,t){if(e){if("string"==typeof e)return _o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_o(e,t):void 0}}function _o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Oo(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function To(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Oo(i,r,o,a,u,"next",e)}function u(e){Oo(i,r,o,a,u,"throw",e)}a(void 0)}))}}function Ro(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function So(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ro(Object(n),!0).forEach((function(t){Eo(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ro(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Eo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Po(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xo(){return xo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=jo(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},xo.apply(this,arguments)}function jo(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Mo(e)););return e}function Co(e,t){return Co=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Co(e,t)}function ko(e,t){if(t&&("object"===bo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Mo(e){return Mo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Mo(e)}var Do=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Co(e,t)}(f,e);var t,n,r,o,i,a,u,c,s,l=(c=f,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Mo(c);if(s){var n=Mo(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return ko(this,e)});function f(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(n=l.call(this,e,t)).mValue=So({media_id:0,svg_element:"",clipping_element:void 0},f.getDefaultOptions()),n.canvasGroup="",n.canvasGroup=mo.F.uuidV4(),n.setValue(f.getDefaultOptions(),{emitEvent:!1,rebuild:!1}).then((function(){}),(function(e){ee.qL.error(e)})),n.mTextureResolver.subscribe(function(){var e=To(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.mTextureController=t;case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n}return t=f,n=[{key:"getType",value:function(){return f.TypeRTTI}},{key:"getAttribute",value:function(){return this.updateValues(),this.mAttributeData}},{key:"getQueryParam",value:function(e,t){return!0===t?Eo({},this.mAttributeData.id,JSON.stringify(this.getValue())):{}}},{key:"getValue",value:function(){return this.mValue}},{key:"getValueName",value:function(){var e,t,n,r=["id"],o=[],i=go(this.mValue.canvas.objects);try{for(i.s();!(e=i.n()).done;){for(var a=e.value,u=[],c=0,s=Object.entries(a);c<s.length;c++){var l=(t=s[c],n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,u=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){u=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(u)throw o}}return i}}(t,n)||wo(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),f=l[0],p=l[1];r.includes(f)||u.push("@".concat(f,":").concat(p,";"))}o.push(u.join(" "))}}catch(e){i.e(e)}finally{i.f()}return o.join("|")}},{key:"parse",value:(u=To(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,K.isNullOrUndefined)(t)||(0,K.isNullOrUndefined)(t.canvas)){e.next=3;break}return e.next=3,this.setValue(t);case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"serialize",value:function(e){var t=xo(Mo(f.prototype),"serialize",this).call(this,e);if(!0!==e.calculate_approximations||!t||!this.mTextureController)return t;if(this.mSvgElementBoundary||(this.mSvgElementBoundary=this.mTextureController.getBoundariesSync(this.mValue.svg_element,void 0,!0)),!this.mSvgElementBoundary)return t;var n=this.calculateSurfaceCoverage();return t.attribute_value.svg_canvas_surface=n,t}},{key:"resetValue",value:(a=To(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.setValue(f.getDefaultOptions(),t);case 3:return e.prev=3,this.broadcast(t),e.finish(3);case 6:case"end":return e.stop()}}),e,this,[[0,,3,6]])}))),function(e){return a.apply(this,arguments)})},{key:"setValue",value:(i=To(regeneratorRuntime.mark((function e(t,n){var r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t,this.copyValueFromCanvas(t.canvas||r),this.validateEmojisInTextObjects(),this.updateValues(),e.prev=4,e.next=7,this.resolveSvgTextureController(this.mValue.media_id);case 7:return o=e.sent,e.next=10,o.updateCanvas(this.mValue.svg_element,this.canvasGroup,this.mValue);case 10:return e.prev=10,this.broadcast(n),e.finish(10);case 13:case"end":return e.stop()}}),e,this,[[4,,10,13]])}))),function(e,t){return i.apply(this,arguments)})},{key:"validateEmojisInTextObjects",value:function(){var e=this.mValue.canvas.objects.filter((function(e){return"i-text"===e.type}));if(!(0,K.isNullOrUndefined)(e)){var t,n=go(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.text=qt(r.text)}}catch(e){n.e(e)}finally{n.f()}}}},{key:"broadcast",value:function(e){var t=this._getDefaultSetOptions(e);t.emitEvent&&this.broadcastValueChange(this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,this.mValue,t.rebuild)}},{key:"setValueByKey",value:(o=To(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setValue(t,n);case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"copyValueFromCanvas",value:function(e){var t=e||{objects:[],type:"",version:1};t.objects=Array.isArray(e.objects)?e.objects:[],this.mValue.canvas.type=t.type||"",this.mValue.canvas.version=void 0!==t.version?Number(e.version):0,this.mValue.canvas.objects=t.objects.map((function(e){var t=JSON.parse(JSON.stringify(e));return Object.keys(t).forEach((function(e){t[e]=Pe.F.isNumeric(t[e])?Number(t[e]):t[e]})),So({id:mo.F.guid(),key:"",type:"",width:0,height:0,scaleX:1,scaleY:1,angle:0,top:0,left:0},t)}))}},{key:"updateValues",value:function(){if(this.mAttributeData.attribute_values.length>0){this.mAttributeData.selected_value_id=this.mAttributeData.attribute_values[0].id;var e=this.mAttributeData.attribute_values[0].attribute_value_valuable;Array.isArray(e.available_fonts)&&0!==e.available_fonts.length||(e.available_fonts=["Arial","Times New Roman"]),this.mValue.media_id=e.media_id||0,this.mValue.svg_element=e.svg_element}this.mAttributeData.selected_value_value=this.getValue()}},{key:"calculateSurfaceCoverage",value:function(){var e=this,t=this.mSvgElementBoundary.left,n=this.mSvgElementBoundary.top,r=Math.floor(this.mSvgElementBoundary.width*this.mSvgElementBoundary.scaleX),o=Math.floor(this.mSvgElementBoundary.height*this.mSvgElementBoundary.scaleY),i=(this.mValue.canvas.objects||[]).map((function(t){var n=e.mTextureController.getBoundariesSync(t.id,e.canvasGroup,!0);if(n)switch(n.id=t.id,n.width*=n.scaleX,n.height*=n.scaleY,t.type){case"i-text":case"image":return n;default:return}})).filter((function(e){if(!e)return!1;var i=e.bbox.min.x,a=e.bbox.min.y,u=e.bbox.max.x,c=e.bbox.max.y;if(i>t&&a>n&&u<t+r&&c<n+o)return!0;if(i<t&&u>t+r||a<n&&c>n+o)return!0;var s=e.coords.tl.x>t&&e.coords.tl.x<t+r&&e.coords.tl.y>n&&e.coords.tl.y<n+o,l=e.coords.tr.x>t&&e.coords.tr.x<t+r&&e.coords.tr.y>n&&e.coords.tr.y<n+o,f=e.coords.bl.x>t&&e.coords.bl.x<t+r&&e.coords.bl.y>n&&e.coords.bl.y<n+o,p=e.coords.br.x>t&&e.coords.br.x<t+r&&e.coords.br.y>n&&e.coords.br.y<n+o;if(s||l||f||p)return!0;var d=new THREE.Vector2(t,n),h=new THREE.Vector2(t+r,n),y=new THREE.Vector2(t,n+o),m=new THREE.Vector2(t+r,n+o),v=new THREE.Vector2(e.coords.tl.x,e.coords.tl.y),b=new THREE.Vector2(e.coords.tr.x,e.coords.tr.y),g=new THREE.Vector2(e.coords.bl.x,e.coords.bl.y),w=new THREE.Vector2(e.coords.br.x,e.coords.br.y),_=vo.M.LineLineIntersection(d,h,v,b),O=vo.M.LineLineIntersection(d,h,b,w),T=vo.M.LineLineIntersection(d,h,w,g),R=vo.M.LineLineIntersection(d,h,g,v);if(_||O||T||R)return!0;var S=vo.M.LineLineIntersection(m,y,v,b),E=vo.M.LineLineIntersection(m,y,b,w),P=vo.M.LineLineIntersection(m,y,w,g),x=vo.M.LineLineIntersection(m,y,g,v);return!!(S||E||P||x)})),a=r*o,u=0,c=0;return i.length>0&&a>0&&(i.map((function(e){return e.minX=e.bbox.min.x<t?t:e.bbox.min.x,e.minY=e.bbox.min.y<n?n:e.bbox.min.y,e.maxX=e.bbox.max.x>t+r?t+r:e.bbox.max.x,e.maxY=e.bbox.max.y>n+o?n+o:e.bbox.max.y,e})).forEach((function(e){u+=(e.maxX-e.minX)*(e.maxY-e.minY)})),c=(u=Math.min(u,a))/a*100),c}}],r=[{key:"getDefaultOptions",value:function(){return{canvas:{objects:[],type:"",version:0}}}}],n&&Po(t.prototype,n),r&&Po(t,r),Object.defineProperty(t,"prototype",{writable:!1}),f}(ro.v);function Ao(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function Io(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Do.TypeRTTI=new Re.rz("AttributeSvgCanvasController",ro.v.TypeRTTI),n(32023),n(51532),n(10072),n(23042),n(99137),n(71957),n(96306),n(103),n(74592),n(58276),n(35082),n(12813),n(18222),n(38563),n(50336),n(7512);var No=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r,o;return t=e,n=[{key:"setNext",value:function(e){return this.mNext=e,this}},{key:"handle",value:(r=regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve(this.execute(t,n));case 2:if(!this.mNext){e.next=5;break}return e.next=5,this.mNext.handle(t,n);case 5:case"end":return e.stop()}}),e,this)})),o=function(){var e=this,t=arguments;return new Promise((function(n,o){var i=r.apply(e,t);function a(e){Ao(i,n,o,a,u,"next",e)}function u(e){Ao(i,n,o,a,u,"throw",e)}a(void 0)}))},function(e,t){return o.apply(this,arguments)})}],n&&Io(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Vo(e){return Vo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vo(e)}function Uo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Fo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Bo(e,t){return Bo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Bo(e,t)}function Lo(e,t){if(t&&("object"===Vo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ho(e){return Ho=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ho(e)}var zo=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Bo(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ho(r);if(o){var n=Ho(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Lo(this,e)});function a(){return Uo(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"execute",value:function(e,t){var n=e.svgEngine.getRootGroup();n.getObjects().forEach((function(e){e.visible||n.remove(e)}))}}])&&Fo(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(No);function qo(e){return qo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qo(e)}function Go(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Wo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qo(e,t){return Qo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Qo(e,t)}function Ko(e,t){if(t&&("object"===qo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Yo(e){return Yo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Yo(e)}var Zo=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Qo(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Yo(r);if(o){var n=Yo(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Ko(this,e)});function a(){return Go(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"execute",value:function(e,t){var n=this;e.svgEngine.getObjects().forEach((function(e){n.updateOpacity(e)}))}},{key:"updateOpacity",value:function(e){e.element.opacity<=0?e.element.visible=!1:e.element.opacity=1}}])&&Wo(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(No);function Xo(e){return Xo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xo(e)}function Jo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ei(e,t){return ei=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ei(e,t)}function ti(e,t){if(t&&("object"===Xo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ni(e){return ni=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ni(e)}n(43290);var ri=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ei(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ni(r);if(o){var n=ni(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return ti(this,e)});function a(){return Jo(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"execute",value:function(e,t){e.svgEngine.getObjects().forEach((function(e){if(!e.element.hasFill()||"linear"===e.element.fill.type||"radial"===e.element.fill.type){var t=e.element.fill.colorStops;if(t&&0!==t.length){var n=t.find((function(e){return 0===e.offset}))||t[0];n&&(e.element.fill=n.color)}}}))}}])&&$o(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(No);function oi(e){return oi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oi(e)}function ii(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ai(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ui(e,t){return ui=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ui(e,t)}function ci(e,t){if(t&&("object"===oi(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function si(e){return si=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},si(e)}var li=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ui(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=si(r);if(o){var n=si(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return ci(this,e)});function a(){return ii(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"execute",value:function(e,t){var n=this,r=e.svgEngine.getObjects(),o=new Map;r.forEach((function(e){if(e.element.type&&"group"!==e.element.type){var t=n.getColor(e);0!==t.length&&(o.has(t)?o.get(t).push(e):o.set(t,[e]))}})),e.palette=o}},{key:"getColor",value:function(e){if(!Array.isArray(e.element.colorProperties)||0===e.element.colorProperties.length)return"";if(e.element.hasFill()&&"string"!=typeof e.element.fill){if("linear"===e.element.fill.type||"radial"===e.element.fill.type){var t=e.element.fill.colorStops[0];return this.convertToHex(t.color)}return""}return this.convertToHex(e.element.fill)}},{key:"convertToHex",value:function(e){return"#".concat(new THREE.Color(e).getHexString())}}])&&ai(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(No);function fi(e){return fi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fi(e)}function pi(e,t){if(e){if("string"==typeof e)return di(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?di(e,t):void 0}}function di(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function hi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function mi(e,t){return mi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},mi(e,t)}function vi(e,t){if(t&&("object"===fi(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function bi(e){return bi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},bi(e)}var gi=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mi(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=bi(r);if(o){var n=bi(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return vi(this,e)});function a(){var e;return hi(this,a),(e=i.apply(this,arguments)).Pr=.2126,e.Pg=.7152,e.Pb=.0722,e.rd=255,e.gd=255,e.bd=255,e.euclMax=Math.sqrt(e.Pr*e.rd*e.rd+e.Pg*e.gd*e.gd+e.Pb*e.bd*e.bd),e.manhMax=e.Pr*e.rd+e.Pg*e.gd+e.Pb*e.bd,e.mColorDistanceMethod="manhattan",e}return t=a,(n=[{key:"execute",value:function(e,t){var n,r=e.palette,o=t.maxColors||1;if(!(r.size<=o)){for(var i=.01;r.size>o;){for(var a=Array.from(r.keys()),u=0;u<a.length;u++)if(r.has(a[u]))for(var c=0;c<a.length;c++)if(r.has(a[c])&&u!==c){var s=a[u],l=a[c],f=this.hex2rgb(s),p=this.hex2rgb(l);if(this.colorDistance(f,p)<=i){var d,h=r.get(l);r.delete(l),(d=r.get(s)).push.apply(d,function(e){if(Array.isArray(e))return di(e)}(n=h)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||pi(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())}if(r.size<=o)break}i+=.005}var y,m=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=pi(e))){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw i}}}}(r);try{var v=function(){var e=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,u=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){u=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(u)throw o}}return i}}(e,t)||pi(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(y.value,2),t=e[0];e[1].forEach((function(e){e.element.fill=t}))};for(m.s();!(y=m.n()).done;)v()}catch(e){m.e(e)}finally{m.f()}}}},{key:"colorDistance",value:function(e,t){switch(this.mColorDistanceMethod){case"euclidean":return this.euclideanDistance(e,t);case"manhattan":return this.manhattanDistance(e,t)}}},{key:"euclideanDistance",value:function(e,t){var n=t[0]-e[0],r=t[1]-e[1],o=t[2]-e[2];return Math.sqrt(this.Pr*n*n+this.Pg*r*r+this.Pb*o*o)/this.euclMax}},{key:"manhattanDistance",value:function(e,t){var n=Math.abs(t[0]-e[0]),r=Math.abs(t[1]-e[1]),o=Math.abs(t[2]-e[2]);return(this.Pr*n+this.Pg*r+this.Pb*o)/this.manhMax}},{key:"hex2rgb",value:function(e){var t="#"===e[0]?e.substring(1):e;return 3===t.length?[parseInt(String(17*parseInt(t[0],16)),10),parseInt(String(17*parseInt(t[1],16)),10),parseInt(String(17*parseInt(t[2],16)),10)]:6===t.length?[parseInt(String(parseInt(t[0]+t[1],16)),10),parseInt(String(parseInt(t[2]+t[3],16)),10),parseInt(String(parseInt(t[4]+t[5],16)),10)]:[0,0,0]}}])&&yi(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(No);function wi(e){return wi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wi(e)}function _i(e,t){if(e){if("string"==typeof e)return Oi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Oi(e,t):void 0}}function Oi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ti(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ri(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Si(e,t){return Si=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Si(e,t)}function Ei(e,t){if(t&&("object"===wi(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Pi(e){return Pi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Pi(e)}var xi=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Si(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Pi(r);if(o){var n=Pi(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Ei(this,e)});function a(){return Ti(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"execute",value:function(e,t){var n,r=this,o=e.palette,i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_i(e))){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw i}}}}(e.paletteOverride);try{var a=function(){var e,t,i=(e=n.value,t=2,function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,u=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){u=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(u)throw o}}return i}}(e,t)||_i(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=i[0],u=i[1];if(!u)return{v:void 0};var c=o.get(a);if(!c)return{v:void 0};c.forEach((function(e){r.overrideColor(e.element,u)}))};for(i.s();!(n=i.n()).done;){var u=a();if("object"===wi(u))return u.v}}catch(e){i.e(e)}finally{i.f()}}},{key:"overrideColor",value:function(e,t){var n=e.colorProperties;Array.isArray(n)&&n.length>0?(n.forEach((function(n){Pe.F.isNonEmptyString(e[n])&&(e[n]=t)})),e.clipPath&&this.overrideColor(e.clipPath,t)):e.fill&&(e.fill=t)}}])&&Ri(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(No);function ji(e){return ji="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ji(e)}function Ci(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ki(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Mi(e,t){return Mi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Mi(e,t)}function Di(e,t){if(t&&("object"===ji(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ai(e){return Ai=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ai(e)}var Ii=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Mi(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ai(r);if(o){var n=Ai(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Di(this,e)});function a(){return Ci(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"execute",value:function(e,t){var n=this;e.svgEngine.getObjects().forEach((function(e){n.fixColor(e.element)}))}},{key:"fixColor",value:function(e){if(Array.isArray(e.colorProperties)&&0!==e.colorProperties.length)if(!e.hasFill()||"string"==typeof e.fill||"linear"!==e.fill.type&&"radial"!==e.fill.type){e.clipPath&&this.fixColor(e.clipPath);var t=this.convertToHex(e,e.fill);Pe.F.isNonEmptyString(t)&&(e.fill=t),Pe.F.isNonEmptyString(e.fillRule)&&(e.fillRule="nonzero")}else{var n=e.fill.colorStops[0],r=this.convertToHex(e,n.color);Pe.F.isNonEmptyString(r)&&(n.color=r)}}},{key:"convertToHex",value:function(e,t){if(t)return"currentColor"===t?e.group?this.convertToHex(e.group,e.group.fill):"#000000":"#".concat(new THREE.Color(t).getHexString())}}])&&ki(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(No);function Ni(e){return Ni="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ni(e)}function Vi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ui(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fi(e,t){return Fi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Fi(e,t)}function Bi(e,t){if(t&&("object"===Ni(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Li(e){return Li=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Li(e)}var Hi=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Fi(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Li(r);if(o){var n=Li(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Bi(this,e)});function a(){return Vi(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"execute",value:function(e,t){var n=this;e.svgEngine.getObjects().forEach((function(e){n.removeShadows(e)}))}},{key:"removeShadows",value:function(e){e.element.shadow&&(e.element.shadow=null)}}])&&Ui(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(No);function zi(e){return zi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zi(e)}function qi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wi(e,t){return Wi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Wi(e,t)}function Qi(e,t){if(t&&("object"===zi(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ki(e){return Ki=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ki(e)}var Yi=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Wi(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ki(r);if(o){var n=Ki(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Qi(this,e)});function a(){return qi(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"execute",value:function(e,t){}}])&&Gi(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(No);function Zi(e){return Zi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zi(e)}function Xi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ji(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $i(e,t){return $i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},$i(e,t)}function ea(e,t){if(t&&("object"===Zi(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ta(e){return ta=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ta(e)}var na=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$i(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ta(r);if(o){var n=ta(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return ea(this,e)});function a(){return Xi(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"execute",value:function(e,t){}}])&&Ji(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(No);function ra(e){return ra="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ra(e)}function oa(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ia(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function aa(e,t){return aa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},aa(e,t)}function ua(e,t){if(t&&("object"===ra(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ca(e){return ca=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ca(e)}n(44048);var sa=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aa(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ca(r);if(o){var n=ca(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return ua(this,e)});function a(){var e;return oa(this,a),(e=i.apply(this,arguments)).renderResolution=1024,e}return t=a,(n=[{key:"execute",value:function(e,t){var n=this,r=e.svgEngine.getSvgCanvas(),o=e.svgEngine.getRootGroup(),i=e.svgEngine.getObjects();this.makeNumberSafe(r,"width",this.renderResolution),this.makeNumberSafe(r,"height",this.renderResolution),this.makeNumberSafe(o,"width",r.width),this.makeNumberSafe(o,"height",r.height),o.width<=0&&(o.width=r.width),o.height<=0&&(o.height=r.height),this.makeObjectSafe(o),i.forEach((function(e){n.makeObjectSafe(e.element)}))}},{key:"makeNumberSafe",value:function(e,t,n){e&&void 0!==e[t]&&Number.isNaN(e[t])&&(e[t]=n)}},{key:"makeObjectSafe",value:function(e){var t=this;e&&(this.makeNumberSafe(e,"width",this.renderResolution),this.makeNumberSafe(e,"height",this.renderResolution),this.makeNumberSafe(e,"zoomX",1),this.makeNumberSafe(e,"zoomY",1),this.makeNumberSafe(e,"scaleX",1),this.makeNumberSafe(e,"scaleY",1),this.makeNumberSafe(e,"top",0),this.makeNumberSafe(e,"left",0),e.lineCoords&&Object.keys(e.lineCoords).forEach((function(n){void 0!==e.lineCoords[n].x&&t.makeNumberSafe(e.lineCoords[n],"x",0),void 0!==e.lineCoords[n].y&&t.makeNumberSafe(e.lineCoords[n],"y",0)})),e.aCoords&&Object.keys(e.aCoords).forEach((function(n){void 0!==e.aCoords[n].x&&t.makeNumberSafe(e.aCoords[n],"x",0),void 0!==e.aCoords[n].y&&t.makeNumberSafe(e.aCoords[n],"y",0)})),e.clipPath&&this.makeObjectSafe(e.clipPath))}}])&&ia(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(No);function la(e){return la="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},la(e)}function fa(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function da(e,t){return da=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},da(e,t)}function ha(e,t){if(t&&("object"===la(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ya(e){return ya=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ya(e)}n(23157);var ma=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&da(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ya(r);if(o){var n=ya(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return ha(this,e)});function a(){return fa(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"execute",value:function(e,t){var n=this;e.svgEngine.getObjects().forEach((function(e){n.removeImage(e.element)}))}},{key:"hasImage",value:function(e){return!(!e||"string"!=typeof e)&&(e.startsWith("http")||e.startsWith("base"))}},{key:"removeImage",value:function(e){var t=this;if(e){if(Array.isArray(e.colorProperties)&&0===e.colorProperties.length?e.colorProperties.forEach((function(n){t.hasImage(e[n])&&delete e[n]})):e.hasFill()&&this.hasImage(e.fill)&&delete e.fill,e.hasFill()&&"string"!=typeof e.fill&&("linear"===e.fill.type||"radial"===e.fill.type)){var n=e.fill.colorStops;Array.isArray(n)&&n.forEach((function(e){t.hasImage(e.color)&&delete e.color}))}"image"===e.type&&this.hasImage(e.getSrc())&&e.setSrc(""),e.clipPath&&this.removeImage(e.clipPath)}}}])&&pa(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(No);function va(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function ba(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){va(i,r,o,a,u,"next",e)}function u(e){va(i,r,o,a,u,"throw",e)}a(void 0)}))}}function ga(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var wa=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mOptimizeHandler=this.setHandlers([new sa,new ma,new Zo,new zo,new Ii,new ri,new Hi,new Yi,new na]),this.mAnalyzeHandler=this.setHandlers([new li,new gi]),this.mPalletizeHandler=this.setHandlers([new xi])}var t,n,r,o,i;return t=e,n=[{key:"optimize",value:(i=ba(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.mOptimizeHandler.handle(t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"analyze",value:(o=ba(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.mAnalyzeHandler.handle(t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"palletize",value:(r=ba(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.mPalletizeHandler.handle(t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"setHandlers",value:function(e){for(var t=1;t<e.length;t++)e[t-1].setNext(e[t]);return e[0]}}],n&&ga(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),_a=n(64520);function Oa(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function Ta(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Oa(i,r,o,a,u,"next",e)}function u(e){Oa(i,r,o,a,u,"throw",e)}a(void 0)}))}}function Ra(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Sa=function(){function e(t){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.mOptions=t,1===this.mOptions.version||ee.qL.warn("Version is not provided to svg palletization. Using latest version instead."),this.mEngine=new wa}var t,n,r,o,i,a,u;return t=e,n=[{key:"optimize",value:(u=Ta(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.mEngine.optimize(t,this.mOptions);case 2:t.optimized=!0;case 3:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"analyze",value:(a=Ta(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.mEngine.analyze(t,this.mOptions);case 2:t.analyzed=!0;case 3:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"palletize",value:(i=Ta(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.mEngine.palletize(t,this.mOptions);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"render",value:function(e){return e.svgEngine.getRootGroup().dirty=!0,e.svgEngine.getObjects().forEach((function(e){e.element.dirty=!0})),e.svgEngine.render(),e.canvas}}],r=[{key:"create",value:(o=Ta(regeneratorRuntime.mark((function e(t,n){var r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new _a.S,e.next=3,r.create(t,n);case 3:return o=e.sent,e.abrupt("return",{svgEngine:r,canvas:o.canvas,palette:new Map,paletteOverride:new Map,optimized:!1,analyzed:!1});case 5:case"end":return e.stop()}}),e)}))),function(e,t){return o.apply(this,arguments)})},{key:"destroy",value:function(e){e&&(e.svgEngine&&(e.svgEngine.destroy(),delete e.svgEngine),e.canvas&&delete e.canvas,e.palette&&(e.palette.clear(),delete e.palette),e.paletteOverride&&(e.paletteOverride.clear(),delete e.paletteOverride),e.optimized=!1,e.analyzed=!1)}}],n&&Ra(t.prototype,n),r&&Ra(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ea(e){return Ea="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ea(e)}function Pa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pa(Object(n),!0).forEach((function(t){ja(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ja(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ca(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function ka(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ma(){return Ma="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=Da(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Ma.apply(this,arguments)}function Da(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Na(e)););return e}function Aa(e,t){return Aa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Aa(e,t)}function Ia(e,t){if(t&&("object"===Ea(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Na(e){return Na=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Na(e)}var Va=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Aa(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Na(r);if(o){var n=Na(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Ia(this,e)});function a(e,t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e,t)).mValue={image_source:"",media_id:null,svg_element:null,clipping_element:null,offset:[],size:null,scale:1,rotation:0,palletization_version:1,palletization_colors:[],palletization_palette:[],palletization_palette_override:[]},n.mUpdateEvent=new me.xQ,n.mUpdateEvent.pipe(St((function(e){return(0,st.D)(new Promise((function(t){var r=n.resolveValuable(),o=JSON.parse(JSON.stringify(r)),i=JSON.parse(JSON.stringify(n.mValue));if(void 0===o.media_id||!o.svg_element)return n.broadcast(e.broadcast_options),void t();(0,st.D)(n.resolveSvgTextureController(o.media_id)).pipe((0,_e.q)(1),Ot((function(){t(),n.broadcast(e.broadcast_options)}))).subscribe(function(){var t,r=(t=regeneratorRuntime.mark((function t(r){var a,u,c,s,l,f,p;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=i.image_source,n.mOriginalImageSource!==a&&(n.mOriginalImageSource=a,n.mValue.palletization_palette=[],n.mValue.palletization_palette_override=[],i.palletization_palette=[],i.palletization_palette_override=[],n.mPalletizationContext&&(Sa.destroy(n.mPalletizationContext),delete n.mPalletizationContext)),!(o.allow_palletization&&n.mOriginalImageSource&&n.isSvg(n.mOriginalImageSource))){t.next=34;break}if(t.prev=4,u=new Sa({version:i.palletization_version,maxColors:o.palletization_max_colors||1}),n.mPalletizationContext){t.next=11;break}return t.next=10,Sa.create(n.mOriginalImageSource,1024);case 10:n.mPalletizationContext=t.sent;case 11:if(n.mPalletizationContext.optimized){t.next=14;break}return t.next=14,u.optimize(n.mPalletizationContext);case 14:if(n.mPalletizationContext.analyzed){t.next=18;break}return t.next=17,u.analyze(n.mPalletizationContext);case 17:n.mValue.palletization_palette=Array.from(n.mPalletizationContext.palette.keys());case 18:if(n.mValue.palletization_palette&&n.mValue.palletization_palette.length>0)for(c=n.mValue.palletization_colors.find((function(e){return e.default}))||n.mValue.palletization_colors[0],s=c.color||"#ffffff",n.mValue.palletization_palette_override=n.mValue.palletization_palette.map((function(e,t){if(!n.mValue.palletization_palette_override||!n.mValue.palletization_palette_override[t])return s;var r=n.mValue.palletization_palette_override[t];return n.mValue.palletization_colors.find((function(e){return e.color===r}))?r:s})),n.mPalletizationContext.paletteOverride.clear(),l=0;l<n.mValue.palletization_palette.length;l++)f=s,l<n.mValue.palletization_palette_override.length&&n.mValue.palletization_palette_override[l]&&(f=n.mValue.palletization_palette_override[l]),n.mPalletizationContext.paletteOverride.set(n.mValue.palletization_palette[l],f);if(!(n.mPalletizationContext.optimized&&n.mPalletizationContext.analyzed&&n.mPalletizationContext.palette&&n.mPalletizationContext.palette.size>0&&n.mPalletizationContext.paletteOverride&&n.mPalletizationContext.paletteOverride.size>0)){t.next=22;break}return t.next=22,u.palletize(n.mPalletizationContext);case 22:p=u.render(n.mPalletizationContext),a=p.toDataURL(),t.next=33;break;case 26:t.prev=26,t.t0=t.catch(4),ee.qL.error("Unable to palletize image:",t.t0),a="",n.mOriginalImageSource="",i.image_source="",n.mValue.image_source="";case 33:n.broadcast(e.broadcast_options);case 34:return t.next=36,r.updateImage(o.svg_element,a,i,o);case 36:n.resolveProductNode().getRenderState().requestFrame();case 37:case"end":return t.stop()}}),t,null,[[4,26]])})),function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(e){Ca(i,r,o,a,u,"next",e)}function u(e){Ca(i,r,o,a,u,"throw",e)}a(void 0)}))});return function(e){return r.apply(this,arguments)}}(),(function(e){return ee.qL.error(e)}))})))}))).subscribe((function(){ee.qL.print("Image upload updated."),n.resolveProductNode().getRenderState().requestFrame()}),(function(e){ee.qL.warn("Failed to update image upload (pipeline):",e)}));var r=n.resolveValuable();if(r){if(Array.isArray(r.palletization_colors))for(var o=0;o<r.palletization_colors.length;o++)if(7!==r.palletization_colors[o].color.length){var u=r.palletization_colors[o].color;"#"!==u[0]&&(u="#".concat(u)),u=u.slice(0,7),r.palletization_colors[o].color=u}n.setValue({size:Pe.F.isNonEmptyString(r.size_type)?r.size_type:"cover",scale:r.allow_scaling&&Pe.F.isNumeric(r.scale)?r.scale:void 0,rotation:r.allow_rotation&&Pe.F.isNumeric(r.rotation)?r.rotation:void 0,offset:[r.allow_offset&&Pe.F.isNumeric(r.offset_x)?r.offset_x:0,r.allow_offset&&Pe.F.isNumeric(r.offset_y)?r.offset_y:0],palletization_colors:r.allow_palletization?r.palletization_colors:[],palletization_palette:r.allow_palletization?r.palletization_palette:[],palletization_palette_override:r.allow_palletization?r.palletization_palette_override:[]},{emitEvent:!1,rebuild:!0})}return n}return t=a,n=[{key:"getType",value:function(){return a.TypeRTTI}},{key:"broadcastAttributeUpdated",value:function(){this.setValue(this.getValue()),Ma(Na(a.prototype),"broadcastAttributeUpdated",this).call(this)}},{key:"getAttribute",value:function(){return this.updateValues(),this.mAttributeData}},{key:"updateValues",value:function(){this.mAttributeData.selected_value_id=this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:void 0,this.mAttributeData.selected_value_value=this.getValue();var e=this.mAttributeData.attribute_values[0].attribute_value_valuable;this.mValue.media_id=e.media_id,this.mValue.svg_element=e.svg_element,this.mValue.clipping_element=e.clipping_element}},{key:"setValue",value:function(e,t){"string"!=typeof e&&e?this.mValue=xa(xa({},this.mValue),e):this.mValue.image_source=e,this.updateValues(),this.resolveValuable()?this.mUpdateEvent.next({broadcast_options:t}):this.broadcast(t)}},{key:"setValueByKey",value:function(e,t){this.setValue(e,t)}},{key:"compareValue",value:function(e){return e==this.getValue().image_source}},{key:"getValue",value:function(){return this.mValue}},{key:"getValueName",value:function(){if(!this.getValue().image_source)return"";var e=[];return e.push("".concat(this.getValue().image_source)),isFinite(this.mValue.scale)&&null!==this.mValue.scale&&e.push("@scale:".concat(this.mValue.scale,";")),isFinite(this.mValue.rotation)&&null!==this.mValue.rotation&&e.push("@rotation:".concat(this.mValue.rotation,";")),e.join(" ")}},{key:"resetValue",value:function(e){this.mValue.image_source="",delete this.mValue.value,this.broadcast(e)}},{key:"getQueryParam",value:function(){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e?ja({},this.mAttributeData.id,this.getValueName()):{}}},{key:"parse",value:function(e,t){e&&e.image_source&&this.setValue(e.image_source,t)}},{key:"resolveValuable",value:function(){return this.mAttributeData&&this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].attribute_value_valuable:null}},{key:"broadcast",value:function(e){var t=this._getDefaultSetOptions(e);t.emitEvent&&this.broadcastValueChange(this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:void 0,this.mValue,t.rebuild)}},{key:"isSvg",value:function(e){return Pe.F.isValidURL(e)?/\.(svg)$/gm.test(e):e.slice(0,19).includes("image/svg")}}],n&&ka(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(ro.v);function Ua(e){return Ua="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ua(e)}function Fa(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function Ba(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function La(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ba(Object(n),!0).forEach((function(t){Ha(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ba(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ha(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function za(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qa(){return qa="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=Ga(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},qa.apply(this,arguments)}function Ga(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ka(e)););return e}function Wa(e,t){return Wa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Wa(e,t)}function Qa(e,t){if(t&&("object"===Ua(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ka(e){return Ka=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ka(e)}Va.TypeRTTI=new Re.rz("AttributeSvgImageController",ro.v.TypeRTTI),n(23123),n(94986);var Ya=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Wa(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ka(r);if(o){var n=Ka(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Qa(this,e)});function a(e,t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e,t)).mValue={text:"",media_id:null,svg_element:null,clipping_element:null,multiline:!1,font:null,size:null,offset:[0,0],rotation:0,scale:0,color:null,styles:null,align:"center"};var r=n.resolveValuable();return(0,K.isNullOrUndefined)(r)||n.setValue({text:r.text,font:!(0,K.isNullOrUndefined)(r.available_fonts)&&r.available_fonts.length>0?r.available_fonts[0]:void 0,size:Pe.F.isNumeric(r.font_size)?r.font_size:void 0,scale:r.allow_scaling&&Pe.F.isNumeric(r.scale)?r.scale:void 0,rotation:r.allow_rotation&&Pe.F.isNumeric(r.rotation)?r.rotation:void 0,offset:[r.allow_offset&&Pe.F.isNumeric(r.offset_x)?r.offset_x:0,r.allow_offset&&Pe.F.isNumeric(r.offset_y)?r.offset_y:0],color:"#000000"}),n}return t=a,n=[{key:"getType",value:function(){return a.TypeRTTI}},{key:"getAttribute",value:function(){return this.updateValues(),this.mAttributeData}},{key:"validateMinMax",value:function(e){if(Pe.F.isString(this.mValue.text)&&Pe.F.isNumeric(e.max_length)&&e){var t=e.max_length;if(this.mValue.multiline){var n=this.mValue.text.match(/\n/g);n&&(t+=n.length)}this.mValue.text=this.mValue.text.slice(0,t)}}},{key:"updateValues",value:function(){this.mAttributeData.selected_value_id=this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,this.mAttributeData.selected_value_value=this.getValue()}},{key:"setValue",value:function(e,t){var n=this;(0,K.isString)(e)?this.mValue.text=e:this.mValue=La(La({},this.mValue),e);var r=this.resolveValuable();this.validateMinMax(r),this.mValue.text=qt(this.mValue.text),this.mValue.multiline&&this.isExtendedEditorViewSelected()&&this.validateLineBreaks();var o=La({},this.getValue());!(0,K.isString)(e)&&(0,K.isNullOrUndefined)(e.color)&&delete o.color,this.updateValues(),r?this.resolveSvgTextureController(r.media_id).then(function(){var e,i=(e=regeneratorRuntime.mark((function e(i){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.multiline||!n.isExtendedEditorViewSelected()){e.next=6;break}return e.next=3,i.getCurrentRawTextFromObject(r.svg_element,o);case 3:o.text=e.sent,n.mValue.text=o.text,n.updateValues();case 6:i.updateText(r.svg_element,o,r).then((function(){n.broadcast(t)}),(function(){n.broadcast(t)}));case 7:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Fa(i,r,o,a,u,"next",e)}function u(e){Fa(i,r,o,a,u,"throw",e)}a(void 0)}))});return function(e){return i.apply(this,arguments)}}(),(function(){n.broadcast(t)})):this.broadcast(t)}},{key:"broadcast",value:function(e){var t=this._getDefaultSetOptions(e);t.emitEvent&&this.broadcastValueChange(this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,this.mValue,t.rebuild)}},{key:"setValueByKey",value:function(e,t){this.setValue(e,t)}},{key:"compareValue",value:function(e){return e==this.getValue().text}},{key:"getValue",value:function(){if(this.mAttributeData.attribute_values.length>0){var e=this.mAttributeData.attribute_values[0].attribute_value_valuable;(0,K.isNullOrUndefined)(e)||(this.mValue.media_id=e.media_id,this.mValue.svg_element=e.svg_element,this.mValue.clipping_element=e.clipping_element,this.mValue.multiline=e.multiline)}return this.mValue}},{key:"getValueName",value:function(){if(!this.getValue().text||this.getValue().styles)return this.getValue().text;var e=[];return e.push("".concat(this.getValue().text)),this.mValue.size&&e.push("@size:".concat(this.mValue.size,";")),this.mValue.font&&e.push("@font:".concat(this.mValue.font,";")),e.join(" ")}},{key:"resetValue",value:function(e){this.mValue.text="",delete this.mValue.value;var t=this._getDefaultSetOptions(e);t.emitEvent&&this.broadcastValueChange(this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,this.mValue,t.rebuild)}},{key:"getQueryParam",value:function(){return{}}},{key:"parse",value:function(e,t){"string"==typeof e?this.setValue(e,t):(0,K.isNullOrUndefined)(e)||this.setValue(e,t)}},{key:"resolveValuable",value:function(){return this.mAttributeData&&this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].attribute_value_valuable:null}},{key:"destroy",value:function(){qa(Ka(a.prototype),"destroy",this).call(this)}},{key:"validateLineBreaks",value:function(){this.validateMaxCharactersForEachLine(),this.validateMaxLineBreaks()}},{key:"validateMaxCharactersForEachLine",value:function(){var e=this,t=this.mValue.text.split("\n"),n=parseInt(this.mAttributeData.meta.maxCharactersForEachLine,10)||0,r=[];0!==n&&(t.forEach((function(t){"string"!=typeof t||t.length<n?r.push(t):e.breakLines(t,n).forEach((function(e){r.push(e.trim())}))})),this.mValue.text=r.join("\n"))}},{key:"breakLines",value:function(e,t){if(!e)return[];if(e.length<=t)return[e];var n=e.slice(0,t),r=n.lastIndexOf(" ");return e.length>t&&" "===e[t]?e.slice(t).trim()?[n].concat(this.breakLines(e.slice(t).trim(),t)):[n]:-1===r?[n].concat(this.breakLines(e.slice(t),t)):[n=n.slice(0,r+1)].concat(this.breakLines(e.slice(r+1),t))}},{key:"validateMaxLineBreaks",value:function(){var e=parseInt(this.mAttributeData.meta.maxLineBreaks,10)||0;if(0!==e){var t=this.mValue.text.split("\n");t=t.slice(0,e),this.mValue.text=t.join("\n")}}},{key:"isExtendedEditorViewSelected",value:function(){return this.mAttributeData.meta&&"SvgTextEditorView"===this.mAttributeData.meta.render_function}}],n&&za(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(ro.v);Ya.TypeRTTI=new f.r("AttributeSvgTextController",ro.v.TypeRTTI);var Za=n(48155);function Xa(e){return Xa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xa(e)}function Ja(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function $a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function eu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$a(Object(n),!0).forEach((function(t){tu(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function tu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ru(){return ru="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=ou(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},ru.apply(this,arguments)}function ou(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=uu(e)););return e}function iu(e,t){return iu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},iu(e,t)}function au(e,t){if(t&&("object"===Xa(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function uu(e){return uu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},uu(e)}var cu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iu(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=uu(r);if(o){var n=uu(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return au(this,e)});function a(e,t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e,t)).mValue={name:"",media_id:null,selected_media_id:null,svg_element:null};var r=n.resolveValuable();if(!(0,K.isNullOrUndefined)(r)&&!(0,K.isNullOrUndefined)(r.attributes)&&r.attributes.length>0){var o=r.attributes.find((function(e){return Pe.F.isTrue(e.default)}));(0,K.isNullOrUndefined)(o)?n.setValue(r.attributes[0].key):n.setValue(o.key)}return n}return t=a,n=[{key:"getType",value:function(){return a.TypeRTTI}},{key:"getAttribute",value:function(){return this.updateValues(),this.mAttributeData}},{key:"updateValues",value:function(){this.mAttributeData.selected_value_id=this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,this.mAttributeData.selected_value_value=this.getValue()}},{key:"setValue",value:function(e,t){var n=this;if((0,K.isString)(e)){var r=this.mAttributeData.attribute_values[0].attribute_value_valuable,o=r.attributes.find((function(t){return t.key===e}));o&&(this.mValue={key:o.key,media_id:r.media_id,svg_element:r.svg_element,name:o.name,selected_media_id:o.selected_media_id})}else this.mValue=eu(eu({},this.mValue),e);this.updateValues();var i=this.resolveValuable();null!==i?this.resolveSvgTextureController(i.media_id).then(function(){var e,r=(e=regeneratorRuntime.mark((function e(r){var o,a,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Za.y.getInstance().resolveModel(n.getValue().selected_media_id);case 2:return o=e.sent,a=n.getValue(),e.next=6,r.updatePattern(i.svg_element,o.source_url,a);case 6:return u=e.sent,n.broadcast(t),e.abrupt("return",u);case 9:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Ja(i,r,o,a,u,"next",e)}function u(e){Ja(i,r,o,a,u,"throw",e)}a(void 0)}))});return function(e){return r.apply(this,arguments)}}(),(function(){n.broadcast(t)})):this.broadcast(t)}},{key:"broadcast",value:function(e){var t=this._getDefaultSetOptions(e);t.emitEvent&&this.broadcastValueChange(this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,this.mValue,t.rebuild)}},{key:"setValueByKey",value:function(e,t){this.setValue(e,t)}},{key:"compareValue",value:function(e){return e==this.getValue().key}},{key:"getValue",value:function(){if(this.mAttributeData.attribute_values.length>0){var e=this.mAttributeData.attribute_values[0].attribute_value_valuable;(0,K.isNullOrUndefined)(e)||(this.mValue.media_id=e.media_id,this.mValue.svg_element=e.svg_element,this.mValue.scale=e.scale)}return this.mValue}},{key:"getValueName",value:function(){return this.getValue().name}},{key:"resetValue",value:function(e){this.mValue.name="",delete this.mValue.selected_media_id,delete this.mValue.value;var t=this._getDefaultSetOptions(e);t.emitEvent&&this.broadcastValueChange(this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,this.mValue,t.rebuild)}},{key:"setVisibility",value:function(e,t){if(!this.visibleOnFrame)return ru(uu(a.prototype),"setVisibility",this).call(this,!1);if(t&&!(0,K.isNullOrUndefined)(t.option_id))try{var n=this.mAttributeData.attribute_values[0].attribute_value_valuable.attributes.find((function(e){return e.key===t.option_id}));n&&(n.visible=e)}catch(e){ee.qL.print("failed to get svg valuable: ",e)}else ru(uu(a.prototype),"setVisibility",this).call(this,e,t)}},{key:"getQueryParam",value:function(){return{}}},{key:"parse",value:function(e,t){(0,K.isNullOrUndefined)(e)||this.setValue(e,t)}},{key:"resolveValuable",value:function(){return this.mAttributeData&&this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].attribute_value_valuable:null}}],n&&nu(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(ro.v);function su(e){return su="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},su(e)}function lu(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function fu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fu(Object(n),!0).forEach((function(t){du(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function du(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yu(){return yu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=mu(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},yu.apply(this,arguments)}function mu(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=gu(e)););return e}function vu(e,t){return vu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},vu(e,t)}function bu(e,t){if(t&&("object"===su(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function gu(e){return gu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},gu(e)}cu.TypeRTTI=new f.r("AttributeSvgImageSelectorController",ro.v.TypeRTTI),n(85827),n(25387),n(72608);var wu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vu(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=gu(r);if(o){var n=gu(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return bu(this,e)});function a(e,t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e,t)).mValue={name:"",media_id:null,selected_element_id:null,elements:[]};var r=n.resolveValuable();if(!(0,K.isNullOrUndefined)(r)&&!(0,K.isNullOrUndefined)(r.attributes)&&r.attributes.length>0){var o=r.attributes.find((function(e){return Pe.F.isTrue(e.default)}));(0,K.isNullOrUndefined)(o)?n.setValue(r.attributes[0].key):n.setValue(o.key)}return n}return t=a,n=[{key:"getType",value:function(){return a.TypeRTTI}},{key:"getAttribute",value:function(){return this.updateValues(),this.mAttributeData}},{key:"updateValues",value:function(){this.mAttributeData.selected_value_id=this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,this.mAttributeData.selected_value_value=this.getValue()}},{key:"setValue",value:function(e,t){var n=this;if((0,K.isString)(e)){var r=this.mAttributeData.attribute_values[0].attribute_value_valuable,o=r.attributes.find((function(t){return t.key===e}));o&&(this.mValue={key:o.key,media_id:r.media_id,name:o.name,selected_element_id:o.selected_element_id})}else this.mValue=pu(pu({},this.mValue),e);this.updateValues();var i=this.resolveValuable();null!==i?this.resolveSvgTextureController(i.media_id).then(function(){var e,r=(e=regeneratorRuntime.mark((function e(r){var o,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.getValue(),i=o.elements.reduce((function(e,t){return pu(pu({},e),{},du({},t,t===o.selected_element_id))}),{}),e.next=4,r.updateVisibility(i);case 4:return a=e.sent,n.broadcast(t),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){lu(i,r,o,a,u,"next",e)}function u(e){lu(i,r,o,a,u,"throw",e)}a(void 0)}))});return function(e){return r.apply(this,arguments)}}(),(function(){n.broadcast(t)})):this.broadcast(t)}},{key:"broadcast",value:function(e){var t=this._getDefaultSetOptions(e);t.emitEvent&&this.broadcastValueChange(this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,this.mValue,t.rebuild)}},{key:"setValueByKey",value:function(e,t){this.setValue(e,t)}},{key:"compareValue",value:function(e){return e==this.getValue().value}},{key:"getValue",value:function(){if(this.mAttributeData.attribute_values.length>0){var e=this.mAttributeData.attribute_values[0].attribute_value_valuable;(0,K.isNullOrUndefined)(e)||(this.mValue.media_id=e.media_id,this.mValue.elements=e.attributes.map((function(e){return e.selected_element_id})))}return this.mValue}},{key:"getValueName",value:function(){return this.getValue().name}},{key:"resetValue",value:function(e){this.mValue.name="",delete this.mValue.selected_element_id,delete this.mValue.value;var t=this._getDefaultSetOptions(e);t.emitEvent&&this.broadcastValueChange(this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,this.mValue,t.rebuild)}},{key:"setVisibility",value:function(e,t){if(!this.visibleOnFrame)return yu(gu(a.prototype),"setVisibility",this).call(this,!1);if(t&&!(0,K.isNullOrUndefined)(t.option_id))try{var n=this.mAttributeData.attribute_values[0].attribute_value_valuable.attributes.find((function(e){return e.key===t.option_id}));n&&(n.visible=e)}catch(e){ee.qL.print("failed to get svg valuable: ",e)}else yu(gu(a.prototype),"setVisibility",this).call(this,e,t)}},{key:"getQueryParam",value:function(){return{}}},{key:"parse",value:function(e,t){(0,K.isNullOrUndefined)(e)||(0,K.isUndefined)(e.value)||this.setValue(e.value,t)}},{key:"resolveValuable",value:function(){return this.mAttributeData&&this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].attribute_value_valuable:null}}],n&&hu(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(ro.v);wu.TypeRTTI=new f.r("AttributeSvgElementSelectorController",ro.v.TypeRTTI);var _u=n(94498);function Ou(e){return Ou="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ou(e)}function Tu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ru(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tu(Object(n),!0).forEach((function(t){Su(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Su(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Eu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Pu(e,t){return Pu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Pu(e,t)}function xu(e,t){if(t&&("object"===Ou(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ju(e){return ju=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ju(e)}var Cu,ku=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Pu(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ju(r);if(o){var n=ju(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return xu(this,e)});function a(e,t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e,t)).mValue={media_id:null,svg_element:null,clipping_element:null,primary_color:"",secondary_color:"",direction:null};var r=n.resolveValuable();return(0,K.isNullOrUndefined)(r)||n.setValue({primary_color:r.primary_color,secondary_color:r.secondary_color,direction:r.direction}),n}return t=a,(n=[{key:"resolveValuable",value:function(){return this.mAttributeData&&this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].attribute_value_valuable:null}},{key:"getAttribute",value:function(){return this.updateValues(),this.mAttributeData}},{key:"updateValues",value:function(){this.mAttributeData.selected_value_id=this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,this.mAttributeData.selected_value_value=this.getValue()}},{key:"getQueryParam",value:function(e,t){return t?Su({},this.mAttributeData.id,this.getValueName()):{}}},{key:"getValue",value:function(){if(this.mAttributeData.attribute_values.length>0){var e=this.mAttributeData.attribute_values[0].attribute_value_valuable;(0,K.isNullOrUndefined)(e)||(this.mValue.media_id=e.media_id,this.mValue.svg_element=e.svg_element,this.mValue.clipping_element=e.clipping_element)}return this.mValue}},{key:"getValueName",value:function(){var e=this.resolveValuable(),t=this.mValue.primary_color||e&&e.primary_color||"",n=this.mValue.secondary_color||e&&e.secondary_color||"",r=this.mValue.direction||e&&e.direction||"";return"primary_color: ".concat(t,", secondary_color: ").concat(n,", direction: ").concat(r,"; ")}},{key:"parse",value:function(e,t){(0,K.isNullOrUndefined)(e)||this.setValue(e,t)}},{key:"resetValue",value:function(e){var t=this.resolveValuable();this.mValue.primary_color=t&&t.primary_color||"",this.mValue.secondary_color=t&&t.secondary_color||"",this.mValue.direction=t&&t.direction||null,this.mValue.media_id=t&&t.media_id||null,this.mValue.svg_element=t&&t.svg_element||null,this.mValue.clipping_element=t&&t.clipping_element||null,delete this.mValue.value;var n=this._getDefaultSetOptions(e);n.emitEvent&&this.broadcastValueChange(this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,this.mValue,n.rebuild)}},{key:"setValue",value:function(e,t){var n=this;this.mValue=Ru(Ru({},this.mValue),e);var r=this.resolveValuable();this.updateValues(),r?this.resolveSvgTextureController(r.media_id).then((function(e){e.updateGradient(r.svg_element,n.getValue()).then((function(){n.broadcast(t)}),(function(){n.broadcast(t)}))}),(function(){n.broadcast(t)})):this.broadcast(t)}},{key:"broadcast",value:function(e){var t=this._getDefaultSetOptions(e);t.emitEvent&&this.broadcastValueChange(this.mAttributeData.attribute_values.length>0?this.mAttributeData.attribute_values[0].id:null,this.mValue,t.rebuild)}},{key:"setValueByKey",value:function(e,t){this.setValue(e,t)}}])&&Eu(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(ro.v),Mu=n(29844),Du=n(28810);function Au(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Iu(e,t,n){return t&&Au(e.prototype,t),n&&Au(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Nu(e){return Nu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nu(e)}function Vu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Uu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vu(Object(n),!0).forEach((function(t){Fu(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Fu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Bu(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function Lu(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Bu(i,r,o,a,u,"next",e)}function u(e){Bu(i,r,o,a,u,"throw",e)}a(void 0)}))}}function Hu(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qu(e,t){return qu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},qu(e,t)}function Gu(e,t){if(t&&("object"===Nu(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Wu(e){return Wu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Wu(e)}!function(e){e.en="en",e.ar="ar",e.fr="fr",e.de="de",e.hi="hi",e.ja="ja",e.it="it",e.pt="pt",e.ru="ru",e.es="es",e.th="th",e.tr="tr",e.zh="zh",e.ko="ko",e.pa="pa"}(Cu||(Cu={}));var Qu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qu(e,t)}(s,e);var t,n,r,o,i,a,u,c=(a=s,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Wu(a);if(u){var n=Wu(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Gu(this,e)});function s(){return Hu(this,s),c.apply(this,arguments)}return t=s,n=[{key:"filterProfanityText",value:(i=Lu(regeneratorRuntime.mark((function e(t,n){var r,o,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=s.getLocale(),o=Uu({text:t,lang:r,replacesymbol:"*",requestComplete:!0},n),i={success:!0,text:t,found:0},!(t.length<=2)){e.next=5;break}return e.abrupt("return",i);case 5:return e.prev=5,e.next=8,this.sendRequestFilter(o);case 8:if("complete"!==(a=e.sent).status||!a.data.result.found){e.next=11;break}return e.abrupt("return",Uu(Uu({},i),{},{text:a.data.result.text,found:parseInt(a.data.result.found,10)}));case 11:return e.abrupt("return",i);case 14:return e.prev=14,e.t0=e.catch(5),ee.qL.error("Profanity service failed",e.t0),e.abrupt("return",Uu(Uu({},i),{},{success:!1}));case 18:case"end":return e.stop()}}),e,this,[[5,14]])}))),function(e,t){return i.apply(this,arguments)})},{key:"sendRequestFilter",value:(o=Lu(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Mu.O.getInstance().post(Du.E.makeApiRoute("services/webpurify:profanity"),t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)}))),function(e){return o.apply(this,arguments)})}],r=[{key:"getInstance",value:function(){return null===this._instance&&(this._instance=new this),this._instance}},{key:"getLocale",value:function(){var e=Mu.O.getInstance().getAcceptLanguage();if(!e)return Cu.en;var t=e.split("-")[0];return Cu[t]||Cu.en}}],n&&zu(t.prototype,n),r&&zu(t,r),Object.defineProperty(t,"prototype",{writable:!1}),s}(Iu((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)})));Qu._instance=null;var Ku=n(18170),Yu=n(3283),Zu=n(96381);function Xu(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function Ju(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var $u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r,o;return t=e,n=[{key:"setNext",value:function(e){this.next?this.next.setNext(e):this.next=e}},{key:"execute",value:(r=regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.handler(t);case 2:if(n=e.sent,this.next){e.next=5;break}return e.abrupt("return",n);case 5:return e.abrupt("return",this.next.execute(n));case 6:case"end":return e.stop()}}),e,this)})),o=function(){var e=this,t=arguments;return new Promise((function(n,o){var i=r.apply(e,t);function a(e){Xu(i,n,o,a,u,"next",e)}function u(e){Xu(i,n,o,a,u,"throw",e)}a(void 0)}))},function(e){return o.apply(this,arguments)})}],n&&Ju(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ec(e){return ec="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ec(e)}function tc(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return nc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?nc(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw i}}}}function nc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function rc(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function oc(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){rc(i,r,o,a,u,"next",e)}function u(e){rc(i,r,o,a,u,"throw",e)}a(void 0)}))}}function ic(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ac(e,t){return ac=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ac(e,t)}function uc(e,t){if(t&&("object"===ec(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function cc(e){return cc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},cc(e)}var sc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ac(e,t)}(p,e);var t,n,r,o,i,a,u,c,s,l,f=(s=p,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=cc(s);if(l){var n=cc(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return uc(this,e)});function p(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),(n=f.call(this)).aController=e,n.aProductAttributeComponent=t,n.mModerate$=new me.xQ,n.mModerateResult$=new me.xQ,n.mControllerName=e.getType().getTypeName(),n.setProfanityFilter(e),n.mModerate$.pipe((0,Yu.b)(1e3),(0,Zu.w)(function(){var e=oc(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,Ku.of)(n.resolveModerateText(t)));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())).subscribe(function(){var e=oc(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.mModerateResult$.next(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n}return t=p,n=[{key:"setProfanityFilter",value:function(e){var t=e.getAttribute().meta;if(t&&t.filters&&t.filters.profanity){var n=t.filters.profanity;this.mService=this.resolveService(n)}}},{key:"resolveService",value:function(e){var t=Object.entries(e).find((function(e){return!0===e[1]})),n=null;return t?("enable_webpurify"===t[0]&&(n=Qu.getInstance()),n):n}},{key:"resolveModerateText",value:(c=oc(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=this.mControllerName,e.next="AttributeSvgTextController"===e.t0?3:"AttributeTextToImageController"===e.t0?7:"AttributeSvgCanvasController"===e.t0?11:15;break;case 3:return e.next=5,this.getTextFromSvgText(t);case 5:case 9:case 13:return t=e.sent,e.abrupt("break",15);case 7:return e.next=9,this.getTextFromTextToImage(t);case 11:return e.next=13,this.getTextFromSvgCanvas(t);case 15:return e.abrupt("return",t);case 16:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"moderateText",value:(u=oc(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=2;break}return e.abrupt("return",{text:t,found:0});case 2:return e.next=4,this.mService.filterProfanityText(t);case 4:if(!(n=e.sent).success||!n.found){e.next=7;break}return e.abrupt("return",{text:n.text,found:n.found});case 7:return e.abrupt("return",{text:t,found:0});case 8:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"handler",value:(a=oc(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.mService){e.next=2;break}return e.abrupt("return",t);case 2:return this.mModerate$.next(t),e.next=5,this.mModerateResult$.pipe((0,_e.q)(1)).toPromise();case 5:return e.next=7,e.sent.toPromise();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"getTextFromSvgCanvas",value:(i=oc(regeneratorRuntime.mark((function e(t){var n,r,o,i,a,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.objects.filter((function(e){return"i-text"===e.type})),r=!1,o=tc(n),e.prev=3,o.s();case 5:if((i=o.n()).done){e.next=14;break}return a=i.value,e.next=9,this.moderateText(a.text);case 9:u=e.sent,a.text=u.text,u.found&&(r=!0);case 12:e.next=5;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(3),o.e(e.t0);case 19:return e.prev=19,o.f(),e.finish(19);case 22:return r&&this.aController.broadcastAttributeModerated(),e.abrupt("return",t);case 24:case"end":return e.stop()}}),e,this,[[3,16,19,22]])}))),function(e){return i.apply(this,arguments)})},{key:"getTextFromSvgText",value:(o=oc(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t){e.next=8;break}return e.next=3,this.moderateText(t);case 3:return(n=e.sent).found&&this.aController.broadcastAttributeModerated(),e.abrupt("return",n.text);case 8:return e.next=10,this.moderateText(t.text);case 10:return r=e.sent,t.text=r.text,r.found&&this.aController.broadcastAttributeModerated(),e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"getTextFromTextToImage",value:(r=oc(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t){e.next=8;break}return e.next=3,this.moderateText(t);case 3:return(n=e.sent).found&&this.aController.broadcastAttributeModerated(),e.abrupt("return",n.text);case 8:return e.next=10,this.moderateText(t.value);case 10:return r=e.sent,t.value=r.text,r.found&&this.aController.broadcastAttributeModerated(),e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})}],n&&ic(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),p}($u);function lc(e){return lc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lc(e)}function fc(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function pc(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){fc(i,r,o,a,u,"next",e)}function u(e){fc(i,r,o,a,u,"throw",e)}a(void 0)}))}}function dc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hc(e,t){return hc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},hc(e,t)}function yc(e,t){if(t&&("object"===lc(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function mc(e){return mc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},mc(e)}var vc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hc(e,t)}(s,e);var t,n,r,o,i,a,u,c=(a=s,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=mc(a);if(u){var n=mc(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return yc(this,e)});function s(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(e=c.call(this,"attributeManager")).mProductAttributes=new Array,e.mAttributeControllers={},e.mSubscriptions=new Array,e.mMaterialGroupManagerAccessor=null,e.onAttributeChanged=new me.xQ,e.onAttributeUpdated=new me.xQ,e.onAttributeModerated=new me.xQ,e._handleOptionVisibilityChange=function(t){t.product_scene_uuid===e.getParentObject().getObjectUUID()&&e._setVisibility(t.attribute_id,t.visible,t)},e.handleSetValue=function(t){"product_id"===t.key&&e._setProductId(t.value)},e}return t=s,n=[{key:"getType",value:function(){return s.TypeRTTI}},{key:"OnAttached",value:function(){var e=this,t=this.getParentObject(),n=t.getValue("product_id");!(0,K.isNullOrUndefined)(n)&&n.toString().length>0&&this._setProductId(n),this.mSubscriptions.push(this.onAttributeChanged.subscribe((function(e){t.getRenderState().dispatchAppEvent(Kr.G.ProductOptionChanged,e)})),this.onAttributeUpdated.subscribe((function(e){t.getRenderState().dispatchAppEvent(Kr.G.ProductAttributeUpdated,e)})),this.onAttributeModerated.subscribe((function(e){t.getRenderState().dispatchAppEvent(Kr.G.ProductAttributeModerated,e)})),t.getRenderState().getSceneManager().onApplicationReady.subscribe((function(t){e.mSubscriptions.push(t.observeMessages(Yr.Z.TypeRTTI).subscribe(e._handleOptionVisibilityChange))}))),this.registerMessageHandler(zr.Xk.TypeRTTI,this.handleSetValue),this.registerMessageHandler(_u.u.TypeRTTI,(function(n){t.getSceneObjectId()===n.sceneObjectId&&e._getAttributeControllers().forEach((function(e){e.onMaterialUpdated(n)}))}))}},{key:"OnDetached",value:function(){this.mSubscriptions.splice(0).forEach((function(e){return e.unsubscribe()})),this.unregisterMessageHandler(zr.Xk.TypeRTTI),this.unregisterMessageHandler(_u.u.TypeRTTI),(0,K.isNullOrUndefined)(this.mLoaderService)||this.mLoaderService.error("product options detached"),this.mLoaderService=null}},{key:"isAttachable",value:function(e){return e.isDerivedOfTypeName("ProductNode")}},{key:"_loadDependencies",value:function(){return(0,ve.D)(this._depResolveMaterialManager())}},{key:"_depResolveMaterialManager",value:function(){var e=this,t=this.getParentObject().getComponent("materialGroupManager");return(0,K.isNullOrUndefined)(t)?(0,be._)("material group component not found"):t.resolveMaterialGroups().pipe((0,we.b)((function(t){return e.mMaterialGroupManagerAccessor=t,t})))}},{key:"_loadProductAttributes",value:(i=pc(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){no.Q.getInstance().resolveBootstrapData(+t.mProductId).pipe((0,_e.q)(1)).subscribe((function(n){var r=n.getAttributes(),o=JSON.parse(JSON.stringify(Se.FG.getItems(r)));o.sort((function(e,t){return e.position-t.position})),t.mProductAttributes=o,t._makeAttributeControllers(),e(o)}),(function(e){n(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(){return i.apply(this,arguments)})},{key:"_setProductId",value:function(e){this.mProductId!=e&&(this.mProductId=e,this.mMaterialGroupManagerAccessor=null,(0,K.isNullOrUndefined)(this.mLoaderService)||this.mLoaderService.error("product id has changed"),this.mLoaderService=null)}},{key:"resolveAttributeManager",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(0,K.isNullOrUndefined)(this.mProductId)?(ee.qL.warn("trying to load product options with undefined product id"),(0,be._)("undefined product id")):(!(0,K.isNullOrUndefined)(this.mLoaderService)&&t&&(this.mLoaderService=null),(0,K.isNullOrUndefined)(this.mLoaderService)&&(this.mLoaderService=new ge.t(1),this._loadDependencies().pipe((0,Oe.zg)(pc(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e._loadProductAttributes());case 1:case"end":return t.stop()}}),t)}))))).pipe((0,_e.q)(1)).subscribe((function(){(0,K.isNullOrUndefined)(e.mLoaderService)||e.mLoaderService.next(new Qr(e))}),(function(t){(0,K.isNullOrUndefined)(e.mLoaderService)||e.mLoaderService.error(t),e.mLoaderService=null}))),this.mLoaderService.pipe((0,Te.P)()))}},{key:"_makeAttributeControllers",value:function(){var e=this,t={};Object.keys(this.mAttributeControllers).forEach((function(n){t[n]=e.mAttributeControllers[n].serialize(),e.mAttributeControllers[n].destroy()})),this.mAttributeControllers={},this.mProductAttributes.forEach((function(n){var r=!0;switch(n.type){case"question":e.mAttributeControllers[n.id]=new Ie(n,e);break;case"matgroup":e.mAttributeControllers[n.id]=new qe(n,e);break;case"color":e.mAttributeControllers[n.id]=new et(n,e);break;case"color_picker":e.mAttributeControllers[n.id]=new ct(n,e);break;case"image_upload":e.mAttributeControllers[n.id]=new At(n,e);break;case"text_input":e.mAttributeControllers[n.id]=new Lt(n,e);break;case"text_to_image":e.mAttributeControllers[n.id]=new en(n,e),e.mAttributeControllers[n.id].registerMiddleware(new sc(e.mAttributeControllers[n.id],e));break;case"operable_numbers_input":e.mAttributeControllers[n.id]=new Hr(n,e);break;case"svg_element":e.mAttributeControllers[n.id]=new yo(n,e);break;case"svg_image":e.mAttributeControllers[n.id]=new Va(n,e);break;case"svg_image_selector":e.mAttributeControllers[n.id]=new cu(n,e);break;case"svg_element_selector":e.mAttributeControllers[n.id]=new wu(n,e);break;case"svg_text":e.mAttributeControllers[n.id]=new Ya(n,e),e.mAttributeControllers[n.id].registerMiddleware(new sc(e.mAttributeControllers[n.id],e));break;case"title":case"header":case"custom":case"step":e.mAttributeControllers[n.id]=new to(n,e);break;case"svg_canvas":e.mAttributeControllers[n.id]=new Do(n,e),e.mAttributeControllers[n.id].registerMiddleware(new sc(e.mAttributeControllers[n.id],e));break;case"svg_gradient":e.mAttributeControllers[n.id]=new ku(n,e);break;default:r=!1}r&&!(0,K.isNullOrUndefined)(t[n.id])&&e.mAttributeControllers[n.id].parse(t[n.id])}))}},{key:"_getMaterialGroupManager",value:function(){return this.mMaterialGroupManagerAccessor}},{key:"_hasAttribute",value:function(e){return!(0,K.isNullOrUndefined)(this.mAttributeControllers[e])}},{key:"_getRawAttributes",value:function(){return this.mProductAttributes}},{key:"_getAttributes",value:function(){var e=new Array;return this._getAttributeControllers().forEach((function(t){e.push(t.getAttribute())})),e}},{key:"_cloneAttributes",value:function(){return Pe.F.deepCloneJSON(this._getAttributes())}},{key:"_getAttribute",value:function(e){var t=this._getAttributeController(e);if(!(0,K.isNullOrUndefined)(t))return t.getAttribute()}},{key:"_getAttributeByName",value:function(e){var t=this._getAttributeControllerByName(e);if(!(0,K.isNullOrUndefined)(t))return t.getAttribute()}},{key:"_getAttributeIdByName",value:function(e){return this._getAttributeIdBy("name",e)}},{key:"_getAttributeIdByKey",value:function(e){return this._getAttributeIdBy("key",e)}},{key:"_getAttributeIdBy",value:function(e,t){var n=t.toLowerCase().trim();n=(n=n.replace(/\u202d/g,"")).replace(/\u202c/g,"");var r=this.mProductAttributes.find((function(t){if("string"!=typeof t[e])return!1;var r=t[e].toLowerCase().trim();return(r=(r=r.replace(/\u202d/g,"")).replace(/\u202c/g,""))===n}));return(0,K.isUndefined)(r)?-1:r.id}},{key:"_getAttributeControllers",value:function(){var e=this;return Object.keys(this.mAttributeControllers).map((function(t){return e.mAttributeControllers[t]}))}},{key:"_getAttributeController",value:function(e){if(this._hasAttribute(e))return this.mAttributeControllers[e];ee.qL.warn("Attribute id '".concat(e,"' not found@getAttriubte"))}},{key:"_getAttributeControllerByName",value:function(e){var t=this._getAttributeIdByName(e);if(t>=0)return this.mAttributeControllers[t]}},{key:"_setValue",value:(o=pc(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._hasAttribute(t)){e.next=3;break}return ee.qL.warn("Attribute id '".concat(t,"' not found@setValue")),e.abrupt("return");case 3:return e.next=5,this.mAttributeControllers[t].setNextValue(n,r);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return o.apply(this,arguments)})},{key:"_getValue",value:function(e){if(this._hasAttribute(e))return this.mAttributeControllers[e].getValue();ee.qL.warn("Attribute id '".concat(e,"' not found@_getValue"))}},{key:"_getValueName",value:function(e){if(this._hasAttribute(e))return this.mAttributeControllers[e].getValueName();ee.qL.warn("Attribute id '".concat(e,"' not found@_getValueName"))}},{key:"_resetValue",value:function(e,t){if(this._hasAttribute(e))return this.mAttributeControllers[e].resetValue(t);ee.qL.warn("Attribute id '".concat(e,"' not found@_resetValue"))}},{key:"_setValueByName",value:(r=pc(regeneratorRuntime.mark((function e(t,n,r){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((o=this._getAttributeIdByName(t))>=0)){e.next=4;break}return e.next=4,this._setValue(o,n,r);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"_getValueByName",value:function(e){var t=this._getAttributeIdByName(e);if(t>=0)return this._getValue(t)}},{key:"_setValueByKey",value:function(e,t,n){var r=this._getAttributeIdByKey(e);r>=0&&this.mAttributeControllers[r].setValueByKey(t,n)}},{key:"_getValueByKey",value:function(e){var t=this._getAttributeIdByKey(e);if(t>=0)return this._getValue(t)}},{key:"_getValueNameByName",value:function(e){var t=this._getAttributeIdByName(e);if(t>=0)return this._getValueName(t)}},{key:"_resetValueByName",value:function(e,t){var n=this._getAttributeIdByName(e);if(n>=0)return this._resetValue(n,t)}},{key:"_resetAllValues",value:function(e){var t=this;return Object.keys(this.mAttributeControllers).map((function(n){return t.mAttributeControllers[n].resetValue(e)}))}},{key:"_setVisibility",value:function(e,t,n){this._hasAttribute(e)?this.mAttributeControllers[e].setVisibility(t,n):ee.qL.warn("Attribute id '".concat(e,"' not found@_setVisibility"))}},{key:"_setVisibilityByName",value:function(e,t,n){var r=this._getAttributeIdByName(e);if(r>=0)return this._setVisibility(r,t,n)}},{key:"_isVisible",value:function(e,t){if(this._hasAttribute(e))return this.mAttributeControllers[e].isVisible(t);ee.qL.warn("Attribute id '".concat(e,"' not found@_isVisible"))}},{key:"_buildQueryParams",value:function(e,t){var n=this,r={};return Object.keys(this.mAttributeControllers).forEach((function(o){var i=n.mAttributeControllers[o].getQueryParam(e,t);Object.assign(r,i)})),r}},{key:"_serialize",value:function(e){var t=[];return this._getAttributeControllers().sort((function(e,t){return e.getAttribute().position-t.getAttribute().position})).forEach((function(n){var r=n.serialize(e);(0,K.isNullOrUndefined)(r)||t.push(r)})),t}},{key:"_parse",value:function(e,t){var n=this;e.forEach((function(e){(0,K.isUndefined)(e.attribute_id)||(0,K.isNullOrUndefined)(n.mAttributeControllers[e.attribute_id])||n.mAttributeControllers[e.attribute_id].parse(e.attribute_value,t)}))}},{key:"_hashConfiguration",value:function(){var e="";return this._serialize({discard_hidden:!1,include_keys:!1,calculate_approximations:!1}).forEach((function(t){e+="".concat(t.attribute_id,"/").concat(t.attribute_value_name)})),mo.F.Md5(e)}}],n&&dc(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),s}(Re.H6);vc.TypeRTTI=new Re.rz("ProductAttributeManagerComponent",Re.H6.TypeRTTI);var bc=n(47405),gc=n(55830);function wc(e){return wc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wc(e)}function _c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Oc(e,t){return Oc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Oc(e,t)}function Tc(e,t){if(t&&("object"===wc(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Rc(e){return Rc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Rc(e)}var Sc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Oc(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Rc(r);if(o){var n=Rc(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Tc(this,e)});function a(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(e=i.call(this,"dropableHandler")).mCellPlane=null,e.mPlaneOpacity=0,e.mAnimationHandle=null,e.mTemporaryObjectMaterial=null,e.mDragMaterial=new THREE.MeshBasicMaterial({color:4549591,transparent:!0,opacity:.04}),e}return t=a,n=[{key:"OnAttached",value:function(){this.mControllerNode=this.getParentObject()}},{key:"OnDetached",value:function(){this.cancelAnimation(),this.disposeCellPlane(),this.mControllerNode=null}},{key:"isAttachable",value:function(e){return e.isDerivedOfTypeName("ControllerEntityGridArea")}},{key:"getScene",value:function(e){return(0,K.isNullOrUndefined)(e.parent)?e:this.getScene(e.parent)}},{key:"createCellPlane",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(this.mControllerNode.hasRenderObject()&&(null===this.mCellPlane||this.mCellPlane.geometry.parameters.width!==e||this.mCellPlane.geometry.parameters.height!==t)){this.disposeCellPlane();var n=new THREE.PlaneBufferGeometry(e,t),r=new THREE.TextureLoader;r.setPath(gc.E4.assetsUrl);var o=r.load("system/placeholders/drop-icon.png");this.mCellPlane=new THREE.Mesh(n,new THREE.MeshBasicMaterial({color:2677654,side:THREE.DoubleSide,transparent:!0,map:o,opacity:0})),this.mCellPlane.name="cell_plane",this.mCellPlane.castShadow=!1,this.mCellPlane.receiveShadow=!1;var i=this.mControllerNode.getRenderObject(),a=this.getScene(i.get3DObject()),u=a.scale.clone();this.mCellPlane.scale.copy(new THREE.Vector3(1/(Math.abs(u.x)<1e-5?1:u.x),1/(Math.abs(u.y)<1e-5?1:u.y),1/(Math.abs(u.z)<1e-5?1:u.z))),this.mCellPlane.rotation.copy(new THREE.Euler(Math.PI/2,0,0)),a.add(this.mCellPlane),ee.qL.print("Create cell plane:",e,t)}}},{key:"disposeCellPlane",value:function(){null!==this.mCellPlane&&(this.mCellPlane.parent.remove(this.mCellPlane),this.mCellPlane.material.dispose(),this.mCellPlane.geometry.dispose(),this.mCellPlane=null)}},{key:"getCellPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=this.mCellPlane.quaternion.clone().multiply((new THREE.Quaternion).setFromEuler(new THREE.Euler(-.5*Math.PI,0,0))),o=new THREE.Vector3(t,0,n).addScalar(1e-5),i=o.clone().applyQuaternion(r),a=o.clone().multiplyScalar(.5).applyQuaternion(r);return(new THREE.Vector3).copy(e).divide(i).floor().multiply(i).add(a)}},{key:"getCellRotation",value:function(){var e=this.mCellPlane.quaternion.clone().multiply((new THREE.Quaternion).setFromEuler(new THREE.Euler(.5*Math.PI,0,0)));return(new THREE.Euler).setFromQuaternion(e)}},{key:"interceptDragMove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.createCellPlane(t,n);var r=this.mControllerNode.getValue("cell_width"),o=this.mControllerNode.getValue("cell_height"),i=this.getCellPosition(e.point,r,o);this.mCellPlane.rotation.copy(e.object.rotation);var a=new THREE.Vector3;return e.object.getWorldDirection(a),i.add(a.clone().multiplyScalar(.03)),this.fadeIn(i),!0}},{key:"fadeIn",value:function(e){null!==this.mCellPlane&&this.mCellPlane.position.distanceToSquared(e)>.001&&(ee.qL.print("Reset cell to position: ",e),this.mPlaneOpacity=.1,this.mCellPlane.position.copy(e),this.cancelAnimation(),this.animateFadeIn())}},{key:"cancelAnimation",value:function(){null!==this.mAnimationHandle&&clearTimeout(this.mAnimationHandle),this.mAnimationHandle=null}},{key:"animateFadeIn",value:function(){var e=this;this.mAnimationHandle=setTimeout((function(){e.mPlaneOpacity+=.01,e.mPlaneOpacity>1?(e.mPlaneOpacity=1,e.mAnimationHandle=null):e.animateFadeIn(),e.mCellPlane.material.opacity=e.mPlaneOpacity,e.mControllerNode.getRenderState().requestFrame()}),32)}},{key:"animateFadeOut",value:function(){var e=this;this.mAnimationHandle=setTimeout((function(){e.mPlaneOpacity-=.01,e.mPlaneOpacity<0?(e.mPlaneOpacity=0,e.mAnimationHandle=null):e.animateFadeOut(),e.mCellPlane.material.opacity=e.mPlaneOpacity,e.mControllerNode.getRenderState().requestFrame()}),32)}},{key:"markDragMaterial",value:function(e){if(this.mControllerNode.hasRenderObject()){var t=this.mControllerNode.getRenderObject();this.mTemporaryObjectMaterial=t.get3DObject().material,t.get3DObject().material=this.mDragMaterial}return!0}},{key:"resetDragMaterial",value:function(e){ee.qL.print("reset drag material object:",e),this.mControllerNode.hasRenderObject()&&null!==this.mTemporaryObjectMaterial&&(this.mControllerNode.getRenderObject().get3DObject().material=this.mTemporaryObjectMaterial),this.mTemporaryObjectMaterial=null,this.cancelAnimation(),this.animateFadeOut()}},{key:"acceptDrop",value:function(e){var t=this.mControllerNode.getValue("cell_width"),n=this.mControllerNode.getValue("cell_height"),r=this.getCellPosition(e.point,t,n),o=this.getCellRotation();return ee.qL.print("Place on intersection: ",r),{pos:r,rot:o}}}],n&&_c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(Re.H6),Ec=n(85715);function Pc(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function xc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var jc=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mMaterialGroupManager=t}var t,n,r,o;return t=e,n=[{key:"onMaterialChanged",get:function(){return this.mMaterialGroupManager.onMaterialChanged}},{key:"onMaterialVisibility",get:function(){return this.mMaterialGroupManager.onMaterialVisibility}},{key:"getGroups",value:function(){return this.mMaterialGroupManager._getGroups()}},{key:"getGroup",value:function(e){return this.mMaterialGroupManager._getGroup(e)}},{key:"getGroupByGroupId",value:function(e){return this.mMaterialGroupManager._getGroupByGroupId(e)}},{key:"getGroupReferences",value:function(e){return this.mMaterialGroupManager._getGroupReferences(e)}},{key:"getGroupReferencesByGroupId",value:function(e){return this.mMaterialGroupManager._getGroupReferencesByGroupId(e)}},{key:"getActiveGroupSKU",value:function(e){return this.mMaterialGroupManager._getActiveGroupSKU(e)}},{key:"getActiveGroupName",value:function(e){return this.mMaterialGroupManager._getActiveGroupName(e)}},{key:"getActiveRef",value:function(e){return this.mMaterialGroupManager._getActiveRef(e)}},{key:"getActiveRefId",value:function(e){return this.mMaterialGroupManager._getActiveRefId(e)}},{key:"getActiveRefModel",value:function(e){return this.mMaterialGroupManager._getActiveRefModel(e)}},{key:"getActiveMaterial",value:function(e){return this.mMaterialGroupManager._getActiveMaterial(e)}},{key:"getActiveMaterialByGroupId",value:function(e){return this.mMaterialGroupManager._getActiveMaterialByGroupId(e)}},{key:"setActiveMaterial",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.mMaterialGroupManager._setActiveMaterial(e,t,n)}},{key:"resetActiveMaterial",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.mMaterialGroupManager._resetActiveMaterial(e,t)}},{key:"applyActiveMaterial",value:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.mMaterialGroupManager._applyActiveMaterial(e,t,n,r)}},{key:"setActiveMaterialByGroupId",value:function(e,t){this.mMaterialGroupManager._setActiveMaterialByGroupId(e,t)}},{key:"setMaterialVisibility",value:function(e,t,n){this.mMaterialGroupManager._setMaterialVisibility(e,t,n)}},{key:"setMaterialVisibilityByGroupId",value:function(e,t,n){this.mMaterialGroupManager._setMaterialVisibilityByGroupId(e,t,n)}},{key:"setColorOverwrite",value:function(e,t,n){this.mMaterialGroupManager._setColorOverwrite(e,t,n)}},{key:"setMapOverwrite",value:(r=regeneratorRuntime.mark((function e(t,n,r,o){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.mMaterialGroupManager._setMapOverwrite(t,n,r,o));case 1:case"end":return e.stop()}}),e,this)})),o=function(){var e=this,t=arguments;return new Promise((function(n,o){var i=r.apply(e,t);function a(e){Pc(i,n,o,a,u,"next",e)}function u(e){Pc(i,n,o,a,u,"throw",e)}a(void 0)}))},function(e,t,n,r){return o.apply(this,arguments)})},{key:"buildQueryParams",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.mMaterialGroupManager._buildQueryParams(e)}}],n&&xc(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Cc=n(99556);function kc(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function Mc(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){kc(i,r,o,a,u,"next",e)}function u(e){kc(i,r,o,a,u,"throw",e)}a(void 0)}))}}function Dc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ac(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ic=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mActiveMaterials={},this.mColorOverwrites={},this.mMapOverwrites={},this.onMaterialChanged=new me.xQ,this.onMaterialVisibility=new me.xQ,this.mGroups=[]}var t,n,r,o;return t=e,n=[{key:"init",value:function(){this.mGroups.splice(0)}},{key:"deinit",value:function(){this.mGroups.splice(0),(0,K.isNullOrUndefined)(this.mLoaderService)||this.mLoaderService.error("product options detached"),delete this.mLoaderService}},{key:"_setProductId",value:function(e){this.mProductId=e,(0,K.isNullOrUndefined)(this.mLoaderService)||this.mLoaderService.error("product id has changed"),delete this.mLoaderService}},{key:"_loadMaterialGroups",value:function(){var e=this;return no.Q.getInstance().resolveBootstrapData(this.mProductId).pipe((0,_e.q)(1),(0,yt.U)((function(t){var n,r,o=t.getMaterialsByGroup().map((function(e){return e.generate_code="1"==e.generate_code||"true"==e.generate_code||!0===e.generate_code,e}));return(n=e.mGroups).push.apply(n,function(e){if(Array.isArray(e))return Dc(e)}(r=o||[])||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||function(e,t){if(e){if("string"==typeof e)return Dc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Dc(e,t):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o})))}},{key:"_beforeResolve",value:function(){var e=this;Object.keys(this.mColorOverwrites).forEach((function(t){e._applyColorOverwrites(parseInt(t,10))})),Object.keys(this.mMapOverwrites).forEach((function(t){e._applyMapOverwrites(parseInt(t,10)).then((function(){}),(function(){}))}))}},{key:"resolveMaterialGroups",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(0,K.isNullOrUndefined)(this.mProductId)?(ee.qL.warn("trying to load product options with undefined product id"),(0,be._)("undefined product id")):(!(0,K.isNullOrUndefined)(this.mLoaderService)&&t&&delete this.mLoaderService,(0,K.isNullOrUndefined)(this.mLoaderService)&&(this.mLoaderService=new ge.t(1),this._loadMaterialGroups().subscribe((function(){ee.qL.print("material groups loaded: ",e.mGroups),(0,K.isNullOrUndefined)(e.mLoaderService)||(e._beforeResolve(),e.mLoaderService.next(new jc(e)))}),(function(t){(0,K.isNullOrUndefined)(e.mLoaderService)||e.mLoaderService.error(t),delete e.mLoaderService}))),this.mLoaderService.pipe((0,Te.P)()))}},{key:"_getGroups",value:function(){return this.mGroups}},{key:"_getGroup",value:function(e){return this.mGroups.find((function(t){return t.id==e}))}},{key:"_getGroupByGroupId",value:function(e){return this.mGroups.find((function(t){return t.group_id==e}))}},{key:"_getGroupReferences",value:function(e){var t=this.mGroups.find((function(t){return t.id==e}));if(!(0,K.isNullOrUndefined)(t))return t.materials}},{key:"_getGroupReferencesByGroupId",value:function(e){var t=this.mGroups.find((function(t){return t.group_id==e}));if(!(0,K.isNullOrUndefined)(t))return t.materials}},{key:"_getActiveGroupSKU",value:function(e){var t=this._getActiveRef(e);return(0,K.isNullOrUndefined)(t)?null:this._getGroupReferences(e).find((function(e){return e.id==t.id})).sku}},{key:"_getActiveGroupName",value:function(e){var t=this._getActiveRef(e);return(0,K.isNullOrUndefined)(t)?null:this._getGroupReferences(e).find((function(e){return e.id==t.id})).material_name}},{key:"_getActiveRef",value:function(e){if(e in this.mActiveMaterials)return this.mActiveMaterials[e];var t=this._getGroupReferences(e);if(!(0,K.isNullOrUndefined)(t)&&t.length>0){var n=t.find((function(e){return 1==e.default_selected}));return(0,K.isNullOrUndefined)(n)&&(n=t[0]),this.mActiveMaterials[e]={id:n.id,mat:n.material_id},this.mActiveMaterials[e]}}},{key:"_getActiveRefId",value:function(e){var t=this._getActiveRef(e);if(!(0,K.isNullOrUndefined)(t))return t.id}},{key:"_getActiveRefModel",value:function(e){var t=this._getActiveRefId(e);if(!(0,K.isNullOrUndefined)(t))return this._getGroupReferences(e).find((function(e){return e.id==t}))}},{key:"_getActiveMaterial",value:function(e){var t=this._getActiveRef(e);if(!(0,K.isNullOrUndefined)(t))return t.mat}},{key:"_getActiveMaterialByGroupId",value:function(e){var t=this.mGroups.find((function(t){return t.group_id===e}));if(!(0,K.isNullOrUndefined)(t))return this._getActiveMaterial(t.id)}},{key:"_setActiveMaterial",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.mGroups.find((function(t){return t.id==e}));if(r&&r.materials){var o=r.materials.find((function(e){return e.id==t}));(0,K.isNullOrUndefined)(o)||this._applyActiveMaterial(r.id,o.id,o.material_id,n)}}},{key:"_resetActiveMaterial",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.mGroups.find((function(t){return t.id==e}));n&&e in this.mActiveMaterials&&(delete this.mActiveMaterials[e],t&&this.onMaterialChanged.next({id:e,group:n.group_id,ref_id:this._getActiveRefId(e),material_id:this.mActiveMaterials[e].mat}))}},{key:"_applyActiveMaterial",value:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=this.mGroups.find((function(t){return t.id==e}));(0,K.isNullOrUndefined)(o)||(this.mActiveMaterials[e]={id:t,mat:n},r&&this.onMaterialChanged.next({id:e,group:o.group_id,ref_id:t,material_id:this.mActiveMaterials[e].mat}))}},{key:"_applyColorOverwrites",value:function(e,t){var n=this,r=this.mGroups.find((function(t){return t.id==e}));(0,K.isNullOrUndefined)(r)||tt.ResourceManagerService.getInstance().getManager(tt.ResourceManagerTypes.MaterialManager).then((function(o){r.materials&&r.materials.forEach((function(r){o.setColorOverwrite(r.material_id,n.mColorOverwrites[e],t)}))}),(function(){}))}},{key:"_applyMapOverwrites",value:(o=Mc(regeneratorRuntime.mark((function e(t,n){var r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,o){var i=r.mGroups.find((function(e){return e.id==t}));(0,K.isNullOrUndefined)(i)?o("apply map overwrite: Group not found."):tt.ResourceManagerService.getInstance().getManager(tt.ResourceManagerTypes.MaterialManager).then((function(a){if(i.materials){var u=[];i.materials.forEach((function(e){var o=r.mMapOverwrites[t];void 0!==o&&0!==o.length&&o.forEach((function(t){u.push(Mc(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",a.setMapOverwrite(e.material_id,t.type,t.textureId,n));case 1:case"end":return r.stop()}}),r)}))))}))})),Cc.S.executeInOrder(u,(function(t,n){t.length>0?e(t[0]):o(n.length>0?n[0]:"Nothing to apply")}))}}),(function(){o("Could not retrieve MaterialManager.")}))})));case 1:case"end":return e.stop()}}),e)}))),function(e,t){return o.apply(this,arguments)})},{key:"_setActiveMaterialByGroupId",value:function(e,t){var n=this.mGroups.find((function(t){return t.group_id==e}));(0,K.isNullOrUndefined)(n)||this._setActiveMaterial(n.id,t)}},{key:"_setMaterialVisibility",value:function(e,t,n){var r=this.mGroups.find((function(t){return t.id==e}));if(!(0,K.isNullOrUndefined)(r)){var o=r.materials;if(!o)return;var i=o.find((function(e){return e.id==t}));(0,K.isNullOrUndefined)(i)||(i.visible=n?1:0,this.onMaterialVisibility.next({id:e,group:r.group_id,ref_id:i.id,visible:n}))}}},{key:"_setMaterialVisibilityByGroupId",value:function(e,t,n){var r=this.mGroups.find((function(t){return t.group_id==e}));r&&this._setMaterialVisibility(r.id,t,n)}},{key:"_setColorOverwrite",value:function(e,t,n){return this.mColorOverwrites[e]=t,this._applyColorOverwrites(e,n)}},{key:"_setMapOverwrite",value:(r=Mc(regeneratorRuntime.mark((function e(t,n,r,o){var i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){if((0,K.isNullOrUndefined)(n))return a("Incorrect type!");(0,K.isNullOrUndefined)(i.mMapOverwrites[t])&&(i.mMapOverwrites[t]=[]);var u=i.mMapOverwrites[t].findIndex((function(e){return e.type===n}));if(((0,K.isNullOrUndefined)(r)||r<0)&&!(0,K.isNullOrUndefined)(i.mMapOverwrites[t][u]))u>=0&&(i.mMapOverwrites[t][u].textureId=null);else try{u>=0?i.mMapOverwrites[t][u].textureId=r:(i.mMapOverwrites[t].push({type:n,textureId:r}),u=i.mMapOverwrites[t].length-1)}catch(e){}i._applyMapOverwrites(t,o).then((function(t){e(t)}),(function(e){a(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(e,t,n,o){return r.apply(this,arguments)})},{key:"_buildQueryParams",value:function(){var e=this,t={};return Object.keys(this.mActiveMaterials).forEach((function(n){var r=Number(n);t[r]="".concat(e.mActiveMaterials[r].id)})),t}}],n&&Ac(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Nc(e){return Nc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nc(e)}function Vc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Uc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vc(Object(n),!0).forEach((function(t){Fc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Fc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Bc(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function Lc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Hc(e,t){return Hc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Hc(e,t)}function zc(e,t){if(t&&("object"===Nc(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function qc(e){return qc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},qc(e)}var Gc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Hc(e,t)}(c,e);var t,n,r,o,i,a,u=(i=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=qc(i);if(a){var n=qc(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return zc(this,e)});function c(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(e=u.call(this,"materialGroupManager")).mMaterialGroupManagerService=new Ic,e}return t=c,n=[{key:"getType",value:function(){return c.TypeRTTI}},{key:"isAttachable",value:function(e){return e.isDerivedOfTypeName("ProductNode")}},{key:"OnAttached",value:function(){this.mMaterialGroupManagerService.init();var e=this.getParentObject().getValue("product_id");!(0,K.isNullOrUndefined)(e)&&e.toString().length>0&&this.mMaterialGroupManagerService._setProductId(e),this.registerMessageHandler(Ec.X.TypeRTTI,this.handleSetValue.bind(this))}},{key:"OnDetached",value:function(){this.mMaterialGroupManagerService.deinit(),this.unregisterMessageHandler(Ec.X.TypeRTTI)}},{key:"handleSetValue",value:function(e){"product_id"===e.key&&this.mMaterialGroupManagerService._setProductId(e.value)}},{key:"resolveMaterialGroups",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.mMaterialGroupManagerService.resolveMaterialGroups(e)}},{key:"serialize",value:(r=regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.resolveMaterialGroups().toPromise();case 2:return t=e.sent,e.abrupt("return",t.getGroups().map((function(e){return{group:e,activeRefModel:t.getActiveRefModel(e.id)}})).filter((function(e){return e.activeRefModel})).map((function(e){var t=e.group,n=e.activeRefModel,r=Uc({},t);return r.materials&&(r.selected_reference_id=n.id),r})));case 4:case"end":return e.stop()}}),e,this)})),o=function(){var e=this,t=arguments;return new Promise((function(n,o){var i=r.apply(e,t);function a(e){Bc(i,n,o,a,u,"next",e)}function u(e){Bc(i,n,o,a,u,"throw",e)}a(void 0)}))},function(){return o.apply(this,arguments)})}],n&&Lc(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(J.H);Gc.TypeRTTI=new f.r("MaterialGroupManagerComponent",J.H.TypeRTTI);var Wc=n(75736),Qc=n(92354);function Kc(e){return Kc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kc(e)}function Yc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Zc(){return Zc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=Xc(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Zc.apply(this,arguments)}function Xc(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=es(e)););return e}function Jc(e,t){return Jc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Jc(e,t)}function $c(e,t){if(t&&("object"===Kc(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function es(e){return es=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},es(e)}var ts=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Jc(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=es(r);if(o){var n=es(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return $c(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e,t)).mFirstProductCreation=!0,n}return t=a,n=[{key:"getType",value:function(){return a.TypeRTTI}},{key:"parse",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{if(this.mFirstProductCreation){this.mFirstProductCreation=!1;var r=JSON.parse(e.asset_meta),o=r.node_matrix,i=new THREE.Vector3,u=new THREE.Quaternion,c=new THREE.Vector3(1,1,1);if(o){var s=(new THREE.Matrix4).set(o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],o[8],o[9],o[10],o[11],o[12],o[13],o[14],o[15]);s.decompose(i,u,c),ee.qL.print("init with initial: ",i,u,c)}var l=(new THREE.Euler).setFromQuaternion(u);e.children=e.children||[],e.children.push({type:"product",name:"Referenced product id:"+r.product_id,properties:'{"child_lock": false, "product_id": "'.concat(r.product_id,'", "object_lock": false}'),position_x:i.x,position_y:i.y,position_z:i.z,rotation_x:l.x,rotation_y:l.y,rotation_z:l.z,scale_x:c.x,scale_y:c.y,scale_z:c.z}),ee.qL.print("product reference node: ",e)}Zc(es(a.prototype),"parse",this).call(this,e,t,n)}catch(e){ee.qL.error("parsing reference product failed: ",e)}}},{key:"onBeforeAddNewToRenderState",value:function(e){return ee.qL.print("reference before add to render state: ",e.getType().isDerivedOfTypeName("ProductNode")),!e.getType().isDerivedOfTypeName("ProductNode")}},{key:"serialize",value:function(e){return Object.assign(Qc.D.prototype.serialize.call(this,e),{type:"asset"})}}],n&&Yc(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(r.B);function ns(e){return ns="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ns(e)}function rs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function os(e,t){return os=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},os(e,t)}function is(e,t){if(t&&("object"===ns(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function as(e){return as=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},as(e)}ts.TypeRTTI=new Re.rz("ReferenceProductNode",r.B.TypeRTTI);var us=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&os(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=as(r);if(o){var n=as(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return is(this,e)});function a(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(e=i.call(this,"propertyValue")).mValues={},e}return t=a,(n=[{key:"getType",value:function(){return a.TypeRTTI}},{key:"OnAttached",value:function(){}},{key:"OnDetached",value:function(){}},{key:"isAttachable",value:function(e){return!0}},{key:"setValue",value:function(e,t){this.mValues[e]=t}},{key:"getValue",value:function(e){return this.mValues[e]}},{key:"valueExists",value:function(e){return void 0!==this.mValues[e]}}])&&rs(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(J.H);us.TypeRTTI=new f.r("PropertyValueComponent",J.H.TypeRTTI);var cs=n(64569),ss=function(){function e(e){this.notifier=e}return e.prototype.call=function(e,t){var n=new ls(e),r=(0,mt.ft)(this.notifier,new mt.IY(n));return r&&!n.seenValue?(n.add(r),t.subscribe(n)):n},e}(),ls=function(e){function t(t){var n=e.call(this,t)||this;return n.seenValue=!1,n}return ht.ZT(t,e),t.prototype.notifyNext=function(){this.seenValue=!0,this.complete()},t.prototype.notifyComplete=function(){},t}(mt.Ds),fs=n(50666),ps=n(50762);function ds(e){return ds="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ds(e)}function hs(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function ys(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ms(e,t){return ms=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ms(e,t)}function vs(e,t){if(t&&("object"===ds(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function bs(e){return bs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},bs(e)}var gs=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ms(e,t)}(c,e);var t,n,r,o,i,a,u=(i=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=bs(i);if(a){var n=bs(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return vs(this,e)});function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=u.call(this)).mSyncHash=new ps.L,t.mObjectModels={},t.sceneObject=e,t}return t=c,n=[{key:"getType",value:function(){return c.TypeRTTI}},{key:"getObjectModel",value:function(e){return e in this.mObjectModels?this.mObjectModels[e]:null}},{key:"getObjectModels",value:function(){return this.mObjectModels}},{key:"syncObjectModels",value:(r=regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.mSyncHash.newHash(),n=this.syncNewModels(t),n=this.detachOutOfSync()||n,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})),o=function(){var e=this,t=arguments;return new Promise((function(n,o){var i=r.apply(e,t);function a(e){hs(i,n,o,a,u,"next",e)}function u(e){hs(i,n,o,a,u,"throw",e)}a(void 0)}))},function(e){return o.apply(this,arguments)})},{key:"syncNewModels",value:function(e){var t=this,n=!1;return Pe.F.isArray(e)&&e.forEach((function(e){e.id in t.mObjectModels?t.mObjectModels[e.id].setSyncHash(t.mSyncHash.getHash()):(n=!0,t.mObjectModels[e.id]=new fs.a(e.id,e.Name,e.Description,e.SKU,e.Price,t.mSyncHash.getHash()),t.mObjectModels[e.id].onAttached())})),n}},{key:"detachOutOfSync",value:function(){var e=this,t=!1,n=new Array;return Object.keys(this.mObjectModels).forEach((function(r){var o=e.mObjectModels[r];o.isInSyncWithHash(e.mSyncHash.getHash())||(t=!0,o.onDetached(),n.push(r))})),n.forEach((function(t){delete e.mObjectModels[t]})),t}}],n&&ys(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(Re.e3);gs.TypeRTTI=new Re.rz("ArticleListController",Re.e3.TypeRTTI);var ws=n(57142);function _s(e){return _s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_s(e)}function Os(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,u=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){u=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(u)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ts(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ts(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ts(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Rs(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function Ss(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Rs(i,r,o,a,u,"next",e)}function u(e){Rs(i,r,o,a,u,"throw",e)}a(void 0)}))}}function Es(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ps(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xs(){return xs="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=js(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},xs.apply(this,arguments)}function js(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ms(e)););return e}function Cs(e,t){return Cs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Cs(e,t)}function ks(e,t){if(t&&("object"===_s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ms(e){return Ms=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ms(e)}var Ds=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Cs(e,t)}(d,e);var t,n,r,o,i,a,u,c,s,l,f,p=(l=d,f=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ms(l);if(f){var n=Ms(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return ks(this,e)});function d(){var e;return Es(this,d),(e=p.apply(this,arguments)).mCache={},e}return t=d,n=[{key:"getType",value:function(){return d.TypeRTTI}},{key:"getName",value:function(){return"ScriptEngineController"}},{key:"getArticles",value:(s=Ss(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.requestSKUs());case 1:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"syncObjectModels",value:(c=Ss(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xs(Ms(d.prototype),"syncObjectModels",this).call(this,t);case 2:return n=e.sent,e.next=5,this.syncScriptModels();case 5:if(e.t0=e.sent,e.t0){e.next=8;break}e.t0=n;case 8:return n=e.t0,e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"syncScriptModels",value:(u=Ss(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.requestSKUs();case 3:t=e.sent,e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",!0);case 9:return n=t.reduce((function(e,t){if(!t.sku)return e;for(var n=t.sku.length;n;)e=33*e^t.sku.charCodeAt(--n);return e}),d.MAGIC_HASH)>>>0,r=this.mScriptModelHash!==n,this.mScriptModelHash=n,e.abrupt("return",r);case 13:case"end":return e.stop()}}),e,this,[[0,6]])}))),function(){return u.apply(this,arguments)})},{key:"getSerializedAttributes",value:(a=Ss(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.sceneObject.getComponent("attributeManager"),e.abrupt("return",t.resolveAttributeManager().toPromise().then((function(e){return{hash:e.hashConfiguration(),serialized:e.serialize({discard_hidden:!1,include_keys:!0,calculate_approximations:!1})}})));case 2:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"requestSKUs",value:(i=Ss(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getSerializedAttributes();case 2:return t=e.sent,n=t.hash,r=t.serialized,e.abrupt("return",this.cache(n,r));case 6:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"requestSKUsFromScriptEngine",value:(o=Ss(regeneratorRuntime.mark((function e(t){var n,r,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.sceneObject.getValue("product_id"),r=gc.E4.makeApiRoute("script_engine/catalogue/".concat(n,"/sku/get")),o={object_models:this.getObjectModels(),attributes:t},e.next=5,gc.OE.getInstance().post(r,o).catch((function(e){return e.response})).then((function(e){return e.data}));case 5:if(!(i=e.sent).error){e.next=8;break}throw i;case 8:return e.abrupt("return",this.buildObjectModels(i));case 9:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"cache",value:(r=Ss(regeneratorRuntime.mark((function e(t,n){var r,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Date.now(),!(o=this.mCache[t])){e.next=5;break}return o.timestamp=r,e.abrupt("return",o.value);case 5:return i=this.requestSKUsFromScriptEngine(n),this.mCache[t]={hash:t,timestamp:r,value:i},e.next=9,i;case 9:return this.clearOldCache(),e.abrupt("return",i);case 11:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"clearOldCache",value:function(){var e=this,t=Object.entries(this.mCache);t.length<=d.MAX_CACHE||t.sort((function(e,t){var n=Os(e,2)[1];return Os(t,2)[1].timestamp-n.timestamp})).splice(d.MAX_CACHE).forEach((function(t){var n=Os(t,1)[0];return delete e.mCache[n]}))}},{key:"buildObjectModels",value:function(e){var t=[],n=0;return e.forEach((function(e){for(var r=0;r<e.quantity;r++)t.push(new ws.ModelProduct(--n,e.name||"",e.description||"",e.sku,e.price||0,null))})),t}}],n&&Ps(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),d}(gs);function As(e){return As="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},As(e)}function Is(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function Ns(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Us(e,t){return Us=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Us(e,t)}function Fs(e,t){if(t&&("object"===As(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Bs(e){return Bs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Bs(e)}Ds.TypeRTTI=new Re.rz("ArticleListScriptEngineController",gs.TypeRTTI),Ds.MAX_CACHE=100,Ds.MAGIC_HASH=5381;var Ls=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Us(e,t)}(c,e);var t,n,r,o,i,a,u=(i=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Bs(i);if(a){var n=Bs(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Fs(this,e)});function c(){return Ns(this,c),u.apply(this,arguments)}return t=c,n=[{key:"getType",value:function(){return c.TypeRTTI}},{key:"getName",value:function(){return"objectModelController"}},{key:"getArticles",value:(r=regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object.keys(this.mObjectModels).map((function(e){return n.mObjectModels[e]})),e.abrupt("return",Promise.resolve(t));case 2:case"end":return e.stop()}}),e,this)})),o=function(){var e=this,t=arguments;return new Promise((function(n,o){var i=r.apply(e,t);function a(e){Is(i,n,o,a,u,"next",e)}function u(e){Is(i,n,o,a,u,"throw",e)}a(void 0)}))},function(){return o.apply(this,arguments)})}],n&&Vs(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(gs);function Hs(e){return Hs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hs(e)}function zs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qs(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zs(Object(n),!0).forEach((function(t){Gs(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zs(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Gs(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ws(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function Qs(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Ws(i,r,o,a,u,"next",e)}function u(e){Ws(i,r,o,a,u,"throw",e)}a(void 0)}))}}function Ks(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ys(e,t){return Ys=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ys(e,t)}function Zs(e,t){if(t&&("object"===Hs(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Xs(e){return Xs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Xs(e)}Ls.TypeRTTI=new Re.rz("ArticleListObjectModelController",gs.TypeRTTI);var Js=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ys(e,t)}(d,e);var t,n,r,o,i,a,u,c,s,l,f,p=(l=d,f=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Xs(l);if(f){var n=Xs(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Zs(this,e)});function d(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(e=p.call(this,"articleListManager")).onModelsChanged=new me.xQ,e}return t=d,n=[{key:"getType",value:function(){return d.TypeRTTI}},{key:"getArticles",value:(s=Qs(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.resolveController();case 2:return t=e.sent,e.abrupt("return",t.getArticles());case 4:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"serialize",value:(c=Qs(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getArticles();case 2:return t=e.sent,e.abrupt("return",t.map((function(e){return e.serialize()})));case 4:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"getController",value:(u=Qs(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.resolveController();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"getObjectModel",value:(a=Qs(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.resolveController();case 2:return n=e.sent,e.abrupt("return",n.getObjectModel(t));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"getObjectModels",value:(i=Qs(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.resolveController();case 2:return t=e.sent,e.abrupt("return",t.getObjectModels());case 4:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"syncObjectModels",value:(o=Qs(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.resolveController();case 2:return n=e.sent,e.next=5,n.syncObjectModels(t);case 5:if(e.sent){e.next=8;break}return e.abrupt("return");case 8:return e.prev=8,e.t0=this.onModelsChanged,e.next=12,n.getArticles();case 12:e.t1=e.sent,e.t2={articles:e.t1},e.t0.next.call(e.t0,e.t2),e.next=20;break;case 17:e.prev=17,e.t3=e.catch(8),this.onModelsChanged.next(qs({},e.t3));case 20:case"end":return e.stop()}}),e,this,[[8,17]])}))),function(e){return o.apply(this,arguments)})},{key:"resolveController",value:(r=Qs(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.mArticleController){e.next=6;break}return t=this.getParentObject(),e.next=4,this.resolvePricingSettings().toPromise();case 4:"script_engine"===e.sent.sku_calculator?this.mArticleController=new Ds(t):this.mArticleController=new Ls(t);case 6:return e.abrupt("return",this.mArticleController);case 7:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"resolvePricingSettings",value:function(){var e,t=this.getParentObject(),n=parseInt(t.getValue("product_id"),10);return no.Q.getInstance().resolveBootstrapData(n).pipe((e=this._destroy$$,function(t){return t.lift(new ss(e))}),(0,_e.q)(1),(0,yt.U)((function(e){return e.getPricingSettings()})))}},{key:"OnAttached",value:function(){this._destroy$$=new me.xQ}},{key:"OnDetached",value:function(){this._destroy$$.next(),this._destroy$$.complete(),delete this._destroy$$}},{key:"isAttachable",value:function(e){return e.isDerivedTypeOf(Y.L.TypeRTTI)}}],n&&Ks(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),d}(J.H);Js.TypeRTTI=new f.r("ArticleListManagerComponent",J.H.TypeRTTI);var $s=n(2168);function el(e){return el="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},el(e)}function tl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function nl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tl(Object(n),!0).forEach((function(t){rl(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function rl(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ol(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function il(){return il="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=al(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},il.apply(this,arguments)}function al(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=sl(e)););return e}function ul(e,t){return ul=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ul(e,t)}function cl(e,t){if(t&&("object"===el(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function sl(e){return sl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},sl(e)}var ll=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ul(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=sl(r);if(o){var n=sl(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return cl(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e,t)).mColor="#FFFFFF",n.mOpacity=1,n.mCacheLayers={},n.onBeforeRender=function(e,t,r){t.traverse((function(e){n.mCacheLayers[e.id]=e.layers.mask,e.layers.set(0)})),n.mFuncReflectorBeforeRender&&n.mFuncReflectorBeforeRender(e,t,r)},n.onAfterRender=function(e,t){t.traverse((function(e){e.layers.mask=n.mCacheLayers[e.id]}))},n}return t=a,(n=[{key:"getType",value:function(){return a.TypeRTTI}},{key:"setValue",value:function(e,t){switch(e){case"color":return t&&t.isColor?this.mColor="#"+t.getHexString():this.mColor=t,this.updateUniforms(),!0;case"opacity":return this.mOpacity=parseFloat(t),this.updateUniforms(),!0}return il(sl(a.prototype),"setValue",this).call(this,e,t)}},{key:"getValue",value:function(e){var t=il(sl(a.prototype),"getValue",this).call(this,e);if(null!==t)return t;switch(e){case"color":return new THREE.Color(this.mColor);case"opacity":return this.mOpacity}return null}},{key:"updateUniforms",value:function(){this.mReflector&&(this.mReflector.material.uniforms.color.value=this.getValue("color"),this.mReflector.material.uniforms.opacity.value=this.getValue("opacity"),this.mReflector.material.needsUpdate=!0)}},{key:"createRenderObject",value:function(){var e=new THREE.PlaneBufferGeometry(20,20);return this.mReflector=new THREE.Reflector(e,{clipBias:.003,textureWidth:1024,textureHeight:1024,color:this.getValue("color"),opacity:this.getValue("opacity"),recursion:1}),this.mReflector.receiveShadow=this.mReceiveShadow,this.mReflector.position.copy(this.mPosition),this.mReflector.scale.copy(this.mScale),this.mReflector.rotation.x=.5*-Math.PI,this.mFuncReflectorBeforeRender=this.mReflector.onBeforeRender,this.mReflector.onBeforeRender=this.onBeforeRender,this.mReflector.onAfterRender=this.onAfterRender,ee.qL.print("reflector created: ",this.mReflector),new d.m(this.mReflector,this)}},{key:"deinitRenderObject",value:function(){delete this.mFuncReflectorBeforeRender,delete this.mReflector,il(sl(a.prototype),"deinitRenderObject",this).call(this)}},{key:"serialize",value:function(e){var t=nl(nl({},il(sl(a.prototype),"serialize",this).call(this,e)),{type:"reflector"});return t.properties=nl(nl({},t.properties),{color:"#"+new THREE.Color(this.mColor).getHexString(),opacity:this.getValue("opacity")}),t}}])&&ol(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}($s.o);ll.TypeRTTI=new f.r("ShaderEntityReflector",$s.o.TypeRTTI),n(66342),n(62962),n(23748);var fl=n(99672),pl=n(79618),dl=n(19790);function hl(e){return hl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hl(e)}function yl(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ml(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vl(){return vl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=bl(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},vl.apply(this,arguments)}function bl(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_l(e)););return e}function gl(e,t){return gl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},gl(e,t)}function wl(e,t){if(t&&("object"===hl(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function _l(e){return _l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},_l(e)}var Ol=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gl(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=_l(r);if(o){var n=_l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return wl(this,e)});function a(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};yl(this,a),(n=i.call(this,e,t)).aSceneObject=e,n.onEvents=new me.xQ,n.mHtmlText="",n.mPositionIteration=0,n.mPresenting=!1,n.mTagVisibilityOwners={},n.OVERLAY_TIMEOUT=300;var o=Object.assign({title:"A1",margin:2,color:"#1f1e1e",hover:"#343232",textColor:"#ffffff",fontSize:10,htmlText:""},r);return n.mTitle=o.title,n.mMargin=o.margin,n.mColor=o.color,n.mHover=o.hover,n.mTextColor=o.textColor,n.mFontSize=o.fontSize,n.mHtmlText=o.htmlText,n._createTag(),n}return t=a,(n=[{key:"getType",value:function(){return a.TypeRTTI}},{key:"setValue",value:function(e,t){switch(e){case"title":return this.setTitle(t),!0;case"color":return(0,K.isUndefined)(t.isColor)?this.mColor=t:this.mColor="#"+t.getHexString(),this.setTitle(this.mTitle),!0;case"hover":return(0,K.isUndefined)(t.isColor)?this.mHover=t:this.mHover="#"+t.getHexString(),this.setTitle(this.mTitle),!0;case"textColor":return(0,K.isUndefined)(t.isColor)?this.mTextColor=t:this.mTextColor="#"+t.getHexString(),this.setTitle(this.mTitle),!0;case"fontSize":return this.mFontSize=parseInt(t,10),this.setTitle(this.mTitle),!0;case"margin":return this.mMargin=t,this.setTitle(this.mTitle),!0;case"htmlText":return this.setHtmlText(t),!0}return vl(_l(a.prototype),"setValue",this).call(this,e,t)}},{key:"getValue",value:function(e){switch(e){case"title":return this.mTitle;case"color":return this.mColor;case"hover":return this.mHover;case"textColor":return this.mTextColor;case"fontSize":return this.mFontSize;case"margin":return this.mMargin;case"htmlText":return this.mHtmlText}return vl(_l(a.prototype),"getValue",this).call(this,e)}},{key:"update",value:function(e){if(this.mPresenting||vl(_l(a.prototype),"update",this).call(this,e),"projection"===this.mPositionType){var t=this.mPosition.clone().project(e);this.updateScale(e,t),this.hideOutOfScreen(e,t),this.updateOverlay(),this.hideWhenInMovement()}}},{key:"updateScale",value:function(e,t){var n=new THREE.Vector3;e.getWorldPosition(n);var r=t.distanceTo(n);r=Math.max(r,.001),r=Math.pow(r,1.25);var o=e.far-e.near,i=Math.min(Math.max(o/r,.25),1);this.mTagElement.style.transform="scale(".concat(i,")")}},{key:"hideOutOfScreen",value:function(e,t){var n=this.uiRenderer.getSize(),r=t.clone();r.x=(r.x+1)/2*n.width,r.y=-(r.y-1)/2*n.height,this.mTagElement.style.visibility=r.x>n.width||r.x<0||r.y>n.height||r.y<0?"hidden":"visible"}},{key:"updateOverlay",value:function(){this.mOverlayElement&&(this.mOverlayElement.style.transform="translate(-".concat(this.domElement.style.left,"px, -").concat(this.domElement.style.top,")"))}},{key:"fadeInOut",value:function(){var e=this;clearTimeout(this.mVisibilityHandle),this.mVisibilityHandle=setTimeout((function(){e.showTag("movement"),e.mPositionIteration=0,delete e.mVisibilityHandle}),100)}},{key:"hideWhenInMovement",value:function(){this.isInSceneEditor()||(this.mPositionIteration++>50&&this.hideTag("movement"),this.fadeInOut())}},{key:"showTag",value:function(e){delete this.mTagVisibilityOwners[e],0===Object.keys(this.mTagVisibilityOwners).length&&(this.mTagElement.style.display="flex")}},{key:"hideTag",value:function(e){this.mTagVisibilityOwners[e]=!0,this.mTagElement.style.display="none"}},{key:"setTitle",value:function(e){this.mTitle=e,this.mTextElement.style.fontSize="".concat(this.mFontSize,"px"),this.mTextElement.textContent=this.mTitle;var t=this.mTextElement.clientHeight+1,n=this.mTextElement.clientWidth+1+t+this.mMargin,r="".concat(n,"px");this.mTagElement.style.backgroundColor=this.mColor,this.mTagElement.style.color=this.mTextColor,this.mTagElement.style.width=r,this.mTagElement.style.height=r}},{key:"setHtmlText",value:function(e){this.mHtmlText=e,this.mOverlayElement&&(this.mOverlayElement.querySelector(".xpv-annotation-html").innerHTML=this.mHtmlText)}},{key:"_createTag",value:function(){var e=this;this.mTextElement=document.createElement("div"),this.mTextElement.setAttribute("data-ui-type","annotation-tag-title"),this.mTextElement.textContent=this.mTitle,this.mTextElement.style.cssText="\n            font-size: ".concat(this.mFontSize,"px;\n            position: absolute;\n            top: 0px;\n            left: 0px;\n            visibility: hidden;\n            display: block;\n            transform-origin: top left;\n        "),document.body.appendChild(this.mTextElement);var t=this.mTextElement.offsetHeight+1,n=this.mTextElement.offsetWidth+1+t+this.mMargin,r="".concat(n,"px");document.body.removeChild(this.mTextElement),this.mTextElement.style.position="relative",this.mTextElement.style.visibility="",this.mTextElement.style.display="",this.mTagElement=document.createElement("div"),this.mTagElement.setAttribute("data-ui-type","annotation-tag"),this.mTagElement.setAttribute("data-annotation-uuid",this.aSceneObject.uuid),this.mTagElement.style.cssText="\n            position: relative;\n            top: 0px;\n            left: 0px;\n            width: ".concat(r,";\n            height: ").concat(r,";\n            background-color: ").concat(this.mColor,";\n            color: ").concat(this.mTextColor,";\n            border-radius: 50%;\n            border: 3px solid white;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            transform-origin: left top;\n            -ms-user-select: none;\n            -moz-user-select: none;\n            -webkit-user-select: none;\n            user-select: none;\n        "),this.mTagElement.appendChild(this.mTextElement),this.mTagElement.addEventListener("mouseover",(function(){e.mTagElement.style.backgroundColor=e.mHover})),this.mTagElement.addEventListener("mouseout",(function(){e.mTagElement.style.backgroundColor=e.mColor})),this.mTagElement.addEventListener("click",(function(){e.showOverlay(),e.onEvents.next({name:"click",data:e.getObjectId()})})),this.domElement.appendChild(this.mTagElement)}},{key:"showOverlay",value:function(){var e=this;this.mPresenting||this.mEditting||this.isInSceneEditor()||(this.mPresenting=!0,this.hideTag("overlay"),setTimeout((function(){e.createTextOverlay()}),this.OVERLAY_TIMEOUT))}},{key:"hideOverlay",value:function(){this.mPresenting=!1,this.showTag("overlay"),this.mOverlayElement.parentNode.removeChild(this.mOverlayElement),delete this.mOverlayElement}},{key:"isInSceneEditor",value:function(){var e=this.getSceneObject().getRenderState().getSceneManager().getApplication();return e&&e.getState(dl.D.SCENE_EDITOR)}},{key:"createTextOverlay",value:function(){var e=this;this.mOverlayElement=document.createElement("div"),this.mOverlayElement.setAttribute("data-ui-type","annotation-text-overlay");var t=this.uiRenderer.getSize();this.mOverlayElement.style.cssText="\n            top: 0;\n            left: 0;\n            position: absolute;\n            width: ".concat(t.width,"px;\n            height: ").concat(t.height,"px;\n            background: linear-gradient(0deg, rgba(255, 255, 255, 0.44) 0%, rgba(199, 209, 225, 0.55) 40%, rgba(15, 35, 39, 0.64) 100%);\n            display: block;\n            padding: 1rem;\n            overflow-y: auto;\n            color: #ffffff;\n            font-size: 2rem;\n            transform: translate(-").concat(this.domElement.style.left,", -").concat(this.domElement.style.top,");\n            z-index: 2;\n        ");var n=document.createElement("div");n.classList.add("xpv-annotation-html"),n.style.cssText="\n            border-left: 2px solid white;\n            padding: 0.5rem;\n        ",n.innerHTML=this.mHtmlText,this.mOverlayElement.appendChild(n);var r=document.createElement("div");r.style.cssText="\n            margin: 1rem 0;\n            font-weight: bold;\n            font-size: large;\n            cursor: pointer;\n            display: inline-block;\n        ",r.innerHTML='\n            Back\n            <br/>\n            <span style="font-size: 32px;line-height: 18px;margin-left: -1px;">\n                &#129044;\n            </span>\n        ',r.onclick=function(){e.hideOverlay(),e.onEvents.next({name:"back",data:e.getObjectId()})},this.mOverlayElement.appendChild(r),this.domElement.appendChild(this.mOverlayElement)}}])&&ml(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(pl.p);function Tl(e){return Tl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tl(e)}function Rl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Sl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rl(Object(n),!0).forEach((function(t){El(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function El(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Pl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xl(){return xl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=jl(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},xl.apply(this,arguments)}function jl(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ml(e)););return e}function Cl(e,t){return Cl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Cl(e,t)}function kl(e,t){if(t&&("object"===Tl(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ml(e){return Ml=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ml(e)}Ol.TypeRTTI=new f.r("AnnotationUixObject",pl.p.TypeRTTI);var Dl=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Cl(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ml(r);if(o){var n=Ml(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return kl(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e,t)).mOptions={},n.mViewportPosition=new THREE.Vector3,n.mViewportRotation=new THREE.Euler,n.mSubscriptions=[],n.setValue("options",{title:"A1",margin:2,color:"#1f1e1e",hover:"#343232",fontSize:10,textColor:"#ffffff"}),n}return t=a,(n=[{key:"getType",value:function(){return a.TypeRTTI}},{key:"setValue",value:function(e,t){switch(e){case"htmlText":return this.mOptions.htmlText=t,!0;case"viewport":return this.setValue("viewport_position",t.position),this.setValue("viewport_rotation",t.rotation),!0;case"viewport_position":return t&&t.isVector3?this.mViewportPosition=t.clone():Array.isArray(t)&&this.mViewportPosition.fromArray(t),!0;case"viewport_rotation":return t&&t.isEuler?this.mViewportRotation=t.clone():Array.isArray(t)&&this.mViewportRotation.fromArray(t),!0}return xl(Ml(a.prototype),"setValue",this).call(this,e,t)}},{key:"getValue",value:function(e){var t=xl(Ml(a.prototype),"getValue",this).call(this,e);if(null!==t)return t;switch(e){case"htmlText":return this.mOptions.htmlText;case"viewport":return{position:this.mViewportPosition,rotation:this.mViewportRotation};case"viewport_position":return this.mViewportPosition;case"viewport_rotation":return this.mViewportRotation}return null}},{key:"createRenderObject",value:function(){var e=this,t=this.getRenderState().getSceneManager().getRenderScene().userData._editorRef,n=new Ol(this,t.getUiRenderer(),this.mOptions);return n.positionType=this.getValue("position_type"),n.position=new THREE.Vector3(this.mPosition.x,this.mPosition.y,this.mPosition.z),n.locked=this.getValue("locked"),this.mSubscriptions.push(n.onEvents.subscribe((function(t){return e.uiEvent(t)}))),new fl.p(n,this)}},{key:"uiEvent",value:function(e){switch(e.name){case"click":this.moveToViewport();break;case"back":this.returnToPreviousCamera()}}},{key:"moveToViewport",value:function(){var e=this.getRenderState().getSceneManager().getRenderScene().userData._editorRef;this.mPreviousCamera={position:e.getCamera().position.clone(),rotation:e.getCamera().rotation.clone()},this.getRenderState().dispatchAppMessage(new zr.GY(this.mViewportPosition.clone(),this.mViewportRotation.toVector3(),zr.HF.PUSH_CONTROLLER))}},{key:"returnToPreviousCamera",value:function(){this.getRenderState().dispatchAppMessage(new zr.GY(this.mPreviousCamera.position,this.mPreviousCamera.rotation.toVector3(),zr.HF.POP_CONTROLLER))}},{key:"destroyRenderObject",value:function(){return this.mSubscriptions.splice(0).forEach((function(e){return e.unsubscribe()})),xl(Ml(a.prototype),"destroyRenderObject",this).call(this)}},{key:"serialize",value:function(e){var t=xl(Ml(a.prototype),"serialize",this).call(this,e);return Sl(Sl({},t),{},{type:"uix_annotation",ui_options:JSON.stringify(Sl(Sl({},JSON.parse(t.ui_options)),{htmlText:this.mOptions.htmlText})),properties:Sl(Sl({},t.properties),{viewport_position:this.mViewportPosition.toArray(),viewport_rotation:this.mViewportRotation.toArray()})})}}])&&Pl(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(z.T);function Al(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Dl.TypeRTTI=new f.r("UiEntityAnnotation",z.T.TypeRTTI);var Il=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"createObject",value:function(t,n,r){var o=null;if(t in e._factories){for(var i=e._factories[t],a=(0,K.isUndefined)(i.factory)?i:i.factory,u=(0,K.isUndefined)(i.components)?[]:i.components,c=arguments.length,s=new Array(c>3?c-3:0),l=3;l<c;l++)s[l-3]=arguments[l];if((0,K.isUndefined)(s))o=new a(r,n);else{var f=[null,r,n].concat(s);o=new(Function.prototype.bind.apply(a,f))}u.forEach((function(e){o.addComponent(new e)}))}return o}}],n&&Al(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();Il._factories={product:{factory:Y.L,components:[Gc,vc,Z.P,X.I,ue,us,Js]},configurable:D.w,vnode:r.B,node:r.B,vmesh:o.u,group:ye,view:i.R,spotLight:a.p,pointLight:u.m,hemisphereLight:c.v,directionalLight:s.C,ambientLight:l.d,rectAreaLight:_,sphere:O.f,plane:T.N,box:R.X,line:Q.j,camera_perspective:S.x,reference_product:ts,water:E.G,reflector:ll,meshModel:P.Y,glare:x.q,text:C.Y,flare:j.I,fire:Wc.x,skycube:k.h,skyequirect:M.h,ao_plane:cs.s,global_clipper:H,uix_button:z.T,uix_image:q.p,uix_tag:G.d,uix_text:W.$,uix_annotation:Dl,drop_area:{factory:bc.M,components:[Sc]}}},8438:function(e,t,n){"use strict";n.d(t,{i:function(){return w}}),n(92222),n(41539),n(15581),n(2490),n(34514),n(54747),n(88674),n(21703),n(68216),n(79433),n(40561),n(69070);var r=n(70456),o=n(64944),i=n(39876),a=n(50753),u=n(74897),c=n(67988),s=n(89539),l=n(12673),f=n(83348),p=n(99556),d=n(14311),h=n(29844),y=n(41142),m=n(89002),v=n(23498),b=n(79843);function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var w=function(){function e(t,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mApplication=null,this.mActiveBuild=null,this.onApplicationReady=new r.t(1),this.mResourceManager=t,this.mSceneFactory=(0,s.isNullOrUndefined)(o)?new l.g:o,this.mRenderState=new a.n(this,this.mResourceManager),(0,s.isFunction)(n)?this.mRootNode=n(this):this.mRootNode=this.createObject("node",-1)}var t,n;return t=e,n=[{key:"_initApplication",value:function(e,t){this.mApplication=e,this.mRenderScene=t,this.onApplicationReady.next(this.mApplication)}},{key:"getApplication",value:function(){return this.mApplication}},{key:"getRenderScene",value:function(){return this.mRenderScene}},{key:"getRenderState",value:function(){return this.mRenderState}},{key:"createObject",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];if(!(0,s.isNullOrUndefined)(r)){var i=[e,t,this.mRenderState].concat(r);return this.mSceneFactory.createObject.apply(this,i)}return this.mSceneFactory.createObject(e,t,this.mRenderState)}},{key:"isRootNode",value:function(e){return this.mRootNode.getObjectId()===e.getObjectId()}},{key:"getRootNode",value:function(){return this.mRootNode}},{key:"getActiveProductNode",value:function(){if(!(0,s.isNullOrUndefined)(this.mRootNode)){var e=this.findNodesOfType(f.L.TypeRTTI);return e.length>0?e[0]:null}return null}},{key:"getActiveView",value:function(){var e=this.getRenderState().getActiveViewInfo();return(0,s.isNullOrUndefined)(e)?null:this.getViewById(e.product_scene_id,e.view_id)}},{key:"getViewById",value:function(e,t){var n=new Array,r=this.findNodesOfType(f.L.TypeRTTI,(function(t){return t.getSceneObjectId()===e}));if(0===r.length)return null;for(n.push(r[0]);n.length>0;){var o=n.shift();if(o.isDerivedTypeOf(c.B.TypeRTTI)){if(o.isDerivedTypeOf(u.R.TypeRTTI)&&o.getViewId()===t)return o;o.getChildren().forEach((function(e){e.isDerivedTypeOf(f.L.TypeRTTI)||n.push(e)}))}}return null}},{key:"findNodesOfType",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.findNodesOfTypeName(e.getTypeName(),t,n)}},{key:"findNodesOfTypeName",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=new Array,o=new Array;for(o.push((0,s.isNullOrUndefined)(n)?this.mRootNode:n);o.length>0;){var i=o.shift();i.isDerivedOfTypeName(e)&&((0,s.isNullOrUndefined)(t)||t(i))&&r.push(i),i.isDerivedTypeOf(c.B.TypeRTTI)&&i.getChildren().forEach((function(e){return o.push(e)}))}return r}},{key:"findNode",value:function(e,t){var n=null;m.F.isUUID(e)&&(n=e);var r=new Array;for(r.push(this.mRootNode);r.length>0;){var o=r.shift();if(((0,s.isNullOrUndefined)(t)||o.isDerivedTypeOf(t))&&(null!==n&&o.getObjectUUID()===n||null===n&&o.getSceneObjectId()==e))return o;o.isDerivedTypeOf(c.B.TypeRTTI)&&o.getChildren().forEach((function(e){return r.push(e)}))}return null}},{key:"findNodesNamed",value:function(e){var t=new Array,n=new Array;for(n.push(this.mRootNode);n.length>0;){var r=n.shift();r.getValue("name")===e&&t.push(r),r.isDerivedTypeOf(c.B.TypeRTTI)&&r.getChildren().forEach((function(e){return n.push(e)}))}return t}},{key:"setActiveViewId",value:function(e,t){var n=this,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=this.getViewById(e,t),i=!1;if(!(0,s.isNullOrUndefined)(o)){var a=o.findParentOfType(f.L.TypeRTTI);(i=!(0,s.isNullOrUndefined)(a)&&(0,s.isNullOrUndefined)(a.findParentOfType(f.L.TypeRTTI)))&&this.mRenderState._setActiveViewId(e,t)}return new Promise((function(e,a){if((0,s.isNullOrUndefined)(o))a("ViewId not found:"+t);else{if(!i)return a("view is not part of root product");r&&n.mRootNode.dismissBuild(),n.buildScene().subscribe((function(t){e(o)}),(function(e){a(e)}))}}))}},{key:"getActiveViewInfo",value:function(){return this.mRenderState.getActiveViewInfo()}},{key:"getActiveCameraId",value:function(){return this.mActiveCameraId}},{key:"_setActiveCameraId",value:function(e){this.mActiveCameraId=e}},{key:"buildScene",value:function(){var e=this;y.qL.print("scene manager: build scene"),this.getRenderState().dispatchAppEvent(d.G.BuildStarted);var t=this.mRootNode.buildRenderObject().pipe((0,i.B)());return this.mActiveBuild=t,t.subscribe((function(){t===e.mActiveBuild&&(e.mActiveBuild=null),e.mRenderState.requestFrame(),e.mRenderState.dispatchAppEvent(d.G.BuildUpdated)}),(function(n){t===e.mActiveBuild&&(e.mActiveBuild=null),e.mRenderState.dispatchAppEvent(d.G.BuildUpdated)})),t}},{key:"destroyScene",value:function(){return this.mRootNode.destroyRenderObject()}},{key:"destruct",value:function(){this.mRootNode.dismissBuild(),this.mRootNode.removeAllComponents();var e=this.mRootNode.destroyRenderObject();return this.mRootNode=null,this.onApplicationReady.unsubscribe(),this.mRenderState=null,e}},{key:"observeActiveBuild",value:function(){return null!==this.mActiveBuild?this.mActiveBuild:(0,o._)(new Error("No active build"))}},{key:"getNodeNamespace",value:function(e){if(this.isRootNode(e))return"/"+e.getValue("product_id")+"/";var t=new Array,n=null;for(t.push(e.getParent());t.length>0;){var r=t.shift();if((0,s.isNull)(r))break;if(r.isDerivedTypeOf(f.L.TypeRTTI)){n=r;break}t.push(r.getParent())}var o="/";return(0,s.isNullOrUndefined)(n)||this.findNodesOfType(f.L.TypeRTTI).every((function(e){return o+=n.getValue("product_id")+"/",e.getObjectId()!==n.getObjectId()})),o}},{key:"addNode",value:function(e,t,n){var r=this,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return new Promise((function(i,a){y.qL.print("add node to scene:",e);var u=null;(0,s.isNullOrUndefined)(t)||(u=r.getViewById((0,s.isNullOrUndefined)(n)?r.getActiveProductNode().getSceneObjectId():n,t)),null===u&&(u=r.getActiveView()),u.attachChild(e),r.getRenderState().addNewNode(r.getNodeNamespace(e),e),o?r.mRootNode.buildRenderObject().subscribe((function(e){return i(e)}),(function(e){return a(e)})):i(!0)}))}},{key:"deleteNode",value:function(e){var t=this,n=e.getParent();if(null!==n){var r=this.getNodeNamespace(e),o=n.detachChild(e,(function(){return t.mRenderState.requestFrame()}));y.qL.print("delete node",e," namespace:",r),(0,s.isNullOrUndefined)(o)||function(){var e=new Array;for(e.push(o);e.length>0;){var n=e.shift();t.getRenderState().setNodeDeleted(r,n.getSceneObjectId()),n.isDerivedTypeOf(c.B.TypeRTTI)&&n.getChildren().forEach((function(t){return e.push(t)}))}}()}else y.qL.print("product node can not be deleted")}},{key:"moveNode",value:function(e,t){var n=this;y.qL.print("Move",e,t);var r=e.getParent();return null!==r?new Promise((function(o,i){r.detachChild(e,(function(e){(0,s.isNullOrUndefined)(e)?i("node not found:"+e):(t.attachChild(e),e.getSceneObjectId()>=0&&n.getRenderState().setNodeMoved(n.getNodeNamespace(e),e.getSceneObjectId(),t.getSceneObjectId()),o(e)),n.mRenderState.requestFrame()}))})):(y.qL.warn("product node can not be moved"),null)}},{key:"saveScene",value:function(){var e=this;return new Promise((function(t,n){var r=e.findNodesOfType(f.L.TypeRTTI);r.splice(1);var o=[];r.forEach((function(t){o.push((function(){return new Promise((function(n,r){var o=t.serialize(!1,!0);y.qL.print("save scene:",o),h.O.getInstance().post("catalogue/"+t.getValue("product_id")+"/scene_objects/sync",{scene:o,deletions:e.getRenderState().getDeletedNodes(t.getProductNodeNamespace())}).then((function(e){v.g.getInstance().disposeCatalogue(t.getValue("product_id")),b.Q.getInstance().resetCache(),n(!0)}),(function(e){r(e)}))}))}))})),p.S.executeInOrder(o,(function(r,o){if(o.length>0)return alert("failed to save scene."),n(o[0]);e.getRenderState().resetNodeStates(),p.S.completePromise(e.mRootNode.detachAllChildren()).then((function(){e.destroyScene().subscribe((function(){e.buildScene().subscribe((function(){return t(!0)}),(function(){return t(!1)}))}),(function(){e.buildScene().subscribe((function(){return t(!0)}),(function(){return t(!1)}))}))}))}))}))}},{key:"registerOnRenderObjectAttached",value:function(e,t,n){return this.mRenderState.onRenderObjectAttached.subscribe(e,t,n)}},{key:"registerOnRenderObjectDetached",value:function(e,t,n){return this.mRenderState.onRenderObjectDetached.subscribe(e,t,n)}},{key:"registerOnDispatchAppEvent",value:function(e,t,n){return this.mRenderState.onDispatchAppEvent.subscribe(e,t,n)}},{key:"registerOnExecuteAppCommand",value:function(e,t,n){return this.mRenderState.onExecuteAppCommand.subscribe(e,t,n)}},{key:"registerOnDispatchAppMessage",value:function(e,t,n){return this.mRenderState.onDispatchAppMessage.subscribe(e,t,n)}}],n&&g(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},67988:function(e,t,n){"use strict";n.d(t,{B:function(){return _}}),n(41539),n(15581),n(2490),n(34514),n(54747),n(47941),n(69826),n(31672),n(59461),n(19601),n(40561),n(82772),n(88674),n(47042),n(68216),n(79433),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(42615),o=n(18170),i=n(47746),a=n(29514),u=n(92354),c=n(90140),s=n(89539),l=n(37526),f=n(99556),p=n(41142),d=n(14311);function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(){return m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=v(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},m.apply(this,arguments)}function v(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=w(e)););return e}function b(e,t){return b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},b(e,t)}function g(e,t){if(t&&("object"===h(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function w(e){return w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},w(e)}var _=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b(e,t)}(v,e);var t,n,u,c,h=(u=v,c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=w(u);if(c){var n=w(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return g(this,e)});function v(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,v),(n=h.call(this,e,t)).mChildren=new Array,n.mChildLock=!1,n}return t=v,n=[{key:"getType",value:function(){return v.TypeRTTI}},{key:"setValue",value:function(e,t){return"child_lock"===e?(this.mChildLock=!0===t||"1"==t||"true"===t,!0):m(w(v.prototype),"setValue",this).call(this,e,t)}},{key:"getValue",value:function(e){var t=m(w(v.prototype),"getValue",this).call(this,e);return null!==t?t:"child_lock"===e?this.mChildLock:null}},{key:"parse",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.setSyncHash(t),((0,s.isNullOrUndefined)(e.object_updated_at)||this.getServerSyncTime()!==e.object_updated_at)&&Object.keys(e).forEach((function(t){n.setValue(t,e[t],!0)})),!0===r||!this.mChildLock&&this.onBeforeParseChildren()){!(0,s.isNullOrUndefined)(e.children)&&e.children instanceof Array&&e.children.forEach((function(e){var r=n.mChildren.find((function(t){return t.getSceneObjectId()==e.scene_object_id}));if((0,s.isUndefined)(r)){if(n.onBeforeParseCreate(e.type)){var o=n.getRenderState().getSceneManager().createObject(e.type,e.scene_object_id);(0,s.isNullOrUndefined)(o)?p.qL.warn("unknown node in parse: ",e.type):(n.attachChild(o),o.getSceneObjectId()<0&&n.onBeforeAddNewToRenderState(o)&&n.getRenderState().addNewNode(n.getRenderState().getSceneManager().getNodeNamespace(o),o),o.parse(e,t))}}else r.parse(e,t)}));for(var o=this.mChildren.length-1;o>=0;o--){var i=this.mChildren[o];i.getSceneObjectId()>=0&&!i.isInSyncWithHash(t)&&this.detachChildAtIndex(o)}}}},{key:"serialize",value:function(e,t){var n=Object.assign(m(w(v.prototype),"serialize",this).call(this,e,t),{type:"node"});return n.properties=Object.assign(n.properties,{child_lock:this.mChildLock}),n.children=[],!0===t||!this.mChildLock&&this.onBeforeSerializeChildren()?(this.mChildren.forEach((function(t){n.children.push(t.serialize(e))})),n):n}},{key:"attachChild",value:function(e){return this.attachChildAtIndex(e,this.mChildren.length)}},{key:"attachChildAtIndex",value:function(e,t){return this._beforeAttach(e)?(this.mChildren.splice(t,0,e),e.setParent(this),this._afterAttach(e),this.getRenderState().dispatchAppEvent(d.G.SceneObjectAttached,e),this.mChildren.indexOf(e)):-1}},{key:"detachChild",value:function(e,t){return this.detachChildAtIndex(this.mChildren.indexOf(e),t)}},{key:"detachChildAtIndex",value:function(e,t){var n=this;if(this.mChildren.length>0&&e<this.mChildren.length){var r=this.mChildren[e];return p.qL.print("detaching child: ",r),Promise.resolve(r.destroyRenderObject()).then((function(e){r.setParent(null),n.getRenderState().dispatchAppEvent(d.G.SceneObjectDetached,r),(0,s.isNullOrUndefined)(t)||t(r)}),(function(e){r.setParent(null),n.getRenderState().dispatchAppEvent(d.G.SceneObjectDetached,r),(0,s.isNullOrUndefined)(t)||t(r)})),this.mChildren.splice(e,1)[0]}(0,s.isNullOrUndefined)(t)||t(null)}},{key:"detachAllChildren",value:function(){var e=this,t=new Array,n=new Array;return this.getChildren().slice().forEach((function(r){var o=new Promise((function(n){e.detachChild(r,(function(e){t.push(e),n(e)}))}));n.push(o)})),new Promise((function(e){f.S.resolveArray(n,(function(n){e(t)}))}))}},{key:"getNumChildren",value:function(){return this.mChildren.length}},{key:"getChildAtIndex",value:function(e){return e>0&&e<this.mChildren.length?this.mChildren[e]:void 0}},{key:"getChildren",value:function(){return this.mChildren}},{key:"getChildrenDerivedTypeOf",value:function(e){return this.getChildrenDerivedOfTypeName(e.getTypeName())}},{key:"getChildrenDerivedOfTypeName",value:function(e){var t=new Array;return this.mChildren.forEach((function(n){n.isDerivedOfTypeName(e)&&t.push(n)})),t}},{key:"_beforeAttach",value:function(e){return!0}},{key:"_afterAttach",value:function(e){}},{key:"buildRenderObject",value:function(){var e=this;return m(w(v.prototype),"buildRenderObject",this).call(this).pipe((0,i.zg)((function(t){if(t&&e.mChildren.length>0){var n=new Array;return e.mChildren.forEach((function(e){n.push(e.buildRenderObject())})),(0,r.D)(n,(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.every((function(e){return!0===e}))})).pipe((0,a.P)())}return(0,o.of)(t)})))}},{key:"destroyRenderObject",value:function(){var e=this;if(0===this.mChildren.length)return m(w(v.prototype),"destroyRenderObject",this).call(this);var t=new Array;return this.mChildren.forEach((function(e){t.push(e.destroyRenderObject())})),(0,r.D)(t,(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.every((function(e){return!0===e}))})).pipe((0,a.P)(),(0,i.zg)((function(){return m(w(v.prototype),"destroyRenderObject",e).call(e)})),(0,a.P)())}},{key:"killBuild",value:function(){var e=this;if(0===this.mChildren.length)return m(w(v.prototype),"killBuild",this).call(this);var t=new Array;return this.mChildren.forEach((function(e){t.push(e.killBuild())})),(0,r.D)(t,(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.every((function(e){return!0===e}))})).pipe((0,a.P)(),(0,i.zg)((function(){return m(w(v.prototype),"killBuild",e).call(e)})),(0,a.P)())}},{key:"dismissBuild",value:function(){var e=this;if(0===this.mChildren.length)return m(w(v.prototype),"dismissBuild",this).call(this);var t=new Array;return this.mChildren.forEach((function(e){t.push(e.dismissBuild())})),(0,r.D)(t,(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.every((function(e){return!0===e}))})).pipe((0,a.P)(),(0,i.zg)((function(){return m(w(v.prototype),"dismissBuild",e).call(e)})),(0,a.P)())}},{key:"dispatchMessage",value:function(e){m(w(v.prototype),"dispatchMessage",this).call(this,e),this.mChildren.forEach((function(t){t.dispatchMessage(e)}))}},{key:"createRenderObject",value:function(){var e=new THREE.Group;return e.position.copy(this.mPosition),e.rotation.copy(this.mRotation),e.scale.copy(this.mScale),new l.m(e,this)}},{key:"deinitRenderObject",value:function(){m(w(v.prototype),"deinitRenderObject",this).call(this)}},{key:"onBeforeParseChildren",value:function(){return!0}},{key:"onBeforeParseCreate",value:function(e){return!0}},{key:"onBeforeAddNewToRenderState",value:function(e){return!0}},{key:"onBeforeSerializeChildren",value:function(){return!0}}],n&&y(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),v}(u.D);_.TypeRTTI=new c.r("SceneNode",u.D.TypeRTTI)},92354:function(e,t,n){"use strict";n.d(t,{D:function(){return O}}),n(54678),n(41539),n(15581),n(2490),n(34514),n(54747),n(47941),n(21703),n(68304),n(30489),n(81299),n(12419),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(18170),o=n(64944),i=n(39876),a=n(78842),u=n(90140),c=n(78456),s=n(71303),l=n(89539),f=n(83194),p=n(41142),d=n(16839),h=n(57877),y=n(37852),m=n(89002);function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e,t){return g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},g(e,t)}function w(e,t){if(t&&("object"===v(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function _(e){return _=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},_(e)}var O=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}(O,e);var t,n,a,u,v=(a=O,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=_(a);if(u){var n=_(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return w(this,e)});function O(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,O),(n=v.call(this)).mRenderObject=null,n.mParentObject=null,n.mLoadingProcess=null,n.mName="Scene object",n.mReceiveShadow=!1,n.mCastShadow=!1,n.mHasModel=!1,n.mObjectLock=!1,n.mPosition=new THREE.Vector3,n.mRotation=new THREE.Euler,n.mScale=new THREE.Vector3(1,1,1),n.mSceneObjectId=(0,l.isNullOrUndefined)(t)?-n.getObjectId():t,n.mRenderState=e,n.registerMessageHandler(f.S.TypeRTTI,(function(e){n.isDerivedTypeOf(e.object_type)&&n.hasRenderObject()&&n.getRenderObject().dispatchMessage(e)})),n}return t=O,(n=[{key:"getType",value:function(){return O.TypeRTTI}},{key:"serialize",value:function(e,t){var n;n=null===this.getParent()||null===this.getParent().getParent()||this.getParent().isDerivedOfTypeName("ProductNode")?null:this.getParent().getSceneObjectId();var r=e?++y.e.ObjectIdCount:this.getObjectId();return{name:this.mName,parent_id:n,object_cid:r,object_uuid:e?m.F.guid():this.getObjectUUID(),scene_object_id:e?-r:this.mSceneObjectId,receive_shadow:this.mReceiveShadow,cast_shadow:this.mCastShadow,properties:{object_lock:this.mObjectLock},has_model:this.mHasModel,position_x:this.mPosition.x,position_y:this.mPosition.y,position_z:this.mPosition.z,rotation_x:this.mRotation.x,rotation_y:this.mRotation.y,rotation_z:this.mRotation.z,scale_x:this.mScale.x,scale_y:this.mScale.y,scale_z:this.mScale.z}}},{key:"setValue",value:function(e,t){var n=this;switch(e){case"Name":case"name":return this.mName=String(t),!0;case"object_uuid":return this._setObjectUUID(t),!0;case"object_updated_at":return this.mServerSyncTime=t,!0;case"receive_shadow":case"receiveShadow":return this.mReceiveShadow=!0===t||"1"==t,!0;case"cast_shadow":case"castShadow":return this.mCastShadow=!0===t||"1"==t,!0;case"has_model":case"hasModel":return this.mHasModel=!0===t||"1"==t,!0;case"object_lock":return this.mObjectLock=!0===t||"1"==t,!0;case"position_x":return this.mPosition.x=parseFloat(t),!0;case"position_y":return this.mPosition.y=parseFloat(t),!0;case"position_z":return this.mPosition.z=parseFloat(t),!0;case"rotation_x":return this.mRotation.x=parseFloat(t),!0;case"rotation_y":return this.mRotation.y=parseFloat(t),!0;case"rotation_z":return this.mRotation.z=parseFloat(t),!0;case"scale_x":return this.mScale.x=parseFloat(t),!0;case"scale_y":return this.mScale.y=parseFloat(t),!0;case"scale_z":return this.mScale.z=parseFloat(t),!0;case"position":return!t||!0!==t.isVector2&&!0!==t.isVector3||(this.mPosition.x=t.x,this.mPosition.y=t.y,!0===t.isVector3&&(this.mPosition.z=t.z)),!0;case"rotation":return t&&!0===t.isEuler&&(this.mRotation=t.clone()),!0;case"quaternion":return t&&!0===t.isQuaternion&&this.mRotation.setFromQuaternion(t),!0;case"scale":return t&&!0===t.isVector3&&(this.mScale=t.clone()),!0;case"properties":if(!(0,l.isNullOrUndefined)(t))try{var r;r=(0,l.isString)(t)?JSON.parse(t):t,Object.keys(r).forEach((function(e){"properties"!==e?n.setValue(e,r[e]):p.qL.warn("Properties field can not contain key name properties")}))}catch(e){p.qL.warn("could not parse properties: ",e)}return!0}return!1}},{key:"getValue",value:function(e){switch(e){case"Name":case"name":return this.mName;case"object_cid":return this.getObjectId();case"object_uuid":return this.getObjectUUID();case"server_sync_time":case"object_updated_at":return this.getServerSyncTime();case"receive_shadow":case"receiveShadow":return this.mReceiveShadow;case"cast_shadow":case"castShadow":return this.mCastShadow;case"has_model":case"hasModel":return this.mHasModel;case"object_lock":return this.mObjectLock;case"position":return this.mPosition;case"position_x":return this.mPosition.x;case"position_y":return this.mPosition.y;case"position_z":return this.mPosition.z;case"rotation":return this.mRotation;case"rotation_x":return this.mRotation.x;case"rotation_y":return this.mRotation.y;case"rotation_z":return this.mRotation.z;case"scale":return this.mScale;case"scale_x":return this.mScale.x;case"scale_y":return this.mScale.y;case"scale_z":return this.mScale.z}return null}},{key:"getSceneObjectId",value:function(){return this.mSceneObjectId}},{key:"setSyncHash",value:function(e){this.mSyncHash=e}},{key:"getSyncHash",value:function(){return this.mSyncHash}},{key:"isInSyncWithHash",value:function(e){return this.mSyncHash===e}},{key:"getServerSyncTime",value:function(){return this.mServerSyncTime}},{key:"getRenderState",value:function(){return this.mRenderState}},{key:"getRenderObject",value:function(){return this.mRenderObject}},{key:"hasRenderObject",value:function(){return null!==this.mRenderObject}},{key:"setParent",value:function(e){this.mParentObject=e}},{key:"getParent",value:function(){return this.mParentObject}},{key:"getRootParent",value:function(){return null!==this.mParentObject?this.mParentObject.getRootParent():this}},{key:"findParentOfType",value:function(e){return this.findParentOfTypeName(e.getTypeName())}},{key:"findParentOfTypeName",value:function(e){for(var t=null,n=this.getParent();null!==n;){if(n.isDerivedOfTypeName(e)){t=n;break}n=n.getParent()}return t}},{key:"buildRenderObject",value:function(){var e=this;if(null!==this.mRenderObject&&!0!==this.mRenderObject.needsUpdate)return(0,r.of)(!0);if(null!==this.mLoadingProcess){var t=this.mLoadingProcess.getLastProcess();if(t.getStatus()===c.B.Working&&!t.isCancelled()&&t.isReusable())return t.observeSubject()}var n=this.createBuildProcess(),o=n.attach(this).pipe((0,i.B)());return null===this.mLoadingProcess?(this.mLoadingProcess=n,this.mLoadingProcess.execute()):this.mLoadingProcess.setNextProcess(n),o.subscribe((function(t){t&&(e._createOrResolveRenderObject(),e.mRenderObject.isAttached()||e.mRenderObject.attach(),e.mRenderObject.needsUpdate=!1,e.finalizeRenderObjectBuild()),e._shiftLoadingStack()}),(function(){e._shiftLoadingStack()})),o}},{key:"_shiftLoadingStack",value:function(){this.mLoadingProcess.detach(),null!==this.mLoadingProcess.getNextProcess()?(this.mLoadingProcess=this.mLoadingProcess.getNextProcess(),this.mLoadingProcess.execute()):this.mLoadingProcess=null}},{key:"killBuild",value:function(){if(null!==this.mLoadingProcess){var e=this.mLoadingProcess.getLastProcess();return this.mLoadingProcess.kill(),e.observeSubject()}return(0,r.of)(!0)}},{key:"dismissBuild",value:function(){if(null!==this.mLoadingProcess){var e=this.mLoadingProcess.getLastProcess();return this.mLoadingProcess.cancel(),e.observeSubject()}return(0,r.of)(!0)}},{key:"destroyRenderObject",value:function(){var e=this,t=this.killBuild();return t.subscribe((function(){e.deinitRenderObject(),e._detachRenderObject()}),(function(){e._detachRenderObject()})),t}},{key:"observeLastProcess",value:function(){return null!==this.mLoadingProcess?this.mLoadingProcess.getLastProcess().observeSubject():(0,o._)(new Error("No active process running"))}},{key:"_detachRenderObject",value:function(){if(null!==this.mRenderObject){if(this.mRenderObject.detach(),this.getGarbageTime()>=0){var e=null;if(this.mRenderObject.isDerivedOfTypeName("ThreedObject")?e=this.mRenderObject.get3DObject():this.mRenderObject.isDerivedOfTypeName("TwodObject")&&(e=this.mRenderObject.get2DObject()),null!==e){var t=this.mRenderObject;this.getRenderState().trashItem(this.getGarbageHash(),e,this.getGarbageTime(),(function(e){t.dispose()}))}}else this.mRenderObject.dispose();this.mRenderObject=null}}},{key:"_createOrResolveRenderObject",value:function(){return null===this.mRenderObject&&(this.mRenderObject=this.createRenderObject(),this.initRenderObject()),this.mRenderObject}},{key:"getGarbageHash",value:function(){return this.getType().getTypeName()}},{key:"getGarbageTime",value:function(){return-1}},{key:"createBuildProcess",value:function(){return new s.T}},{key:"initRenderObject",value:function(){return this.dispatchMessageToComponents(new d.H),!0}},{key:"finalizeRenderObjectBuild",value:function(){}},{key:"deinitRenderObject",value:function(){this.dispatchMessageToComponents(new h.y)}}])&&b(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),O}(a.L);O.TypeRTTI=new u.r("SceneObject",a.L.TypeRTTI)},64569:function(e,t,n){"use strict";n.d(t,{s:function(){return I}}),n(21249),n(57640),n(9924),n(54678),n(19601),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(47941),n(82526),n(57327),n(88449),n(2490),n(59849),n(15581),n(34514),n(54747),n(49337),n(33321),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(2168),o=n(90140),i=n(37526),a=n(41142),u=n(89539),c=(n(35666),n(88674),n(78456)),s=n(37852),l=n(84217);function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function p(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t){return h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},h(e,t)}function y(e,t){if(t&&("object"===f(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(f,e);var t,n,r,o,i,c,s=(i=f,c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=m(i);if(c){var n=m(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return y(this,e)});function f(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),s.call(this,"ProcessLoadConfigurable")}return t=f,n=[{key:"getType",value:function(){return f.TypeRTTI}},{key:"onAttached",value:function(){var e=this.getParent();(0,u.isFunction)(e._onConfigurableLoaded)||a.qL.error("Attached ProcessLoadConfigurable to node with no _onConfigurableLoaded function.")}},{key:"onExecute",value:(r=regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){if(t.isCancelled())e(!1);else{var r=t.getParent();r.findParentOfTypeName("ProductNode").onConfigurableNodeReady.pipe((0,l.q)(1)).subscribe((function(t){r._onConfigurableLoaded(t),e(!0)}),(function(e){a.qL.error("Failed to get configurable node in job: ",e),n(e)}))}})));case 1:case"end":return e.stop()}}),e)})),o=function(){var e=this,t=arguments;return new Promise((function(n,o){var i=r.apply(e,t);function a(e){p(i,n,o,a,u,"next",e)}function u(e){p(i,n,o,a,u,"throw",e)}a(void 0)}))},function(){return o.apply(this,arguments)})}],n&&d(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(c.o);v.TypeRTTI=new o.r("JobLoadConfigurable",s.e.TypeRTTI);var b=n(74379),g=n(17507),w=n(47746),_=n(43608);function O(e){return void 0===e&&(e=Number.POSITIVE_INFINITY),(0,w.zg)(_.y,e)}var T=n(43375),R=n(96169);function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){x(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function C(){return C="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=k(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},C.apply(this,arguments)}function k(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=A(e)););return e}function M(e,t){return M=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},M(e,t)}function D(e,t){if(t&&("object"===S(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function A(e){return A=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},A(e)}var I=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&M(e,t)}(s,e);var t,n,r,o,c=(r=s,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=A(r);if(o){var n=A(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return D(this,e)});function s(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(n=c.call(this,e,t)).mCacheLayers={},n.AOPlaneRTSize=256,n.mClipDistance=.05,n.mSamplingRadius=8,n.mPower=.5,n.mRebuildAO=!0,n.mVertexShader="\n    precision highp float;\n\n    varying float vDepth;\n\tvarying vec2 vUv;\n\tvarying vec3 vModelPosition;\n\n\tvoid main() {\n\t\tvec4 modelPosition = modelViewMatrix * vec4( position, 1.0 );\n\t\tvModelPosition = modelPosition.xyz;\n        vDepth =  -modelPosition.z;\n        vUv = uv;\n        gl_Position = projectionMatrix * modelPosition;\n\t}\n    ",n.mFragmentDepthShader="\n    #ifdef HIGHP_SUPPORTED\n        precision highp float;\n    #endif\n\n\t#include <packing>\n\tuniform float far;\n\n\tvarying float vDepth;\n\n\tvoid main (){\n\t\tgl_FragColor = packDepthToRGBA(vDepth/far);//save depth in part-components space\n\t}\n    ",n.mFragmentBlurShader="\n    #ifdef HIGHP_SUPPORTED\n        precision highp float;\n    #endif\n\n    uniform vec2 iResolution;\n    uniform vec2 direction;\n    uniform sampler2D tDiffuse;\n\n    varying vec2 vUv;\n\n    vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n        vec4 color = vec4(0.0);\n        vec2 off1 = vec2(1.3846153846) * direction;\n        vec2 off2 = vec2(3.2307692308) * direction;\n        color += texture2D(image, uv) * 0.2270270270;\n        color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;\n        color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;\n        color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;\n        color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;\n        return color;\n    }\n\n    void main() {\n        gl_FragColor = blur9(tDiffuse, vUv, iResolution.xy, direction);\n    }\n    ",n.mFragmentAO="\n    #ifdef HIGHP_SUPPORTED\n        precision highp float;\n    #endif\n\n    uniform sampler2D Sample0;\t// View space position data\n    uniform vec2 TexelSize;\n    uniform float SamplingRadius;\n    uniform float Power;\n    uniform float CameraFar;\n    uniform float CameraNear;\n    uniform vec2 RightTop;\n\n    varying vec3 vModelPosition;\n    varying vec2 vUv;\n\n    #include <packing>\n\n    vec3 reconstructPosition(vec2 uv){\n        vec2 ndc = uv*2.0 - vec2(1.0, 1.0);\n        vec4 sampleDepth = texture2D(Sample0, uv);\n        float modelDepth = unpackRGBAToDepth(sampleDepth);\n        vec2 pnear = ndc * RightTop;\n        float pz = -modelDepth*CameraFar;\n        return vec3(-pz*pnear.x / CameraNear, -pz*pnear.y / CameraNear, pz);\n    }\n\n\tfloat SamplePixels (vec3 srcPosition, vec2 uv)\n    {\n        vec3 dstPosition = reconstructPosition(uv);\n\n        vec3 positionVec = dstPosition - srcPosition;\n        float dist = length(positionVec);\n        float intensity = dist*dist*dist*dist;\n\t\tintensity = intensity*Power;\n\t\tintensity = exp(-(intensity));\n\n\t\treturn min(-dstPosition.z, intensity);\n    }\n\n    void main ()\n    {\n        float kernelRadius = SamplingRadius;\n\n        // Sample neighbouring pixels\n        vec2 kernel[4];\n        kernel[0] = vec2(0.0, 1.0);\t// top\n        kernel[1] = vec2(1.0, 0.0);\t// right\n        kernel[2] = vec2(0.0, -1.0);\t// bottom\n        kernel[3] = vec2(-1.0, 0.0);\t// left\n\n        const float Sin45 = 0.707107;\t// 45 degrees = sin(PI / 4)\n\n        float occlusion = 0.0;\n        for (int i = 0; i < 4; ++i)\n        {\n            vec2 k1 = kernel[i];\n            vec2 k2 = vec2(k1.x * Sin45 - k1.y * Sin45, k1.x * Sin45 + k1.y * Sin45);\n            k1 *= TexelSize;\n            k2 *= TexelSize;\n            occlusion += SamplePixels(vModelPosition, vUv + k1 * kernelRadius);\n            occlusion += SamplePixels(vModelPosition, vUv + k2 * kernelRadius * 0.75);\n            occlusion += SamplePixels(vModelPosition, vUv + k1 * kernelRadius * 0.5);\n            occlusion += SamplePixels(vModelPosition, vUv + k2 * kernelRadius * 0.25);\n        }\n\n        // Average and clamp ambient occlusion\n        occlusion /= 16.0;\n        occlusion = clamp(occlusion, 0.0, 1.0);\n\n        gl_FragColor = vec4(0.0, 0.0, 0.0, exp(occlusion) - 1.0);\n    }\n    ",n.onBeforeRender=function(e,t,r){!(0,u.isNullOrUndefined)(n.mConfigurableNode)&&n.mRebuildAO&&(t.traverse((function(e){n.mCacheLayers[e.id]=e.layers.mask,e.layers.set(0)})),n.renderPlaneDepth(e,t,r),n.renderAO(e,t,r),n.renderBlur(e,t,r),n.mPlaneMaterial.map=n.mRT2.texture,n.mPlaneMaterial.needsUpdate=!0)},n.onAfterRender=function(e,t){!(0,u.isNullOrUndefined)(n.mConfigurableNode)&&n.mRebuildAO&&(t.traverse((function(e){e.layers.mask=n.mCacheLayers[e.id]})),n.mRebuildAO=!1)},n}return t=s,n=[{key:"getType",value:function(){return s.TypeRTTI}},{key:"setValue",value:function(e,t){switch(e){case"clip_distance":return this.mClipDistance=parseFloat(t),this.mRebuildAO=!0,!0;case"sampling_radius":return this.mSamplingRadius=parseFloat(t),this.mRebuildAO=!0,!0;case"power":return this.mPower=parseFloat(t),this.mRebuildAO=!0,!0}return C(A(s.prototype),"setValue",this).call(this,e,t)}},{key:"getValue",value:function(e){var t=C(A(s.prototype),"getValue",this).call(this,e);if(null!==t)return t;switch(e){case"clip_distance":return this.mClipDistance;case"sampling_radius":return this.mSamplingRadius;case"power":return this.mPower}return null}},{key:"calculatePower",value:function(){return 1/Math.exp(9*(1-(1-this.mPower)))}},{key:"fitCameraToObject",value:function(){var e=new THREE.Box3;e.setFromObject(this.mConfigurableNode.getRenderObject().get3DObject());var t=new THREE.Vector3;e.getCenter(t);var n=new THREE.Vector3(e.max.x-e.min.x,e.max.y-e.min.y,e.max.z-e.min.z),r=(n.x>n.z?n.x:n.z)/2/Math.tan(45*Math.PI/360);this.mPersCamera.position.set(t.x,t.y-1*(r+n.y),t.z),this.mPersCamera.far=Math.abs(this.mPersCamera.position.y-e.min.y)*(1+this.mClipDistance),this.mPersCamera.fov=45,this.mPersCamera.lookAt(t),this.mPersCamera.updateProjectionMatrix();var o=2*Math.tan(Math.PI/180*45/2)*this.mPersCamera.near,i=2*Math.tan(Math.PI/180*45/2)*this.mPersCamera.far,a=new THREE.Vector3(t.x,e.min.y-.001,t.z),u=(i-o)*((this.mPersCamera.position.distanceTo(a)-this.mPersCamera.near)/(this.mPersCamera.far-this.mPersCamera.near));this.updatePlaneGeometry(a,u)}},{key:"updatePlaneGeometry",value:function(e,t){this.mPlaneSize!==t&&((0,u.isNullOrUndefined)(this.mPlane.geometry)||this.mPlane.geometry.dispose(),this.mPlaneSize=t,this.mPlane.geometry=new THREE.PlaneGeometry(t,t,1,1)),this.mPlane.position.copy(e),this.mPlane.rotation.set(1.57,0,0)}},{key:"renderPlaneDepth",value:function(e,t,n){this.mPlane.visible=!1,this.fitCameraToObject(),this.mDepthShader.uniforms.far.value=this.mPersCamera.far,this.mDepthShader.needsUpdate=!0;var r=t.overrideMaterial,o=t.background,i=e.getRenderTarget();t.overrideMaterial=this.mDepthShader,t.background=null;var a=e.getClearColor(),u=e.getClearAlpha();e.setRenderTarget(this.mRT1),e.setClearColor(0,0),e.clear(),e.render(t,this.mPersCamera),this.mPlane.visible=!0,t.overrideMaterial=r,t.background=o,e.setRenderTarget(i),e.setClearColor(a,u)}},{key:"renderAO",value:function(e,t,n){var r=this.mPersCamera.far,o=this.mPersCamera.near,i=this.mPersCamera.fov,a=this.mPersCamera.aspect,u=Math.tan(i*(Math.PI/180)/2)*o,c=u*a,s=new THREE.Vector2(c,u);this.mAOPlaneShader.uniforms.RightTop.value.copy(s),this.mAOPlaneShader.uniforms.SamplingRadius.value=this.mSamplingRadius,this.mAOPlaneShader.uniforms.Power.value=this.calculatePower(),this.mAOPlaneShader.uniforms.CameraFar.value=r,this.mAOPlaneShader.uniforms.CameraNear.value=o,this.mAOPlaneShader.uniforms.Sample0.value=this.mRT1.texture,this.mAOPlaneShader.uniforms.TexelSize.value.copy(new THREE.Vector2(1/this.AOPlaneRTSize,1/this.AOPlaneRTSize)),this.mAOPlaneShader.needsUpdate=!0,this.mScreenQuad.material=this.mAOPlaneShader;var l=e.getRenderTarget(),f=e.getClearColor(),p=e.getClearAlpha();e.setRenderTarget(this.mRT2),e.setClearColor(0,0),e.clear(),e.render(this.mScreenScene,this.mOrthoCamera),e.setRenderTarget(l),e.setClearColor(f,p)}},{key:"renderBlur",value:function(e,t,n){this.mBlurShader.uniforms.direction.value.set(1,0),this.mBlurShader.uniforms.tDiffuse.value=this.mRT2.texture,this.mBlurShader.needsUpdate=!0,this.mScreenQuad.material=this.mBlurShader;var r=e.getRenderTarget(),o=e.getClearColor(),i=e.getClearAlpha();e.setRenderTarget(this.mRT1),e.setClearColor(0,0),e.clear(),e.render(this.mScreenScene,this.mOrthoCamera),this.mBlurShader.uniforms.direction.value.set(0,1),this.mBlurShader.uniforms.tDiffuse.value=this.mRT1.texture,this.mBlurShader.needsUpdate=!0,e.setRenderTarget(this.mRT2),e.clear(),e.render(this.mScreenScene,this.mOrthoCamera),e.setRenderTarget(r),e.setClearColor(o,i)}},{key:"_onConfigurableLoaded",value:function(e){this.mConfigurableNode=e}},{key:"buildRenderObject",value:function(){return a.qL.print("AO Rebuild"),this.mRebuildAO=!0,C(A(s.prototype),"buildRenderObject",this).call(this)}},{key:"createBuildProcess",value:function(){return new v}},{key:"createRenderObject",value:function(){var e=this,t=this.getRenderState().getSceneManager().getApplication(),n={};if(!(0,u.isNullOrUndefined)(t)){var r=t.getRenderer().getContext();r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.HIGH_FLOAT).precision>0&&(n={HIGHP_SUPPORTED:!0})}return this.mRT1=new THREE.WebGLRenderTarget(this.AOPlaneRTSize,this.AOPlaneRTSize,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat}),this.mRT2=new THREE.WebGLRenderTarget(this.AOPlaneRTSize,this.AOPlaneRTSize,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat}),this.mDepthShader=new THREE.ShaderMaterial({uniforms:{far:{value:2}},defines:P({},n),vertexShader:this.mVertexShader,fragmentShader:this.mFragmentDepthShader}),this.mDepthShader.side=THREE.DoubleSide,this.mPersCamera=new THREE.PerspectiveCamera(45,1,.01,1e4),this.mOrthoCamera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),this.mScreenScene=new THREE.Scene,this.mBlurShader=new THREE.ShaderMaterial({uniforms:{iResolution:{value:new THREE.Vector2(this.AOPlaneRTSize,this.AOPlaneRTSize)},direction:{value:new THREE.Vector2(1,0)},tDiffuse:{value:null}},defines:P({},n),vertexShader:this.mVertexShader,fragmentShader:this.mFragmentBlurShader}),this.mAOPlaneShader=new THREE.ShaderMaterial({uniforms:{TexelSize:{value:new THREE.Vector2(1/this.AOPlaneRTSize,1/this.AOPlaneRTSize)},RightTop:{value:new THREE.Vector2(1,1)},SamplingRadius:{value:this.mSamplingRadius},Power:{value:this.calculatePower()},CameraFar:{value:1e3},CameraNear:{value:.01},Sample0:{value:null}},defines:P({},n),vertexShader:this.mVertexShader,fragmentShader:this.mFragmentAO}),this.mScreenQuad=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2)),this.mScreenQuad.frustumCulled=!1,this.mScreenScene.add(this.mScreenQuad),this.mPlaneMaterial=new THREE.MeshBasicMaterial({color:16777215,side:THREE.BackSide}),this.mPlaneMaterial.transparent=!0,this.mPlane=new THREE.Mesh,this.mPlane.onBeforeRender=this.onBeforeRender,this.mPlane.onAfterRender=this.onAfterRender,this.mPlane.material=this.mPlaneMaterial,this.updatePlaneGeometry(this.mConfigurableNode.getValue("position"),10),(0,u.isNullOrUndefined)(t)||(this.mEventSubscription=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Number.POSITIVE_INFINITY,r=null,o=e[e.length-1];return(0,g.K)(o)?(r=e.pop(),e.length>1&&"number"==typeof e[e.length-1]&&(n=e.pop())):"number"==typeof o&&(n=e.pop()),null===r&&1===e.length&&e[0]instanceof b.y?e[0]:O(n)((0,T.n)(e,r))}(t.observeEvents(R.Gw.BuildFinished),t.observeEvents(R.Gw.BuildUpdated)).subscribe((function(){e.mRebuildAO=!0,setTimeout((function(){e.getRenderState().requestFrame(),setTimeout((function(){return e.getRenderState().requestFrame()}),100)}),0)}))),new i.m(this.mPlane,this)}},{key:"disposeProperty",value:function(e){e&&e.dispose()}},{key:"deinitRenderObject",value:function(){this.disposeProperty(this.mRT1),this.disposeProperty(this.mRT2),this.disposeProperty(this.mPlaneMaterial),this.disposeProperty(this.mBlurShader),this.disposeProperty(this.mAOPlaneShader),this.disposeProperty(this.mDepthShader),this.disposeProperty(this.mPlaneMaterial),this.mScreenQuad&&this.disposeProperty(this.mScreenQuad.geometry),this.mPlane&&this.disposeProperty(this.mPlane.geometry),this.disposeProperty(this.mScreenScene),(0,u.isNullOrUndefined)(this.mEventSubscription)||(this.mEventSubscription.unsubscribe(),delete this.mEventSubscription),C(A(s.prototype),"deinitRenderObject",this).call(this)}},{key:"serialize",value:function(e){var t=Object.assign(C(A(s.prototype),"serialize",this).call(this,e),{type:"ao_plane"});return t.properties=Object.assign(t.properties,{clip_distance:this.mClipDistance,sampling_radius:this.mSamplingRadius,power:this.mPower}),t}}],n&&j(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),s}(r.o);I.TypeRTTI=new o.r("ShaderEntityAoPlane",r.o.TypeRTTI)},75736:function(e,t,n){"use strict";n.d(t,{x:function(){return h}}),n(19601),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(2168),o=n(90140),i=n(37526),a=n(35572);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(){return s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=l(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},s.apply(this,arguments)}function l(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}function f(e,t){return f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},f(e,t)}function p(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(l,e);var t,n,r,o,u=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=d(r);if(o){var n=d(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return p(this,e)});function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=u.call(this,e,t)).mFireMesh=null,n.mCameraHeight=null,n.mCameraFOV=null,n.mClock=null,n.onBeforeRender=function(e){var t=new THREE.Vector2;e.renderer.getSize(t),!n.hasRenderObject()||n.mCameraHeight==t.y&&n.mCameraFOV==e.camera.fov||(n.mCameraHeight=t.y,n.mCameraFOV=e.camera.fov,n.mFireMesh.material.setPerspective(n.mCameraFOV,n.mCameraHeight)),null!==!n.mFireMesh&&n.mFireMesh.material.update(n.mClock.getDelta())},n}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}},{key:"createRenderObject",value:function(){var e=new particleFire.Geometry(.5,3,300),t=new particleFire.Material({color:16720384});return this.mFireMesh=new THREE.Points(e,t),this.mFireMesh.position.copy(this.mPosition),this.mFireMesh.rotation.copy(this.mRotation),this.mFireMesh.scale.copy(this.mScale),this.mClock=new THREE.Clock,this.registerMessageHandler(a.V.TypeRTTI,this.onBeforeRender),new i.m(this.mFireMesh,this)}},{key:"deinitRenderObject",value:function(){this.hasRenderObject()&&this.unregisterMessageHandler(a.V.TypeRTTI),null!==this.mFireMesh&&(this.mFireMesh.material.dispose(),this.mFireMesh=null),this.mCameraHeight=null,this.mCameraFOV=null,this.mClock=null,s(d(l.prototype),"deinitRenderObject",this).call(this)}},{key:"serialize",value:function(e){return Object.assign(s(d(l.prototype),"serialize",this).call(this,e),{type:"fire"})}}])&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r.o);h.TypeRTTI=new o.r("ShaderEntityFire",r.o.TypeRTTI)},57348:function(e,t,n){"use strict";n.d(t,{I:function(){return y}}),n(60086),n(68309),n(41539),n(15581),n(2490),n(34514),n(54747),n(19601),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(2168),o=n(90140),i=n(37526),a=n(35572),u=n(27263);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(){return l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=f(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},l.apply(this,arguments)}function f(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}function p(e,t){return p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},p(e,t)}function d(e,t){if(t&&("object"===c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(f,e);var t,n,r,o,c=(r=f,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(r);if(o){var n=h(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return d(this,e)});function f(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(n=c.call(this,e,t)).mFlareTexture=null,n.mMaterial=null,n.mFlareGeometry=null,n.mFlarePlane=null,n.mRayCaster=new THREE.Raycaster,n.mAlpha=1,n.mAngle=1,n.onBeforeRender=function(e){n.hasRenderObject()&&n.getRenderObject().isAttached()&&n._updateFlare(e.renderer,e.camera,e.scene)},n}return t=f,(n=[{key:"getType",value:function(){return f.TypeRTTI}},{key:"_updateFlare",value:function(e,t,n){var r=this.mFlarePlane.matrixWorld.clone(),o=new THREE.Vector3,i=new THREE.Vector3,a=new THREE.Quaternion;r.decompose(o,a,i);var u=new THREE.Vector3;u.applyMatrix4(r);var c=new THREE.Vector3(0,0,1);c.applyQuaternion(a).normalize();var s=t.position.clone(),l=s.clone().sub(u).clone().normalize(),f=c.dot(l),p=f<0?0:f;p=(p=this.mAngle-Math.pow(-.59*(1-Math.exp(1-p)),4)-(1-this.mAlpha))<0?0:p;var d=u.clone().sub(s);if(this.mRayCaster.set(s.clone(),d.clone().normalize()),this.mRayCaster.far=d.length()-1e-4,this.mRayCaster.intersectObjects(n.children,!0).length>0)this.mMaterial.opacity=0;else{var h=(new THREE.Matrix4).makeRotationFromQuaternion(this.mFlarePlane.quaternion),y=((new THREE.Matrix4).getInverse(h),new THREE.Vector3(0,1,0));(new THREE.Matrix4).lookAt(u,s.clone(),y);var m=2*p;m=m>1?1:m,(new THREE.Matrix4).makeScale(m,m,m);var v=.5*this.mVertices.length;p=(p-=0/(v=v<1?1:v))<0?0:p,this.mMaterial.opacity=p,this.mFlareGeometry.verticesNeedUpdate=!0,this.mFlareGeometry.computeFaceNormals()}}},{key:"createRenderObject",value:function(){var e=this;return this.registerMessageHandler(a.V.TypeRTTI,this.onBeforeRender),this.mMaterial=new THREE.MeshBasicMaterial({map:this.mFlareTexture,side:THREE.DoubleSide,blending:THREE.AdditiveBlending,depthTest:!1,depthFunc:THREE.LessDepth,depthWrite:!1,transparent:!0,color:16777215,opacity:.9}),this.mMaterial.needsUpdate=!0,this.mFlareGeometry=new THREE.PlaneGeometry(4,1,8),this.mFlarePlane=new THREE.Mesh(this.mFlareGeometry,this.mMaterial),this.mFlarePlane.name=this.getValue("name"),this.mFlarePlane.castShadow=!1,this.mFlarePlane.receiveShadow=!1,this.mFlarePlane.position.copy(this.mPosition),this.mFlarePlane.rotation.copy(this.mRotation),this.mFlarePlane.scale.copy(this.mScale),this.mVertices=new Array,this.mFlareGeometry.vertices.forEach((function(t){e.mVertices.push(t.clone())})),console.log("created flare geometry: ",this.mFlareGeometry),new i.m(this.mFlarePlane,this)}},{key:"createBuildProcess",value:function(){return new u.y("assets/system/textures/flare-strip.png")}},{key:"_onTextureLoaded",value:function(e,t){this.mFlareTexture=t,this.mFlareTexture.needsUpdate=!0}},{key:"deinitRenderObject",value:function(){null!==this.mFlareTexture&&(this.mFlareTexture.dispose(),this.mFlareTexture=null),null!==this.mMaterial&&(this.mMaterial.dispose(),this.mMaterial=null),this.hasRenderObject()&&this.unregisterMessageHandler(a.V.TypeRTTI),this.mFlareGeometry=null,this.mFlarePlane=null,l(h(f.prototype),"deinitRenderObject",this).call(this)}},{key:"serialize",value:function(e){return Object.assign(l(h(f.prototype),"serialize",this).call(this,e),{type:"flare"})}}])&&s(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(r.o);y.TypeRTTI=new o.r("ShaderEntityFlare",r.o.TypeRTTI)},48709:function(e,t,n){"use strict";n.d(t,{q:function(){return y}}),n(91058),n(54678),n(68309),n(40561),n(60086),n(85827),n(41539),n(25387),n(2490),n(72608),n(47941),n(66992),n(44197),n(48675),n(92990),n(18927),n(33105),n(35035),n(74345),n(7174),n(32846),n(44731),n(77209),n(96319),n(58867),n(37789),n(33739),n(29368),n(14483),n(12056),n(3462),n(30678),n(27462),n(33824),n(55021),n(12974),n(15016),n(8922),n(37380),n(1118),n(5835),n(23767),n(8585),n(8970),n(84444),n(68696),n(29135),n(57327),n(88449),n(59849),n(19601),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(78783),n(33948);var r=n(2168),o=n(90140),i=n(37526),a=n(35572),u=n(89539);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(){return l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=f(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},l.apply(this,arguments)}function f(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}function p(e,t){return p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},p(e,t)}function d(e,t){if(t&&("object"===c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(f,e);var t,n,r,o,c=(r=f,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(r);if(o){var n=h(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return d(this,e)});function f(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(n=c.call(this,e,t)).mPoints=new Array,n.mHasVertices=!1,n.mRayCaster=new THREE.Raycaster,n.mEdgesRebuild=!1,n.mHitObjects={},n.mCurrentOcclusionFrame=0,n.mEdges=4,n.mSize=1,n.mBlur=2,n.mExtension=0,n.mColor="#ffffff",n.mFlare="#ffffff",n.mAlpha=1,n.mAngle=1,n.onBeforeRender=function(e){n.hasRenderObject()&&n.getRenderObject().isAttached()&&(n.mEdgesRebuild&&n._buildEdges(n.mEdges,!0),n._updateGlare(e.renderer,e.camera,e.scene))},n}return t=f,n=[{key:"getType",value:function(){return f.TypeRTTI}},{key:"setValue",value:function(e,t){switch(e){case"edges":return this.mEdges=parseInt(t,10),this.mEdgesRebuild=!0,!0;case"size":return this.mSize=parseFloat(t),this.mEdgesRebuild=!0,!0;case"blur":return this.mBlur=parseFloat(t),!0;case"extension":return this.mExtension=parseFloat(t),!0;case"alpha":return this.mAlpha=parseFloat(t),!0;case"angle":return this.mAngle=parseFloat(t),!0;case"color":return(0,u.isUndefined)(t.isColor)?this.mColor=t:this.mColor="#"+t.getHexString(),!0;case"flare":return(0,u.isUndefined)(t.isColor)?this.mFlare=t:this.mFlare="#"+t.getHexString(),!0}return l(h(f.prototype),"setValue",this).call(this,e,t)}},{key:"getValue",value:function(e){var t=l(h(f.prototype),"getValue",this).call(this,e);if(null!==t)return t;switch(e){case"edges":return this.mEdges;case"size":return this.mSize;case"blur":return this.mBlur;case"extension":return this.mExtension;case"alpha":return this.mAlpha;case"angle":return this.mAngle;case"color":return new THREE.Color(this.mColor);case"flare":return new THREE.Color(this.mFlare)}return null}},{key:"createRenderObject",value:function(){return this.mMesh=new THREE.Mesh(new THREE.BufferGeometry,this._createMaterial()),this.mMesh.name=this.mName,this.mMesh.position.copy(this.mPosition),this.mMesh.rotation.copy(this.mRotation),this.mMesh.scale.copy(this.mScale),this._buildEdges(this.mEdges,!0),this.registerMessageHandler(a.V.TypeRTTI,this.onBeforeRender),new i.m(this.mMesh,this)}},{key:"_buildEdges",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t||this.mEdges!==e){this.mEdges=e,this.mPoints.splice(0,this.mPoints.length);for(var n=360/this.mEdges*.0174533,r=0;r<this.mEdges;r++){var o=new THREE.Matrix4;o.makeRotationZ(n*-r);var i=new THREE.Vector3(0,this.mSize,0);i.applyMatrix4(o),this.mPoints.push({v:new THREE.Vector3(i.x,0,i.y)})}this.mHitObjects={},this.mHasVertices=!1,this.mEdgesRebuild=!1}}},{key:"_updateGlare",value:function(e,t,n){for(var r=this,o=this.mMesh.matrixWorld.clone(),i=(new THREE.Matrix4).getInverse(o),a=t.projectionMatrix.clone().multiply(t.matrixWorldInverse.clone()),u=(new THREE.Matrix4).getInverse(a.clone()),c=0;c<this.mPoints.length;c++){var s=this.mPoints[c].v.clone();s.applyMatrix4(o);var l=s.clone(),f=new THREE.Vector4(l.x,l.y,l.z,1).applyMatrix4(a);f.multiplyScalar(1/f.w),this.mPoints[c].wp0=s,this.mPoints[c].sp=new THREE.Vector3(f.x,f.y,f.z)}for(var p=this.mBlur,d=0;d<this.mPoints.length;d++){var h=(d+1)%this.mPoints.length,y=this.mPoints[d].sp.clone(),m=this.mPoints[h].sp.clone(),v=y.clone().sub(m),b=new THREE.Vector3(-v.y,v.x,0);b.normalize(),y.addScaledVector(b,40),m.addScaledVector(b,40);var g=y.clone().applyMatrix4(u),w=m.clone().applyMatrix4(u);g.applyMatrix4(i),w.applyMatrix4(i);var _=g.sub(this.mPoints[d].v).normalize(),O=w.sub(this.mPoints[h].v).normalize();this.mPoints[d].wp1=this.mPoints[d].v.clone().addScaledVector(_,p),this.mPoints[d].wp2=this.mPoints[h].v.clone().addScaledVector(O,p)}var T=[],R=[],S=[],E=new THREE.Vector3,P=new THREE.Vector3,x=new THREE.Quaternion;o.decompose(E,x,P);var j=new THREE.Vector3;j.applyMatrix4(o);var C=new THREE.Vector3(0,1,0);C.applyQuaternion(x).normalize();var k=t.position.clone().clone().sub(j).clone().normalize(),M=C.dot(k),D=M<0?0:M;D=this.mAngle-Math.pow(-.59*(1-Math.exp(1-D)),4)-(1-this.mAlpha),D=(D-=Object.keys(this.mHitObjects).reduce((function(e,t){return e+(r.mHitObjects[t]?1:0)}),0)/this.mPoints.length)<0?0:D;for(var A=this.getValue("color"),I=this.getValue("flare"),N=0;N<this.mPoints.length;N++){var V=(N+1)%this.mPoints.length;T.push(this.mPoints[N].v.x,this.mPoints[N].v.y,this.mPoints[N].v.z),R.push(A.r,A.g,A.b,D),T.push(this.mPoints[N].wp1.x,this.mPoints[N].wp1.y,this.mPoints[N].wp1.z),R.push(I.r,I.g,I.b,0),T.push(this.mPoints[N].wp2.x,this.mPoints[N].wp2.y,this.mPoints[N].wp2.z),R.push(I.r,I.g,I.b,0),T.push(this.mPoints[V].v.x,this.mPoints[V].v.y,this.mPoints[V].v.z),R.push(A.r,A.g,A.b,D);var U=this.mPoints[N].wp2.clone().addScaledVector(this.mPoints[V].wp1.clone().sub(this.mPoints[N].wp2),.5).sub(this.mPoints[V].v).normalize(),F=this.mPoints[V].v.clone().addScaledVector(U,p+this.mExtension);T.push(this.mPoints[V].v.x,this.mPoints[V].v.y,this.mPoints[V].v.z),R.push(A.r,A.g,A.b,D),T.push(this.mPoints[N].wp2.x,this.mPoints[N].wp2.y,this.mPoints[N].wp2.z),R.push(I.r,I.g,I.b,0),T.push(F.x,F.y,F.z),R.push(I.r,I.g,I.b,0),T.push(this.mPoints[V].wp1.x,this.mPoints[V].wp1.y,this.mPoints[V].wp1.z),R.push(I.r,I.g,I.b,0)}for(var B=this.mPoints[0].v.clone(),L=1;L<this.mPoints.length;L++)B.add(this.mPoints[L].v);B.multiplyScalar(1/this.mPoints.length);for(var H=0;H<this.mPoints.length;H++){var z=H,q=(H+1)%this.mPoints.length;T.push(B.x,B.y,B.z),R.push(A.r,A.g,A.b,D),T.push(this.mPoints[z].v.x,this.mPoints[z].v.y,this.mPoints[z].v.z),R.push(A.r,A.g,A.b,D),T.push(this.mPoints[q].v.x,this.mPoints[q].v.y,this.mPoints[q].v.z),R.push(A.r,A.g,A.b,D),T.push(B.x,B.y,B.z),R.push(A.r,A.g,A.b,D)}for(var G=T.length/3,W=!1,Q=0;Q<G;)W?(S.push(Q,Q-1,Q-3),Q+=1):(S.push(Q,(Q+2)%G,(Q+1)%G),Q+=3),W=!W;if(this.mHasVertices){for(var K=0;K<this.mVertices.length;K++)this.mVertices[K]=T[K];for(var Y=0;Y<this.mColors.length;Y++)this.mColors[Y]=R[Y];this.mBuffer.getAttribute("position").needsUpdate=!0,this.mBuffer.getAttribute("customColor").needsUpdate=!0}else{this.mVertices=new Float32Array(T),this.mColors=new Float32Array(R);var Z=new Uint32Array(S);this.mBuffer=new THREE.BufferGeometry,this.mBuffer.setIndex(new THREE.BufferAttribute(Z,1)),this.mBuffer.addAttribute("position",new THREE.BufferAttribute(this.mVertices,3)),this.mBuffer.addAttribute("customColor",new THREE.BufferAttribute(this.mColors,4)),this.mMesh.geometry.dispose(),this.mMesh.geometry=this.mBuffer,this.mHasVertices=!0}}},{key:"_createMaterial",value:function(){return new THREE.ShaderMaterial({vertexShader:"\n            attribute vec4 customColor;\n            varying vec4 vColor;\n            void main() {\n                vColor = customColor;\n                gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n            }\n        ",fragmentShader:"\n            varying vec4 vColor;\n            void main() {\n                vec4 nlColor = vColor;\n                nlColor.a = pow(((1.0-exp(nlColor.a))*-1.0),2.0);\n                gl_FragColor = nlColor;\n            }\n        ",blending:THREE.CustomBlending,blendEquation:THREE.AddEquation,blendSrc:THREE.SrcAlphaFactor,blendDst:THREE.DstAlphaFactor,depthTest:!0,depthFunc:THREE.LessDepth,depthWrite:!1,transparent:!0,lights:!1,side:THREE.DoubleSide,wireframe:!1})}},{key:"deinitRenderObject",value:function(){var e=this;this.mMesh.material.dispose(),this.mMesh=null,this.mVertices=null,this.mColors=null,this.mBuffer=null,this.mHasVertices=!1,this.hasRenderObject()&&this.unregisterMessageHandler(a.V.TypeRTTI),f.GlareRayTracingTasksQueue=f.GlareRayTracingTasksQueue.filter((function(t){return t!==e.getObjectId()})),l(h(f.prototype),"deinitRenderObject",this).call(this)}},{key:"serialize",value:function(e){var t=Object.assign(l(h(f.prototype),"serialize",this).call(this,e),{type:"glare"});return t.properties=Object.assign(t.properties,{edges:this.mEdges,size:this.mSize,blur:this.mBlur,extension:this.mExtension,alpha:this.mAlpha,angle:this.mAngle,color:"#"+new THREE.Color(this.mColor).getHexString(),flare:"#"+new THREE.Color(this.mFlare).getHexString()}),t}}],n&&s(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(r.o);y.GlareRayTracingTasksQueue=new Array,y.GlareRayTracingFrameDelay=5,y.GlareOcclusionDelayCount=0,y.TypeRTTI=new o.r("ShaderEntityGlare",r.o.TypeRTTI)},8614:function(e,t,n){"use strict";n.d(t,{h:function(){return y}}),n(91058),n(19601),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(2168),o=n(90140),i=n(37526),a=n(89539),u=n(20051);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(){return l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=f(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},l.apply(this,arguments)}function f(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}function p(e,t){return p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},p(e,t)}function d(e,t){if(t&&("object"===c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(f,e);var t,n,r,o,c=(r=f,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(r);if(o){var n=h(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return d(this,e)});function f(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(n=c.call(this,e,t)).mTextureCube=null,n.mCubeMaterial=null,n.mTextureIds=[null,null,null,null,null,null],n.mActiveTextures=[null,null,null,null,null,null],n}return t=f,(n=[{key:"getType",value:function(){return f.TypeRTTI}},{key:"setValue",value:function(e,t){switch(e){case"skycube_tex_0":return this.mTextureIds[0]=(0,a.isNullOrUndefined)(t)?null:parseInt(t,10),this.updateTextures(),!0;case"skycube_tex_1":return this.mTextureIds[1]=(0,a.isNullOrUndefined)(t)?null:parseInt(t,10),this.updateTextures(),!0;case"skycube_tex_2":return this.mTextureIds[2]=(0,a.isNullOrUndefined)(t)?null:parseInt(t,10),this.updateTextures(),!0;case"skycube_tex_3":return this.mTextureIds[3]=(0,a.isNullOrUndefined)(t)?null:parseInt(t,10),this.updateTextures(),!0;case"skycube_tex_4":return this.mTextureIds[4]=(0,a.isNullOrUndefined)(t)?null:parseInt(t,10),this.updateTextures(),!0;case"skycube_tex_5":return this.mTextureIds[5]=(0,a.isNullOrUndefined)(t)?null:parseInt(t,10),this.updateTextures(),!0}return l(h(f.prototype),"setValue",this).call(this,e,t)}},{key:"getValue",value:function(e){var t=l(h(f.prototype),"getValue",this).call(this,e);if(null!==t)return t;switch(e){case"skycube_tex_0":return this.mTextureIds[0];case"skycube_tex_1":return this.mTextureIds[1];case"skycube_tex_2":return this.mTextureIds[2];case"skycube_tex_3":return this.mTextureIds[3];case"skycube_tex_4":return this.mTextureIds[4];case"skycube_tex_5":return this.mTextureIds[5]}return null}},{key:"getTextureIds",value:function(){return this.mTextureIds}},{key:"getActiveTextures",value:function(){return this.mActiveTextures}},{key:"setActiveTextureId",value:function(e,t){this.mActiveTextures[e]=t}},{key:"updateTextures",value:function(){this.hasRenderObject()&&(this.getRenderObject().needsUpdate=!0,this.buildRenderObject())}},{key:"createBuildProcess",value:function(){return new u.p}},{key:"createRenderObject",value:function(){console.log("create skybox");var e=THREE.ShaderLib.cube;this.mCubeMaterial=new THREE.ShaderMaterial({fragmentShader:e.fragmentShader,vertexShader:e.vertexShader,uniforms:e.uniforms,depthWrite:!1,side:THREE.BackSide}),this.mCubeMaterial.uniforms.tCube.value=this.mTextureCube;var t=new THREE.Mesh(new THREE.BoxGeometry(500,500,500),this.mCubeMaterial);return t.position.copy(this.mPosition),t.rotation.copy(this.mRotation),t.scale.copy(this.mScale),new i.m(t,this)}},{key:"_updateMaterial",value:function(){null!==this.mCubeMaterial&&(this.mCubeMaterial.needsUpdate=!0)}},{key:"_setTextureCubeImage",value:function(e,t){this.mTextureCube.images[e]=t,this.mTextureCube.needsUpdate=!0}},{key:"_createTextureCube",value:function(){null===this.mTextureCube&&(this.mTextureCube=new THREE.CubeTexture)}},{key:"deinitRenderObject",value:function(){console.warn("deinit of skybox!!"),null!==this.mCubeMaterial&&(this.mCubeMaterial.dispose(),this.mCubeMaterial=null),null!==this.mTextureCube&&(this.mTextureCube.dispose(),this.mTextureCube=null),this.mActiveTextures=[null,null,null,null,null,null],l(h(f.prototype),"deinitRenderObject",this).call(this)}},{key:"serialize",value:function(e){var t=Object.assign(l(h(f.prototype),"serialize",this).call(this,e),{type:"skycube"});return t.properties=Object.assign(t.properties,{skycube_tex_0:this.mTextureIds[0],skycube_tex_1:this.mTextureIds[1],skycube_tex_2:this.mTextureIds[2],skycube_tex_3:this.mTextureIds[3],skycube_tex_4:this.mTextureIds[4],skycube_tex_5:this.mTextureIds[5]}),t}}])&&s(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(r.o);y.TypeRTTI=new o.r("ShaderEntitySkyCube",r.o.TypeRTTI)},87974:function(e,t,n){"use strict";n.d(t,{h:function(){return y}}),n(91058),n(19601),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(2168),o=n(90140),i=n(37526),a=n(89539),u=n(20051);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(){return l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=f(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},l.apply(this,arguments)}function f(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}function p(e,t){return p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},p(e,t)}function d(e,t){if(t&&("object"===c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(f,e);var t,n,r,o,c=(r=f,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(r);if(o){var n=h(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return d(this,e)});function f(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(n=c.call(this,e,t)).mTextureEquirect=null,n.mEquirectMaterial=null,n.mTextureIds=[null],n.mActiveTextures=[null],n}return t=f,(n=[{key:"getType",value:function(){return f.TypeRTTI}},{key:"setValue",value:function(e,t){return"skycube_tex_0"===e?(this.mTextureIds[0]=(0,a.isNullOrUndefined)(t)?null:parseInt(t,10),this.updateTextures(),!0):l(h(f.prototype),"setValue",this).call(this,e,t)}},{key:"getValue",value:function(e){var t=l(h(f.prototype),"getValue",this).call(this,e);return null!==t?t:"skycube_tex_0"===e?this.mTextureIds[0]:null}},{key:"getTextureIds",value:function(){return this.mTextureIds}},{key:"getActiveTextures",value:function(){return this.mActiveTextures}},{key:"setActiveTextureId",value:function(e,t){this.mActiveTextures[e]=t}},{key:"updateTextures",value:function(){this.hasRenderObject()&&(this.getRenderObject().needsUpdate=!0,this.buildRenderObject())}},{key:"createBuildProcess",value:function(){return new u.p(1)}},{key:"createRenderObject",value:function(){console.log("create skybox equirect");var e=THREE.ShaderLib.equirect;this.mEquirectMaterial=new THREE.ShaderMaterial({fragmentShader:e.fragmentShader,vertexShader:e.vertexShader,uniforms:e.uniforms,depthWrite:!1,side:THREE.BackSide}),this.mEquirectMaterial.uniforms.tEquirect.value=this.mTextureEquirect;var t=new THREE.Mesh(new THREE.BoxGeometry(500,500,500),this.mEquirectMaterial);return t.position.copy(this.mPosition),t.rotation.copy(this.mRotation),t.scale.copy(this.mScale),new i.m(t,this)}},{key:"_updateMaterial",value:function(){null!==this.mEquirectMaterial&&(this.mEquirectMaterial.needsUpdate=!0)}},{key:"_setTextureCubeImage",value:function(e,t){this.mTextureEquirect.image=t,this.mTextureEquirect.needsUpdate=!0}},{key:"_createTextureCube",value:function(){null===this.mTextureEquirect&&(this.mTextureEquirect=new THREE.Texture,this.mTextureEquirect.mapping=THREE.EquirectangularReflectionMapping,this.mTextureEquirect.magFilter=THREE.LinearFilter,this.mTextureEquirect.minFilter=THREE.LinearMipMapLinearFilter)}},{key:"deinitRenderObject",value:function(){null!==this.mEquirectMaterial&&(this.mEquirectMaterial.dispose(),this.mEquirectMaterial=null),null!==this.mTextureEquirect&&(this.mTextureEquirect.dispose(),this.mTextureEquirect=null),this.mActiveTextures=null,l(h(f.prototype),"deinitRenderObject",this).call(this)}},{key:"serialize",value:function(e){var t=Object.assign(l(h(f.prototype),"serialize",this).call(this,e),{type:"skyequirect"});return t.properties=Object.assign(t.properties,{skycube_tex_0:this.mTextureIds[0]}),t}}])&&s(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(r.o);y.TypeRTTI=new o.r("ShaderEntitySkyEquirect",r.o.TypeRTTI)},52121:function(e,t,n){"use strict";n.d(t,{G:function(){return P}}),n(26699),n(32023),n(19601),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(2168),o=n(90140),i=n(37526),a=(n(35666),n(88674),n(21249),n(57640),n(9924),n(78456)),u=n(37852),c=n(89539),s=n(41142),l=n(99556);function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function p(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function d(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){p(i,r,o,a,u,"next",e)}function u(e){p(i,r,o,a,u,"throw",e)}a(void 0)}))}}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t){return y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},y(e,t)}function m(e,t){if(t&&("object"===f(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(u,e);var t,n,r,o,i,a=(o=u,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=v(o);if(i){var n=v(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return m(this,e)});function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=a.call(this,"ProcessLoadTexture")).mTexturePaths=e,t}return t=u,n=[{key:"getType",value:function(){return u.TypeRTTI}},{key:"onAttached",value:function(){var e=this.getParent();(0,c.isFunction)(e._onTextureLoaded)||s.qL.error("Attached JobLoadTextures to node with no _onTextureLoaded function.")}},{key:"onExecute",value:(r=d(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){if(t.isCancelled())e(!1);else{var n=new THREE.TextureLoader;n.setCrossOrigin("anonymous");var r=t.mTexturePaths.map((function(e){return d(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",new Promise((function(r,o){n.load(e,(function(n){t.getParent()._onTextureLoaded(e,n),r(n)}),(function(e){}),(function(e){s.qL.error("Failed to load texture: ",e),o(e)}))})));case 1:case"end":return r.stop()}}),r)})))}));l.S.executeInOrder(r,(function(t,n){e(0===n.length)}))}})));case 1:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})}],n&&h(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(a.o);b.TypeRTTI=new o.r("JobLoadTextures",u.e.TypeRTTI);var g=n(55830);function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function O(){return O="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=T(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},O.apply(this,arguments)}function T(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=E(e)););return e}function R(e,t){return R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},R(e,t)}function S(e,t){if(t&&("object"===w(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function E(e){return E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},E(e)}var P=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&R(e,t)}(u,e);var t,n,r,o,a=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=E(r);if(o){var n=E(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return S(this,e)});function u(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(n=a.call(this,e,t)).mWaterNormal1=null,n.mWaterNormal2=null,n.mCacheLayers={},n.onBeforeRender=function(e,t,r){t.traverse((function(e){n.mCacheLayers[e.id]=e.layers.mask,e.layers.set(0)})),(0,c.isNullOrUndefined)(n.mFuncWaterBeforeRender)||n.mFuncWaterBeforeRender(e,t,r)},n.onAfterRender=function(e,t){t.traverse((function(e){e.layers.mask=n.mCacheLayers[e.id]}))},n}return t=u,(n=[{key:"getType",value:function(){return u.TypeRTTI}},{key:"createRenderObject",value:function(){var e=new THREE.PlaneBufferGeometry(20,20),t=new THREE.Water(e,{color:"#ffffff",scale:1,flowDirection:new THREE.Vector2(1,1),textureWidth:1024,textureHeight:1024,normalMap0:this.mWaterNormal1,normalMap1:this.mWaterNormal2});return t.receiveShadow=this.mReceiveShadow,t.position.copy(this.mPosition),t.scale.copy(this.mScale),t.rotation.x=.5*-Math.PI,this.mFuncWaterBeforeRender=t.onBeforeRender,t.onBeforeRender=this.onBeforeRender,t.onAfterRender=this.onAfterRender,s.qL.print("water created: ",t),new i.m(t,this)}},{key:"createBuildProcess",value:function(){return new b(["".concat(g.E4.assetsUrl,"system/textures/Water_1_M_Normal.jpg"),"".concat(g.E4.assetsUrl,"system/textures/Water_2_M_Normal.jpg")])}},{key:"_onTextureLoaded",value:function(e,t){e&&e.includes("Water_1_M_Normal")?this.mWaterNormal1=t:this.mWaterNormal2=t}},{key:"deinitRenderObject",value:function(){null!==this.mWaterNormal1&&(this.mWaterNormal1.dispose(),this.mWaterNormal1=null),null!==this.mWaterNormal2&&(this.mWaterNormal2.dispose(),this.mWaterNormal2=null),this.mFuncWaterBeforeRender=null,O(E(u.prototype),"deinitRenderObject",this).call(this)}},{key:"serialize",value:function(e){return Object.assign(O(E(u.prototype),"serialize",this).call(this,e),{type:"water"})}}])&&_(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(r.o);P.TypeRTTI=new o.r("ShaderEntityWater",r.o.TypeRTTI)},2168:function(e,t,n){"use strict";n.d(t,{o:function(){return l}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(80353),o=n(90140);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function c(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(l,e);var t,n,r,o,i=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=s(r);if(o){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return c(this,e)});function l(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),i.call(this,e,t)}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r.u);l.TypeRTTI=new o.r("ShaderEntity",r.u.TypeRTTI)},16499:function(e,t,n){"use strict";n.d(t,{T:function(){return y}}),n(91058),n(54678),n(19601),n(38862),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(90140),o=n(48425),i=n(89539),a=n(96782),u=n(99672);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(){return l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=f(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},l.apply(this,arguments)}function f(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}function p(e,t){return p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},p(e,t)}function d(e,t){if(t&&("object"===c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(f,e);var t,n,r,o,c=(r=f,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(r);if(o){var n=h(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return d(this,e)});function f(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(n=c.call(this,e,t)).mOptions={},n.setValue("options",{}),n}return t=f,(n=[{key:"getType",value:function(){return f.TypeRTTI}},{key:"setValue",value:function(e,t){switch(e){case"color":return(0,i.isUndefined)(t.isColor)?this.mOptions.color=t:this.mOptions.color="#"+t.getHexString(),!0;case"hover":return(0,i.isUndefined)(t.isColor)?this.mOptions.hover=t:this.mOptions.hover="#"+t.getHexString(),!0;case"textColor":return(0,i.isUndefined)(t.isColor)?this.mOptions.textColor=t:this.mOptions.textColor="#"+t.getHexString(),!0;case"fontSize":return this.mOptions.fontSize=parseInt(t,10),!0;case"margin":return this.mOptions.margin=parseFloat(t),!0;case"title":return this.mOptions.title=t,!0;case"ui_options":case"options":try{var n;n=(0,i.isString)(t)?JSON.parse(t):t,this.mOptions=Object.assign({title:"Title",margin:5,color:"#f06",hover:"#ca095e",fontSize:16,textColor:"#000000"},n)}catch(e){return!1}return!0}return l(h(f.prototype),"setValue",this).call(this,e,t)}},{key:"getValue",value:function(e){var t=l(h(f.prototype),"getValue",this).call(this,e);if(null!==t)return t;switch(e){case"title":return this.mOptions.title;case"margin":return this.mOptions.margin;case"color":return new THREE.Color(this.mOptions.color);case"hover":return new THREE.Color(this.mOptions.hover);case"textColor":return new THREE.Color(this.mOptions.textColor);case"fontSize":return this.mOptions.fontSize;case"ui_options":case"options":return this.mOptions}return null}},{key:"createRenderObject",value:function(){var e=this.getRenderState().getSceneManager().getRenderScene().userData._editorRef,t=new a.f(this,e.getUiRenderer(),this.mOptions);return t.positionType=this.getValue("position_type"),t.position=new THREE.Vector3(this.mPosition.x,this.mPosition.y,this.mPosition.z),t.locked=this.getValue("locked"),new u.p(t,this)}},{key:"serialize",value:function(e){return Object.assign(l(h(f.prototype),"serialize",this).call(this,e),{type:"uix_button",ui_options:JSON.stringify({title:this.mOptions.title,margin:this.mOptions.margin,color:"#"+new THREE.Color(this.mOptions.color).getHexString(),hover:"#"+new THREE.Color(this.mOptions.hover).getHexString(),fontSize:this.mOptions.fontSize,textColor:"#"+new THREE.Color(this.mOptions.textColor).getHexString()})})}}])&&s(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(o.Q);y.TypeRTTI=new r.r("UiEntityButton",o.Q.TypeRTTI)},20349:function(e,t,n){"use strict";n.d(t,{p:function(){return v}}),n(91058),n(54678),n(19601),n(38862),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(90140),o=n(48425),i=n(99672),a=n(95735),u=n(74419),c=n(89539),s=n(71303);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(){return p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=d(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},p.apply(this,arguments)}function d(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=m(e)););return e}function h(e,t){return h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},h(e,t)}function y(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(d,e);var t,n,r,o,l=(r=d,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=m(r);if(o){var n=m(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return y(this,e)});function d(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(n=l.call(this,e,t)).mImage=-1,n.mSize=new THREE.Vector2(100,100),n.setValue("options",{}),n}return t=d,(n=[{key:"getType",value:function(){return d.TypeRTTI}},{key:"setValue",value:function(e,t){switch(e){case"image":return this.mImage=(0,c.isNullOrUndefined)(t)?-1:parseInt(t,10),!0;case"width":return this.mSize.x=parseFloat(t),!0;case"height":return this.mSize.y=parseFloat(t),!0;case"size":return!(!t||!0!==t.isVector2||(this.mSize=t.clone(),0));case"ui_options":case"options":try{var n=null;n=(0,c.isString)(t)?JSON.parse(t):t,n=Object.assign({image:-1,width:100,height:100},n),this.mImage=n.image,this.mSize=new THREE.Vector2(n.width,n.height)}catch(e){return!1}return!0}return p(m(d.prototype),"setValue",this).call(this,e,t)}},{key:"getValue",value:function(e){var t=p(m(d.prototype),"getValue",this).call(this,e);if(null!==t)return t;switch(e){case"image":return this.mImage;case"size":return this.mSize;case"width":return this.mSize.x;case"height":return this.mSize.y;case"ui_options":case"options":return{image:this.mImage,width:this.mSize.x,height:this.mSize.y}}return null}},{key:"createRenderObject",value:function(){var e=this.getRenderState().getSceneManager().getRenderScene().userData._editorRef,t=new a.U(this,e.getUiRenderer(),this.mImagePath,this.mSize.x,this.mSize.y);return t.positionType=this.getValue("position_type"),t.position=new THREE.Vector3(this.mPosition.x,this.mPosition.y,this.mPosition.z),t.locked=this.getValue("locked"),new i.p(t,this)}},{key:"createBuildProcess",value:function(){return(0,c.isNullOrUndefined)(this.mImage)||this.mImage<=0?(this.mImagePath="/assets/system/placeholders/no-image.jpg",new s.T):new u.e(this.mImage)}},{key:"_textureModelReady",value:function(e,t){this.mImagePath=t.source_url}},{key:"serialize",value:function(e){return Object.assign(p(m(d.prototype),"serialize",this).call(this,e),{type:"uix_image",ui_options:JSON.stringify(this.getValue("options"))})}}])&&f(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),d}(o.Q);v.TypeRTTI=new r.r("UiEntityImage",o.Q.TypeRTTI)},8790:function(e,t,n){"use strict";n.d(t,{d:function(){return h}}),n(19601),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(90140),o=n(99672),i=n(43814),a=n(16499);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(){return s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=l(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},s.apply(this,arguments)}function l(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}function f(e,t){return f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},f(e,t)}function p(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(l,e);var t,n,r,a,u=(r=l,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=d(r);if(a){var n=d(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return p(this,e)});function l(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),u.call(this,e,t)}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}},{key:"createRenderObject",value:function(){var e=this.getRenderState().getSceneManager().getRenderScene().userData._editorRef,t=new i.l(this,e.getUiRenderer(),this.mOptions);return t.positionType=this.getValue("position_type"),t.position=new THREE.Vector3(this.mPosition.x,this.mPosition.y,this.mPosition.z),t.locked=this.getValue("locked"),new o.p(t,this)}},{key:"serialize",value:function(e){return Object.assign(s(d(l.prototype),"serialize",this).call(this,e),{type:"uix_tag"})}}])&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(a.T);h.TypeRTTI=new r.r("UiEntityTag",a.T.TypeRTTI)},76101:function(e,t,n){"use strict";n.d(t,{$:function(){return y}}),n(91058),n(19601),n(38862),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(90140),o=n(48425),i=n(89539),a=n(99672),u=n(20128);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(){return l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=f(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},l.apply(this,arguments)}function f(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}function p(e,t){return p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},p(e,t)}function d(e,t){if(t&&("object"===c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(f,e);var t,n,r,o,c=(r=f,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(r);if(o){var n=h(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return d(this,e)});function f(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(n=c.call(this,e,t)).mHtmlText="",n.mOptions={},n.setValue("options",{}),n}return t=f,(n=[{key:"getType",value:function(){return f.TypeRTTI}},{key:"setValue",value:function(e,t){switch(e){case"text":case"htmlText":return this.mHtmlText=t,!0;case"panelColor":case"linkColor":case"linkHover":return(0,i.isUndefined)(t.isColor)?this.mOptions[e]=t:this.mOptions[e]="#"+t.getHexString(),!0;case"margin":return this.mOptions.margin=parseInt(t,10),!0;case"size":return t&&!0===t.isVector2&&(this.mOptions.width=t.x,this.mOptions.height=t.y),!0;case"ui_options":case"options":try{var n;n=(0,i.isString)(t)?JSON.parse(t):t,this.mOptions=Object.assign({panelColor:"#f06",linkColor:"#00f",linkHover:"#0000a0",margin:20,width:200,height:200,text:""},n),this.mHtmlText=this.mOptions.text}catch(e){return!1}return!0}return l(h(f.prototype),"setValue",this).call(this,e,t)}},{key:"getValue",value:function(e){var t=l(h(f.prototype),"getValue",this).call(this,e);if(null!==t)return t;switch(e){case"htmlText":case"text":return this.mHtmlText;case"panelColor":case"linkColor":case"linkHover":return new THREE.Color(this.mOptions[e]);case"margin":return this.mOptions.margin;case"ui_options":case"options":return this.mOptions;case"size":return new THREE.Vector2(this.mOptions.width,this.mOptions.height)}return null}},{key:"createRenderObject",value:function(){var e=this.getRenderState().getSceneManager().getRenderScene().userData._editorRef,t=new u._(this,e.getUiRenderer(),this.mHtmlText,this.mOptions);return t.positionType=this.getValue("position_type"),t.position=new THREE.Vector3(this.mPosition.x,this.mPosition.y,this.mPosition.z),t.locked=this.getValue("locked"),t.setValue("size",this.getValue("size")),new a.p(t,this)}},{key:"serialize",value:function(e){return Object.assign(l(h(f.prototype),"serialize",this).call(this,e),{type:"uix_text",ui_options:JSON.stringify({text:this.mHtmlText,panelColor:"#"+new THREE.Color(this.mOptions.panelColor).getHexString(),linkColor:"#"+new THREE.Color(this.mOptions.linkColor).getHexString(),linkHover:"#"+new THREE.Color(this.mOptions.linkHover).getHexString(),margin:this.mOptions.margin,width:this.mOptions.width,height:this.mOptions.height})})}}])&&s(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(o.Q);y.TypeRTTI=new r.r("UiEntityText",o.Q.TypeRTTI)},48425:function(e,t,n){"use strict";n.d(t,{Q:function(){return h}}),n(19601),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(80353),o=n(90140),i=n(35572),a=n(89539);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(){return s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=l(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},s.apply(this,arguments)}function l(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}function f(e,t){return f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},f(e,t)}function p(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(l,e);var t,n,r,o,u=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=d(r);if(o){var n=d(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return p(this,e)});function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=u.call(this,e,t)).mPositionType="fixed",n.mLocked=!1,n.onBeforeRender=function(e){if(n.hasRenderObject()){var t=n.getRenderObject();t.isDerivedOfTypeName("TwodObject")&&t.get2DObject().update(e.camera)}},n}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}},{key:"setValue",value:function(e,t){switch(e){case"position_type":return this.mPositionType=t,!0;case"locked":return this.mLocked=!0===t||"1"==t,!0}return s(d(l.prototype),"setValue",this).call(this,e,t)}},{key:"getValue",value:function(e){var t=s(d(l.prototype),"getValue",this).call(this,e);if(null!==t)return t;switch(e){case"position_type":return this.mPositionType;case"locked":return this.mLocked}return null}},{key:"initRenderObject",value:function(){return s(d(l.prototype),"initRenderObject",this).call(this),this.registerMessageHandler(i.V.TypeRTTI,this.onBeforeRender),!0}},{key:"deinitRenderObject",value:function(){return this.hasRenderObject()&&this.unregisterMessageHandler(i.V.TypeRTTI),s(d(l.prototype),"deinitRenderObject",this).call(this)}},{key:"serialize",value:function(e){return Object.assign(s(d(l.prototype),"serialize",this).call(this,e),{position_type:(0,a.isNullOrUndefined)(this.mPositionType)?"fixed":this.mPositionType,locked:this.mLocked})}}])&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r.u);h.TypeRTTI=new o.r("UiEntity",r.u.TypeRTTI)},74897:function(e,t,n){"use strict";n.d(t,{R:function(){return k}}),n(41539),n(39714),n(19601),n(91058),n(34553),n(15581),n(2490),n(34514),n(54747),n(68216),n(79433),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r,o=n(67988),i=n(90140);!function(e){e[e.Default=0]="Default",e[e.Parent=1]="Parent",e[e.Always=2]="Always",e[e.OnlySelf=3]="OnlySelf"}(r||(r={}));var a=n(41142),u=n(83348),c=n(89539),s=(n(35666),n(88674),n(78456)),l=n(37852),f=n(80115),p=n(48155);function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function h(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function y(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){h(i,r,o,a,u,"next",e)}function u(e){h(i,r,o,a,u,"throw",e)}a(void 0)}))}}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function b(e,t){return b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},b(e,t)}function g(e,t){if(t&&("object"===d(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function w(e){return w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},w(e)}var _=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b(e,t)}(l,e);var t,n,r,o,i,u,s=(i=l,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=w(i);if(u){var n=w(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return g(this,e)});function l(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6;return m(this,l),(e=s.call(this,"ProcessUpdateView")).mMaxSides=t,e}return t=l,n=[{key:"getType",value:function(){return l.TypeRTTI}},{key:"onAttached",value:function(){this.getParent().isDerivedOfTypeName("ViewNode")||a.qL.error("ProcessUpdateView can only be attached to ViewNode.")}},{key:"getTexturePath",value:(o=y(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){p.y.getInstance().resolveModel(t).then((function(t){for(var r=n>2?2:n<0?0:n;r>=0;r--){var o=t["Lod".concat(r)];if(!(0,c.isNullOrUndefined)(o)&&o.length>0)return e(o)}e(t.source_url)}),(function(e){r(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(e,t){return o.apply(this,arguments)})},{key:"updateTextures",value:function(e){for(var t=this,n=this.getParent(),r=n.getTextureIds(),o=n.getActiveTextures(),i=new Array,u=0;u<this.mMaxSides;u++)r[u]!==o[u]&&(null===r[u]&&null!==o[u]?(n.setActiveTextureId(u,null),n._setTextureCubeImage(u,null)):(n.setActiveTextureId(u,r[u]),i.push({index:u,id:r[u]})));var c=i.length;0===c?e():i.forEach((function(n){t.getTexturePath(n.id,0).then((function(r){t.setActiveTexture(n.index,r,(function(){0==--c&&e()}))}),(function(){a.qL.warn("could not find media model for view at index:",n.index," with id:",n.id),0==--c&&e()}))}))}},{key:"setActiveTexture",value:function(e,t,n){var r=this;this.mImageLoader.load(t,(function(t){var o=r.getParent();null!==o.getActiveTextures()[e]&&o._setTextureCubeImage(e,t),o._updateBackground(),n(!0)}),void 0,(function(e){n(e)}))}},{key:"onExecute",value:(r=y(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){if(t.isCancelled())e(!1);else{var r=t.getParent();r.getRenderState().getResourceManager().getManager(f.O.TextureManager).then((function(n){t.mTextureManager=n,t.mImageLoader=new THREE.ImageLoader,r._createTextureCube(),t.updateTextures((function(){a.qL.print("update tex skybox done"),e(!0)}))}),(function(e){n(e)}))}})));case 1:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})}],n&&v(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(s.o);_.TypeRTTI=new i.r("JobUpdateView",l.e.TypeRTTI);var O=n(35572),T=n(14311);function R(e){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(e)}function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function E(){return E="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=P(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},E.apply(this,arguments)}function P(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=C(e)););return e}function x(e,t){return x=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},x(e,t)}function j(e,t){if(t&&("object"===R(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function C(e){return C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},C(e)}var k=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&x(e,t)}(f,e);var t,n,i,s,l=(i=f,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=C(i);if(s){var n=C(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return j(this,e)});function f(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(n=l.call(this,e,t)).mViewVisibilityType=r.Default,n.mMenuNavigation=!0,n.mBgType="none",n.mColor="#ffffff",n.mBgTexture=null,n.mBgCubemap=null,n.onBeforeRender=function(e){n.getRenderState().getActiveViewInfo().view_id,n.getViewId()},n.mViewId=n._guid(),n.mTextureIds=[null,null,null,null,null,null],n.mActiveTextures=[null,null,null,null,null,null],n}return t=f,(n=[{key:"getType",value:function(){return f.TypeRTTI}},{key:"_guid",value:function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}},{key:"serialize",value:function(e){var t=Object.assign(E(C(f.prototype),"serialize",this).call(this,e),{type:"view"});return t.properties=Object.assign(t.properties,{view_id:this.mViewId,view_visibility:this.mViewVisibilityType,menu_navigation:this.mMenuNavigation,bg_type:this.mBgType,skycube_tex_0:this.mTextureIds[0],skycube_tex_1:this.mTextureIds[1],skycube_tex_2:this.mTextureIds[2],skycube_tex_3:this.mTextureIds[3],skycube_tex_4:this.mTextureIds[4],skycube_tex_5:this.mTextureIds[5],color:"#"+new THREE.Color(this.mColor).getHexString()}),t}},{key:"setValue",value:function(e,t){switch(e){case"view_id":return this.mViewId=t,!0;case"view_visibility":return this.mViewVisibilityType=t,!0;case"menu_navigation":return this.mMenuNavigation=!0===t||"1"==t,!0;case"bg_type":return this.mBgType=t,this.disposeAllTextures(),this.updateTextures(),!0;case"skycube_tex_0":return this.mTextureIds[0]=(0,c.isNullOrUndefined)(t)?null:parseInt(t,10),this.updateTextures(),!0;case"skycube_tex_1":return this.mTextureIds[1]=(0,c.isNullOrUndefined)(t)?null:parseInt(t,10),this.updateTextures(),!0;case"skycube_tex_2":return this.mTextureIds[2]=(0,c.isNullOrUndefined)(t)?null:parseInt(t,10),this.updateTextures(),!0;case"skycube_tex_3":return this.mTextureIds[3]=(0,c.isNullOrUndefined)(t)?null:parseInt(t,10),this.updateTextures(),!0;case"skycube_tex_4":return this.mTextureIds[4]=(0,c.isNullOrUndefined)(t)?null:parseInt(t,10),this.updateTextures(),!0;case"skycube_tex_5":return this.mTextureIds[5]=(0,c.isNullOrUndefined)(t)?null:parseInt(t,10),this.updateTextures(),!0;case"color":return(0,c.isUndefined)(t.isColor)?this.mColor=t:this.mColor="#"+t.getHexString(),this.updateTextures(),!0}return E(C(f.prototype),"setValue",this).call(this,e,t)}},{key:"getValue",value:function(e){var t=E(C(f.prototype),"getValue",this).call(this,e);if(null!==t)return t;switch(e){case"view_id":return this.mViewId;case"view_visibility":return this.mViewVisibilityType;case"menu_navigation":return this.mMenuNavigation;case"bg_type":return this.mBgType;case"skycube_tex_0":return this.mTextureIds[0];case"skycube_tex_1":return this.mTextureIds[1];case"skycube_tex_2":return this.mTextureIds[2];case"skycube_tex_3":return this.mTextureIds[3];case"skycube_tex_4":return this.mTextureIds[4];case"skycube_tex_5":return this.mTextureIds[5];case"color":return new THREE.Color(this.mColor)}return null}},{key:"createBuildProcess",value:function(){switch(this.getValue("bg_type")){case"image":case"equirect":return new _(1);case"cube":return new _}return E(C(f.prototype),"createBuildProcess",this).call(this)}},{key:"onBeforeParseCreate",value:function(e){var t=this.findParentOfType(u.L.TypeRTTI);return!("product"===e&&!(0,c.isNullOrUndefined)(t)&&t.isBundled())&&E(C(f.prototype),"onBeforeParseCreate",this).call(this,e)}},{key:"getTextureIds",value:function(){return this.mTextureIds}},{key:"getActiveTextures",value:function(){return this.mActiveTextures}},{key:"setActiveTextureId",value:function(e,t){this.mActiveTextures[e]=t}},{key:"updateTextures",value:function(){this.hasRenderObject()&&(this.getRenderObject().needsUpdate=!0,this.buildRenderObject())}},{key:"_updateBackground",value:function(){}},{key:"_setTextureCubeImage",value:function(e,t){switch(this.getValue("bg_type")){case"image":case"equirect":(0,c.isNullOrUndefined)(this.mBgTexture)&&(a.qL.warn("Setting image on null bg texture. Creating one!"),this._createTextureCube()),this.mBgTexture.image=t,this.mBgTexture.needsUpdate=!0;break;case"cube":(0,c.isNullOrUndefined)(this.mBgCubemap)&&(a.qL.warn("Setting image on null bg cube. Creating one!"),this._createTextureCube()),this.mBgCubemap.images[e]=t,Array.isArray(this.mBgCubemap.images)&&this.mBgCubemap.images.findIndex((function(e){return(0,c.isNullOrUndefined)(e)}))<0&&(this.mBgCubemap.needsUpdate=!0);break;default:a.qL.warn("Trying to set texture cube on view with bg type: ",this.getValue("bg_type"))}}},{key:"_createTextureCube",value:function(){switch(this.getValue("bg_type")){case"image":null===this.mBgTexture?(this.mBgTexture=new THREE.Texture,this.mBgTexture.magFilter=THREE.LinearFilter,this.mBgTexture.minFilter=THREE.LinearMipMapLinearFilter):this.mBgTexture.mapping!==THREE.UVMapping&&(this.mBgTexture.mapping=THREE.UVMapping,this.mBgTexture.needsUpdate=!0);break;case"equirect":null===this.mBgTexture?(this.mBgTexture=new THREE.Texture,this.mBgTexture.mapping=THREE.EquirectangularReflectionMapping,this.mBgTexture.magFilter=THREE.LinearFilter,this.mBgTexture.minFilter=THREE.LinearMipMapLinearFilter):this.mBgTexture.mapping!==THREE.EquirectangularReflectionMapping&&(this.mBgTexture.mapping=THREE.EquirectangularReflectionMapping,this.mBgTexture.needsUpdate=!0);break;case"cube":null===this.mBgCubemap&&(this.mBgCubemap=new THREE.CubeTexture);break;default:a.qL.warn("request create texture cube on view with bg type: ",this.getValue("bg_type"))}}},{key:"getViewId",value:function(){return this.getValue("view_id")}},{key:"getVisibilityType",value:function(){return this.getValue("view_visibility")}},{key:"setVisibilityType",value:function(e){this.setValue("view_visibility",e)}},{key:"getVisibilityMenu",value:function(){return this.getValue("menu_navigation")}},{key:"setVisibleMenu",value:function(e){this.setValue("menu_navigation",e)}},{key:"_isParentViewVisible",value:function(){for(var e=this.getParent();null!==e;){if(e.isDerivedTypeOf(f.TypeRTTI))return e.isViewVisible();e=e.getParent()}return!1}},{key:"_descendingViewActive",value:function(){var e=new Array,t=this.getRenderState();this.mChildren.forEach((function(t){t.isDerivedTypeOf(u.L.TypeRTTI)||e.push(t)}));for(var n=function(){var n=e.shift();if(n.isDerivedTypeOf(o.B.TypeRTTI)){if(n.isDerivedTypeOf(f.TypeRTTI)&&n.getViewId()===t.getActiveViewInfo().view_id)return{v:!0};n.getChildren().forEach((function(t){n.isDerivedTypeOf(u.L.TypeRTTI)||e.push(t)}))}};e.length>0;){var r=n();if("object"===R(r))return r.v}return!1}},{key:"isViewVisible",value:function(){var e=this.getRenderState().getActiveViewInfo(),t=this.findParentOfType(u.L.TypeRTTI);if((0,c.isNullOrUndefined)(e)||(0,c.isNullOrUndefined)(t)||t.getSceneObjectId()!==e.product_scene_id)return!1;var n=e.view_id===this.getViewId(),o=!1;switch(+this.getVisibilityType()){case r.Default:o=n||this._descendingViewActive();break;case r.Parent:o=n||this._descendingViewActive()||this._isParentViewVisible();break;case r.Always:o=!0;break;case r.OnlySelf:o=n}return o}},{key:"disposeBgTexture",value:function(){null!==this.mBgTexture&&(this.mBgTexture.dispose(),this.mBgTexture=null)}},{key:"disposeBgCube",value:function(){null!==this.mBgCubemap&&(this.mBgCubemap.dispose(),this.mBgCubemap=null)}},{key:"disposeAllTextures",value:function(){this.mActiveTextures=[null,null,null,null,null,null],this.disposeBgCube(),this.disposeBgTexture()}},{key:"setSceneBackground",value:function(e){switch(this.getValue("bg_type")){case"image":case"equirect":return(0,c.isNullOrUndefined)(this.mBgTexture)||(0,c.isNullOrUndefined)(this.mBgTexture.image)?e.background=null:e.background=this.mBgTexture,!0;case"cube":return!(0,c.isNullOrUndefined)(this.mBgCubemap)&&6===this.mBgCubemap.images.length&&this.mBgCubemap.images.every((function(e){return!(0,c.isNullOrUndefined)(e)}))?e.background=this.mBgCubemap:e.background=null,!0;case"color":return e.background=this.getValue("color"),!0;case"transparent":return e.background=null,!0}return!1}},{key:"createRenderObject",value:function(){return this.registerMessageHandler(O.V.TypeRTTI,this.onBeforeRender),E(C(f.prototype),"createRenderObject",this).call(this)}},{key:"buildRenderObject",value:function(){var e=this.isViewVisible();return a.qL.print("view ",this.getValue("name"),"is",e,"rv",this.getRenderState().getActiveViewInfo(),"id",this.getViewId(),"vis",this.getVisibilityType()),e?E(C(f.prototype),"buildRenderObject",this).call(this):E(C(f.prototype),"destroyRenderObject",this).call(this)}},{key:"finalizeRenderObjectBuild",value:function(){if(E(C(f.prototype),"finalizeRenderObjectBuild",this).call(this),a.qL.print("Finalize view build: ",this.getViewId()),this.getRenderState().getActiveViewInfo().view_id!==this.getViewId())this.disposeAllTextures();else switch(this.getValue("bg_type")){case"image":case"equirect":this.disposeBgCube();for(var e=1;e<6;e++)this.mActiveTextures[e]=null;break;case"cube":this.disposeBgTexture();break;default:this.disposeAllTextures()}this.getRenderState().dispatchAppEvent(T.G.ViewUpdated)}},{key:"deinitRenderObject",value:function(){this.mActiveTextures=[null,null,null,null,null,null],this.disposeBgTexture(),this.disposeBgCube(),this.hasRenderObject()&&this.unregisterMessageHandler(O.V.TypeRTTI),E(C(f.prototype),"deinitRenderObject",this).call(this)}}])&&S(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(o.B);k.TypeRTTI=new i.r("ViewNode",o.B.TypeRTTI)},70062:function(e,t,n){"use strict";n.d(t,{S:function(){return s}}),n(35666),n(41539),n(88674),n(47941),n(69070),n(21703);var r=n(29514),o=n(89539),i=n(70456);function a(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function u(e){a(i,r,o,u,c,"next",e)}function c(e){a(i,r,o,u,c,"throw",e)}u(void 0)}))}}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,a,s;return t=e,n=[{key:"save",value:(s=u(regeneratorRuntime.mark((function e(t,n){var r=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.length>2&&void 0!==r[2]&&r[2],r.length>3&&r[3],e.abrupt("return",new Promise((function(e,t){})));case 3:case"end":return e.stop()}}),e)}))),function(e,t){return s.apply(this,arguments)})},{key:"load",value:(a=u(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){if((0,o.isNullOrUndefined)(n))return t("undefined configurations")})));case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return a.apply(this,arguments)})},{key:"_setActiveOptions",value:function(e,t,n,r,i){var a=this,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(arguments.length>6&&void 0!==arguments[6]||new Date,(0,o.isNullOrUndefined)(i)&&(i=Object.keys(t)),u>=i.length)return n();e.getAttributes(),(0,o.isFunction)(r)&&r((u+1)/i.length);var c=+new Date;setTimeout((function(){a._setActiveOptions(e,t,n,r,i,u+1,c)}),0)}},{key:"_setActiveMaterials",value:function(e,t,n,r,i){var a=this,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(arguments.length>6&&void 0!==arguments[6]||new Date,(0,o.isNullOrUndefined)(i)&&(i=Object.keys(t)),u>=i.length)return n();e.setActiveMaterial(i[u],t[i[u]]),(0,o.isFunction)(r)&&r((u+1)/i.length);var c=+new Date;setTimeout((function(){a._setActiveMaterials(e,t,n,r,i,u+1,c)}),0)}},{key:"_resolveConfigurableNode",value:function(e){var t=this;this.mConfigurableNodeSubject=new i.t(1);var n=null,o=!1,a=e.onConfigurableNodeReady.pipe((0,r.P)()).subscribe((function(e){t.mConfigurableNodeSubject.next(e),o=!0,null!==n&&(clearTimeout(n),n=null)}),(function(e){t.mConfigurableNodeSubject.error(e),null!==n&&(clearTimeout(n),n=null)}));return o||(n=setTimeout((function(){null!==n&&(a.unsubscribe(),t.mConfigurableNodeSubject.error("timeout"),n=null)}),6e4)),this.mConfigurableNodeSubject.pipe((0,r.P)())}}],n&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},57085:function(){},82434:function(e,t,n){"use strict";n.d(t,{q:function(){return y}}),n(41539),n(88674),n(69070),n(21703),n(47941),n(82526),n(57327),n(88449),n(2490),n(59849),n(38880),n(15581),n(34514),n(54747),n(49337),n(33321),n(35666);var r=n(70062),o=n(89539),i=n(41142);function a(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function u(e){a(i,r,o,u,c,"next",e)}function c(e){a(i,r,o,u,c,"throw",e)}u(void 0)}))}}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r,a;return t=e,n=[{key:"save",value:(a=u(regeneratorRuntime.mark((function e(t,n){var r,i,a=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>2&&void 0!==a[2]?a[2]:null,i=a.length>3?a[3]:void 0,e.abrupt("return",new Promise((function(e,a){t.getComponent("materialGroupManager").resolveMaterialGroups().subscribe((function(u){var c={};u.getGroups().forEach((function(e){var t=u.getActiveRefId(e.id);(0,o.isNullOrUndefined)(t)||(c[e.id]=t)})),t.getComponent("attributeManager").resolveAttributeManager().subscribe((function(o){var a=!!i&&i.include_keys;e({version:"2.0",catalogue_id:t.getValue("product_id"),configuration:{attributes:o.serialize({discard_hidden:!1,include_keys:a,calculate_approximations:!0}),materials:c},attributes:o.serialize({discard_hidden:!0,include_keys:a,calculate_approximations:!1}),thumbnail:r,articles:n})}),(function(e){a(e)}))}),(function(e){a(e)}))})));case 3:case"end":return e.stop()}}),e)}))),function(e,t){return a.apply(this,arguments)})},{key:"load",value:(r=u(regeneratorRuntime.mark((function e(t,n,r){var a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,u){if((0,o.isNullOrUndefined)(n))return u("undefined configurations");i.qL.print("previous configuration: ",n),t.getComponent("attributeManager").resolveAttributeManager().subscribe((function(t){var i=n.configuration.attributes,u=i.length;u=u<=0?1:u,a._setActiveOptions(t,i,(function(){e(!0)}),(function(e){if((0,o.isFunction)(r)){var t=i.length/u;r(e*t)}}))}),(function(e){u(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"_setActiveOptions",value:function(e,t,n,r){var a=this,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(arguments.length>5&&void 0!==arguments[5]||new Date,u>=t.length)return n();try{var c=t[u],s=e.getAttributeController(c.attribute_id);(0,o.isNullOrUndefined)(s)||s.parse(c.attribute_value,{emitEvent:!0,rebuild:u===t.length-1})}catch(e){i.qL.warn(e)}(0,o.isFunction)(r)&&r((u+1)/t.length);var l=+new Date;setTimeout((function(){a._setActiveOptions(e,t,n,r,u+1,l)}),0)}}],n&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function l(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){l(i,r,o,a,u,"next",e)}function u(e){l(i,r,o,a,u,"throw",e)}a(void 0)}))}}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var y=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mOptions=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({include_keys:!1},t)}var t,n,a,u;return t=e,n=[{key:"save",value:(u=f(regeneratorRuntime.mark((function e(t,n,o,a){var u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=a,e.next="1.0"===e.t0?3:"2.0"===e.t0?5:7;break;case 3:return u=new r.S,e.abrupt("break",9);case 5:return u=new s,e.abrupt("break",9);case 7:i.qL.print("Saving configuration with version '"+a+"'. Provided version: "+a),u=new s;case 9:return e.abrupt("return",u.save(t,n,o,this.mOptions));case 10:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return u.apply(this,arguments)})},{key:"load",value:(a=f(regeneratorRuntime.mark((function e(t,n,a){var u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,o.isNullOrUndefined)(n)){e.next=2;break}return e.abrupt("return",new Promise((function(e,t){return t("undefined configurations")})));case 2:e.t0=n.version,e.next="1.0"===e.t0?5:"2.0"===e.t0?7:9;break;case 5:return u=new r.S,e.abrupt("break",11);case 7:return u=new s,e.abrupt("break",11);case 9:i.qL.warn("Loading configuration with version '"+String(n.version)+"'. Unknown version: "+String(n.version)),u=new s;case 11:return e.abrupt("return",u.load(t,n,a));case 12:case"end":return e.stop()}}),e)}))),function(e,t,n){return a.apply(this,arguments)})}],n&&h(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},39030:function(e,t,n){"use strict";n.d(t,{ConfigurationSerializer:function(){return o.q}});var r=n(57085);n.o(r,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return r.AddObjectCommand}}),n.o(r,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return r.AppViewerComponent}}),n.o(r,"ConfigurationSerializer")&&n.d(t,{ConfigurationSerializer:function(){return r.ConfigurationSerializer}}),n.o(r,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return r.SetPositionCommand}}),n.o(r,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return r.SetRotationCommand}}),n(70062);var o=n(82434)},8942:function(e,t,n){"use strict";var r=n(39030);n.o(r,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return r.AddObjectCommand}}),n.o(r,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return r.AppViewerComponent}}),n.o(r,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return r.SetPositionCommand}}),n.o(r,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return r.SetRotationCommand}})},75306:function(e,t,n){"use strict";var r;n.d(t,{i:function(){return r}}),function(e){e[e.Desktop=0]="Desktop",e[e.Mobile=1]="Mobile"}(r||(r={}))},30082:function(e,t,n){"use strict";n.d(t,{n:function(){return f}}),n(19601),n(47941),n(54678),n(91058),n(69070),n(21703),n(47042),n(41539),n(68309),n(91038),n(78783),n(74916),n(77601),n(82526),n(41817),n(32165),n(66992),n(33948);var r=n(89539),o=n(75306);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mSettings=t}var t,n;return t=e,(n=[{key:"shadow",get:function(){return this.mSettings.shadow_mob}},{key:"lod",get:function(){return this.mSettings.lod_mob}},{key:"compression",get:function(){return this.mSettings.compression_mob}},{key:"anti_aliasing",get:function(){return"1"==this.mSettings.aliasing_mob}},{key:"alpha",get:function(){return"1"==this.mSettings.alpha}},{key:"clear_color",get:function(){return this.mSettings.clear_color}},{key:"esd_scene_scale",get:function(){return this.mSettings.esd_scene_scale}}])&&i(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mSettings=t}var t,n;return t=e,(n=[{key:"shadow",get:function(){return this.mSettings.shadow_desk}},{key:"lod",get:function(){return this.mSettings.lod_desk}},{key:"compression",get:function(){return this.mSettings.compression_desk}},{key:"anti_aliasing",get:function(){return"1"==this.mSettings.aliasing_desk}},{key:"alpha",get:function(){return"1"==this.mSettings.alpha}},{key:"clear_color",get:function(){return this.mSettings.clear_color}},{key:"esd_scene_scale",get:function(){return this.mSettings.esd_scene_scale}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var f=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mCatalogueMeta=(0,r.isNullOrUndefined)(t)?null:t}var t,n;return t=e,(n=[{key:"withCatalogueSettings",value:function(e){return this.mCatalogueMeta=e.getCatalogueMeta(),this}},{key:"withSceneSettings",value:function(e){return this.mCatalogueMeta=this.mCatalogueMeta||{},this.mCatalogueMeta.scene_settings=this.validateSettings(e),this}},{key:"withCatalogueMeta",value:function(e){return this.mCatalogueMeta=this.mCatalogueMeta||{},this.mCatalogueMeta=Object.assign(this.mCatalogueMeta,e),this}},{key:"validateSettings",value:function(e){var t=!(0,r.isNullOrUndefined)(e)&&Object.keys(e).length>0&&!(0,r.isArray)(e)&&!("string"==typeof e||e instanceof String);return Object.assign(Object.assign({shadow_desk:"3",shadow_mob:"2",lod_desk:"0",lod_mob:"1",compression_desk:"1",compression_mob:"1",aliasing_desk:"1",aliasing_mob:"1",alpha:"0",clear_color:2147483647,esd_scene_scale:1},t?e:{}))}},{key:"getCatalogueMeta",value:function(){return this.mCatalogueMeta||{}}},{key:"isModuleEnabled",value:function(e){return!(0,r.isNullOrUndefined)(this.mCatalogueMeta)&&!(0,r.isNullOrUndefined)(this.mCatalogueMeta.modules)&&!0===this.mCatalogueMeta.modules[e]}},{key:"getModuleSettings",value:function(e){return this.mCatalogueMeta&&this.mCatalogueMeta.module_settings&&this.mCatalogueMeta.module_settings[e]?this.mCatalogueMeta.module_settings[e]:{}}},{key:"getSubModuleSettings",value:function(e,t){if(!(this.mCatalogueMeta&&this.mCatalogueMeta.module_settings&&this.mCatalogueMeta.module_settings[e]))return{};var n=this.mCatalogueMeta.module_settings[e];if(!Array.isArray(n))return{};var r,o=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw i}}}}(n);try{for(o.s();!(r=o.n()).done;){var i=r.value;if(i.scope==t)return i}}catch(e){o.e(e)}finally{o.f()}return{}}},{key:"getSceneDeviceSettings",value:function(e){return e===o.i.Mobile?new a(this.getSceneSettings()):new c(this.getSceneSettings())}},{key:"getSceneSettings",value:function(){var e=(0,r.isNullOrUndefined)(this.mCatalogueMeta)?null:this.mCatalogueMeta.scene_settings;return this.validateSettings(e)}},{key:"getSceneRevId",value:function(){if((0,r.isNullOrUndefined)(this.mCatalogueMeta))return null;var e=parseFloat(this.mCatalogueMeta.scene_rev_id);return!isNaN(e)&&isFinite(e)?parseInt(String(e),10):0}},{key:"getGraphRevId",value:function(){if((0,r.isNullOrUndefined)(this.mCatalogueMeta))return null;var e=parseFloat(this.mCatalogueMeta.graph_active);return!isNaN(e)&&isFinite(e)?parseInt(String(e),10):0}}])&&l(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},79843:function(e,t,n){"use strict";n.d(t,{Q:function(){return g}}),n(41539),n(15581),n(2490),n(34514),n(54747),n(47941),n(91058),n(88674),n(69070),n(21703);var r=n(64944),o=n(70456),i=n(84217),a=n(39876),u=n(51610),c=n(68009),s=n(89539),l=n(29844),f=n(28810);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n(82526),n(57327),n(88449),n(59849),n(38880),n(49337),n(33321);var m=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mData=t}var t,n;return t=e,n=[{key:"getRawData",value:function(){return this.mData}},{key:"getCatalogue",value:function(){return(0,s.isNullOrUndefined)(this.mData.catalogue)?{}:this.mData.catalogue}},{key:"getMaterialsByGroup",value:function(){return(0,s.isNullOrUndefined)(this.mData.materials_by_group)?[]:this.mData.materials_by_group}},{key:"getAttributes",value:function(){return(0,s.isNullOrUndefined)(this.mData.attributes)?{}:this.mData.attributes}},{key:"getRules",value:function(){return(0,s.isNullOrUndefined)(this.mData.rules)?[]:this.mData.rules}},{key:"getOffsetGroups",value:function(){return(0,s.isNullOrUndefined)(this.mData.offset_groups)?{}:this.mData.offset_groups}},{key:"getPostPipelines",value:function(){return(0,s.isNullOrUndefined)(this.mData.post_pipelines)?[]:this.mData.post_pipelines}},{key:"getCatalogueClasses",value:function(){return(0,s.isNullOrUndefined)(this.mData.modifier_classes)?{}:this.mData.modifier_classes}},{key:"getPricingSettings",value:function(){return this.buildDefaultPricingSettings(this.mData.pricing_settings)}},{key:"getPricingGroups",value:function(){return(0,s.isNullOrUndefined)(this.mData.pricing_groups)?{}:this.mData.pricing_groups}},{key:"getMaterials",value:function(){return(0,s.isNullOrUndefined)(this.mData.all_materials)?{}:this.mData.all_materials}},{key:"getMedia",value:function(){return(0,s.isNullOrUndefined)(this.mData.media)?{}:this.mData.media}},{key:"buildDefaultPricingSettings",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return d(d({id:null,sku_calculator:"part_sku"},e),{},{price_calculators:d({attribute_pricing:!0,pricing_matrix:!0,script_engine:!1,external_api:!1},(e||{}).price_calculators)})}}],n&&y(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),v=n(41142);function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var g=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mLoader={}}var t,n,p;return t=e,p=[{key:"getInstance",value:function(){return null===this._instance&&(this._instance=new this),this._instance}}],(n=[{key:"resetCache",value:function(){return this.disposeCacheLoader(),this}},{key:"disposeCacheLoader",value:function(){var e=this;Object.keys(this.mLoader).forEach((function(t){e.mLoader[t].error("disposed")})),this.mLoader={}}},{key:"resolveBootstrapData",value:function(e){var t=this,n=c.F.isNumeric(e)?parseInt(e,10):null;return null===n?(0,r._)("Catalogue id is not an ID"):((0,s.isNullOrUndefined)(this.mLoader[n])&&(this.mLoader[n]=new o.t(1),u.R.getInstance().resolveMeta(e).pipe((0,i.q)(1)).subscribe((function(e){v.qL.print("bootstrap got meta: ",e),t._resolveFromCache(n,e).then((function(e){v.qL.print("boostrap got data from cache: ",e),t.mLoader[n].next(new m(e))}),(function(e){t._resolveFromAPI(n).then((function(e){v.qL.print("boostrap got data from api: ",e),t.mLoader[n].next(new m(e))}),(function(e){t.mLoader[n].error(e),t.mLoader[n]=null}))}))}),(function(e){t.mLoader[n].error(e),t.mLoader[n]=null}))),this.mLoader[n].pipe((0,a.B)()))}},{key:"_resolveFromAPI",value:function(e){return new Promise((function(t,n){l.O.getInstance().get(f.E.apiUrl+"catalogue/"+e+"/bootstrap?include[attributes]=categories,values.categories,values.valuable,entityProperties.entityPropertyValues&include[pricing_groups]=pricing_rules.pricingRuleAdjustmentFields,pricing_classes").then((function(e){if(200!==e.status)return n("Response status: "+e.status);var r=e.data;t(r)}),(function(e){n(e)}))}))}},{key:"_resolveFromCache",value:function(e,t){return new Promise((function(e,n){if(!(0,s.isString)(t.bootstrap_data_cache_file)||0===t.bootstrap_data_cache_file.length)return n("not hash");var r=t.bootstrap_data_cache_file;l.O.uniqueInstance().get(r,{baseURL:f.E.spacesUrl}).then((function(t){if(200!==t.status)return n("Response status: "+t.status);var r=t.data;e(r)}),(function(e){n(e)}))}))}}])&&b(t.prototype,n),p&&b(t,p),Object.defineProperty(t,"prototype",{writable:!1}),e}();g._instance=null},28810:function(e,t,n){"use strict";n.d(t,{E:function(){return a}}),n(74916),n(15306),n(92222),n(69070),n(21703);var r,o=n(89539);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}!function(e){e.Production="production",e.Staging="staging",e.Local="local"}(r||(r={}));var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"productionBuild",get:function(){return true}},{key:"environment",get:function(){return"production"}},{key:"protocol",get:function(){return"https://"}},{key:"backendURL",get:function(){return"https://expivi.net"}},{key:"serverAddress",get:function(){return"https://admin.expivi.net"}},{key:"cacheAddress",get:function(){return"https://cache.expivi.net"}},{key:"spacesAddress",get:function(){return"https://d33o7r96pw821t.cloudfront.net"}},{key:"apiUrl",get:function(){return"".concat(e.backendURL,"/api/")}},{key:"authUrl",get:function(){return"".concat(e.backendURL,"/oauth/token")}},{key:"kioskAuthUrl",get:function(){return"".concat(e.backendURL,"/kiosk/login")}},{key:"storageUrl",get:function(){return"".concat(e.serverAddress,"/storage/")}},{key:"assetsUrl",get:function(){return"".concat(e.serverAddress,"/assets/")}},{key:"spacesUrl",get:function(){return"".concat(e.spacesAddress,"/")}},{key:"cacheUrl",get:function(){return"".concat(e.cacheAddress,"/")}},{key:"makeApiRoute",value:function(t){return e.apiUrl+((0,o.isUndefined)(t)?"":t)}},{key:"makeTeamRoute",value:function(t,n){var r=e.backendURL.replace(/https?:\/\/((www|master)\.)*/gi,".");return"".concat(e.protocol).concat(t).concat(r).concat(n)}}],null&&i(t.prototype,null),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},10288:function(e,t,n){"use strict";n.d(t,{Dt:function(){return u},Em:function(){return f},_v:function(){return c},gn:function(){return i},nI:function(){return l},tq:function(){return s}}),n(74916),n(77601);var r=n(51390);function o(){return navigator.platform&&/MacIntel/.test(navigator.platform)&&navigator.maxTouchPoints>1}function i(){return!(!navigator.platform||!/iPhone|iPod|iPad|iPhone Simulator|iPod Simulator/.test(navigator.platform))||!!o()||/iPad|iPhone|iPod|Pike v7\.6 release 92|Pike v7\.8 release 517/.test(navigator.userAgent)&&!("MSStream"in window)}function a(){return/windows phone/i.test(navigator.userAgent)}function u(){return!(!navigator.platform||!/Android/.test(navigator.platform))||/android/i.test(navigator.userAgent)&&!a()}function c(){return i()?r.S.iOS:u()?r.S.Android:a()?r.S.WindowsPhone:navigator.platform&&/OS\/2|Pocket PC|Windows|Win16|Win32|Win64|WinCE/.test(navigator.platform)?r.S.Windows:navigator.platform&&/Macintosh|MacIntel|MacPPC|Mac68K/.test(navigator.platform)?r.S.MacOS:r.S.Unknown}function s(){return i()||u()||a()}function l(){return!s()}function f(){if(o())return!0;var e=navigator.userAgent;return/(ipad|tablet|(android(?!.*mobile))|(windows(?!.*phone)(.*touch))|kindle|playbook|silk|(puffin(?!.*(IP|AP|WP))))/i.test(e)}},29844:function(e,t,n){"use strict";n.d(t,{O:function(){return d}}),n(35666),n(41539),n(88674),n(21249),n(57640),n(9924),n(40561),n(74916),n(77601),n(69070),n(21703);var r=n(9669),o=n.n(r),i=n(28810),a=n(70211),u=n(89539),c=n(41142);function s(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){s(i,r,o,a,u,"next",e)}function u(e){s(i,r,o,a,u,"throw",e)}a(void 0)}))}}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];f(this,e),this.tokenChanged=new a.xQ,this.refreshTokenChanged=new a.xQ,this.isRefreshing=!1,this.mRefreshSubscribers=[],this.mToken=null,this.mRefreshToken=null,this.mAxiosInstance=o().create({baseURL:i.E.apiUrl}),n||this.mAxiosInstance.interceptors.response.use((function(e){return e}),function(){var e=l(regeneratorRuntime.mark((function e(n){var r,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r="-1",n&&n.response&&n.response.status&&(r=n.response.status),i=n.config,c.qL.warn("httpservice rejected"),null===t.mRefreshToken||"401"!=r&&"403"!=r){e.next=10;break}return t.isRefreshing||t._refreshAccessToken().then((function(e){c.qL.print("token refreshed: ",e)}),(function(e){c.qL.print("Failed to refresh token: ",e)})),a=new Promise((function(e,n){t._subscribeTokenRefresh((function(t){i.headers.Authorization="Bearer "+t,e(o()(i))}),(function(e){n(e)}))})),e.abrupt("return",a);case 10:return e.abrupt("return",Promise.reject(n));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}var t,n,r,s,d,h,y,m,v,b;return t=e,n=[{key:"getHttpInstance",value:function(){return this.mAxiosInstance}},{key:"_refreshAccessToken",value:(b=l(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isRefreshing=!0,e.abrupt("return",new Promise((function(e,n){if(!t.mRefreshToken)return t.isRefreshing=!1,t._onFailedRefresh("Missing refresh token"),n("Not logged in");var r=t.mRefreshToken;o()({method:"post",url:i.E.authUrl,data:{grant_type:"refresh_token",refresh_token:r,scope:"read-write"}}).then((function(n){t.isRefreshing=!1;var r=n.data;t.setToken(r.access_token),t.mRefreshToken=r.refresh_token,t.tokenChanged.next(t.mToken),t.refreshTokenChanged.next(t.mRefreshToken),t._onRrefreshed(r.access_token),e(r.access_token)}),(function(e){t.isRefreshing=!1,t._onFailedRefresh(e),n(e)}))})));case 2:case"end":return e.stop()}}),e,this)}))),function(){return b.apply(this,arguments)})},{key:"_subscribeTokenRefresh",value:function(e,t){this.mRefreshSubscribers.push({resolve:e,reject:t})}},{key:"_onRrefreshed",value:function(e){this.mRefreshSubscribers.splice(0,this.mRefreshSubscribers.length).map((function(t){t.resolve(e)}))}},{key:"_onFailedRefresh",value:function(e){this.mRefreshSubscribers.splice(0,this.mRefreshSubscribers.length).map((function(t){!(0,u.isNullOrUndefined)(t.reject)&&(0,u.isFunction)(t.reject)&&t.reject(e)}))}},{key:"setToken",value:function(e){this.mToken=e,this.mAxiosInstance.defaults.headers.common.Authorization="Bearer "+e}},{key:"setRefreshToken",value:function(e){this.mRefreshToken=e}},{key:"getAcceptLanguage",value:function(){return this.mAcceptLanguage}},{key:"getCountry",value:function(){return this.mCountry}},{key:"setAcceptLanguage",value:function(e){!(0,u.isNullOrUndefined)(e)&&/^[a-zA-Z]{2}(-[A-Z]{2})?$/.test(e)&&(this.mAcceptLanguage=e,this.mAxiosInstance.defaults.headers.common["Accept-Language"]=this.mAcceptLanguage,c.qL.print("language changed to "+this.mAcceptLanguage))}},{key:"setCountry",value:function(e){(0,u.isNullOrUndefined)(e)||2!==e.length?(0,u.isNullOrUndefined)(e)||2===e.length||c.qL.warn("Can not set country code. Invalid code provided:",e):(this.mCountry=e,this.mAxiosInstance.defaults.headers.common["Locale-Country"]=this.mCountry,c.qL.print("country changed to "+this.mCountry))}},{key:"get",value:(v=l(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.mAxiosInstance.get(t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return v.apply(this,arguments)})},{key:"delete",value:(m=l(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.mAxiosInstance.delete(t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return m.apply(this,arguments)})},{key:"post",value:(y=l(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.mAxiosInstance.post(t,n,r));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return y.apply(this,arguments)})},{key:"put",value:(h=l(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.mAxiosInstance.put(t,n,r));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return h.apply(this,arguments)})},{key:"patch",value:(d=l(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.mAxiosInstance.patch(t,n,r));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return d.apply(this,arguments)})},{key:"head",value:(s=l(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.mAxiosInstance.head(t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})}],r=[{key:"getInstance",value:function(){return null===this._instance&&(this._instance=new this(!1)),this._instance}},{key:"uniqueInstance",value:function(){return new this(!0)}}],n&&p(t.prototype,n),r&&p(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();d._instance=null},55830:function(e,t,n){"use strict";n.d(t,{E4:function(){return r.E},OE:function(){return o.O}});var r=n(28810),o=n(29844);n(44795),n(3635)},9896:function(e,t,n){"use strict";n.d(t,{h:function(){return v}}),n(21249),n(57640),n(9924),n(47941),n(41539),n(15581),n(2490),n(34514),n(54747),n(88674),n(91058),n(64211),n(41874),n(69600),n(57327),n(88449),n(59849),n(92222),n(69070),n(21703);var r=n(18170),o=n(63202),i=n(70456),a=n(64944),u=n(40486),c=n(84217),s=n(68009),l=n(89539),f=n(29844),p=n(28810),d=n(94130),h=n(79843),y=n(41142);function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var v=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mModels={},this.mMaterialLoaders={},this.mDependencyLoaders={}}var t,n,v;return t=e,v=[{key:"getInstance",value:function(){return null===this._instance&&(this._instance=new this),this._instance}}],(n=[{key:"getModels",value:function(){var e=this;return Object.keys(this.mModels).map((function(t){return e.mModels[t]}))}},{key:"resetCache",value:function(){return this.disposeCacheLoader(),this.mModels={},this}},{key:"disposeCacheLoader",value:function(){var e=this;Object.keys(this.mMaterialLoaders).forEach((function(t){e.mMaterialLoaders[t].error("disposed")})),this.mMaterialLoaders={},Object.keys(this.mDependencyLoaders).forEach((function(t){e.mDependencyLoaders[t].error("disposed")})),this.mDependencyLoaders={}}},{key:"resolveModel",value:function(e){var t=this;return new Promise((function(n,o){if(!s.F.isNumeric(e))return o("requested id is not an integer: "+e);var i=parseInt(e,10);if(i in t.mModels)return n(t.mModels[i]);var a=Object.keys(t.mDependencyLoaders).map((function(e){return t.mDependencyLoaders[e].pipe((0,u.K)((function(e){return(0,r.of)([])})))}));y.qL.print("material bootstrap dependencies: ",a),t.finishDependencies(a).pipe((0,c.q)(1)).subscribe((function(){y.qL.print("material finish dependency"),t._getModelFromAPI(i).then((function(e){n(e)}),(function(e){o(e)}))}),(function(e){y.qL.error("bootstrap material failed",e)}))}))}},{key:"resolveModels",value:function(e){var t=this;return new Promise((function(n,o){if(e.map((function(e){return s.F.isNumeric(e)})).some((function(e){return!e})))return o("requested list contains non-numeric values: "+e.join(", "));var i=Object.keys(t.mDependencyLoaders).map((function(e){return t.mDependencyLoaders[e].pipe((0,u.K)((function(e){return(0,r.of)([])})))}));t.finishDependencies(i).pipe((0,c.q)(1)).subscribe((function(){y.qL.print("Material finish dependency"),t._getModelsFromAPI(e).then(n,o)}),(function(e){y.qL.error("Bootstrap material failed",e)}))}))}},{key:"finishDependencies",value:function(e){return e.length>0?(0,o.aj)(e):(0,r.of)(!0)}},{key:"_getModelFromAPI",value:function(e){var t=this;return new Promise((function(n,r){if(e in t.mModels)return n(t.mModels[e]);e in t.mMaterialLoaders||(t.mMaterialLoaders[e]=new i.t(1),f.O.getInstance().get(p.E.apiUrl+"material/"+e).then((function(n){var r=n.data;t.mMaterialLoaders[e].next(d.FG.getItem(r))}),(function(n){t.mMaterialLoaders[e].error(n)}))),t.mMaterialLoaders[e].pipe((0,c.q)(1)).subscribe((function(r){t.mModels[e]=r,delete t.mMaterialLoaders[e],n(r)}),(function(n){delete t.mMaterialLoaders[e],r(n)}))}))}},{key:"_getModelsFromAPI",value:function(e){var t=this;return new Promise((function(n,r){var o=e.map((function(e){return e in t.mModels?t.mModels[e]:e})),i=o.filter((function(e){return"number"!=typeof e})),a=o.filter((function(e){return"number"==typeof e}));a.length>0?f.O.getInstance().get("".concat(p.E.apiUrl,"material?id=").concat(a.join("|"))).then((function(e){return e.data.data.map((function(e){return t.mModels[e.id]=e,e}))}),(function(e){return[]})).then((function(e){n(i.concat(e))}),(function(e){r(e)})):n(i)}))}},{key:"preloadCatalogue",value:function(e){var t=this,n=s.F.isNumeric(e)?parseInt(e,10):null;return null===n?(0,a._)("Catalogue id is not an ID"):((0,l.isNullOrUndefined)(this.mDependencyLoaders[n])&&(this.mDependencyLoaders[n]=new i.t(1),y.qL.print("material resolve bootstrap data"),h.Q.getInstance().resolveBootstrapData(n).pipe((0,c.q)(1)).subscribe((function(e){var r=e.getMaterials(),o=d.FG.getItems(r);o.forEach((function(e){t.mModels[e.id]=e})),y.qL.print("bootstrap material pre load: ",o),t.mDependencyLoaders[n].next(!0)}),(function(e){y.qL.warn("Bootstrap material pre load failed",e),t.mDependencyLoaders[n].error(e),t.mDependencyLoaders[n]=null}))),this.mDependencyLoaders[n])}}])&&m(t.prototype,n),v&&m(t,v),Object.defineProperty(t,"prototype",{writable:!1}),e}();v._instance=null},48155:function(e,t,n){"use strict";n.d(t,{y:function(){return m}}),n(21249),n(57640),n(9924),n(47941),n(41539),n(15581),n(2490),n(34514),n(54747),n(88674),n(91058),n(69070),n(21703);var r=n(18170),o=n(63202),i=n(70456),a=n(64944),u=n(40486),c=n(84217),s=n(68009),l=n(89539),f=n(29844),p=n(28810),d=n(94130),h=n(79843);function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var m=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mModels={},this.mMediaLoaders={},this.mDependencyLoaders={}}var t,n,m;return t=e,m=[{key:"getInstance",value:function(){return null===this._instance&&(this._instance=new this),this._instance}}],(n=[{key:"getModels",value:function(){var e=this;return Object.keys(this.mModels).map((function(t){return e.mModels[t]}))}},{key:"resetCache",value:function(){return this.disposeCacheLoader(),this.mModels={},this}},{key:"disposeCacheLoader",value:function(){var e=this;Object.keys(this.mMediaLoaders).forEach((function(t){e.mMediaLoaders[t].error("disposed")})),this.mMediaLoaders={},Object.keys(this.mDependencyLoaders).forEach((function(t){e.mDependencyLoaders[t].error("disposed")})),this.mDependencyLoaders={}}},{key:"resolveModel",value:function(e){var t=this;return new Promise((function(n,o){if(!s.F.isNumeric(e))return o("requested id is not an integer: "+e);var i=parseInt(e,10);if(i in t.mModels)return n(t.mModels[i]);var a=Object.keys(t.mDependencyLoaders).map((function(e){return t.mDependencyLoaders[e].pipe((0,u.K)((function(e){return(0,r.of)([])})))}));t.finishDependencies(a).pipe((0,c.q)(1)).subscribe((function(){t._getModelFromAPI(i).then((function(e){n(e)}),(function(e){o(e)}))}))}))}},{key:"finishDependencies",value:function(e){return e.length>0?(0,o.aj)(e):(0,r.of)(!0)}},{key:"_getModelFromAPI",value:function(e){var t=this;return new Promise((function(n,r){if(e in t.mModels)return n(t.mModels[e]);e in t.mMediaLoaders||(t.mMediaLoaders[e]=new i.t(1),f.O.getInstance().get(p.E.apiUrl+"media/"+e).then((function(n){var r=n.data;t.mMediaLoaders[e].next(d.FG.getItem(r))}),(function(n){t.mMediaLoaders[e].error(n)}))),t.mMediaLoaders[e].pipe((0,c.q)(1)).subscribe((function(r){t.mModels[e]=r,delete t.mMediaLoaders[e],n(r)}),(function(n){delete t.mMediaLoaders[e],r(n)}))}))}},{key:"preloadCatalogue",value:function(e){var t=this,n=s.F.isNumeric(e)?parseInt(e,10):null;return null===n?(0,a._)("Catalogue id is not an ID"):((0,l.isNullOrUndefined)(this.mDependencyLoaders[n])&&(this.mDependencyLoaders[n]=new i.t(1),h.Q.getInstance().resolveBootstrapData(n).pipe((0,c.q)(1)).subscribe((function(e){var r=e.getMedia();d.FG.getItems(r).forEach((function(e){t.mModels[e.id]=e})),t.mDependencyLoaders[n].next(!0)}),(function(e){t.mDependencyLoaders[n].error(e),t.mDependencyLoaders[n]=null}))),this.mDependencyLoaders[n])}}])&&y(t.prototype,n),m&&y(t,m),Object.defineProperty(t,"prototype",{writable:!1}),e}();m._instance=null},51610:function(e,t,n){"use strict";n.d(t,{R:function(){return p}}),n(41539),n(15581),n(2490),n(34514),n(54747),n(47941),n(69070),n(21703),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(64944),o=n(70456),i=n(68009),a=n(46296),u=n(29844),c=n(28810),s=n(41142);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var p=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mLoader={}}var t,n,p;return t=e,p=[{key:"getInstance",value:function(){return null===this._instance&&(this._instance=new this),this._instance}}],(n=[{key:"resetCache",value:function(){return this.disposeCacheLoader(),this}},{key:"disposeCacheLoader",value:function(){var e=this;Object.keys(this.mLoader).forEach((function(t){e.mLoader[t].error("disposed")})),this.mLoader={}}},{key:"getSessionId",value:function(e){if(!(0,a.tO)())return null;var t="$$__xpv__product_session_".concat(e);return window.sessionStorage.getItem(t)}},{key:"setSessionId",value:function(e,t){if((0,a.tO)()){var n="$$__xpv__product_session_".concat(e);sessionStorage.setItem(n,t)}}},{key:"setMeta",value:function(e,t){var n="object"!=l(t)||Array.isArray(t)?{}:t;s.qL.print("loaded settings meta:",n),this.mLoader[e].next(n)}},{key:"requestMeta",value:function(e){var t=this,n=this.getSessionId(e),r={};null!=n&&(r["Product-Session-ID"]=n),u.O.getInstance().get(c.E.makeApiRoute("catalogue/".concat(e,"/meta")),{headers:r}).then((function(n){if(!n.data)throw"no data has been returned";var r=n.headers["Product-Session-ID"];void 0!==r&&t.setSessionId(e,r),t.setMeta(e,n.data)}),(function(n){t.mLoader[e].error(n),t.mLoader[e]=null}))}},{key:"resolveMeta",value:function(e){return i.F.isNumeric(e)?(this.mLoader[e]||(this.mLoader[e]=new o.t(1),this.requestMeta(e)),this.mLoader[e]):(0,r._)("Catalogue id is not an ID")}}])&&f(t.prototype,n),p&&f(t,p),Object.defineProperty(t,"prototype",{writable:!1}),e}();p._instance=null},3635:function(e,t,n){"use strict";n.d(t,{I:function(){return f}}),n(41539),n(15581),n(2490),n(34514),n(54747),n(47941),n(88674),n(68216),n(79433),n(21703),n(69070);var r=n(63438),o=n(29514),i=n(96381),a=n(2503),u=n(70456),c=n(89539),s=n(99556);function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var f=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mLoaderSubjects={},this.mResolveSubject=new u.t(1),this.mPipelines={},this.mRenderer=t,this.mResolveSubject.next(null)}var t,n;return t=e,n=[{key:"dispose",value:function(){var e=this;this.deactivatePipeline(),this.mResolveSubject.error("pipeline disposed"),Object.keys(this.mLoaderSubjects).forEach((function(t){e.mLoaderSubjects[t].error("pipeline disposed")})),this.mLoaderSubjects={},Object.keys(this.mPipelines).forEach((function(t){e.mPipelines[t].dispose()})),this.mPipelines={}}},{key:"_activatePipeline",value:function(e,t){var n=this;return Object.keys(this.mPipelines).forEach((function(e){var r=n.mPipelines[e];(0,c.isNullOrUndefined)(r.getActivePipelineUUID())||r.getActivePipelineUUID()===t||r.clearPipeline()})),this.preload(e),this.mLoaderSubjects[e].pipe((0,r.b)((function(e){return e.getActivePipelineUUID()!==t&&e.activatePipeline(t),e})),(0,o.P)())}},{key:"resolvePipeline",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.preload(e,t),this.mLoaderSubjects[e].pipe((0,o.P)())}},{key:"preload",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,c.isNullOrUndefined)(this.mPipelines[e])&&(this.mPipelines[e]=new a._(e,this.mRenderer)),((0,c.isNullOrUndefined)(this.mLoaderSubjects[e])||n)&&((0,c.isNullOrUndefined)(this.mLoaderSubjects[e])||this.mLoaderSubjects[e].error("forced to reload"),this.mLoaderSubjects[e]=new u.t(1),Promise.resolve(this.mPipelines[e]._resolvePipelines(n)).then((function(n){(0,c.isNullOrUndefined)(t.mLoaderSubjects[e])||t.mLoaderSubjects[e].next(n)}),(function(n){(0,c.isNullOrUndefined)(t.mLoaderSubjects[e])||(t.mLoaderSubjects[e].next(null),t.mLoaderSubjects[e].error(n))})))}},{key:"setActivePipeline",value:function(e,t){this.mResolveSubject.next({productId:e,pipelineId:t})}},{key:"_deactivatePipeline",value:function(){var e=this;Object.keys(this.mPipelines).every((function(t){var n=e.mPipelines[t];return!!(0,c.isNullOrUndefined)(n.getActivePipelineUUID())||(n.clearPipeline(),!1)}))}},{key:"deactivatePipeline",value:function(){this._deactivatePipeline(),this.mResolveSubject.next(null)}},{key:"resolveActivePipeline",value:function(){var e=this;return this.mResolveSubject.pipe((0,i.w)((function(t){if(!(0,c.isNullOrUndefined)(t))return e._activatePipeline(t.productId,t.pipelineId);throw new Error("empty pipeline")})),(0,r.b)((function(e){if(null!==e)return e;throw new Error("no active pipeline")})),(0,o.P)())}},{key:"saveAll",value:function(){var e=this;return new Promise((function(t,n){var r=[];Object.keys(e.mPipelines).forEach((function(t){var n=e.mPipelines[t];r.push((function(){return new Promise((function(e,t){Promise.resolve(n._resolvePipelines()).then((function(t){s.S.completePromise(t.savePipeline()).then((function(){e(!0)}))}),(function(e){return t(e)}))}))}))})),s.S.executeInOrder(r,(function(e,n){t(0===n.length)}))}))}}],n&&l(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},44795:function(e,t,n){"use strict";n.d(t,{Z:function(){return p}}),n(40561),n(41539),n(15581),n(2490),n(34514),n(54747),n(69826),n(31672),n(59461),n(47941),n(88674),n(69070),n(21703);var r=n(84217),o=n(39876),i=n(89539),a=n(70211),u=n(70456),c=n(29844),s=n(94130),l=n(79843);function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var p=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mLoadingObserver=null,this.onOffsetChanged=new a.xQ,this.onOffsetVisibility=new a.xQ,this.mProductId=t,this.mOffsets=new Array}var t,n;return t=e,n=[{key:"unload",value:function(){this.mOffsets.splice(0,this.mOffsets.length),null!==this.mLoadingObserver&&(this.mLoadingObserver.error("unloaded"),this.mLoadingObserver=null)}},{key:"_resolveOffsets",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return t&&null!==this.mLoadingObserver&&(this.mLoadingObserver=null),null===this.mLoadingObserver&&(this.mLoadingObserver=new u.t(1),l.Q.getInstance().resolveBootstrapData(+this.mProductId).pipe((0,r.q)(1)).subscribe((function(t){try{var n=t.getOffsetGroups(),r=s.FG.getItems(n);r.forEach((function(e){e.levels={},e.levels[0]=new THREE.Vector3(e.offset_vec_x,e.offset_vec_y,e.offset_vec_z),e.rotation=new THREE.Quaternion;try{(0,i.isString)(e.matrix)&&(e.matrix=JSON.parse(e.matrix))}catch(t){e.matrix=null}})),null!==e.mLoadingObserver&&(e.mOffsets=r,e.mLoadingObserver.next(e))}catch(t){e.mLoadingObserver.error(t)}}),(function(t){e.mLoadingObserver.error(t)}))),this.mLoadingObserver.pipe((0,o.B)())}},{key:"getOffsets",value:function(){return this.mOffsets}},{key:"getOffset",value:function(e){return this.mOffsets.find((function(t){return t.id==e}))}},{key:"getOffsetByGroup",value:function(e){return this.mOffsets.find((function(t){return t.offset_id===e}))}},{key:"getAbsoluteOffsetMatrix",value:function(e){var t=this.getOffset(e),n=(new THREE.Matrix4).identity();if(!(0,i.isNullOrUndefined)(t)){var r=new THREE.Vector3;Object.keys(t.levels).forEach((function(e){r.add(t.levels[e])}));var o=new THREE.Vector3,a=new THREE.Quaternion,u=new THREE.Vector3(1,1,1);t.matrix&&(new THREE.Matrix4).set(t.matrix[0],t.matrix[1],t.matrix[2],t.matrix[3],t.matrix[4],t.matrix[5],t.matrix[6],t.matrix[7],t.matrix[8],t.matrix[9],t.matrix[10],t.matrix[11],t.matrix[12],t.matrix[13],t.matrix[14],t.matrix[15]).decompose(o,a,u);var c=(new THREE.Matrix4).makeTranslation(o.x,o.y,o.z);n.multiply(c);var s=(new THREE.Matrix4).makeRotationFromQuaternion(a.multiply(t.rotation));n.multiply(s);var l=(new THREE.Matrix4).makeScale(u.x,u.y,u.z);n.multiply(l);var f=(new THREE.Matrix4).makeTranslation(r.x,r.y,r.z);n.premultiply(f)}return n}},{key:"getOffsetVector",value:function(e,t){var n=this.getOffset(e);if(!(0,i.isNullOrUndefined)(n))return(0,i.isNullOrUndefined)(n.levels[t])&&(n.levels[t]=new THREE.Vector3),n.levels[t]}},{key:"getOffsetRotation",value:function(e){var t=this.getOffset(e);if(!(0,i.isNullOrUndefined)(t))return t.rotation}},{key:"getOffsetVisibility",value:function(e){var t=this.getOffset(e);return t&&!1!==t.visible}},{key:"getOffsetVectorByGroup",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.getOffsetByGroup(e);if(!(0,i.isNullOrUndefined)(n))return this.getOffsetVector(n.id,t)}},{key:"setOffset",value:function(e,t,n){var r=this.getOffset(e);(0,i.isNullOrUndefined)(r)||(r.levels[t]=n),this.onOffsetChanged.next({id:e,matrix:this.getAbsoluteOffsetMatrix(e)})}},{key:"setOffsetRotation",value:function(e,t){var n=this.getOffset(e);(0,i.isNullOrUndefined)(n)||(n.rotation=t),this.onOffsetChanged.next({id:e,matrix:this.getAbsoluteOffsetMatrix(e)})}},{key:"hideOffsetNode",value:function(e){this.getOffset(e).visible=!1,this.onOffsetVisibility.next({id:e,visible:!1})}},{key:"showOffsetNode",value:function(e){this.getOffset(e).visible=!0,this.onOffsetVisibility.next({id:e,visible:!0})}},{key:"setOffsetByGroup",value:function(e,t,n){var r=this.getOffsetByGroup(e);(0,i.isNullOrUndefined)(r)||this.setOffset(r.id,t,n)}},{key:"saveOffsets",value:function(){var e=this;return new Promise((function(t,n){c.O.getInstance().patch("catalogue/"+e.mProductId+"/offset_groups/sync",{offsets:e.mOffsets}).then((function(r){r.updated?t(e):n("unknown server error")}),(function(e){n("connection error")}))}))}}],n&&f(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},23498:function(e,t,n){"use strict";n.d(t,{g:function(){return h}}),n(41539),n(15581),n(2490),n(34514),n(54747),n(47941),n(69070),n(21703);var r=n(29514),o=(n(88674),n(84217)),i=n(29844),a=n(28810),u=n(89539),c=n(70456),s=n(30082),l=n(51610);function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var p=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mMetaSubject=null,this.mUpdateData=!0,this.mCatalogueId=t}var t,n;return t=e,(n=[{key:"dispose",value:function(){null!==this.mMetaSubject&&this.mMetaSubject.error("disposed"),this.mMetaSubject=null,l.R.getInstance().resetCache()}},{key:"setCatalogueId",value:function(e){this.mCatalogueId=e,this.mUpdateData=!0}},{key:"loadAndObserve",value:function(){return this._preload(),this.mMetaSubject.pipe((0,r.P)())}},{key:"_preload",value:function(){var e=this;((0,u.isNullOrUndefined)(this.mMetaSubject)||this.mUpdateData)&&(this.mUpdateData=!1,(0,u.isNullOrUndefined)(this.mMetaSubject)||this.mMetaSubject.error("forced to reload"),this.mMetaSubject=new c.t(1),this._loadFromId(this.mCatalogueId).then((function(t){(0,u.isNullOrUndefined)(e.mMetaSubject)||e.mMetaSubject.next(t)}),(function(t){(0,u.isNullOrUndefined)(e.mMetaSubject)||(e.mMetaSubject.next(null),e.mMetaSubject.error(t))})))}},{key:"_loadFromId",value:function(e){return new Promise((function(t,n){(0,u.isNullOrUndefined)(e)?t({}):l.R.getInstance().resolveMeta(e).pipe((0,o.q)(1)).subscribe((function(e){t(e)}),(function(e){n(e)}))}))}},{key:"saveCatalogueSettings",value:function(e,t){return new Promise((function(n,r){var o=(new s.n).validateSettings(t);i.O.getInstance().put(a.E.makeApiRoute("catalogue/"+e+"/meta"),{scene_settings:o}).then((function(e){n(o)}),(function(e){r(e)}))}))}}])&&f(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var h=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mMetaSerializer={},this.mSettings={}}var t,n,o;return t=e,o=[{key:"getInstance",value:function(){return null===this._instance&&(this._instance=new this),this._instance}}],(n=[{key:"resolveCatalogueSettings",value:function(e){var t=this;return(0,u.isNullOrUndefined)(this.mSettings[e])&&(this.mSettings[e]=new c.t(1),this.mMetaSerializer[e]=new p(e),this.mMetaSerializer[e].loadAndObserve().subscribe((function(n){t.mSettings[e].next(new s.n(n))}),(function(n){t.mSettings[e].next(new s.n),t.mSettings[e].error(n)}))),this.mSettings[e].pipe((0,r.P)())}},{key:"disposeCatalogue",value:function(e){(0,u.isNullOrUndefined)(e)||(0,u.isNullOrUndefined)(this.mMetaSerializer[e])||(this.mMetaSerializer[e].dispose(),delete this.mMetaSerializer[e],delete this.mSettings[e])}},{key:"dispose",value:function(){var e=this;Object.keys(this.mMetaSerializer).forEach((function(t){e.disposeCatalogue(t)})),this.mMetaSerializer={},this.mSettings={}}}])&&d(t.prototype,n),o&&d(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();h._instance=null},41142:function(e,t,n){"use strict";n.d(t,{qL:function(){return c},vU:function(){return u}});var r=n(28810),o=Function.prototype.bind?Function.prototype.bind.call(console.log,console):function(){Function.prototype.apply.call(console.debug,console,arguments)},i=r.E.productionBuild?function(){}:Function.prototype.bind?Function.prototype.bind.call(console.log,console):function(){Function.prototype.apply.call(console.log,console,arguments)},a=r.E.productionBuild?function(){}:Function.prototype.bind?Function.prototype.bind.call(console.warn,console):function(){Function.prototype.apply.call(console.warn,console,arguments)},u=Function.prototype.bind?Function.prototype.bind.call(console.warn,console):function(){Function.prototype.apply.call(console.warn,console,arguments)},c={info:o,print:i,warn:a,error:u}},1762:function(){},96782:function(e,t,n){"use strict";n.d(t,{f:function(){return y}}),n(19601),n(91058),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(79618),o=n(90140),i=n(70211),a=n(89539);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(){return l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=f(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},l.apply(this,arguments)}function f(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}function p(e,t){return p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},p(e,t)}function d(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(f,e);var t,n,r,o,u=(r=f,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(r);if(o){var n=h(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return d(this,e)});function f(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};c(this,f),(n=u.call(this,e,t)).onEvents=new i.xQ;var o=Object.assign({title:"Title",margin:5,color:"#f06",hover:"#ca095e",fontSize:16,textColor:"#000000"},r);return n.mTitle=o.title,n.mMargin=o.margin,n.mColor=o.color,n.mHover=o.hover,n.mFontSize=o.fontSize,n.mTextColor=o.textColor,n._createButton(),n}return t=f,(n=[{key:"getType",value:function(){return f.TypeRTTI}},{key:"setValue",value:function(e,t){switch(e){case"title":return this.setTitle(t),!0;case"color":return(0,a.isUndefined)(t.isColor)?this.mColor=t:this.mColor="#"+t.getHexString(),this.setTitle(this.mTitle),!0;case"hover":return(0,a.isUndefined)(t.isColor)?this.mHover=t:this.mHover="#"+t.getHexString(),this.setTitle(this.mTitle),!0;case"textColor":return(0,a.isUndefined)(t.isColor)?this.mTextColor=t:this.mTextColor="#"+t.getHexString(),this.setTitle(this.mTitle),!0;case"fontSize":return this.mFontSize=parseInt(t,10),this.setTitle(this.mTitle),!0;case"margin":return this.mMargin=t,this.setTitle(this.mTitle),!0}return l(h(f.prototype),"setValue",this).call(this,e,t)}},{key:"getValue",value:function(e){switch(e){case"title":return this.mTitle;case"color":return this.mColor;case"hover":return this.mHover;case"textColor":return this.mTextColor;case"fontSize":return this.mFontSize;case"margin":return this.mMargin}return l(h(f.prototype),"getValue",this).call(this,e)}},{key:"setTitle",value:function(e){this.mTitle=e,this.mBtnElment.style.fontSize="".concat(this.mFontSize,"px"),this.mBtnElment.style.padding="".concat(this.mMargin,"px"),this.mBtnElment.innerText=this.mTitle,this.mBtnElment.style.backgroundColor=this.mColor,this.mBtnElment.style.color=this.mTextColor}},{key:"_createButton",value:function(){var e=this;this.mBtnElment=document.createElement("button"),this.mBtnElment.setAttribute("data-ui-type","button"),this.mBtnElment.type="button",this.mBtnElment.style.position="relative",this.mBtnElment.style.top="0px",this.mBtnElment.style.left="0px",this.mBtnElment.style.fontSize="".concat(this.mFontSize,"px"),this.mBtnElment.style.padding="".concat(this.mMargin,"px"),this.mBtnElment.style.backgroundColor=this.mColor,this.mBtnElment.style.color=this.mTextColor,this.mBtnElment.innerText=this.mTitle,this.mBtnElment.onmouseover=function(){e.mBtnElment.style.backgroundColor=e.mHover},this.mBtnElment.onmouseout=function(){e.mBtnElment.style.backgroundColor=e.mColor},this.mBtnElment.onclick=function(){e.onEvents.next({name:"click",data:e.getObjectId()})},this.domElement.appendChild(this.mBtnElment)}}])&&s(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(r.p);y.TypeRTTI=new o.r("ButtonUixObject",r.p.TypeRTTI)},95735:function(e,t,n){"use strict";n.d(t,{U:function(){return y}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(79618),o=n(90140),i=n(70211),a=n(89539);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(){return l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=f(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},l.apply(this,arguments)}function f(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}function p(e,t){return p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},p(e,t)}function d(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(f,e);var t,n,r,o,u=(r=f,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(r);if(o){var n=h(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return d(this,e)});function f(e,t,n){var r,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return c(this,f),(r=u.call(this,e,t)).onEvents=new i.xQ,r.mImagePath=n,r.mSize=new THREE.Vector2(o,a),r._createImage(),r}return t=f,(n=[{key:"getType",value:function(){return f.TypeRTTI}},{key:"setValue",value:function(e,t){switch(e){case"imagePath":return this.setImagePath(t),!0;case"size":return this.setImageSize(t.x,t.y),!0;case"width":return this.setImageSize(t,this.mSize.y),!0;case"height":return this.setImageSize(this.mSize.x,t),!0}return l(h(f.prototype),"setValue",this).call(this,e,t)}},{key:"getValue",value:function(e){switch(e){case"imagePath":return this.mImagePath;case"size":return this.mSize;case"width":return this.mSize.x;case"height":return this.mSize.y}return l(h(f.prototype),"getValue",this).call(this,e)}},{key:"setImagePath",value:function(e){this.mImagePath=e,(0,a.isNullOrUndefined)(this.mImage)||(this.mImage.src=e)}},{key:"setImageSize",value:function(e,t){this.mSize.set(e,t),(0,a.isNullOrUndefined)(this.mImage)||(this.mImage.style.width="".concat(e,"px"),this.mImage.style.height="".concat(t,"px"))}},{key:"_createImage",value:function(){var e=this;this.mImage=document.createElement("img"),this.mImage.setAttribute("data-ui-type","image"),this.mImage.src=this.mImagePath,this.mImage.style.position="relative",this.mImage.style.top="0px",this.mImage.style.left="0px",this.mSize.x>0&&this.setImageSize(this.mSize.x,this.mSize.y),this.mImage.onclick=function(){e.onEvents.next({name:"click",data:e.getObjectId()})},this.domElement.appendChild(this.mImage)}},{key:"makeEditable",value:function(){var e=this;return!!l(h(f.prototype),"makeEditable",this).call(this)&&((0,a.isUndefined)($(this.mImage).resizable("instance"))&&$(this.mImage).resizable({resize:function(t,n){e.onEdit.next({type:"resize",data:n.size})}}),!0)}},{key:"makeUnEditable",value:function(){(0,a.isUndefined)($(this.mImage).resizable("instance"))||$(this.mImage).resizable("destroy"),l(h(f.prototype),"makeUnEditable",this).call(this)}}])&&s(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(r.p);y.TypeRTTI=new o.r("ImageUixObject",r.p.TypeRTTI)},42139:function(e,t,n){"use strict";var r=n(1762);n.o(r,"AddObjectCommand")&&n.d(t,{AddObjectCommand:function(){return r.AddObjectCommand}}),n.o(r,"AppViewerComponent")&&n.d(t,{AppViewerComponent:function(){return r.AppViewerComponent}}),n.o(r,"SetPositionCommand")&&n.d(t,{SetPositionCommand:function(){return r.SetPositionCommand}}),n.o(r,"SetRotationCommand")&&n.d(t,{SetRotationCommand:function(){return r.SetRotationCommand}}),n(38217),n(79618),n(96782),n(95735),n(20128),n(61330),n(43814)},61330:function(e,t,n){"use strict";n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(20128),o=n(90140),i=n(89539);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(){return s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=l(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},s.apply(this,arguments)}function l(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}function f(e,t){return f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},f(e,t)}function p(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(l,e);var t,n,r,o,a=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=d(r);if(o){var n=d(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return p(this,e)});function l(){return u(this,l),a.apply(this,arguments)}return t=l,(n=[{key:"getType",value:function(){return l.TypeRTTI}},{key:"_createText",value:function(){var e=this._buildPanel();e.style.left="10px",this.mPolygonElement=document.createElement("div"),this.mPolygonElement.style.backgroundColor=this.mPanelColor,this.mPolygonElement.style.cssText="\n        position: relative;\n        top: 20px;\n        left: -10px;\n        width: 0;\n        height: 0;\n        border-top: 10px solid transparent;\n        border-bottom: 10px solid transparent;\n        border-right: 10px solid "+this.mPanelColor+";",e.appendChild(this.mPolygonElement),this.domElement.appendChild(e)}},{key:"setHtmlText",value:function(e){s(d(l.prototype),"setHtmlText",this).call(this,e)}},{key:"setValue",value:function(e,t){return"panelColor"===e?(s(d(l.prototype),"setValue",this).call(this,e,t),(0,i.isNullOrUndefined)(this.mPolygonElement)||(this.mPolygonElement.style.backgroundColor=this.mPanelColor),!0):s(d(l.prototype),"setValue",this).call(this,e,t)}}])&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r._);h.TypeRTTI=new o.r("PopupUixObject",r._.TypeRTTI)},43814:function(e,t,n){"use strict";n.d(t,{l:function(){return y}}),n(19601),n(91058),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(79618),o=n(90140),i=n(70211),a=n(89539);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(){return l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=f(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},l.apply(this,arguments)}function f(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}function p(e,t){return p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},p(e,t)}function d(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(f,e);var t,n,r,o,u=(r=f,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(r);if(o){var n=h(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return d(this,e)});function f(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};c(this,f),(n=u.call(this,e,t)).onEvents=new i.xQ;var o=Object.assign({title:"Title",margin:0,color:"#f06",hover:"#ca095e",fontSize:16,textColor:"#000000"},r);return n.mTitle=o.title,n.mMargin=o.margin,n.mColor=o.color,n.mHover=o.hover,n.mFontSize=o.fontSize,n.mTextColor=o.textColor,n._createTag(),n}return t=f,(n=[{key:"getType",value:function(){return f.TypeRTTI}},{key:"setValue",value:function(e,t){switch(e){case"title":return this.setTitle(t),!0;case"color":return(0,a.isUndefined)(t.isColor)?this.mColor=t:this.mColor="#"+t.getHexString(),this.setTitle(this.mTitle),!0;case"hover":return(0,a.isUndefined)(t.isColor)?this.mHover=t:this.mHover="#"+t.getHexString(),this.setTitle(this.mTitle),!0;case"textColor":return(0,a.isUndefined)(t.isColor)?this.mTextColor=t:this.mTextColor="#"+t.getHexString(),this.setTitle(this.mTitle),!0;case"fontSize":return this.mFontSize=parseInt(t,10),this.setTitle(this.mTitle),!0;case"margin":return this.mMargin=t,this.setTitle(this.mTitle),!0}return l(h(f.prototype),"setValue",this).call(this,e,t)}},{key:"getValue",value:function(e){switch(e){case"title":return this.mTitle;case"color":return this.mColor;case"hover":return this.mHover;case"textColor":return this.mTextColor;case"fontSize":return this.mFontSize;case"margin":return this.mMargin}return l(h(f.prototype),"getValue",this).call(this,e)}},{key:"setTitle",value:function(e){this.mTitle=e,this.mTextElement.style.fontSize="".concat(this.mFontSize,"px"),this.mTextElement.innerText=this.mTitle;var t=this.mTextElement.clientHeight+1,n=this.mTextElement.clientWidth+1+t+this.mMargin,r="".concat(n,"px");this.mTagElement.style.backgroundColor=this.mColor,this.mTagElement.style.color=this.mTextColor,this.mTagElement.style.width=r,this.mTagElement.style.height=r}},{key:"_createTag",value:function(){var e=this;this.mTextElement=document.createElement("div"),this.mTextElement.setAttribute("data-ui-type","tag-title"),this.mTextElement.innerText=this.mTitle,this.mTextElement.style.fontSize="".concat(this.mFontSize,"px"),this.mTextElement.style.position="absolute",this.mTextElement.style.top="0px",this.mTextElement.style.left="0px",this.mTextElement.style.visibility="hidden",this.mTextElement.style.display="block",document.body.appendChild(this.mTextElement);var t=this.mTextElement.offsetHeight+1,n=this.mTextElement.offsetWidth+1+t+this.mMargin,r="".concat(n,"px");document.body.removeChild(this.mTextElement),this.mTextElement.style.position="relative",this.mTextElement.style.visibility="",this.mTextElement.style.display="",this.mTagElement=document.createElement("div"),this.mTagElement.setAttribute("data-ui-type","tag"),this.mTagElement.style.position="relative",this.mTagElement.style.top="0px",this.mTagElement.style.left="0px",this.mTagElement.style.width=r,this.mTagElement.style.height=r,this.mTagElement.style.backgroundColor=this.mColor,this.mTagElement.style.borderRadius="50%",this.mTagElement.style.display="flex",this.mTagElement.style.justifyContent="center",this.mTagElement.style.alignItems="center",this.mTagElement.appendChild(this.mTextElement),this.mTagElement.onmouseover=function(){e.mTagElement.style.backgroundColor=e.mHover},this.mTagElement.onmouseout=function(){e.mTagElement.style.backgroundColor=e.mColor},this.mTagElement.onclick=function(){e.onEvents.next({name:"click",data:e.getObjectId()})},this.domElement.appendChild(this.mTagElement)}}])&&s(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(r.p);y.TypeRTTI=new o.r("TagUixObject",r.p.TypeRTTI)},20128:function(e,t,n){"use strict";n.d(t,{_:function(){return y}}),n(19601),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(74819),n(38880),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(79618),o=n(90140),i=n(70211),a=n(89539);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(){return l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=f(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},l.apply(this,arguments)}function f(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}function p(e,t){return p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},p(e,t)}function d(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(f,e);var t,n,r,o,u=(r=f,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(r);if(o){var n=h(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return d(this,e)});function f(e,t,n){var r,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};c(this,f),(r=u.call(this,e,t)).onEvents=new i.xQ;var a=Object.assign({panelColor:"#f06",linkColor:"#00f",linkHover:"#0000a0",margin:20,width:150,height:200},o);return r.mHtmlText=n,r.mPanelColor=a.panelColor,r.mMargin=a.margin,r.mSize=new THREE.Vector2(a.width,a.height),r._createText(),r}return t=f,(n=[{key:"getType",value:function(){return f.TypeRTTI}},{key:"_createText",value:function(){var e=this._buildPanel();this.domElement.appendChild(e)}},{key:"setValue",value:function(e,t){switch(e){case"htmlText":case"text":return this.setHtmlText(t),!0;case"panelColor":return(0,a.isUndefined)(t.isColor)?this.mPanelColor=t:this.mPanelColor="#"+t.getHexString(),(0,a.isNullOrUndefined)(this.mPanelElement)||(this.mPanelElement.style.backgroundColor=this.mPanelColor),!0;case"margin":return this.setMargin(t),!0;case"size":return this.setSize(t.x,t.y),!0;case"width":return this.setSize(t,this.mSize.y),!0;case"height":return this.setSize(this.mSize.x,t),!0}return l(h(f.prototype),"setValue",this).call(this,e,t)}},{key:"getValue",value:function(e){switch(e){case"htmlText":case"text":return this.mHtmlText;case"panelColor":return this.mPanelColor;case"margin":return this.mMargin;case"size":return this.mSize;case"width":return this.mSize.x;case"height":return this.mSize.y}return l(h(f.prototype),"getValue",this).call(this,e)}},{key:"setHtmlText",value:function(e){this.mHtmlText=e,this.mTextElement.innerHTML=e}},{key:"setMargin",value:function(e){this.mMargin=e,(0,a.isNullOrUndefined)(this.mPanelElement)||(this.mPanelElement.style.padding="".concat(this.mMargin,"px"))}},{key:"setSize",value:function(e,t){this.mSize.set(e,t),(0,a.isNullOrUndefined)(this.mPanelElement)||(this.mPanelElement.style.width="".concat(e,"px"),this.mPanelElement.style.height="".concat(t,"px"))}},{key:"_buildPanel",value:function(){return this.mPanelElement=document.createElement("div"),this.mPanelElement.setAttribute("data-ui-type","text-panel"),this.mPanelElement.style.backgroundColor=this.mPanelColor,this.mPanelElement.style.padding="".concat(this.mMargin,"px"),this.mPanelElement.style.position="relative",this.mPanelElement.style.top="0px",this.mPanelElement.style.left="0px",this.mPanelElement.style.width="".concat(this.mSize.x,"px"),this.mPanelElement.style.height="".concat(this.mSize.y,"px"),this.mTextElement=document.createElement("div"),this.mTextElement.setAttribute("data-ui-type","text-content"),this.mTextElement.style.width="100%",this.mTextElement.style.height="100%",this.mTextElement.style.overflow="auto",this.mTextElement.innerHTML=this.mHtmlText,this.mPanelElement.appendChild(this.mTextElement),this.mPanelElement}},{key:"makeEditable",value:function(){var e=this;return!!l(h(f.prototype),"makeEditable",this).call(this)&&((0,a.isUndefined)($(this.mPanelElement).resizable("instance"))&&$(this.mPanelElement).resizable({resize:function(t,n){e.onEdit.next({type:"resize",data:n.size})}}),!0)}},{key:"makeUnEditable",value:function(){(0,a.isUndefined)($(this.mPanelElement).resizable("instance"))||$(this.mPanelElement).resizable("destroy"),l(h(f.prototype),"makeUnEditable",this).call(this)}}])&&s(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(r.p);y.TypeRTTI=new o.r("TextUixObject",r.p.TypeRTTI)},38217:function(e,t,n){"use strict";n.d(t,{K:function(){return u}}),n(69070),n(21703);var r=n(89539),o=n(70211),i=n(41142);function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mWidth=2,this.mHeight=2,this.onUiSelected=new o.xQ,this.renderDom=document.createElement("div"),this.renderDom.style.position="absolute",this.renderDom.style.top="1px",this.renderDom.style.left="1px",this.renderDom.style.zIndex="1",this.renderDom.style.width="1px",this.renderDom.style.height="1px",this.renderDom.setAttributeNS(null,"id","svg_renderdom")}var t,n;return t=e,(n=[{key:"dispose",value:function(){(0,r.isNullOrUndefined)(this.renderDom.parentNode)||this.renderDom.parentNode.removeChild(this.renderDom)}},{key:"add",value:function(e){i.qL.print("renderer append child:",e),this.renderDom.appendChild(e)}},{key:"remove",value:function(e){i.qL.print("renderer remove child:",e),this.renderDom.removeChild(e)}},{key:"enableEvents",value:function(){this.renderDom.style.pointerEvents="auto"}},{key:"disableEvents",value:function(){this.renderDom.style.pointerEvents="none"}},{key:"eventsEnabled",value:function(){return"all"===this.renderDom.style.pointerEvents}},{key:"getSize",value:function(){return{width:this.mWidth,height:this.mHeight}}},{key:"resize",value:function(e,t){this.mWidth=e,this.mHeight=t}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},79618:function(e,t,n){"use strict";n.d(t,{p:function(){return d}}),n(41539),n(88674),n(66342),n(62962),n(2490),n(23748),n(69826),n(31672),n(59461),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(78842),o=n(90140),i=n(89539),a=n(70211);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},s(e,t)}function l(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return f(e)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(d,e);var t,n,r,o,u=(r=d,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=p(r);if(o){var n=p(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return l(this,e)});function d(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(n=u.call(this)).onEdit=new a.xQ,n.userData={},n.mPositionType="fixed",n.mPosition=new THREE.Vector3,n.mLocked=!1,n.mEditting=!1,n.uiRenderer=t,n.mSceneObject=e,n.domElement=document.createElement("div"),n.domElement.style.position="absolute",n.domElement.style.top="0px",n.domElement.style.left="0px",n.domElement.addEventListener("click",(function(){n.uiRenderer.onUiSelected.next(f(n))}),!1),n}return t=d,(n=[{key:"getType",value:function(){return d.TypeRTTI}},{key:"dispose",value:function(){(0,i.isNullOrUndefined)(this.domElement.parentNode)||this.domElement.parentNode.removeChild(this.domElement)}},{key:"getSceneObject",value:function(){return this.mSceneObject}},{key:"isObjectUI",get:function(){return!0}},{key:"update",value:function(e){var t=this.uiRenderer.getSize();if("projection"===this.mPositionType){var n=this.mPosition.clone().project(e);n.x=(n.x+1)/2*t.width,n.y=-(n.y-1)/2*t.height,n.x=n.x>t.width?t.width:n.x<0?0:n.x,n.y=n.y>t.height?t.height:n.y<0?0:n.y,this.domElement.style.top="".concat(n.y,"px"),this.domElement.style.left="".concat(n.x,"px")}}},{key:"setValue",value:function(e,t){switch(e){case"position_type":return this.positionType=t,!0;case"position":return this.position=t,!0;case"locked":return this.locked=t,!0}return!1}},{key:"getValue",value:function(e){switch(e){case"position_type":return this.positionType;case"position":return this.position;case"locked":return this.locked}}},{key:"position",get:function(){return this.mPosition},set:function(e){var t=e.toArray();this.mPosition.x=t[0],this.mPosition.y=t[1],!0===e.isVector3&&(this.mPosition.z=t[2]),this.domElement.style.top="".concat(this.mPosition.y,"px"),this.domElement.style.left="".concat(this.mPosition.x,"px")}},{key:"positionType",get:function(){return this.mPositionType},set:function(e){this.mPositionType=e}},{key:"element",get:function(){return this.domElement}},{key:"locked",get:function(){return this.mLocked},set:function(e){var t=this.mLocked;this.mLocked=e,t&&!e?this.makeEditable():!t&&e&&this.makeUnEditable()}},{key:"add",value:function(e){this.element.appendChild(e)}},{key:"remove",value:function(e){this.element.removeChild(e)}},{key:"hasParent",value:function(){return!(0,i.isNullOrUndefined)(this.domElement.parentNode)}},{key:"makeEditable",value:function(){var e=this;if(!this.hasParent())return!1;if(this.mEditting=!0,this.locked)return!1;var t=$(this.domElement);(0,i.isUndefined)(t.draggable("instance"))&&t.draggable({drag:function(t,n){e.onEdit.next({type:"drag",data:n.position})}});var n=t.find("#highlight_selected");return 0===n.length&&((n=$("<div></div>").attr("id","highlight_selected")).css({width:"100%",height:"100%",position:"absolute",top:"0px",left:"0px",border:"2px solid yellow"}),t.append(n)),!0}},{key:"makeUnEditable",value:function(){if(this.mEditting=!1,this.hasParent()){var e=$(this.domElement);(0,i.isUndefined)(e.draggable("instance"))||e.draggable("destroy");var t=e.find("#highlight_selected");0!==t.length&&t.remove()}}}])&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),d}(r.L);d.TypeRTTI=new o.r("UixObject",r.L.TypeRTTI)},94130:function(e,t,n){"use strict";n.d(t,{FG:function(){return a}}),n(21249),n(57640),n(9924),n(57327),n(41539),n(88449),n(2490),n(59849),n(15581),n(34514),n(54747),n(47941),n(69600),n(74916),n(23123),n(69826),n(31672),n(59461),n(9653);var r=n(89539);function o(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if((0,r.isNullOrUndefined)(e))return null;var u=e.attributes,c=e.relationships||{};return Object.keys(c).forEach((function(e){var s=e;n&&(s=s.split(/(?=[A-Z])/).map((function(e){return e.toLowerCase()})).join("_"));var l=Array.isArray(c[e].data),f=l?c[e].data:[c[e].data],p=void 0!==a[e]?a[e]:s;u[p]=f.map((function(e){var u=t.find((function(t){return t.id===e.id&&t.type===e.type}));return(0,r.isUndefined)(u)?null:i<=0?u.attributes:o(u,t,n,i-1,a)})).filter((function(e){return!(0,r.isNullOrUndefined)(e)})),l||(u[p]=u[p][0])})),u}function i(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if((0,r.isNullOrUndefined)(e)||(0,r.isNullOrUndefined)(e.data))return null;var a=(0,r.isNullOrUndefined)(e.included)?[]:e.included;return Array.isArray(e.data)?e.data.map((function(e){return o(e,a,t,n,i)})):o(e.data,a,t,n,i)}var a={getItems:function(e){return(0,r.isUndefined)(e.data)?[]:e.data.map((function(e){return e.attributes}))},getItem:function(e){if(!(0,r.isUndefined)(e.data))return e.data.attributes},getIncludedItems:function(e,t){return(0,r.isUndefined)(e.included)?[]:e.included.filter((function(e){return e.type===t})).map((function(e){return e.attributes}))},getItemsWithRelations:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return i(e,t,n,r)},hydrateResponse:i,getIncludedItemsWithRelations:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if((0,r.isUndefined)(e.included))return[];var i=e.included||[];return i.map((function(e){if(e.type===t){var a=e.attributes||[],u=e.relationships||{};return Object.keys(u).forEach((function(t){var u=t;n&&(u=t.split(/(?=[A-Z])/).map((function(e){return e.toLowerCase()})).join("_"));var c=void 0!==o[t]?o[t]:u;a[c]=e.relationships[t].data.map((function(e){var t=i.find((function(t){return t.id===e.id&&t.type===e.type}));return(0,r.isUndefined)(t)?null:t.attributes})).filter((function(e){return!(0,r.isNullOrUndefined)(e)}))})),a}})).filter((function(e){return!(0,r.isNullOrUndefined)(e)}))},getMetaCursor:function(e){return(0,r.isUndefined)(e.meta.cursor)?0:Number(e.meta.cursor.current)},getMetaTotalCount:function(e){if(!(0,r.isUndefined)(e.meta.total_count))return e.meta.total_count}}},46296:function(e,t,n){"use strict";function r(){try{if(window.location.href===window.parent.location.href)return!1}catch(e){}return!0}function o(){try{return window.sessionStorage.getItem("foo"),!0}catch(e){return!1}}n.d(t,{tO:function(){return o},zd:function(){return r}})},89002:function(e,t,n){"use strict";n.d(t,{F:function(){return u}}),n(41539),n(39714),n(74916),n(15306),n(9653),n(66992),n(82472),n(48675),n(92990),n(18927),n(33105),n(35035),n(74345),n(7174),n(32846),n(44731),n(77209),n(96319),n(58867),n(37789),n(33739),n(29368),n(14483),n(12056),n(3462),n(30678),n(27462),n(33824),n(55021),n(12974),n(15016),n(8922),n(37380),n(1118),n(5835),n(23767),n(8585),n(8970),n(84444),n(68696),n(77601),n(91058),n(69070),n(21703);var r=n(89539),o=n(84758);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=window.crypto||window.msCrypto,u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"guid",value:function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}},{key:"uuidV4",value:function(){return a?"10000000-1000-4000-8000-100000000000".replace(/[018]/g,(function(e){return(Number(e)^a.getRandomValues(new Uint8Array(1))[0]&15>>Number(e)/4).toString(16)})):"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}},{key:"isUUID",value:function(e){return!(0,r.isNullOrUndefined)(e)&&/(.*)-(.*)-(.*)/.test(e)}},{key:"Md5",value:function(e){return o.V.hashStr(e).toString()}},{key:"encrypt",value:function(e,t){for(var n="",r=0;r<e.length;r++){var o=(e.charCodeAt(r)^t.charCodeAt(r%t.length)).toString(16);o.length<2&&(o="0"+o),n+=o}return n}},{key:"decrypt",value:function(e,t){for(var n="",r=0;r<e.length;r+=2){var o=e.substring(r,r+2),i=parseInt(o,16),a=t.charCodeAt(r/2%t.length);n+=String.fromCharCode(i^a)}return n}}],null&&i(t.prototype,null),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},59342:function(e,t,n){"use strict";n.d(t,{M:function(){return i}}),n(60086),n(69070),n(21703);var r=n(68009);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"LookAt",value:function(e,t){var n=new THREE.Quaternion,r=new THREE.Matrix4,o=new THREE.Vector3,i=new THREE.Vector3;o.copy(t);var a=e.parent;this.UpdateWorldMatrix(e,!0,!1),i.setFromMatrixPosition(e.matrixWorld),e.isCamera||e.isLight?r.lookAt(i,o,e.up):r.lookAt(o,i,e.up),e.quaternion.setFromRotationMatrix(r),a&&(r.extractRotation(a.matrixWorld),n.setFromRotationMatrix(r),e.quaternion.premultiply(n.inverse()))}},{key:"UpdateWorldMatrix",value:function(e,t,n){var r=e.parent;if(!0===t&&null!==r&&this.UpdateWorldMatrix(r,!0,!1),e.matrixAutoUpdate&&e.updateMatrix(),null===e.parent?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(e.parent.matrixWorld,e.matrix),!0===n)for(var o=e.children,i=0,a=o.length;i<a;i++)this.UpdateWorldMatrix(o[i],!1,!0)}},{key:"Arctangent",value:function(e,t,n,r){var o=r-t,i=n-e,a=Math.atan2(o,i);return(a*=180/Math.PI)<0&&(a=360+a),a}},{key:"AngleTwoLines",value:function(e,t,n,r,o,i){var a=e-n,u=t-r,c=o-n,s=i-n,l=a*c+u*s,f=Math.sqrt(a*a+u*u)*Math.sqrt(c*c+s*s);return Math.acos(l/f)}},{key:"AngleOfTwoPoints",value:function(e,t,n,r){var o=n-e,i=r-t;return-Math.atan2(i,o)}},{key:"Clamp",value:function(e,t,n,o){return r.F.isNumeric(e)?e>n?n:e<t?t:e:o}},{key:"RotateBasedOnUpAxis",value:function(t,n){var r=new THREE.Vector3(0,1,0).applyQuaternion(t),o=n.dot(r);if(Math.abs(o)>1-e.EPS)return t;var i=Math.acos(o),a=r.cross(n).normalize();return(new THREE.Quaternion).setFromAxisAngle(a,i).multiply(t)}},{key:"Vec2Cross",value:function(e,t){return e.x*t.y-e.y*t.x}},{key:"LineLineIntersection",value:function(e,t,n,r){var o=t.clone().sub(e),i=r.clone().sub(n),a=this.Vec2Cross(n.clone().sub(e),o),u=this.Vec2Cross(o,i);if(0==a&&0==u)return!!(e.equals(n)||e.equals(r)||t.equals(n)||t.equals(r))||!(n.x-e.x<0&&n.x-t.x<0&&r.x-e.x<0&&r.x-t.x<0&&n.y-e.y<0&&n.y-t.y<0&&r.y-e.y<0&&r.y-t.y<0);if(u===this.EPS)return!1;var c=a/u,s=this.Vec2Cross(n.clone().sub(e),i)/u;return s>=0&&s<=1&&c>=0&&c<=1}}],null&&o(t.prototype,null),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();i.EPS=1e-6},99556:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.d(t,{S:function(){return o}}),n(41539),n(88674),n(69070),n(21703);var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"resolveArray",value:function(e,t){var n=this,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(0!==e.length){var o=e.shift();Promise.resolve(o).then((function(o){n.resolveArray(e,t,r)}),(function(r){n.resolveArray(e,t,!1)}))}else t(r)}},{key:"executeInOrder",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Array,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new Array;if(0===e.length||r&&i.length>0)t(o,i);else{var a=e.shift();Promise.resolve(a()).then((function(a){o.push(a),n.executeInOrder(e,t,r,o,i)}),(function(a){i.push(a),n.executeInOrder(e,t,r,o,i)}))}}},{key:"completePromise",value:function(e){return new Promise((function(t){Promise.resolve(e).then((function(e){t(e)}),(function(e){t()}))}))}}],null&&r(t.prototype,null),n&&r(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},4192:function(e,t,n){"use strict";function r(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.d(t,{W:function(){return i}}),n(35666),n(41539),n(88674),n(69070),n(21703);var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i,a;return t=e,null,n=[{key:"loadScript",value:(i=regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n in e.scriptPromises)){t.next=2;break}return t.abrupt("return",e.scriptPromises[n]);case 2:return e.scriptPromises[n]=new Promise((function(e){var t=document.createElement("script");t.crossOrigin="anonymous";var r=function(){e()};if(t.readyState){var o=t;o.onreadystatechange=function(){"loaded"!==o.readyState&&"complete"!==o.readyState||(o.onreadystatechange=null,r())}}else t.onload=r;t.src=n,document.head.appendChild(t)})),t.abrupt("return",e.scriptPromises[n]);case 4:case"end":return t.stop()}}),t)})),a=function(){var e=this,t=arguments;return new Promise((function(n,o){var a=i.apply(e,t);function u(e){r(a,n,o,u,c,"next",e)}function c(e){r(a,n,o,u,c,"throw",e)}u(void 0)}))},function(e){return a.apply(this,arguments)})}],n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();i.scriptPromises={}},68009:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}n.d(t,{F:function(){return o}}),n(54678),n(66992),n(41539),n(78783),n(33948),n(60285),n(41637),n(21703),n(9653),n(21249),n(57640),n(9924),n(15581),n(2490),n(34514),n(54747),n(47941),n(74916),n(15306),n(73210),n(26699),n(32023),n(4723),n(39714),n(83112),n(92222),n(82526),n(41817),n(32165);var o={isNumeric:function(e){return null!==e&&!isNaN(parseFloat(e))&&isFinite(e)},lowerCaseString:function(e){return null===e?null:void 0===e?e:e.toLowerCase()},isTrue:function(e){return!0===e||"1"==e||"true"===e},isString:function(e){return e&&"string"==typeof e},isNonEmptyString:function(e){return"string"==typeof e&&e.length>0},isValidURL:function(e){if(!e)return!1;try{if("data:"===new window.URL(e).protocol)throw new Error("Base64 url")}catch(e){return!1}return!0},isBase64:function(e){if(!e)return!1;try{if("data:"===new window.URL(e).protocol)return!0}catch(e){return!1}return!1},makeUrlUnique:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"uhash";if(!o.isNonEmptyString(e)||!o.isValidURL(e))return e;var n=new window.URL(e);return n.searchParams.set(t,"".concat(Date.now())),n.href},isArray:function(e){return e&&"[object Array]"===Object.prototype.toString.call(e)},deepCloneJSON:function(e){if("object"!==r(e)||null===e)return e;if(e instanceof Number)return Number(e);if(e instanceof Boolean)return Boolean(e);if(e instanceof String)return String(e);if(Array.isArray(e))return e.map((function(e){return o.deepCloneJSON(e)}));var t={};return Object.keys(e).forEach((function(n){t[n]=o.deepCloneJSON(e[n])})),t},stringToDate:function(e){if(!isNaN(Date.parse(e)))return new Date(e);var t=e.trim().replace(/[/\\]/g,"-");return t.length>10&&(t.includes("T")||(t=t.replace(/\s/g,"T")),t.includes("+")||t.match(/T.*Z$/g)||(t+="Z")),new Date(t)},dateToString:function(e){if(e){var t=e.getFullYear().toString(),n=(e.getMonth()+1).toString().padStart(2,"0"),r=e.getDate().toString().padStart(2,"0"),o=e.getHours().toString().padStart(2,"0"),i=e.getMinutes().toString().padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(r," ").concat(o,":").concat(i,":00")}}}},66092:function(e,t,n){"use strict";var r=n(16957),o=(n(98919),n(73915),n(7349),n(41539),n(15581),n(2490),n(34514),n(54747),n(40561),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948),n(63438)),i=n(3283),a=n(90140),u=n(73010),c=n(70211),s=n(14311),l=n(38531),f=n(89539),p=n(41142);function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t){return m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},m(e,t)}function v(e,t){if(t&&("object"===d(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function b(e){return b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},b(e)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(g,e);var t,n,r,a,d=(r=g,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=b(r);if(a){var n=b(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return v(this,e)});function g(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e4,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4?arguments[4]:void 0;return h(this,g),(e=d.call(this,"controls")).mSubscriptions=new Array,e.mTransformChanged=!1,e.onControlsChanged=function(t){e.mControlChange.next(),e.getViewportRenderer().dispatchMessage(new u.c),e.getViewportRenderer().getEditor().dispatchEvent(s.G.RequestFrame)},e.mMaxZoom=t,e.mMinZoom=n,e.mPanDisabled=r,e.mLockUpVector=o,e.mTargetVector=i,e}return t=g,(n=[{key:"getType",value:function(){return g.TypeRTTI}},{key:"setMaxZoom",value:function(e){this.mMaxZoom=e,(0,f.isNullOrUndefined)(this.mEditorControls)||(this.mEditorControls.maxZoom=this.mMaxZoom)}},{key:"setMinZoom",value:function(e){this.mMinZoom=e,(0,f.isNullOrUndefined)(this.mEditorControls)||(this.mEditorControls.minZoom=this.mMinZoom)}},{key:"setPanDisabled",value:function(e){this.mPanDisabled=e,(0,f.isNullOrUndefined)(this.mEditorControls)||(this.mEditorControls.disablePan=this.mPanDisabled)}},{key:"setLockUpVector",value:function(e){this.mLockUpVector=e,(0,f.isNullOrUndefined)(this.mEditorControls)||(this.mEditorControls.lockUpVector=this.mLockUpVector)}},{key:"enabled",value:function(e){this.mEditorControls&&(this.mEditorControls.enabled=e)}},{key:"OnAttached",value:function(){var e=this,t=this.getViewportRenderer().getEditor();this.mEditorControls=new THREE.EditorControls(t.getCamera(),t.getRenderer().domElement,this.mTargetVector),this.mEditorControls.maxZoom=this.mMaxZoom,this.mEditorControls.minZoom=this.mMinZoom,this.mEditorControls.disablePan=this.mPanDisabled,this.mEditorControls.lockUpVector=this.mLockUpVector,this.mEditorControls.addEventListener("change",this.onControlsChanged),this.registerMessageHandler(l.c.TypeRTTI,(function(){e.mCamAnimate.next()})),this.mControlChange=new c.xQ;var n=this.mControlChange.pipe((0,o.b)((function(){e.getViewportRenderer().getEditor().getUiRenderer().disableEvents()})),(0,i.b)(300)).subscribe((function(){e.getViewportRenderer().getEditor().getUiRenderer().enableEvents()}));this.mSubscriptions.push(n),this.mCamAnimate=new c.xQ;var r=this.mCamAnimate.pipe((0,o.b)((function(){e.mEditorControls.enabled=!1})),(0,i.b)(100)).subscribe((function(){e.mEditorControls.enabled=!0,e.mEditorControls.reset()}));this.mSubscriptions.push(r);var a=t.observeEvents(s.G.TransformControlChanged).pipe((0,o.b)((function(){e.mTransformChanged=!0,e.mEditorControls.enabled=!1})),(0,i.b)(3e3)).subscribe((function(){}));this.mSubscriptions.push(a);var u=t.observeEvents(s.G.TransformControlLock).subscribe((function(){e.mTransformChanged=!1,e.mEditorControls.enabled=!1,e.mControlChange.next(),setTimeout((function(){e.mTransformChanged||(p.qL.warn("did not change, reset"),e.mEditorControls.enabled=!0)}),1e3)}));this.mSubscriptions.push(u);var f=t.observeEvents(s.G.TransformControlUnLock).subscribe((function(){e.mEditorControls.enabled=!0}));this.mSubscriptions.push(f)}},{key:"OnDetached",value:function(){this.mEditorControls.removeEventListener("change",this.onControlsChanged),this.mEditorControls.dispose(),this.mEditorControls=null,this.unregisterMessageHandler(l.c.TypeRTTI),this.mSubscriptions.splice(0).forEach((function(e){return e.unsubscribe()}))}}])&&y(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),g}(r.V);function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function O(e,t){return O=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},O(e,t)}function T(e,t){if(t&&("object"===w(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function R(e){return R=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},R(e)}g.TypeRTTI=new a.r("ViewportControllerEditorControls",r.V.TypeRTTI),(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=R(r);if(o){var n=R(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return T(this,e)});function a(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(e=i.call(this,"helpers"))._subscriptions=new Array,e.objectSelectedHandler=function(t){e.mSelectionBox.visible=!1;var n=(0,f.isNullOrUndefined)(t.getData())?null:t.getData().selection;(0,f.isNullOrUndefined)(n)||!0!==n.isObject3D||n===e.mEditor.getScene()||(e.mBox.setFromObject(n),!e.mBox.isEmpty()&&e.isBoxValid(e.mBox)&&(e.mSelectionBox.setFromObject(n),e.mSelectionBox.update(),e.mSelectionBox.visible=!0),e.updateHelpers(n))},e.objectChangedHandler=function(t){var n=t.getData().object;!0===n.isObject3D&&(e.updateHelpers(n),n instanceof THREE.PerspectiveCamera&&n.updateProjectionMatrix())},e.transformControlHandler=function(t){var n=t.getData();if((0,f.isNullOrUndefined)(n))p.qL.warn("transform control handle no data!");else{var r=n.object;if(!(0,f.isNullOrUndefined)(r)){var o=e.mEditor.getSelectedObject();!0!==r.isLight&&((0,f.isNullOrUndefined)(o)||(0,f.isNullOrUndefined)(o.target)||o.target.id!==r.id)||e.updateHelpers(r)}}},e}return t=a,(n=[{key:"getType",value:function(){return a.TypeRTTI}},{key:"OnAttached",value:function(){this.mEditor=this.getViewportRenderer().getEditor(),this._subscriptions.push(this.mEditor.observeEvents(s.G.ObjectSelected).subscribe(this.objectSelectedHandler),this.mEditor.observeEvents(s.G.ObjectChanged).subscribe(this.objectChangedHandler),this.mEditor.observeEvents(s.G.ObjectTargetChanged).subscribe(this.objectChangedHandler),this.mEditor.observeEvents(s.G.TransformControlChanged).subscribe(this.transformControlHandler)),this.mGrid=new THREE.GridHelper(60,60),this.mEditor.getSceneHelpers().add(this.mGrid),this.mBox=new THREE.Box3,this.mSelectionBox=new THREE.BoxHelper,this.mSelectionBox.material.depthTest=!1,this.mSelectionBox.material.transparent=!0,this.mSelectionBox.visible=!1,this.mEditor.getSceneHelpers().add(this.mSelectionBox),this.mEditor.getScene().background=new THREE.Color(11184810)}},{key:"OnDetached",value:function(){this._subscriptions.splice(0).forEach((function(e){return e.unsubscribe()})),this.mGrid.parent.remove(this.mGrid),this.mGrid.geometry.dispose(),this.mSelectionBox.parent.remove(this.mSelectionBox),this.mSelectionBox.geometry.dispose()}},{key:"updateHelpers",value:function(e){if(void 0!==e){this.mSelectionBox.update(),(0,f.isNullOrUndefined)(this.mEditor.helpers[e.id])||this.mEditor.helpers[e.id].update();var t=this.mEditor.getSelectedObject();(0,f.isNullOrUndefined)(t)||(0,f.isNullOrUndefined)(t.target)||t.target.id!==e.id||(0,f.isNullOrUndefined)(this.mEditor.helpers[t.id])||this.mEditor.helpers[t.id].update()}}},{key:"isBoxValid",value:function(e){return!(isNaN(e.min.x)||isNaN(e.min.y)||isNaN(e.min.z)||isNaN(e.max.x)||isNaN(e.max.y)||isNaN(e.max.z))}}])&&_(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(r.V)).TypeRTTI=new a.r("ViewportControllerEditorHelpers",r.V.TypeRTTI),n(92403);var S=n(74920),E=n(20490);function P(e){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P(e)}function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function j(e,t){return j=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},j(e,t)}function C(e,t){if(t&&("object"===P(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function k(e){return k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},k(e)}var M=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&j(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=k(r);if(o){var n=k(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return C(this,e)});function a(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(e=i.call(this,"transforms"))._subscriptions=new Array,e.mTransformTargetMode=0,e.mTransformComponent=new E.J,e.mTransformHandler=null,e.transformModeHandler=function(t){if(p.qL.print("Viewport transform mode changed: ",t.getData()),0===e.mTransformTargetMode){var n=t.getData();e.mTransformControls.setMode(n)}},e.transformTargetModeHandler=function(t){var n=e.mTransformControls.object;if(!(0,f.isNullOrUndefined)(n)){if(e.mTransformTargetMode=t.getData(),1===e.mTransformTargetMode)e.mTransformControls.setMode("translate"),e.mTransformControls.detach(),e.mTransformControls.attach(n.target);else{var r=e.mEditor.getSelectedObject();e._attachObject(r)}setTimeout((function(){return e.mEditor.dispatchEvent(s.G.RequestFrame)}),300)}},e.objectSelectedHandler=function(t){var n=null,r=!1;if(!(0,f.isNullOrUndefined)(t.getData())){var o=t.getData();n=o.selection,r=o.options&&!0===o.options.control}e._attachObject(n,r)},e.objectChangedHandler=function(e){},e}return t=a,n=[{key:"getType",value:function(){return a.TypeRTTI}},{key:"OnAttached",value:function(){var e=this;this.mEditor=this.getViewportRenderer().getEditor(),this._subscriptions.push(this.mEditor.observeEvents(s.G.TransformModeChanged).subscribe(this.transformModeHandler),this.mEditor.observeEvents(s.G.TransformTargetMode).subscribe(this.transformTargetModeHandler),this.mEditor.observeEvents(s.G.ObjectSelected).subscribe(this.objectSelectedHandler),this.mEditor.observeEvents(s.G.ObjectChanged).subscribe(this.objectChangedHandler),this.mEditor.observeEvents(s.G.ObjectTargetChanged).subscribe(this.objectChangedHandler)),this.mTransformControls=new THREE.TransformControls(this.mEditor.getCamera(),this.mEditor.getRenderer().domElement),this.registerMessageHandler(u.c.TypeRTTI,(function(){})),this.mTransformControls.addEventListener("objectChange",(function(){var t=e.mTransformControls.object;e.mEditor.dispatchEvent(s.G.TransformControlChanged,t),0===e.mTransformTargetMode&&e.mEditor.dispatchEvent(s.G.ObjectTransformed,t)})),this.mTransformControls.addEventListener("mouseDown",(function(){var t=e.mTransformControls.object;e.mEditor.dispatchEvent(s.G.TransformControlLock,t),e.mObjectPositionOnDown=t.position.clone(),e.mObjectRotationOnDown=t.rotation.clone(),e.mObjectScaleOnDown=t.scale.clone()})),this.mTransformControls.addEventListener("mouseUp",(function(){var t=e.mTransformControls.object;if(e.mEditor.dispatchEvent(s.G.TransformControlUnLock,t),e.mEditor.dispatchEvent(s.G.RequestFrame),void 0!==t)switch(e.mTransformControls.getMode()){case"translate":if(!e.mObjectPositionOnDown.equals(t.position))if(0===e.mTransformTargetMode)e.mTransformHandler.setPosition(e.mEditor,t,t.position,e.mObjectPositionOnDown);else{var n=e.mEditor.getSelectedObject();(0,f.isNullOrUndefined)(n)||(0,f.isNullOrUndefined)(n.target)||n.target.id!==t.id||e.mEditor.execute(new S.V(n,t.position,e.mObjectPositionOnDown))}break;case"rotate":e.mObjectRotationOnDown.equals(t.rotation)||e.mTransformHandler.setRotation(e.mEditor,t,t.rotation,e.mObjectRotationOnDown);break;case"scale":e.mObjectScaleOnDown.equals(t.scale)||e.mTransformHandler.setScale(e.mEditor,t,t.scale,e.mObjectScaleOnDown)}})),this.mEditor.getSceneHelpers().add(this.mTransformControls)}},{key:"OnDetached",value:function(){this.mTransformControls.dispose(),this.unregisterMessageHandler(u.c.TypeRTTI),this._subscriptions.forEach((function(e){return e.unsubscribe()})),this.mTransformComponent=null}},{key:"_attachObject",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.mTransformControls.detach(),this.mTransformTargetMode=0,this.mTransformHandler=this.mTransformComponent,(0,f.isNullOrUndefined)(e)||!0!==e.isObject3D||e===this.mEditor.getScene()||(t||(0,f.isNullOrUndefined)(e.userData.transforms)?this.mTransformControls.attach(e):(this.mTransformHandler=e.userData.transforms,this.mTransformControls.attach(this.mTransformHandler.transformObject(e))))}}],n&&x(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(r.V);M.TypeRTTI=new a.r("ViewportControllerEditorTransforms",r.V.TypeRTTI),n(76699),n(35666),n(82772),n(68309),n(92222),n(54678),n(68216),n(79433),n(91058),n(88674);var D=n(79241),A=n(24098);function I(e){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I(e)}function N(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function V(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){N(i,r,o,a,u,"next",e)}function u(e){N(i,r,o,a,u,"throw",e)}a(void 0)}))}}function U(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function F(e,t){return F=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},F(e,t)}function B(e,t){if(t&&("object"===I(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function L(e){return L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},L(e)}var H=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&F(e,t)}(h,e);var t,n,r,o,a,u,l,d=(u=h,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=L(u);if(l){var n=L(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return B(this,e)});function h(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),(e=d.call(this,"model_selector"))._subscriptions=new Array,e.mRayCaster=new THREE.Raycaster,e.mMouse=new THREE.Vector2,e.mOnDownPosition=new THREE.Vector2,e.mOnUpPosition=new THREE.Vector2,e.onModelSelected=new c.xQ,e.mMouseMoveSubject=new c.xQ,e.mMouseIsDown=!1,e.objectAddedHandler=function(t){var n=t.getData();!0===n.isObject3D&&n.traverse((function(t){e.mObjects.push(t)}))},e.objectRemovedHandler=function(t){var n=t.getData();!0===n.isObject3D&&n.traverse((function(t){e.mObjects.splice(e.mObjects.indexOf(t),1)}))},e.helperAddedHandler=function(t){var n=t.getData();e.mObjects.push(n.getObjectByName("picker"))},e.helperRemovedHandler=function(t){var n=t.getData();e.mObjects.splice(e.mObjects.indexOf(n.getObjectByName("picker")),1)},e}return t=h,n=[{key:"getType",value:function(){return h.TypeRTTI}},{key:"OnAttached",value:function(){var e=this;this.mEditor=this.getViewportRenderer().getEditor(),this.mObjects=new Array,this._subscriptions.push(this.mEditor.observeEvents(s.G.NodeAdded).subscribe(this.objectAddedHandler),this.mEditor.observeEvents(s.G.NodeRemoved).subscribe(this.objectRemovedHandler),this.mEditor.observeEvents(s.G.NodeChanged).subscribe(this.objectAddedHandler),this.mEditor.observeEvents(s.G.HelperAdded).subscribe(this.helperAddedHandler),this.mEditor.observeEvents(s.G.HelperRemoved).subscribe(this.helperRemovedHandler),this.mMouseMoveSubject.pipe((0,i.b)(200)).subscribe(function(){var t=V(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.handleMouseMove(n));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())),this.registerMessageHandler(D.n.TypeRTTI,function(){var t=V(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=n.name,t.next="down"===t.t0?3:"up"===t.t0?5:"move"===t.t0?8:10;break;case 3:return e.handleViewMouseDown(n.event),t.abrupt("break",10);case 5:return t.next=7,e.handleViewMouseUp(n.event);case 7:return t.abrupt("break",10);case 8:return e.mMouseMoveSubject.next(n.event),t.abrupt("break",10);case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),this.mPopup=$("<div></div>"),this.mPopup.css({"font-size":"10px",color:"#071623","background-color":"rgba(255, 255, 255, 0.4)","box-shadow":"1px 1px 3px 3px rgba(0, 0, 0, 0.3)",width:"100px",height:"40px",display:"block",position:"absolute",padding:"0.3rem"}).addClass("noselect"),$("body").append(this.mPopup),this.mPopup.hide()}},{key:"OnDetached",value:function(){this.mObjects=null,this.mPopup.remove(),this._subscriptions.forEach((function(e){return e.unsubscribe()})),this.unregisterMessageHandler(D.n.TypeRTTI)}},{key:"clearDocumentSelections",value:function(){document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges()}},{key:"getMousePosition",value:function(e,t){var n=this.getViewportRenderer().getViewContainer();if(!(0,f.isUndefined)(n)){var r=n.getBoundingClientRect();return[(e-r.left)/r.width,(t-r.top)/r.height]}return[0,0]}},{key:"handleViewMouseDown",value:function(e){this.clearDocumentSelections(),this.mMouseIsDown=!0;var t=e.changedTouches?e.changedTouches[0]:event;this.mOnDownPosition.fromArray([t.clientX,t.clientY])}},{key:"handleViewMouseUp",value:(a=V(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.changedTouches?t.changedTouches[0]:event,this.mOnUpPosition.fromArray([n.clientX,n.clientY]),this.mMouseIsDown=!1,e.next=5,this.handleClick();case 5:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"handleMouseMove",value:(o=V(regeneratorRuntime.mark((function e(t){var n,r,o,i,a,u,c,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.mMouseIsDown){e.next=2;break}return e.abrupt("return");case 2:if(n=t.changedTouches?t.changedTouches[0]:event,r=(new THREE.Vector2).fromArray([n.clientX,n.clientY]),!((o=this.getSelectedModel(r))>=0)){e.next=17;break}return(0,f.isNullOrUndefined)(this.mHidePopupTimer)||clearTimeout(this.mHidePopupTimer),i=this.mEditor.getSceneManager().getActiveProductNode(),a=i.getComponent("articleListManager"),e.next=11,a.getObjectModel(o);case 11:u=e.sent,c="\n            <span>id: ".concat(o,"</span>\n            <p style='white-space: nowrap;max-width: 80px; overflow-x: hidden; text-overflow: ellipsis;'>\n            ").concat(u.name,"\n            </p>"),this.mPopup.show().html(c).css({top:parseFloat(n.clientY)+10,left:parseFloat(n.clientX)+10}),this.mHidePopupTimer=setTimeout((function(){s.mHidePopupTimer=null,s.mPopup.hide()}),1500),e.next=18;break;case 17:this.mPopup.hide();case 18:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"handleClick",value:(r=V(regeneratorRuntime.mark((function e(){var t,n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.mOnDownPosition.distanceTo(this.mOnUpPosition)<.01)){e.next=10;break}if(!((t=this.getSelectedModel(this.mOnUpPosition))>=0)){e.next=10;break}return p.qL.print("model selected: ",t),n=this.mEditor.getSceneManager().getActiveProductNode(),r=n.getComponent("articleListManager"),e.next=8,r.getObjectModel(t);case 8:o=e.sent,this.onModelSelected.next(o);case 10:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"getSelectedModel",value:function(e){var t=this.getIntersects((new THREE.Vector2).fromArray(this.getMousePosition(e.x,e.y)));if(t.length>0){var n=t[0].object;if(void 0!==n.userData.object&&(n=n.userData.object),!(0,f.isUndefined)(n)&&!(0,f.isNullOrUndefined)(n.userData.sceneObjectRef)){var r=n.userData.sceneObjectRef;if(r.isDerivedTypeOf(A.w.TypeRTTI)){var o=r.getBatches(),i=null;if(o.every((function(e){var t=e.getMesh();return!(!(0,f.isNullOrUndefined)(t)&&t.id===n.id&&(i=e,1))})),null!==i){var a=i.getMesh().geometry.getIndex(),u=i.getNodes();if(u&&Array.isArray(u)){var c=-1;return u.every((function(e){for(var n=parseInt(e.batch_offset,10),r=parseInt(e.index_count,10),o=n;o<n+r;o+=3)if(a.array[o]===t[0].face.a&&a.array[o+1]===t[0].face.b&&a.array[o+2]===t[0].face.c){c=e.models_id;break}return c<0})),c}}}}}return-1}},{key:"getIntersects",value:function(e){return this.mMouse.set(2*e.x-1,-2*e.y+1),this.mRayCaster.setFromCamera(this.mMouse,this.mEditor.getCamera()),this.mRayCaster.intersectObjects(this.mObjects)}}],n&&U(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),h}(r.V);H.TypeRTTI=new a.r("ViewportControllerModelSelector",r.V.TypeRTTI);var z=n(38e3);function q(e){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},q(e)}function G(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function W(e,t){return W=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},W(e,t)}function Q(e,t){if(t&&("object"===q(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function K(e){return K=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},K(e)}(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&W(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=K(r);if(o){var n=K(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Q(this,e)});function a(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(e=i.call(this,"uix"))._subscriptions=new Array,e.mSelectedUi=null,e.handleSelectedObject=function(t){var n=t.getData().selection;if((0,f.isNullOrUndefined)(n)||!0!==n.isObjectUI)e.deselect();else{var r=n;e.select(r)}},e.handleObjectEdit=function(t){if(!(0,f.isNullOrUndefined)(e.mSelectedUi))switch(t.type){case"drag":e.mEditor.execute(new z.K(e.mSelectedUi,"position",new THREE.Vector2(t.data.left,t.data.top),!0));break;case"resize":e.mEditor.execute(new z.K(e.mSelectedUi,"size",new THREE.Vector2(t.data.width,t.data.height),!0))}},e}return t=a,(n=[{key:"getType",value:function(){return a.TypeRTTI}},{key:"getSelectedUi",value:function(){return this.mSelectedUi}},{key:"OnAttached",value:function(){var e=this;this.mEditor=this.getViewportRenderer().getEditor(),this._subscriptions.push(this.mEditor.getUiRenderer().onUiSelected.subscribe((function(t){e.mEditor.select(t)})),this.mEditor.observeEvents(s.G.ObjectSelected).subscribe(this.handleSelectedObject))}},{key:"OnDetached",value:function(){this.deselect(),this._subscriptions.splice(0,this._subscriptions.length).forEach((function(e){return e.unsubscribe()}))}},{key:"deselect",value:function(){null!==this.mSelectedUi&&this.mSelectedUi.makeUnEditable(),(0,f.isNullOrUndefined)(this.mEditSubscription)||(this.mEditSubscription.unsubscribe(),this.mEditSubscription=null),this.mSelectedUi=null}},{key:"select",value:function(e){this.mSelectedUi!==e&&(null!==this.mSelectedUi&&this.deselect(),this.mSelectedUi=e,this.mSelectedUi.makeEditable(),this.mEditSubscription=this.mSelectedUi.onEdit.subscribe(this.handleObjectEdit))}}])&&G(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(r.V)).TypeRTTI=new a.r("ViewportControllerUixEdit",r.V.TypeRTTI);var Y=n(46863);function Z(e){return Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Z(e)}function X(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function J(e,t){return J=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},J(e,t)}function ee(e,t){if(t&&("object"===Z(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function te(e){return te=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},te(e)}(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&J(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=te(r);if(o){var n=te(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return ee(this,e)});function a(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(e=i.call(this,"transforms"))._subscriptions=new Array,e.mTransformTargetMode=0,e.mTransformComponent=new E.J,e.mTransformHandler=null,e.transformModeHandler=function(t){if(0===e.mTransformTargetMode){var n=t.getData();e.mTransformControls.setMode(n)}},e.transformTargetModeHandler=function(t){var n=e.mTransformControls.object;if(!(0,f.isNullOrUndefined)(n))if(e.mTransformTargetMode=t.getData(),1===e.mTransformTargetMode)e.mTransformControls.setMode("translate"),e.mTransformControls.detach(),e.mTransformControls.attach(n.target),e.mTransformControls.update();else{var r=e.mEditor.getSelectedObject();(0,f.isNullOrUndefined)(r)||!0!==r.isObject3D||(e.mTransformControls.detach(),e.mTransformControls.attach(r),e.mTransformControls.update())}},e.objectSelectedHandler=function(t){e.mTransformControls.detach(),e.mTransformTargetMode=0;var n=(0,f.isNullOrUndefined)(t.getData())?null:t.getData().selection,r=e._findSceneMesh(n);(0,f.isNullOrUndefined)(r)||e._attachObject(r),setTimeout((function(){return e.mEditor.dispatchEvent(s.G.RequestFrame)}),500)},e.objectChangedHandler=function(t){e.mTransformControls.update()},e.onPostDrawHandler=function(t){t.renderer.render(e.mSceneHelpers,t.camera)},e}return t=a,(n=[{key:"getType",value:function(){return a.TypeRTTI}},{key:"OnAttached",value:function(){var e=this;this.mEditor=this.getViewportRenderer().getEditor(),this._subscriptions.push(this.mEditor.observeEvents(s.G.TransformModeChanged).subscribe(this.transformModeHandler),this.mEditor.observeEvents(s.G.TransformTargetMode).subscribe(this.transformTargetModeHandler),this.mEditor.observeEvents(s.G.ObjectSelected).subscribe(this.objectSelectedHandler),this.mEditor.observeEvents(s.G.ObjectChanged).subscribe(this.objectChangedHandler),this.mEditor.observeEvents(s.G.ObjectTargetChanged).subscribe(this.objectChangedHandler)),this.mTransformControls=new THREE.TransformControls(this.mEditor.getCamera(),this.mEditor.getRenderer().domElement),this.registerMessageHandler(u.c.TypeRTTI,(function(){e.mTransformControls.update()})),this.registerMessageHandler(Y.r.TypeRTTI,this.onPostDrawHandler),this.mTransformControls.addEventListener("change",(function(){var t=e.mTransformControls.object;e.mTransformControls.update(),0===e.mTransformTargetMode&&e.mEditor.dispatchEvent(s.G.ObjectTransformed,t),e.mEditor.dispatchEvent(s.G.RequestFrame)})),this.mTransformControls.addEventListener("mouseDown",(function(){var t=e.mTransformControls.object;e.mEditor.dispatchEvent(s.G.TransformControlLock,t),e.mObjectPositionOnDown=t.position.clone(),e.mObjectRotationOnDown=t.rotation.clone(),e.mObjectScaleOnDown=t.scale.clone()})),this.mTransformControls.addEventListener("mouseUp",(function(){var t=e.mTransformControls.object;if(e.mEditor.dispatchEvent(s.G.TransformControlUnLock,t),void 0!==t)switch(e.mTransformControls.getMode()){case"translate":if(!e.mObjectPositionOnDown.equals(t.position))if(0===e.mTransformTargetMode)e.mTransformHandler.setPosition(e.mEditor,t,t.position,e.mObjectPositionOnDown);else{var n=e.mEditor.getSelectedObject();(0,f.isNullOrUndefined)(n)||(0,f.isNullOrUndefined)(n.target)||n.target.id!==t.id||e.mEditor.execute(new S.V(n,t.position,e.mObjectPositionOnDown))}break;case"rotate":e.mObjectRotationOnDown.equals(t.rotation)||e.mTransformHandler.setRotation(e.mEditor,t,t.rotation,e.mObjectRotationOnDown);break;case"scale":e.mObjectScaleOnDown.equals(t.scale)||e.mTransformHandler.setScale(e.mEditor,t,t.scale,e.mObjectScaleOnDown)}})),this.mSceneHelpers=new THREE.Scene,this.mSceneHelpers.add(this.mTransformControls)}},{key:"OnDetached",value:function(){this.mTransformControls.dispose(),this.unregisterMessageHandler(u.c.TypeRTTI),this.unregisterMessageHandler(Y.r.TypeRTTI),this._subscriptions.forEach((function(e){return e.unsubscribe()})),this.mSceneHelpers=null,this.mTransformComponent=null}},{key:"_findSceneMesh",value:function(e){if((0,f.isNullOrUndefined)(e))return null;if(!(0,f.isUndefined)(e.userData)&&!(0,f.isNullOrUndefined)(e.userData.sceneObjectRef)){var t=e.userData.sceneObjectRef;if(t.isDerivedOfTypeName("MeshEntityModel")||t.isDerivedOfTypeName("ProductNode")&&null!==t.findParentOfTypeName("ProductNode"))return e}return this._findSceneMesh(e.parent)}},{key:"_attachObject",value:function(e){this.mTransformControls.detach(),this.mTransformTargetMode=0,this.mTransformHandler=this.mTransformComponent,(0,f.isNullOrUndefined)(e)||!0!==e.isObject3D||e===this.mEditor.getScene()||((0,f.isNullOrUndefined)(e.userData.transforms)?this.mTransformControls.attach(e):(this.mTransformHandler=e.userData.transforms,this.mTransformControls.attach(this.mTransformHandler.transformObject(e)))),this.mTransformControls.update()}}])&&X(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(r.V)).TypeRTTI=new a.r("ViewportControllerViewerTransforms",r.V.TypeRTTI),n(6892)},98919:function(e,t,n){"use strict";n.d(t,{x:function(){return G}}),n(41539),n(15581),n(2490),n(34514),n(54747),n(34553),n(60086),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(16957),o=n(90140),i=n(70211),a=n(64944),u=n(45355),c=n(14311),s=n(16011),l=n(43706),f=n(38531),p=n(70258),d=n(89539),h=n(74897),y=n(76699),m=n(99556),v=(n(40561),n(73010)),b=n(63438),g=n(3283),w=n(52557),_=n(59342),O=n(19790),T=n(10288);function R(e){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(e)}function S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function P(e,t){return P=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},P(e,t)}function x(e,t){if(t&&("object"===R(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function j(e){return j=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},j(e)}var C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P(e,t)}(u,e);var t,n,r,o,a=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=j(r);if(o){var n=j(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return x(this,e)});function u(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e4,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,l=arguments.length>6?arguments[6]:void 0,f=arguments.length>7?arguments[7]:void 0,p=arguments.length>8?arguments[8]:void 0;return S(this,u),(e=a.call(this,"controls")).mSubscriptions=new Array,e.onControlsChanged=function(t){e.mControlChange.next(),e.getViewportRenderer().dispatchMessage(new v.c),e.getViewportRenderer().getEditor().dispatchEvent(c.G.RequestFrame)},e.onZoomChanged=function(t){e.getViewportRenderer().getEditor().dispatchEvent(c.G.ZoomChanged)},e.mMaxZoom=t,e.mMinZoom=n,e.mPanDisabled=r,e.mLockUpVector=o,e.mTargetVector=i||new THREE.Vector3,e.mMinAzimuthAngle=(0,d.isNullOrUndefined)(s)||!(0,d.isNumber)(s)?-1/0:s,e.mMaxAzimuthAngle=(0,d.isNullOrUndefined)(l)||!(0,d.isNumber)(l)?1/0:l,e.mMinPolarAngle=_.M.Clamp(f,0,3.14159265359,0),e.mMaxPolarAngle=_.M.Clamp(p,0,3.14159265359,3.14159265359),e}return t=u,(n=[{key:"getType",value:function(){return u.TypeRTTI}},{key:"setMaxZoom",value:function(e){this.mMaxZoom=e,(0,d.isNullOrUndefined)(this.mOrbitControls)||(this.mOrbitControls.maxDistance=this.mMaxZoom)}},{key:"setMinZoom",value:function(e){this.mMinZoom=e,(0,d.isNullOrUndefined)(this.mOrbitControls)||(this.mOrbitControls.minDistance=this.mMinZoom)}},{key:"setPanDisabled",value:function(e){this.mPanDisabled=e,(0,d.isNullOrUndefined)(this.mOrbitControls)||(this.mOrbitControls.enablePan=!this.mPanDisabled)}},{key:"setLockUpVector",value:function(e){this.mLockUpVector=e,(0,d.isNullOrUndefined)(this.mOrbitControls)||this.mLockUpVector&&(this.mOrbitControls.maxPolarAngle=Math.PI/2)}},{key:"OnAttached",value:function(){var e=this,t=this.getViewportRenderer().getEditor();this.mOrbitControls=new THREE.ExpiviOrbitControls(t.getCamera(),t.getRenderer().domElement),this.mOrbitControls.target=this.mOrbitControls.target0=this.mTargetVector.clone(),this.mOrbitControls.enableDamping=!0,this.mOrbitControls.rotateSpeed=(0,T.tq)()?.05:.1,this.mOrbitControls.dampingFactor=.1,this.mOrbitControls.panSpeed=.1,this.mOrbitControls.screenSpacePanning=!0,this.mOrbitControls.minAzimuthAngle=this.mMinAzimuthAngle,this.mOrbitControls.maxAzimuthAngle=this.mMaxAzimuthAngle,this.mOrbitControls.minPolarAngle=this.mMinPolarAngle,this.mOrbitControls.maxPolarAngle=this.mMaxPolarAngle,this.mOrbitControls.blockDefaultTouch=!0!==t.getState(O.D.UNBLOCK_DEFAULT_TOUCH),this.setMaxZoom(this.mMaxZoom),this.setMinZoom(this.mMinZoom),this.setPanDisabled(this.mPanDisabled),this.setLockUpVector(this.mLockUpVector),this.mOrbitControls.addEventListener("change",this.onControlsChanged),this.mOrbitControls.addEventListener("zoom",this.onZoomChanged),this.registerMessageHandler(f.c.TypeRTTI,(function(){e.mCamAnimate.next()})),this.registerMessageHandler(s.I.TypeRTTI,(function(t){null!==e.mOrbitControls&&e.mOrbitControls.update()})),this.registerMessageHandler(w.E.TypeRTTI,(function(t){null!==e.mOrbitControls&&t.reset&&e.mOrbitControls.reset(),null!==e.mOrbitControls&&t.save&&e.mOrbitControls.saveState()})),this.mControlChange=new i.xQ;var n=this.mControlChange.pipe((0,b.b)((function(){e.getViewportRenderer().getEditor().getUiRenderer().disableEvents()})),(0,g.b)(300)).subscribe((function(){e.getViewportRenderer().getEditor().getUiRenderer().enableEvents()}));this.mSubscriptions.push(n),this.mCamAnimate=new i.xQ;var r=this.mCamAnimate.pipe((0,b.b)((function(){e.mOrbitControls.enabled=!1})),(0,g.b)(100)).subscribe((function(){e.mOrbitControls.enabled=!0,e.mOrbitControls.position0=t.getCamera().position.clone(),e.mOrbitControls.reset()}));this.mSubscriptions.push(r);var o=t.observeEvents(c.G.TransformControlChanged).pipe((0,b.b)((function(){e.mOrbitControls.enabled=!1,e.mOrbitControls.resetMouseState(),e.mControlChange.next()})),(0,g.b)(100)).subscribe((function(){e.mOrbitControls.enabled=!0}));this.mSubscriptions.push(o);var a=t.observeEvents(c.G.TransformControlLock).subscribe((function(){e.mOrbitControls.enabled=!1,e.mOrbitControls.resetMouseState(),e.mControlChange.next()}));this.mSubscriptions.push(a);var u=t.observeEvents(c.G.TransformControlUnLock).subscribe((function(){e.mOrbitControls.enabled=!0}));this.mSubscriptions.push(u)}},{key:"enabled",value:function(e){this.mOrbitControls&&(this.mOrbitControls.enabled=e)}},{key:"onReset",value:function(){}},{key:"OnDetached",value:function(){this.mOrbitControls.removeEventListener("change",this.onControlsChanged),this.mOrbitControls.removeEventListener("zoom",this.onZoomChanged),this.mOrbitControls.dispose(),this.mOrbitControls=null,this.unregisterMessageHandler(f.c.TypeRTTI),this.unregisterMessageHandler(s.I.TypeRTTI),this.unregisterMessageHandler(w.E.TypeRTTI),this.mSubscriptions.splice(0).forEach((function(e){return e.unsubscribe()}))}},{key:"updateTarget",value:function(e){this.mTargetVector.copy(e),this.mOrbitControls&&(this.mOrbitControls.target.copy(this.mTargetVector),this.mOrbitControls.target0.copy(this.mTargetVector),this.mOrbitControls.update())}}])&&E(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(r.V);C.TypeRTTI=new o.r("ViewportControllerOrbitControls",r.V.TypeRTTI);var k=n(41142),M=n(33314),D=n(82417),A=n(96381),I=n(29514),N=n(39876),V=n(45689),U=n(73463),F=n(67574);function B(e){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},B(e)}function L(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function H(e,t){return H=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},H(e,t)}function z(e,t){if(t&&("object"===B(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function q(e){return q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},q(e)}var G=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&H(e,t)}(b,e);var t,n,r,o,v=(r=b,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=q(r);if(o){var n=q(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return z(this,e)});function b(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,b),(e=v.call(this,"cameraselector"))._subscriptions=new Array,e.mBuildListener=new i.xQ,e.mFirstSync=!0,e.mPreviousControls=null,e.mControllerStack=new Array,e.checkForDefaultCamera=function(){e.syncCameras(),0===e.mCameras.length&&e.mBuildListener.next()},e.objectAddedHandler=function(t){t.getData()instanceof THREE.Camera&&e.syncCameras()},e.objectRemovedHandler=function(t){t.getData()instanceof THREE.Camera&&e.syncCameras()},e}return t=b,n=[{key:"getType",value:function(){return b.TypeRTTI}},{key:"OnAttached",value:function(){var e=this;this.mEditor=this.getViewportRenderer().getEditor(),this.mCameras=[],this._subscriptions.push(this.mEditor.observeEvents(c.G.NodeAdded).subscribe(this.objectAddedHandler),this.mEditor.observeEvents(c.G.NodeRemoved).subscribe(this.objectRemovedHandler),this.mEditor.observeEvents(c.G.BuildUpdated).subscribe(this.checkForDefaultCamera)),this.registerMessageHandler(s.I.TypeRTTI,(function(t){e.animate(t.delta)})),this.registerMessageHandler(l.u.TypeRTTI,(function(t){e.moveToCameraId(t.camId,t.animate,t.openView)})),this.registerMessageHandler(D.U.TypeRTTI,(function(t){e.moveToViewId(t.viewId)})),this.registerMessageHandler(p.G.TypeRTTI,(function(t){e.moveToPoint(t.origin,t.dir,t.action,t.delta,t.forceUpdate)})),this.registerMessageHandler(U.j.TypeRTTI,(function(t){e.setCameraToObject(t.targetObject,t.fitPosition,t.animate)})),this._subscriptions.push(this.mEditor.observeEvents(c.G.EnterVR).subscribe((function(){if((0,d.isNullOrUndefined)(e.mPreviousControls)){var t=e.getViewportRenderer();e.mPreviousControls=t.getComponent("controls"),t.removeComponent("controls")}})),this.mEditor.observeEvents(c.G.ExitVR).subscribe((function(){var t=e.getViewportRenderer();(0,d.isNullOrUndefined)(e.mPreviousControls)||(t.removeComponent("controls"),t.addComponent(e.mPreviousControls),e.mPreviousControls=null)})),this.mEditor.observeMessages(p.G.TypeRTTI).subscribe((function(t){return e.dispatchMessage(t)})),this.mBuildListener.pipe((0,g.b)(500),(0,A.w)((function(){var t=e.mEditor.getSceneManager().getActiveProductNode();return null==t?(0,a._)("Can not find product node"):t.onConfigurableNodeReady.pipe((0,I.P)(),(0,N.B)())}))).subscribe((function(t){null!=t&&(e.syncCameras(),0===e.mCameras.length&&e.setCameraToObject(t,V._.FIT_OBJECT_FRONT,!0))}),(function(e){k.qL.print("Failed to retrive configurable node: ",e)})))}},{key:"OnDetached",value:function(){this._subscriptions.forEach((function(e){return e.unsubscribe()})),this.unregisterMessageHandler(s.I.TypeRTTI),this.unregisterMessageHandler(l.u.TypeRTTI),this.unregisterMessageHandler(D.U.TypeRTTI),this.unregisterMessageHandler(p.G.TypeRTTI),this.unregisterMessageHandler(U.j.TypeRTTI),this.mCameras=void 0}},{key:"syncCameras",value:function(){var e=this;this.mCameras=[],this.mEditor.getSceneManager().findNodesOfType(u.g.TypeRTTI,(function(e){return null===e.findParentOfType(M.Ln.TypeRTTI).findParentOfType(M.Ln.TypeRTTI)})).forEach((function(t){e.mCameras.push(t)})),this.mFirstSync&&this.mCameras.length>0&&(this.mFirstSync=!1,this.moveToCamera(0))}},{key:"moveToViewId",value:function(e){var t=this;k.qL.print("move to view id: ",e);var n=this.mEditor.getSceneManager(),r=n.findNodesOfType(h.R.TypeRTTI,(function(t){return t.getSceneObjectId()==e}));if(r.length>0){var o=r[0],i=o.findParentOfType(M.Ln.TypeRTTI),a=n.setActiveViewId(i.getSceneObjectId(),o.getViewId(),!1);this.getViewportRenderer().getViewComponent().setLoaderVisible(!0),m.S.completePromise(a).then((function(){t.getViewportRenderer().getViewComponent().setLoaderVisible(!1)}),(function(e){k.qL.error("Set active view failed: ",e)}))}}},{key:"moveToCameraId",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.syncCameras();var r=this.mCameras.findIndex((function(t){return t.getSceneObjectId()==e}));k.qL.print("move to camera: ",e,"index: ",r),r>=0&&this.moveToCamera(r,t,n)}},{key:"moveToCamera",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=this.mCameras[e],i=null;if(r)for(var a=new Array(o.getParent());a.length>0;){var u=a.shift();(0,d.isNullOrUndefined)(u)||(u.isDerivedTypeOf(h.R.TypeRTTI)?i=u:a.push(u.getParent()))}var c=this.mEditor.getSceneManager();c._setActiveCameraId(o.getSceneObjectId());var s=c.getActiveView();if((0,d.isNullOrUndefined)(s)||(0,d.isNullOrUndefined)(i)||s.getViewId()===i.getViewId())this.setActiveCamera(o,n);else{var l=i.findParentOfType(M.Ln.TypeRTTI);(0,d.isNullOrUndefined)(l)||(this.getViewportRenderer().getViewComponent().setLoaderVisible(!0),setTimeout((function(){var e=c.setActiveViewId(l.getSceneObjectId(),i.getViewId(),!1);m.S.completePromise(e).then((function(){t.setActiveCamera(o,!0),t.getViewportRenderer().getViewComponent().setLoaderVisible(!1)}),(function(e){k.qL.error("Set active view failed: ",e)}))}),100))}}},{key:"setCameraToObject",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:V._.FIT_OBJECT_FRONT,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(null!=e){var r=e.getRenderObject();if(null!=r&&r.isDerivedOfTypeName("ThreedObject")){var o=r.get3DObject();o.updateMatrixWorld(!0);var i=new THREE.Box3;i.setFromObject(o);var a=new THREE.Vector3;i.getCenter(a);var u=new THREE.Vector3;i.getSize(u);var s=u.x>u.z?u.x:u.z,l=u.z>u.y?u.z:u.y,p=u.x>u.y?u.x:u.y,d=this.mEditor.getCamera().fov,h=l/2/Math.tan(Math.PI*d/360),y=s/2/Math.tan(Math.PI*d/360),m=p/2/Math.tan(Math.PI*d/360),v=Math.max(h,y,m),b=Math.max(u.x,u.y,u.z),g=Math.max(.001,.1*(v-b)),w=4*(b+v);k.qL.print("fit object near/far: ",g,w);var _=this.getViewportRenderer();_.removeComponent("controls");var O=new C(1e4,0,!1,!1,a);_.addComponent(O);var T=a.clone();switch(t){case V._.FIT_OBJECT_FRONT:T.add(new THREE.Vector3(0,.5*u.y,1.5*m));break;case V._.FIT_OBJECT_BACK:T.add(new THREE.Vector3(0,.5*u.y,-1.5*m));break;case V._.FIT_OBJECT_LEFT:T.add(new THREE.Vector3(1.5*h,.5*u.y,0));break;case V._.FIT_OBJECT_RIGHT:T.add(new THREE.Vector3(-1.5*h,.5*u.y,0));break;case V._.FIT_OBJECT_TOP:T.add(new THREE.Vector3(0,1.5*y,0));break;case V._.FIT_OBJECT_BOTTOM:T.add(new THREE.Vector3(0,-1.5*y,0));break;default:T.add(new THREE.Vector3(0,.5*u.y,1.5*m))}var R=this.mEditor.getCamera().position.clone(),S=this.mEditor.getCamera().rotation.clone(),E=this.mEditor.getCamera().up.clone();this.mEditor.getCamera().up.set(0,0,1),this.mEditor.getCamera().lookAt(a),this.mEditor.getCamera().updateProjectionMatrix(),this.mEditor.getCamera().updateMatrixWorld(!0);var P=this.mEditor.getCamera().rotation.clone();this.mEditor.getCamera().up.copy(E),n?(this.mEditor.getCamera().rotation.copy(S),this.mEditor.getCamera().updateProjectionMatrix(),this.mEditor.getCamera().updateMatrixWorld(!0),this.mAnimation={t:0,p1:R,p2:T.clone(),r1:S,r2:P.clone(),near:g,far:w,fov:45,tonemapping_type:THREE.LinearToneMapping,tonemapping_exposure:1,tonemapping_whitepoint:1}):(this.mAnimation=void 0,this.mEditor.getCamera().position.copy(T),this.mEditor.getCamera().rotation.copy(P),this.applyCameraValues(g,w,45,THREE.LinearToneMapping,1,1),this.mEditor.getCamera().updateMatrixWorld(!0),this.getViewportRenderer().dispatchMessage(new f.c),this.getViewportRenderer().getEditor().dispatchEvent(c.G.RequestFrame))}}}},{key:"setActiveCamera",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getViewportRenderer();if(n.removeComponent("controls"),0===e.getValue("cam_controller")){var r=new C(e.getValue("max_zoom"),e.getValue("min_zoom"),e.getValue("pan_disabled"),e.getValue("lockup_hemisphere"),e.getValue("target"),e.getValue("min_azimuth_angle"),e.getValue("max_azimuth_angle"),e.getValue("min_polar_angle"),e.getValue("max_polar_angle"));n.addComponent(r)}else 1===e.getValue("cam_controller")?n.addComponent(new y.o):2===e.getValue("cam_controller")&&n.addComponent(new F.X(e.getValue("max_zoom"),e.getValue("min_zoom"),e.getValue("direction"),e.getValue("min_polar_angle"),e.getValue("max_polar_angle"),e.getValue("min_azimuth_angle"),e.getValue("max_azimuth_angle"),e.getValue("damp_factor"),e.getValue("rotation_speed")));var o=null,i=null;if(e.hasRenderObject()){var a=e.getRenderObject().get3DObject();o=new THREE.Vector3,i=new THREE.Euler,a.getWorldPosition(o);var u=new THREE.Quaternion;a.getWorldQuaternion(u),i.setFromQuaternion(u),k.qL.print("set active camera to world space: ",o,i)}else o=e.getValue("position"),i=e.getValue("rotation");t?this.mAnimation={t:0,p1:this.mEditor.getCamera().position.clone(),p2:o.clone(),r1:this.mEditor.getCamera().rotation.clone(),r2:i.clone(),near:e.getValue("near"),far:e.getValue("far"),fov:e.getValue("fov"),tonemapping_type:THREE[e.getValue("tonemapping_type")],tonemapping_exposure:e.getValue("tonemapping_exposure"),tonemapping_whitepoint:e.getValue("tonemapping_whitepoint")}:(this.mAnimation=void 0,this.mEditor.getCamera().position.copy(o),this.mEditor.getCamera().rotation.copy(i),this.applyCameraValues(e.getValue("near"),e.getValue("far"),e.getValue("fov"),THREE[e.getValue("tonemapping_type")],e.getValue("tonemapping_exposure"),e.getValue("tonemapping_whitepoint")),this.mEditor.getCamera().updateMatrixWorld(!0),this.getViewportRenderer().dispatchMessage(new f.c),this.getViewportRenderer().getEditor().dispatchEvent(c.G.RequestFrame))}},{key:"applyCameraValues",value:function(e,t,n,r,o,i){this.mEditor.getCamera().near=e,this.mEditor.getCamera().far=t,this.mEditor.getCamera().fov=n;var a=this.mEditor.getRenderer();a.toneMappingExposure=o,a.toneMappingWhitePoint=i,this.mEditor.getCamera().updateProjectionMatrix()}},{key:"moveToPoint",value:function(e,t,n){var r,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=e,u=(new THREE.Euler).setFromVector3(t);if(n===p.H.PUSH_CONTROLLER){var c=this.getViewportRenderer();this.mControllerStack.push(c.getComponent("controls")),c.removeComponent("controls")}else n===p.H.POP_CONTROLLER&&(r=this.mControllerStack.pop());this.mAnimation={t:o,p1:this.mEditor.getCamera().position.clone(),p2:a.clone(),r1:this.mEditor.getCamera().rotation.clone(),r2:u.clone(),controller:r},i&&this.animate(1/60)}},{key:"animate",value:function(e){if(void 0!==this.mAnimation){var t=this.mAnimation;t.t+=1*e,t.t>1&&(t.t=1,(0,d.isNullOrUndefined)(this.mAnimation.near)||(this.applyCameraValues(this.mAnimation.near,this.mAnimation.far,this.mAnimation.fov,this.mAnimation.tonemapping_type,this.mAnimation.tonemapping_exposure,this.mAnimation.tonemapping_whitepoint),this.mEditor.getCamera().updateMatrixWorld(!0)),this.mAnimation.controller&&this.getViewportRenderer().addComponent(this.mAnimation.controller),this.mAnimation=void 0);var n=t.p2.clone();n.sub(t.p1);var r=n.length();n.normalize(),n.multiplyScalar(t.t*r);var o=t.p1.clone();o.add(n);var i=new THREE.Quaternion;i.setFromEuler(t.r1);var a=new THREE.Quaternion;a.setFromEuler(t.r2);var u=new THREE.Quaternion;THREE.Quaternion.slerp(i,a,u,t.t),this.mEditor.getCamera().position.copy(o),this.mEditor.getCamera().rotation.setFromQuaternion(u),this.mEditor.getCamera().updateProjectionMatrix(),this.mEditor.getCamera().updateMatrixWorld(!0),this.getViewportRenderer().dispatchMessage(new f.c),this.getViewportRenderer().getEditor().dispatchEvent(c.G.RequestFrame)}}}],n&&L(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),b}(r.V);G.TypeRTTI=new o.r("ViewportControllerCameraSelector",r.V.TypeRTTI)},73915:function(e,t,n){"use strict";n.d(t,{q:function(){return y}}),n(41539),n(68216),n(2490),n(79433),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(16957),o=n(90140),i=n(94110),a=n(73462),u=n(13420),c=n(33314),s=n(89539);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},p(e,t)}function d(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(y,e);var t,n,r,o,l=(r=y,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(r);if(o){var n=h(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return d(this,e)});function y(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,y),(e=l.call(this,"draw")).mPostPipeline=null,e.mRenderId=0,e.mViewSizeW=-1,e.mViewSizeH=-1,e.onResizeHandler=function(t){var n=e.mEditor.getRenderer(),r=n.getPixelRatio(),o=new THREE.Vector2;n.getSize(o);var i=Math.floor(o.x/r)||1,a=Math.floor(o.y/r)||1;e.mViewSizeW=i,e.mViewSizeH=a},e.onDrawHandler=function(t){e.mRenderId+=1,null!==e.mPostPipeline&&e.mPostPipeline.discard(),t.renderer.clear(!0,!0,!0),t.renderer.render(t.scene,t.camera)},e.onDrawEffects=function(t){var n=e.mRenderId,r=e.mEditor.getSceneManager(),o=r.findNodesOfType(c.gR.TypeRTTI),i=r.getActiveCameraId(),a=null;o.every((function(e){return e.getSceneObjectId()!==i||(a=e,!1)}));var u=!1;if(null!==a){var l=a.getValue("pipeline"),f=a.findParentOfType(c.Ln.TypeRTTI);null!==f&&!(0,s.isNullOrUndefined)(l)&&l.length>0&&(u=!0,e.mEditor.getPipelineManager().setActivePipeline(f.getValue("product_id"),l))}u||e.mEditor.getPipelineManager().deactivatePipeline(),e.mEditor.getPipelineManager().resolveActivePipeline().subscribe((function(r){e.mPostPipeline!==r&&(e.mPostPipeline=r,e.mPostPipeline.setSize(e.mViewSizeW,e.mViewSizeH)),e._renderPipeline(t,n)}),(function(t){e._clearPipeline()}))},e}return t=y,(n=[{key:"getType",value:function(){return y.TypeRTTI}},{key:"OnAttached",value:function(){this.mEditor=this.getViewportRenderer().getEditor(),this.registerMessageHandler(i.K.TypeRTTI,this.onDrawHandler),this.registerMessageHandler(u.f.TypeRTTI,this.onDrawEffects),this.registerMessageHandler(a.N.TypeRTTI,this.onResizeHandler)}},{key:"OnDetached",value:function(){this.unregisterMessageHandler(i.K.TypeRTTI),this.unregisterMessageHandler(u.f.TypeRTTI),this.unregisterMessageHandler(a.N.TypeRTTI)}},{key:"_clearPipeline",value:function(){null!==this.mPostPipeline&&(this.mPostPipeline.dispose(),this.mPostPipeline=null)}},{key:"_renderPipeline",value:function(e,t){null!==this.mPostPipeline&&t===this.mRenderId&&this.mPostPipeline.render(e.renderer,e.scene,e.camera)}}])&&f(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),y}(r.V);y.TypeRTTI=new o.r("ViewportControllerDrawPP4",r.V.TypeRTTI)},7349:function(e,t,n){"use strict";n.d(t,{H:function(){return _}}),n(34553),n(40561),n(82772),n(68309),n(41539),n(15581),n(2490),n(34514),n(54747),n(91058),n(54678),n(69826),n(31672),n(59461),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(73316),o=n(16957),i=n(90140),a=n(70211),u=n(14311),c=n(89539),s=n(11706),l=n(54598),f=n(36298),p=n(80115),d=n(41142),h=n(73046),y=n(12673);function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function b(e,t){return b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},b(e,t)}function g(e,t){if(t&&("object"===m(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function w(e){return w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},w(e)}var _=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b(e,t)}(_,e);var t,n,o,i,m=(o=_,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=w(o);if(i){var n=w(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return g(this,e)});function _(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,_),(e=m.call(this,"droppable"))._subscriptions=new Array,e.mRayCaster=new THREE.Raycaster,e.mMoveSubject=new a.xQ,e.mCurrentDragOver=null,e.mTemporaryObjectMaterial=null,e.mCellWidth=1,e.mCellHeight=1,e.mDragMaterial=new THREE.MeshBasicMaterial({color:65280}),e.objectAddedHandler=function(t){var n=t.getData();!0===n.isObject3D&&n.traverse((function(t){e.mObjects.findIndex((function(e){return e.id===t.id}))<0&&e.mObjects.push(t)}))},e.objectRemovedHandler=function(t){var n=t.getData();!0===n.isObject3D&&n.traverse((function(t){e.mObjects.splice(e.mObjects.indexOf(t),1)}))},e.dragMoveHandler=function(t){var n=t.position,r=t.data;if(d.qL.print("drag move handled: ",r.types),r.types&&r.types.length>0){var o=new THREE.Vector2;o.fromArray(e.getMousePosition(n.x,n.y));for(var i=e.getIntersects(o),a=null,u=0;u<i.length;u++){var s=e.resolveDropableComponent(i[u].object);if(!(0,c.isNullOrUndefined)(s)&&s.interceptDragMove(i[u],e.mCellWidth,e.mCellHeight)){a=i[u].object;break}}e.markDragMaterial(a)}else e.resetDragMaterial()},e}return t=_,(n=[{key:"getType",value:function(){return _.TypeRTTI}},{key:"OnAttached",value:function(){var e=this;this.mEditor=this.getViewportRenderer().getEditor(),this.mObjects=new Array,this._subscriptions.push(this.mEditor.observeEvents(u.G.NodeAdded).subscribe(this.objectAddedHandler),this.mEditor.observeEvents(u.G.NodeRemoved).subscribe(this.objectRemovedHandler),this.mEditor.observeEvents(u.G.NodeChanged).subscribe(this.objectAddedHandler),this.mMoveSubject.pipe((0,r.p)(50)).subscribe(this.dragMoveHandler)),this.registerMessageHandler(f.x.TypeRTTI,(function(t){switch(t.name){case"start":e.onDragStarted();break;case"move":e.onDragMoved(t.position,t.data);break;case"end":e.onDragEnd(t.position,t.data);break;case"drop":e.onItemDropped(t.position,t.data)}}))}},{key:"OnDetached",value:function(){this.mObjects=null,this.resetDragMaterial(),this._subscriptions.splice(0).forEach((function(e){return e.unsubscribe()})),this.unregisterMessageHandler(f.x.TypeRTTI)}},{key:"setCellSize",value:function(e,t){this.mCellWidth=e,this.mCellHeight=t}},{key:"resolveDropableComponent",value:function(e){var t=(e.userData||{}).sceneObjectRef;return(0,c.isNullOrUndefined)(t)?null:t.getComponent("dropableHandler")}},{key:"onDragStarted",value:function(){}},{key:"onDragMoved",value:function(e,t){this.mMoveSubject.next({position:e,data:t})}},{key:"onDragEnd",value:function(e,t){this.resetDragMaterial()}},{key:"markDragMaterial",value:function(e){if(this.mCurrentDragOver!==e)if((0,c.isNullOrUndefined)(e))this.resetDragMaterial();else{this.resetDragMaterial(),this.mCurrentDragOver=e;var t=this.resolveDropableComponent(this.mCurrentDragOver);(0,c.isNullOrUndefined)(t)?(this.mTemporaryObjectMaterial=this.mCurrentDragOver.material,this.mCurrentDragOver.material=this.mDragMaterial):t.markDragMaterial(this.mCurrentDragOver),this.mEditor.getSceneManager().getRenderState().requestFrame()}}},{key:"resetDragMaterial",value:function(){if(null!==this.mCurrentDragOver){var e=this.resolveDropableComponent(this.mCurrentDragOver);(0,c.isNullOrUndefined)(e)?(0,c.isNullOrUndefined)(this.mTemporaryObjectMaterial)||(this.mCurrentDragOver.material=this.mTemporaryObjectMaterial,this.mTemporaryObjectMaterial=null):e.resetDragMaterial(this.mCurrentDragOver),this.mCurrentDragOver=null,this.mEditor.getSceneManager().getRenderState().requestFrame()}}},{key:"onItemDropped",value:function(e,t){var n=this,r=!1;if(this.resetDragMaterial(),d.qL.print("item dropped: ",e,"data: ",t),!(0,c.isUndefined)(t))if(!(0,c.isUndefined)(t.model_id)&&t.model_id.length>0)this.mEditor.getSceneManager().getRenderState().getResourceManager().getManager(p.O.ModelManager).then((function(o){var i=parseInt(t.model_id,10),a=o.getModel(i),u=new s.Y(n.mEditor.getSceneManager().getRenderState());u.setValue("name",a.Name);var c=new THREE.Vector2;c.fromArray(n.getMousePosition(e.x,e.y));var f=n.getIntersects(c);if(f.length>0){var p=f[0].point;u.setValue("position",p)}else u.setValue("position",new THREE.Vector3(0,0,0));u.setValue("rotation_y",1.57),u.setValue("model_id",i),n.mEditor.execute(new l.Y(u)),r=!0}),(function(e){d.qL.error("Could not retrieve modelmanager",e)}));else if(!(0,c.isUndefined)(t.product_id)&&!isNaN(parseFloat(t.product_id))&&isFinite(t.product_id)){var o=new THREE.Vector2;o.fromArray(this.getMousePosition(e.x,e.y));var i=this.getIntersects(o).find((function(e){return!(0,c.isNullOrUndefined)(n.resolveDropableComponent(e.object))}));if(!(0,c.isNullOrUndefined)(i)){var a=this.resolveDropableComponent(i.object);if(!(0,c.isNullOrUndefined)(a)){var u=a.acceptDrop(i),f=u.pos,m=u.rot;if(!(0,c.isNullOrUndefined)(f)){var v=(new y.g).createObject("product",null,this.mEditor.getSceneManager().getRenderState(),t.product_id);v.setValue("name","Product id:".concat(t.product_id)),v.setValue("position",f),v.setValue("rotation",m),this.mEditor.execute(new l.Y(v)),r=!0}}}}this.mEditor.dispatchMessage(new h.y("drop",r,{model_id:t.model_id,product_id:t.product_id,event:t.event,target:t.target}))}},{key:"getMousePosition",value:function(e,t){var n=this.getViewportRenderer().getViewContainer().getBoundingClientRect();return[(e-n.left)/n.width,(t-n.top)/n.height]}},{key:"getIntersects",value:function(e){return this.mRayCaster.setFromCamera(new THREE.Vector2(2*e.x-1,-2*e.y+1),this.mEditor.getCamera()),this.mRayCaster.intersectObjects(this.mObjects)}}])&&v(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),_}(o.V);_.TypeRTTI=new i.r("ViewportControllerDroppable",o.V.TypeRTTI)},92403:function(e,t,n){"use strict";n.d(t,{N:function(){return m}}),n(34553),n(82772),n(40561),n(68309),n(41539),n(15581),n(2490),n(34514),n(54747),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(16957),o=n(90140),i=n(14311),a=n(79241),u=n(89539),c=n(23089),s=n(79816),l=n(41142);function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t){return d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},d(e,t)}function h(e,t){if(t&&("object"===f(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(m,e);var t,n,r,o,f=(r=m,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=y(r);if(o){var n=y(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return h(this,e)});function m(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,m),(e=f.call(this,"selector"))._subscriptions=new Array,e.mRayCaster=new THREE.Raycaster,e.mMouse=new THREE.Vector2,e.mOnDownPosition=new THREE.Vector2,e.mOnUpPosition=new THREE.Vector2,e.mOnDoublePosition=new THREE.Vector2,e.mHoverEnabled=!1,e.mHoverThrottle=null,e.mHoverThrottleTime=300,e.mDragging=!1,e.objectAddedHandler=function(t){var n=t.getData();!0===n.isObject3D&&n.traverse((function(t){"Group"!==t.type&&e.mObjects.findIndex((function(e){return e.id===t.id}))<0&&e.mObjects.push(t)}))},e.objectRemovedHandler=function(t){var n=t.getData();!0===n.isObject3D&&n.traverse((function(t){var n=e.mObjects.indexOf(t);n>=0&&e.mObjects.splice(n,1)}))},e.helperAddedHandler=function(t){var n=t.getData().getObjectByName("picker");e.mObjects.push(n)},e.helperRemovedHandler=function(t){var n=t.getData().getObjectByName("picker"),r=e.mObjects.indexOf(n);e.mObjects.splice(r,1)},e}return t=m,(n=[{key:"getType",value:function(){return m.TypeRTTI}},{key:"OnAttached",value:function(){var e=this;this.mEditor=this.getViewportRenderer().getEditor(),this.mObjects=new Array,this._subscriptions.push(this.mEditor.observeEvents(i.G.NodeAdded).subscribe(this.objectAddedHandler),this.mEditor.observeEvents(i.G.NodeRemoved).subscribe(this.objectRemovedHandler),this.mEditor.observeEvents(i.G.NodeChanged).subscribe(this.objectAddedHandler),this.mEditor.observeEvents(i.G.HelperAdded).subscribe(this.helperAddedHandler),this.mEditor.observeEvents(i.G.HelperRemoved).subscribe(this.helperRemovedHandler)),this.registerMessageHandler(a.n.TypeRTTI,(function(t){switch(t.name){case"down":e.handleViewMouseDown(t.event);break;case"up":e.handleViewMouseUp(t.event);break;case"move":e.handleViewMouseMove(t.event);break;case"leave":e.handleViewMouseLeave(t.event);break;case"dbclick":e.handleDoubleClick(t.event)}})),this.registerMessageHandler(s.xS.TypeRTTI,(function(t){"start"===t.name?e.mDragging=!0:"end"!==t.name&&"drop"!==t.name||(e.mDragging=!1)}))}},{key:"OnDetached",value:function(){this.mObjects=null,this._subscriptions.forEach((function(e){return e.unsubscribe()})),this.unregisterMessageHandler(a.n.TypeRTTI)}},{key:"enableHover",value:function(e){this.mHoverEnabled=e}},{key:"setHoverThrothleTime",value:function(e){this.mHoverThrottleTime=e}},{key:"clearDocumentSelections",value:function(){document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges()}},{key:"getMousePosition",value:function(e,t){var n=this.getViewportRenderer().getViewContainer();if(!(0,u.isUndefined)(n)){var r=n.getBoundingClientRect();return[(e-r.left)/r.width,(t-r.top)/r.height]}return[0,0]}},{key:"handleViewMouseMove",value:function(e){var t=this;this.mHoverEnabled&&!this.mDragging&&null===this.mHoverThrottle&&(this.mHoverThrottle=setTimeout((function(){t.mHoverThrottle=null;var n=e.changedTouches?e.changedTouches[0]:e,r=t.getIntersects((new THREE.Vector2).fromArray(t.getMousePosition(n.clientX,n.clientY)));r.length>0&&t.mEditor.intercept(c.z.RayHoverSceneObject,r[0]).then((function(e){}),(function(e){}))}),this.mHoverThrottleTime))}},{key:"handleViewMouseLeave",value:function(e){}},{key:"handleViewMouseDown",value:function(e){this.clearDocumentSelections();var t=e.changedTouches?e.changedTouches[0]:e;this.mOnDownPosition.fromArray([t.clientX,t.clientY])}},{key:"handleViewMouseUp",value:function(e){var t=e.changedTouches?e.changedTouches[0]:e;this.mOnUpPosition.fromArray([t.clientX,t.clientY]),this.handleClick(!0===t.ctrlKey)}},{key:"handleDoubleClick",value:function(e){l.qL.print("double!!!!!"),this.mOnDoublePosition.fromArray(this.getMousePosition(e.clientX,e.clientY));var t=this.getIntersects(this.mOnDoublePosition);if(t.length>0){var n=t[0];this.mEditor.dispatchEvent(i.G.ObjectFocused,n.object)}}},{key:"handleClick",value:function(e){var t=this;if(this.mOnDownPosition.distanceTo(this.mOnUpPosition)<.01){var n=this.getIntersects((new THREE.Vector2).fromArray(this.getMousePosition(this.mOnUpPosition.x,this.mOnUpPosition.y)));l.qL.print("clicked, intersects:",n),n.length>0?this.mEditor.intercept(c.z.RayPickedSceneObject,n[0]).then((function(n){var r=n.object;void 0!==r.userData.object?(r=r.userData.object,t.mEditor.select(r,{control:e})):t.mEditor.select(r,{control:e})}),(function(e){})):this.mEditor.select(null)}}},{key:"getIntersects",value:function(e){return this.mMouse.set(2*e.x-1,-2*e.y+1),this.mRayCaster.setFromCamera(this.mMouse,this.mEditor.getCamera()),this.mRayCaster.intersectObjects(this.mObjects)}}])&&p(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),m}(r.V);m.TypeRTTI=new o.r("ViewportControllerEditorSelector",r.V.TypeRTTI)},76699:function(e,t,n){"use strict";n.d(t,{o:function(){return g}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(63438),o=n(3283),i=n(16957),a=n(90140),u=n(16011),c=n(68511),s=n(73462),l=n(70211),f=n(38531),p=n(14311),d=n(73010);function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t){return m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},m(e,t)}function v(e,t){if(t&&("object"===h(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function b(e){return b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},b(e)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(g,e);var t,n,i,a,h=(i=g,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=b(i);if(a){var n=b(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return v(this,e)});function g(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,g),(e=h.call(this,"controls")).mFPSControls=null,e.onControlsChanged=function(t){e.mControlChange.next(),e.getViewportRenderer().dispatchMessage(new d.c),e.getViewportRenderer().getEditor().dispatchEvent(p.G.RequestFrame)},e}return t=g,(n=[{key:"getType",value:function(){return g.TypeRTTI}},{key:"enabled",value:function(e){this.mFPSControls&&(this.mFPSControls.enabled=e)}},{key:"OnAttached",value:function(){var e=this,t=this.getViewportRenderer().getEditor();this.mFPSControls=new THREE.ExpiviFirstPersonControls(t.getCamera(),t.getRenderer().domElement),this.mFPSControls.enabled=!0,this.mFPSControls.movementSpeed=5,this.mFPSControls.constrainVertical=!0,this.registerMessageHandler(u.I.TypeRTTI,(function(t){null!==e.mFPSControls&&e.mFPSControls.update(t.delta)})),this.registerMessageHandler(c.f.TypeRTTI,(function(t){e.mFPSControls.handleResize()})),this.registerMessageHandler(s.N.TypeRTTI,(function(){null!==e.mFPSControls&&e.mFPSControls.handleResize()})),this.registerMessageHandler(f.c.TypeRTTI,(function(){e.mCamAnimate.next()})),this.mFPSControls.addEventListener("change",this.onControlsChanged),this.mControlChange=new l.xQ,this.mSubscriptionControlChange=this.mControlChange.pipe((0,r.b)((function(){e.getViewportRenderer().getEditor().getUiRenderer().disableEvents()})),(0,o.b)(300)).subscribe((function(){e.getViewportRenderer().getEditor().getUiRenderer().enableEvents()})),this.mCamAnimate=new l.xQ,this.mSubscriptionCamAnimated=this.mCamAnimate.pipe((0,r.b)((function(){e.mFPSControls.enabled=!1})),(0,o.b)(100)).subscribe((function(){e.mFPSControls.enabled=!0;var t=e.getViewportRenderer().getEditor().getCamera(),n=new THREE.Vector3(0,0,-1);n.applyQuaternion(t.quaternion),e.mFPSControls.target=t.position.clone().addScaledVector(n,10),e.mFPSControls.reset()})),this.mSubscriptionTransformChanged=t.observeEvents(p.G.TransformControlChanged).pipe((0,r.b)((function(){e.mFPSControls.enabled=!1,e.mControlChange.next()})),(0,o.b)(300)).subscribe((function(){e.mFPSControls.enabled=!0}))}},{key:"OnDetached",value:function(){this.mSubscriptionCamAnimated.unsubscribe(),this.mSubscriptionTransformChanged.unsubscribe(),this.mSubscriptionControlChange.unsubscribe(),this.unregisterMessageHandler(u.I.TypeRTTI),this.unregisterMessageHandler(s.N.TypeRTTI),this.unregisterMessageHandler(c.f.TypeRTTI),this.unregisterMessageHandler(f.c.TypeRTTI),null!==this.mFPSControls&&(this.mFPSControls.removeEventListener("change",this.onControlsChanged),this.mFPSControls.dispose(),this.mFPSControls=null)}}])&&y(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),g}(i.V);g.TypeRTTI=new a.r("ViewportControllerFPSControls",i.V.TypeRTTI)},67574:function(e,t,n){"use strict";n.d(t,{X:function(){return O},o:function(){return r}}),n(41539),n(15581),n(2490),n(34514),n(54747),n(40561),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r,o=n(63438),i=n(3283),a=n(16957),u=n(90140),c=n(16011),s=n(70211),l=n(38531),f=n(14311),p=n(73010),d=n(89539),h=n(59342),y=n(52557);function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e,t){return g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},g(e,t)}function w(e,t){if(t&&("object"===m(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function _(e){return _=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},_(e)}!function(e){e[e.Phi=0]="Phi",e[e.Theta=1]="Theta"}(r||(r={}));var O=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}(O,e);var t,n,a,u,m=(a=O,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=_(a);if(u){var n=_(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return w(this,e)});function O(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e4,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.Theta,i=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,u=arguments.length>5?arguments[5]:void 0,c=arguments.length>6?arguments[6]:void 0,s=arguments.length>7?arguments[7]:void 0,l=arguments.length>8?arguments[8]:void 0;return v(this,O),(e=m.call(this,"controls")).mSubscriptions=new Array,e.mMaxZoom=t,e.mMinZoom=n,e.mDirection=o,e.mDampFactor=s,e.mMinPolar=(0,d.isNullOrUndefined)(i)||!(0,d.isNumber)(i)||i<=h.M.EPS?-1/0:i,e.mMaxPolar=(0,d.isNullOrUndefined)(a)||!(0,d.isNumber)(a)||a>=Math.PI-h.M.EPS?1/0:a,e.mMinAzimuth=(0,d.isNullOrUndefined)(u)||!(0,d.isNumber)(u)?-1/0:u,e.mMaxAzimuth=(0,d.isNullOrUndefined)(c)||!(0,d.isNumber)(c)?1/0:c,e.mRotationSpeed=(0,d.isNullOrUndefined)(l)?.1:l,e}return t=O,(n=[{key:"getType",value:function(){return O.TypeRTTI}},{key:"OnAttached",value:function(){var e=this;this.mEditor=this.getViewportRenderer().getEditor(),this.mCamera=this.mEditor.getCamera(),this.registerMessageHandler(l.c.TypeRTTI,(function(){e.mCamAnimate.next()})),this.registerMessageHandler(c.I.TypeRTTI,(function(t){(0,d.isNullOrUndefined)(e.mControls)||e.mControls.update()})),this.registerMessageHandler(y.E.TypeRTTI,(function(t){!(0,d.isNullOrUndefined)(e.mControls)&&t.reset&&e.mControls.reset(),!(0,d.isNullOrUndefined)(e.mControls)&&t.save&&e.mControls.saveState()})),this.mControlChange=new s.xQ;var t=this.mControlChange.pipe((0,o.b)((function(){e.getViewportRenderer().getEditor().getUiRenderer().disableEvents()})),(0,i.b)(300)).subscribe((function(){e.getViewportRenderer().getEditor().getUiRenderer().enableEvents()}));this.mSubscriptions.push(t),this.mCamAnimate=new s.xQ;var n=this.mCamAnimate.pipe((0,o.b)((function(){(0,d.isNullOrUndefined)(e.mControls)||(e.mControls.enabled=!1)})),(0,i.b)(100)).subscribe((function(){(0,d.isNullOrUndefined)(e.mControls)||(e.mControls.enabled=!0,e.mControls.reset())}));this.mSubscriptions.push(n);var r=this.mEditor.observeEvents(f.G.TransformControlChanged).pipe((0,o.b)((function(){(0,d.isNullOrUndefined)(e.mControls)||(e.mControls.enabled=!1,e.mControlChange.next())})),(0,i.b)(100)).subscribe((function(){(0,d.isNullOrUndefined)(e.mControls)||(e.mControls.enabled=!0)}));this.mSubscriptions.push(r);var a=this.mEditor.observeEvents(f.G.TransformControlLock).subscribe((function(){(0,d.isNullOrUndefined)(e.mControls)||(e.mControls.enabled=!1,e.mControlChange.next())}));this.mSubscriptions.push(a);var u=this.mEditor.observeEvents(f.G.TransformControlUnLock).subscribe((function(){(0,d.isNullOrUndefined)(e.mControls)||(e.mControls.enabled=!0)}));if(this.mSubscriptions.push(u),this.mSubscriptions.push(this.mEditor.observeEvents(f.G.NodeAdded).subscribe(this.objectAddedHandler.bind(this))),this.mSubscriptions.push(this.mEditor.observeEvents(f.G.NodeRemoved).subscribe(this.objectRemovedHandler.bind(this))),this.mSubscriptions.push(this.mEditor.observeEvents(f.G.NodeChanged).subscribe(this.objectAddedHandler.bind(this))),(0,d.isNullOrUndefined)(this.mObject)){var p=this.mEditor.getSceneManager().getActiveProductNode();(0,d.isNullOrUndefined)(p)||(0,d.isNullOrUndefined)(p.getRenderObject())||(this.mObject=p.getRenderObject().get3DObject(),this.attachConstrols())}}},{key:"OnDetached",value:function(){(0,d.isNullOrUndefined)(this.mControls)||(this.mControls.removeEventListener("change",this.onControlsChanged.bind(this)),this.mControls.removeEventListener("zoom",this.onZoomChanged.bind(this)),this.mControls.dispose(),this.mControls=null),this.unregisterMessageHandler(l.c.TypeRTTI),this.unregisterMessageHandler(c.I.TypeRTTI),this.unregisterMessageHandler(y.E.TypeRTTI),this.mSubscriptions.splice(0).forEach((function(e){return e.unsubscribe()})),(0,d.isNullOrUndefined)(this.mCamAnimate)||(this.mCamAnimate.unsubscribe(),this.mCamAnimate=null),(0,d.isNullOrUndefined)(this.mControlChange)||(this.mControlChange.unsubscribe(),this.mControlChange=null)}},{key:"objectAddedHandler",value:function(e){var t=e.getData();if(!0===t.isObject3D&&(0,d.isNullOrUndefined)(this.mObject)){var n=this.findSceneMesh(t);(0,d.isNullOrUndefined)(n)||(this.mObject=n,this.attachConstrols())}}},{key:"objectRemovedHandler",value:function(e){var t=e.getData();!0!==t.isObject3D||(0,d.isNullOrUndefined)(this.mObject)||t.uuid===this.mObject.uuid&&this.detachControls()}},{key:"findSceneMesh",value:function(e){if((0,d.isNullOrUndefined)(e))return null;if(!(0,d.isNullOrUndefined)(e.userData)&&!(0,d.isNullOrUndefined)(e.userData.sceneObjectRef)){var t=e.userData.sceneObjectRef;if(!(0,d.isNullOrUndefined)(t)&&t.isDerivedOfTypeName("ConfigurableNode"))return e}return this.findSceneMesh(e.parent)}},{key:"attachConstrols",value:function(){if(!(0,d.isNullOrUndefined)(this.mObject)){this.mControls=new TurntableControls(this.mCamera,this.mObject,new THREE.Vector3(0,0,0),this.mDirection==r.Phi?new THREE.Vector3(1,0,0):new THREE.Vector3(0,1,0),this.mEditor.getRenderer().domElement),this.mControls.enabled=!0,this.mControls.rotateSpeed=this.mRotationSpeed,(0,d.isNullOrUndefined)(this.mDampFactor)?this.mControls.enableDamping=!1:(this.mControls.enableDamping=!0,this.mControls.dampingFactor=this.mDampFactor);var e=new THREE.Vector3,t=new THREE.Spherical;e.applyQuaternion((new THREE.Quaternion).setFromUnitVectors(this.mCamera.up,new THREE.Vector3(0,1,0))),t.setFromVector3(e),t.makeSafe(),this.mDirection==r.Phi?(this.mControls.minPolarAngle=this.mMinPolar,this.mControls.maxPolarAngle=this.mMaxPolar,this.mControls.minAzimuthAngle=t.theta,this.mControls.maxAzimuthAngle=t.theta):(this.mControls.minAzimuthAngle=this.mMinAzimuth,this.mControls.maxAzimuthAngle=this.mMaxAzimuth,this.mControls.minPolarAngle=t.phi,this.mControls.maxPolarAngle=t.phi),this.setMaxZoom(this.mMaxZoom),this.setMinZoom(this.mMinZoom),this.mControls.addEventListener("change",this.onControlsChanged.bind(this)),this.mControls.addEventListener("zoom",this.onZoomChanged.bind(this))}}},{key:"detachControls",value:function(){this.mObject=null,this.mControls.object=null,this.mControls.enabled=!1}},{key:"enabled",value:function(e){this.mControls&&(this.mControls.enabled=e)}},{key:"onReset",value:function(){}},{key:"setMaxZoom",value:function(e){this.mMaxZoom=e,(0,d.isNullOrUndefined)(this.mControls)||(this.mControls.maxDistance=this.mMaxZoom)}},{key:"setMinZoom",value:function(e){this.mMinZoom=e,(0,d.isNullOrUndefined)(this.mControls)||(this.mControls.minDistance=this.mMinZoom)}},{key:"onControlsChanged",value:function(e){this.mControlChange.next(),this.getViewportRenderer().dispatchMessage(new p.c),this.getViewportRenderer().getEditor().dispatchEvent(f.G.RequestFrame)}},{key:"onZoomChanged",value:function(e){this.getViewportRenderer().getEditor().dispatchEvent(f.G.ZoomChanged)}}])&&b(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),O}(a.V);O.TypeRTTI=new u.r("ViewportControllerTurntableControls",a.V.TypeRTTI)},16957:function(e,t,n){"use strict";n.d(t,{V:function(){return f}}),n(68304),n(30489),n(41539),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(18743),o=n(90140);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function s(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(f,e);var t,n,r,o,i=(r=f,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=l(r);if(o){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return s(this,e)});function f(){return a(this,f),i.apply(this,arguments)}return t=f,(n=[{key:"getType",value:function(){return f.TypeRTTI}},{key:"getViewportRenderer",value:function(){return this.getParentObject()}},{key:"isAttachable",value:function(e){return e.isTypeName("ViewportRenderer")}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),f}(r.H);f.TypeRTTI=new o.r("ViewportController",r.H.TypeRTTI)},6892:function(e,t,n){"use strict";n.d(t,{g:function(){return v}}),n(41539),n(15581),n(2490),n(34514),n(54747),n(68304),n(30489),n(81299),n(12419),n(21703),n(69070),n(82526),n(41817),n(32165),n(66992),n(78783),n(33948);var r=n(78842),o=n(90140),i=n(73462),a=n(16011),u=n(79241),c=n(36298),s=n(46863),l=n(94110),f=n(13420);function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t){return h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},h(e,t)}function y(e,t){if(t&&("object"===p(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(v,e);var t,n,r,o,p=(r=v,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=m(r);if(o){var n=m(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return y(this,e)});function v(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,v),(n=p.call(this)).mControllers=new Array,n.mInitialized=!1,n.mEditor=e,n.mViewerComponent=t,n}return t=v,(n=[{key:"getType",value:function(){return v.TypeRTTI}},{key:"setViewContainer",value:function(e){this.mViewContainer=e}},{key:"getViewComponent",value:function(){return this.mViewerComponent}},{key:"getViewContainer",value:function(){return this.mViewContainer}},{key:"getEditor",value:function(){return this.mEditor}},{key:"initialize",value:function(){var e=this;this.mControllers.forEach((function(t){e.addComponent(t)})),this.mInitialized=!0}},{key:"dispose",value:function(){this.removeAllComponents(),this.mInitialized=!1}},{key:"resize",value:function(e,t){this.dispatchMessage(new i.N(e,t))}},{key:"mouseDown",value:function(e){this.dispatchMessage(new u.n("down",e))}},{key:"mouseUp",value:function(e){this.dispatchMessage(new u.n("up",e))}},{key:"mouseMove",value:function(e){this.dispatchMessage(new u.n("move",e))}},{key:"mouseLeave",value:function(e){this.dispatchMessage(new u.n("out",e))}},{key:"mouseDbClick",value:function(e){this.dispatchMessage(new u.n("dbclick",e))}},{key:"dragStart",value:function(e){this.dispatchMessage(new c.x("start",e.position,e.dragData))}},{key:"dragMove",value:function(e){this.dispatchMessage(new c.x("move",e.position,e.dragData))}},{key:"dragEnd",value:function(e){this.dispatchMessage(new c.x("leave",e.position,e.dragData))}},{key:"dropItem",value:function(e){this.dispatchMessage(new c.x("drop",e.position,e.dragData))}},{key:"update",value:function(e){this.dispatchMessage(new a.I(e))}},{key:"draw",value:function(e,t,n){this.dispatchMessage(new l.K(e,t,n))}},{key:"postDraw",value:function(e,t,n){this.dispatchMessage(new s.r(e,t,n))}},{key:"postEffects",value:function(e,t,n){this.dispatchMessage(new f.f(e,t,n))}},{key:"addController",value:function(e){this.mControllers.push(e),this.mInitialized&&this.addComponent(e)}}])&&d(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),v}(r.L);v.TypeRTTI=new o.r("ViewportRenderer",r.L.TypeRTTI)},19662:function(e,t,n){var r=n(17854),o=n(60614),i=n(66330),a=r.TypeError;e.exports=function(e){if(o(e))return e;throw a(i(e)+" is not a function")}},39483:function(e,t,n){var r=n(17854),o=n(4411),i=n(66330),a=r.TypeError;e.exports=function(e){if(o(e))return e;throw a(i(e)+" is not a constructor")}},96077:function(e,t,n){var r=n(17854),o=n(60614),i=r.String,a=r.TypeError;e.exports=function(e){if("object"==typeof e||o(e))return e;throw a("Can't set "+i(e)+" as a prototype")}},51223:function(e,t,n){var r=n(5112),o=n(70030),i=n(3070),a=r("unscopables"),u=Array.prototype;null==u[a]&&i.f(u,a,{configurable:!0,value:o(null)}),e.exports=function(e){u[a][e]=!0}},31530:function(e,t,n){"use strict";var r=n(28710).charAt;e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},25787:function(e,t,n){var r=n(17854),o=n(47976),i=r.TypeError;e.exports=function(e,t){if(o(t,e))return e;throw i("Incorrect invocation")}},19670:function(e,t,n){var r=n(17854),o=n(70111),i=r.String,a=r.TypeError;e.exports=function(e){if(o(e))return e;throw a(i(e)+" is not an object")}},24019:function(e){e.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},7556:function(e,t,n){var r=n(47293);e.exports=r((function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}))},90260:function(e,t,n){"use strict";var r,o,i,a=n(24019),u=n(19781),c=n(17854),s=n(60614),l=n(70111),f=n(92597),p=n(70648),d=n(66330),h=n(68880),y=n(98052),m=n(3070).f,v=n(47976),b=n(79518),g=n(27674),w=n(5112),_=n(69711),O=c.Int8Array,T=O&&O.prototype,R=c.Uint8ClampedArray,S=R&&R.prototype,E=O&&b(O),P=T&&b(T),x=Object.prototype,j=c.TypeError,C=w("toStringTag"),k=_("TYPED_ARRAY_TAG"),M=_("TYPED_ARRAY_CONSTRUCTOR"),D=a&&!!g&&"Opera"!==p(c.opera),A=!1,I={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},N={BigInt64Array:8,BigUint64Array:8},V=function(e){if(!l(e))return!1;var t=p(e);return f(I,t)||f(N,t)};for(r in I)(i=(o=c[r])&&o.prototype)?h(i,M,o):D=!1;for(r in N)(i=(o=c[r])&&o.prototype)&&h(i,M,o);if((!D||!s(E)||E===Function.prototype)&&(E=function(){throw j("Incorrect invocation")},D))for(r in I)c[r]&&g(c[r],E);if((!D||!P||P===x)&&(P=E.prototype,D))for(r in I)c[r]&&g(c[r].prototype,P);if(D&&b(S)!==P&&g(S,P),u&&!f(P,C))for(r in A=!0,m(P,C,{get:function(){return l(this)?this[k]:void 0}}),I)c[r]&&h(c[r],k,r);e.exports={NATIVE_ARRAY_BUFFER_VIEWS:D,TYPED_ARRAY_CONSTRUCTOR:M,TYPED_ARRAY_TAG:A&&k,aTypedArray:function(e){if(V(e))return e;throw j("Target is not a typed array")},aTypedArrayConstructor:function(e){if(s(e)&&(!g||v(E,e)))return e;throw j(d(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,t,n,r){if(u){if(n)for(var o in I){var i=c[o];if(i&&f(i.prototype,e))try{delete i.prototype[e]}catch(n){try{i.prototype[e]=t}catch(e){}}}P[e]&&!n||y(P,e,n?t:D&&T[e]||t,r)}},exportTypedArrayStaticMethod:function(e,t,n){var r,o;if(u){if(g){if(n)for(r in I)if((o=c[r])&&f(o,e))try{delete o[e]}catch(e){}if(E[e]&&!n)return;try{return y(E,e,n?t:D&&E[e]||t)}catch(e){}}for(r in I)!(o=c[r])||o[e]&&!n||y(o,e,t)}},isView:function(e){if(!l(e))return!1;var t=p(e);return"DataView"===t||f(I,t)||f(N,t)},isTypedArray:V,TypedArray:E,TypedArrayPrototype:P}},13331:function(e,t,n){"use strict";var r=n(17854),o=n(1702),i=n(19781),a=n(24019),u=n(76530),c=n(68880),s=n(89190),l=n(47293),f=n(25787),p=n(19303),d=n(17466),h=n(57067),y=n(11179),m=n(79518),v=n(27674),b=n(8006).f,g=n(3070).f,w=n(21285),_=n(41589),O=n(58003),T=n(29909),R=u.PROPER,S=u.CONFIGURABLE,E=T.get,P=T.set,x="ArrayBuffer",j="Wrong index",C=r.ArrayBuffer,k=C,M=k&&k.prototype,D=r.DataView,A=D&&D.prototype,I=Object.prototype,N=r.Array,V=r.RangeError,U=o(w),F=o([].reverse),B=y.pack,L=y.unpack,H=function(e){return[255&e]},z=function(e){return[255&e,e>>8&255]},q=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},G=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},W=function(e){return B(e,23,4)},Q=function(e){return B(e,52,8)},K=function(e,t){g(e.prototype,t,{get:function(){return E(this)[t]}})},Y=function(e,t,n,r){var o=h(n),i=E(e);if(o+t>i.byteLength)throw V(j);var a=E(i.buffer).bytes,u=o+i.byteOffset,c=_(a,u,u+t);return r?c:F(c)},Z=function(e,t,n,r,o,i){var a=h(n),u=E(e);if(a+t>u.byteLength)throw V(j);for(var c=E(u.buffer).bytes,s=a+u.byteOffset,l=r(+o),f=0;f<t;f++)c[s+f]=l[i?f:t-f-1]};if(a){var X=R&&C.name!==x;if(l((function(){C(1)}))&&l((function(){new C(-1)}))&&!l((function(){return new C,new C(1.5),new C(NaN),X&&!S})))X&&S&&c(C,"name",x);else{(k=function(e){return f(this,M),new C(h(e))}).prototype=M;for(var J,$=b(C),ee=0;$.length>ee;)(J=$[ee++])in k||c(k,J,C[J]);M.constructor=k}v&&m(A)!==I&&v(A,I);var te=new D(new k(2)),ne=o(A.setInt8);te.setInt8(0,2147483648),te.setInt8(1,2147483649),!te.getInt8(0)&&te.getInt8(1)||s(A,{setInt8:function(e,t){ne(this,e,t<<24>>24)},setUint8:function(e,t){ne(this,e,t<<24>>24)}},{unsafe:!0})}else M=(k=function(e){f(this,M);var t=h(e);P(this,{bytes:U(N(t),0),byteLength:t}),i||(this.byteLength=t)}).prototype,A=(D=function(e,t,n){f(this,A),f(e,M);var r=E(e).byteLength,o=p(t);if(o<0||o>r)throw V("Wrong offset");if(o+(n=void 0===n?r-o:d(n))>r)throw V("Wrong length");P(this,{buffer:e,byteLength:n,byteOffset:o}),i||(this.buffer=e,this.byteLength=n,this.byteOffset=o)}).prototype,i&&(K(k,"byteLength"),K(D,"buffer"),K(D,"byteLength"),K(D,"byteOffset")),s(A,{getInt8:function(e){return Y(this,1,e)[0]<<24>>24},getUint8:function(e){return Y(this,1,e)[0]},getInt16:function(e){var t=Y(this,2,e,arguments.length>1?arguments[1]:void 0);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=Y(this,2,e,arguments.length>1?arguments[1]:void 0);return t[1]<<8|t[0]},getInt32:function(e){return G(Y(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return G(Y(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return L(Y(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return L(Y(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,t){Z(this,1,e,H,t)},setUint8:function(e,t){Z(this,1,e,H,t)},setInt16:function(e,t){Z(this,2,e,z,t,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,t){Z(this,2,e,z,t,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,t){Z(this,4,e,q,t,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,t){Z(this,4,e,q,t,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,t){Z(this,4,e,W,t,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,t){Z(this,8,e,Q,t,arguments.length>2?arguments[2]:void 0)}});O(k,x),O(D,"DataView"),e.exports={ArrayBuffer:k,DataView:D}},1048:function(e,t,n){"use strict";var r=n(47908),o=n(51400),i=n(26244),a=Math.min;e.exports=[].copyWithin||function(e,t){var n=r(this),u=i(n),c=o(e,u),s=o(t,u),l=arguments.length>2?arguments[2]:void 0,f=a((void 0===l?u:o(l,u))-s,u-c),p=1;for(s<c&&c<s+f&&(p=-1,s+=f-1,c+=f-1);f-- >0;)s in n?n[c]=n[s]:delete n[c],c+=p,s+=p;return n}},21285:function(e,t,n){"use strict";var r=n(47908),o=n(51400),i=n(26244);e.exports=function(e){for(var t=r(this),n=i(t),a=arguments.length,u=o(a>1?arguments[1]:void 0,n),c=a>2?arguments[2]:void 0,s=void 0===c?n:o(c,n);s>u;)t[u++]=e;return t}},18533:function(e,t,n){"use strict";var r=n(42092).forEach,o=n(9341)("forEach");e.exports=o?[].forEach:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}},97745:function(e,t,n){var r=n(26244);e.exports=function(e,t){for(var n=0,o=r(t),i=new e(o);o>n;)i[n]=t[n++];return i}},48457:function(e,t,n){"use strict";var r=n(17854),o=n(49974),i=n(46916),a=n(47908),u=n(53411),c=n(97659),s=n(4411),l=n(26244),f=n(86135),p=n(18554),d=n(71246),h=r.Array;e.exports=function(e){var t=a(e),n=s(this),r=arguments.length,y=r>1?arguments[1]:void 0,m=void 0!==y;m&&(y=o(y,r>2?arguments[2]:void 0));var v,b,g,w,_,O,T=d(t),R=0;if(!T||this==h&&c(T))for(v=l(t),b=n?new this(v):h(v);v>R;R++)O=m?y(t[R],R):t[R],f(b,R,O);else for(_=(w=p(t,T)).next,b=n?new this:[];!(g=i(_,w)).done;R++)O=m?u(w,y,[g.value,R],!0):g.value,f(b,R,O);return b.length=R,b}},61386:function(e,t,n){var r=n(17854),o=n(49974),i=n(1702),a=n(68361),u=n(47908),c=n(34948),s=n(26244),l=n(70030),f=n(97745),p=r.Array,d=i([].push);e.exports=function(e,t,n,r){for(var i,h,y,m=u(e),v=a(m),b=o(t,n),g=l(null),w=s(v),_=0;w>_;_++)y=v[_],(h=c(b(y,_,m)))in g?d(g[h],y):g[h]=[y];if(r&&(i=r(m))!==p)for(h in g)g[h]=f(i,g[h]);return g}},41318:function(e,t,n){var r=n(45656),o=n(51400),i=n(26244),a=function(e){return function(t,n,a){var u,c=r(t),s=i(c),l=o(a,s);if(e&&n!=n){for(;s>l;)if((u=c[l++])!=u)return!0}else for(;s>l;l++)if((e||l in c)&&c[l]===n)return e||l||0;return!e&&-1}};e.exports={includes:a(!0),indexOf:a(!1)}},9671:function(e,t,n){var r=n(49974),o=n(68361),i=n(47908),a=n(26244),u=function(e){var t=1==e;return function(n,u,c){for(var s,l=i(n),f=o(l),p=r(u,c),d=a(f);d-- >0;)if(p(s=f[d],d,l))switch(e){case 0:return s;case 1:return d}return t?-1:void 0}};e.exports={findLast:u(0),findLastIndex:u(1)}},42092:function(e,t,n){var r=n(49974),o=n(1702),i=n(68361),a=n(47908),u=n(26244),c=n(65417),s=o([].push),l=function(e){var t=1==e,n=2==e,o=3==e,l=4==e,f=6==e,p=7==e,d=5==e||f;return function(h,y,m,v){for(var b,g,w=a(h),_=i(w),O=r(y,m),T=u(_),R=0,S=v||c,E=t?S(h,T):n||p?S(h,0):void 0;T>R;R++)if((d||R in _)&&(g=O(b=_[R],R,w),e))if(t)E[R]=g;else if(g)switch(e){case 3:return!0;case 5:return b;case 6:return R;case 2:s(E,b)}else switch(e){case 4:return!1;case 7:s(E,b)}return f?-1:o||l?l:E}};e.exports={forEach:l(0),map:l(1),filter:l(2),some:l(3),every:l(4),find:l(5),findIndex:l(6),filterReject:l(7)}},86583:function(e,t,n){"use strict";var r=n(22104),o=n(45656),i=n(19303),a=n(26244),u=n(9341),c=Math.min,s=[].lastIndexOf,l=!!s&&1/[1].lastIndexOf(1,-0)<0,f=u("lastIndexOf"),p=l||!f;e.exports=p?function(e){if(l)return r(s,this,arguments)||0;var t=o(this),n=a(t),u=n-1;for(arguments.length>1&&(u=c(u,i(arguments[1]))),u<0&&(u=n+u);u>=0;u--)if(u in t&&t[u]===e)return u||0;return-1}:s},81194:function(e,t,n){var r=n(47293),o=n(5112),i=n(7392),a=o("species");e.exports=function(e){return i>=51||!r((function(){var t=[];return(t.constructor={})[a]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},9341:function(e,t,n){"use strict";var r=n(47293);e.exports=function(e,t){var n=[][e];return!!n&&r((function(){n.call(null,t||function(){return 1},1)}))}},53671:function(e,t,n){var r=n(17854),o=n(19662),i=n(47908),a=n(68361),u=n(26244),c=r.TypeError,s=function(e){return function(t,n,r,s){o(n);var l=i(t),f=a(l),p=u(l),d=e?p-1:0,h=e?-1:1;if(r<2)for(;;){if(d in f){s=f[d],d+=h;break}if(d+=h,e?d<0:p<=d)throw c("Reduce of empty array with no initial value")}for(;e?d>=0:p>d;d+=h)d in f&&(s=n(s,f[d],d,l));return s}};e.exports={left:s(!1),right:s(!0)}},41589:function(e,t,n){var r=n(17854),o=n(51400),i=n(26244),a=n(86135),u=r.Array,c=Math.max;e.exports=function(e,t,n){for(var r=i(e),s=o(t,r),l=o(void 0===n?r:n,r),f=u(c(l-s,0)),p=0;s<l;s++,p++)a(f,p,e[s]);return f.length=p,f}},50206:function(e,t,n){var r=n(1702);e.exports=r([].slice)},94362:function(e,t,n){var r=n(41589),o=Math.floor,i=function(e,t){var n=e.length,c=o(n/2);return n<8?a(e,t):u(e,i(r(e,0,c),t),i(r(e,c),t),t)},a=function(e,t){for(var n,r,o=e.length,i=1;i<o;){for(r=i,n=e[i];r&&t(e[r-1],n)>0;)e[r]=e[--r];r!==i++&&(e[r]=n)}return e},u=function(e,t,n,r){for(var o=t.length,i=n.length,a=0,u=0;a<o||u<i;)e[a+u]=a<o&&u<i?r(t[a],n[u])<=0?t[a++]:n[u++]:a<o?t[a++]:n[u++];return e};e.exports=i},77475:function(e,t,n){var r=n(17854),o=n(43157),i=n(4411),a=n(70111),u=n(5112)("species"),c=r.Array;e.exports=function(e){var t;return o(e)&&(t=e.constructor,(i(t)&&(t===c||o(t.prototype))||a(t)&&null===(t=t[u]))&&(t=void 0)),void 0===t?c:t}},65417:function(e,t,n){var r=n(77475);e.exports=function(e,t){return new(r(e))(0===t?0:t)}},21843:function(e,t,n){var r=n(26244);e.exports=function(e,t){for(var n=r(e),o=new t(n),i=0;i<n;i++)o[i]=e[n-i-1];return o}},1654:function(e,t,n){var r=n(26244),o=n(51400),i=n(19303),a=TypeError,u=Math.max,c=Math.min;e.exports=function(e,t,n){var s,l,f,p,d=n[0],h=n[1],y=r(e),m=o(d,y),v=n.length,b=0;if(0===v?s=l=0:1===v?(s=0,l=y-m):(s=v-2,l=c(u(i(h),0),y-m)),(f=y+s-l)>9007199254740991)throw a("Maximum allowed length exceeded");for(p=new t(f);b<m;b++)p[b]=e[b];for(;b<m+s;b++)p[b]=n[b-m+2];for(;b<f;b++)p[b]=e[b+l-s];return p}},60956:function(e,t,n){"use strict";var r=n(35005),o=n(1702),i=n(19662),a=n(26244),u=n(47908),c=n(65417),s=r("Map"),l=s.prototype,f=o(l.forEach),p=o(l.has),d=o(l.set),h=o([].push);e.exports=function(e){var t,n,r,o=u(this),l=a(o),y=c(o,0),m=new s,v=null!=e?i(e):function(e){return e};for(t=0;t<l;t++)r=v(n=o[t]),p(m,r)||d(m,r,n);return f(m,(function(e){h(y,e)})),y}},11572:function(e,t,n){var r=n(17854),o=n(26244),i=n(19303),a=r.RangeError;e.exports=function(e,t,n,r){var u=o(e),c=i(n),s=c<0?u+c:c;if(s>=u||s<0)throw a("Incorrect index");for(var l=new t(u),f=0;f<u;f++)l[f]=f===s?r:e[f];return l}},45348:function(e,t,n){"use strict";var r=n(46916),o=n(19662),i=n(19670),a=n(70030),u=n(68880),c=n(89190),s=n(5112),l=n(29909),f=n(35005),p=n(58173),d=n(66462),h=f("Promise"),y="AsyncIteratorProxy",m=l.set,v=l.getterFor(y),b=s("toStringTag");e.exports=function(e,t){var n=function(e){e.type=y,e.next=o(e.iterator.next),e.done=!1,e.ignoreArgument=!t,m(this,e)};return n.prototype=c(a(d),{next:function(n){var o=this,a=!!arguments.length;return new h((function(u){var c=v(o),s=a?[c.ignoreArgument?void 0:n]:t?[]:[void 0];c.ignoreArgument=!1,u(c.done?{done:!0,value:void 0}:i(r(e,c,h,s)))}))},return:function(e){var t=this;return new h((function(n,o){var a=v(t),u=a.iterator;a.done=!0;var c=p(u,"return");if(void 0===c)return n({done:!0,value:e});h.resolve(r(c,u,e)).then((function(t){i(t),n({done:!0,value:e})}),o)}))},throw:function(e){var t=this;return new h((function(n,o){var i=v(t),a=i.iterator;i.done=!0;var u=p(a,"throw");if(void 0===u)return o(e);n(r(u,a,e))}))}}),t||u(n.prototype,b,"Generator"),n}},12269:function(e,t,n){"use strict";var r=n(17854),o=n(46916),i=n(19662),a=n(19670),u=n(35005),c=n(58173),s=r.TypeError,l=function(e){var t=0==e,n=1==e,r=2==e,l=3==e;return function(e,f,p){a(e);var d=u("Promise"),h=i(e.next),y=0,m=void 0!==f;return!m&&t||i(f),new d((function(i,u){var v=function(t,n){try{var r=c(e,"return");if(r)return d.resolve(o(r,e)).then((function(){t(n)}),(function(e){u(e)}))}catch(e){return u(e)}t(n)},b=function(e){v(u,e)},g=function(){try{if(t&&y>9007199254740991&&m)throw s("The allowed number of iterations has been exceeded");d.resolve(a(o(h,e))).then((function(e){try{if(a(e).done)t?(p.length=y,i(p)):i(!l&&(r||void 0));else{var o=e.value;m?d.resolve(t?f(o,y):f(o)).then((function(e){n?g():r?e?g():v(i,!1):t?(p[y++]=e,g()):e?v(i,l||o):g()}),b):(p[y++]=o,g())}}catch(e){b(e)}}),b)}catch(e){b(e)}};g()}))}};e.exports={toArray:l(0),forEach:l(1),every:l(2),some:l(3),find:l(4)}},66462:function(e,t,n){var r,o,i=n(17854),a=n(5465),u=n(60614),c=n(70030),s=n(79518),l=n(98052),f=n(5112),p=n(31913),d=f("asyncIterator"),h=i.AsyncIterator,y=a.AsyncIteratorPrototype;if(y)r=y;else if(u(h))r=h.prototype;else if(a.USE_FUNCTION_CONSTRUCTOR||i.USE_FUNCTION_CONSTRUCTOR)try{o=s(s(s(Function("return async function*(){}()")()))),s(o)===Object.prototype&&(r=o)}catch(e){}r?p&&(r=c(r)):r={},u(r[d])||l(r,d,(function(){return this})),e.exports=r},14170:function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n={},r=0;r<66;r++)n[t.charAt(r)]=r;e.exports={itoc:t,ctoi:n}},53411:function(e,t,n){var r=n(19670),o=n(99212);e.exports=function(e,t,n,i){try{return i?t(r(n)[0],n[1]):t(n)}catch(t){o(e,"throw",t)}}},17072:function(e,t,n){var r=n(5112)("iterator"),o=!1;try{var i=0,a={next:function(){return{done:!!i++}},return:function(){o=!0}};a[r]=function(){return this},Array.from(a,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!o)return!1;var n=!1;try{var i={};i[r]=function(){return{next:function(){return{done:n=!0}}}},e(i)}catch(e){}return n}},84326:function(e,t,n){var r=n(1702),o=r({}.toString),i=r("".slice);e.exports=function(e){return i(o(e),8,-1)}},70648:function(e,t,n){var r=n(17854),o=n(51694),i=n(60614),a=n(84326),u=n(5112)("toStringTag"),c=r.Object,s="Arguments"==a(function(){return arguments}());e.exports=o?a:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=c(e),u))?n:s?a(t):"Object"==(r=a(t))&&i(t.callee)?"Arguments":r}},77741:function(e,t,n){var r=n(1702),o=Error,i=r("".replace),a=String(o("zxcasd").stack),u=/\n\s*at [^:]*:[^\n]*/,c=u.test(a);e.exports=function(e,t){if(c&&"string"==typeof e&&!o.prepareStackTrace)for(;t--;)e=i(e,u,"");return e}},34092:function(e,t,n){"use strict";var r=n(46916),o=n(19662),i=n(19670);e.exports=function(){for(var e,t=i(this),n=o(t.delete),a=!0,u=0,c=arguments.length;u<c;u++)e=r(n,t,arguments[u]),a=a&&e;return!!a}},95631:function(e,t,n){"use strict";var r=n(3070).f,o=n(70030),i=n(89190),a=n(49974),u=n(25787),c=n(20408),s=n(70654),l=n(96340),f=n(19781),p=n(62423).fastKey,d=n(29909),h=d.set,y=d.getterFor;e.exports={getConstructor:function(e,t,n,s){var l=e((function(e,r){u(e,d),h(e,{type:t,index:o(null),first:void 0,last:void 0,size:0}),f||(e.size=0),null!=r&&c(r,e[s],{that:e,AS_ENTRIES:n})})),d=l.prototype,m=y(t),v=function(e,t,n){var r,o,i=m(e),a=b(e,t);return a?a.value=n:(i.last=a={index:o=p(t,!0),key:t,value:n,previous:r=i.last,next:void 0,removed:!1},i.first||(i.first=a),r&&(r.next=a),f?i.size++:e.size++,"F"!==o&&(i.index[o]=a)),e},b=function(e,t){var n,r=m(e),o=p(t);if("F"!==o)return r.index[o];for(n=r.first;n;n=n.next)if(n.key==t)return n};return i(d,{clear:function(){for(var e=m(this),t=e.index,n=e.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete t[n.index],n=n.next;e.first=e.last=void 0,f?e.size=0:this.size=0},delete:function(e){var t=this,n=m(t),r=b(t,e);if(r){var o=r.next,i=r.previous;delete n.index[r.index],r.removed=!0,i&&(i.next=o),o&&(o.previous=i),n.first==r&&(n.first=o),n.last==r&&(n.last=i),f?n.size--:t.size--}return!!r},forEach:function(e){for(var t,n=m(this),r=a(e,arguments.length>1?arguments[1]:void 0);t=t?t.next:n.first;)for(r(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!b(this,e)}}),i(d,n?{get:function(e){var t=b(this,e);return t&&t.value},set:function(e,t){return v(this,0===e?0:e,t)}}:{add:function(e){return v(this,e=0===e?0:e,e)}}),f&&r(d,"size",{get:function(){return m(this).size}}),l},setStrong:function(e,t,n){var r=t+" Iterator",o=y(t),i=y(r);s(e,t,(function(e,t){h(this,{type:r,target:e,state:o(e),kind:t,last:void 0})}),(function(){for(var e=i(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),l(t)}}},77710:function(e,t,n){"use strict";var r=n(82109),o=n(17854),i=n(1702),a=n(54705),u=n(98052),c=n(62423),s=n(20408),l=n(25787),f=n(60614),p=n(70111),d=n(47293),h=n(17072),y=n(58003),m=n(79587);e.exports=function(e,t,n){var v=-1!==e.indexOf("Map"),b=-1!==e.indexOf("Weak"),g=v?"set":"add",w=o[e],_=w&&w.prototype,O=w,T={},R=function(e){var t=i(_[e]);u(_,e,"add"==e?function(e){return t(this,0===e?0:e),this}:"delete"==e?function(e){return!(b&&!p(e))&&t(this,0===e?0:e)}:"get"==e?function(e){return b&&!p(e)?void 0:t(this,0===e?0:e)}:"has"==e?function(e){return!(b&&!p(e))&&t(this,0===e?0:e)}:function(e,n){return t(this,0===e?0:e,n),this})};if(a(e,!f(w)||!(b||_.forEach&&!d((function(){(new w).entries().next()})))))O=n.getConstructor(t,e,v,g),c.enable();else if(a(e,!0)){var S=new O,E=S[g](b?{}:-0,1)!=S,P=d((function(){S.has(1)})),x=h((function(e){new w(e)})),j=!b&&d((function(){for(var e=new w,t=5;t--;)e[g](t,t);return!e.has(-0)}));x||((O=t((function(e,t){l(e,_);var n=m(new w,e,O);return null!=t&&s(t,n[g],{that:n,AS_ENTRIES:v}),n}))).prototype=_,_.constructor=O),(P||j)&&(R("delete"),R("has"),v&&R("get")),(j||E)&&R(g),b&&_.clear&&delete _.clear}return T[e]=O,r({global:!0,constructor:!0,forced:O!=w},T),y(O,e),b||n.setStrong(O,e,v),O}},99920:function(e,t,n){var r=n(92597),o=n(53887),i=n(31236),a=n(3070);e.exports=function(e,t,n){for(var u=o(t),c=a.f,s=i.f,l=0;l<u.length;l++){var f=u[l];r(e,f)||n&&r(n,f)||c(e,f,s(t,f))}}},84964:function(e,t,n){var r=n(5112)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[r]=!1,"/./"[e](t)}catch(e){}}return!1}},49920:function(e,t,n){var r=n(47293);e.exports=!r((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},14230:function(e,t,n){var r=n(1702),o=n(84488),i=n(41340),a=/"/g,u=r("".replace);e.exports=function(e,t,n,r){var c=i(o(e)),s="<"+t;return""!==n&&(s+=" "+n+'="'+u(i(r),a,"&quot;")+'"'),s+">"+c+"</"+t+">"}},24994:function(e,t,n){"use strict";var r=n(13383).IteratorPrototype,o=n(70030),i=n(79114),a=n(58003),u=n(97497),c=function(){return this};e.exports=function(e,t,n,s){var l=t+" Iterator";return e.prototype=o(r,{next:i(+!s,n)}),a(e,l,!1,!0),u[l]=c,e}},68880:function(e,t,n){var r=n(19781),o=n(3070),i=n(79114);e.exports=r?function(e,t,n){return o.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},79114:function(e){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},86135:function(e,t,n){"use strict";var r=n(34948),o=n(3070),i=n(79114);e.exports=function(e,t,n){var a=r(t);a in e?o.f(e,a,i(0,n)):e[a]=n}},47045:function(e,t,n){var r=n(56339),o=n(3070);e.exports=function(e,t,n){return n.get&&r(n.get,t,{getter:!0}),n.set&&r(n.set,t,{setter:!0}),o.f(e,t,n)}},98052:function(e,t,n){var r=n(17854),o=n(60614),i=n(68880),a=n(56339),u=n(83505);e.exports=function(e,t,n,c){var s=!!c&&!!c.unsafe,l=!!c&&!!c.enumerable,f=!!c&&!!c.noTargetGet,p=c&&void 0!==c.name?c.name:t;return o(n)&&a(n,p,c),e===r?(l?e[t]=n:u(t,n),e):(s?!f&&e[t]&&(l=!0):delete e[t],l?e[t]=n:i(e,t,n),e)}},89190:function(e,t,n){var r=n(98052);e.exports=function(e,t,n){for(var o in t)r(e,o,t[o],n);return e}},70654:function(e,t,n){"use strict";var r=n(82109),o=n(46916),i=n(31913),a=n(76530),u=n(60614),c=n(24994),s=n(79518),l=n(27674),f=n(58003),p=n(68880),d=n(98052),h=n(5112),y=n(97497),m=n(13383),v=a.PROPER,b=a.CONFIGURABLE,g=m.IteratorPrototype,w=m.BUGGY_SAFARI_ITERATORS,_=h("iterator"),O="keys",T="values",R="entries",S=function(){return this};e.exports=function(e,t,n,a,h,m,E){c(n,t,a);var P,x,j,C=function(e){if(e===h&&I)return I;if(!w&&e in D)return D[e];switch(e){case O:case T:case R:return function(){return new n(this,e)}}return function(){return new n(this)}},k=t+" Iterator",M=!1,D=e.prototype,A=D[_]||D["@@iterator"]||h&&D[h],I=!w&&A||C(h),N="Array"==t&&D.entries||A;if(N&&(P=s(N.call(new e)))!==Object.prototype&&P.next&&(i||s(P)===g||(l?l(P,g):u(P[_])||d(P,_,S)),f(P,k,!0,!0),i&&(y[k]=S)),v&&h==T&&A&&A.name!==T&&(!i&&b?p(D,"name",T):(M=!0,I=function(){return o(A,this)})),h)if(x={values:C(T),keys:m?I:C(O),entries:C(R)},E)for(j in x)(w||M||!(j in D))&&d(D,j,x[j]);else r({target:t,proto:!0,forced:w||M},x);return i&&!E||D[_]===I||d(D,_,I,{name:h}),y[t]=I,x}},97235:function(e,t,n){var r=n(40857),o=n(92597),i=n(6061),a=n(3070).f;e.exports=function(e){var t=r.Symbol||(r.Symbol={});o(t,e)||a(t,e,{value:i.f(e)})}},19781:function(e,t,n){var r=n(47293);e.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},80317:function(e,t,n){var r=n(17854),o=n(70111),i=r.document,a=o(i)&&o(i.createElement);e.exports=function(e){return a?i.createElement(e):{}}},93678:function(e){e.exports={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}},48324:function(e){e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},98509:function(e,t,n){var r=n(80317)("span").classList,o=r&&r.constructor&&r.constructor.prototype;e.exports=o===Object.prototype?void 0:o},68886:function(e,t,n){var r=n(88113).match(/firefox\/(\d+)/i);e.exports=!!r&&+r[1]},7871:function(e){e.exports="object"==typeof window&&"object"!=typeof Deno},30256:function(e,t,n){var r=n(88113);e.exports=/MSIE|Trident/.test(r)},71528:function(e,t,n){var r=n(88113),o=n(17854);e.exports=/ipad|iphone|ipod/i.test(r)&&void 0!==o.Pebble},6833:function(e,t,n){var r=n(88113);e.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(r)},35268:function(e,t,n){var r=n(84326),o=n(17854);e.exports="process"==r(o.process)},71036:function(e,t,n){var r=n(88113);e.exports=/web0s(?!.*chrome)/i.test(r)},88113:function(e,t,n){var r=n(35005);e.exports=r("navigator","userAgent")||""},7392:function(e,t,n){var r,o,i=n(17854),a=n(88113),u=i.process,c=i.Deno,s=u&&u.versions||c&&c.version,l=s&&s.v8;l&&(o=(r=l.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!o&&a&&(!(r=a.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=a.match(/Chrome\/(\d+)/))&&(o=+r[1]),e.exports=o},98008:function(e,t,n){var r=n(88113).match(/AppleWebKit\/(\d+)\./);e.exports=!!r&&+r[1]},80748:function(e){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},22914:function(e,t,n){var r=n(47293),o=n(79114);e.exports=!r((function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",o(1,7)),7!==e.stack)}))},7762:function(e,t,n){"use strict";var r=n(19781),o=n(47293),i=n(19670),a=n(70030),u=n(56277),c=Error.prototype.toString,s=o((function(){if(r){var e=a(Object.defineProperty({},"name",{get:function(){return this===e}}));if("true"!==c.call(e))return!0}return"2: 1"!==c.call({message:1,name:2})||"Error"!==c.call({})}));e.exports=s?function(){var e=i(this),t=u(e.name,"Error"),n=u(e.message);return t?n?t+": "+n:t:n}:c},82109:function(e,t,n){var r=n(17854),o=n(31236).f,i=n(68880),a=n(98052),u=n(83505),c=n(99920),s=n(54705);e.exports=function(e,t){var n,l,f,p,d,h=e.target,y=e.global,m=e.stat;if(n=y?r:m?r[h]||u(h,{}):(r[h]||{}).prototype)for(l in t){if(p=t[l],f=e.noTargetGet?(d=o(n,l))&&d.value:n[l],!s(y?l:h+(m?".":"#")+l,e.forced)&&void 0!==f){if(typeof p==typeof f)continue;c(p,f)}(e.sham||f&&f.sham)&&i(p,"sham",!0),a(n,l,p,e)}}},47293:function(e){e.exports=function(e){try{return!!e()}catch(e){return!0}}},27007:function(e,t,n){"use strict";n(74916);var r=n(1702),o=n(98052),i=n(22261),a=n(47293),u=n(5112),c=n(68880),s=u("species"),l=RegExp.prototype;e.exports=function(e,t,n,f){var p=u(e),d=!a((function(){var t={};return t[p]=function(){return 7},7!=""[e](t)})),h=d&&!a((function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[s]=function(){return n},n.flags="",n[p]=/./[p]),n.exec=function(){return t=!0,null},n[p](""),!t}));if(!d||!h||n){var y=r(/./[p]),m=t(p,""[e],(function(e,t,n,o,a){var u=r(e),c=t.exec;return c===i||c===l.exec?d&&!a?{done:!0,value:y(t,n,o)}:{done:!0,value:u(n,t,o)}:{done:!1}}));o(String.prototype,e,m[0]),o(l,p,m[1])}f&&c(l[p],"sham",!0)}},76677:function(e,t,n){var r=n(47293);e.exports=!r((function(){return Object.isExtensible(Object.preventExtensions({}))}))},22104:function(e,t,n){var r=n(34374),o=Function.prototype,i=o.apply,a=o.call;e.exports="object"==typeof Reflect&&Reflect.apply||(r?a.bind(i):function(){return a.apply(i,arguments)})},49974:function(e,t,n){var r=n(1702),o=n(19662),i=n(34374),a=r(r.bind);e.exports=function(e,t){return o(e),void 0===t?e:i?a(e,t):function(){return e.apply(t,arguments)}}},34374:function(e,t,n){var r=n(47293);e.exports=!r((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},27065:function(e,t,n){"use strict";var r=n(17854),o=n(1702),i=n(19662),a=n(70111),u=n(92597),c=n(50206),s=n(34374),l=r.Function,f=o([].concat),p=o([].join),d={},h=function(e,t,n){if(!u(d,t)){for(var r=[],o=0;o<t;o++)r[o]="a["+o+"]";d[t]=l("C,a","return new C("+p(r,",")+")")}return d[t](e,n)};e.exports=s?l.bind:function(e){var t=i(this),n=t.prototype,r=c(arguments,1),o=function(){var n=f(r,c(arguments));return this instanceof o?h(t,n.length,n):t.apply(e,n)};return a(n)&&(o.prototype=n),o}},46916:function(e,t,n){var r=n(34374),o=Function.prototype.call;e.exports=r?o.bind(o):function(){return o.apply(o,arguments)}},76530:function(e,t,n){var r=n(19781),o=n(92597),i=Function.prototype,a=r&&Object.getOwnPropertyDescriptor,u=o(i,"name"),c=u&&"something"===function(){}.name,s=u&&(!r||r&&a(i,"name").configurable);e.exports={EXISTS:u,PROPER:c,CONFIGURABLE:s}},1702:function(e,t,n){var r=n(34374),o=Function.prototype,i=o.bind,a=o.call,u=r&&i.bind(a,a);e.exports=r?function(e){return e&&u(e)}:function(e){return e&&function(){return a.apply(e,arguments)}}},35005:function(e,t,n){var r=n(17854),o=n(60614),i=function(e){return o(e)?e:void 0};e.exports=function(e,t){return arguments.length<2?i(r[e]):r[e]&&r[e][t]}},71246:function(e,t,n){var r=n(70648),o=n(58173),i=n(97497),a=n(5112)("iterator");e.exports=function(e){if(null!=e)return o(e,a)||o(e,"@@iterator")||i[r(e)]}},18554:function(e,t,n){var r=n(17854),o=n(46916),i=n(19662),a=n(19670),u=n(66330),c=n(71246),s=r.TypeError;e.exports=function(e,t){var n=arguments.length<2?c(e):t;if(i(n))return a(o(n,e));throw s(u(e)+" is not iterable")}},54647:function(e,t,n){var r=n(46916);e.exports=function(e){return r(Map.prototype.entries,e)}},58173:function(e,t,n){var r=n(19662);e.exports=function(e,t){var n=e[t];return null==n?void 0:r(n)}},10647:function(e,t,n){var r=n(1702),o=n(47908),i=Math.floor,a=r("".charAt),u=r("".replace),c=r("".slice),s=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,l=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,n,r,f,p){var d=n+e.length,h=r.length,y=l;return void 0!==f&&(f=o(f),y=s),u(p,y,(function(o,u){var s;switch(a(u,0)){case"$":return"$";case"&":return e;case"`":return c(t,0,n);case"'":return c(t,d);case"<":s=f[c(u,1,-1)];break;default:var l=+u;if(0===l)return o;if(l>h){var p=i(l/10);return 0===p?o:p<=h?void 0===r[p-1]?a(u,1):r[p-1]+a(u,1):o}s=r[l-1]}return void 0===s?"":s}))}},17854:function(e,t,n){var r=function(e){return e&&e.Math==Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||function(){return this}()||Function("return this")()},92597:function(e,t,n){var r=n(1702),o=n(47908),i=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return i(o(e),t)}},3501:function(e){e.exports={}},842:function(e,t,n){var r=n(17854);e.exports=function(e,t){var n=r.console;n&&n.error&&(1==arguments.length?n.error(e):n.error(e,t))}},60490:function(e,t,n){var r=n(35005);e.exports=r("document","documentElement")},64664:function(e,t,n){var r=n(19781),o=n(47293),i=n(80317);e.exports=!r&&!o((function(){return 7!=Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a}))},11179:function(e,t,n){var r=n(17854).Array,o=Math.abs,i=Math.pow,a=Math.floor,u=Math.log,c=Math.LN2;e.exports={pack:function(e,t,n){var s,l,f,p=r(n),d=8*n-t-1,h=(1<<d)-1,y=h>>1,m=23===t?i(2,-24)-i(2,-77):0,v=e<0||0===e&&1/e<0?1:0,b=0;for((e=o(e))!=e||e===1/0?(l=e!=e?1:0,s=h):(s=a(u(e)/c),e*(f=i(2,-s))<1&&(s--,f*=2),(e+=s+y>=1?m/f:m*i(2,1-y))*f>=2&&(s++,f/=2),s+y>=h?(l=0,s=h):s+y>=1?(l=(e*f-1)*i(2,t),s+=y):(l=e*i(2,y-1)*i(2,t),s=0));t>=8;)p[b++]=255&l,l/=256,t-=8;for(s=s<<t|l,d+=t;d>0;)p[b++]=255&s,s/=256,d-=8;return p[--b]|=128*v,p},unpack:function(e,t){var n,r=e.length,o=8*r-t-1,a=(1<<o)-1,u=a>>1,c=o-7,s=r-1,l=e[s--],f=127&l;for(l>>=7;c>0;)f=256*f+e[s--],c-=8;for(n=f&(1<<-c)-1,f>>=-c,c+=t;c>0;)n=256*n+e[s--],c-=8;if(0===f)f=1-u;else{if(f===a)return n?NaN:l?-1/0:1/0;n+=i(2,t),f-=u}return(l?-1:1)*n*i(2,f-t)}}},68361:function(e,t,n){var r=n(17854),o=n(1702),i=n(47293),a=n(84326),u=r.Object,c=o("".split);e.exports=i((function(){return!u("z").propertyIsEnumerable(0)}))?function(e){return"String"==a(e)?c(e,""):u(e)}:u},79587:function(e,t,n){var r=n(60614),o=n(70111),i=n(27674);e.exports=function(e,t,n){var a,u;return i&&r(a=t.constructor)&&a!==n&&o(u=a.prototype)&&u!==n.prototype&&i(e,u),e}},42788:function(e,t,n){var r=n(1702),o=n(60614),i=n(5465),a=r(Function.toString);o(i.inspectSource)||(i.inspectSource=function(e){return a(e)}),e.exports=i.inspectSource},58340:function(e,t,n){var r=n(70111),o=n(68880);e.exports=function(e,t){r(t)&&"cause"in t&&o(e,"cause",t.cause)}},62423:function(e,t,n){var r=n(82109),o=n(1702),i=n(3501),a=n(70111),u=n(92597),c=n(3070).f,s=n(8006),l=n(1156),f=n(52050),p=n(69711),d=n(76677),h=!1,y=p("meta"),m=0,v=function(e){c(e,y,{value:{objectID:"O"+m++,weakData:{}}})},b=e.exports={enable:function(){b.enable=function(){},h=!0;var e=s.f,t=o([].splice),n={};n[y]=1,e(n).length&&(s.f=function(n){for(var r=e(n),o=0,i=r.length;o<i;o++)if(r[o]===y){t(r,o,1);break}return r},r({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:l.f}))},fastKey:function(e,t){if(!a(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!u(e,y)){if(!f(e))return"F";if(!t)return"E";v(e)}return e[y].objectID},getWeakData:function(e,t){if(!u(e,y)){if(!f(e))return!0;if(!t)return!1;v(e)}return e[y].weakData},onFreeze:function(e){return d&&h&&f(e)&&!u(e,y)&&v(e),e}};i[y]=!0},29909:function(e,t,n){var r,o,i,a=n(68536),u=n(17854),c=n(1702),s=n(70111),l=n(68880),f=n(92597),p=n(5465),d=n(6200),h=n(3501),y="Object already initialized",m=u.TypeError,v=u.WeakMap;if(a||p.state){var b=p.state||(p.state=new v),g=c(b.get),w=c(b.has),_=c(b.set);r=function(e,t){if(w(b,e))throw new m(y);return t.facade=e,_(b,e,t),t},o=function(e){return g(b,e)||{}},i=function(e){return w(b,e)}}else{var O=d("state");h[O]=!0,r=function(e,t){if(f(e,O))throw new m(y);return t.facade=e,l(e,O,t),t},o=function(e){return f(e,O)?e[O]:{}},i=function(e){return f(e,O)}}e.exports={set:r,get:o,has:i,enforce:function(e){return i(e)?o(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!s(t)||(n=o(t)).type!==e)throw m("Incompatible receiver, "+e+" required");return n}}}},97659:function(e,t,n){var r=n(5112),o=n(97497),i=r("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(o.Array===e||a[i]===e)}},43157:function(e,t,n){var r=n(84326);e.exports=Array.isArray||function(e){return"Array"==r(e)}},60614:function(e){e.exports=function(e){return"function"==typeof e}},4411:function(e,t,n){var r=n(1702),o=n(47293),i=n(60614),a=n(70648),u=n(35005),c=n(42788),s=function(){},l=[],f=u("Reflect","construct"),p=/^\s*(?:class|function)\b/,d=r(p.exec),h=!p.exec(s),y=function(e){if(!i(e))return!1;try{return f(s,l,e),!0}catch(e){return!1}},m=function(e){if(!i(e))return!1;switch(a(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return h||!!d(p,c(e))}catch(e){return!0}};m.sham=!0,e.exports=!f||o((function(){var e;return y(y.call)||!y(Object)||!y((function(){e=!0}))||e}))?m:y},45032:function(e,t,n){var r=n(92597);e.exports=function(e){return void 0!==e&&(r(e,"value")||r(e,"writable"))}},54705:function(e,t,n){var r=n(47293),o=n(60614),i=/#|\.prototype\./,a=function(e,t){var n=c[u(e)];return n==l||n!=s&&(o(t)?r(t):!!t)},u=a.normalize=function(e){return String(e).replace(i,".").toLowerCase()},c=a.data={},s=a.NATIVE="N",l=a.POLYFILL="P";e.exports=a},55988:function(e,t,n){var r=n(70111),o=Math.floor;e.exports=Number.isInteger||function(e){return!r(e)&&isFinite(e)&&o(e)===e}},70111:function(e,t,n){var r=n(60614);e.exports=function(e){return"object"==typeof e?null!==e:r(e)}},31913:function(e){e.exports=!1},47850:function(e,t,n){var r=n(70111),o=n(84326),i=n(5112)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[i])?!!t:"RegExp"==o(e))}},52190:function(e,t,n){var r=n(17854),o=n(35005),i=n(60614),a=n(47976),u=n(43307),c=r.Object;e.exports=u?function(e){return"symbol"==typeof e}:function(e){var t=o("Symbol");return i(t)&&a(t.prototype,c(e))}},20408:function(e,t,n){var r=n(17854),o=n(49974),i=n(46916),a=n(19670),u=n(66330),c=n(97659),s=n(26244),l=n(47976),f=n(18554),p=n(71246),d=n(99212),h=r.TypeError,y=function(e,t){this.stopped=e,this.result=t},m=y.prototype;e.exports=function(e,t,n){var r,v,b,g,w,_,O,T=n&&n.that,R=!(!n||!n.AS_ENTRIES),S=!(!n||!n.IS_ITERATOR),E=!(!n||!n.INTERRUPTED),P=o(t,T),x=function(e){return r&&d(r,"normal",e),new y(!0,e)},j=function(e){return R?(a(e),E?P(e[0],e[1],x):P(e[0],e[1])):E?P(e,x):P(e)};if(S)r=e;else{if(!(v=p(e)))throw h(u(e)+" is not iterable");if(c(v)){for(b=0,g=s(e);g>b;b++)if((w=j(e[b]))&&l(m,w))return w;return new y(!1)}r=f(e,v)}for(_=r.next;!(O=i(_,r)).done;){try{w=j(O.value)}catch(e){d(r,"throw",e)}if("object"==typeof w&&w&&l(m,w))return w}return new y(!1)}},99212:function(e,t,n){var r=n(46916),o=n(19670),i=n(58173);e.exports=function(e,t,n){var a,u;o(e);try{if(!(a=i(e,"return"))){if("throw"===t)throw n;return n}a=r(a,e)}catch(e){u=!0,a=e}if("throw"===t)throw n;if(u)throw a;return o(a),n}},54956:function(e,t,n){"use strict";var r=n(46916),o=n(19662),i=n(19670),a=n(70030),u=n(68880),c=n(89190),s=n(5112),l=n(29909),f=n(58173),p=n(13383).IteratorPrototype,d="IteratorProxy",h=l.set,y=l.getterFor(d),m=s("toStringTag");e.exports=function(e,t){var n=function(e){e.type=d,e.next=o(e.iterator.next),e.done=!1,e.ignoreArg=!t,h(this,e)};return n.prototype=c(a(p),{next:function(n){var o=y(this),i=arguments.length?[o.ignoreArg?void 0:n]:t?[]:[void 0];o.ignoreArg=!1;var a=o.done?void 0:r(e,o,i);return{done:o.done,value:a}},return:function(e){var t=y(this),n=t.iterator;t.done=!0;var o=f(n,"return");return{done:!0,value:o?i(r(o,n,e)).value:e}},throw:function(e){var t=y(this),n=t.iterator;t.done=!0;var o=f(n,"throw");if(o)return r(o,n,e);throw e}}),t||u(n.prototype,m,"Generator"),n}},13383:function(e,t,n){"use strict";var r,o,i,a=n(47293),u=n(60614),c=n(70030),s=n(79518),l=n(98052),f=n(5112),p=n(31913),d=f("iterator"),h=!1;[].keys&&("next"in(i=[].keys())?(o=s(s(i)))!==Object.prototype&&(r=o):h=!0),null==r||a((function(){var e={};return r[d].call(e)!==e}))?r={}:p&&(r=c(r)),u(r[d])||l(r,d,(function(){return this})),e.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:h}},97497:function(e){e.exports={}},26244:function(e,t,n){var r=n(17466);e.exports=function(e){return r(e.length)}},56339:function(e,t,n){var r=n(47293),o=n(60614),i=n(92597),a=n(19781),u=n(76530).CONFIGURABLE,c=n(42788),s=n(29909),l=s.enforce,f=s.get,p=Object.defineProperty,d=a&&!r((function(){return 8!==p((function(){}),"length",{value:8}).length})),h=String(String).split("String"),y=e.exports=function(e,t,n){if("Symbol("===String(t).slice(0,7)&&(t="["+String(t).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!i(e,"name")||u&&e.name!==t)&&p(e,"name",{value:t,configurable:!0}),d&&n&&i(n,"arity")&&e.length!==n.arity&&p(e,"length",{value:n.arity}),n&&i(n,"constructor")&&n.constructor){if(a)try{p(e,"prototype",{writable:!1})}catch(e){}}else e.prototype=void 0;var r=l(e);return i(r,"source")||(r.source=h.join("string"==typeof t?t:"")),e};Function.prototype.toString=y((function(){return o(this)&&f(this).source||c(this)}),"toString")},37502:function(e,t,n){"use strict";var r=n(46916),o=n(19662),i=n(19670);e.exports=function(e,t){var n=i(this),a=o(n.get),u=o(n.has),c=o(n.set),s=r(u,n,e)&&"update"in t?t.update(r(a,n,e),e,n):t.insert(e,n);return r(c,n,e,s),s}},95948:function(e,t,n){var r,o,i,a,u,c,s,l,f=n(17854),p=n(49974),d=n(31236).f,h=n(20261).set,y=n(6833),m=n(71528),v=n(71036),b=n(35268),g=f.MutationObserver||f.WebKitMutationObserver,w=f.document,_=f.process,O=f.Promise,T=d(f,"queueMicrotask"),R=T&&T.value;R||(r=function(){var e,t;for(b&&(e=_.domain)&&e.exit();o;){t=o.fn,o=o.next;try{t()}catch(e){throw o?a():i=void 0,e}}i=void 0,e&&e.enter()},y||b||v||!g||!w?!m&&O&&O.resolve?((s=O.resolve(void 0)).constructor=O,l=p(s.then,s),a=function(){l(r)}):b?a=function(){_.nextTick(r)}:(h=p(h,f),a=function(){h(r)}):(u=!0,c=w.createTextNode(""),new g(r).observe(c,{characterData:!0}),a=function(){c.data=u=!u})),e.exports=R||function(e){var t={fn:e,next:void 0};i&&(i.next=t),o||(o=t,a()),i=t}},30735:function(e,t,n){var r=n(30133);e.exports=r&&!!Symbol.for&&!!Symbol.keyFor},30133:function(e,t,n){var r=n(7392),o=n(47293);e.exports=!!Object.getOwnPropertySymbols&&!o((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},590:function(e,t,n){var r=n(47293),o=n(5112),i=n(31913),a=o("iterator");e.exports=!r((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,n="";return e.pathname="c%20d",t.forEach((function(e,r){t.delete("b"),n+=r+e})),i&&!e.toJSON||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[a]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://тест").host||"#%D0%B1"!==new URL("http://a#б").hash||"a1c3"!==n||"x"!==new URL("http://x",void 0).host}))},68536:function(e,t,n){var r=n(17854),o=n(60614),i=n(42788),a=r.WeakMap;e.exports=o(a)&&/native code/.test(i(a))},78523:function(e,t,n){"use strict";var r=n(19662),o=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=r(t),this.reject=r(n)};e.exports.f=function(e){return new o(e)}},56277:function(e,t,n){var r=n(41340);e.exports=function(e,t){return void 0===e?arguments.length<2?"":t:r(e)}},3929:function(e,t,n){var r=n(17854),o=n(47850),i=r.TypeError;e.exports=function(e){if(o(e))throw i("The method doesn't accept regular expressions");return e}},77023:function(e,t,n){var r=n(17854).isFinite;e.exports=Number.isFinite||function(e){return"number"==typeof e&&r(e)}},2814:function(e,t,n){var r=n(17854),o=n(47293),i=n(1702),a=n(41340),u=n(53111).trim,c=n(81361),s=i("".charAt),l=r.parseFloat,f=r.Symbol,p=f&&f.iterator,d=1/l(c+"-0")!=-1/0||p&&!o((function(){l(Object(p))}));e.exports=d?function(e){var t=u(a(e)),n=l(t);return 0===n&&"-"==s(t,0)?-0:n}:l},83009:function(e,t,n){var r=n(17854),o=n(47293),i=n(1702),a=n(41340),u=n(53111).trim,c=n(81361),s=r.parseInt,l=r.Symbol,f=l&&l.iterator,p=/^[+-]?0x/i,d=i(p.exec),h=8!==s(c+"08")||22!==s(c+"0x16")||f&&!o((function(){s(Object(f))}));e.exports=h?function(e,t){var n=u(a(e));return s(n,t>>>0||(d(p,n)?16:10))}:s},21574:function(e,t,n){"use strict";var r=n(19781),o=n(1702),i=n(46916),a=n(47293),u=n(81956),c=n(25181),s=n(55296),l=n(47908),f=n(68361),p=Object.assign,d=Object.defineProperty,h=o([].concat);e.exports=!p||a((function(){if(r&&1!==p({b:1},p(d({},"a",{enumerable:!0,get:function(){d(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol(),o="abcdefghijklmnopqrst";return e[n]=7,o.split("").forEach((function(e){t[e]=e})),7!=p({},e)[n]||u(p({},t)).join("")!=o}))?function(e,t){for(var n=l(e),o=arguments.length,a=1,p=c.f,d=s.f;o>a;)for(var y,m=f(arguments[a++]),v=p?h(u(m),p(m)):u(m),b=v.length,g=0;b>g;)y=v[g++],r&&!i(d,m,y)||(n[y]=m[y]);return n}:p},70030:function(e,t,n){var r,o=n(19670),i=n(36048),a=n(80748),u=n(3501),c=n(60490),s=n(80317),l=n(6200)("IE_PROTO"),f=function(){},p=function(e){return"<script>"+e+"<\/script>"},d=function(e){e.write(p("")),e.close();var t=e.parentWindow.Object;return e=null,t},h=function(){try{r=new ActiveXObject("htmlfile")}catch(e){}var e,t;h="undefined"!=typeof document?document.domain&&r?d(r):((t=s("iframe")).style.display="none",c.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(p("document.F=Object")),e.close(),e.F):d(r);for(var n=a.length;n--;)delete h.prototype[a[n]];return h()};u[l]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(f.prototype=o(e),n=new f,f.prototype=null,n[l]=e):n=h(),void 0===t?n:i.f(n,t)}},36048:function(e,t,n){var r=n(19781),o=n(3353),i=n(3070),a=n(19670),u=n(45656),c=n(81956);t.f=r&&!o?Object.defineProperties:function(e,t){a(e);for(var n,r=u(t),o=c(t),s=o.length,l=0;s>l;)i.f(e,n=o[l++],r[n]);return e}},3070:function(e,t,n){var r=n(17854),o=n(19781),i=n(64664),a=n(3353),u=n(19670),c=n(34948),s=r.TypeError,l=Object.defineProperty,f=Object.getOwnPropertyDescriptor;t.f=o?a?function(e,t,n){if(u(e),t=c(t),u(n),"function"==typeof e&&"prototype"===t&&"value"in n&&"writable"in n&&!n.writable){var r=f(e,t);r&&r.writable&&(e[t]=n.value,n={configurable:"configurable"in n?n.configurable:r.configurable,enumerable:"enumerable"in n?n.enumerable:r.enumerable,writable:!1})}return l(e,t,n)}:l:function(e,t,n){if(u(e),t=c(t),u(n),i)try{return l(e,t,n)}catch(e){}if("get"in n||"set"in n)throw s("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},31236:function(e,t,n){var r=n(19781),o=n(46916),i=n(55296),a=n(79114),u=n(45656),c=n(34948),s=n(92597),l=n(64664),f=Object.getOwnPropertyDescriptor;t.f=r?f:function(e,t){if(e=u(e),t=c(t),l)try{return f(e,t)}catch(e){}if(s(e,t))return a(!o(i.f,e,t),e[t])}},1156:function(e,t,n){var r=n(84326),o=n(45656),i=n(8006).f,a=n(41589),u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return u&&"Window"==r(e)?function(e){try{return i(e)}catch(e){return a(u)}}(e):i(o(e))}},8006:function(e,t,n){var r=n(16324),o=n(80748).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,o)}},25181:function(e,t){t.f=Object.getOwnPropertySymbols},79518:function(e,t,n){var r=n(17854),o=n(92597),i=n(60614),a=n(47908),u=n(6200),c=n(49920),s=u("IE_PROTO"),l=r.Object,f=l.prototype;e.exports=c?l.getPrototypeOf:function(e){var t=a(e);if(o(t,s))return t[s];var n=t.constructor;return i(n)&&t instanceof n?n.prototype:t instanceof l?f:null}},52050:function(e,t,n){var r=n(47293),o=n(70111),i=n(84326),a=n(7556),u=Object.isExtensible,c=r((function(){u(1)}));e.exports=c||a?function(e){return!!o(e)&&(!a||"ArrayBuffer"!=i(e))&&(!u||u(e))}:u},47976:function(e,t,n){var r=n(1702);e.exports=r({}.isPrototypeOf)},16324:function(e,t,n){var r=n(1702),o=n(92597),i=n(45656),a=n(41318).indexOf,u=n(3501),c=r([].push);e.exports=function(e,t){var n,r=i(e),s=0,l=[];for(n in r)!o(u,n)&&o(r,n)&&c(l,n);for(;t.length>s;)o(r,n=t[s++])&&(~a(l,n)||c(l,n));return l}},81956:function(e,t,n){var r=n(16324),o=n(80748);e.exports=Object.keys||function(e){return r(e,o)}},55296:function(e,t){"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,o=r&&!n.call({1:2},1);t.f=o?function(e){var t=r(this,e);return!!t&&t.enumerable}:n},27674:function(e,t,n){var r=n(1702),o=n(19670),i=n(96077);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=r(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return o(n),i(r),t?e(n,r):n.__proto__=r,n}}():void 0)},44699:function(e,t,n){var r=n(19781),o=n(1702),i=n(81956),a=n(45656),u=o(n(55296).f),c=o([].push),s=function(e){return function(t){for(var n,o=a(t),s=i(o),l=s.length,f=0,p=[];l>f;)n=s[f++],r&&!u(o,n)||c(p,e?[n,o[n]]:o[n]);return p}};e.exports={entries:s(!0),values:s(!1)}},90288:function(e,t,n){"use strict";var r=n(51694),o=n(70648);e.exports=r?{}.toString:function(){return"[object "+o(this)+"]"}},92140:function(e,t,n){var r=n(17854),o=n(46916),i=n(60614),a=n(70111),u=r.TypeError;e.exports=function(e,t){var n,r;if("string"===t&&i(n=e.toString)&&!a(r=o(n,e)))return r;if(i(n=e.valueOf)&&!a(r=o(n,e)))return r;if("string"!==t&&i(n=e.toString)&&!a(r=o(n,e)))return r;throw u("Can't convert object to primitive value")}},53887:function(e,t,n){var r=n(35005),o=n(1702),i=n(8006),a=n(25181),u=n(19670),c=o([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=i.f(u(e)),n=a.f;return n?c(t,n(e)):t}},40857:function(e,t,n){var r=n(17854);e.exports=r},12534:function(e){e.exports=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}}},63702:function(e,t,n){var r=n(17854),o=n(2492),i=n(60614),a=n(54705),u=n(42788),c=n(5112),s=n(7871),l=n(31913),f=n(7392),p=o&&o.prototype,d=c("species"),h=!1,y=i(r.PromiseRejectionEvent),m=a("Promise",(function(){var e=u(o),t=e!==String(o);if(!t&&66===f)return!0;if(l&&(!p.catch||!p.finally))return!0;if(f>=51&&/native code/.test(e))return!1;var n=new o((function(e){e(1)})),r=function(e){e((function(){}),(function(){}))};return(n.constructor={})[d]=r,!(h=n.then((function(){}))instanceof r)||!t&&s&&!y}));e.exports={CONSTRUCTOR:m,REJECTION_EVENT:y,SUBCLASSING:h}},2492:function(e,t,n){var r=n(17854);e.exports=r.Promise},69478:function(e,t,n){var r=n(19670),o=n(70111),i=n(78523);e.exports=function(e,t){if(r(e),o(t)&&t.constructor===e)return t;var n=i.f(e);return(0,n.resolve)(t),n.promise}},80612:function(e,t,n){var r=n(2492),o=n(17072),i=n(63702).CONSTRUCTOR;e.exports=i||!o((function(e){r.all(e).then(void 0,(function(){}))}))},2626:function(e,t,n){var r=n(3070).f;e.exports=function(e,t,n){n in e||r(e,n,{configurable:!0,get:function(){return t[n]},set:function(e){t[n]=e}})}},18572:function(e){var t=function(){this.head=null,this.tail=null};t.prototype={add:function(e){var t={item:e,next:null};this.head?this.tail.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return this.head=e.next,this.tail===e&&(this.tail=null),e.item}},e.exports=t},97651:function(e,t,n){var r=n(17854),o=n(46916),i=n(19670),a=n(60614),u=n(84326),c=n(22261),s=r.TypeError;e.exports=function(e,t){var n=e.exec;if(a(n)){var r=o(n,e,t);return null!==r&&i(r),r}if("RegExp"===u(e))return o(c,e,t);throw s("RegExp#exec called on incompatible receiver")}},22261:function(e,t,n){"use strict";var r,o,i=n(46916),a=n(1702),u=n(41340),c=n(67066),s=n(52999),l=n(72309),f=n(70030),p=n(29909).get,d=n(9441),h=n(38173),y=l("native-string-replace",String.prototype.replace),m=RegExp.prototype.exec,v=m,b=a("".charAt),g=a("".indexOf),w=a("".replace),_=a("".slice),O=(o=/b*/g,i(m,r=/a/,"a"),i(m,o,"a"),0!==r.lastIndex||0!==o.lastIndex),T=s.BROKEN_CARET,R=void 0!==/()??/.exec("")[1];(O||R||T||d||h)&&(v=function(e){var t,n,r,o,a,s,l,d=this,h=p(d),S=u(e),E=h.raw;if(E)return E.lastIndex=d.lastIndex,t=i(v,E,S),d.lastIndex=E.lastIndex,t;var P=h.groups,x=T&&d.sticky,j=i(c,d),C=d.source,k=0,M=S;if(x&&(j=w(j,"y",""),-1===g(j,"g")&&(j+="g"),M=_(S,d.lastIndex),d.lastIndex>0&&(!d.multiline||d.multiline&&"\n"!==b(S,d.lastIndex-1))&&(C="(?: "+C+")",M=" "+M,k++),n=new RegExp("^(?:"+C+")",j)),R&&(n=new RegExp("^"+C+"$(?!\\s)",j)),O&&(r=d.lastIndex),o=i(m,x?n:d,M),x?o?(o.input=_(o.input,k),o[0]=_(o[0],k),o.index=d.lastIndex,d.lastIndex+=o[0].length):d.lastIndex=0:O&&o&&(d.lastIndex=d.global?o.index+o[0].length:r),R&&o&&o.length>1&&i(y,o[0],n,(function(){for(a=1;a<arguments.length-2;a++)void 0===arguments[a]&&(o[a]=void 0)})),o&&P)for(o.groups=s=f(null),a=0;a<P.length;a++)s[(l=P[a])[0]]=o[l[1]];return o}),e.exports=v},67066:function(e,t,n){"use strict";var r=n(19670);e.exports=function(){var e=r(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},34706:function(e,t,n){var r=n(46916),o=n(92597),i=n(47976),a=n(67066),u=RegExp.prototype;e.exports=function(e){var t=e.flags;return void 0!==t||"flags"in u||o(e,"flags")||!i(u,e)?t:r(a,e)}},52999:function(e,t,n){var r=n(47293),o=n(17854).RegExp,i=r((function(){var e=o("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),a=i||r((function(){return!o("a","y").sticky})),u=i||r((function(){var e=o("^r","gy");return e.lastIndex=2,null!=e.exec("str")}));e.exports={BROKEN_CARET:u,MISSED_STICKY:a,UNSUPPORTED_Y:i}},9441:function(e,t,n){var r=n(47293),o=n(17854).RegExp;e.exports=r((function(){var e=o(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)}))},38173:function(e,t,n){var r=n(47293),o=n(17854).RegExp;e.exports=r((function(){var e=o("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")}))},84488:function(e,t,n){var r=n(17854).TypeError;e.exports=function(e){if(null==e)throw r("Can't call method on "+e);return e}},46465:function(e){e.exports=function(e,t){return e===t||e!=e&&t!=t}},81150:function(e){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},83505:function(e,t,n){var r=n(17854),o=Object.defineProperty;e.exports=function(e,t){try{o(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},96340:function(e,t,n){"use strict";var r=n(35005),o=n(3070),i=n(5112),a=n(19781),u=i("species");e.exports=function(e){var t=r(e),n=o.f;a&&t&&!t[u]&&n(t,u,{configurable:!0,get:function(){return this}})}},58003:function(e,t,n){var r=n(3070).f,o=n(92597),i=n(5112)("toStringTag");e.exports=function(e,t,n){e&&!n&&(e=e.prototype),e&&!o(e,i)&&r(e,i,{configurable:!0,value:t})}},6200:function(e,t,n){var r=n(72309),o=n(69711),i=r("keys");e.exports=function(e){return i[e]||(i[e]=o(e))}},5465:function(e,t,n){var r=n(17854),o=n(83505),i="__core-js_shared__",a=r[i]||o(i,{});e.exports=a},72309:function(e,t,n){var r=n(31913),o=n(5465);(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.22.5",mode:r?"pure":"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.22.5/LICENSE",source:"https://github.com/zloirock/core-js"})},36707:function(e,t,n){var r=n(19670),o=n(39483),i=n(5112)("species");e.exports=function(e,t){var n,a=r(e).constructor;return void 0===a||null==(n=r(a)[i])?t:o(n)}},43429:function(e,t,n){var r=n(47293);e.exports=function(e){return r((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}))}},28710:function(e,t,n){var r=n(1702),o=n(19303),i=n(41340),a=n(84488),u=r("".charAt),c=r("".charCodeAt),s=r("".slice),l=function(e){return function(t,n){var r,l,f=i(a(t)),p=o(n),d=f.length;return p<0||p>=d?e?"":void 0:(r=c(f,p))<55296||r>56319||p+1===d||(l=c(f,p+1))<56320||l>57343?e?u(f,p):r:e?s(f,p,p+2):l-56320+(r-55296<<10)+65536}};e.exports={codeAt:l(!1),charAt:l(!0)}},54986:function(e,t,n){var r=n(88113);e.exports=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(r)},76650:function(e,t,n){var r=n(1702),o=n(17466),i=n(41340),a=n(38415),u=n(84488),c=r(a),s=r("".slice),l=Math.ceil,f=function(e){return function(t,n,r){var a,f,p=i(u(t)),d=o(n),h=p.length,y=void 0===r?" ":i(r);return d<=h||""==y?p:((f=c(y,l((a=d-h)/y.length))).length>a&&(f=s(f,0,a)),e?p+f:f+p)}};e.exports={start:f(!1),end:f(!0)}},33197:function(e,t,n){"use strict";var r=n(17854),o=n(1702),i=2147483647,a=/[^\0-\u007E]/,u=/[.\u3002\uFF0E\uFF61]/g,c="Overflow: input needs wider integers to process",s=r.RangeError,l=o(u.exec),f=Math.floor,p=String.fromCharCode,d=o("".charCodeAt),h=o([].join),y=o([].push),m=o("".replace),v=o("".split),b=o("".toLowerCase),g=function(e){return e+22+75*(e<26)},w=function(e,t,n){var r=0;for(e=n?f(e/700):e>>1,e+=f(e/t);e>455;)e=f(e/35),r+=36;return f(r+36*e/(e+38))},_=function(e){var t=[];e=function(e){for(var t=[],n=0,r=e.length;n<r;){var o=d(e,n++);if(o>=55296&&o<=56319&&n<r){var i=d(e,n++);56320==(64512&i)?y(t,((1023&o)<<10)+(1023&i)+65536):(y(t,o),n--)}else y(t,o)}return t}(e);var n,r,o=e.length,a=128,u=0,l=72;for(n=0;n<e.length;n++)(r=e[n])<128&&y(t,p(r));var m=t.length,v=m;for(m&&y(t,"-");v<o;){var b=i;for(n=0;n<e.length;n++)(r=e[n])>=a&&r<b&&(b=r);var _=v+1;if(b-a>f((i-u)/_))throw s(c);for(u+=(b-a)*_,a=b,n=0;n<e.length;n++){if((r=e[n])<a&&++u>i)throw s(c);if(r==a){for(var O=u,T=36;;){var R=T<=l?1:T>=l+26?26:T-l;if(O<R)break;var S=O-R,E=36-R;y(t,p(g(R+S%E))),O=f(S/E),T+=36}y(t,p(g(O))),l=w(u,_,v==m),u=0,v++}}u++,a++}return h(t,"")};e.exports=function(e){var t,n,r=[],o=v(m(b(e),u,"."),".");for(t=0;t<o.length;t++)n=o[t],y(r,l(a,n)?"xn--"+_(n):n);return h(r,".")}},38415:function(e,t,n){"use strict";var r=n(17854),o=n(19303),i=n(41340),a=n(84488),u=r.RangeError;e.exports=function(e){var t=i(a(this)),n="",r=o(e);if(r<0||r==1/0)throw u("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(t+=t))1&r&&(n+=t);return n}},76091:function(e,t,n){var r=n(76530).PROPER,o=n(47293),i=n(81361);e.exports=function(e){return o((function(){return!!i[e]()||"​᠎"!=="​᠎"[e]()||r&&i[e].name!==e}))}},53111:function(e,t,n){var r=n(1702),o=n(84488),i=n(41340),a=n(81361),u=r("".replace),c="["+a+"]",s=RegExp("^"+c+c+"*"),l=RegExp(c+c+"*$"),f=function(e){return function(t){var n=i(o(t));return 1&e&&(n=u(n,s,"")),2&e&&(n=u(n,l,"")),n}};e.exports={start:f(1),end:f(2),trim:f(3)}},56532:function(e,t,n){var r=n(46916),o=n(35005),i=n(5112),a=n(98052);e.exports=function(){var e=o("Symbol"),t=e&&e.prototype,n=t&&t.valueOf,u=i("toPrimitive");t&&!t[u]&&a(t,u,(function(e){return r(n,this)}),{arity:1})}},20261:function(e,t,n){var r,o,i,a,u=n(17854),c=n(22104),s=n(49974),l=n(60614),f=n(92597),p=n(47293),d=n(60490),h=n(50206),y=n(80317),m=n(48053),v=n(6833),b=n(35268),g=u.setImmediate,w=u.clearImmediate,_=u.process,O=u.Dispatch,T=u.Function,R=u.MessageChannel,S=u.String,E=0,P={};try{r=u.location}catch(e){}var x=function(e){if(f(P,e)){var t=P[e];delete P[e],t()}},j=function(e){return function(){x(e)}},C=function(e){x(e.data)},k=function(e){u.postMessage(S(e),r.protocol+"//"+r.host)};g&&w||(g=function(e){m(arguments.length,1);var t=l(e)?e:T(e),n=h(arguments,1);return P[++E]=function(){c(t,void 0,n)},o(E),E},w=function(e){delete P[e]},b?o=function(e){_.nextTick(j(e))}:O&&O.now?o=function(e){O.now(j(e))}:R&&!v?(a=(i=new R).port2,i.port1.onmessage=C,o=s(a.postMessage,a)):u.addEventListener&&l(u.postMessage)&&!u.importScripts&&r&&"file:"!==r.protocol&&!p(k)?(o=k,u.addEventListener("message",C,!1)):o="onreadystatechange"in y("script")?function(e){d.appendChild(y("script")).onreadystatechange=function(){d.removeChild(this),x(e)}}:function(e){setTimeout(j(e),0)}),e.exports={set:g,clear:w}},50863:function(e,t,n){var r=n(1702);e.exports=r(1..valueOf)},51400:function(e,t,n){var r=n(19303),o=Math.max,i=Math.min;e.exports=function(e,t){var n=r(e);return n<0?o(n+t,0):i(n,t)}},57067:function(e,t,n){var r=n(17854),o=n(19303),i=n(17466),a=r.RangeError;e.exports=function(e){if(void 0===e)return 0;var t=o(e),n=i(t);if(t!==n)throw a("Wrong length or index");return n}},45656:function(e,t,n){var r=n(68361),o=n(84488);e.exports=function(e){return r(o(e))}},19303:function(e){var t=Math.ceil,n=Math.floor;e.exports=function(e){var r=+e;return r!=r||0===r?0:(r>0?n:t)(r)}},17466:function(e,t,n){var r=n(19303),o=Math.min;e.exports=function(e){return e>0?o(r(e),9007199254740991):0}},47908:function(e,t,n){var r=n(17854),o=n(84488),i=r.Object;e.exports=function(e){return i(o(e))}},84590:function(e,t,n){var r=n(17854),o=n(73002),i=r.RangeError;e.exports=function(e,t){var n=o(e);if(n%t)throw i("Wrong offset");return n}},73002:function(e,t,n){var r=n(17854),o=n(19303),i=r.RangeError;e.exports=function(e){var t=o(e);if(t<0)throw i("The argument can't be less than 0");return t}},57593:function(e,t,n){var r=n(17854),o=n(46916),i=n(70111),a=n(52190),u=n(58173),c=n(92140),s=n(5112),l=r.TypeError,f=s("toPrimitive");e.exports=function(e,t){if(!i(e)||a(e))return e;var n,r=u(e,f);if(r){if(void 0===t&&(t="default"),n=o(r,e,t),!i(n)||a(n))return n;throw l("Can't convert object to primitive value")}return void 0===t&&(t="number"),c(e,t)}},34948:function(e,t,n){var r=n(57593),o=n(52190);e.exports=function(e){var t=r(e,"string");return o(t)?t:t+""}},51694:function(e,t,n){var r={};r[n(5112)("toStringTag")]="z",e.exports="[object z]"===String(r)},41340:function(e,t,n){var r=n(17854),o=n(70648),i=r.String;e.exports=function(e){if("Symbol"===o(e))throw TypeError("Cannot convert a Symbol value to a string");return i(e)}},44038:function(e,t,n){var r=n(35268);e.exports=function(e){try{if(r)return Function('return require("'+e+'")')()}catch(e){}}},66330:function(e,t,n){var r=n(17854).String;e.exports=function(e){try{return r(e)}catch(e){return"Object"}}},19843:function(e,t,n){"use strict";var r=n(82109),o=n(17854),i=n(46916),a=n(19781),u=n(63832),c=n(90260),s=n(13331),l=n(25787),f=n(79114),p=n(68880),d=n(55988),h=n(17466),y=n(57067),m=n(84590),v=n(34948),b=n(92597),g=n(70648),w=n(70111),_=n(52190),O=n(70030),T=n(47976),R=n(27674),S=n(8006).f,E=n(97321),P=n(42092).forEach,x=n(96340),j=n(3070),C=n(31236),k=n(29909),M=n(79587),D=k.get,A=k.set,I=j.f,N=C.f,V=Math.round,U=o.RangeError,F=s.ArrayBuffer,B=F.prototype,L=s.DataView,H=c.NATIVE_ARRAY_BUFFER_VIEWS,z=c.TYPED_ARRAY_CONSTRUCTOR,q=c.TYPED_ARRAY_TAG,G=c.TypedArray,W=c.TypedArrayPrototype,Q=c.aTypedArrayConstructor,K=c.isTypedArray,Y="BYTES_PER_ELEMENT",Z="Wrong length",X=function(e,t){Q(e);for(var n=0,r=t.length,o=new e(r);r>n;)o[n]=t[n++];return o},J=function(e,t){I(e,t,{get:function(){return D(this)[t]}})},$=function(e){var t;return T(B,e)||"ArrayBuffer"==(t=g(e))||"SharedArrayBuffer"==t},ee=function(e,t){return K(e)&&!_(t)&&t in e&&d(+t)&&t>=0},te=function(e,t){return t=v(t),ee(e,t)?f(2,e[t]):N(e,t)},ne=function(e,t,n){return t=v(t),!(ee(e,t)&&w(n)&&b(n,"value"))||b(n,"get")||b(n,"set")||n.configurable||b(n,"writable")&&!n.writable||b(n,"enumerable")&&!n.enumerable?I(e,t,n):(e[t]=n.value,e)};a?(H||(C.f=te,j.f=ne,J(W,"buffer"),J(W,"byteOffset"),J(W,"byteLength"),J(W,"length")),r({target:"Object",stat:!0,forced:!H},{getOwnPropertyDescriptor:te,defineProperty:ne}),e.exports=function(e,t,n){var a=e.match(/\d+$/)[0]/8,c=e+(n?"Clamped":"")+"Array",s="get"+e,f="set"+e,d=o[c],v=d,b=v&&v.prototype,g={},_=function(e,t){I(e,t,{get:function(){return function(e,t){var n=D(e);return n.view[s](t*a+n.byteOffset,!0)}(this,t)},set:function(e){return function(e,t,r){var o=D(e);n&&(r=(r=V(r))<0?0:r>255?255:255&r),o.view[f](t*a+o.byteOffset,r,!0)}(this,t,e)},enumerable:!0})};H?u&&(v=t((function(e,t,n,r){return l(e,b),M(w(t)?$(t)?void 0!==r?new d(t,m(n,a),r):void 0!==n?new d(t,m(n,a)):new d(t):K(t)?X(v,t):i(E,v,t):new d(y(t)),e,v)})),R&&R(v,G),P(S(d),(function(e){e in v||p(v,e,d[e])})),v.prototype=b):(v=t((function(e,t,n,r){l(e,b);var o,u,c,s=0,f=0;if(w(t)){if(!$(t))return K(t)?X(v,t):i(E,v,t);o=t,f=m(n,a);var p=t.byteLength;if(void 0===r){if(p%a)throw U(Z);if((u=p-f)<0)throw U(Z)}else if((u=h(r)*a)+f>p)throw U(Z);c=u/a}else c=y(t),o=new F(u=c*a);for(A(e,{buffer:o,byteOffset:f,byteLength:u,length:c,view:new L(o)});s<c;)_(e,s++)})),R&&R(v,G),b=v.prototype=O(W)),b.constructor!==v&&p(b,"constructor",v),p(b,z,v),q&&p(b,q,c);var T=v!=d;g[c]=v,r({global:!0,constructor:!0,forced:T,sham:!H},g),Y in v||p(v,Y,a),Y in b||p(b,Y,a),x(c)}):e.exports=function(){}},63832:function(e,t,n){var r=n(17854),o=n(47293),i=n(17072),a=n(90260).NATIVE_ARRAY_BUFFER_VIEWS,u=r.ArrayBuffer,c=r.Int8Array;e.exports=!a||!o((function(){c(1)}))||!o((function(){new c(-1)}))||!i((function(e){new c,new c(null),new c(1.5),new c(e)}),!0)||o((function(){return 1!==new c(new u(2),1,void 0).length}))},43074:function(e,t,n){var r=n(97745),o=n(66304);e.exports=function(e,t){return r(o(e),t)}},97321:function(e,t,n){var r=n(49974),o=n(46916),i=n(39483),a=n(47908),u=n(26244),c=n(18554),s=n(71246),l=n(97659),f=n(90260).aTypedArrayConstructor;e.exports=function(e){var t,n,p,d,h,y,m=i(this),v=a(e),b=arguments.length,g=b>1?arguments[1]:void 0,w=void 0!==g,_=s(v);if(_&&!l(_))for(y=(h=c(v,_)).next,v=[];!(d=o(y,h)).done;)v.push(d.value);for(w&&b>2&&(g=r(g,arguments[2])),n=u(v),p=new(f(m))(n),t=0;n>t;t++)p[t]=w?g(v[t],t):v[t];return p}},66304:function(e,t,n){var r=n(90260),o=n(36707),i=r.TYPED_ARRAY_CONSTRUCTOR,a=r.aTypedArrayConstructor;e.exports=function(e){return a(o(e,e[i]))}},69711:function(e,t,n){var r=n(1702),o=0,i=Math.random(),a=r(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+a(++o+i,36)}},43307:function(e,t,n){var r=n(30133);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},3353:function(e,t,n){var r=n(19781),o=n(47293);e.exports=r&&o((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},48053:function(e,t,n){var r=n(17854).TypeError;e.exports=function(e,t){if(e<t)throw r("Not enough arguments");return e}},6061:function(e,t,n){var r=n(5112);t.f=r},5112:function(e,t,n){var r=n(17854),o=n(72309),i=n(92597),a=n(69711),u=n(30133),c=n(43307),s=o("wks"),l=r.Symbol,f=l&&l.for,p=c?l:l&&l.withoutSetter||a;e.exports=function(e){if(!i(s,e)||!u&&"string"!=typeof s[e]){var t="Symbol."+e;u&&i(l,e)?s[e]=l[e]:s[e]=c&&f?f(t):p(t)}return s[e]}},81361:function(e){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},89191:function(e,t,n){"use strict";var r=n(35005),o=n(92597),i=n(68880),a=n(47976),u=n(27674),c=n(99920),s=n(2626),l=n(79587),f=n(56277),p=n(58340),d=n(77741),h=n(22914),y=n(19781),m=n(31913);e.exports=function(e,t,n,v){var b="stackTraceLimit",g=v?2:1,w=e.split("."),_=w[w.length-1],O=r.apply(null,w);if(O){var T=O.prototype;if(!m&&o(T,"cause")&&delete T.cause,!n)return O;var R=r("Error"),S=t((function(e,t){var n=f(v?t:e,void 0),r=v?new O(e):new O;return void 0!==n&&i(r,"message",n),h&&i(r,"stack",d(r.stack,2)),this&&a(T,this)&&l(r,this,S),arguments.length>g&&p(r,arguments[g]),r}));if(S.prototype=T,"Error"!==_?u?u(S,R):c(S,R,{name:!0}):y&&b in O&&(s(S,O,b),s(S,O,"prepareStackTrace")),c(S,O),!m)try{T.name!==_&&i(T,"name",_),T.constructor=S}catch(e){}return S}}},92222:function(e,t,n){"use strict";var r=n(82109),o=n(17854),i=n(47293),a=n(43157),u=n(70111),c=n(47908),s=n(26244),l=n(86135),f=n(65417),p=n(81194),d=n(5112),h=n(7392),y=d("isConcatSpreadable"),m=9007199254740991,v="Maximum allowed index exceeded",b=o.TypeError,g=h>=51||!i((function(){var e=[];return e[y]=!1,e.concat()[0]!==e})),w=p("concat"),_=function(e){if(!u(e))return!1;var t=e[y];return void 0!==t?!!t:a(e)};r({target:"Array",proto:!0,arity:1,forced:!g||!w},{concat:function(e){var t,n,r,o,i,a=c(this),u=f(a,0),p=0;for(t=-1,r=arguments.length;t<r;t++)if(_(i=-1===t?a:arguments[t])){if(p+(o=s(i))>m)throw b(v);for(n=0;n<o;n++,p++)n in i&&l(u,p,i[n])}else{if(p>=m)throw b(v);l(u,p++,i)}return u.length=p,u}})},43290:function(e,t,n){var r=n(82109),o=n(21285),i=n(51223);r({target:"Array",proto:!0},{fill:o}),i("fill")},57327:function(e,t,n){"use strict";var r=n(82109),o=n(42092).filter;r({target:"Array",proto:!0,forced:!n(81194)("filter")},{filter:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}})},34553:function(e,t,n){"use strict";var r=n(82109),o=n(42092).findIndex,i=n(51223),a="findIndex",u=!0;a in[]&&Array(1).findIndex((function(){u=!1})),r({target:"Array",proto:!0,forced:u},{findIndex:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),i(a)},69826:function(e,t,n){"use strict";var r=n(82109),o=n(42092).find,i=n(51223),a="find",u=!0;a in[]&&Array(1).find((function(){u=!1})),r({target:"Array",proto:!0,forced:u},{find:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),i(a)},91038:function(e,t,n){var r=n(82109),o=n(48457);r({target:"Array",stat:!0,forced:!n(17072)((function(e){Array.from(e)}))},{from:o})},26699:function(e,t,n){"use strict";var r=n(82109),o=n(41318).includes,i=n(47293),a=n(51223);r({target:"Array",proto:!0,forced:i((function(){return!Array(1).includes()}))},{includes:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),a("includes")},82772:function(e,t,n){"use strict";var r=n(82109),o=n(1702),i=n(41318).indexOf,a=n(9341),u=o([].indexOf),c=!!u&&1/u([1],1,-0)<0,s=a("indexOf");r({target:"Array",proto:!0,forced:c||!s},{indexOf:function(e){var t=arguments.length>1?arguments[1]:void 0;return c?u(this,e,t)||0:i(this,e,t)}})},66992:function(e,t,n){"use strict";var r=n(45656),o=n(51223),i=n(97497),a=n(29909),u=n(3070).f,c=n(70654),s=n(31913),l=n(19781),f="Array Iterator",p=a.set,d=a.getterFor(f);e.exports=c(Array,"Array",(function(e,t){p(this,{type:f,target:r(e),index:0,kind:t})}),(function(){var e=d(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values");var h=i.Arguments=i.Array;if(o("keys"),o("values"),o("entries"),!s&&l&&"values"!==h.name)try{u(h,"name",{value:"values"})}catch(e){}},69600:function(e,t,n){"use strict";var r=n(82109),o=n(1702),i=n(68361),a=n(45656),u=n(9341),c=o([].join),s=i!=Object,l=u("join",",");r({target:"Array",proto:!0,forced:s||!l},{join:function(e){return c(a(this),void 0===e?",":e)}})},94986:function(e,t,n){var r=n(82109),o=n(86583);r({target:"Array",proto:!0,forced:o!==[].lastIndexOf},{lastIndexOf:o})},21249:function(e,t,n){"use strict";var r=n(82109),o=n(42092).map;r({target:"Array",proto:!0,forced:!n(81194)("map")},{map:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}})},85827:function(e,t,n){"use strict";var r=n(82109),o=n(53671).left,i=n(9341),a=n(7392),u=n(35268);r({target:"Array",proto:!0,forced:!i("reduce")||!u&&a>79&&a<83},{reduce:function(e){var t=arguments.length;return o(this,e,t,t>1?arguments[1]:void 0)}})},47042:function(e,t,n){"use strict";var r=n(82109),o=n(17854),i=n(43157),a=n(4411),u=n(70111),c=n(51400),s=n(26244),l=n(45656),f=n(86135),p=n(5112),d=n(81194),h=n(50206),y=d("slice"),m=p("species"),v=o.Array,b=Math.max;r({target:"Array",proto:!0,forced:!y},{slice:function(e,t){var n,r,o,p=l(this),d=s(p),y=c(e,d),g=c(void 0===t?d:t,d);if(i(p)&&(n=p.constructor,(a(n)&&(n===v||i(n.prototype))||u(n)&&null===(n=n[m]))&&(n=void 0),n===v||void 0===n))return h(p,y,g);for(r=new(void 0===n?v:n)(b(g-y,0)),o=0;y<g;y++,o++)y in p&&f(r,o,p[y]);return r.length=o,r}})},2707:function(e,t,n){"use strict";var r=n(82109),o=n(1702),i=n(19662),a=n(47908),u=n(26244),c=n(41340),s=n(47293),l=n(94362),f=n(9341),p=n(68886),d=n(30256),h=n(7392),y=n(98008),m=[],v=o(m.sort),b=o(m.push),g=s((function(){m.sort(void 0)})),w=s((function(){m.sort(null)})),_=f("sort"),O=!s((function(){if(h)return h<70;if(!(p&&p>3)){if(d)return!0;if(y)return y<603;var e,t,n,r,o="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(r=0;r<47;r++)m.push({k:t+r,v:n})}for(m.sort((function(e,t){return t.v-e.v})),r=0;r<m.length;r++)t=m[r].k.charAt(0),o.charAt(o.length-1)!==t&&(o+=t);return"DGBEFHACIJK"!==o}}));r({target:"Array",proto:!0,forced:g||!w||!_||!O},{sort:function(e){void 0!==e&&i(e);var t=a(this);if(O)return void 0===e?v(t):v(t,e);var n,r,o=[],s=u(t);for(r=0;r<s;r++)r in t&&b(o,t[r]);for(l(o,function(e){return function(t,n){return void 0===n?-1:void 0===t?1:void 0!==e?+e(t,n)||0:c(t)>c(n)?1:-1}}(e)),n=o.length,r=0;r<n;)t[r]=o[r++];for(;r<s;)delete t[r++];return t}})},40561:function(e,t,n){"use strict";var r=n(82109),o=n(17854),i=n(51400),a=n(19303),u=n(26244),c=n(47908),s=n(65417),l=n(86135),f=n(81194)("splice"),p=o.TypeError,d=Math.max,h=Math.min,y=9007199254740991,m="Maximum allowed length exceeded";r({target:"Array",proto:!0,forced:!f},{splice:function(e,t){var n,r,o,f,v,b,g=c(this),w=u(g),_=i(e,w),O=arguments.length;if(0===O?n=r=0:1===O?(n=0,r=w-_):(n=O-2,r=h(d(a(t),0),w-_)),w+n-r>y)throw p(m);for(o=s(g,r),f=0;f<r;f++)(v=_+f)in g&&l(o,f,g[v]);if(o.length=r,n<r){for(f=_;f<w-r;f++)b=f+n,(v=f+r)in g?g[b]=g[v]:delete g[b];for(f=w;f>w-r+n;f--)delete g[f-1]}else if(n>r)for(f=w-r;f>_;f--)b=f+n-1,(v=f+r-1)in g?g[b]=g[v]:delete g[b];for(f=0;f<n;f++)g[f+_]=arguments[f+2];return g.length=w-r+n,o}})},21703:function(e,t,n){var r=n(82109),o=n(17854),i=n(22104),a=n(89191),u=o.WebAssembly,c=7!==Error("e",{cause:7}).cause,s=function(e,t){var n={};n[e]=a(e,t,c),r({global:!0,constructor:!0,arity:1,forced:c},n)},l=function(e,t){if(u&&u[e]){var n={};n[e]=a("WebAssembly."+e,t,c),r({target:"WebAssembly",stat:!0,constructor:!0,arity:1,forced:c},n)}};s("Error",(function(e){return function(t){return i(e,this,arguments)}})),s("EvalError",(function(e){return function(t){return i(e,this,arguments)}})),s("RangeError",(function(e){return function(t){return i(e,this,arguments)}})),s("ReferenceError",(function(e){return function(t){return i(e,this,arguments)}})),s("SyntaxError",(function(e){return function(t){return i(e,this,arguments)}})),s("TypeError",(function(e){return function(t){return i(e,this,arguments)}})),s("URIError",(function(e){return function(t){return i(e,this,arguments)}})),l("CompileError",(function(e){return function(t){return i(e,this,arguments)}})),l("LinkError",(function(e){return function(t){return i(e,this,arguments)}})),l("RuntimeError",(function(e){return function(t){return i(e,this,arguments)}}))},68309:function(e,t,n){var r=n(19781),o=n(76530).EXISTS,i=n(1702),a=n(3070).f,u=Function.prototype,c=i(u.toString),s=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,l=i(s.exec);r&&!o&&a(u,"name",{configurable:!0,get:function(){try{return l(s,c(this))[1]}catch(e){return""}}})},38862:function(e,t,n){var r=n(82109),o=n(35005),i=n(22104),a=n(46916),u=n(1702),c=n(47293),s=n(43157),l=n(60614),f=n(70111),p=n(52190),d=n(50206),h=n(30133),y=o("JSON","stringify"),m=u(/./.exec),v=u("".charAt),b=u("".charCodeAt),g=u("".replace),w=u(1..toString),_=/[\uD800-\uDFFF]/g,O=/^[\uD800-\uDBFF]$/,T=/^[\uDC00-\uDFFF]$/,R=!h||c((function(){var e=o("Symbol")();return"[null]"!=y([e])||"{}"!=y({a:e})||"{}"!=y(Object(e))})),S=c((function(){return'"\\udf06\\ud834"'!==y("\udf06\ud834")||'"\\udead"'!==y("\udead")})),E=function(e,t){var n=d(arguments),r=t;if((f(t)||void 0!==e)&&!p(e))return s(t)||(t=function(e,t){if(l(r)&&(t=a(r,this,e,t)),!p(t))return t}),n[1]=t,i(y,null,n)},P=function(e,t,n){var r=v(n,t-1),o=v(n,t+1);return m(O,e)&&!m(T,o)||m(T,e)&&!m(O,r)?"\\u"+w(b(e,0),16):e};y&&r({target:"JSON",stat:!0,arity:3,forced:R||S},{stringify:function(e,t,n){var r=d(arguments),o=i(R?E:y,null,r);return S&&"string"==typeof o?g(o,_,P):o}})},69098:function(e,t,n){"use strict";n(77710)("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),n(95631))},51532:function(e,t,n){n(69098)},9653:function(e,t,n){"use strict";var r=n(19781),o=n(17854),i=n(1702),a=n(54705),u=n(98052),c=n(92597),s=n(79587),l=n(47976),f=n(52190),p=n(57593),d=n(47293),h=n(8006).f,y=n(31236).f,m=n(3070).f,v=n(50863),b=n(53111).trim,g="Number",w=o.Number,_=w.prototype,O=o.TypeError,T=i("".slice),R=i("".charCodeAt),S=function(e){var t=p(e,"number");return"bigint"==typeof t?t:E(t)},E=function(e){var t,n,r,o,i,a,u,c,s=p(e,"number");if(f(s))throw O("Cannot convert a Symbol value to a number");if("string"==typeof s&&s.length>2)if(s=b(s),43===(t=R(s,0))||45===t){if(88===(n=R(s,2))||120===n)return NaN}else if(48===t){switch(R(s,1)){case 66:case 98:r=2,o=49;break;case 79:case 111:r=8,o=55;break;default:return+s}for(a=(i=T(s,2)).length,u=0;u<a;u++)if((c=R(i,u))<48||c>o)return NaN;return parseInt(i,r)}return+s};if(a(g,!w(" 0o1")||!w("0b1")||w("+0x1"))){for(var P,x=function(e){var t=arguments.length<1?0:w(S(e)),n=this;return l(_,n)&&d((function(){v(n)}))?s(Object(t),n,x):t},j=r?h(w):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),C=0;j.length>C;C++)c(w,P=j[C])&&!c(x,P)&&m(x,P,y(w,P));x.prototype=_,_.constructor=x,u(o,g,x,{constructor:!0})}},35192:function(e,t,n){n(82109)({target:"Number",stat:!0},{isFinite:n(77023)})},33161:function(e,t,n){n(82109)({target:"Number",stat:!0},{isInteger:n(55988)})},44048:function(e,t,n){n(82109)({target:"Number",stat:!0},{isNaN:function(e){return e!=e}})},61874:function(e,t,n){var r=n(82109),o=n(2814);r({target:"Number",stat:!0,forced:Number.parseFloat!=o},{parseFloat:o})},56977:function(e,t,n){"use strict";var r=n(82109),o=n(17854),i=n(1702),a=n(19303),u=n(50863),c=n(38415),s=n(47293),l=o.RangeError,f=o.String,p=Math.floor,d=i(c),h=i("".slice),y=i(1..toFixed),m=function(e,t,n){return 0===t?n:t%2==1?m(e,t-1,n*e):m(e*e,t/2,n)},v=function(e,t,n){for(var r=-1,o=n;++r<6;)o+=t*e[r],e[r]=o%1e7,o=p(o/1e7)},b=function(e,t){for(var n=6,r=0;--n>=0;)r+=e[n],e[n]=p(r/t),r=r%t*1e7},g=function(e){for(var t=6,n="";--t>=0;)if(""!==n||0===t||0!==e[t]){var r=f(e[t]);n=""===n?r:n+d("0",7-r.length)+r}return n};r({target:"Number",proto:!0,forced:s((function(){return"0.000"!==y(8e-5,3)||"1"!==y(.9,0)||"1.25"!==y(1.255,2)||"1000000000000000128"!==y(0xde0b6b3a7640080,0)}))||!s((function(){y({})}))},{toFixed:function(e){var t,n,r,o,i=u(this),c=a(e),s=[0,0,0,0,0,0],p="",y="0";if(c<0||c>20)throw l("Incorrect fraction digits");if(i!=i)return"NaN";if(i<=-1e21||i>=1e21)return f(i);if(i<0&&(p="-",i=-i),i>1e-21)if(n=(t=function(e){for(var t=0,n=e;n>=4096;)t+=12,n/=4096;for(;n>=2;)t+=1,n/=2;return t}(i*m(2,69,1))-69)<0?i*m(2,-t,1):i/m(2,t,1),n*=4503599627370496,(t=52-t)>0){for(v(s,0,n),r=c;r>=7;)v(s,1e7,0),r-=7;for(v(s,m(10,r,1),0),r=t-1;r>=23;)b(s,1<<23),r-=23;b(s,1<<r),v(s,1,1),b(s,2),y=g(s)}else v(s,0,n),v(s,1<<-t,0),y=g(s)+d("0",c);return c>0?p+((o=y.length)<=c?"0."+d("0",c-o)+y:h(y,0,o-c)+"."+h(y,o-c)):p+y}})},19601:function(e,t,n){var r=n(82109),o=n(21574);r({target:"Object",stat:!0,arity:2,forced:Object.assign!==o},{assign:o})},33321:function(e,t,n){var r=n(82109),o=n(19781),i=n(36048).f;r({target:"Object",stat:!0,forced:Object.defineProperties!==i,sham:!o},{defineProperties:i})},69070:function(e,t,n){var r=n(82109),o=n(19781),i=n(3070).f;r({target:"Object",stat:!0,forced:Object.defineProperty!==i,sham:!o},{defineProperty:i})},69720:function(e,t,n){var r=n(82109),o=n(44699).entries;r({target:"Object",stat:!0},{entries:function(e){return o(e)}})},38880:function(e,t,n){var r=n(82109),o=n(47293),i=n(45656),a=n(31236).f,u=n(19781),c=o((function(){a(1)}));r({target:"Object",stat:!0,forced:!u||c,sham:!u},{getOwnPropertyDescriptor:function(e,t){return a(i(e),t)}})},49337:function(e,t,n){var r=n(82109),o=n(19781),i=n(53887),a=n(45656),u=n(31236),c=n(86135);r({target:"Object",stat:!0,sham:!o},{getOwnPropertyDescriptors:function(e){for(var t,n,r=a(e),o=u.f,s=i(r),l={},f=0;s.length>f;)void 0!==(n=o(r,t=s[f++]))&&c(l,t,n);return l}})},29660:function(e,t,n){var r=n(82109),o=n(30133),i=n(47293),a=n(25181),u=n(47908);r({target:"Object",stat:!0,forced:!o||i((function(){a.f(1)}))},{getOwnPropertySymbols:function(e){var t=a.f;return t?t(u(e)):[]}})},30489:function(e,t,n){var r=n(82109),o=n(47293),i=n(47908),a=n(79518),u=n(49920);r({target:"Object",stat:!0,forced:o((function(){a(1)})),sham:!u},{getPrototypeOf:function(e){return a(i(e))}})},47941:function(e,t,n){var r=n(82109),o=n(47908),i=n(81956);r({target:"Object",stat:!0,forced:n(47293)((function(){i(1)}))},{keys:function(e){return i(o(e))}})},68304:function(e,t,n){n(82109)({target:"Object",stat:!0},{setPrototypeOf:n(27674)})},41539:function(e,t,n){var r=n(51694),o=n(98052),i=n(90288);r||o(Object.prototype,"toString",i,{unsafe:!0})},54678:function(e,t,n){var r=n(82109),o=n(2814);r({global:!0,forced:parseFloat!=o},{parseFloat:o})},91058:function(e,t,n){var r=n(82109),o=n(83009);r({global:!0,forced:parseInt!=o},{parseInt:o})},70821:function(e,t,n){"use strict";var r=n(82109),o=n(46916),i=n(19662),a=n(78523),u=n(12534),c=n(20408);r({target:"Promise",stat:!0,forced:n(80612)},{all:function(e){var t=this,n=a.f(t),r=n.resolve,s=n.reject,l=u((function(){var n=i(t.resolve),a=[],u=0,l=1;c(e,(function(e){var i=u++,c=!1;l++,o(n,t,e).then((function(e){c||(c=!0,a[i]=e,--l||r(a))}),s)})),--l||r(a)}));return l.error&&s(l.value),n.promise}})},94164:function(e,t,n){"use strict";var r=n(82109),o=n(31913),i=n(63702).CONSTRUCTOR,a=n(2492),u=n(35005),c=n(60614),s=n(98052),l=a&&a.prototype;if(r({target:"Promise",proto:!0,forced:i,real:!0},{catch:function(e){return this.then(void 0,e)}}),!o&&c(a)){var f=u("Promise").prototype.catch;l.catch!==f&&s(l,"catch",f,{unsafe:!0})}},43401:function(e,t,n){"use strict";var r,o,i,a=n(82109),u=n(31913),c=n(35268),s=n(17854),l=n(46916),f=n(98052),p=n(27674),d=n(58003),h=n(96340),y=n(19662),m=n(60614),v=n(70111),b=n(25787),g=n(36707),w=n(20261).set,_=n(95948),O=n(842),T=n(12534),R=n(18572),S=n(29909),E=n(2492),P=n(63702),x=n(78523),j="Promise",C=P.CONSTRUCTOR,k=P.REJECTION_EVENT,M=P.SUBCLASSING,D=S.getterFor(j),A=S.set,I=E&&E.prototype,N=E,V=I,U=s.TypeError,F=s.document,B=s.process,L=x.f,H=L,z=!!(F&&F.createEvent&&s.dispatchEvent),q="unhandledrejection",G=function(e){var t;return!(!v(e)||!m(t=e.then))&&t},W=function(e,t){var n,r,o,i=t.value,a=1==t.state,u=a?e.ok:e.fail,c=e.resolve,s=e.reject,f=e.domain;try{u?(a||(2===t.rejection&&X(t),t.rejection=1),!0===u?n=i:(f&&f.enter(),n=u(i),f&&(f.exit(),o=!0)),n===e.promise?s(U("Promise-chain cycle")):(r=G(n))?l(r,n,c,s):c(n)):s(i)}catch(e){f&&!o&&f.exit(),s(e)}},Q=function(e,t){e.notified||(e.notified=!0,_((function(){for(var n,r=e.reactions;n=r.get();)W(n,e);e.notified=!1,t&&!e.rejection&&Y(e)})))},K=function(e,t,n){var r,o;z?((r=F.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),s.dispatchEvent(r)):r={promise:t,reason:n},!k&&(o=s["on"+e])?o(r):e===q&&O("Unhandled promise rejection",n)},Y=function(e){l(w,s,(function(){var t,n=e.facade,r=e.value;if(Z(e)&&(t=T((function(){c?B.emit("unhandledRejection",r,n):K(q,n,r)})),e.rejection=c||Z(e)?2:1,t.error))throw t.value}))},Z=function(e){return 1!==e.rejection&&!e.parent},X=function(e){l(w,s,(function(){var t=e.facade;c?B.emit("rejectionHandled",t):K("rejectionhandled",t,e.value)}))},J=function(e,t,n){return function(r){e(t,r,n)}},$=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,Q(e,!0))},ee=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw U("Promise can't be resolved itself");var r=G(t);r?_((function(){var n={done:!1};try{l(r,t,J(ee,n,e),J($,n,e))}catch(t){$(n,t,e)}})):(e.value=t,e.state=1,Q(e,!1))}catch(t){$({done:!1},t,e)}}};if(C&&(V=(N=function(e){b(this,V),y(e),l(r,this);var t=D(this);try{e(J(ee,t),J($,t))}catch(e){$(t,e)}}).prototype,(r=function(e){A(this,{type:j,done:!1,notified:!1,parent:!1,reactions:new R,rejection:!1,state:0,value:void 0})}).prototype=f(V,"then",(function(e,t){var n=D(this),r=L(g(this,N));return n.parent=!0,r.ok=!m(e)||e,r.fail=m(t)&&t,r.domain=c?B.domain:void 0,0==n.state?n.reactions.add(r):_((function(){W(r,n)})),r.promise})),o=function(){var e=new r,t=D(e);this.promise=e,this.resolve=J(ee,t),this.reject=J($,t)},x.f=L=function(e){return e===N||void 0===e?new o(e):H(e)},!u&&m(E)&&I!==Object.prototype)){i=I.then,M||f(I,"then",(function(e,t){var n=this;return new N((function(e,t){l(i,n,e,t)})).then(e,t)}),{unsafe:!0});try{delete I.constructor}catch(e){}p&&p(I,V)}a({global:!0,constructor:!0,wrap:!0,forced:C},{Promise:N}),d(N,j,!1,!0),h(j)},88674:function(e,t,n){n(43401),n(70821),n(94164),n(6027),n(60683),n(96294)},6027:function(e,t,n){"use strict";var r=n(82109),o=n(46916),i=n(19662),a=n(78523),u=n(12534),c=n(20408);r({target:"Promise",stat:!0,forced:n(80612)},{race:function(e){var t=this,n=a.f(t),r=n.reject,s=u((function(){var a=i(t.resolve);c(e,(function(e){o(a,t,e).then(n.resolve,r)}))}));return s.error&&r(s.value),n.promise}})},60683:function(e,t,n){"use strict";var r=n(82109),o=n(46916),i=n(78523);r({target:"Promise",stat:!0,forced:n(63702).CONSTRUCTOR},{reject:function(e){var t=i.f(this);return o(t.reject,void 0,e),t.promise}})},96294:function(e,t,n){"use strict";var r=n(82109),o=n(35005),i=n(31913),a=n(2492),u=n(63702).CONSTRUCTOR,c=n(69478),s=o("Promise"),l=i&&!u;r({target:"Promise",stat:!0,forced:i||u},{resolve:function(e){return c(l&&this===s?a:this,e)}})},12419:function(e,t,n){var r=n(82109),o=n(35005),i=n(22104),a=n(27065),u=n(39483),c=n(19670),s=n(70111),l=n(70030),f=n(47293),p=o("Reflect","construct"),d=Object.prototype,h=[].push,y=f((function(){function e(){}return!(p((function(){}),[],e)instanceof e)})),m=!f((function(){p((function(){}))})),v=y||m;r({target:"Reflect",stat:!0,forced:v,sham:v},{construct:function(e,t){u(e),c(t);var n=arguments.length<3?e:u(arguments[2]);if(m&&!y)return p(e,t,n);if(e==n){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var r=[null];return i(h,r,t),new(i(a,e,r))}var o=n.prototype,f=l(s(o)?o:d),v=i(e,f,t);return s(v)?v:f}})},74819:function(e,t,n){var r=n(82109),o=n(46916),i=n(70111),a=n(19670),u=n(45032),c=n(31236),s=n(79518);r({target:"Reflect",stat:!0},{get:function e(t,n){var r,l,f=arguments.length<3?t:arguments[2];return a(t)===f?t[n]:(r=c.f(t,n))?u(r)?r.value:void 0===r.get?void 0:o(r.get,f):i(l=s(t))?e(l,n,f):void 0}})},81299:function(e,t,n){var r=n(82109),o=n(17854),i=n(58003);r({global:!0},{Reflect:{}}),i(o.Reflect,"Reflect",!0)},24603:function(e,t,n){var r=n(19781),o=n(17854),i=n(1702),a=n(54705),u=n(79587),c=n(68880),s=n(8006).f,l=n(47976),f=n(47850),p=n(41340),d=n(34706),h=n(52999),y=n(2626),m=n(98052),v=n(47293),b=n(92597),g=n(29909).enforce,w=n(96340),_=n(5112),O=n(9441),T=n(38173),R=_("match"),S=o.RegExp,E=S.prototype,P=o.SyntaxError,x=i(E.exec),j=i("".charAt),C=i("".replace),k=i("".indexOf),M=i("".slice),D=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,A=/a/g,I=/a/g,N=new S(A)!==A,V=h.MISSED_STICKY,U=h.UNSUPPORTED_Y;if(a("RegExp",r&&(!N||V||O||T||v((function(){return I[R]=!1,S(A)!=A||S(I)==I||"/a/i"!=S(A,"i")}))))){for(var F=function(e,t){var n,r,o,i,a,s,h=l(E,this),y=f(e),m=void 0===t,v=[],w=e;if(!h&&y&&m&&e.constructor===F)return e;if((y||l(E,e))&&(e=e.source,m&&(t=d(w))),e=void 0===e?"":p(e),t=void 0===t?"":p(t),w=e,O&&"dotAll"in A&&(r=!!t&&k(t,"s")>-1)&&(t=C(t,/s/g,"")),n=t,V&&"sticky"in A&&(o=!!t&&k(t,"y")>-1)&&U&&(t=C(t,/y/g,"")),T&&(i=function(e){for(var t,n=e.length,r=0,o="",i=[],a={},u=!1,c=!1,s=0,l="";r<=n;r++){if("\\"===(t=j(e,r)))t+=j(e,++r);else if("]"===t)u=!1;else if(!u)switch(!0){case"["===t:u=!0;break;case"("===t:x(D,M(e,r+1))&&(r+=2,c=!0),o+=t,s++;continue;case">"===t&&c:if(""===l||b(a,l))throw new P("Invalid capture group name");a[l]=!0,i[i.length]=[l,s],c=!1,l="";continue}c?l+=t:o+=t}return[o,i]}(e),e=i[0],v=i[1]),a=u(S(e,t),h?this:E,F),(r||o||v.length)&&(s=g(a),r&&(s.dotAll=!0,s.raw=F(function(e){for(var t,n=e.length,r=0,o="",i=!1;r<=n;r++)"\\"!==(t=j(e,r))?i||"."!==t?("["===t?i=!0:"]"===t&&(i=!1),o+=t):o+="[\\s\\S]":o+=t+j(e,++r);return o}(e),n)),o&&(s.sticky=!0),v.length&&(s.groups=v)),e!==w)try{c(a,"source",""===w?"(?:)":w)}catch(e){}return a},B=s(S),L=0;B.length>L;)y(F,S,B[L++]);E.constructor=F,F.prototype=E,m(o,"RegExp",F,{constructor:!0})}w("RegExp")},28450:function(e,t,n){var r=n(17854),o=n(19781),i=n(9441),a=n(84326),u=n(47045),c=n(29909).get,s=RegExp.prototype,l=r.TypeError;o&&i&&u(s,"dotAll",{configurable:!0,get:function(){if(this!==s){if("RegExp"===a(this))return!!c(this).dotAll;throw l("Incompatible receiver, RegExp required")}}})},74916:function(e,t,n){"use strict";var r=n(82109),o=n(22261);r({target:"RegExp",proto:!0,forced:/./.exec!==o},{exec:o})},88386:function(e,t,n){var r=n(17854),o=n(19781),i=n(52999).MISSED_STICKY,a=n(84326),u=n(47045),c=n(29909).get,s=RegExp.prototype,l=r.TypeError;o&&i&&u(s,"sticky",{configurable:!0,get:function(){if(this!==s){if("RegExp"===a(this))return!!c(this).sticky;throw l("Incompatible receiver, RegExp required")}}})},77601:function(e,t,n){"use strict";n(74916);var r,o,i=n(82109),a=n(17854),u=n(46916),c=n(1702),s=n(60614),l=n(70111),f=(r=!1,(o=/[ac]/).exec=function(){return r=!0,/./.exec.apply(this,arguments)},!0===o.test("abc")&&r),p=a.Error,d=c(/./.test);i({target:"RegExp",proto:!0,forced:!f},{test:function(e){var t=this.exec;if(!s(t))return d(this,e);var n=u(t,this,e);if(null!==n&&!l(n))throw new p("RegExp exec method returned something other than an Object or null");return!!n}})},39714:function(e,t,n){"use strict";var r=n(76530).PROPER,o=n(98052),i=n(19670),a=n(41340),u=n(47293),c=n(34706),s="toString",l=RegExp.prototype.toString,f=u((function(){return"/a/b"!=l.call({source:"a",flags:"b"})})),p=r&&l.name!=s;(f||p)&&o(RegExp.prototype,s,(function(){var e=i(this);return"/"+a(e.source)+"/"+a(c(e))}),{unsafe:!0})},32023:function(e,t,n){"use strict";var r=n(82109),o=n(1702),i=n(3929),a=n(84488),u=n(41340),c=n(84964),s=o("".indexOf);r({target:"String",proto:!0,forced:!c("includes")},{includes:function(e){return!!~s(u(a(this)),u(i(e)),arguments.length>1?arguments[1]:void 0)}})},78783:function(e,t,n){"use strict";var r=n(28710).charAt,o=n(41340),i=n(29909),a=n(70654),u="String Iterator",c=i.set,s=i.getterFor(u);a(String,"String",(function(e){c(this,{type:u,string:o(e),index:0})}),(function(){var e,t=s(this),n=t.string,o=t.index;return o>=n.length?{value:void 0,done:!0}:(e=r(n,o),t.index+=e.length,{value:e,done:!1})}))},76373:function(e,t,n){"use strict";var r=n(82109),o=n(17854),i=n(46916),a=n(1702),u=n(24994),c=n(84488),s=n(17466),l=n(41340),f=n(19670),p=n(84326),d=n(47850),h=n(34706),y=n(58173),m=n(98052),v=n(47293),b=n(5112),g=n(36707),w=n(31530),_=n(97651),O=n(29909),T=n(31913),R=b("matchAll"),S="RegExp String Iterator",E=O.set,P=O.getterFor(S),x=RegExp.prototype,j=o.TypeError,C=a("".indexOf),k=a("".matchAll),M=!!k&&!v((function(){k("a",/./)})),D=u((function(e,t,n,r){E(this,{type:S,regexp:e,string:t,global:n,unicode:r,done:!1})}),"RegExp String",(function(){var e=P(this);if(e.done)return{value:void 0,done:!0};var t=e.regexp,n=e.string,r=_(t,n);return null===r?{value:void 0,done:e.done=!0}:e.global?(""===l(r[0])&&(t.lastIndex=w(n,s(t.lastIndex),e.unicode)),{value:r,done:!1}):(e.done=!0,{value:r,done:!1})})),A=function(e){var t,n,r,o=f(this),i=l(e),a=g(o,RegExp),u=l(h(o));return t=new a(a===RegExp?o.source:o,u),n=!!~C(u,"g"),r=!!~C(u,"u"),t.lastIndex=s(o.lastIndex),new D(t,i,n,r)};r({target:"String",proto:!0,forced:M},{matchAll:function(e){var t,n,r,o,a=c(this);if(null!=e){if(d(e)&&(t=l(c(h(e))),!~C(t,"g")))throw j("`.matchAll` does not allow non-global regexes");if(M)return k(a,e);if(void 0===(r=y(e,R))&&T&&"RegExp"==p(e)&&(r=A),r)return i(r,e,a)}else if(M)return k(a,e);return n=l(a),o=new RegExp(e,"g"),T?i(A,o,n):o[R](n)}}),T||R in x||m(x,R,A)},4723:function(e,t,n){"use strict";var r=n(46916),o=n(27007),i=n(19670),a=n(17466),u=n(41340),c=n(84488),s=n(58173),l=n(31530),f=n(97651);o("match",(function(e,t,n){return[function(t){var n=c(this),o=null==t?void 0:s(t,e);return o?r(o,t,n):new RegExp(t)[e](u(n))},function(e){var r=i(this),o=u(e),c=n(t,r,o);if(c.done)return c.value;if(!r.global)return f(r,o);var s=r.unicode;r.lastIndex=0;for(var p,d=[],h=0;null!==(p=f(r,o));){var y=u(p[0]);d[h]=y,""===y&&(r.lastIndex=l(o,a(r.lastIndex),s)),h++}return 0===h?null:d}]}))},83112:function(e,t,n){"use strict";var r=n(82109),o=n(76650).start;r({target:"String",proto:!0,forced:n(54986)},{padStart:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}})},82481:function(e,t,n){n(82109)({target:"String",proto:!0},{repeat:n(38415)})},15306:function(e,t,n){"use strict";var r=n(22104),o=n(46916),i=n(1702),a=n(27007),u=n(47293),c=n(19670),s=n(60614),l=n(19303),f=n(17466),p=n(41340),d=n(84488),h=n(31530),y=n(58173),m=n(10647),v=n(97651),b=n(5112)("replace"),g=Math.max,w=Math.min,_=i([].concat),O=i([].push),T=i("".indexOf),R=i("".slice),S="$0"==="a".replace(/./,"$0"),E=!!/./[b]&&""===/./[b]("a","$0");a("replace",(function(e,t,n){var i=E?"$":"$0";return[function(e,n){var r=d(this),i=null==e?void 0:y(e,b);return i?o(i,e,r,n):o(t,p(r),e,n)},function(e,o){var a=c(this),u=p(e);if("string"==typeof o&&-1===T(o,i)&&-1===T(o,"$<")){var d=n(t,a,u,o);if(d.done)return d.value}var y=s(o);y||(o=p(o));var b=a.global;if(b){var S=a.unicode;a.lastIndex=0}for(var E=[];;){var P=v(a,u);if(null===P)break;if(O(E,P),!b)break;""===p(P[0])&&(a.lastIndex=h(u,f(a.lastIndex),S))}for(var x,j="",C=0,k=0;k<E.length;k++){for(var M=p((P=E[k])[0]),D=g(w(l(P.index),u.length),0),A=[],I=1;I<P.length;I++)O(A,void 0===(x=P[I])?x:String(x));var N=P.groups;if(y){var V=_([M],A,D,u);void 0!==N&&O(V,N);var U=p(r(o,void 0,V))}else U=m(M,u,D,A,N,o);D>=C&&(j+=R(u,C,D)+U,C=D+M.length)}return j+R(u,C)}]}),!!u((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}))||!S||E)},64765:function(e,t,n){"use strict";var r=n(46916),o=n(27007),i=n(19670),a=n(84488),u=n(81150),c=n(41340),s=n(58173),l=n(97651);o("search",(function(e,t,n){return[function(t){var n=a(this),o=null==t?void 0:s(t,e);return o?r(o,t,n):new RegExp(t)[e](c(n))},function(e){var r=i(this),o=c(e),a=n(t,r,o);if(a.done)return a.value;var s=r.lastIndex;u(s,0)||(r.lastIndex=0);var f=l(r,o);return u(r.lastIndex,s)||(r.lastIndex=s),null===f?-1:f.index}]}))},23123:function(e,t,n){"use strict";var r=n(22104),o=n(46916),i=n(1702),a=n(27007),u=n(47850),c=n(19670),s=n(84488),l=n(36707),f=n(31530),p=n(17466),d=n(41340),h=n(58173),y=n(41589),m=n(97651),v=n(22261),b=n(52999),g=n(47293),w=b.UNSUPPORTED_Y,_=4294967295,O=Math.min,T=[].push,R=i(/./.exec),S=i(T),E=i("".slice),P=!g((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));a("split",(function(e,t,n){var i;return i="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,n){var i=d(s(this)),a=void 0===n?_:n>>>0;if(0===a)return[];if(void 0===e)return[i];if(!u(e))return o(t,i,e,a);for(var c,l,f,p=[],h=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),m=0,b=new RegExp(e.source,h+"g");(c=o(v,b,i))&&!((l=b.lastIndex)>m&&(S(p,E(i,m,c.index)),c.length>1&&c.index<i.length&&r(T,p,y(c,1)),f=c[0].length,m=l,p.length>=a));)b.lastIndex===c.index&&b.lastIndex++;return m===i.length?!f&&R(b,"")||S(p,""):S(p,E(i,m)),p.length>a?y(p,0,a):p}:"0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:o(t,this,e,n)}:t,[function(t,n){var r=s(this),a=null==t?void 0:h(t,e);return a?o(a,t,r,n):o(i,d(r),t,n)},function(e,r){var o=c(this),a=d(e),u=n(i,o,a,r,i!==t);if(u.done)return u.value;var s=l(o,RegExp),h=o.unicode,y=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(w?"g":"y"),v=new s(w?"^(?:"+o.source+")":o,y),b=void 0===r?_:r>>>0;if(0===b)return[];if(0===a.length)return null===m(v,a)?[a]:[];for(var g=0,T=0,R=[];T<a.length;){v.lastIndex=w?0:T;var P,x=m(v,w?E(a,T):a);if(null===x||(P=O(p(v.lastIndex+(w?T:0)),a.length))===g)T=f(a,T,h);else{if(S(R,E(a,g,T)),R.length===b)return R;for(var j=1;j<=x.length-1;j++)if(S(R,x[j]),R.length===b)return R;T=g=P}}return S(R,E(a,g)),R}]}),!P,w)},23157:function(e,t,n){"use strict";var r,o=n(82109),i=n(1702),a=n(31236).f,u=n(17466),c=n(41340),s=n(3929),l=n(84488),f=n(84964),p=n(31913),d=i("".startsWith),h=i("".slice),y=Math.min,m=f("startsWith");o({target:"String",proto:!0,forced:!(!p&&!m&&(r=a(String.prototype,"startsWith"),r&&!r.writable)||m)},{startsWith:function(e){var t=c(l(this));s(e);var n=u(y(arguments.length>1?arguments[1]:void 0,t.length)),r=c(e);return d?d(t,r,n):h(t,n,n+r.length)===r}})},60086:function(e,t,n){"use strict";var r=n(82109),o=n(14230);r({target:"String",proto:!0,forced:n(43429)("sub")},{sub:function(){return o(this,"sub","","")}})},73210:function(e,t,n){"use strict";var r=n(82109),o=n(53111).trim;r({target:"String",proto:!0,forced:n(76091)("trim")},{trim:function(){return o(this)}})},4032:function(e,t,n){"use strict";var r=n(82109),o=n(17854),i=n(46916),a=n(1702),u=n(31913),c=n(19781),s=n(30133),l=n(47293),f=n(92597),p=n(47976),d=n(19670),h=n(45656),y=n(34948),m=n(41340),v=n(79114),b=n(70030),g=n(81956),w=n(8006),_=n(1156),O=n(25181),T=n(31236),R=n(3070),S=n(36048),E=n(55296),P=n(98052),x=n(72309),j=n(6200),C=n(3501),k=n(69711),M=n(5112),D=n(6061),A=n(97235),I=n(56532),N=n(58003),V=n(29909),U=n(42092).forEach,F=j("hidden"),B="Symbol",L=V.set,H=V.getterFor(B),z=Object.prototype,q=o.Symbol,G=q&&q.prototype,W=o.TypeError,Q=o.QObject,K=T.f,Y=R.f,Z=_.f,X=E.f,J=a([].push),$=x("symbols"),ee=x("op-symbols"),te=x("wks"),ne=!Q||!Q.prototype||!Q.prototype.findChild,re=c&&l((function(){return 7!=b(Y({},"a",{get:function(){return Y(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=K(z,t);r&&delete z[t],Y(e,t,n),r&&e!==z&&Y(z,t,r)}:Y,oe=function(e,t){var n=$[e]=b(G);return L(n,{type:B,tag:e,description:t}),c||(n.description=t),n},ie=function(e,t,n){e===z&&ie(ee,t,n),d(e);var r=y(t);return d(n),f($,r)?(n.enumerable?(f(e,F)&&e[F][r]&&(e[F][r]=!1),n=b(n,{enumerable:v(0,!1)})):(f(e,F)||Y(e,F,v(1,{})),e[F][r]=!0),re(e,r,n)):Y(e,r,n)},ae=function(e,t){d(e);var n=h(t),r=g(n).concat(le(n));return U(r,(function(t){c&&!i(ue,n,t)||ie(e,t,n[t])})),e},ue=function(e){var t=y(e),n=i(X,this,t);return!(this===z&&f($,t)&&!f(ee,t))&&(!(n||!f(this,t)||!f($,t)||f(this,F)&&this[F][t])||n)},ce=function(e,t){var n=h(e),r=y(t);if(n!==z||!f($,r)||f(ee,r)){var o=K(n,r);return!o||!f($,r)||f(n,F)&&n[F][r]||(o.enumerable=!0),o}},se=function(e){var t=Z(h(e)),n=[];return U(t,(function(e){f($,e)||f(C,e)||J(n,e)})),n},le=function(e){var t=e===z,n=Z(t?ee:h(e)),r=[];return U(n,(function(e){!f($,e)||t&&!f(z,e)||J(r,$[e])})),r};s||(q=function(){if(p(G,this))throw W("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?m(arguments[0]):void 0,t=k(e),n=function(e){this===z&&i(n,ee,e),f(this,F)&&f(this[F],t)&&(this[F][t]=!1),re(this,t,v(1,e))};return c&&ne&&re(z,t,{configurable:!0,set:n}),oe(t,e)},P(G=q.prototype,"toString",(function(){return H(this).tag})),P(q,"withoutSetter",(function(e){return oe(k(e),e)})),E.f=ue,R.f=ie,S.f=ae,T.f=ce,w.f=_.f=se,O.f=le,D.f=function(e){return oe(M(e),e)},c&&(Y(G,"description",{configurable:!0,get:function(){return H(this).description}}),u||P(z,"propertyIsEnumerable",ue,{unsafe:!0}))),r({global:!0,constructor:!0,wrap:!0,forced:!s,sham:!s},{Symbol:q}),U(g(te),(function(e){A(e)})),r({target:B,stat:!0,forced:!s},{useSetter:function(){ne=!0},useSimple:function(){ne=!1}}),r({target:"Object",stat:!0,forced:!s,sham:!c},{create:function(e,t){return void 0===t?b(e):ae(b(e),t)},defineProperty:ie,defineProperties:ae,getOwnPropertyDescriptor:ce}),r({target:"Object",stat:!0,forced:!s},{getOwnPropertyNames:se}),I(),N(q,B),C[F]=!0},41817:function(e,t,n){"use strict";var r=n(82109),o=n(19781),i=n(17854),a=n(1702),u=n(92597),c=n(60614),s=n(47976),l=n(41340),f=n(3070).f,p=n(99920),d=i.Symbol,h=d&&d.prototype;if(o&&c(d)&&(!("description"in h)||void 0!==d().description)){var y={},m=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:l(arguments[0]),t=s(h,this)?new d(e):void 0===e?d():d(e);return""===e&&(y[t]=!0),t};p(m,d),m.prototype=h,h.constructor=m;var v="Symbol(test)"==String(d("test")),b=a(h.toString),g=a(h.valueOf),w=/^Symbol\((.*)\)[^)]+$/,_=a("".replace),O=a("".slice);f(h,"description",{configurable:!0,get:function(){var e=g(this),t=b(e);if(u(y,e))return"";var n=v?O(t,7,-1):_(t,w,"$1");return""===n?void 0:n}}),r({global:!0,constructor:!0,forced:!0},{Symbol:m})}},40763:function(e,t,n){var r=n(82109),o=n(35005),i=n(92597),a=n(41340),u=n(72309),c=n(30735),s=u("string-to-symbol-registry"),l=u("symbol-to-string-registry");r({target:"Symbol",stat:!0,forced:!c},{for:function(e){var t=a(e);if(i(s,t))return s[t];var n=o("Symbol")(t);return s[t]=n,l[n]=t,n}})},32165:function(e,t,n){n(97235)("iterator")},82526:function(e,t,n){n(4032),n(40763),n(26620),n(38862),n(29660)},26620:function(e,t,n){var r=n(82109),o=n(92597),i=n(52190),a=n(66330),u=n(72309),c=n(30735),s=u("symbol-to-string-registry");r({target:"Symbol",stat:!0,forced:!c},{keyFor:function(e){if(!i(e))throw TypeError(a(e)+" is not a symbol");if(o(s,e))return s[e]}})},48675:function(e,t,n){"use strict";var r=n(90260),o=n(26244),i=n(19303),a=r.aTypedArray;(0,r.exportTypedArrayMethod)("at",(function(e){var t=a(this),n=o(t),r=i(e),u=r>=0?r:n+r;return u<0||u>=n?void 0:t[u]}))},92990:function(e,t,n){"use strict";var r=n(1702),o=n(90260),i=r(n(1048)),a=o.aTypedArray;(0,o.exportTypedArrayMethod)("copyWithin",(function(e,t){return i(a(this),e,t,arguments.length>2?arguments[2]:void 0)}))},18927:function(e,t,n){"use strict";var r=n(90260),o=n(42092).every,i=r.aTypedArray;(0,r.exportTypedArrayMethod)("every",(function(e){return o(i(this),e,arguments.length>1?arguments[1]:void 0)}))},33105:function(e,t,n){"use strict";var r=n(90260),o=n(46916),i=n(21285),a=r.aTypedArray;(0,r.exportTypedArrayMethod)("fill",(function(e){var t=arguments.length;return o(i,a(this),e,t>1?arguments[1]:void 0,t>2?arguments[2]:void 0)}))},35035:function(e,t,n){"use strict";var r=n(90260),o=n(42092).filter,i=n(43074),a=r.aTypedArray;(0,r.exportTypedArrayMethod)("filter",(function(e){var t=o(a(this),e,arguments.length>1?arguments[1]:void 0);return i(this,t)}))},7174:function(e,t,n){"use strict";var r=n(90260),o=n(42092).findIndex,i=r.aTypedArray;(0,r.exportTypedArrayMethod)("findIndex",(function(e){return o(i(this),e,arguments.length>1?arguments[1]:void 0)}))},74345:function(e,t,n){"use strict";var r=n(90260),o=n(42092).find,i=r.aTypedArray;(0,r.exportTypedArrayMethod)("find",(function(e){return o(i(this),e,arguments.length>1?arguments[1]:void 0)}))},44197:function(e,t,n){n(19843)("Float32",(function(e){return function(t,n,r){return e(this,t,n,r)}}))},32846:function(e,t,n){"use strict";var r=n(90260),o=n(42092).forEach,i=r.aTypedArray;(0,r.exportTypedArrayMethod)("forEach",(function(e){o(i(this),e,arguments.length>1?arguments[1]:void 0)}))},44731:function(e,t,n){"use strict";var r=n(90260),o=n(41318).includes,i=r.aTypedArray;(0,r.exportTypedArrayMethod)("includes",(function(e){return o(i(this),e,arguments.length>1?arguments[1]:void 0)}))},77209:function(e,t,n){"use strict";var r=n(90260),o=n(41318).indexOf,i=r.aTypedArray;(0,r.exportTypedArrayMethod)("indexOf",(function(e){return o(i(this),e,arguments.length>1?arguments[1]:void 0)}))},96319:function(e,t,n){"use strict";var r=n(17854),o=n(47293),i=n(1702),a=n(90260),u=n(66992),c=n(5112)("iterator"),s=r.Uint8Array,l=i(u.values),f=i(u.keys),p=i(u.entries),d=a.aTypedArray,h=a.exportTypedArrayMethod,y=s&&s.prototype,m=!o((function(){y[c].call([1])})),v=!!y&&y.values&&y[c]===y.values&&"values"===y.values.name,b=function(){return l(d(this))};h("entries",(function(){return p(d(this))}),m),h("keys",(function(){return f(d(this))}),m),h("values",b,m||!v,{name:"values"}),h(c,b,m||!v,{name:"values"})},58867:function(e,t,n){"use strict";var r=n(90260),o=n(1702),i=r.aTypedArray,a=r.exportTypedArrayMethod,u=o([].join);a("join",(function(e){return u(i(this),e)}))},37789:function(e,t,n){"use strict";var r=n(90260),o=n(22104),i=n(86583),a=r.aTypedArray;(0,r.exportTypedArrayMethod)("lastIndexOf",(function(e){var t=arguments.length;return o(i,a(this),t>1?[e,arguments[1]]:[e])}))},33739:function(e,t,n){"use strict";var r=n(90260),o=n(42092).map,i=n(66304),a=r.aTypedArray;(0,r.exportTypedArrayMethod)("map",(function(e){return o(a(this),e,arguments.length>1?arguments[1]:void 0,(function(e,t){return new(i(e))(t)}))}))},14483:function(e,t,n){"use strict";var r=n(90260),o=n(53671).right,i=r.aTypedArray;(0,r.exportTypedArrayMethod)("reduceRight",(function(e){var t=arguments.length;return o(i(this),e,t,t>1?arguments[1]:void 0)}))},29368:function(e,t,n){"use strict";var r=n(90260),o=n(53671).left,i=r.aTypedArray;(0,r.exportTypedArrayMethod)("reduce",(function(e){var t=arguments.length;return o(i(this),e,t,t>1?arguments[1]:void 0)}))},12056:function(e,t,n){"use strict";var r=n(90260),o=r.aTypedArray,i=r.exportTypedArrayMethod,a=Math.floor;i("reverse",(function(){for(var e,t=this,n=o(t).length,r=a(n/2),i=0;i<r;)e=t[i],t[i++]=t[--n],t[n]=e;return t}))},3462:function(e,t,n){"use strict";var r=n(17854),o=n(46916),i=n(90260),a=n(26244),u=n(84590),c=n(47908),s=n(47293),l=r.RangeError,f=r.Int8Array,p=f&&f.prototype,d=p&&p.set,h=i.aTypedArray,y=i.exportTypedArrayMethod,m=!s((function(){var e=new Uint8ClampedArray(2);return o(d,e,{length:1,0:3},1),3!==e[1]})),v=m&&i.NATIVE_ARRAY_BUFFER_VIEWS&&s((function(){var e=new f(2);return e.set(1),e.set("2",1),0!==e[0]||2!==e[1]}));y("set",(function(e){h(this);var t=u(arguments.length>1?arguments[1]:void 0,1),n=c(e);if(m)return o(d,this,n,t);var r=this.length,i=a(n),s=0;if(i+t>r)throw l("Wrong length");for(;s<i;)this[t+s]=n[s++]}),!m||v)},30678:function(e,t,n){"use strict";var r=n(90260),o=n(66304),i=n(47293),a=n(50206),u=r.aTypedArray;(0,r.exportTypedArrayMethod)("slice",(function(e,t){for(var n=a(u(this),e,t),r=o(this),i=0,c=n.length,s=new r(c);c>i;)s[i]=n[i++];return s}),i((function(){new Int8Array(1).slice()})))},27462:function(e,t,n){"use strict";var r=n(90260),o=n(42092).some,i=r.aTypedArray;(0,r.exportTypedArrayMethod)("some",(function(e){return o(i(this),e,arguments.length>1?arguments[1]:void 0)}))},33824:function(e,t,n){"use strict";var r=n(17854),o=n(1702),i=n(47293),a=n(19662),u=n(94362),c=n(90260),s=n(68886),l=n(30256),f=n(7392),p=n(98008),d=c.aTypedArray,h=c.exportTypedArrayMethod,y=r.Uint16Array,m=y&&o(y.prototype.sort),v=!(!m||i((function(){m(new y(2),null)}))&&i((function(){m(new y(2),{})}))),b=!!m&&!i((function(){if(f)return f<74;if(s)return s<67;if(l)return!0;if(p)return p<602;var e,t,n=new y(516),r=Array(516);for(e=0;e<516;e++)t=e%4,n[e]=515-e,r[e]=e-2*t+3;for(m(n,(function(e,t){return(e/4|0)-(t/4|0)})),e=0;e<516;e++)if(n[e]!==r[e])return!0}));h("sort",(function(e){return void 0!==e&&a(e),b?m(this,e):u(d(this),function(e){return function(t,n){return void 0!==e?+e(t,n)||0:n!=n?-1:t!=t?1:0===t&&0===n?1/t>0&&1/n<0?1:-1:t>n}}(e))}),!b||v)},55021:function(e,t,n){"use strict";var r=n(90260),o=n(17466),i=n(51400),a=n(66304),u=r.aTypedArray;(0,r.exportTypedArrayMethod)("subarray",(function(e,t){var n=u(this),r=n.length,c=i(e,r);return new(a(n))(n.buffer,n.byteOffset+c*n.BYTES_PER_ELEMENT,o((void 0===t?r:i(t,r))-c))}))},12974:function(e,t,n){"use strict";var r=n(17854),o=n(22104),i=n(90260),a=n(47293),u=n(50206),c=r.Int8Array,s=i.aTypedArray,l=i.exportTypedArrayMethod,f=[].toLocaleString,p=!!c&&a((function(){f.call(new c(1))}));l("toLocaleString",(function(){return o(f,p?u(s(this)):s(this),u(arguments))}),a((function(){return[1,2].toLocaleString()!=new c([1,2]).toLocaleString()}))||!a((function(){c.prototype.toLocaleString.call([1,2])})))},15016:function(e,t,n){"use strict";var r=n(90260).exportTypedArrayMethod,o=n(47293),i=n(17854),a=n(1702),u=i.Uint8Array,c=u&&u.prototype||{},s=[].toString,l=a([].join);o((function(){s.call({})}))&&(s=function(){return l(this)});var f=c.toString!=s;r("toString",s,f)},29135:function(e,t,n){n(19843)("Uint32",(function(e){return function(t,n,r){return e(this,t,n,r)}}))},82472:function(e,t,n){n(19843)("Uint8",(function(e){return function(t,n,r){return e(this,t,n,r)}}))},49743:function(e,t,n){n(19843)("Uint8",(function(e){return function(t,n,r){return e(this,t,n,r)}}),!0)},66342:function(e,t,n){"use strict";var r=n(82109),o=n(25787),i=n(68880),a=n(92597),u=n(5112),c=n(66462),s=n(31913),l=u("toStringTag"),f=function(){o(this,c)};f.prototype=c,a(c,l)||i(c,l,"AsyncIterator"),!s&&a(c,"constructor")&&c.constructor!==Object||i(c,"constructor",f),r({global:!0,constructor:!0,forced:s},{AsyncIterator:f})},68216:function(e,t,n){"use strict";var r=n(82109),o=n(12269).every;r({target:"AsyncIterator",proto:!0,real:!0,forced:!0},{every:function(e){return o(this,e)}})},88449:function(e,t,n){"use strict";var r=n(82109),o=n(22104),i=n(19662),a=n(19670),u=n(45348)((function(e,t){var n=this,r=n.filterer;return new e((function(i,u){var c=function(){try{e.resolve(a(o(n.next,n.iterator,t))).then((function(t){try{if(a(t).done)n.done=!0,i({done:!0,value:void 0});else{var o=t.value;e.resolve(r(o)).then((function(e){e?i({done:!1,value:o}):c()}),u)}}catch(e){u(e)}}),u)}catch(e){u(e)}};c()}))}));r({target:"AsyncIterator",proto:!0,real:!0,forced:!0},{filter:function(e){return new u({iterator:a(this),filterer:i(e)})}})},31672:function(e,t,n){"use strict";var r=n(82109),o=n(12269).find;r({target:"AsyncIterator",proto:!0,real:!0,forced:!0},{find:function(e){return o(this,e)}})},15581:function(e,t,n){"use strict";var r=n(82109),o=n(12269).forEach;r({target:"AsyncIterator",proto:!0,real:!0,forced:!0},{forEach:function(e){return o(this,e)}})},57640:function(e,t,n){"use strict";var r=n(82109),o=n(22104),i=n(19662),a=n(19670),u=n(45348)((function(e,t){var n=this,r=n.mapper;return e.resolve(a(o(n.next,n.iterator,t))).then((function(t){return a(t).done?(n.done=!0,{done:!0,value:void 0}):e.resolve(r(t.value)).then((function(e){return{done:!1,value:e}}))}))}));r({target:"AsyncIterator",proto:!0,real:!0,forced:!0},{map:function(e){return new u({iterator:a(this),mapper:i(e)})}})},25387:function(e,t,n){"use strict";var r=n(82109),o=n(17854),i=n(46916),a=n(19662),u=n(19670),c=n(35005)("Promise"),s=o.TypeError;r({target:"AsyncIterator",proto:!0,real:!0,forced:!0},{reduce:function(e){var t=u(this),n=a(t.next),r=arguments.length<2,o=r?void 0:arguments[1];return a(e),new c((function(a,l){var f=function(){try{c.resolve(u(i(n,t))).then((function(t){try{if(u(t).done)r?l(s("Reduce of empty iterator with no initial value")):a(o);else{var n=t.value;r?(r=!1,o=n,f()):c.resolve(e(o,n)).then((function(e){o=e,f()}),l)}}catch(e){l(e)}}),l)}catch(e){l(e)}};f()}))}})},64211:function(e,t,n){"use strict";var r=n(82109),o=n(12269).some;r({target:"AsyncIterator",proto:!0,real:!0,forced:!0},{some:function(e){return o(this,e)}})},62962:function(e,t,n){"use strict";var r=n(82109),o=n(12269).toArray;r({target:"AsyncIterator",proto:!0,real:!0,forced:!0},{toArray:function(){return o(this,void 0,[])}})},2490:function(e,t,n){"use strict";var r=n(82109),o=n(17854),i=n(25787),a=n(60614),u=n(68880),c=n(47293),s=n(92597),l=n(5112),f=n(13383).IteratorPrototype,p=n(31913),d=l("toStringTag"),h=o.Iterator,y=p||!a(h)||h.prototype!==f||!c((function(){h({})})),m=function(){i(this,f)};s(f,d)||u(f,d,"Iterator"),!y&&s(f,"constructor")&&f.constructor!==Object||u(f,"constructor",m),m.prototype=f,r({global:!0,constructor:!0,forced:y},{Iterator:m})},79433:function(e,t,n){"use strict";var r=n(82109),o=n(20408),i=n(19662),a=n(19670);r({target:"Iterator",proto:!0,real:!0,forced:!0},{every:function(e){return a(this),i(e),!o(this,(function(t,n){if(!e(t))return n()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}})},59849:function(e,t,n){"use strict";var r=n(82109),o=n(22104),i=n(19662),a=n(19670),u=n(54956),c=n(53411),s=u((function(e){for(var t,n,r=this.iterator,i=this.filterer,u=this.next;;){if(t=a(o(u,r,e)),this.done=!!t.done)return;if(n=t.value,c(r,i,n))return n}}));r({target:"Iterator",proto:!0,real:!0,forced:!0},{filter:function(e){return new s({iterator:a(this),filterer:i(e)})}})},59461:function(e,t,n){"use strict";var r=n(82109),o=n(20408),i=n(19662),a=n(19670);r({target:"Iterator",proto:!0,real:!0,forced:!0},{find:function(e){return a(this),i(e),o(this,(function(t,n){if(e(t))return n(t)}),{IS_ITERATOR:!0,INTERRUPTED:!0}).result}})},34514:function(e,t,n){"use strict";var r=n(82109),o=n(20408),i=n(19670);r({target:"Iterator",proto:!0,real:!0,forced:!0},{forEach:function(e){o(i(this),e,{IS_ITERATOR:!0})}})},9924:function(e,t,n){"use strict";var r=n(82109),o=n(22104),i=n(19662),a=n(19670),u=n(54956),c=n(53411),s=u((function(e){var t=this.iterator,n=a(o(this.next,t,e));if(!(this.done=!!n.done))return c(t,this.mapper,n.value)}));r({target:"Iterator",proto:!0,real:!0,forced:!0},{map:function(e){return new s({iterator:a(this),mapper:i(e)})}})},72608:function(e,t,n){"use strict";var r=n(82109),o=n(17854),i=n(20408),a=n(19662),u=n(19670),c=o.TypeError;r({target:"Iterator",proto:!0,real:!0,forced:!0},{reduce:function(e){u(this),a(e);var t=arguments.length<2,n=t?void 0:arguments[1];if(i(this,(function(r){t?(t=!1,n=r):n=e(n,r)}),{IS_ITERATOR:!0}),t)throw c("Reduce of empty iterator with no initial value");return n}})},41874:function(e,t,n){"use strict";var r=n(82109),o=n(20408),i=n(19662),a=n(19670);r({target:"Iterator",proto:!0,real:!0,forced:!0},{some:function(e){return a(this),i(e),o(this,(function(t,n){if(e(t))return n()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}})},23748:function(e,t,n){"use strict";var r=n(82109),o=n(20408),i=n(19670),a=[].push;r({target:"Iterator",proto:!0,real:!0,forced:!0},{toArray:function(){var e=[];return o(i(this),a,{that:e,IS_ITERATOR:!0}),e}})},10072:function(e,t,n){"use strict";n(82109)({target:"Map",proto:!0,real:!0,forced:!0},{deleteAll:n(34092)})},23042:function(e,t,n){"use strict";n(82109)({target:"Map",proto:!0,real:!0,forced:!0},{emplace:n(37502)})},99137:function(e,t,n){"use strict";var r=n(82109),o=n(19670),i=n(49974),a=n(54647),u=n(20408);r({target:"Map",proto:!0,real:!0,forced:!0},{every:function(e){var t=o(this),n=a(t),r=i(e,arguments.length>1?arguments[1]:void 0);return!u(n,(function(e,n,o){if(!r(n,e,t))return o()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}})},71957:function(e,t,n){"use strict";var r=n(82109),o=n(35005),i=n(49974),a=n(46916),u=n(19662),c=n(19670),s=n(36707),l=n(54647),f=n(20408);r({target:"Map",proto:!0,real:!0,forced:!0},{filter:function(e){var t=c(this),n=l(t),r=i(e,arguments.length>1?arguments[1]:void 0),p=new(s(t,o("Map"))),d=u(p.set);return f(n,(function(e,n){r(n,e,t)&&a(d,p,e,n)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),p}})},103:function(e,t,n){"use strict";var r=n(82109),o=n(19670),i=n(49974),a=n(54647),u=n(20408);r({target:"Map",proto:!0,real:!0,forced:!0},{findKey:function(e){var t=o(this),n=a(t),r=i(e,arguments.length>1?arguments[1]:void 0);return u(n,(function(e,n,o){if(r(n,e,t))return o(e)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}})},96306:function(e,t,n){"use strict";var r=n(82109),o=n(19670),i=n(49974),a=n(54647),u=n(20408);r({target:"Map",proto:!0,real:!0,forced:!0},{find:function(e){var t=o(this),n=a(t),r=i(e,arguments.length>1?arguments[1]:void 0);return u(n,(function(e,n,o){if(r(n,e,t))return o(n)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}})},74592:function(e,t,n){"use strict";var r=n(82109),o=n(19670),i=n(54647),a=n(46465),u=n(20408);r({target:"Map",proto:!0,real:!0,forced:!0},{includes:function(e){return u(i(o(this)),(function(t,n,r){if(a(n,e))return r()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}})},58276:function(e,t,n){"use strict";var r=n(82109),o=n(19670),i=n(54647),a=n(20408);r({target:"Map",proto:!0,real:!0,forced:!0},{keyOf:function(e){return a(i(o(this)),(function(t,n,r){if(n===e)return r(t)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}})},35082:function(e,t,n){"use strict";var r=n(82109),o=n(35005),i=n(49974),a=n(46916),u=n(19662),c=n(19670),s=n(36707),l=n(54647),f=n(20408);r({target:"Map",proto:!0,real:!0,forced:!0},{mapKeys:function(e){var t=c(this),n=l(t),r=i(e,arguments.length>1?arguments[1]:void 0),p=new(s(t,o("Map"))),d=u(p.set);return f(n,(function(e,n){a(d,p,r(n,e,t),n)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),p}})},12813:function(e,t,n){"use strict";var r=n(82109),o=n(35005),i=n(49974),a=n(46916),u=n(19662),c=n(19670),s=n(36707),l=n(54647),f=n(20408);r({target:"Map",proto:!0,real:!0,forced:!0},{mapValues:function(e){var t=c(this),n=l(t),r=i(e,arguments.length>1?arguments[1]:void 0),p=new(s(t,o("Map"))),d=u(p.set);return f(n,(function(e,n){a(d,p,e,r(n,e,t))}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),p}})},18222:function(e,t,n){"use strict";var r=n(82109),o=n(19662),i=n(19670),a=n(20408);r({target:"Map",proto:!0,real:!0,arity:1,forced:!0},{merge:function(e){for(var t=i(this),n=o(t.set),r=arguments.length,u=0;u<r;)a(arguments[u++],n,{that:t,AS_ENTRIES:!0});return t}})},38563:function(e,t,n){"use strict";var r=n(82109),o=n(17854),i=n(19670),a=n(19662),u=n(54647),c=n(20408),s=o.TypeError;r({target:"Map",proto:!0,real:!0,forced:!0},{reduce:function(e){var t=i(this),n=u(t),r=arguments.length<2,o=r?void 0:arguments[1];if(a(e),c(n,(function(n,i){r?(r=!1,o=i):o=e(o,i,n,t)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),r)throw s("Reduce of empty map with no initial value");return o}})},50336:function(e,t,n){"use strict";var r=n(82109),o=n(19670),i=n(49974),a=n(54647),u=n(20408);r({target:"Map",proto:!0,real:!0,forced:!0},{some:function(e){var t=o(this),n=a(t),r=i(e,arguments.length>1?arguments[1]:void 0);return u(n,(function(e,n,o){if(r(n,e,t))return o()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}})},7512:function(e,t,n){"use strict";var r=n(82109),o=n(17854),i=n(46916),a=n(19670),u=n(19662),c=o.TypeError;r({target:"Map",proto:!0,real:!0,forced:!0},{update:function(e,t){var n=a(this),r=u(n.get),o=u(n.has),s=u(n.set),l=arguments.length;u(t);var f=i(o,n,e);if(!f&&l<3)throw c("Updating absent value");var p=f?i(r,n,e):u(l>2?arguments[2]:void 0)(e,n);return i(s,n,e,t(p,e,n)),n}})},8922:function(e,t,n){"use strict";var r=n(90260),o=n(42092).filterReject,i=n(43074),a=r.aTypedArray;(0,r.exportTypedArrayMethod)("filterReject",(function(e){var t=o(a(this),e,arguments.length>1?arguments[1]:void 0);return i(this,t)}),!0)},1118:function(e,t,n){"use strict";var r=n(90260),o=n(9671).findLastIndex,i=r.aTypedArray;(0,r.exportTypedArrayMethod)("findLastIndex",(function(e){return o(i(this),e,arguments.length>1?arguments[1]:void 0)}))},37380:function(e,t,n){"use strict";var r=n(90260),o=n(9671).findLast,i=r.aTypedArray;(0,r.exportTypedArrayMethod)("findLast",(function(e){return o(i(this),e,arguments.length>1?arguments[1]:void 0)}))},5835:function(e,t,n){"use strict";var r=n(90260),o=n(61386),i=n(66304),a=r.aTypedArray;(0,r.exportTypedArrayMethod)("groupBy",(function(e){var t=arguments.length>1?arguments[1]:void 0;return o(a(this),e,t,i)}),!0)},23767:function(e,t,n){"use strict";var r=n(21843),o=n(90260),i=o.aTypedArray,a=o.exportTypedArrayMethod,u=o.TYPED_ARRAY_CONSTRUCTOR;a("toReversed",(function(){return r(i(this),this[u])}))},8585:function(e,t,n){"use strict";var r=n(90260),o=n(1702),i=n(19662),a=n(97745),u=r.aTypedArray,c=r.exportTypedArrayMethod,s=r.TYPED_ARRAY_CONSTRUCTOR,l=o(r.TypedArrayPrototype.sort);c("toSorted",(function(e){void 0!==e&&i(e);var t=u(this),n=a(t[s],t);return l(n,e)}))},8970:function(e,t,n){"use strict";var r=n(90260),o=n(50206),i=n(1654),a=r.aTypedArray,u=r.exportTypedArrayMethod,c=r.TYPED_ARRAY_CONSTRUCTOR;u("toSpliced",(function(e,t){return i(a(this),this[c],o(arguments))}),{arity:2})},84444:function(e,t,n){"use strict";var r=n(1702),o=n(90260),i=n(60956),a=n(43074),u=o.aTypedArray,c=o.exportTypedArrayMethod,s=r(i);c("uniqueBy",(function(e){return a(this,s(u(this),e))}),!0)},68696:function(e,t,n){"use strict";var r=n(11572),o=n(90260),i=o.aTypedArray,a=o.exportTypedArrayMethod,u=o.TYPED_ARRAY_CONSTRUCTOR;a("with",{with:function(e,t){return r(i(this),this[u],e,t)}}.with)},75505:function(e,t,n){var r=n(82109),o=n(35005),i=n(1702),a=n(47293),u=n(41340),c=n(92597),s=n(48053),l=n(14170).ctoi,f=/[^\d+/a-z]/i,p=/[\t\n\f\r ]+/g,d=/[=]+$/,h=o("atob"),y=String.fromCharCode,m=i("".charAt),v=i("".replace),b=i(f.exec),g=a((function(){return""!==h(" ")})),w=!a((function(){h("a")})),_=!g&&!w&&!a((function(){h()})),O=!g&&!w&&1!==h.length;r({global:!0,enumerable:!0,forced:g||w||_||O},{atob:function(e){if(s(arguments.length,1),_||O)return h(e);var t,n,r=v(u(e),p,""),i="",a=0,g=0;if(r.length%4==0&&(r=v(r,d,"")),r.length%4==1||b(f,r))throw new(o("DOMException"))("The string is not correctly encoded","InvalidCharacterError");for(;t=m(r,a++);)c(l,t)&&(n=g%4?64*n+l[t]:l[t],g++%4&&(i+=y(255&n>>(-2*g&6))));return i}})},27479:function(e,t,n){var r=n(82109),o=n(35005),i=n(1702),a=n(47293),u=n(41340),c=n(48053),s=n(14170).itoc,l=o("btoa"),f=i("".charAt),p=i("".charCodeAt),d=!!l&&!a((function(){l()})),h=!!l&&a((function(){return"bnVsbA=="!==l(null)})),y=!!l&&1!==l.length;r({global:!0,enumerable:!0,forced:d||h||y},{btoa:function(e){if(c(arguments.length,1),d||h||y)return l(u(e));for(var t,n,r=u(e),i="",a=0,m=s;f(r,a)||(m="=",a%1);){if((n=p(r,a+=3/4))>255)throw new(o("DOMException"))("The string contains characters outside of the Latin1 range","InvalidCharacterError");i+=f(m,63&(t=t<<8|n)>>8-a%1*8)}return i}})},54747:function(e,t,n){var r=n(17854),o=n(48324),i=n(98509),a=n(18533),u=n(68880),c=function(e){if(e&&e.forEach!==a)try{u(e,"forEach",a)}catch(t){e.forEach=a}};for(var s in o)o[s]&&c(r[s]&&r[s].prototype);c(i)},33948:function(e,t,n){var r=n(17854),o=n(48324),i=n(98509),a=n(66992),u=n(68880),c=n(5112),s=c("iterator"),l=c("toStringTag"),f=a.values,p=function(e,t){if(e){if(e[s]!==f)try{u(e,s,f)}catch(t){e[s]=f}if(e[l]||u(e,l,t),o[t])for(var n in a)if(e[n]!==a[n])try{u(e,n,a[n])}catch(t){e[n]=a[n]}}};for(var d in o)p(r[d]&&r[d].prototype,d);p(i,"DOMTokenList")},87714:function(e,t,n){"use strict";var r=n(82109),o=n(44038),i=n(35005),a=n(47293),u=n(70030),c=n(79114),s=n(3070).f,l=n(98052),f=n(47045),p=n(92597),d=n(25787),h=n(19670),y=n(7762),m=n(56277),v=n(93678),b=n(77741),g=n(29909),w=n(19781),_=n(31913),O="DOMException",T=i("Error"),R=i(O)||function(){try{(new(i("MessageChannel")||o("worker_threads").MessageChannel)).port1.postMessage(new WeakMap)}catch(e){if("DATA_CLONE_ERR"==e.name&&25==e.code)return e.constructor}}(),S=R&&R.prototype,E=T.prototype,P=g.set,x=g.getterFor(O),j="stack"in T(O),C=function(e){return p(v,e)&&v[e].m?v[e].c:0},k=function(){d(this,M);var e=arguments.length,t=m(e<1?void 0:arguments[0]),n=m(e<2?void 0:arguments[1],"Error"),r=C(n);if(P(this,{type:O,name:n,message:t,code:r}),w||(this.name=n,this.message=t,this.code=r),j){var o=T(t);o.name=O,s(this,"stack",c(1,b(o.stack,1)))}},M=k.prototype=u(E),D=function(e){return{enumerable:!0,configurable:!0,get:e}},A=function(e){return D((function(){return x(this)[e]}))};w&&(f(M,"code",A("code")),f(M,"message",A("message")),f(M,"name",A("name"))),s(M,"constructor",c(1,k));var I=a((function(){return!(new R instanceof T)})),N=I||a((function(){return E.toString!==y||"2: 1"!==String(new R(1,2))})),V=I||a((function(){return 25!==new R(1,"DataCloneError").code})),U=I||25!==R.DATA_CLONE_ERR||25!==S.DATA_CLONE_ERR,F=_?N||V||U:I;r({global:!0,constructor:!0,forced:F},{DOMException:F?k:R});var B=i(O),L=B.prototype;for(var H in N&&(_||R===B)&&l(L,"toString",y),V&&w&&R===B&&f(L,"code",D((function(){return C(h(this).name)}))),v)if(p(v,H)){var z=v[H],q=z.s,G=c(6,z.c);p(B,q)||s(B,q,G),p(L,q)||s(L,q,G)}},82801:function(e,t,n){"use strict";var r=n(82109),o=n(35005),i=n(79114),a=n(3070).f,u=n(92597),c=n(25787),s=n(79587),l=n(56277),f=n(93678),p=n(77741),d=n(31913),h="DOMException",y=o("Error"),m=o(h),v=function(){c(this,b);var e=arguments.length,t=l(e<1?void 0:arguments[0]),n=l(e<2?void 0:arguments[1],"Error"),r=new m(t,n),o=y(t);return o.name=h,a(r,"stack",i(1,p(o.stack,1))),s(r,this,v),r},b=v.prototype=m.prototype,g="stack"in y(h),w="stack"in new m(1,2),_=g&&!w;r({global:!0,constructor:!0,forced:d||_},{DOMException:_?v:m});var O=o(h),T=O.prototype;if(T.constructor!==O)for(var R in d||a(T,"constructor",i(1,O)),f)if(u(f,R)){var S=f[R],E=S.s;u(O,E)||a(O,E,i(6,S.c))}},1174:function(e,t,n){var r=n(35005),o="DOMException";n(58003)(r(o),o)},65556:function(e,t,n){"use strict";n(66992);var r=n(82109),o=n(17854),i=n(46916),a=n(1702),u=n(19781),c=n(590),s=n(98052),l=n(89190),f=n(58003),p=n(24994),d=n(29909),h=n(25787),y=n(60614),m=n(92597),v=n(49974),b=n(70648),g=n(19670),w=n(70111),_=n(41340),O=n(70030),T=n(79114),R=n(18554),S=n(71246),E=n(48053),P=n(5112),x=n(94362),j=P("iterator"),C="URLSearchParams",k="URLSearchParamsIterator",M=d.set,D=d.getterFor(C),A=d.getterFor(k),I=Object.getOwnPropertyDescriptor,N=function(e){if(!u)return o[e];var t=I(o,e);return t&&t.value},V=N("fetch"),U=N("Request"),F=N("Headers"),B=U&&U.prototype,L=F&&F.prototype,H=o.RegExp,z=o.TypeError,q=o.decodeURIComponent,G=o.encodeURIComponent,W=a("".charAt),Q=a([].join),K=a([].push),Y=a("".replace),Z=a([].shift),X=a([].splice),J=a("".split),$=a("".slice),ee=/\+/g,te=Array(4),ne=function(e){return te[e-1]||(te[e-1]=H("((?:%[\\da-f]{2}){"+e+"})","gi"))},re=function(e){try{return q(e)}catch(t){return e}},oe=function(e){var t=Y(e,ee," "),n=4;try{return q(t)}catch(e){for(;n;)t=Y(t,ne(n--),re);return t}},ie=/[!'()~]|%20/g,ae={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},ue=function(e){return ae[e]},ce=function(e){return Y(G(e),ie,ue)},se=p((function(e,t){M(this,{type:k,iterator:R(D(e).entries),kind:t})}),"Iterator",(function(){var e=A(this),t=e.kind,n=e.iterator.next(),r=n.value;return n.done||(n.value="keys"===t?r.key:"values"===t?r.value:[r.key,r.value]),n}),!0),le=function(e){this.entries=[],this.url=null,void 0!==e&&(w(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===W(e,0)?$(e,1):e:_(e)))};le.prototype={type:C,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,n,r,o,a,u,c,s=S(e);if(s)for(n=(t=R(e,s)).next;!(r=i(n,t)).done;){if(a=(o=R(g(r.value))).next,(u=i(a,o)).done||(c=i(a,o)).done||!i(a,o).done)throw z("Expected sequence with length 2");K(this.entries,{key:_(u.value),value:_(c.value)})}else for(var l in e)m(e,l)&&K(this.entries,{key:l,value:_(e[l])})},parseQuery:function(e){if(e)for(var t,n,r=J(e,"&"),o=0;o<r.length;)(t=r[o++]).length&&(n=J(t,"="),K(this.entries,{key:oe(Z(n)),value:oe(Q(n,"="))}))},serialize:function(){for(var e,t=this.entries,n=[],r=0;r<t.length;)e=t[r++],K(n,ce(e.key)+"="+ce(e.value));return Q(n,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var fe=function(){h(this,pe);var e=arguments.length>0?arguments[0]:void 0;M(this,new le(e))},pe=fe.prototype;if(l(pe,{append:function(e,t){E(arguments.length,2);var n=D(this);K(n.entries,{key:_(e),value:_(t)}),n.updateURL()},delete:function(e){E(arguments.length,1);for(var t=D(this),n=t.entries,r=_(e),o=0;o<n.length;)n[o].key===r?X(n,o,1):o++;t.updateURL()},get:function(e){E(arguments.length,1);for(var t=D(this).entries,n=_(e),r=0;r<t.length;r++)if(t[r].key===n)return t[r].value;return null},getAll:function(e){E(arguments.length,1);for(var t=D(this).entries,n=_(e),r=[],o=0;o<t.length;o++)t[o].key===n&&K(r,t[o].value);return r},has:function(e){E(arguments.length,1);for(var t=D(this).entries,n=_(e),r=0;r<t.length;)if(t[r++].key===n)return!0;return!1},set:function(e,t){E(arguments.length,1);for(var n,r=D(this),o=r.entries,i=!1,a=_(e),u=_(t),c=0;c<o.length;c++)(n=o[c]).key===a&&(i?X(o,c--,1):(i=!0,n.value=u));i||K(o,{key:a,value:u}),r.updateURL()},sort:function(){var e=D(this);x(e.entries,(function(e,t){return e.key>t.key?1:-1})),e.updateURL()},forEach:function(e){for(var t,n=D(this).entries,r=v(e,arguments.length>1?arguments[1]:void 0),o=0;o<n.length;)r((t=n[o++]).value,t.key,this)},keys:function(){return new se(this,"keys")},values:function(){return new se(this,"values")},entries:function(){return new se(this,"entries")}},{enumerable:!0}),s(pe,j,pe.entries,{name:"entries"}),s(pe,"toString",(function(){return D(this).serialize()}),{enumerable:!0}),f(fe,C),r({global:!0,constructor:!0,forced:!c},{URLSearchParams:fe}),!c&&y(F)){var de=a(L.has),he=a(L.set),ye=function(e){if(w(e)){var t,n=e.body;if(b(n)===C)return t=e.headers?new F(e.headers):new F,de(t,"content-type")||he(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),O(e,{body:T(0,_(n)),headers:T(0,t)})}return e};if(y(V)&&r({global:!0,enumerable:!0,noTargetGet:!0,forced:!0},{fetch:function(e){return V(e,arguments.length>1?ye(arguments[1]):{})}}),y(U)){var me=function(e){return h(this,B),new U(e,arguments.length>1?ye(arguments[1]):{})};B.constructor=me,me.prototype=B,r({global:!0,constructor:!0,noTargetGet:!0,forced:!0},{Request:me})}}e.exports={URLSearchParams:fe,getState:D}},41637:function(e,t,n){n(65556)},68789:function(e,t,n){"use strict";n(78783);var r,o=n(82109),i=n(19781),a=n(590),u=n(17854),c=n(49974),s=n(1702),l=n(98052),f=n(47045),p=n(25787),d=n(92597),h=n(21574),y=n(48457),m=n(41589),v=n(28710).codeAt,b=n(33197),g=n(41340),w=n(58003),_=n(48053),O=n(65556),T=n(29909),R=T.set,S=T.getterFor("URL"),E=O.URLSearchParams,P=O.getState,x=u.URL,j=u.TypeError,C=u.parseInt,k=Math.floor,M=Math.pow,D=s("".charAt),A=s(/./.exec),I=s([].join),N=s(1..toString),V=s([].pop),U=s([].push),F=s("".replace),B=s([].shift),L=s("".split),H=s("".slice),z=s("".toLowerCase),q=s([].unshift),G="Invalid scheme",W="Invalid host",Q="Invalid port",K=/[a-z]/i,Y=/[\d+-.a-z]/i,Z=/\d/,X=/^0x/i,J=/^[0-7]+$/,$=/^\d+$/,ee=/^[\da-f]+$/i,te=/[\0\t\n\r #%/:<>?@[\\\]^|]/,ne=/[\0\t\n\r #/:<>?@[\\\]^|]/,re=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,oe=/[\t\n\r]/g,ie=function(e){var t,n,r,o;if("number"==typeof e){for(t=[],n=0;n<4;n++)q(t,e%256),e=k(e/256);return I(t,".")}if("object"==typeof e){for(t="",r=function(e){for(var t=null,n=1,r=null,o=0,i=0;i<8;i++)0!==e[i]?(o>n&&(t=r,n=o),r=null,o=0):(null===r&&(r=i),++o);return o>n&&(t=r,n=o),t}(e),n=0;n<8;n++)o&&0===e[n]||(o&&(o=!1),r===n?(t+=n?":":"::",o=!0):(t+=N(e[n],16),n<7&&(t+=":")));return"["+t+"]"}return e},ae={},ue=h({},ae,{" ":1,'"':1,"<":1,">":1,"`":1}),ce=h({},ue,{"#":1,"?":1,"{":1,"}":1}),se=h({},ce,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),le=function(e,t){var n=v(e,0);return n>32&&n<127&&!d(t,e)?e:encodeURIComponent(e)},fe={ftp:21,file:null,http:80,https:443,ws:80,wss:443},pe=function(e,t){var n;return 2==e.length&&A(K,D(e,0))&&(":"==(n=D(e,1))||!t&&"|"==n)},de=function(e){var t;return e.length>1&&pe(H(e,0,2))&&(2==e.length||"/"===(t=D(e,2))||"\\"===t||"?"===t||"#"===t)},he=function(e){return"."===e||"%2e"===z(e)},ye={},me={},ve={},be={},ge={},we={},_e={},Oe={},Te={},Re={},Se={},Ee={},Pe={},xe={},je={},Ce={},ke={},Me={},De={},Ae={},Ie={},Ne=function(e,t,n){var r,o,i,a=g(e);if(t){if(o=this.parse(a))throw j(o);this.searchParams=null}else{if(void 0!==n&&(r=new Ne(n,!0)),o=this.parse(a,null,r))throw j(o);(i=P(new E)).bindURL(this),this.searchParams=i}};Ne.prototype={type:"URL",parse:function(e,t,n){var o,i,a,u,c,s=this,l=t||ye,f=0,p="",h=!1,v=!1,b=!1;for(e=g(e),t||(s.scheme="",s.username="",s.password="",s.host=null,s.port=null,s.path=[],s.query=null,s.fragment=null,s.cannotBeABaseURL=!1,e=F(e,re,"")),e=F(e,oe,""),o=y(e);f<=o.length;){switch(i=o[f],l){case ye:if(!i||!A(K,i)){if(t)return G;l=ve;continue}p+=z(i),l=me;break;case me:if(i&&(A(Y,i)||"+"==i||"-"==i||"."==i))p+=z(i);else{if(":"!=i){if(t)return G;p="",l=ve,f=0;continue}if(t&&(s.isSpecial()!=d(fe,p)||"file"==p&&(s.includesCredentials()||null!==s.port)||"file"==s.scheme&&!s.host))return;if(s.scheme=p,t)return void(s.isSpecial()&&fe[s.scheme]==s.port&&(s.port=null));p="","file"==s.scheme?l=xe:s.isSpecial()&&n&&n.scheme==s.scheme?l=be:s.isSpecial()?l=Oe:"/"==o[f+1]?(l=ge,f++):(s.cannotBeABaseURL=!0,U(s.path,""),l=De)}break;case ve:if(!n||n.cannotBeABaseURL&&"#"!=i)return G;if(n.cannotBeABaseURL&&"#"==i){s.scheme=n.scheme,s.path=m(n.path),s.query=n.query,s.fragment="",s.cannotBeABaseURL=!0,l=Ie;break}l="file"==n.scheme?xe:we;continue;case be:if("/"!=i||"/"!=o[f+1]){l=we;continue}l=Te,f++;break;case ge:if("/"==i){l=Re;break}l=Me;continue;case we:if(s.scheme=n.scheme,i==r)s.username=n.username,s.password=n.password,s.host=n.host,s.port=n.port,s.path=m(n.path),s.query=n.query;else if("/"==i||"\\"==i&&s.isSpecial())l=_e;else if("?"==i)s.username=n.username,s.password=n.password,s.host=n.host,s.port=n.port,s.path=m(n.path),s.query="",l=Ae;else{if("#"!=i){s.username=n.username,s.password=n.password,s.host=n.host,s.port=n.port,s.path=m(n.path),s.path.length--,l=Me;continue}s.username=n.username,s.password=n.password,s.host=n.host,s.port=n.port,s.path=m(n.path),s.query=n.query,s.fragment="",l=Ie}break;case _e:if(!s.isSpecial()||"/"!=i&&"\\"!=i){if("/"!=i){s.username=n.username,s.password=n.password,s.host=n.host,s.port=n.port,l=Me;continue}l=Re}else l=Te;break;case Oe:if(l=Te,"/"!=i||"/"!=D(p,f+1))continue;f++;break;case Te:if("/"!=i&&"\\"!=i){l=Re;continue}break;case Re:if("@"==i){h&&(p="%40"+p),h=!0,a=y(p);for(var w=0;w<a.length;w++){var _=a[w];if(":"!=_||b){var O=le(_,se);b?s.password+=O:s.username+=O}else b=!0}p=""}else if(i==r||"/"==i||"?"==i||"#"==i||"\\"==i&&s.isSpecial()){if(h&&""==p)return"Invalid authority";f-=y(p).length+1,p="",l=Se}else p+=i;break;case Se:case Ee:if(t&&"file"==s.scheme){l=Ce;continue}if(":"!=i||v){if(i==r||"/"==i||"?"==i||"#"==i||"\\"==i&&s.isSpecial()){if(s.isSpecial()&&""==p)return W;if(t&&""==p&&(s.includesCredentials()||null!==s.port))return;if(u=s.parseHost(p))return u;if(p="",l=ke,t)return;continue}"["==i?v=!0:"]"==i&&(v=!1),p+=i}else{if(""==p)return W;if(u=s.parseHost(p))return u;if(p="",l=Pe,t==Ee)return}break;case Pe:if(!A(Z,i)){if(i==r||"/"==i||"?"==i||"#"==i||"\\"==i&&s.isSpecial()||t){if(""!=p){var T=C(p,10);if(T>65535)return Q;s.port=s.isSpecial()&&T===fe[s.scheme]?null:T,p=""}if(t)return;l=ke;continue}return Q}p+=i;break;case xe:if(s.scheme="file","/"==i||"\\"==i)l=je;else{if(!n||"file"!=n.scheme){l=Me;continue}if(i==r)s.host=n.host,s.path=m(n.path),s.query=n.query;else if("?"==i)s.host=n.host,s.path=m(n.path),s.query="",l=Ae;else{if("#"!=i){de(I(m(o,f),""))||(s.host=n.host,s.path=m(n.path),s.shortenPath()),l=Me;continue}s.host=n.host,s.path=m(n.path),s.query=n.query,s.fragment="",l=Ie}}break;case je:if("/"==i||"\\"==i){l=Ce;break}n&&"file"==n.scheme&&!de(I(m(o,f),""))&&(pe(n.path[0],!0)?U(s.path,n.path[0]):s.host=n.host),l=Me;continue;case Ce:if(i==r||"/"==i||"\\"==i||"?"==i||"#"==i){if(!t&&pe(p))l=Me;else if(""==p){if(s.host="",t)return;l=ke}else{if(u=s.parseHost(p))return u;if("localhost"==s.host&&(s.host=""),t)return;p="",l=ke}continue}p+=i;break;case ke:if(s.isSpecial()){if(l=Me,"/"!=i&&"\\"!=i)continue}else if(t||"?"!=i)if(t||"#"!=i){if(i!=r&&(l=Me,"/"!=i))continue}else s.fragment="",l=Ie;else s.query="",l=Ae;break;case Me:if(i==r||"/"==i||"\\"==i&&s.isSpecial()||!t&&("?"==i||"#"==i)){if(".."===(c=z(c=p))||"%2e."===c||".%2e"===c||"%2e%2e"===c?(s.shortenPath(),"/"==i||"\\"==i&&s.isSpecial()||U(s.path,"")):he(p)?"/"==i||"\\"==i&&s.isSpecial()||U(s.path,""):("file"==s.scheme&&!s.path.length&&pe(p)&&(s.host&&(s.host=""),p=D(p,0)+":"),U(s.path,p)),p="","file"==s.scheme&&(i==r||"?"==i||"#"==i))for(;s.path.length>1&&""===s.path[0];)B(s.path);"?"==i?(s.query="",l=Ae):"#"==i&&(s.fragment="",l=Ie)}else p+=le(i,ce);break;case De:"?"==i?(s.query="",l=Ae):"#"==i?(s.fragment="",l=Ie):i!=r&&(s.path[0]+=le(i,ae));break;case Ae:t||"#"!=i?i!=r&&("'"==i&&s.isSpecial()?s.query+="%27":s.query+="#"==i?"%23":le(i,ae)):(s.fragment="",l=Ie);break;case Ie:i!=r&&(s.fragment+=le(i,ue))}f++}},parseHost:function(e){var t,n,r;if("["==D(e,0)){if("]"!=D(e,e.length-1))return W;if(t=function(e){var t,n,r,o,i,a,u,c=[0,0,0,0,0,0,0,0],s=0,l=null,f=0,p=function(){return D(e,f)};if(":"==p()){if(":"!=D(e,1))return;f+=2,l=++s}for(;p();){if(8==s)return;if(":"!=p()){for(t=n=0;n<4&&A(ee,p());)t=16*t+C(p(),16),f++,n++;if("."==p()){if(0==n)return;if(f-=n,s>6)return;for(r=0;p();){if(o=null,r>0){if(!("."==p()&&r<4))return;f++}if(!A(Z,p()))return;for(;A(Z,p());){if(i=C(p(),10),null===o)o=i;else{if(0==o)return;o=10*o+i}if(o>255)return;f++}c[s]=256*c[s]+o,2!=++r&&4!=r||s++}if(4!=r)return;break}if(":"==p()){if(f++,!p())return}else if(p())return;c[s++]=t}else{if(null!==l)return;f++,l=++s}}if(null!==l)for(a=s-l,s=7;0!=s&&a>0;)u=c[s],c[s--]=c[l+a-1],c[l+--a]=u;else if(8!=s)return;return c}(H(e,1,-1)),!t)return W;this.host=t}else if(this.isSpecial()){if(e=b(e),A(te,e))return W;if(t=function(e){var t,n,r,o,i,a,u,c=L(e,".");if(c.length&&""==c[c.length-1]&&c.length--,(t=c.length)>4)return e;for(n=[],r=0;r<t;r++){if(""==(o=c[r]))return e;if(i=10,o.length>1&&"0"==D(o,0)&&(i=A(X,o)?16:8,o=H(o,8==i?1:2)),""===o)a=0;else{if(!A(10==i?$:8==i?J:ee,o))return e;a=C(o,i)}U(n,a)}for(r=0;r<t;r++)if(a=n[r],r==t-1){if(a>=M(256,5-t))return null}else if(a>255)return null;for(u=V(n),r=0;r<n.length;r++)u+=n[r]*M(256,3-r);return u}(e),null===t)return W;this.host=t}else{if(A(ne,e))return W;for(t="",n=y(e),r=0;r<n.length;r++)t+=le(n[r],ae);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"==this.scheme},includesCredentials:function(){return""!=this.username||""!=this.password},isSpecial:function(){return d(fe,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||"file"==this.scheme&&1==t&&pe(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,n=e.username,r=e.password,o=e.host,i=e.port,a=e.path,u=e.query,c=e.fragment,s=t+":";return null!==o?(s+="//",e.includesCredentials()&&(s+=n+(r?":"+r:"")+"@"),s+=ie(o),null!==i&&(s+=":"+i)):"file"==t&&(s+="//"),s+=e.cannotBeABaseURL?a[0]:a.length?"/"+I(a,"/"):"",null!==u&&(s+="?"+u),null!==c&&(s+="#"+c),s},setHref:function(e){var t=this.parse(e);if(t)throw j(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if("blob"==e)try{return new Ve(e.path[0]).origin}catch(e){return"null"}return"file"!=e&&this.isSpecial()?e+"://"+ie(this.host)+(null!==t?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(g(e)+":",ye)},getUsername:function(){return this.username},setUsername:function(e){var t=y(g(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var n=0;n<t.length;n++)this.username+=le(t[n],se)}},getPassword:function(){return this.password},setPassword:function(e){var t=y(g(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var n=0;n<t.length;n++)this.password+=le(t[n],se)}},getHost:function(){var e=this.host,t=this.port;return null===e?"":null===t?ie(e):ie(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,Se)},getHostname:function(){var e=this.host;return null===e?"":ie(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,Ee)},getPort:function(){var e=this.port;return null===e?"":g(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(""==(e=g(e))?this.port=null:this.parse(e,Pe))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+I(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,ke))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){""==(e=g(e))?this.query=null:("?"==D(e,0)&&(e=H(e,1)),this.query="",this.parse(e,Ae)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){""!=(e=g(e))?("#"==D(e,0)&&(e=H(e,1)),this.fragment="",this.parse(e,Ie)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var Ve=function(e){var t=p(this,Ue),n=_(arguments.length,1)>1?arguments[1]:void 0,r=R(t,new Ne(e,!1,n));i||(t.href=r.serialize(),t.origin=r.getOrigin(),t.protocol=r.getProtocol(),t.username=r.getUsername(),t.password=r.getPassword(),t.host=r.getHost(),t.hostname=r.getHostname(),t.port=r.getPort(),t.pathname=r.getPathname(),t.search=r.getSearch(),t.searchParams=r.getSearchParams(),t.hash=r.getHash())},Ue=Ve.prototype,Fe=function(e,t){return{get:function(){return S(this)[e]()},set:t&&function(e){return S(this)[t](e)},configurable:!0,enumerable:!0}};if(i&&(f(Ue,"href",Fe("serialize","setHref")),f(Ue,"origin",Fe("getOrigin")),f(Ue,"protocol",Fe("getProtocol","setProtocol")),f(Ue,"username",Fe("getUsername","setUsername")),f(Ue,"password",Fe("getPassword","setPassword")),f(Ue,"host",Fe("getHost","setHost")),f(Ue,"hostname",Fe("getHostname","setHostname")),f(Ue,"port",Fe("getPort","setPort")),f(Ue,"pathname",Fe("getPathname","setPathname")),f(Ue,"search",Fe("getSearch","setSearch")),f(Ue,"searchParams",Fe("getSearchParams")),f(Ue,"hash",Fe("getHash","setHash"))),l(Ue,"toJSON",(function(){return S(this).serialize()}),{enumerable:!0}),l(Ue,"toString",(function(){return S(this).serialize()}),{enumerable:!0}),x){var Be=x.createObjectURL,Le=x.revokeObjectURL;Be&&l(Ve,"createObjectURL",c(Be,x)),Le&&l(Ve,"revokeObjectURL",c(Le,x))}w(Ve,"URL"),o({global:!0,constructor:!0,forced:!a,sham:!i},{URL:Ve})},60285:function(e,t,n){n(68789)},41766:function(e,t,n){var r;!function(){"use strict";var o=function(){this.init()};o.prototype={init:function(){var e=this||i;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function(e){var t=this||i;if(e=parseFloat(e),t.ctx||d(),void 0!==e&&e>=0&&e<=1){if(t._volume=e,t._muted)return t;t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e,i.ctx.currentTime);for(var n=0;n<t._howls.length;n++)if(!t._howls[n]._webAudio)for(var r=t._howls[n]._getSoundIds(),o=0;o<r.length;o++){var a=t._howls[n]._soundById(r[o]);a&&a._node&&(a._node.volume=a._volume*e)}return t}return t._volume},mute:function(e){var t=this||i;t.ctx||d(),t._muted=e,t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e?0:t._volume,i.ctx.currentTime);for(var n=0;n<t._howls.length;n++)if(!t._howls[n]._webAudio)for(var r=t._howls[n]._getSoundIds(),o=0;o<r.length;o++){var a=t._howls[n]._soundById(r[o]);a&&a._node&&(a._node.muted=!!e||a._muted)}return t},stop:function(){for(var e=this||i,t=0;t<e._howls.length;t++)e._howls[t].stop();return e},unload:function(){for(var e=this||i,t=e._howls.length-1;t>=0;t--)e._howls[t].unload();return e.usingWebAudio&&e.ctx&&void 0!==e.ctx.close&&(e.ctx.close(),e.ctx=null,d()),e},codecs:function(e){return(this||i)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||i;if(e.state=e.ctx&&e.ctx.state||"suspended",e._autoSuspend(),!e.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(e._canPlayEvent="canplay")}catch(t){e.noAudio=!0}else e.noAudio=!0;try{(new Audio).muted&&(e.noAudio=!0)}catch(e){}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||i,t=null;try{t="undefined"!=typeof Audio?new Audio:null}catch(t){return e}if(!t||"function"!=typeof t.canPlayType)return e;var n=t.canPlayType("audio/mpeg;").replace(/^no$/,""),r=e._navigator?e._navigator.userAgent:"",o=r.match(/OPR\/([0-6].)/g),a=o&&parseInt(o[0].split("/")[1],10)<33,u=-1!==r.indexOf("Safari")&&-1===r.indexOf("Chrome"),c=r.match(/Version\/(.*?) /),s=u&&c&&parseInt(c[1],10)<15;return e._codecs={mp3:!(a||!n&&!t.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!n,opus:!!t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(t.canPlayType('audio/wav; codecs="1"')||t.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!t.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!t.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(t.canPlayType("audio/x-m4b;")||t.canPlayType("audio/m4b;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/mp4;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!(s||!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!(s||!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!t.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(t.canPlayType("audio/x-flac;")||t.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_unlockAudio:function(){var e=this||i;if(!e._audioUnlocked&&e.ctx){e._audioUnlocked=!1,e.autoUnlock=!1,e._mobileUnloaded||44100===e.ctx.sampleRate||(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var t=function(n){for(;e._html5AudioPool.length<e.html5PoolSize;)try{var r=new Audio;r._unlocked=!0,e._releaseHtml5Audio(r)}catch(n){e.noAudio=!0;break}for(var o=0;o<e._howls.length;o++)if(!e._howls[o]._webAudio)for(var i=e._howls[o]._getSoundIds(),a=0;a<i.length;a++){var u=e._howls[o]._soundById(i[a]);u&&u._node&&!u._node._unlocked&&(u._node._unlocked=!0,u._node.load())}e._autoResume();var c=e.ctx.createBufferSource();c.buffer=e._scratchBuffer,c.connect(e.ctx.destination),void 0===c.start?c.noteOn(0):c.start(0),"function"==typeof e.ctx.resume&&e.ctx.resume(),c.onended=function(){c.disconnect(0),e._audioUnlocked=!0,document.removeEventListener("touchstart",t,!0),document.removeEventListener("touchend",t,!0),document.removeEventListener("click",t,!0),document.removeEventListener("keydown",t,!0);for(var n=0;n<e._howls.length;n++)e._howls[n]._emit("unlock")}};return document.addEventListener("touchstart",t,!0),document.addEventListener("touchend",t,!0),document.addEventListener("click",t,!0),document.addEventListener("keydown",t,!0),e}},_obtainHtml5Audio:function(){var e=this||i;if(e._html5AudioPool.length)return e._html5AudioPool.pop();var t=(new Audio).play();return t&&"undefined"!=typeof Promise&&(t instanceof Promise||"function"==typeof t.then)&&t.catch((function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")})),new Audio},_releaseHtml5Audio:function(e){var t=this||i;return e._unlocked&&t._html5AudioPool.push(e),t},_autoSuspend:function(){var e=this;if(e.autoSuspend&&e.ctx&&void 0!==e.ctx.suspend&&i.usingWebAudio){for(var t=0;t<e._howls.length;t++)if(e._howls[t]._webAudio)for(var n=0;n<e._howls[t]._sounds.length;n++)if(!e._howls[t]._sounds[n]._paused)return e;return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout((function(){if(e.autoSuspend){e._suspendTimer=null,e.state="suspending";var t=function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())};e.ctx.suspend().then(t,t)}}),3e4),e}},_autoResume:function(){var e=this;if(e.ctx&&void 0!==e.ctx.resume&&i.usingWebAudio)return"running"===e.state&&"interrupted"!==e.ctx.state&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state||"running"===e.state&&"interrupted"===e.ctx.state?(e.ctx.resume().then((function(){e.state="running";for(var t=0;t<e._howls.length;t++)e._howls[t]._emit("resume")})),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e}};var i=new o,a=function(e){e.src&&0!==e.src.length?this.init(e):console.error("An array of source files must be passed with any new Howl.")};a.prototype={init:function(e){var t=this;return i.ctx||d(),t._autoplay=e.autoplay||!1,t._format="string"!=typeof e.format?e.format:[e.format],t._html5=e.html5||!1,t._muted=e.mute||!1,t._loop=e.loop||!1,t._pool=e.pool||5,t._preload="boolean"!=typeof e.preload&&"metadata"!==e.preload||e.preload,t._rate=e.rate||1,t._sprite=e.sprite||{},t._src="string"!=typeof e.src?e.src:[e.src],t._volume=void 0!==e.volume?e.volume:1,t._xhr={method:e.xhr&&e.xhr.method?e.xhr.method:"GET",headers:e.xhr&&e.xhr.headers?e.xhr.headers:null,withCredentials:!(!e.xhr||!e.xhr.withCredentials)&&e.xhr.withCredentials},t._duration=0,t._state="unloaded",t._sounds=[],t._endTimers={},t._queue=[],t._playLock=!1,t._onend=e.onend?[{fn:e.onend}]:[],t._onfade=e.onfade?[{fn:e.onfade}]:[],t._onload=e.onload?[{fn:e.onload}]:[],t._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],t._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],t._onpause=e.onpause?[{fn:e.onpause}]:[],t._onplay=e.onplay?[{fn:e.onplay}]:[],t._onstop=e.onstop?[{fn:e.onstop}]:[],t._onmute=e.onmute?[{fn:e.onmute}]:[],t._onvolume=e.onvolume?[{fn:e.onvolume}]:[],t._onrate=e.onrate?[{fn:e.onrate}]:[],t._onseek=e.onseek?[{fn:e.onseek}]:[],t._onunlock=e.onunlock?[{fn:e.onunlock}]:[],t._onresume=[],t._webAudio=i.usingWebAudio&&!t._html5,void 0!==i.ctx&&i.ctx&&i.autoUnlock&&i._unlockAudio(),i._howls.push(t),t._autoplay&&t._queue.push({event:"play",action:function(){t.play()}}),t._preload&&"none"!==t._preload&&t.load(),t},load:function(){var e=this,t=null;if(i.noAudio)e._emit("loaderror",null,"No audio support.");else{"string"==typeof e._src&&(e._src=[e._src]);for(var n=0;n<e._src.length;n++){var r,o;if(e._format&&e._format[n])r=e._format[n];else{if("string"!=typeof(o=e._src[n])){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(r=/^data:audio\/([^;,]+);/i.exec(o))||(r=/\.([^.]+)$/.exec(o.split("?",1)[0])),r&&(r=r[1].toLowerCase())}if(r||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),r&&i.codecs(r)){t=e._src[n];break}}if(t)return e._src=t,e._state="loading","https:"===window.location.protocol&&"http:"===t.slice(0,5)&&(e._html5=!0,e._webAudio=!1),new u(e),e._webAudio&&s(e),e;e._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(e,t){var n=this,r=null;if("number"==typeof e)r=e,e=null;else{if("string"==typeof e&&"loaded"===n._state&&!n._sprite[e])return null;if(void 0===e&&(e="__default",!n._playLock)){for(var o=0,a=0;a<n._sounds.length;a++)n._sounds[a]._paused&&!n._sounds[a]._ended&&(o++,r=n._sounds[a]._id);1===o?e=null:r=null}}var u=r?n._soundById(r):n._inactiveSound();if(!u)return null;if(r&&!e&&(e=u._sprite||"__default"),"loaded"!==n._state){u._sprite=e,u._ended=!1;var c=u._id;return n._queue.push({event:"play",action:function(){n.play(c)}}),c}if(r&&!u._paused)return t||n._loadQueue("play"),u._id;n._webAudio&&i._autoResume();var s=Math.max(0,u._seek>0?u._seek:n._sprite[e][0]/1e3),l=Math.max(0,(n._sprite[e][0]+n._sprite[e][1])/1e3-s),f=1e3*l/Math.abs(u._rate),p=n._sprite[e][0]/1e3,d=(n._sprite[e][0]+n._sprite[e][1])/1e3;u._sprite=e,u._ended=!1;var h=function(){u._paused=!1,u._seek=s,u._start=p,u._stop=d,u._loop=!(!u._loop&&!n._sprite[e][2])};if(!(s>=d)){var y=u._node;if(n._webAudio){var m=function(){n._playLock=!1,h(),n._refreshBuffer(u);var e=u._muted||n._muted?0:u._volume;y.gain.setValueAtTime(e,i.ctx.currentTime),u._playStart=i.ctx.currentTime,void 0===y.bufferSource.start?u._loop?y.bufferSource.noteGrainOn(0,s,86400):y.bufferSource.noteGrainOn(0,s,l):u._loop?y.bufferSource.start(0,s,86400):y.bufferSource.start(0,s,l),f!==1/0&&(n._endTimers[u._id]=setTimeout(n._ended.bind(n,u),f)),t||setTimeout((function(){n._emit("play",u._id),n._loadQueue()}),0)};"running"===i.state&&"interrupted"!==i.ctx.state?m():(n._playLock=!0,n.once("resume",m),n._clearTimer(u._id))}else{var v=function(){y.currentTime=s,y.muted=u._muted||n._muted||i._muted||y.muted,y.volume=u._volume*i.volume(),y.playbackRate=u._rate;try{var r=y.play();if(r&&"undefined"!=typeof Promise&&(r instanceof Promise||"function"==typeof r.then)?(n._playLock=!0,h(),r.then((function(){n._playLock=!1,y._unlocked=!0,t?n._loadQueue():n._emit("play",u._id)})).catch((function(){n._playLock=!1,n._emit("playerror",u._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),u._ended=!0,u._paused=!0}))):t||(n._playLock=!1,h(),n._emit("play",u._id)),y.playbackRate=u._rate,y.paused)return void n._emit("playerror",u._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==e||u._loop?n._endTimers[u._id]=setTimeout(n._ended.bind(n,u),f):(n._endTimers[u._id]=function(){n._ended(u),y.removeEventListener("ended",n._endTimers[u._id],!1)},y.addEventListener("ended",n._endTimers[u._id],!1))}catch(e){n._emit("playerror",u._id,e)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===y.src&&(y.src=n._src,y.load());var b=window&&window.ejecta||!y.readyState&&i._navigator.isCocoonJS;if(y.readyState>=3||b)v();else{n._playLock=!0,n._state="loading";var g=function(){n._state="loaded",v(),y.removeEventListener(i._canPlayEvent,g,!1)};y.addEventListener(i._canPlayEvent,g,!1),n._clearTimer(u._id)}}return u._id}n._ended(u)},pause:function(e){var t=this;if("loaded"!==t._state||t._playLock)return t._queue.push({event:"pause",action:function(){t.pause(e)}}),t;for(var n=t._getSoundIds(e),r=0;r<n.length;r++){t._clearTimer(n[r]);var o=t._soundById(n[r]);if(o&&!o._paused&&(o._seek=t.seek(n[r]),o._rateSeek=0,o._paused=!0,t._stopFade(n[r]),o._node))if(t._webAudio){if(!o._node.bufferSource)continue;void 0===o._node.bufferSource.stop?o._node.bufferSource.noteOff(0):o._node.bufferSource.stop(0),t._cleanBuffer(o._node)}else isNaN(o._node.duration)&&o._node.duration!==1/0||o._node.pause();arguments[1]||t._emit("pause",o?o._id:null)}return t},stop:function(e,t){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"stop",action:function(){n.stop(e)}}),n;for(var r=n._getSoundIds(e),o=0;o<r.length;o++){n._clearTimer(r[o]);var i=n._soundById(r[o]);i&&(i._seek=i._start||0,i._rateSeek=0,i._paused=!0,i._ended=!0,n._stopFade(r[o]),i._node&&(n._webAudio?i._node.bufferSource&&(void 0===i._node.bufferSource.stop?i._node.bufferSource.noteOff(0):i._node.bufferSource.stop(0),n._cleanBuffer(i._node)):isNaN(i._node.duration)&&i._node.duration!==1/0||(i._node.currentTime=i._start||0,i._node.pause(),i._node.duration===1/0&&n._clearSound(i._node))),t||n._emit("stop",i._id))}return n},mute:function(e,t){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"mute",action:function(){n.mute(e,t)}}),n;if(void 0===t){if("boolean"!=typeof e)return n._muted;n._muted=e}for(var r=n._getSoundIds(t),o=0;o<r.length;o++){var a=n._soundById(r[o]);a&&(a._muted=e,a._interval&&n._stopFade(a._id),n._webAudio&&a._node?a._node.gain.setValueAtTime(e?0:a._volume,i.ctx.currentTime):a._node&&(a._node.muted=!!i._muted||e),n._emit("mute",a._id))}return n},volume:function(){var e,t,n,r=this,o=arguments;if(0===o.length)return r._volume;if(1===o.length||2===o.length&&void 0===o[1]){var a=r._getSoundIds(),u=a.indexOf(o[0]);u>=0?t=parseInt(o[0],10):e=parseFloat(o[0])}else o.length>=2&&(e=parseFloat(o[0]),t=parseInt(o[1],10));if(!(void 0!==e&&e>=0&&e<=1))return(n=t?r._soundById(t):r._sounds[0])?n._volume:0;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"volume",action:function(){r.volume.apply(r,o)}}),r;void 0===t&&(r._volume=e),t=r._getSoundIds(t);for(var c=0;c<t.length;c++)(n=r._soundById(t[c]))&&(n._volume=e,o[2]||r._stopFade(t[c]),r._webAudio&&n._node&&!n._muted?n._node.gain.setValueAtTime(e,i.ctx.currentTime):n._node&&!n._muted&&(n._node.volume=e*i.volume()),r._emit("volume",n._id));return r},fade:function(e,t,n,r){var o=this;if("loaded"!==o._state||o._playLock)return o._queue.push({event:"fade",action:function(){o.fade(e,t,n,r)}}),o;e=Math.min(Math.max(0,parseFloat(e)),1),t=Math.min(Math.max(0,parseFloat(t)),1),n=parseFloat(n),o.volume(e,r);for(var a=o._getSoundIds(r),u=0;u<a.length;u++){var c=o._soundById(a[u]);if(c){if(r||o._stopFade(a[u]),o._webAudio&&!c._muted){var s=i.ctx.currentTime,l=s+n/1e3;c._volume=e,c._node.gain.setValueAtTime(e,s),c._node.gain.linearRampToValueAtTime(t,l)}o._startFadeInterval(c,e,t,n,a[u],void 0===r)}}return o},_startFadeInterval:function(e,t,n,r,o,i){var a=this,u=t,c=n-t,s=Math.abs(c/.01),l=Math.max(4,s>0?r/s:r),f=Date.now();e._fadeTo=n,e._interval=setInterval((function(){var o=(Date.now()-f)/r;f=Date.now(),u+=c*o,u=Math.round(100*u)/100,u=c<0?Math.max(n,u):Math.min(n,u),a._webAudio?e._volume=u:a.volume(u,e._id,!0),i&&(a._volume=u),(n<t&&u<=n||n>t&&u>=n)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,a.volume(n,e._id),a._emit("fade",e._id))}),l)},_stopFade:function(e){var t=this,n=t._soundById(e);return n&&n._interval&&(t._webAudio&&n._node.gain.cancelScheduledValues(i.ctx.currentTime),clearInterval(n._interval),n._interval=null,t.volume(n._fadeTo,e),n._fadeTo=null,t._emit("fade",e)),t},loop:function(){var e,t,n,r=this,o=arguments;if(0===o.length)return r._loop;if(1===o.length){if("boolean"!=typeof o[0])return!!(n=r._soundById(parseInt(o[0],10)))&&n._loop;e=o[0],r._loop=e}else 2===o.length&&(e=o[0],t=parseInt(o[1],10));for(var i=r._getSoundIds(t),a=0;a<i.length;a++)(n=r._soundById(i[a]))&&(n._loop=e,r._webAudio&&n._node&&n._node.bufferSource&&(n._node.bufferSource.loop=e,e&&(n._node.bufferSource.loopStart=n._start||0,n._node.bufferSource.loopEnd=n._stop,r.playing(i[a])&&(r.pause(i[a],!0),r.play(i[a],!0)))));return r},rate:function(){var e,t,n,r=this,o=arguments;if(0===o.length)t=r._sounds[0]._id;else if(1===o.length){var a=r._getSoundIds(),u=a.indexOf(o[0]);u>=0?t=parseInt(o[0],10):e=parseFloat(o[0])}else 2===o.length&&(e=parseFloat(o[0]),t=parseInt(o[1],10));if("number"!=typeof e)return(n=r._soundById(t))?n._rate:r._rate;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"rate",action:function(){r.rate.apply(r,o)}}),r;void 0===t&&(r._rate=e),t=r._getSoundIds(t);for(var c=0;c<t.length;c++)if(n=r._soundById(t[c])){r.playing(t[c])&&(n._rateSeek=r.seek(t[c]),n._playStart=r._webAudio?i.ctx.currentTime:n._playStart),n._rate=e,r._webAudio&&n._node&&n._node.bufferSource?n._node.bufferSource.playbackRate.setValueAtTime(e,i.ctx.currentTime):n._node&&(n._node.playbackRate=e);var s=r.seek(t[c]),l=(r._sprite[n._sprite][0]+r._sprite[n._sprite][1])/1e3-s,f=1e3*l/Math.abs(n._rate);!r._endTimers[t[c]]&&n._paused||(r._clearTimer(t[c]),r._endTimers[t[c]]=setTimeout(r._ended.bind(r,n),f)),r._emit("rate",n._id)}return r},seek:function(){var e,t,n=this,r=arguments;if(0===r.length)n._sounds.length&&(t=n._sounds[0]._id);else if(1===r.length){var o=n._getSoundIds(),a=o.indexOf(r[0]);a>=0?t=parseInt(r[0],10):n._sounds.length&&(t=n._sounds[0]._id,e=parseFloat(r[0]))}else 2===r.length&&(e=parseFloat(r[0]),t=parseInt(r[1],10));if(void 0===t)return 0;if("number"==typeof e&&("loaded"!==n._state||n._playLock))return n._queue.push({event:"seek",action:function(){n.seek.apply(n,r)}}),n;var u=n._soundById(t);if(u){if(!("number"==typeof e&&e>=0)){if(n._webAudio){var c=n.playing(t)?i.ctx.currentTime-u._playStart:0,s=u._rateSeek?u._rateSeek-u._seek:0;return u._seek+(s+c*Math.abs(u._rate))}return u._node.currentTime}var l=n.playing(t);l&&n.pause(t,!0),u._seek=e,u._ended=!1,n._clearTimer(t),n._webAudio||!u._node||isNaN(u._node.duration)||(u._node.currentTime=e);var f=function(){l&&n.play(t,!0),n._emit("seek",t)};if(l&&!n._webAudio){var p=function(){n._playLock?setTimeout(p,0):f()};setTimeout(p,0)}else f()}return n},playing:function(e){var t=this;if("number"==typeof e){var n=t._soundById(e);return!!n&&!n._paused}for(var r=0;r<t._sounds.length;r++)if(!t._sounds[r]._paused)return!0;return!1},duration:function(e){var t=this,n=t._duration,r=t._soundById(e);return r&&(n=t._sprite[r._sprite][1]/1e3),n},state:function(){return this._state},unload:function(){for(var e=this,t=e._sounds,n=0;n<t.length;n++)t[n]._paused||e.stop(t[n]._id),e._webAudio||(e._clearSound(t[n]._node),t[n]._node.removeEventListener("error",t[n]._errorFn,!1),t[n]._node.removeEventListener(i._canPlayEvent,t[n]._loadFn,!1),t[n]._node.removeEventListener("ended",t[n]._endFn,!1),i._releaseHtml5Audio(t[n]._node)),delete t[n]._node,e._clearTimer(t[n]._id);var r=i._howls.indexOf(e);r>=0&&i._howls.splice(r,1);var o=!0;for(n=0;n<i._howls.length;n++)if(i._howls[n]._src===e._src||e._src.indexOf(i._howls[n]._src)>=0){o=!1;break}return c&&o&&delete c[e._src],i.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,t,n,r){var o=this["_on"+e];return"function"==typeof t&&o.push(r?{id:n,fn:t,once:r}:{id:n,fn:t}),this},off:function(e,t,n){var r=this,o=r["_on"+e],i=0;if("number"==typeof t&&(n=t,t=null),t||n)for(i=0;i<o.length;i++){var a=n===o[i].id;if(t===o[i].fn&&a||!t&&a){o.splice(i,1);break}}else if(e)r["_on"+e]=[];else{var u=Object.keys(r);for(i=0;i<u.length;i++)0===u[i].indexOf("_on")&&Array.isArray(r[u[i]])&&(r[u[i]]=[])}return r},once:function(e,t,n){return this.on(e,t,n,1),this},_emit:function(e,t,n){for(var r=this,o=r["_on"+e],i=o.length-1;i>=0;i--)o[i].id&&o[i].id!==t&&"load"!==e||(setTimeout(function(e){e.call(this,t,n)}.bind(r,o[i].fn),0),o[i].once&&r.off(e,o[i].fn,o[i].id));return r._loadQueue(e),r},_loadQueue:function(e){var t=this;if(t._queue.length>0){var n=t._queue[0];n.event===e&&(t._queue.shift(),t._loadQueue()),e||n.action()}return t},_ended:function(e){var t=this,n=e._sprite;if(!t._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(t._ended.bind(t,e),100),t;var r=!(!e._loop&&!t._sprite[n][2]);if(t._emit("end",e._id),!t._webAudio&&r&&t.stop(e._id,!0).play(e._id),t._webAudio&&r){t._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=i.ctx.currentTime;var o=1e3*(e._stop-e._start)/Math.abs(e._rate);t._endTimers[e._id]=setTimeout(t._ended.bind(t,e),o)}return t._webAudio&&!r&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,t._clearTimer(e._id),t._cleanBuffer(e._node),i._autoSuspend()),t._webAudio||r||t.stop(e._id,!0),t},_clearTimer:function(e){var t=this;if(t._endTimers[e]){if("function"!=typeof t._endTimers[e])clearTimeout(t._endTimers[e]);else{var n=t._soundById(e);n&&n._node&&n._node.removeEventListener("ended",t._endTimers[e],!1)}delete t._endTimers[e]}return t},_soundById:function(e){for(var t=this,n=0;n<t._sounds.length;n++)if(e===t._sounds[n]._id)return t._sounds[n];return null},_inactiveSound:function(){var e=this;e._drain();for(var t=0;t<e._sounds.length;t++)if(e._sounds[t]._ended)return e._sounds[t].reset();return new u(e)},_drain:function(){var e=this,t=e._pool,n=0,r=0;if(!(e._sounds.length<t)){for(r=0;r<e._sounds.length;r++)e._sounds[r]._ended&&n++;for(r=e._sounds.length-1;r>=0;r--){if(n<=t)return;e._sounds[r]._ended&&(e._webAudio&&e._sounds[r]._node&&e._sounds[r]._node.disconnect(0),e._sounds.splice(r,1),n--)}}},_getSoundIds:function(e){if(void 0===e){for(var t=[],n=0;n<this._sounds.length;n++)t.push(this._sounds[n]._id);return t}return[e]},_refreshBuffer:function(e){return e._node.bufferSource=i.ctx.createBufferSource(),e._node.bufferSource.buffer=c[this._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,i.ctx.currentTime),this},_cleanBuffer:function(e){var t=i._navigator&&i._navigator.vendor.indexOf("Apple")>=0;if(i._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),t))try{e.bufferSource.buffer=i._scratchBuffer}catch(e){}return e.bufferSource=null,this},_clearSound:function(e){/MSIE |Trident\//.test(i._navigator&&i._navigator.userAgent)||(e.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var u=function(e){this._parent=e,this.init()};u.prototype={init:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++i._counter,t._sounds.push(e),e.create(),e},create:function(){var e=this,t=e._parent,n=i._muted||e._muted||e._parent._muted?0:e._volume;return t._webAudio?(e._node=void 0===i.ctx.createGain?i.ctx.createGainNode():i.ctx.createGain(),e._node.gain.setValueAtTime(n,i.ctx.currentTime),e._node.paused=!0,e._node.connect(i.masterGain)):i.noAudio||(e._node=i._obtainHtml5Audio(),e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(i._canPlayEvent,e._loadFn,!1),e._endFn=e._endListener.bind(e),e._node.addEventListener("ended",e._endFn,!1),e._node.src=t._src,e._node.preload=!0===t._preload?"auto":t._preload,e._node.volume=n*i.volume(),e._node.load()),e},reset:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++i._counter,e},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function(){var e=this,t=e._parent;t._duration=Math.ceil(10*e._node.duration)/10,0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue()),e._node.removeEventListener(i._canPlayEvent,e._loadFn,!1)},_endListener:function(){var e=this,t=e._parent;t._duration===1/0&&(t._duration=Math.ceil(10*e._node.duration)/10,t._sprite.__default[1]===1/0&&(t._sprite.__default[1]=1e3*t._duration),t._ended(e)),e._node.removeEventListener("ended",e._endFn,!1)}};var c={},s=function(e){var t=e._src;if(c[t])return e._duration=c[t].duration,void p(e);if(/^data:[^;]+;base64,/.test(t)){for(var n=atob(t.split(",")[1]),r=new Uint8Array(n.length),o=0;o<n.length;++o)r[o]=n.charCodeAt(o);f(r.buffer,e)}else{var i=new XMLHttpRequest;i.open(e._xhr.method,t,!0),i.withCredentials=e._xhr.withCredentials,i.responseType="arraybuffer",e._xhr.headers&&Object.keys(e._xhr.headers).forEach((function(t){i.setRequestHeader(t,e._xhr.headers[t])})),i.onload=function(){var t=(i.status+"")[0];"0"===t||"2"===t||"3"===t?f(i.response,e):e._emit("loaderror",null,"Failed loading audio file with status: "+i.status+".")},i.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete c[t],e.load())},l(i)}},l=function(e){try{e.send()}catch(t){e.onerror()}},f=function(e,t){var n=function(){t._emit("loaderror",null,"Decoding audio data failed.")},r=function(e){e&&t._sounds.length>0?(c[t._src]=e,p(t,e)):n()};"undefined"!=typeof Promise&&1===i.ctx.decodeAudioData.length?i.ctx.decodeAudioData(e).then(r).catch(n):i.ctx.decodeAudioData(e,r,n)},p=function(e,t){t&&!e._duration&&(e._duration=t.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue())},d=function(){if(i.usingWebAudio){try{"undefined"!=typeof AudioContext?i.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?i.ctx=new webkitAudioContext:i.usingWebAudio=!1}catch(e){i.usingWebAudio=!1}i.ctx||(i.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(i._navigator&&i._navigator.platform),t=i._navigator&&i._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),n=t?parseInt(t[1],10):null;if(e&&n&&n<9){var r=/safari/.test(i._navigator&&i._navigator.userAgent.toLowerCase());i._navigator&&!r&&(i.usingWebAudio=!1)}i.usingWebAudio&&(i.masterGain=void 0===i.ctx.createGain?i.ctx.createGainNode():i.ctx.createGain(),i.masterGain.gain.setValueAtTime(i._muted?0:i._volume,i.ctx.currentTime),i.masterGain.connect(i.ctx.destination)),i._setup()}};void 0===(r=function(){return{Howler:i,Howl:a}}.apply(t,[]))||(e.exports=r),t.Howler=i,t.Howl=a,void 0!==n.g?(n.g.HowlerGlobal=o,n.g.Howler=i,n.g.Howl=a,n.g.Sound=u):"undefined"!=typeof window&&(window.HowlerGlobal=o,window.Howler=i,window.Howl=a,window.Sound=u)}(),function(){"use strict";var e;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var t=this;if(!t.ctx||!t.ctx.listener)return t;for(var n=t._howls.length-1;n>=0;n--)t._howls[n].stereo(e);return t},HowlerGlobal.prototype.pos=function(e,t,n){var r=this;return r.ctx&&r.ctx.listener?(t="number"!=typeof t?r._pos[1]:t,n="number"!=typeof n?r._pos[2]:n,"number"!=typeof e?r._pos:(r._pos=[e,t,n],void 0!==r.ctx.listener.positionX?(r.ctx.listener.positionX.setTargetAtTime(r._pos[0],Howler.ctx.currentTime,.1),r.ctx.listener.positionY.setTargetAtTime(r._pos[1],Howler.ctx.currentTime,.1),r.ctx.listener.positionZ.setTargetAtTime(r._pos[2],Howler.ctx.currentTime,.1)):r.ctx.listener.setPosition(r._pos[0],r._pos[1],r._pos[2]),r)):r},HowlerGlobal.prototype.orientation=function(e,t,n,r,o,i){var a=this;if(!a.ctx||!a.ctx.listener)return a;var u=a._orientation;return t="number"!=typeof t?u[1]:t,n="number"!=typeof n?u[2]:n,r="number"!=typeof r?u[3]:r,o="number"!=typeof o?u[4]:o,i="number"!=typeof i?u[5]:i,"number"!=typeof e?u:(a._orientation=[e,t,n,r,o,i],void 0!==a.ctx.listener.forwardX?(a.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),a.ctx.listener.forwardY.setTargetAtTime(t,Howler.ctx.currentTime,.1),a.ctx.listener.forwardZ.setTargetAtTime(n,Howler.ctx.currentTime,.1),a.ctx.listener.upX.setTargetAtTime(r,Howler.ctx.currentTime,.1),a.ctx.listener.upY.setTargetAtTime(o,Howler.ctx.currentTime,.1),a.ctx.listener.upZ.setTargetAtTime(i,Howler.ctx.currentTime,.1)):a.ctx.listener.setOrientation(e,t,n,r,o,i),a)},Howl.prototype.init=(e=Howl.prototype.init,function(t){var n=this;return n._orientation=t.orientation||[1,0,0],n._stereo=t.stereo||null,n._pos=t.pos||null,n._pannerAttr={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:360,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:360,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:0,distanceModel:void 0!==t.distanceModel?t.distanceModel:"inverse",maxDistance:void 0!==t.maxDistance?t.maxDistance:1e4,panningModel:void 0!==t.panningModel?t.panningModel:"HRTF",refDistance:void 0!==t.refDistance?t.refDistance:1,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:1},n._onstereo=t.onstereo?[{fn:t.onstereo}]:[],n._onpos=t.onpos?[{fn:t.onpos}]:[],n._onorientation=t.onorientation?[{fn:t.onorientation}]:[],e.call(this,t)}),Howl.prototype.stereo=function(e,n){var r=this;if(!r._webAudio)return r;if("loaded"!==r._state)return r._queue.push({event:"stereo",action:function(){r.stereo(e,n)}}),r;var o=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===n){if("number"!=typeof e)return r._stereo;r._stereo=e,r._pos=[e,0,0]}for(var i=r._getSoundIds(n),a=0;a<i.length;a++){var u=r._soundById(i[a]);if(u){if("number"!=typeof e)return u._stereo;u._stereo=e,u._pos=[e,0,0],u._node&&(u._pannerAttr.panningModel="equalpower",u._panner&&u._panner.pan||t(u,o),"spatial"===o?void 0!==u._panner.positionX?(u._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),u._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),u._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):u._panner.setPosition(e,0,0):u._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),r._emit("stereo",u._id)}}return r},Howl.prototype.pos=function(e,n,r,o){var i=this;if(!i._webAudio)return i;if("loaded"!==i._state)return i._queue.push({event:"pos",action:function(){i.pos(e,n,r,o)}}),i;if(n="number"!=typeof n?0:n,r="number"!=typeof r?-.5:r,void 0===o){if("number"!=typeof e)return i._pos;i._pos=[e,n,r]}for(var a=i._getSoundIds(o),u=0;u<a.length;u++){var c=i._soundById(a[u]);if(c){if("number"!=typeof e)return c._pos;c._pos=[e,n,r],c._node&&(c._panner&&!c._panner.pan||t(c,"spatial"),void 0!==c._panner.positionX?(c._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),c._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),c._panner.positionZ.setValueAtTime(r,Howler.ctx.currentTime)):c._panner.setPosition(e,n,r)),i._emit("pos",c._id)}}return i},Howl.prototype.orientation=function(e,n,r,o){var i=this;if(!i._webAudio)return i;if("loaded"!==i._state)return i._queue.push({event:"orientation",action:function(){i.orientation(e,n,r,o)}}),i;if(n="number"!=typeof n?i._orientation[1]:n,r="number"!=typeof r?i._orientation[2]:r,void 0===o){if("number"!=typeof e)return i._orientation;i._orientation=[e,n,r]}for(var a=i._getSoundIds(o),u=0;u<a.length;u++){var c=i._soundById(a[u]);if(c){if("number"!=typeof e)return c._orientation;c._orientation=[e,n,r],c._node&&(c._panner||(c._pos||(c._pos=i._pos||[0,0,-.5]),t(c,"spatial")),void 0!==c._panner.orientationX?(c._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),c._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),c._panner.orientationZ.setValueAtTime(r,Howler.ctx.currentTime)):c._panner.setOrientation(e,n,r)),i._emit("orientation",c._id)}}return i},Howl.prototype.pannerAttr=function(){var e,n,r,o=this,i=arguments;if(!o._webAudio)return o;if(0===i.length)return o._pannerAttr;if(1===i.length){if("object"!=typeof i[0])return(r=o._soundById(parseInt(i[0],10)))?r._pannerAttr:o._pannerAttr;e=i[0],void 0===n&&(e.pannerAttr||(e.pannerAttr={coneInnerAngle:e.coneInnerAngle,coneOuterAngle:e.coneOuterAngle,coneOuterGain:e.coneOuterGain,distanceModel:e.distanceModel,maxDistance:e.maxDistance,refDistance:e.refDistance,rolloffFactor:e.rolloffFactor,panningModel:e.panningModel}),o._pannerAttr={coneInnerAngle:void 0!==e.pannerAttr.coneInnerAngle?e.pannerAttr.coneInnerAngle:o._coneInnerAngle,coneOuterAngle:void 0!==e.pannerAttr.coneOuterAngle?e.pannerAttr.coneOuterAngle:o._coneOuterAngle,coneOuterGain:void 0!==e.pannerAttr.coneOuterGain?e.pannerAttr.coneOuterGain:o._coneOuterGain,distanceModel:void 0!==e.pannerAttr.distanceModel?e.pannerAttr.distanceModel:o._distanceModel,maxDistance:void 0!==e.pannerAttr.maxDistance?e.pannerAttr.maxDistance:o._maxDistance,refDistance:void 0!==e.pannerAttr.refDistance?e.pannerAttr.refDistance:o._refDistance,rolloffFactor:void 0!==e.pannerAttr.rolloffFactor?e.pannerAttr.rolloffFactor:o._rolloffFactor,panningModel:void 0!==e.pannerAttr.panningModel?e.pannerAttr.panningModel:o._panningModel})}else 2===i.length&&(e=i[0],n=parseInt(i[1],10));for(var a=o._getSoundIds(n),u=0;u<a.length;u++)if(r=o._soundById(a[u])){var c=r._pannerAttr;c={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:c.coneInnerAngle,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:c.coneOuterAngle,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:c.coneOuterGain,distanceModel:void 0!==e.distanceModel?e.distanceModel:c.distanceModel,maxDistance:void 0!==e.maxDistance?e.maxDistance:c.maxDistance,refDistance:void 0!==e.refDistance?e.refDistance:c.refDistance,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:c.rolloffFactor,panningModel:void 0!==e.panningModel?e.panningModel:c.panningModel};var s=r._panner;s?(s.coneInnerAngle=c.coneInnerAngle,s.coneOuterAngle=c.coneOuterAngle,s.coneOuterGain=c.coneOuterGain,s.distanceModel=c.distanceModel,s.maxDistance=c.maxDistance,s.refDistance=c.refDistance,s.rolloffFactor=c.rolloffFactor,s.panningModel=c.panningModel):(r._pos||(r._pos=o._pos||[0,0,-.5]),t(r,"spatial"))}return o},Sound.prototype.init=function(e){return function(){var t=this,n=t._parent;t._orientation=n._orientation,t._stereo=n._stereo,t._pos=n._pos,t._pannerAttr=n._pannerAttr,e.call(this),t._stereo?n.stereo(t._stereo):t._pos&&n.pos(t._pos[0],t._pos[1],t._pos[2],t._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var t=this,n=t._parent;return t._orientation=n._orientation,t._stereo=n._stereo,t._pos=n._pos,t._pannerAttr=n._pannerAttr,t._stereo?n.stereo(t._stereo):t._pos?n.pos(t._pos[0],t._pos[1],t._pos[2],t._id):t._panner&&(t._panner.disconnect(0),t._panner=void 0,n._refreshBuffer(t)),e.call(this)}}(Sound.prototype.reset);var t=function(e,t){"spatial"===(t=t||"spatial")?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,void 0!==e._panner.positionX?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),void 0!==e._panner.orientationX?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}}()},35666:function(e){var t=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var o=t&&t.prototype instanceof m?t:m,i=Object.create(o.prototype),a=new x(r||[]);return i._invoke=function(e,t,n){var r=f;return function(o,i){if(r===d)throw new Error("Generator is already running");if(r===h){if("throw"===o)throw i;return C()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var u=S(a,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=d;var c=l(e,t,n);if("normal"===c.type){if(r=n.done?h:p,c.arg===y)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r=h,n.method="throw",n.arg=c.arg)}}}(e,n,a),i}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=s;var f="suspendedStart",p="suspendedYield",d="executing",h="completed",y={};function m(){}function v(){}function b(){}var g={};c(g,i,(function(){return this}));var w=Object.getPrototypeOf,_=w&&w(w(j([])));_&&_!==n&&r.call(_,i)&&(g=_);var O=b.prototype=m.prototype=Object.create(g);function T(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function R(e,t){function n(o,i,a,u){var c=l(e[o],e,i);if("throw"!==c.type){var s=c.arg,f=s.value;return f&&"object"==typeof f&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,a,u)}),(function(e){n("throw",e,a,u)})):t.resolve(f).then((function(e){s.value=e,a(s)}),(function(e){return n("throw",e,a,u)}))}u(c.arg)}var o;this._invoke=function(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}}function S(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,S(e,n),"throw"===n.method))return y;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var o=l(r,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,y;var i=o.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function j(e){if(e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}return{next:C}}function C(){return{value:t,done:!0}}return v.prototype=b,c(O,"constructor",b),c(b,"constructor",v),v.displayName=c(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,c(e,u,"GeneratorFunction")),e.prototype=Object.create(O),e},e.awrap=function(e){return{__await:e}},T(R.prototype),c(R.prototype,a,(function(){return this})),e.AsyncIterator=R,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new R(s(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(O),c(O,u,"Generator"),c(O,i,(function(){return this})),c(O,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=j,x.prototype={constructor:x,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return u.type="throw",u.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),s=r.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;P(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:j(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),y}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}},74379:function(e,t,n){"use strict";n.d(t,{y:function(){return l}});var r=n(10979),o=n(23142),i=n(32174),a=n(15050),u=n(43608);function c(e){return 0===e.length?u.y:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var s=n(30150),l=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var a=this.operator,u=function(e,t,n){if(e){if(e instanceof r.L)return e;if(e[o.b])return e[o.b]()}return e||t||n?new r.L(e,t,n):new r.L(i.c)}(e,t,n);if(a?u.add(a.call(u,this.source)):u.add(this.source||s.v.useDeprecatedSynchronousErrorHandling&&!u.syncErrorThrowable?this._subscribe(u):this._trySubscribe(u)),s.v.useDeprecatedSynchronousErrorHandling&&u.syncErrorThrowable&&(u.syncErrorThrowable=!1,u.syncErrorThrown))throw u.syncErrorValue;return u},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){s.v.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),function(e){for(;e;){var t=e,n=t.closed,o=t.destination,i=t.isStopped;if(n||i)return!1;e=o&&o instanceof r.L?o:null}return!0}(e)?e.error(t):console.warn(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=f(t))((function(t,r){var o;o=n.subscribe((function(t){try{e(t)}catch(e){r(e),o&&o.unsubscribe()}}),r,t)}))},e.prototype._subscribe=function(e){var t=this.source;return t&&t.subscribe(e)},e.prototype[a.L]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?this:c(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=f(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function f(e){if(e||(e=s.v.Promise||Promise),!e)throw new Error("no Promise impl found");return e}},32174:function(e,t,n){"use strict";n.d(t,{c:function(){return i}});var r=n(30150),o=n(71644),i={closed:!0,next:function(e){},error:function(e){if(r.v.useDeprecatedSynchronousErrorHandling)throw e;(0,o.z)(e)},complete:function(){}}},70456:function(e,t,n){"use strict";n.d(t,{t:function(){return g}});var r,o=n(70655),i=n(70211),a=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return o.ZT(t,e),t.prototype.schedule=function(t,n){return void 0===n&&(n=0),n>0?e.prototype.schedule.call(this,t,n):(this.delay=n,this.state=t,this.scheduler.flush(this),this)},t.prototype.execute=function(t,n){return n>0||this.closed?e.prototype.execute.call(this,t,n):this._execute(t,n)},t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0?e.prototype.requestAsyncId.call(this,t,n,r):t.flush(this)},t}(n(96114).o),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.ZT(t,e),t}(n(92980).v),c=new u(a),s=n(23884),l=n(10979),f=n(5631),p=n(18170),d=n(64944);r||(r={});var h=function(){function e(e,t,n){this.kind=e,this.value=t,this.error=n,this.hasValue="N"===e}return e.prototype.observe=function(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}},e.prototype.do=function(e,t,n){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return n&&n()}},e.prototype.accept=function(e,t,n){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,n)},e.prototype.toObservable=function(){switch(this.kind){case"N":return(0,p.of)(this.value);case"E":return(0,d._)(this.error);case"C":return(0,f.c)()}throw new Error("unexpected notification kind value")},e.createNext=function(t){return void 0!==t?new e("N",t):e.undefinedValueNotification},e.createError=function(t){return new e("E",void 0,t)},e.createComplete=function(){return e.completeNotification},e.completeNotification=new e("C"),e.undefinedValueNotification=new e("N",void 0),e}(),y=function(e){function t(t,n,r){void 0===r&&(r=0);var o=e.call(this,t)||this;return o.scheduler=n,o.delay=r,o}return o.ZT(t,e),t.dispatch=function(e){var t=e.notification,n=e.destination;t.observe(n),this.unsubscribe()},t.prototype.scheduleMessage=function(e){this.destination.add(this.scheduler.schedule(t.dispatch,this.delay,new m(e,this.destination)))},t.prototype._next=function(e){this.scheduleMessage(h.createNext(e))},t.prototype._error=function(e){this.scheduleMessage(h.createError(e)),this.unsubscribe()},t.prototype._complete=function(){this.scheduleMessage(h.createComplete()),this.unsubscribe()},t}(l.L),m=function(){return function(e,t){this.notification=e,this.destination=t}}(),v=n(41016),b=n(18253),g=function(e){function t(t,n,r){void 0===t&&(t=Number.POSITIVE_INFINITY),void 0===n&&(n=Number.POSITIVE_INFINITY);var o=e.call(this)||this;return o.scheduler=r,o._events=[],o._infiniteTimeWindow=!1,o._bufferSize=t<1?1:t,o._windowTime=n<1?1:n,n===Number.POSITIVE_INFINITY?(o._infiniteTimeWindow=!0,o.next=o.nextInfiniteTimeWindow):o.next=o.nextTimeWindow,o}return o.ZT(t,e),t.prototype.nextInfiniteTimeWindow=function(t){if(!this.isStopped){var n=this._events;n.push(t),n.length>this._bufferSize&&n.shift()}e.prototype.next.call(this,t)},t.prototype.nextTimeWindow=function(t){this.isStopped||(this._events.push(new w(this._getNow(),t)),this._trimBufferThenGetEvents()),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){var t,n=this._infiniteTimeWindow,r=n?this._events:this._trimBufferThenGetEvents(),o=this.scheduler,i=r.length;if(this.closed)throw new v.N;if(this.isStopped||this.hasError?t=s.w.EMPTY:(this.observers.push(e),t=new b.W(this,e)),o&&e.add(e=new y(e,o)),n)for(var a=0;a<i&&!e.closed;a++)e.next(r[a]);else for(a=0;a<i&&!e.closed;a++)e.next(r[a].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),t},t.prototype._getNow=function(){return(this.scheduler||c).now()},t.prototype._trimBufferThenGetEvents=function(){for(var e=this._getNow(),t=this._bufferSize,n=this._windowTime,r=this._events,o=r.length,i=0;i<o&&!(e-r[i].time<n);)i++;return o>t&&(i=Math.max(i,o-t)),i>0&&r.splice(0,i),r},t}(i.xQ),w=function(){return function(e,t){this.time=e,this.value=t}}()},70211:function(e,t,n){"use strict";n.d(t,{Yc:function(){return l},xQ:function(){return f}});var r=n(70655),o=n(74379),i=n(10979),a=n(23884),u=n(41016),c=n(18253),s=n(23142),l=function(e){function t(t){var n=e.call(this,t)||this;return n.destination=t,n}return r.ZT(t,e),t}(i.L),f=function(e){function t(){var t=e.call(this)||this;return t.observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return r.ZT(t,e),t.prototype[s.b]=function(){return new l(this)},t.prototype.lift=function(e){var t=new p(this,this);return t.operator=e,t},t.prototype.next=function(e){if(this.closed)throw new u.N;if(!this.isStopped)for(var t=this.observers,n=t.length,r=t.slice(),o=0;o<n;o++)r[o].next(e)},t.prototype.error=function(e){if(this.closed)throw new u.N;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,n=t.length,r=t.slice(),o=0;o<n;o++)r[o].error(e);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new u.N;this.isStopped=!0;for(var e=this.observers,t=e.length,n=e.slice(),r=0;r<t;r++)n[r].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype._trySubscribe=function(t){if(this.closed)throw new u.N;return e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){if(this.closed)throw new u.N;return this.hasError?(e.error(this.thrownError),a.w.EMPTY):this.isStopped?(e.complete(),a.w.EMPTY):(this.observers.push(e),new c.W(this,e))},t.prototype.asObservable=function(){var e=new o.y;return e.source=this,e},t.create=function(e,t){return new p(e,t)},t}(o.y),p=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return r.ZT(t,e),t.prototype.next=function(e){var t=this.destination;t&&t.next&&t.next(e)},t.prototype.error=function(e){var t=this.destination;t&&t.error&&this.destination.error(e)},t.prototype.complete=function(){var e=this.destination;e&&e.complete&&this.destination.complete()},t.prototype._subscribe=function(e){return this.source?this.source.subscribe(e):a.w.EMPTY},t}(f)},18253:function(e,t,n){"use strict";n.d(t,{W:function(){return o}});var r=n(70655),o=function(e){function t(t,n){var r=e.call(this)||this;return r.subject=t,r.subscriber=n,r.closed=!1,r}return r.ZT(t,e),t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var n=t.indexOf(this.subscriber);-1!==n&&t.splice(n,1)}}},t}(n(23884).w)},10979:function(e,t,n){"use strict";n.d(t,{L:function(){return l}});var r=n(70655),o=n(14156),i=n(32174),a=n(23884),u=n(23142),c=n(30150),s=n(71644),l=function(e){function t(n,r,o){var a=e.call(this)||this;switch(a.syncErrorValue=null,a.syncErrorThrown=!1,a.syncErrorThrowable=!1,a.isStopped=!1,arguments.length){case 0:a.destination=i.c;break;case 1:if(!n){a.destination=i.c;break}if("object"==typeof n){n instanceof t?(a.syncErrorThrowable=n.syncErrorThrowable,a.destination=n,n.add(a)):(a.syncErrorThrowable=!0,a.destination=new f(a,n));break}default:a.syncErrorThrowable=!0,a.destination=new f(a,n,r,o)}return a}return r.ZT(t,e),t.prototype[u.b]=function(){return this},t.create=function(e,n,r){var o=new t(e,n,r);return o.syncErrorThrowable=!1,o},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this},t}(a.w),f=function(e){function t(t,n,r,a){var u,c=e.call(this)||this;c._parentSubscriber=t;var s=c;return(0,o.m)(n)?u=n:n&&(u=n.next,r=n.error,a=n.complete,n!==i.c&&(s=Object.create(n),(0,o.m)(s.unsubscribe)&&c.add(s.unsubscribe.bind(s)),s.unsubscribe=c.unsubscribe.bind(c))),c._context=s,c._next=u,c._error=r,c._complete=a,c}return r.ZT(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;c.v.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber,n=c.v.useDeprecatedSynchronousErrorHandling;if(this._error)n&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)n?(t.syncErrorValue=e,t.syncErrorThrown=!0):(0,s.z)(e),this.unsubscribe();else{if(this.unsubscribe(),n)throw e;(0,s.z)(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var n=function(){return e._complete.call(e._context)};c.v.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){if(this.unsubscribe(),c.v.useDeprecatedSynchronousErrorHandling)throw e;(0,s.z)(e)}},t.prototype.__tryOrSetError=function(e,t,n){if(!c.v.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,n)}catch(t){return c.v.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=t,e.syncErrorThrown=!0,!0):((0,s.z)(t),!0)}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(l)},23884:function(e,t,n){"use strict";n.d(t,{w:function(){return u}});var r=n(59026),o=n(92009),i=n(14156),a=function(){function e(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),u=function(){function e(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}var t;return e.prototype.unsubscribe=function(){var t;if(!this.closed){var n=this,u=n._parentOrParents,s=n._ctorUnsubscribe,l=n._unsubscribe,f=n._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,u instanceof e)u.remove(this);else if(null!==u)for(var p=0;p<u.length;++p)u[p].remove(this);if((0,i.m)(l)){s&&(this._unsubscribe=void 0);try{l.call(this)}catch(e){t=e instanceof a?c(e.errors):[e]}}if((0,r.k)(f)){p=-1;for(var d=f.length;++p<d;){var h=f[p];if((0,o.K)(h))try{h.unsubscribe()}catch(e){t=t||[],e instanceof a?t=t.concat(c(e.errors)):t.push(e)}}}if(t)throw new a(t)}},e.prototype.add=function(t){var n=t;if(!t)return e.EMPTY;switch(typeof t){case"function":n=new e(t);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof e)){var r=n;(n=new e)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var o=n._parentOrParents;if(null===o)n._parentOrParents=this;else if(o instanceof e){if(o===this)return n;n._parentOrParents=[o,this]}else{if(-1!==o.indexOf(this))return n;o.push(this)}var i=this._subscriptions;return null===i?this._subscriptions=[n]:i.push(n),n},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}},e.EMPTY=((t=new e).closed=!0,t),e}();function c(e){return e.reduce((function(e,t){return e.concat(t instanceof a?t.errors:t)}),[])}},30150:function(e,t,n){"use strict";n.d(t,{v:function(){return o}});var r=!1,o={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){e&&(new Error).stack,r=e},get useDeprecatedSynchronousErrorHandling(){return r}}},17604:function(e,t,n){"use strict";n.d(t,{Ds:function(){return c},IY:function(){return u},ft:function(){return s}});var r=n(70655),o=n(10979),i=n(74379),a=n(67843),u=function(e){function t(t){var n=e.call(this)||this;return n.parent=t,n}return r.ZT(t,e),t.prototype._next=function(e){this.parent.notifyNext(e)},t.prototype._error=function(e){this.parent.notifyError(e),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},t}(o.L),c=(o.L,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.ZT(t,e),t.prototype.notifyNext=function(e){this.destination.next(e)},t.prototype.notifyError=function(e){this.destination.error(e)},t.prototype.notifyComplete=function(){this.destination.complete()},t}(o.L));function s(e,t){if(!t.closed){if(e instanceof i.y)return e.subscribe(t);var n;try{n=(0,a.s)(e)(t)}catch(e){t.error(e)}return n}}o.L},63202:function(e,t,n){"use strict";n.d(t,{aj:function(){return h}});var r=n(70655),o=n(17507),i=n(59026),a=n(10979),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.ZT(t,e),t.prototype.notifyNext=function(e,t,n,r,o){this.destination.next(t)},t.prototype.notifyError=function(e,t){this.destination.error(e)},t.prototype.notifyComplete=function(e){this.destination.complete()},t}(a.L),c=function(e){function t(t,n,r){var o=e.call(this)||this;return o.parent=t,o.outerValue=n,o.outerIndex=r,o.index=0,o}return r.ZT(t,e),t.prototype._next=function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)},t.prototype._error=function(e){this.parent.notifyError(e,this),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},t}(a.L),s=n(67843),l=n(74379);function f(e,t,n,r,o){if(void 0===o&&(o=new c(e,n,r)),!o.closed)return t instanceof l.y?t.subscribe(o):(0,s.s)(t)(o)}var p=n(43375),d={};function h(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=void 0,r=void 0;return(0,o.K)(e[e.length-1])&&(r=e.pop()),"function"==typeof e[e.length-1]&&(n=e.pop()),1===e.length&&(0,i.k)(e[0])&&(e=e[0]),(0,p.n)(e,r).lift(new y(n))}var y=function(){function e(e){this.resultSelector=e}return e.prototype.call=function(e,t){return t.subscribe(new m(e,this.resultSelector))},e}(),m=function(e){function t(t,n){var r=e.call(this,t)||this;return r.resultSelector=n,r.active=0,r.values=[],r.observables=[],r}return r.ZT(t,e),t.prototype._next=function(e){this.values.push(d),this.observables.push(e)},t.prototype._complete=function(){var e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.active=t,this.toRespond=t;for(var n=0;n<t;n++){var r=e[n];this.add(f(this,r,void 0,n))}}},t.prototype.notifyComplete=function(e){0==(this.active-=1)&&this.destination.complete()},t.prototype.notifyNext=function(e,t,n){var r=this.values,o=r[n],i=this.toRespond?o===d?--this.toRespond:this.toRespond:0;r[n]=t,0===i&&(this.resultSelector?this._tryResultSelector(r):this.destination.next(r.slice()))},t.prototype._tryResultSelector=function(e){var t;try{t=this.resultSelector.apply(this,e)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(u)},5631:function(e,t,n){"use strict";n.d(t,{c:function(){return i}});var r=n(74379),o=new r.y((function(e){return e.complete()}));function i(e){return e?function(e){return new r.y((function(t){return e.schedule((function(){return t.complete()}))}))}(e):o}},42615:function(e,t,n){"use strict";n.d(t,{D:function(){return c}});var r=n(74379),o=n(59026),i=n(55709),a=n(92009),u=n(94072);function c(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(1===e.length){var n=e[0];if((0,o.k)(n))return s(n,null);if((0,a.K)(n)&&Object.getPrototypeOf(n)===Object.prototype){var r=Object.keys(n);return s(r.map((function(e){return n[e]})),r)}}if("function"==typeof e[e.length-1]){var u=e.pop();return s(e=1===e.length&&(0,o.k)(e[0])?e[0]:e,null).pipe((0,i.U)((function(e){return u.apply(void 0,e)})))}return s(e,null)}function s(e,t){return new r.y((function(n){var r=e.length;if(0!==r)for(var o=new Array(r),i=0,a=0,c=function(c){var s=(0,u.D)(e[c]),l=!1;n.add(s.subscribe({next:function(e){l||(l=!0,a++),o[c]=e},error:function(e){return n.error(e)},complete:function(){++i!==r&&l||(a===r&&n.next(t?t.reduce((function(e,t,n){return e[t]=o[n],e}),{}):o),n.complete())}}))},s=0;s<r;s++)c(s);else n.complete()}))}},94072:function(e,t,n){"use strict";n.d(t,{D:function(){return f}});var r=n(74379),o=n(67843),i=n(23884),a=n(15050),u=n(53109),c=n(999),s=n(70336),l=n(39217);function f(e,t){return t?function(e,t){if(null!=e){if(function(e){return e&&"function"==typeof e[a.L]}(e))return function(e,t){return new r.y((function(n){var r=new i.w;return r.add(t.schedule((function(){var o=e[a.L]();r.add(o.subscribe({next:function(e){r.add(t.schedule((function(){return n.next(e)})))},error:function(e){r.add(t.schedule((function(){return n.error(e)})))},complete:function(){r.add(t.schedule((function(){return n.complete()})))}}))}))),r}))}(e,t);if((0,s.t)(e))return function(e,t){return new r.y((function(n){var r=new i.w;return r.add(t.schedule((function(){return e.then((function(e){r.add(t.schedule((function(){n.next(e),r.add(t.schedule((function(){return n.complete()})))})))}),(function(e){r.add(t.schedule((function(){return n.error(e)})))}))}))),r}))}(e,t);if((0,l.z)(e))return(0,u.r)(e,t);if(function(e){return e&&"function"==typeof e[c.hZ]}(e)||"string"==typeof e)return function(e,t){if(!e)throw new Error("Iterable cannot be null");return new r.y((function(n){var r,o=new i.w;return o.add((function(){r&&"function"==typeof r.return&&r.return()})),o.add(t.schedule((function(){r=e[c.hZ](),o.add(t.schedule((function(){if(!n.closed){var e,t;try{var o=r.next();e=o.value,t=o.done}catch(e){return void n.error(e)}t?n.complete():(n.next(e),this.schedule())}})))}))),o}))}(e,t)}throw new TypeError((null!==e&&typeof e||e)+" is not observable")}(e,t):e instanceof r.y?e:new r.y((0,o.s)(e))}},43375:function(e,t,n){"use strict";n.d(t,{n:function(){return a}});var r=n(74379),o=n(56900),i=n(53109);function a(e,t){return t?(0,i.r)(e,t):new r.y((0,o.V)(e))}},18170:function(e,t,n){"use strict";n.d(t,{of:function(){return a}});var r=n(17507),o=n(43375),i=n(53109);function a(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[e.length-1];return(0,r.K)(n)?(e.pop(),(0,i.r)(e,n)):(0,o.n)(e)}},64944:function(e,t,n){"use strict";n.d(t,{_:function(){return o}});var r=n(74379);function o(e,t){return t?new r.y((function(n){return t.schedule(i,0,{error:e,subscriber:n})})):new r.y((function(t){return t.error(e)}))}function i(e){var t=e.error;e.subscriber.error(t)}},40486:function(e,t,n){"use strict";n.d(t,{K:function(){return i}});var r=n(70655),o=n(17604);function i(e){return function(t){var n=new a(e),r=t.lift(n);return n.caught=r}}var a=function(){function e(e){this.selector=e}return e.prototype.call=function(e,t){return t.subscribe(new u(e,this.selector,this.caught))},e}(),u=function(e){function t(t,n,r){var o=e.call(this,t)||this;return o.selector=n,o.caught=r,o}return r.ZT(t,e),t.prototype.error=function(t){if(!this.isStopped){var n=void 0;try{n=this.selector(t,this.caught)}catch(t){return void e.prototype.error.call(this,t)}this._unsubscribeAndRecycle();var r=new o.IY(this);this.add(r);var i=(0,o.ft)(n,r);i!==r&&this.add(i)}},t}(o.Ds)},3283:function(e,t,n){"use strict";n.d(t,{b:function(){return a}});var r=n(70655),o=n(10979),i=n(90964);function a(e,t){return void 0===t&&(t=i.P),function(n){return n.lift(new u(e,t))}}var u=function(){function e(e,t){this.dueTime=e,this.scheduler=t}return e.prototype.call=function(e,t){return t.subscribe(new c(e,this.dueTime,this.scheduler))},e}(),c=function(e){function t(t,n,r){var o=e.call(this,t)||this;return o.dueTime=n,o.scheduler=r,o.debouncedSubscription=null,o.lastValue=null,o.hasValue=!1,o}return r.ZT(t,e),t.prototype._next=function(e){this.clearDebounce(),this.lastValue=e,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(s,this.dueTime,this))},t.prototype._complete=function(){this.debouncedNext(),this.destination.complete()},t.prototype.debouncedNext=function(){if(this.clearDebounce(),this.hasValue){var e=this.lastValue;this.lastValue=null,this.hasValue=!1,this.destination.next(e)}},t.prototype.clearDebounce=function(){var e=this.debouncedSubscription;null!==e&&(this.remove(e),e.unsubscribe(),this.debouncedSubscription=null)},t}(o.L);function s(e){e.debouncedNext()}},66008:function(e,t,n){"use strict";n.d(t,{h:function(){return i}});var r=n(70655),o=n(10979);function i(e,t){return function(n){return n.lift(new a(e,t))}}var a=function(){function e(e,t){this.predicate=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new u(e,this.predicate,this.thisArg))},e}(),u=function(e){function t(t,n,r){var o=e.call(this,t)||this;return o.predicate=n,o.thisArg=r,o.count=0,o}return r.ZT(t,e),t.prototype._next=function(e){var t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}t&&this.destination.next(e)},t}(o.L)},29514:function(e,t,n){"use strict";n.d(t,{P:function(){return m}});var r=function(){function e(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return e.prototype=Object.create(Error.prototype),e}(),o=n(66008),i=n(84217),a=n(70655),u=n(10979);function c(e){return void 0===e&&(e=null),function(t){return t.lift(new s(e))}}var s=function(){function e(e){this.defaultValue=e}return e.prototype.call=function(e,t){return t.subscribe(new l(e,this.defaultValue))},e}(),l=function(e){function t(t,n){var r=e.call(this,t)||this;return r.defaultValue=n,r.isEmpty=!0,r}return a.ZT(t,e),t.prototype._next=function(e){this.isEmpty=!1,this.destination.next(e)},t.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},t}(u.L);function f(e){return void 0===e&&(e=h),function(t){return t.lift(new p(e))}}var p=function(){function e(e){this.errorFactory=e}return e.prototype.call=function(e,t){return t.subscribe(new d(e,this.errorFactory))},e}(),d=function(e){function t(t,n){var r=e.call(this,t)||this;return r.errorFactory=n,r.hasValue=!1,r}return a.ZT(t,e),t.prototype._next=function(e){this.hasValue=!0,this.destination.next(e)},t.prototype._complete=function(){if(this.hasValue)return this.destination.complete();var e=void 0;try{e=this.errorFactory()}catch(t){e=t}this.destination.error(e)},t}(u.L);function h(){return new r}var y=n(43608);function m(e,t){var n=arguments.length>=2;return function(a){return a.pipe(e?(0,o.h)((function(t,n){return e(t,n,a)})):y.y,(0,i.q)(1),n?c(t):f((function(){return new r})))}}},55709:function(e,t,n){"use strict";n.d(t,{U:function(){return i}});var r=n(70655),o=n(10979);function i(e,t){return function(n){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new a(e,t))}}var a=function(){function e(e,t){this.project=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new u(e,this.project,this.thisArg))},e}(),u=function(e){function t(t,n,r){var o=e.call(this,t)||this;return o.project=n,o.count=0,o.thisArg=r||o,o}return r.ZT(t,e),t.prototype._next=function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(o.L)},47746:function(e,t,n){"use strict";n.d(t,{zg:function(){return u}});var r=n(70655),o=n(55709),i=n(94072),a=n(17604);function u(e,t,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),"function"==typeof t?function(r){return r.pipe(u((function(n,r){return(0,i.D)(e(n,r)).pipe((0,o.U)((function(e,o){return t(n,e,r,o)})))}),n))}:("number"==typeof t&&(n=t),function(t){return t.lift(new c(e,n))})}var c=function(){function e(e,t){void 0===t&&(t=Number.POSITIVE_INFINITY),this.project=e,this.concurrent=t}return e.prototype.call=function(e,t){return t.subscribe(new s(e,this.project,this.concurrent))},e}(),s=function(e){function t(t,n,r){void 0===r&&(r=Number.POSITIVE_INFINITY);var o=e.call(this,t)||this;return o.project=n,o.concurrent=r,o.hasCompleted=!1,o.buffer=[],o.active=0,o.index=0,o}return r.ZT(t,e),t.prototype._next=function(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)},t.prototype._tryNext=function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(e){return void this.destination.error(e)}this.active++,this._innerSub(t)},t.prototype._innerSub=function(e){var t=new a.IY(this),n=this.destination;n.add(t);var r=(0,a.ft)(e,t);r!==t&&n.add(r)},t.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},t.prototype.notifyNext=function(e){this.destination.next(e)},t.prototype.notifyComplete=function(){var e=this.buffer;this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},t}(a.Ds)},39876:function(e,t,n){"use strict";n.d(t,{B:function(){return y}});var r=n(70655),o=n(70211),i=n(74379),a=n(10979),u=n(23884);function c(){return function(e){return e.lift(new s(e))}}var s=function(){function e(e){this.connectable=e}return e.prototype.call=function(e,t){var n=this.connectable;n._refCount++;var r=new l(e,n),o=t.subscribe(r);return r.closed||(r.connection=n.connect()),o},e}(),l=function(e){function t(t,n){var r=e.call(this,t)||this;return r.connectable=n,r}return r.ZT(t,e),t.prototype._unsubscribe=function(){var e=this.connectable;if(e){this.connectable=null;var t=e._refCount;if(t<=0)this.connection=null;else if(e._refCount=t-1,t>1)this.connection=null;else{var n=this.connection,r=e._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}else this.connection=null},t}(a.L),f=function(e){function t(t,n){var r=e.call(this)||this;return r.source=t,r.subjectFactory=n,r._refCount=0,r._isComplete=!1,r}return r.ZT(t,e),t.prototype._subscribe=function(e){return this.getSubject().subscribe(e)},t.prototype.getSubject=function(){var e=this._subject;return e&&!e.isStopped||(this._subject=this.subjectFactory()),this._subject},t.prototype.connect=function(){var e=this._connection;return e||(this._isComplete=!1,(e=this._connection=new u.w).add(this.source.subscribe(new d(this.getSubject(),this))),e.closed&&(this._connection=null,e=u.w.EMPTY)),e},t.prototype.refCount=function(){return c()(this)},t}(i.y),p=function(){var e=f.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:e._subscribe},_isComplete:{value:e._isComplete,writable:!0},getSubject:{value:e.getSubject},connect:{value:e.connect},refCount:{value:e.refCount}}}(),d=function(e){function t(t,n){var r=e.call(this,t)||this;return r.connectable=n,r}return r.ZT(t,e),t.prototype._error=function(t){this._unsubscribe(),e.prototype._error.call(this,t)},t.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),e.prototype._complete.call(this)},t.prototype._unsubscribe=function(){var e=this.connectable;if(e){this.connectable=null;var t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}},t}(o.Yc);a.L;function h(){return new o.xQ}function y(){return function(e){return c()((t=h,function(e){var n;n="function"==typeof t?t:function(){return t};var r=Object.create(e,p);return r.source=e,r.subjectFactory=n,r})(e));var t}}},96381:function(e,t,n){"use strict";n.d(t,{w:function(){return u}});var r=n(70655),o=n(55709),i=n(94072),a=n(17604);function u(e,t){return"function"==typeof t?function(n){return n.pipe(u((function(n,r){return(0,i.D)(e(n,r)).pipe((0,o.U)((function(e,o){return t(n,e,r,o)})))})))}:function(t){return t.lift(new c(e))}}var c=function(){function e(e){this.project=e}return e.prototype.call=function(e,t){return t.subscribe(new s(e,this.project))},e}(),s=function(e){function t(t,n){var r=e.call(this,t)||this;return r.project=n,r.index=0,r}return r.ZT(t,e),t.prototype._next=function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(e){return void this.destination.error(e)}this._innerSub(t)},t.prototype._innerSub=function(e){var t=this.innerSubscription;t&&t.unsubscribe();var n=new a.IY(this),r=this.destination;r.add(n),this.innerSubscription=(0,a.ft)(e,n),this.innerSubscription!==n&&r.add(this.innerSubscription)},t.prototype._complete=function(){var t=this.innerSubscription;t&&!t.closed||e.prototype._complete.call(this),this.unsubscribe()},t.prototype._unsubscribe=function(){this.innerSubscription=void 0},t.prototype.notifyComplete=function(){this.innerSubscription=void 0,this.isStopped&&e.prototype._complete.call(this)},t.prototype.notifyNext=function(e){this.destination.next(e)},t}(a.Ds)},84217:function(e,t,n){"use strict";n.d(t,{q:function(){return u}});var r=n(70655),o=n(10979),i=function(){function e(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return e.prototype=Object.create(Error.prototype),e}(),a=n(5631);function u(e){return function(t){return 0===e?(0,a.c)():t.lift(new c(e))}}var c=function(){function e(e){if(this.total=e,this.total<0)throw new i}return e.prototype.call=function(e,t){return t.subscribe(new s(e,this.total))},e}(),s=function(e){function t(t,n){var r=e.call(this,t)||this;return r.total=n,r.count=0,r}return r.ZT(t,e),t.prototype._next=function(e){var t=this.total,n=++this.count;n<=t&&(this.destination.next(e),n===t&&(this.destination.complete(),this.unsubscribe()))},t}(o.L)},63438:function(e,t,n){"use strict";n.d(t,{b:function(){return u}});var r=n(70655),o=n(10979);function i(){}var a=n(14156);function u(e,t,n){return function(r){return r.lift(new c(e,t,n))}}var c=function(){function e(e,t,n){this.nextOrObserver=e,this.error=t,this.complete=n}return e.prototype.call=function(e,t){return t.subscribe(new s(e,this.nextOrObserver,this.error,this.complete))},e}(),s=function(e){function t(t,n,r,o){var u=e.call(this,t)||this;return u._tapNext=i,u._tapError=i,u._tapComplete=i,u._tapError=r||i,u._tapComplete=o||i,(0,a.m)(n)?(u._context=u,u._tapNext=n):n&&(u._context=n,u._tapNext=n.next||i,u._tapError=n.error||i,u._tapComplete=n.complete||i),u}return r.ZT(t,e),t.prototype._next=function(e){try{this._tapNext.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.next(e)},t.prototype._error=function(e){try{this._tapError.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.error(e)},t.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()},t}(o.L)},36277:function(e,t,n){"use strict";n.d(t,{P:function(){return a},d:function(){return i}});var r=n(70655),o=n(17604),i={leading:!0,trailing:!1};function a(e,t){return void 0===t&&(t=i),function(n){return n.lift(new u(e,!!t.leading,!!t.trailing))}}var u=function(){function e(e,t,n){this.durationSelector=e,this.leading=t,this.trailing=n}return e.prototype.call=function(e,t){return t.subscribe(new c(e,this.durationSelector,this.leading,this.trailing))},e}(),c=function(e){function t(t,n,r,o){var i=e.call(this,t)||this;return i.destination=t,i.durationSelector=n,i._leading=r,i._trailing=o,i._hasValue=!1,i}return r.ZT(t,e),t.prototype._next=function(e){this._hasValue=!0,this._sendValue=e,this._throttled||(this._leading?this.send():this.throttle(e))},t.prototype.send=function(){var e=this._hasValue,t=this._sendValue;e&&(this.destination.next(t),this.throttle(t)),this._hasValue=!1,this._sendValue=void 0},t.prototype.throttle=function(e){var t=this.tryDurationSelector(e);t&&this.add(this._throttled=(0,o.ft)(t,new o.IY(this)))},t.prototype.tryDurationSelector=function(e){try{return this.durationSelector(e)}catch(e){return this.destination.error(e),null}},t.prototype.throttlingDone=function(){var e=this._throttled,t=this._trailing;e&&e.unsubscribe(),this._throttled=void 0,t&&this.send()},t.prototype.notifyNext=function(){this.throttlingDone()},t.prototype.notifyComplete=function(){this.throttlingDone()},t}(o.Ds)},73316:function(e,t,n){"use strict";n.d(t,{p:function(){return u}});var r=n(70655),o=n(10979),i=n(90964),a=n(36277);function u(e,t,n){return void 0===t&&(t=i.P),void 0===n&&(n=a.d),function(r){return r.lift(new c(e,t,n.leading,n.trailing))}}var c=function(){function e(e,t,n,r){this.duration=e,this.scheduler=t,this.leading=n,this.trailing=r}return e.prototype.call=function(e,t){return t.subscribe(new s(e,this.duration,this.scheduler,this.leading,this.trailing))},e}(),s=function(e){function t(t,n,r,o,i){var a=e.call(this,t)||this;return a.duration=n,a.scheduler=r,a.leading=o,a.trailing=i,a._hasTrailingValue=!1,a._trailingValue=null,a}return r.ZT(t,e),t.prototype._next=function(e){this.throttled?this.trailing&&(this._trailingValue=e,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(l,this.duration,{subscriber:this})),this.leading?this.destination.next(e):this.trailing&&(this._trailingValue=e,this._hasTrailingValue=!0))},t.prototype._complete=function(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()},t.prototype.clearThrottle=function(){var e=this.throttled;e&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),e.unsubscribe(),this.remove(e),this.throttled=null)},t}(o.L);function l(e){e.subscriber.clearThrottle()}},53109:function(e,t,n){"use strict";n.d(t,{r:function(){return i}});var r=n(74379),o=n(23884);function i(e,t){return new r.y((function(n){var r=new o.w,i=0;return r.add(t.schedule((function(){i!==e.length?(n.next(e[i++]),n.closed||r.add(this.schedule())):n.complete()}))),r}))}},96114:function(e,t,n){"use strict";n.d(t,{o:function(){return o}});var r=n(70655),o=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r.pending=!1,r}return r.ZT(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!==n&&this.delay===n&&!1===this.pending)return t;clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n=!1,r=void 0;try{this.work(e)}catch(e){n=!0,r=!!e&&e||new Error(e)}if(n)return this.unsubscribe(),r},t.prototype._unsubscribe=function(){var e=this.id,t=this.scheduler,n=t.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null},t}(function(e){function t(t,n){return e.call(this)||this}return r.ZT(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(n(23884).w))},92980:function(e,t,n){"use strict";n.d(t,{v:function(){return i}});var r=n(70655),o=function(){function e(t,n){void 0===n&&(n=e.now),this.SchedulerAction=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.SchedulerAction(this,e).schedule(n,t)},e.now=function(){return Date.now()},e}(),i=function(e){function t(n,r){void 0===r&&(r=o.now);var i=e.call(this,n,(function(){return t.delegate&&t.delegate!==i?t.delegate.now():r()}))||this;return i.actions=[],i.active=!1,i.scheduled=void 0,i}return r.ZT(t,e),t.prototype.schedule=function(n,r,o){return void 0===r&&(r=0),t.delegate&&t.delegate!==this?t.delegate.schedule(n,r,o):e.prototype.schedule.call(this,n,r,o)},t.prototype.flush=function(e){var t=this.actions;if(this.active)t.push(e);else{var n;this.active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(o)},90964:function(e,t,n){"use strict";n.d(t,{P:function(){return o}});var r=n(96114),o=new(n(92980).v)(r.o)},999:function(e,t,n){"use strict";function r(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}n.d(t,{hZ:function(){return o}});var o=r()},15050:function(e,t,n){"use strict";n.d(t,{L:function(){return r}});var r=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}()},23142:function(e,t,n){"use strict";n.d(t,{b:function(){return r}});var r=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}()},41016:function(e,t,n){"use strict";n.d(t,{N:function(){return r}});var r=function(){function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e}()},71644:function(e,t,n){"use strict";function r(e){setTimeout((function(){throw e}),0)}n.d(t,{z:function(){return r}})},43608:function(e,t,n){"use strict";function r(e){return e}n.d(t,{y:function(){return r}})},59026:function(e,t,n){"use strict";n.d(t,{k:function(){return r}});var r=function(){return Array.isArray||function(e){return e&&"number"==typeof e.length}}()},39217:function(e,t,n){"use strict";n.d(t,{z:function(){return r}});var r=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e}},14156:function(e,t,n){"use strict";function r(e){return"function"==typeof e}n.d(t,{m:function(){return r}})},92009:function(e,t,n){"use strict";function r(e){return null!==e&&"object"==typeof e}n.d(t,{K:function(){return r}})},70336:function(e,t,n){"use strict";function r(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}n.d(t,{t:function(){return r}})},17507:function(e,t,n){"use strict";function r(e){return e&&"function"==typeof e.schedule}n.d(t,{K:function(){return r}})},67843:function(e,t,n){"use strict";n.d(t,{s:function(){return l}});var r=n(56900),o=n(71644),i=n(999),a=n(15050),u=n(39217),c=n(70336),s=n(92009),l=function(e){if(e&&"function"==typeof e[a.L])return l=e,function(e){var t=l[a.L]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)};if((0,u.z)(e))return(0,r.V)(e);if((0,c.t)(e))return n=e,function(e){return n.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,o.z),e};if(e&&"function"==typeof e[i.hZ])return t=e,function(e){for(var n=t[i.hZ]();;){var r=void 0;try{r=n.next()}catch(t){return e.error(t),e}if(r.done){e.complete();break}if(e.next(r.value),e.closed)break}return"function"==typeof n.return&&e.add((function(){n.return&&n.return()})),e};var t,n,l,f=(0,s.K)(e)?"an invalid object":"'"+e+"'";throw new TypeError("You provided "+f+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")}},56900:function(e,t,n){"use strict";n.d(t,{V:function(){return r}});var r=function(e){return function(t){for(var n=0,r=e.length;n<r&&!t.closed;n++)t.next(e[n]);t.complete()}}},84758:function(e,t){"use strict";var n=function(){function e(){this._state=new Int32Array(4),this._buffer=new ArrayBuffer(68),this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}return e.hashStr=function(e,t){return void 0===t&&(t=!1),this.onePassHasher.start().appendStr(e).end(t)},e.hashAsciiStr=function(e,t){return void 0===t&&(t=!1),this.onePassHasher.start().appendAsciiStr(e).end(t)},e._hex=function(t){var n,r,o,i,a=e.hexChars,u=e.hexOut;for(i=0;i<4;i+=1)for(r=8*i,n=t[i],o=0;o<8;o+=2)u[r+1+o]=a.charAt(15&n),n>>>=4,u[r+0+o]=a.charAt(15&n),n>>>=4;return u.join("")},e._md5cycle=function(e,t){var n=e[0],r=e[1],o=e[2],i=e[3];r=((r+=((o=((o+=((i=((i+=((n=((n+=(r&o|~r&i)+t[0]-680876936|0)<<7|n>>>25)+r|0)&r|~n&o)+t[1]-389564586|0)<<12|i>>>20)+n|0)&n|~i&r)+t[2]+606105819|0)<<17|o>>>15)+i|0)&i|~o&n)+t[3]-1044525330|0)<<22|r>>>10)+o|0,r=((r+=((o=((o+=((i=((i+=((n=((n+=(r&o|~r&i)+t[4]-176418897|0)<<7|n>>>25)+r|0)&r|~n&o)+t[5]+1200080426|0)<<12|i>>>20)+n|0)&n|~i&r)+t[6]-1473231341|0)<<17|o>>>15)+i|0)&i|~o&n)+t[7]-45705983|0)<<22|r>>>10)+o|0,r=((r+=((o=((o+=((i=((i+=((n=((n+=(r&o|~r&i)+t[8]+1770035416|0)<<7|n>>>25)+r|0)&r|~n&o)+t[9]-1958414417|0)<<12|i>>>20)+n|0)&n|~i&r)+t[10]-42063|0)<<17|o>>>15)+i|0)&i|~o&n)+t[11]-1990404162|0)<<22|r>>>10)+o|0,r=((r+=((o=((o+=((i=((i+=((n=((n+=(r&o|~r&i)+t[12]+1804603682|0)<<7|n>>>25)+r|0)&r|~n&o)+t[13]-40341101|0)<<12|i>>>20)+n|0)&n|~i&r)+t[14]-1502002290|0)<<17|o>>>15)+i|0)&i|~o&n)+t[15]+1236535329|0)<<22|r>>>10)+o|0,r=((r+=((o=((o+=((i=((i+=((n=((n+=(r&i|o&~i)+t[1]-165796510|0)<<5|n>>>27)+r|0)&o|r&~o)+t[6]-1069501632|0)<<9|i>>>23)+n|0)&r|n&~r)+t[11]+643717713|0)<<14|o>>>18)+i|0)&n|i&~n)+t[0]-373897302|0)<<20|r>>>12)+o|0,r=((r+=((o=((o+=((i=((i+=((n=((n+=(r&i|o&~i)+t[5]-701558691|0)<<5|n>>>27)+r|0)&o|r&~o)+t[10]+38016083|0)<<9|i>>>23)+n|0)&r|n&~r)+t[15]-660478335|0)<<14|o>>>18)+i|0)&n|i&~n)+t[4]-405537848|0)<<20|r>>>12)+o|0,r=((r+=((o=((o+=((i=((i+=((n=((n+=(r&i|o&~i)+t[9]+568446438|0)<<5|n>>>27)+r|0)&o|r&~o)+t[14]-1019803690|0)<<9|i>>>23)+n|0)&r|n&~r)+t[3]-187363961|0)<<14|o>>>18)+i|0)&n|i&~n)+t[8]+1163531501|0)<<20|r>>>12)+o|0,r=((r+=((o=((o+=((i=((i+=((n=((n+=(r&i|o&~i)+t[13]-1444681467|0)<<5|n>>>27)+r|0)&o|r&~o)+t[2]-51403784|0)<<9|i>>>23)+n|0)&r|n&~r)+t[7]+1735328473|0)<<14|o>>>18)+i|0)&n|i&~n)+t[12]-1926607734|0)<<20|r>>>12)+o|0,r=((r+=((o=((o+=((i=((i+=((n=((n+=(r^o^i)+t[5]-378558|0)<<4|n>>>28)+r|0)^r^o)+t[8]-2022574463|0)<<11|i>>>21)+n|0)^n^r)+t[11]+1839030562|0)<<16|o>>>16)+i|0)^i^n)+t[14]-35309556|0)<<23|r>>>9)+o|0,r=((r+=((o=((o+=((i=((i+=((n=((n+=(r^o^i)+t[1]-1530992060|0)<<4|n>>>28)+r|0)^r^o)+t[4]+1272893353|0)<<11|i>>>21)+n|0)^n^r)+t[7]-155497632|0)<<16|o>>>16)+i|0)^i^n)+t[10]-1094730640|0)<<23|r>>>9)+o|0,r=((r+=((o=((o+=((i=((i+=((n=((n+=(r^o^i)+t[13]+681279174|0)<<4|n>>>28)+r|0)^r^o)+t[0]-358537222|0)<<11|i>>>21)+n|0)^n^r)+t[3]-722521979|0)<<16|o>>>16)+i|0)^i^n)+t[6]+76029189|0)<<23|r>>>9)+o|0,r=((r+=((o=((o+=((i=((i+=((n=((n+=(r^o^i)+t[9]-640364487|0)<<4|n>>>28)+r|0)^r^o)+t[12]-421815835|0)<<11|i>>>21)+n|0)^n^r)+t[15]+530742520|0)<<16|o>>>16)+i|0)^i^n)+t[2]-995338651|0)<<23|r>>>9)+o|0,r=((r+=((i=((i+=(r^((n=((n+=(o^(r|~i))+t[0]-198630844|0)<<6|n>>>26)+r|0)|~o))+t[7]+1126891415|0)<<10|i>>>22)+n|0)^((o=((o+=(n^(i|~r))+t[14]-1416354905|0)<<15|o>>>17)+i|0)|~n))+t[5]-57434055|0)<<21|r>>>11)+o|0,r=((r+=((i=((i+=(r^((n=((n+=(o^(r|~i))+t[12]+1700485571|0)<<6|n>>>26)+r|0)|~o))+t[3]-1894986606|0)<<10|i>>>22)+n|0)^((o=((o+=(n^(i|~r))+t[10]-1051523|0)<<15|o>>>17)+i|0)|~n))+t[1]-2054922799|0)<<21|r>>>11)+o|0,r=((r+=((i=((i+=(r^((n=((n+=(o^(r|~i))+t[8]+1873313359|0)<<6|n>>>26)+r|0)|~o))+t[15]-30611744|0)<<10|i>>>22)+n|0)^((o=((o+=(n^(i|~r))+t[6]-1560198380|0)<<15|o>>>17)+i|0)|~n))+t[13]+1309151649|0)<<21|r>>>11)+o|0,r=((r+=((i=((i+=(r^((n=((n+=(o^(r|~i))+t[4]-145523070|0)<<6|n>>>26)+r|0)|~o))+t[11]-1120210379|0)<<10|i>>>22)+n|0)^((o=((o+=(n^(i|~r))+t[2]+718787259|0)<<15|o>>>17)+i|0)|~n))+t[9]-343485551|0)<<21|r>>>11)+o|0,e[0]=n+e[0]|0,e[1]=r+e[1]|0,e[2]=o+e[2]|0,e[3]=i+e[3]|0},e.prototype.start=function(){return this._dataLength=0,this._bufferLength=0,this._state.set(e.stateIdentity),this},e.prototype.appendStr=function(t){var n,r,o=this._buffer8,i=this._buffer32,a=this._bufferLength;for(r=0;r<t.length;r+=1){if((n=t.charCodeAt(r))<128)o[a++]=n;else if(n<2048)o[a++]=192+(n>>>6),o[a++]=63&n|128;else if(n<55296||n>56319)o[a++]=224+(n>>>12),o[a++]=n>>>6&63|128,o[a++]=63&n|128;else{if((n=1024*(n-55296)+(t.charCodeAt(++r)-56320)+65536)>1114111)throw new Error("Unicode standard supports code points up to U+10FFFF");o[a++]=240+(n>>>18),o[a++]=n>>>12&63|128,o[a++]=n>>>6&63|128,o[a++]=63&n|128}a>=64&&(this._dataLength+=64,e._md5cycle(this._state,i),a-=64,i[0]=i[16])}return this._bufferLength=a,this},e.prototype.appendAsciiStr=function(t){for(var n,r=this._buffer8,o=this._buffer32,i=this._bufferLength,a=0;;){for(n=Math.min(t.length-a,64-i);n--;)r[i++]=t.charCodeAt(a++);if(i<64)break;this._dataLength+=64,e._md5cycle(this._state,o),i=0}return this._bufferLength=i,this},e.prototype.appendByteArray=function(t){for(var n,r=this._buffer8,o=this._buffer32,i=this._bufferLength,a=0;;){for(n=Math.min(t.length-a,64-i);n--;)r[i++]=t[a++];if(i<64)break;this._dataLength+=64,e._md5cycle(this._state,o),i=0}return this._bufferLength=i,this},e.prototype.getState=function(){var e=this,t=e._state;return{buffer:String.fromCharCode.apply(null,e._buffer8),buflen:e._bufferLength,length:e._dataLength,state:[t[0],t[1],t[2],t[3]]}},e.prototype.setState=function(e){var t,n=e.buffer,r=e.state,o=this._state;for(this._dataLength=e.length,this._bufferLength=e.buflen,o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],t=0;t<n.length;t+=1)this._buffer8[t]=n.charCodeAt(t)},e.prototype.end=function(t){void 0===t&&(t=!1);var n,r=this._bufferLength,o=this._buffer8,i=this._buffer32,a=1+(r>>2);if(this._dataLength+=r,o[r]=128,o[r+1]=o[r+2]=o[r+3]=0,i.set(e.buffer32Identity.subarray(a),a),r>55&&(e._md5cycle(this._state,i),i.set(e.buffer32Identity)),(n=8*this._dataLength)<=4294967295)i[14]=n;else{var u=n.toString(16).match(/(.*?)(.{0,8})$/);if(null===u)return;var c=parseInt(u[2],16),s=parseInt(u[1],16)||0;i[14]=c,i[15]=s}return e._md5cycle(this._state,i),t?this._state:e._hex(this._state)},e.stateIdentity=new Int32Array([1732584193,-271733879,-1732584194,271733878]),e.buffer32Identity=new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),e.hexChars="0123456789abcdef",e.hexOut=[],e.onePassHasher=new e,e}();t.V=n,"5d41402abc4b2a76b9719d911017c592"!==n.hashStr("hello")&&console.error("Md5 self test failed.")},70655:function(e,t,n){"use strict";n.d(t,{ZT:function(){return o}});var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)};function o(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}},91496:function(e){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},20384:function(e){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},89539:function(e,t,n){var r=/%[sdj%]/g;t.format=function(e){if(!m(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(a(arguments[n]));return t.join(" ")}n=1;for(var o=arguments,i=o.length,u=String(e).replace(r,(function(e){if("%%"===e)return"%";if(n>=i)return e;switch(e){case"%s":return String(o[n++]);case"%d":return Number(o[n++]);case"%j":try{return JSON.stringify(o[n++])}catch(e){return"[Circular]"}default:return e}})),c=o[n];n<i;c=o[++n])h(c)||!g(c)?u+=" "+c:u+=" "+a(c);return u},t.deprecate=function(e,r){if(v(n.g.process))return function(){return t.deprecate(e,r).apply(this,arguments)};if(!0===process.noDeprecation)return e;var o=!1;return function(){if(!o){if(process.throwDeprecation)throw new Error(r);process.traceDeprecation?console.trace(r):console.error(r),o=!0}return e.apply(this,arguments)}};var o,i={};function a(e,n){var r={seen:[],stylize:c};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),d(n)?r.showHidden=n:n&&t._extend(r,n),v(r.showHidden)&&(r.showHidden=!1),v(r.depth)&&(r.depth=2),v(r.colors)&&(r.colors=!1),v(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=u),s(r,e,r.depth)}function u(e,t){var n=a.styles[t];return n?"["+a.colors[n][0]+"m"+e+"["+a.colors[n][1]+"m":e}function c(e,t){return e}function s(e,n,r){if(e.customInspect&&n&&O(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var o=n.inspect(r,e);return m(o)||(o=s(e,o,r)),o}var i=function(e,t){if(v(t))return e.stylize("undefined","undefined");if(m(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return y(t)?e.stylize(""+t,"number"):d(t)?e.stylize(""+t,"boolean"):h(t)?e.stylize("null","null"):void 0}(e,n);if(i)return i;var a=Object.keys(n),u=function(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(n)),_(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return l(n);if(0===a.length){if(O(n)){var c=n.name?": "+n.name:"";return e.stylize("[Function"+c+"]","special")}if(b(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(w(n))return e.stylize(Date.prototype.toString.call(n),"date");if(_(n))return l(n)}var g,T="",R=!1,S=["{","}"];return p(n)&&(R=!0,S=["[","]"]),O(n)&&(T=" [Function"+(n.name?": "+n.name:"")+"]"),b(n)&&(T=" "+RegExp.prototype.toString.call(n)),w(n)&&(T=" "+Date.prototype.toUTCString.call(n)),_(n)&&(T=" "+l(n)),0!==a.length||R&&0!=n.length?r<0?b(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),g=R?function(e,t,n,r,o){for(var i=[],a=0,u=t.length;a<u;++a)P(t,String(a))?i.push(f(e,t,n,r,String(a),!0)):i.push("");return o.forEach((function(o){o.match(/^\d+$/)||i.push(f(e,t,n,r,o,!0))})),i}(e,n,r,u,a):a.map((function(t){return f(e,n,r,u,t,R)})),e.seen.pop(),function(e,t,n){return e.reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}(g,T,S)):S[0]+T+S[1]}function l(e){return"["+Error.prototype.toString.call(e)+"]"}function f(e,t,n,r,o,i){var a,u,c;if((c=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?u=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(u=e.stylize("[Setter]","special")),P(r,o)||(a="["+o+"]"),u||(e.seen.indexOf(c.value)<0?(u=h(n)?s(e,c.value,null):s(e,c.value,n-1)).indexOf("\n")>-1&&(u=i?u.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+u.split("\n").map((function(e){return"   "+e})).join("\n")):u=e.stylize("[Circular]","special")),v(a)){if(i&&o.match(/^\d+$/))return u;(a=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+u}function p(e){return Array.isArray(e)}function d(e){return"boolean"==typeof e}function h(e){return null===e}function y(e){return"number"==typeof e}function m(e){return"string"==typeof e}function v(e){return void 0===e}function b(e){return g(e)&&"[object RegExp]"===T(e)}function g(e){return"object"==typeof e&&null!==e}function w(e){return g(e)&&"[object Date]"===T(e)}function _(e){return g(e)&&("[object Error]"===T(e)||e instanceof Error)}function O(e){return"function"==typeof e}function T(e){return Object.prototype.toString.call(e)}function R(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(e){if(v(o)&&(o=process.env.NODE_DEBUG||""),e=e.toUpperCase(),!i[e])if(new RegExp("\\b"+e+"\\b","i").test(o)){var n=process.pid;i[e]=function(){var r=t.format.apply(t,arguments);console.error("%s %d: %s",e,n,r)}}else i[e]=function(){};return i[e]},t.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=p,t.isBoolean=d,t.isNull=h,t.isNullOrUndefined=function(e){return null==e},t.isNumber=y,t.isString=m,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=v,t.isRegExp=b,t.isObject=g,t.isDate=w,t.isError=_,t.isFunction=O,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=n(20384);var S=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function E(){var e=new Date,t=[R(e.getHours()),R(e.getMinutes()),R(e.getSeconds())].join(":");return[e.getDate(),S[e.getMonth()],t].join(" ")}function P(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",E(),t.format.apply(t,arguments))},t.inherits=n(91496),t._extend=function(e,t){if(!t||!g(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](n,n.exports,__webpack_require__),n.exports}__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=function(e,t){for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};var __webpack_exports__={};!function(){"use strict";__webpack_require__(35666),__webpack_require__(19601),__webpack_require__(41539),__webpack_require__(88674),__webpack_require__(74916),__webpack_require__(77601);var e=__webpack_require__(95855),t=(__webpack_require__(66992),__webpack_require__(51532),__webpack_require__(78783),__webpack_require__(10072),__webpack_require__(23042),__webpack_require__(99137),__webpack_require__(71957),__webpack_require__(96306),__webpack_require__(103),__webpack_require__(74592),__webpack_require__(58276),__webpack_require__(35082),__webpack_require__(12813),__webpack_require__(18222),__webpack_require__(38563),__webpack_require__(50336),__webpack_require__(7512),__webpack_require__(33948),__webpack_require__(15581),__webpack_require__(2490),__webpack_require__(34514),__webpack_require__(54747),__webpack_require__(57327),__webpack_require__(88449),__webpack_require__(59849),__webpack_require__(38862),__webpack_require__(9653),__webpack_require__(40561),__webpack_require__(47941),__webpack_require__(39714),__webpack_require__(69826),__webpack_require__(31672),__webpack_require__(59461),__webpack_require__(34553),__webpack_require__(91058),__webpack_require__(68216),__webpack_require__(79433),__webpack_require__(21703),__webpack_require__(68309),__webpack_require__(60086),__webpack_require__(21249),__webpack_require__(57640),__webpack_require__(9924),__webpack_require__(69070),__webpack_require__(70456)),n=__webpack_require__(89539),r=__webpack_require__(7999),o=__webpack_require__(80115),i=__webpack_require__(99556),a=__webpack_require__(55830),u=(__webpack_require__(92222),__webpack_require__(6892)),c=__webpack_require__(45355),s=__webpack_require__(98919),l=__webpack_require__(7349),f=__webpack_require__(92403),p=__webpack_require__(68511),d=__webpack_require__(43706),h=__webpack_require__(70258),y=__webpack_require__(73915),m=__webpack_require__(70211),v=__webpack_require__(14311),b=__webpack_require__(41142),g=(__webpack_require__(68304),__webpack_require__(30489),__webpack_require__(81299),__webpack_require__(12419),__webpack_require__(82526),__webpack_require__(41817),__webpack_require__(32165),__webpack_require__(16957)),w=__webpack_require__(90140),_=__webpack_require__(94110);function O(e){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O(e)}function T(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function R(e,t){return R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},R(e,t)}function S(e,t){if(t&&("object"===O(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function E(e){return E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},E(e)}var P=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&R(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=E(r);if(o){var n=E(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return S(this,e)});function a(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(e=i.call(this,"draw")).onDrawHandler=function(e){e.renderer.clear(!0,!0,!0),e.renderer.render(e.scene,e.camera)},e}return t=a,(n=[{key:"getType",value:function(){return a.TypeRTTI}},{key:"OnAttached",value:function(){this.registerMessageHandler(_.K.TypeRTTI,this.onDrawHandler)}},{key:"OnDetached",value:function(){this.unregisterMessageHandler(_.K.TypeRTTI)}}])&&T(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(g.V);P.TypeRTTI=new w.r("ViewportControllerDraw",g.V.TypeRTTI),__webpack_require__(54678),__webpack_require__(35192),__webpack_require__(82481),__webpack_require__(23157),__webpack_require__(91038),__webpack_require__(47042);var x=__webpack_require__(73316),j=__webpack_require__(96169);function C(e){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function M(e,t){return M=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},M(e,t)}function D(e,t){if(t&&("object"===C(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function A(e){return A=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},A(e)}var I=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&M(e,t)}(u,e);var t,n,r,o,i,a=(o=u,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=A(o);if(i){var n=A(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return D(this,e)});function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=a.call(this)).mInterceptFunction=e,t}return t=u,r=[{key:"ResolveInterceptors",value:function(e,t){var n=0;return new Promise((function(r,o){if(e.length<=0)return o();!function i(){n<e.length?e[n++].execute(t).then(i,o).catch(o):r()}()}))}}],(n=[{key:"execute",value:function(e){return this.mInterceptFunction(e)}}])&&k(t.prototype,n),r&&k(t,r),Object.defineProperty(t,"prototype",{writable:!1}),u}(__webpack_require__(96080).X),N=__webpack_require__(28810),V=__webpack_require__(79816),U=__webpack_require__(59342),F=__webpack_require__(97841),B=(__webpack_require__(74819),__webpack_require__(38880),__webpack_require__(1715));function L(e){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},L(e)}function H(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function z(){return z="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=q(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},z.apply(this,arguments)}function q(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Q(e)););return e}function G(e,t){return G=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},G(e,t)}function W(e,t){if(t&&("object"===L(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Q(e){return Q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Q(e)}var K=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&G(e,t)}(u,e);var t,r,o,i,a=(o=u,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Q(o);if(i){var n=Q(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return W(this,e)});function u(e,t,r){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(o=a.call(this,"set-model-quaternion")).mObject=e,(0,n.isUndefined)(o.mObject)||(0,n.isUndefined)(t)||(o.mOldRotation=o.mObject.quaternion.clone(),o.mNewRotation=t.clone()),(0,n.isNullOrUndefined)(r)||(o.mOldRotation=r.clone()),o.setUpdatable(!0),o}return t=u,(r=[{key:"getType",value:function(){return u.TypeRTTI}},{key:"getNewRotation",value:function(){return this.mNewRotation}},{key:"execute",value:function(){this.mObject.quaternion.copy(this.mNewRotation),this.mObject.updateMatrixWorld(!0);var e=this.mObject.userData.sceneObjectRef;(0,n.isNullOrUndefined)(e)||e.setValue("quaternion",this.mNewRotation),this.mEditor.dispatchEvent(v.G.ObjectChanged,{name:"quaternion",object:this.mObject})}},{key:"undo",value:function(){this.mObject.quaternion.copy(this.mOldRotation),this.mObject.updateMatrixWorld(!0);var e=this.mObject.userData.sceneObjectRef;(0,n.isNullOrUndefined)(e)||e.setValue("quaternion",this.mOldRotation),this.mEditor.dispatchEvent(v.G.ObjectChanged,{name:"quaternion",object:this.mObject})}},{key:"overridesCommand",value:function(e){return z(Q(u.prototype),"overridesCommand",this).call(this,e)}},{key:"update",value:function(e){this.mNewRotation.copy(e.getNewRotation())}}])&&H(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),u}(B.m);K.TypeRTTI=new w.r("SetQuaternionCommand",B.m.TypeRTTI);var Y,Z,X=__webpack_require__(59835),J=__webpack_require__(91305),$=__webpack_require__(47405);function ee(e){return ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ee(e)}function te(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function ne(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){te(i,r,o,a,u,"next",e)}function u(e){te(i,r,o,a,u,"throw",e)}a(void 0)}))}}function re(e){return function(e){if(Array.isArray(e))return oe(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return oe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?oe(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ie(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ae(e,t){return ae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ae(e,t)}function ue(e,t){if(t&&("object"===ee(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ce(e){return ce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ce(e)}!function(e){e[e.X=1]="X",e[e.Y=2]="Y",e[e.Z=4]="Z"}(Y||(Y={})),function(e){e[e.POSITIVE=0]="POSITIVE",e[e.NEGATIVE=1]="NEGATIVE"}(Z||(Z={}));var se=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ae(e,t)}(s,e);var t,r,o,i,a,u,c=(a=s,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ce(a);if(u){var n=ce(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return ue(this,e)});function s(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(e=c.call(this,"floorplanner-transform-controls")).mEditor=null,e.mSubscriptions=new Array,e.enabled=!0,e.rotationEnabled=!1,e.panEnabled=!1,e.isRotating=!1,e.isPanning=!1,e.visible=!1,e.arrowsVisible=!1,e.rotationAxisEnabled=Y.X|Y.Y|Y.Z,e.rotationOffset=0,e.dragging=!1,e.mousedown=!1,e.arrowAxisXMesh=[],e.arrowAxisYMesh=[],e.arrowAxisZMesh=[],e.UnitX=new THREE.Vector3(1,0,0),e.UnitY=new THREE.Vector3(0,1,0),e.UnitZ=new THREE.Vector3(0,0,1),e.sizeArrows={scale:1,min:.1,max:40},e.sizeProtractor={scale:1,min:.1,max:30},e.ringThickness=.045,e.protractorRadius=.3,e.objectAddedHandler=function(t){var r=t.getData();if(r&&r.isObject3D){var o=e.resolveDropableComponent(r);if(!(0,n.isNullOrUndefined)(o)){var i=o.getParentObject(),a=1,u=1;if(i.isDerivedTypeOf($.M.TypeRTTI)){var c=parseFloat(i.getValue("cell_width")),s=parseFloat(i.getValue("cell_height"));a=Number.isFinite(c)?c:1,u=Number.isFinite(s)?s:1}e.addPanningRaycastPlane(r,a,u)}}},e.objectRemovedHandler=function(t){var r=t.getData();if(!0===r.isObject3D){var o=e.resolveDropableComponent(r);(0,n.isNullOrUndefined)(o)||e.removePanningRaycastPlane(r)}},e.objectSelectedHandler=function(t){e.Detach();var n=null!=t.getData()?t.getData().selection:null,r=e._findSceneMesh(n);e.isValidSceneMesh(r)&&(null!==r.userData.transforms&&void 0!==r.userData.transforms?e.Attach(r.userData.transforms.transformObject(r)):e.Attach(r)),setTimeout((function(){return e.mEditor.dispatchEvent(j.Gw.RequestFrame)}),500)},e}return t=s,r=[{key:"getType",value:function(){return s.TypeRTTI}},{key:"OnAttached",value:function(){var e=this;this.mEditor=this.getViewportRenderer().getEditor(),this.camera=this.mEditor.getCamera(),this.domElement=this.mEditor.getRenderer().domElement,this.gizmoArrowTextures=[],this.protractorTexture=this.LoadTexture(N.E.assetsUrl+"system/floorplanner/protractor-texture.png",(function(e){e.wrapS=THREE.RepeatWrapping,e.wrapT=THREE.RepeatWrapping,e.repeat.set(1,1),e.needsUpdate=!0})),this.gizmoArrowTextures.push(this.LoadTexture(N.E.assetsUrl+"system/floorplanner/gizmo-arrow-x-2x.png",(function(e){e.wrapS=THREE.RepeatWrapping,e.wrapT=THREE.RepeatWrapping,e.repeat.set(1,1),e.needsUpdate=!0}))),this.gizmoArrowTextures.push(this.LoadTexture(N.E.assetsUrl+"system/floorplanner/gizmo-arrow-y-2x.png",(function(e){e.wrapS=THREE.RepeatWrapping,e.wrapT=THREE.RepeatWrapping,e.repeat.set(1,1),e.needsUpdate=!0}))),this.gizmoArrowTextures.push(this.LoadTexture(N.E.assetsUrl+"system/floorplanner/gizmo-arrow-z-2x.png",(function(e){e.wrapS=THREE.RepeatWrapping,e.wrapT=THREE.RepeatWrapping,e.repeat.set(1,1),e.needsUpdate=!0}))),this.object=null,this.rotationAxis=null,this.rotationAxisSide=null,this.previousRotation=0,this.originalRotation=0,this.previousUVCoord=new THREE.Vector2,this.raycaster=new THREE.Raycaster,this.mouse=new THREE.Vector2,this.boundingBoxObject=new THREE.Box3,this.boundingRect=new THREE.Vector4,this.panInterceptors=[],this.rotationInterceptors=[],this.rotationRingMesh=new THREE.Mesh(new THREE.RingGeometry(0,0,0,0,0,0),new THREE.MeshBasicMaterial({color:255,visible:!0,side:THREE.DoubleSide,transparent:!0,depthTest:!1,depthWrite:!1})),this.rotationRingMesh.name="TransformControls-rotation-ring",this.rotationRingMesh.visible=!1,this.rotationRingMesh.frustumCulled=!1;var t=new THREE.Geometry;t.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(0,.5,0)),this.rotationLine=new THREE.Line(t,new THREE.LineBasicMaterial({color:255,visible:!0,side:THREE.DoubleSide,transparent:!0,depthTest:!1,depthWrite:!1})),this.rotationLine.name="TransformControls-rotation-line",this.rotationLine.visible=!1,this.rotationLine.frustumCulled=!1,this.rotationRaycastPlane=new THREE.Mesh(new THREE.PlaneGeometry(1e4,1e4,1,1),new THREE.MeshBasicMaterial({visible:!1,transparent:!0,side:THREE.DoubleSide})),this.rotationRaycastPlane.name="TransformControls-rotation-raycast-plane",this.rotationRaycastPlane.frustumCulled=!1,this.panningRaycastPlanes=[],this.arrowAxisXMesh=[],this.arrowAxisYMesh=[],this.arrowAxisZMesh=[],this.protractorMesh=new THREE.Mesh(new THREE.CircleGeometry(this.protractorRadius,32),new THREE.MeshBasicMaterial({color:16777215,map:this.protractorTexture,transparent:!0,opacity:1,depthTest:!1,depthWrite:!1,visible:!0,side:THREE.DoubleSide})),this.protractorMesh.name="TransformControls-protractor",this.protractorMesh.visible=!0,this.protractorMesh.frustumCulled=!1,this.protractorMesh.castShadow=!1,this.protractorMesh.receiveShadow=!1,this.protractorGroup=new THREE.Group,this.protractorGroup.name="TransformControls-protractor-group",this.protractorGroup.add(this.protractorMesh);var n=document.createElement("div");n.style.position="absolute",n.style.display="none",n.style.top="0px",n.style.left="0px",n.style.width="auto",n.style.height="auto",n.style.padding="15px 5px 14px 5px",n.style.margin="0px",n.style.font="normal 16px Arial",n.style.textAlign="center",n.style.lineHeight="0",n.style.color="rgba(0,0,0,1)",n.style.backgroundColor="rgba(255,255,255,1)",n.style.border="1px solid rgba(0,0,0,1)",n.style.borderRadius="3px",n.style.whiteSpace="nowrap",n.style.boxSizing="border-box",n.style.zIndex="5",n.style.pointerEvents="none",n.innerHTML="".concat(0,"&#176;"),this.rotationText=n,document.body.appendChild(n),this.mSubscriptions.push(this.mEditor.observeInitialized().subscribe((function(){e.scene=e.mEditor.getScene(),e.scene.add(e.rotationRaycastPlane),e.scene.add(e.protractorGroup),e.scene.add(e.rotationRingMesh),e.scene.add(e.rotationLine),e.EnablePanning(),e.SetRotationVisibility(!1),e.Initialize()})),this.mEditor.observeEvents(j.Gw.ObjectSelected).subscribe(this.objectSelectedHandler),this.mEditor.observeEvents(j.Gw.RequestFrame).pipe((0,x.p)(50)).subscribe((function(){return e.Update()})),this.mEditor.observeEvents(j.Gw.NodeAdded).subscribe(this.objectAddedHandler),this.mEditor.observeEvents(j.Gw.NodeRemoved).subscribe(this.objectRemovedHandler),this.mEditor.observeEvents(j.Gw.NodeChanged).subscribe(this.objectAddedHandler))}},{key:"OnDetached",value:function(){this.mEditor=null,this.mSubscriptions.splice(0).forEach((function(e){return e.unsubscribe()})),this.Dispose()}},{key:"_findSceneMesh",value:function(e){if(null==e)return null;if(null!==e.userData&&void 0!==e.userData&&null!==e.userData.sceneObjectRef&&void 0!==e.userData.sceneObjectRef){var t=e.userData.sceneObjectRef;if(t.isDerivedOfTypeName("MeshEntityModel")||t.isDerivedOfTypeName("ProductNode")&&!this.mEditor.getSceneManager().isRootNode(t))return e}return this._findSceneMesh(e.parent)}},{key:"resolveDropableComponent",value:function(e){var t=(e.userData||{}).sceneObjectRef;return(0,n.isNullOrUndefined)(t)?null:t.getComponent("dropableHandler")}},{key:"isValidSceneMesh",value:function(e){return null!=e&&!0===e.isObject3D&&e!==this.mEditor.getScene()}},{key:"Attach",value:function(e){var t=this;this.object&&this.Detach(),this.object=e,this.UpdateBoundingBox(),this.disposeArrowAxisMeshes(),this.CreateArrows();var n=new THREE.Vector3;this.object.getWorldPosition(n);var r=new THREE.Vector3;this.boundingBoxObject.getCenter(r);var o=n.clone().add(r);[].concat(re(this.arrowAxisXMesh),re(this.arrowAxisYMesh),re(this.arrowAxisZMesh)).forEach((function(e){t.object.add(e)})),this.RepositionArrows(),this.rotationLine.position.copy(o),this.rotationLine.quaternion.copy(this.object.quaternion),this.rotationRingMesh.position.copy(o),this.rotationRingMesh.quaternion.copy(this.object.quaternion),this.rotationRaycastPlane.position.copy(o),this.rotationRaycastPlane.quaternion.copy(this.object.quaternion),this.SetRotationVisibility(!1,this.rotationEnabled),this.Update(),this.mEditor.dispatchEvent(j.Gw.RequestFrame)}},{key:"Detach",value:function(){if(this.HasObject()){for(var e=0;e<this.arrowAxisXMesh.length;e++)this.object.remove(this.arrowAxisXMesh[e]);for(var t=0;t<this.arrowAxisYMesh.length;t++)this.object.remove(this.arrowAxisYMesh[t]);for(var n=0;n<this.arrowAxisZMesh.length;n++)this.object.remove(this.arrowAxisZMesh[n])}this.object=null,this.SetRotationVisibility(!1),this.rotationAxis=null,this.rotationAxisSide=null,this.isRotating=!1,this.rotationRingMesh.visible=!1,this.rotationLine.visible=!1}},{key:"Update",value:function(){if(this.object&&this.enabled&&this.rotationEnabled){var e=new THREE.Vector3;this.camera.getWorldPosition(e);var t=new THREE.Vector3;this.object.getWorldPosition(t);var n=new THREE.Vector3;this.boundingBoxObject.getCenter(n),n.applyQuaternion(this.object.quaternion);var r=t.clone().add(n),o=new THREE.Vector3;this.camera.getWorldDirection(o);var i=e.clone().sub(r).normalize();if(this.arrowAxisXMesh.length>0&&this.arrowsVisible&&(this.rotationAxisEnabled&Y.X)===Y.X)for(var a=0,u=-1/0,c=new THREE.Vector3,s=0;s<8;s++){this.arrowAxisXMesh[s].visible=!1,this.arrowAxisXMesh[s].getWorldPosition(c);var l=c.clone().sub(r).normalize(),f=i.dot(l);if(f>u&&(a=s,u=f),3===s||7===s){var p=new THREE.Vector3;this.arrowAxisXMesh[a].getWorldDirection(p),this.arrowAxisXMesh[a].visible=o.dot(p)<-.15,u=-1/0}}if(this.arrowAxisYMesh.length>0&&this.arrowsVisible&&(this.rotationAxisEnabled&Y.Y)===Y.Y)for(var d=0,h=-1/0,y=new THREE.Vector3,m=0;m<8;m++){this.arrowAxisYMesh[m].visible=!1,this.arrowAxisYMesh[m].getWorldPosition(y);var v=y.clone().sub(r).normalize(),b=i.dot(v);if(b>h&&(d=m,h=b),3===m||7===m){var g=new THREE.Vector3;this.arrowAxisYMesh[d].getWorldDirection(g),this.arrowAxisYMesh[d].visible=o.dot(g)<-.15,h=-1/0}}if(this.arrowAxisZMesh.length>0&&this.arrowsVisible&&(this.rotationAxisEnabled&Y.Z)===Y.Z)for(var w=0,_=-1/0,O=new THREE.Vector3,T=0;T<8;T++){this.arrowAxisZMesh[T].visible=!1,this.arrowAxisZMesh[T].getWorldPosition(O);var R=O.clone().sub(r).normalize(),S=i.dot(R);if(S>_&&(w=T,_=S),3===T||7===T){var E=new THREE.Vector3;this.arrowAxisZMesh[w].getWorldDirection(E),this.arrowAxisZMesh[w].visible=o.dot(E)<-.15,_=-1/0}}var P=r.distanceTo(this.camera.position),x=P*this.sizeProtractor.scale;if(x=THREE.Math.clamp(x,this.sizeProtractor.min,this.sizeProtractor.max),this.protractorGroup.scale.set(x,x,x),this.arrowsVisible){var j=P*this.sizeArrows.scale;if(j=THREE.Math.clamp(j,this.sizeArrows.min,this.sizeArrows.max),(this.rotationAxisEnabled&Y.X)===Y.X)for(var C=0;C<this.arrowAxisXMesh.length;C++)this.arrowAxisXMesh[C].scale.set(j,j,j);if((this.rotationAxisEnabled&Y.Y)===Y.Y)for(var k=0;k<this.arrowAxisYMesh.length;k++)this.arrowAxisYMesh[k].scale.set(j,j,j);if((this.rotationAxisEnabled&Y.Z)===Y.Z)for(var M=0;M<this.arrowAxisZMesh.length;M++)this.arrowAxisZMesh[M].scale.set(j,j,j)}}}},{key:"EnableRotationAxis",value:function(e){this.rotationAxisEnabled|=e,this.SetRotationVisibility(!1,!0)}},{key:"DisableRotationAxis",value:function(e){this.rotationAxisEnabled&=~e,this.SetRotationVisibility(!1,!0)}},{key:"ToggleRotationAxis",value:function(e){this.rotationAxisEnabled^=e,this.SetRotationVisibility(!1,!0)}},{key:"IsRotationAxisEnabled",value:function(e){return(this.rotationAxisEnabled&e)===e}},{key:"EnablePanning",value:function(){this.panEnabled=!0}},{key:"DisablePanning",value:function(){this.panEnabled=!1}},{key:"IsPanningEnabled",value:function(){return this.panEnabled}},{key:"EnableRotation",value:function(){this.rotationEnabled=!0,this.SetRotationVisibility(!1,!0)}},{key:"DisableRotation",value:function(){this.rotationEnabled=!1,this.SetRotationVisibility(!1,!1)}},{key:"IsRotationEnabled",value:function(){return this.rotationEnabled}},{key:"Initialize",value:function(){var e=this;try{if(document.body.contains(this.domElement)){var t=this.domElement.getBoundingClientRect();this.boundingRect.set(t.left,t.top,t.width,t.height)}}catch(e){b.qL.error(e)}this.registerMessageHandler(V.Nk.TypeRTTI,(function(t){e.OnWindowResize(t.width,t.height)})),this.registerMessageHandler(V.ng.TypeRTTI,(function(t){switch(t.name){case"up":e.OnBeforeMouseUp(t.event);break;case"down":e.OnBeforeMouseDown(t.event);break;case"move":e.OnBeforeMouseMove(t.event)}}))}},{key:"disposeArrowAxisMeshes",value:function(){for(var e=0;e<this.arrowAxisXMesh.length;e++)this.arrowAxisXMesh[e].geometry.dispose(),this.arrowAxisXMesh[e].material.dispose();for(var t=0;t<this.arrowAxisYMesh.length;t++)this.arrowAxisYMesh[t].geometry.dispose(),this.arrowAxisYMesh[t].material.dispose();for(var n=0;n<this.arrowAxisZMesh.length;n++)this.arrowAxisZMesh[n].geometry.dispose(),this.arrowAxisZMesh[n].material.dispose();this.arrowAxisXMesh=[],this.arrowAxisYMesh=[],this.arrowAxisZMesh=[]}},{key:"Dispose",value:function(){this.object&&this.Detach(),this.disposeArrowAxisMeshes(),this.protractorGroup.remove(this.protractorMesh),null!==this.protractorTexture&&this.protractorTexture.dispose(),this.protractorMesh.material.map=null,this.protractorMesh.material.dispose(),this.protractorMesh.geometry.dispose(),this.protractorMesh=null;for(var e=0;e<this.gizmoArrowTextures.length;e++)null!==this.gizmoArrowTextures[e]&&(this.gizmoArrowTextures[e].dispose(),this.gizmoArrowTextures[e]=null);this.gizmoArrowTextures=[],this.scene.remove(this.protractorGroup),this.protractorGroup=null,this.scene.remove(this.rotationRingMesh),this.rotationRingMesh.geometry.dispose(),this.rotationRingMesh.material.dispose(),this.rotationRingMesh=null,this.scene.remove(this.rotationLine),this.scene.remove(this.rotationRaycastPlane),this.rotationRaycastPlane.geometry.dispose(),this.rotationRaycastPlane.material.dispose(),this.rotationRaycastPlane=null,this.panInterceptors=[],this.rotationInterceptors=[],this.object=null,this.unregisterMessageHandler(V.Nk.TypeRTTI),this.unregisterMessageHandler(V.ng.TypeRTTI)}},{key:"addPanningRaycastPlane",value:function(e,t,n){this.panningRaycastPlanes=this.panningRaycastPlanes||[],this.panningRaycastPlanes.findIndex((function(t){return t.plane.id===e.id}))<0&&this.panningRaycastPlanes.push({plane:e,cellWidth:t,cellHeight:n})}},{key:"removePanningRaycastPlane",value:function(e){this.panningRaycastPlanes=this.panningRaycastPlanes||[];var t=this.panningRaycastPlanes.findIndex((function(t){return t.plane.id===e.id}));t>=0&&this.panningRaycastPlanes.splice(t,1)}},{key:"UpdateBoundingBox",value:function(){var e=new THREE.Vector3(1,1,1),t=new THREE.Box3;this.object.updateMatrixWorld(!0);var n=new THREE.Vector3;this.object.getWorldPosition(n),this.object.traverse((function(n){if(n.visible&&!String(n.name).startsWith("TransformControls")){if(n instanceof THREE.Mesh){n.geometry.computeBoundingBox();var r=n.geometry.boundingBox;t.union(r.clone().applyMatrix4(n.matrixWorld))}n.userData.sceneObjectRef&&"Configurable"==n.userData.sceneObjectRef.mName&&e.copy(n.userData.sceneObjectRef.mScale)}})),t.translate(n.clone().negate()),this.boundingBoxObject.copy(t),this.boundingBoxObject.min.multiply(e),this.boundingBoxObject.max.multiply(e)}},{key:"OnMouseDown",value:function(e,t){if(this.object&&this.enabled){this.Update(),this.isRotating=!1,this.isPanning=!1,this.mousedown=!0,this.object.updateMatrixWorld(!0),this.UpdateBoundingBox(),this.RepositionArrows();var n=this.boundingBoxObject.max.x-this.boundingBoxObject.min.x,r=this.boundingBoxObject.max.y-this.boundingBoxObject.min.y,o=this.boundingBoxObject.max.z-this.boundingBoxObject.min.z,i=new THREE.Quaternion;this.object.getWorldQuaternion(i);var a=new THREE.Vector3;a.copy(this.object.up).applyQuaternion(i);var u=new THREE.Vector3;this.object.getWorldDirection(u);var c=u.clone().cross(a),s=new THREE.Vector3;this.object.getWorldPosition(s);var l=new THREE.Vector3;this.boundingBoxObject.getCenter(l),l.applyQuaternion(this.object.quaternion);var f=s.clone().add(l);if(this.rotationEnabled&&!this.isPanning){for(var p=[],d=0;d<this.arrowAxisXMesh.length;d++)this.arrowAxisXMesh[d].visible&&this.IsRotationAxisEnabled(Y.X)&&p.push(this.arrowAxisXMesh[d]);for(var h=0;h<this.arrowAxisYMesh.length;h++)this.arrowAxisYMesh[h].visible&&this.IsRotationAxisEnabled(Y.Y)&&p.push(this.arrowAxisYMesh[h]);for(var y=0;y<this.arrowAxisZMesh.length;y++)this.arrowAxisZMesh[y].visible&&this.IsRotationAxisEnabled(Y.Z)&&p.push(this.arrowAxisZMesh[y]);var m=this.IntersectObjects(e,t,p);if(m){this.mEditor.dispatchEvent(j.Gw.TransformControlChanged,this.object),this.isRotating=!0,this.rotationAxis=null,this.rotationAxisSide=null;var v=new THREE.Vector3;this.camera.getWorldPosition(v);var g=this.arrowAxisXMesh.findIndex((function(e){return e.id===m.object.id}));g>=0&&(this.rotationAxis=Y.X,this.rotationAxisSide=this.arrowAxisXMesh[g].userData.AxisSide),null===this.rotationAxis&&(g=this.arrowAxisYMesh.findIndex((function(e){return e.id===m.object.id})))>=0&&(this.rotationAxis=Y.Y,this.rotationAxisSide=this.arrowAxisYMesh[g].userData.AxisSide),null===this.rotationAxis&&(g=this.arrowAxisZMesh.findIndex((function(e){return e.id===m.object.id})))>=0&&(this.rotationAxis=Y.Z,this.rotationAxisSide=this.arrowAxisZMesh[g].userData.AxisSide);var w=new THREE.Vector3(0,0,0),_=(new THREE.Quaternion).copy(this.object.quaternion);if(this.rotationAxis===Y.X){var O=c.clone();this.rotationAxisSide===Z.POSITIVE?(w.copy(O.multiplyScalar(-.5*n)),_.multiply((new THREE.Quaternion).setFromAxisAngle(new THREE.Vector3(0,1,0),THREE.Math.degToRad(270)))):(w.copy(O.multiplyScalar(.5*n)),_.multiply((new THREE.Quaternion).setFromAxisAngle(new THREE.Vector3(0,1,0),THREE.Math.degToRad(90))))}else if(this.rotationAxis===Y.Y){var T=a.clone();this.rotationAxisSide===Z.NEGATIVE?(w.copy(T.multiplyScalar(-.5*r)),_.multiply((new THREE.Quaternion).setFromAxisAngle(new THREE.Vector3(1,0,0),THREE.Math.degToRad(270)))):(w.copy(T.multiplyScalar(.5*r)),_.multiply((new THREE.Quaternion).setFromAxisAngle(new THREE.Vector3(1,0,0),THREE.Math.degToRad(90))))}else if(this.rotationAxis===Y.Z){var R=u.clone();this.rotationAxisSide===Z.NEGATIVE?w.copy(R.multiplyScalar(-.5*o)):(w.copy(R.multiplyScalar(.5*o)),_.multiply((new THREE.Quaternion).setFromAxisAngle(new THREE.Vector3(0,1,0),THREE.Math.degToRad(180))))}else this.rotationAxis=null;this.previousRotation=null,this.rotationOffset=0,this.originalRotation=0;var S=f.clone().add(w);this.protractorGroup.position.copy(S),this.protractorGroup.quaternion.copy(this.object.quaternion);var E=f.clone(),P=new THREE.Vector3;this.protractorMesh.getWorldPosition(P);var x=new THREE.Vector2(E.x,E.z),C=new THREE.Vector2(P.x,P.z);(x.distanceTo(C)<U.M.EPS||Math.abs(C.x)<U.M.EPS&&Math.abs(C.y)<U.M.EPS)&&E.add(new THREE.Vector3(0,0,.001)),U.M.LookAt(this.protractorMesh,E),this.protractorMesh.rotateZ(THREE.Math.degToRad(270)),this.rotationRingMesh.position.copy(S),this.rotationRingMesh.quaternion.copy(_),this.rotationLine.position.copy(S),this.rotationLine.quaternion.copy(_);var k=window.pageXOffset||document.documentElement.scrollLeft,M=window.pageYOffset||document.documentElement.scrollTop,D=this.WorldToScreen(S.x,S.y,S.z),A=this.boundingRect.x+D.x+k-15,I=this.boundingRect.y+D.y+M-15;this.rotationText.style.transform="translate3d(".concat(A,"px,").concat(I,"px,0px)"),this.rotationText.innerHTML="".concat(0,"&#176;"),this.rotationRaycastPlane.position.copy(S),this.rotationRaycastPlane.quaternion.copy(_),this.objectUpDirectionBasedOnAxis=new THREE.Vector3(0,1,0).applyQuaternion(_),this.SetRotationVisibility(!0,!0),this.dragging=!0}else this.isRotating=!1,this.rotationAxis=null,this.rotationAxisSide=null,this.dragging=!1,this.SetRotationVisibility(!1,!0)}this.panEnabled&&!this.isRotating&&(this.panningRaycastPlanes.length>0?this.IntersectObjects(e,t,[this.object])&&(this.mEditor.dispatchEvent(j.Gw.TransformControlChanged,this.object),this.isPanning=!0):b.qL.warn("TransformControls: Raycast plane for panning is not defined!")),this.Update(),this.mEditor.dispatchEvent(j.Gw.RequestFrame)}}},{key:"OnMouseUp",value:function(e,t){this.object&&this.enabled&&(this.isPanning=!1,this.isRotating=!1,this.mousedown=!1,this.rotationEnabled&&null!==this.rotationAxis&&this.SetRotationVisibility(!1,!0),this.dragging=!1,this.rotationAxis=null,this.rotationAxisSide=null,this.rotationRingMesh.visible=!1,this.rotationLine.visible=!1,this.rotationOffset=0,this.previousRotation=null,this.Update(),this.mEditor.dispatchEvent(j.Gw.RequestFrame))}},{key:"CalculateUVCoordPlane",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new THREE.Vector3(0,1,0),r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new THREE.Quaternion,o=n.clone(),i=new THREE.Vector3;e.getWorldDirection(i),i.applyQuaternion(r),Math.abs(i.x-o.x)<U.M.EPS&&Math.abs(i.y-o.y)<U.M.EPS&&Math.abs(i.z-o.z)<U.M.EPS&&o.applyAxisAngle(new THREE.Vector3(1,0,0),THREE.Math.degToRad(90));var a=new THREE.Vector3;e.getWorldPosition(a);var u=i.clone().cross(o),c=i.clone(),s=new THREE.Plane(c),l=new THREE.Vector3;s.projectPoint(t,l);var f=new THREE.Vector3;s.projectPoint(a,f);var p=o.dot(l),d=u.dot(l),h=o.dot(f),y=u.dot(f),m=new THREE.Vector2(p,d).sub(new THREE.Vector2(h,y)).normalize();return m}},{key:"GetObjectsSnappedRotation",value:function(e,t,n,r,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=this.protractorGroup.scale.x,u=this.protractorRadius*a*2,c=n,s=0,l=r.distanceTo(o),f=THREE.Math.clamp(l/u*c,s,c),p=c-f,d=360-U.M.Arctangent(0,0,e.x,e.y),h=THREE.Math.radToDeg(this.SnapToDegrees(THREE.Math.degToRad(d),THREE.Math.degToRad(t),THREE.Math.degToRad(p),THREE.Math.degToRad(i)));return h}},{key:"getCellPosition",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=t.clone().multiply((new THREE.Quaternion).setFromEuler(new THREE.Euler(-.5*Math.PI,0,0))),i=new THREE.Vector3(n,0,r).addScalar(1e-5),a=i.clone().applyQuaternion(o),u=i.clone().multiplyScalar(.5).applyQuaternion(o);return(new THREE.Vector3).copy(e).divide(a).floor().multiply(a).add(u)}},{key:"OnMouseMove",value:function(e,t){var n=this;if(this.object&&this.enabled){if(this.panEnabled&&this.isPanning&&!this.isRotating&&this.mousedown&&this.panningRaycastPlanes.length>0){var r=this.panningRaycastPlanes.map((function(e){return e.plane})),o=this.IntersectObjects(e,t,r);if(o){var i=this.panningRaycastPlanes.find((function(e){return e.plane.id===o.object.id})),a=new THREE.Quaternion;i.plane.getWorldQuaternion(a);var u=this.getCellPosition(o.point,a,i.cellWidth,i.cellHeight),c=this.getCellPosition(this.object.position,a,i.cellWidth,i.cellHeight);if(u.clone().sub(c).lengthSq()>U.M.EPS){var s=u,l=o.face.normal.clone().applyQuaternion(o.object.quaternion),f=U.M.RotateBasedOnUpAxis(this.object.quaternion.clone(),l);this.InterceptPanning(c.clone(),s.clone()).then((function(){n.mEditor.execute(new F.N(n.object,s.clone(),c.clone())),n.mEditor.execute(new J.aV(n.object,(new THREE.Euler).setFromQuaternion(f),n.object.rotation.clone())),n.mEditor.dispatchEvent(j.Gw.TransformControlChanged,n.object)}),(function(){}))}}}if(this.rotationEnabled&&!this.isPanning&&null!==this.rotationAxis&&this.dragging){var p=this.IntersectObjects(e,t,[this.rotationRaycastPlane]);if(p){this.mEditor.dispatchEvent(j.Gw.TransformControlChanged,this.object);var d=new THREE.Quaternion;this.object.getWorldQuaternion(d);var h=new THREE.Vector3;this.object.getWorldPosition(h),this.object.updateMatrixWorld(!0),this.camera.updateMatrixWorld(!0);var y=(new THREE.Matrix4).extractRotation(this.object.matrixWorld),m=(new THREE.Quaternion).setFromRotationMatrix(y),v=new THREE.Vector3;this.boundingBoxObject.getCenter(v),v.applyQuaternion(this.object.quaternion);var b=h.clone().add(v),g=null===this.previousRotation,w=this.CalculateUVCoordPlane(this.protractorMesh,p.point,this.protractorMesh.up),_=360-U.M.Arctangent(0,0,w.x,w.y),O=this.GetObjectsSnappedRotation(w,30,10,p.point,this.rotationRaycastPlane.position),T=this.GetRotationOffset(O,_);Math.abs(T)>11&&(T=0);var R=this.CalculateUVCoordPlane(this.rotationRaycastPlane,p.point,this.objectUpDirectionBasedOnAxis),S=360-U.M.Arctangent(0,0,R.x,R.y);S+=T,S=Math.round(S);var E=0;g&&(this.originalRotation=this.SetToClosestBy(S,[0,90,180,270,360])%360,this.previousRotation=S,this.previousUVCoord.copy(R),E=this.GetRotationOffset(S-this.originalRotation,S-this.previousRotation));var P=(S-this.previousRotation+E)%360;if(m.setFromRotationMatrix(y),this.rotationAxis===Y.X?m.multiplyQuaternions(m,(new THREE.Quaternion).setFromAxisAngle(this.UnitX,THREE.Math.degToRad(this.rotationAxisSide===Z.POSITIVE?P:-P))):this.rotationAxis===Y.Y?m.multiplyQuaternions(m,(new THREE.Quaternion).setFromAxisAngle(this.UnitY,THREE.Math.degToRad(this.rotationAxisSide===Z.NEGATIVE?-P:P))):this.rotationAxis===Y.Z&&m.multiplyQuaternions(m,(new THREE.Quaternion).setFromAxisAngle(this.UnitZ,THREE.Math.degToRad(this.rotationAxisSide===Z.POSITIVE?P:-P))),null!==this.rotationAxis){this.rotationOffset+=this.GetRotationOffset(S,this.previousRotation),this.rotationOffset+=E,this.rotationOffset%=360;var x=this.rotationOffset>=0,C=0===this.originalRotation||180===this.originalRotation?90:270,k=S-this.originalRotation;x&&k<0&&(k+=360);var M=x?k:-(360-k);M%=360;var D=this.originalRotation-M+C;(D%=360)<0&&(D+=360),D=THREE.Math.degToRad(D);var A=b.distanceTo(this.camera.position)*this.sizeProtractor.scale;A=THREE.Math.clamp(A,this.sizeProtractor.min,this.sizeProtractor.max),this.protractorGroup.scale.set(A,A,A),this.InterceptRotating(m).then((function(){n.object.updateMatrix(),n.UpdateBoundingBox();var e=new THREE.Vector3;n.boundingBoxObject.getCenter(e);var t=n.object.quaternion.clone().conjugate().multiply(m),r=(new THREE.Matrix4).makeTranslation(e.x,e.y,e.z);r.multiply((new THREE.Matrix4).makeRotationFromQuaternion(t)),r.multiply((new THREE.Matrix4).makeTranslation(-e.x,-e.y,-e.z));var o=new THREE.Vector3,i=new THREE.Quaternion,a=new THREE.Vector3;if(n.object.matrix.multiply(r).decompose(o,i,a),n.mEditor.execute(new F.N(n.object,o,n.object.position.clone())),n.mEditor.execute(new K(n.object,i,n.object.quaternion.clone())),n.mEditor.execute(new X.U(n.object,a,n.object.scale.clone())),n.object.updateMatrix(),n.rotationText.innerHTML="".concat(Math.abs(Math.round(M)),"&#176;"),Math.abs(M)>1e-5){var u=new THREE.RingGeometry(n.protractorRadius*A-n.ringThickness*A,n.protractorRadius*A,64,1,D,THREE.Math.degToRad(M));n.rotationRingMesh.geometry.vertices=u.vertices,n.rotationRingMesh.geometry.faces=u.faces,n.rotationRingMesh.geometry.lineDistancesNeedUpdate=!0,n.rotationRingMesh.geometry.verticesNeedUpdate=!0,n.rotationRingMesh.geometry.elementsNeedUpdate=!0,n.rotationRingMesh.visible=!0}else n.rotationRingMesh.visible=!1;var c=THREE.Math.degToRad(360-(S-90)),s=new THREE.Geometry;s.vertices.push(new THREE.Vector3(0,0,0)),s.vertices.push(new THREE.Vector3(Math.cos(c)*(n.protractorRadius*A),Math.sin(c)*(n.protractorRadius*A),0)),n.rotationLine.geometry.vertices=s.vertices,n.rotationLine.geometry.faces=s.faces,n.rotationLine.geometry.lineDistancesNeedUpdate=!0,n.rotationLine.geometry.verticesNeedUpdate=!0,n.rotationLine.geometry.elementsNeedUpdate=!0,n.rotationLine.visible=!0,n.mEditor.dispatchEvent(j.Gw.TransformControlChanged,n.object)}),(function(){})),this.previousRotation=S,this.previousUVCoord.copy(R)}}}}}},{key:"OnWindowResize",value:function(e,t){var n=this;setTimeout((function(){try{var e=n.domElement.getBoundingClientRect();n.boundingRect.set(e.left,e.top,e.width,e.height)}catch(e){b.qL.error(e)}}),50)}},{key:"SetRotationVisibility",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.visible=!(!e&&!t),this.protractorGroup&&(this.protractorGroup.visible=e),this.rotationText&&(this.rotationText.style.display=e?"block":"none"),this.arrowsVisible=t?!e:e,this.IsRotationAxisEnabled(Y.X)||this.IsRotationAxisEnabled(Y.Y)||this.IsRotationAxisEnabled(Y.Z)||(this.arrowsVisible=!1);for(var n=0;n<this.arrowAxisXMesh.length;n++)this.arrowAxisXMesh[n]&&(this.arrowAxisXMesh[n].visible=!!this.IsRotationAxisEnabled(Y.X)&&this.arrowsVisible);for(var r=0;r<this.arrowAxisYMesh.length;r++)this.arrowAxisYMesh[r]&&(this.arrowAxisYMesh[r].visible=!!this.IsRotationAxisEnabled(Y.Y)&&this.arrowsVisible);for(var o=0;o<this.arrowAxisZMesh.length;o++)this.arrowAxisZMesh[o]&&(this.arrowAxisZMesh[o].visible=!!this.IsRotationAxisEnabled(Y.Z)&&this.arrowsVisible);null!=this.mEditor&&this.mEditor.dispatchEvent(j.Gw.RequestFrame)}},{key:"RepositionArrows",value:function(){this.object&&this.UpdateBoundingBox();var e=new THREE.Vector3;this.boundingBoxObject.getSize(e);for(var t=e.x,n=e.y,r=e.z,o=.5*t+.025,i=.5*n+.025,a=.5*r+.025,u=[new THREE.Vector3(0,i,0),new THREE.Vector3(0,0,a),new THREE.Vector3(0,-i,0),new THREE.Vector3(0,0,-a)],c=0;c<this.arrowAxisXMesh.length;c++)this.arrowAxisXMesh[c].position.set(c<4?-.5*t:.5*t,u[c%4].y,u[c%4].z);u=[new THREE.Vector3(0,0,a),new THREE.Vector3(-o,0,0),new THREE.Vector3(0,0,-a),new THREE.Vector3(o,0,0)];for(var s=0;s<this.arrowAxisYMesh.length;s++)this.arrowAxisYMesh[s].position.set(u[s%4].x,s<4?.5*n:-.5*n,u[s%4].z);u=[new THREE.Vector3(0,i,0),new THREE.Vector3(-o,0,0),new THREE.Vector3(0,-i,0),new THREE.Vector3(o,0,0)];for(var l=0;l<this.arrowAxisZMesh.length;l++)this.arrowAxisZMesh[l].position.set(u[l%4].x,u[l%4].y,l<4?-.5*r:.5*r)}},{key:"CreateArrows",value:function(){var e=this.gizmoArrowTextures[0],t=this.gizmoArrowTextures.length>1?this.gizmoArrowTextures[1]:this.gizmoArrowTextures[0],n=this.gizmoArrowTextures.length>2?this.gizmoArrowTextures[2]:null;null===n&&(n=this.gizmoArrowTextures.length>1?this.gizmoArrowTextures[1]:this.gizmoArrowTextures[0]);for(var r=[THREE.Math.degToRad(0),THREE.Math.degToRad(90),THREE.Math.degToRad(180),THREE.Math.degToRad(270)],o=[THREE.Math.degToRad(90),THREE.Math.degToRad(270)],i=[],a=[Z.NEGATIVE,Z.POSITIVE],u=0;u<8;u++)this.arrowAxisXMesh.push(new THREE.Mesh(new THREE.PlaneGeometry(.05,.05,1,1),new THREE.MeshBasicMaterial({color:16777215,transparent:!0,opacity:.5,map:e.clone(),depthTest:!1,depthWrite:!1,side:THREE.FrontSide}))),this.arrowAxisXMesh[u].material.map.needsUpdate=!0,this.arrowAxisXMesh[u].quaternion.multiplyQuaternions((new THREE.Quaternion).setFromAxisAngle(this.UnitX,r[u%4]),(new THREE.Quaternion).setFromAxisAngle(this.UnitY,o[Math.floor(u/4)])),this.arrowAxisXMesh[u].frustumCulled=!1,this.arrowAxisXMesh[u].name="TransformControls-gizmo-arrow-x",this.arrowAxisXMesh[u].visible=this.rotationEnabled&&this.arrowsVisible&&this.IsRotationAxisEnabled(Y.X),this.arrowAxisXMesh[u].userData.AxisSide=a[Math.floor(u/4)];r=[THREE.Math.degToRad(90),THREE.Math.degToRad(270)],i=[THREE.Math.degToRad(0),THREE.Math.degToRad(90),THREE.Math.degToRad(180),THREE.Math.degToRad(270),THREE.Math.degToRad(180),THREE.Math.degToRad(90),THREE.Math.degToRad(0),THREE.Math.degToRad(270)],a=[Z.POSITIVE,Z.NEGATIVE];for(var c=0;c<8;c++)this.arrowAxisYMesh.push(new THREE.Mesh(new THREE.PlaneGeometry(.05,.05,1,1),new THREE.MeshBasicMaterial({color:16777215,transparent:!0,opacity:.5,map:t.clone(),depthTest:!1,depthWrite:!1,side:THREE.FrontSide}))),this.arrowAxisYMesh[c].material.map.needsUpdate=!0,this.arrowAxisYMesh[c].quaternion.multiplyQuaternions((new THREE.Quaternion).setFromAxisAngle(this.UnitX,r[Math.floor(c/4)]),(new THREE.Quaternion).setFromAxisAngle(this.UnitZ,i[c])),this.arrowAxisYMesh[c].frustumCulled=!1,this.arrowAxisYMesh[c].name="TransformControls-gizmo-arrow-y",this.arrowAxisYMesh[c].visible=this.rotationEnabled&&this.arrowsVisible&&this.IsRotationAxisEnabled(Y.Y),this.arrowAxisYMesh[c].userData.AxisSide=a[Math.floor(c/4)];o=[THREE.Math.degToRad(0),THREE.Math.degToRad(180)],i=[THREE.Math.degToRad(0),THREE.Math.degToRad(90),THREE.Math.degToRad(180),THREE.Math.degToRad(270),THREE.Math.degToRad(0),THREE.Math.degToRad(270),THREE.Math.degToRad(180),THREE.Math.degToRad(90)],a=[Z.NEGATIVE,Z.POSITIVE];for(var s=0;s<8;s++)this.arrowAxisZMesh.push(new THREE.Mesh(new THREE.PlaneGeometry(.05,.05,1,1),new THREE.MeshBasicMaterial({color:16777215,transparent:!0,opacity:.5,map:n.clone(),depthTest:!1,depthWrite:!1,side:THREE.FrontSide}))),this.arrowAxisZMesh[s].material.map.needsUpdate=!0,this.arrowAxisZMesh[s].quaternion.multiplyQuaternions((new THREE.Quaternion).setFromAxisAngle(this.UnitY,o[Math.floor(s/4)]),(new THREE.Quaternion).setFromAxisAngle(this.UnitZ,i[s])),this.arrowAxisZMesh[s].frustumCulled=!1,this.arrowAxisZMesh[s].name="TransformControls-gizmo-arrow-z",this.arrowAxisZMesh[s].visible=this.rotationEnabled&&this.arrowsVisible&&this.IsRotationAxisEnabled(Y.Z),this.arrowAxisZMesh[s].userData.AxisSide=a[Math.floor(s/4)];this.RepositionArrows()}},{key:"IntersectObjects",value:function(e,t,n){var r=this.boundingRect.z,o=this.boundingRect.w;return this.mouse.set(e/r*2-1,-t/o*2+1),this.raycaster.setFromCamera(this.mouse,this.camera),this.raycaster.intersectObjects(n,!0)[0]}},{key:"HasObject",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?this.object&&this.object.id===e.id:!!this.object}},{key:"SnapToDegrees",value:function(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=2*Math.PI,i=null!=n?n:Math.PI/48,a=null!=t?t:Math.PI/12,u=Math.floor(o/a),c=i,s=0;s<u;s++){var l=a*s;if(Math.abs(e+r-l)<c||e+r+c>=o){e=l;break}}return e}},{key:"SetToClosestBy",value:function(e,t){for(var n=t[0],r=0;r<t.length;r++)Math.abs(e-t[r])<Math.abs(e-n)&&(n=t[r]);return n}},{key:"WorldToScreen",value:function(e,t,n){var r=new THREE.Vector3(e,t,n);return r.project(this.camera),new THREE.Vector2(Math.round((r.x+1)*this.boundingRect.z/2),Math.round(-(r.y-1)*this.boundingRect.w/2))}},{key:"GetRotationOffset",value:function(e,t){return t>=270&&e<=90?e-(t-360):e>=270&&t<=90?e-360-t:e-t}},{key:"OnBeforeMouseDown",value:function(e){try{var t=this.domElement.getBoundingClientRect();this.boundingRect.set(t.left,t.top,t.width,t.height)}catch(e){b.qL.error("OnBeforeMouseDown:",e)}var n=e.changedTouches?e.changedTouches[0]:e;this.OnMouseDown(n.clientX-this.boundingRect.x,n.clientY-this.boundingRect.y)}},{key:"OnBeforeMouseUp",value:function(e){try{var t=this.domElement.getBoundingClientRect();this.boundingRect.set(t.left,t.top,t.width,t.height)}catch(e){b.qL.error("OnBeforeMouseUp:",e)}var n=e.changedTouches?e.changedTouches[0]:e;this.OnMouseUp(n.clientX-this.boundingRect.x,n.clientY-this.boundingRect.y)}},{key:"OnBeforeMouseMove",value:function(e){try{var t=this.domElement.getBoundingClientRect();this.boundingRect.set(t.left,t.top,t.width,t.height)}catch(e){b.qL.error("OnBeforeMouseMove:",e)}var n=e.changedTouches?e.changedTouches[0]:e;this.OnMouseMove(n.clientX-this.boundingRect.x,n.clientY-this.boundingRect.y)}},{key:"InterceptPanning",value:(i=ne(regeneratorRuntime.mark((function e(t,n){var r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,o){if(r.panInterceptors.length<=0)return e();I.ResolveInterceptors(r.panInterceptors,{position:t,newPosition:n}).then((function(){e()}),(function(e){o(e)})).catch((function(e){b.qL.error("Transform: Intercept panning error: ",e),o(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(e,t){return i.apply(this,arguments)})},{key:"InterceptRotating",value:(o=ne(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){if(n.rotationInterceptors.length<=0)return e();I.ResolveInterceptors(n.rotationInterceptors,t).then((function(t){e()}),(function(e){r(e)})).catch((function(e){b.qL.error("Transform: Intercept rotating error:",e),r(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(e){return o.apply(this,arguments)})},{key:"AddInterceptorPanning",value:function(e){if(null!=e){for(var t=0;t<this.panInterceptors.length;t++)if(this.panInterceptors[t].equals(e))return;this.panInterceptors.push(e)}}},{key:"RemoveInterceptorPanning",value:function(e){if(null!=e)for(var t=0;t<this.panInterceptors.length;t++)if(this.panInterceptors[t].equals(e)){this.panInterceptors.splice(t,1);break}}},{key:"AddInterceptorRotating",value:function(e){if(null!=e){for(var t=0;t<this.rotationInterceptors.length;t++)if(this.rotationInterceptors[t].equals(e))return;this.rotationInterceptors.push(e)}}},{key:"RemoveInterceptorRotating",value:function(e){if(null!=e)for(var t=0;t<this.panInterceptors.length;t++)if(this.rotationInterceptors[t].equals(e)){this.rotationInterceptors.splice(t,1);break}}},{key:"LoadTexture",value:function(e,t){var n=new THREE.TextureLoader;return n.setCrossOrigin(""),n.load(e,t,(function(){}),(function(t){b.qL.error("Couldn't load texture(".concat(e,"). Error:"),t)}))}}],r&&ie(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),s}(g.V);function le(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}se.TypeRTTI=new w.r("ViewportControllerFloorplannerTransformControls",g.V.TypeRTTI),__webpack_require__(15306);var fe=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r;return t=e,r=[{key:"selectDom",value:function(e){return"string"==typeof e?(e=e.replace(/^\s*/,"").replace(/\s*$/,""),document.querySelector(e)):e&&e.nodeName?e:e&&e.length>0?e[0]:e}},{key:"createElement",value:function(e){return document.createElement(e)}},{key:"setStyle",value:function(e,t,r){if(!(0,n.isNullOrUndefined)(e))return"string"!=typeof t||(0,n.isUndefined)(r)?Object.keys(t).forEach((function(n){e.style[n]=t[n]})):e.style[t]=r,e}},{key:"getStyle",value:function(e,t){return e.style[t]}},{key:"setAttribute",value:function(e,t,n){return e.setAttribute(t,n),e}},{key:"setHtml",value:function(e,t){return e.innerHTML=t||"",e}},{key:"emptyHtml",value:function(e){for(;e.firstChild;)e.removeChild(e.firstChild);return e}},{key:"append",value:function(e,t){return e.appendChild(t),t}},{key:"on",value:function(e,t,n){var r=function(e){return n.apply(this,[e].concat(e.detail||[]))};e.addEventListener(t,r),e._e=e._e||{},e._e[t]=e._e[t]||[],e._e[t].push(r)}},{key:"off",value:function(e,t){e._e=e._e||{},(e._e[t]?e._e[t]:[]).forEach((function(n){e.removeEventListener(t,n)})),e._e[t]=[]}}],null&&le(t.prototype,null),r&&le(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),pe=__webpack_require__(82417),de=__webpack_require__(63438),he=__webpack_require__(3283),ye=__webpack_require__(45689),me=__webpack_require__(73463),ve=__webpack_require__(68009),be=(__webpack_require__(69600),__webpack_require__(18743)),ge=__webpack_require__(4530);function we(e){return we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},we(e)}function _e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Oe(e,t){return Oe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Oe(e,t)}function Te(e,t){if(t&&("object"===we(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Re(e){return Re=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Re(e)}var Se=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Oe(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Re(r);if(o){var n=Re(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Te(this,e)});function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.call(this,e)}return t=a,(n=[{key:"OnAttached",value:function(){this.mEditor=this.getParentObject().getEditor(),this.mSettings=this.mEditor.getSettings()}},{key:"getType",value:function(){return a.TypeRTTI}}])&&_e(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(be.H);Se.TypeRTTI=new ge.rz("ToolbarComponent",be.H.TypeRTTI),__webpack_require__(94986);var Ee=__webpack_require__(29844);function Pe(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function xe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var je=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,o,i;return t=e,null,r=[{key:"resolveWebArFiles",value:function(e,t){var r=e.find((function(e){var n=e.substr(e.lastIndexOf(".")+1);return"usdz"===t?"usdz"===n:"gltf"!==t||"gltf"===n||"glb"===n}));if((0,n.isNullOrUndefined)(r))throw"File not found.";return r}},{key:"requestNewArFile",value:(o=regeneratorRuntime.mark((function e(t,n,r,o){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,i){Ee.O.getInstance().post("".concat(N.E.apiUrl,"ar/request"),{esd:r,hash:n,catalogue_id:t,format:o}).then((function(t){if("complete"===t.data.status)e(t.data.files);else if("in_progress"===t.data.status)var r=setInterval((function(){Ee.O.getInstance().get("".concat(N.E.apiUrl,"ar/check/").concat(n)).then((function(t){return"complete"===t.data.status?(clearInterval(r),e(t.data.files)):"not_processing"===t.data.status||"failed"===t.data.status?(clearInterval(r),i()):void 0}),(function(e){return clearInterval(r),i(e)}))}),1e3);else i()}),(function(e){i(e)}))})));case 1:case"end":return e.stop()}}),e)})),i=function(){var e=this,t=arguments;return new Promise((function(n,r){var i=o.apply(e,t);function a(e){Pe(i,n,r,a,u,"next",e)}function u(e){Pe(i,n,r,a,u,"throw",e)}a(void 0)}))},function(e,t,n,r){return i.apply(this,arguments)})}],r&&xe(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Ce=(__webpack_require__(66342),__webpack_require__(62962),__webpack_require__(23748),__webpack_require__(64211),__webpack_require__(41874),__webpack_require__(83937)),ke=__webpack_require__(33314),Me=__webpack_require__(83348),De=__webpack_require__(42615),Ae=__webpack_require__(18170),Ie=__webpack_require__(79843),Ne=__webpack_require__(84217),Ve=__webpack_require__(29514),Ue=__webpack_require__(94130),Fe=__webpack_require__(89002),Be=__webpack_require__(87181),Le=__webpack_require__(48155);function He(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ze(e){return ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ze(e)}function qe(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=We(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw i}}}}function Ge(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,u=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){u=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(u)throw o}}return i}}(e,t)||We(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function We(e,t){if(e){if("string"==typeof e)return Qe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Qe(e,t):void 0}}function Qe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ke(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function Ye(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Ke(i,r,o,a,u,"next",e)}function u(e){Ke(i,r,o,a,u,"throw",e)}a(void 0)}))}}function Ze(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Xe,Je=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,o;return t=e,null,r=[{key:"exportEsd",value:(o=Ye(regeneratorRuntime.mark((function t(r,o){var i,a,u=this,c=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=c.length>2&&void 0!==c[2]&&c[2],a=N.E.cacheUrl,t.abrupt("return",new Promise((function(t,c){if((0,n.isNullOrUndefined)(r))return c("Editor not defined");try{var s={products:[],materials:[],geometries:[],attachments:[],main_camera_id:-1,cameras:[],lights:[],scene:void 0},l=r.getScene();if(!(0,n.isNullOrUndefined)(l)){var f=r.getSettings().getSceneSettings().esd_scene_scale,p=l.scale.clone().multiplyScalar(f);l.updateMatrix();var d=l.matrix.toArray();s.scene={matrix:d,position:[l.position.x,l.position.y,l.position.z],quaternion:[l.quaternion.x,l.quaternion.y,l.quaternion.z,l.quaternion.w],rotation:[l.rotation.x,l.rotation.y,l.rotation.z],scale:[p.x,p.y,p.z]}}var h=r.getCamera(),y=new THREE.PerspectiveCamera(30,1,.001,1e3);if(y.position.copy(h.position),y.quaternion.copy(h.quaternion),y.scale.copy(h.scale),y.zoom=1,y.updateMatrixWorld(!0),y.updateProjectionMatrix(),!(0,n.isNullOrUndefined)(y)){var m=[];y.updateMatrix();var v=y.matrix.toArray();y instanceof THREE.PerspectiveCamera?m.push({id:y.id,type:"PerspectiveCamera",matrix:v,position:[y.position.x,y.position.y,y.position.z],rotation:[y.rotation.x,y.rotation.y,y.rotation.z],quaternion:[y.quaternion.x,y.quaternion.y,y.quaternion.z,y.quaternion.w],scale:[y.scale.x,y.scale.y,y.scale.z],fov:y.fov,aspect:y.aspect,far:y.far,near:y.near,zoom:y.zoom}):y instanceof THREE.OrthographicCamera&&m.push({id:y.id,type:"OrthographicCamera",matrix:v,position:[y.position.x,y.position.y,y.position.z],rotation:[y.rotation.x,y.rotation.y,y.rotation.z],quaternion:[y.quaternion.x,y.quaternion.y,y.quaternion.z,y.quaternion.w],scale:[y.scale.x,y.scale.y,y.scale.z],left:y.left,right:y.right,top:y.top,bottom:y.bottom,far:y.far,near:y.near,zoom:y.zoom}),s.cameras=m,s.main_camera_id=y.id}var g=r.getSceneManager().findNodesOfType(Ce.J.TypeRTTI),w=[];Array.isArray(g)&&g.length>0&&(g.forEach((function(e){var t={position:[e.getValue("position_x"),e.getValue("position_y"),e.getValue("position_z")],color:e.getValue("light_color").getHex(),intensity:e.getValue("light_intensity"),cast_shadow:e.getValue("cast_shadow")};switch(e.getType().getTypeName()){case ke.p2.TypeRTTI.getTypeName():t.type="SpotLight",t.distance=e.getValue("light_distance"),t.angle=e.getValue("light_angle"),t.penumbra=e.getValue("light_penumbra"),t.decay=e.getValue("light_decay"),t.target=[e.getValue("target_x"),e.getValue("target_y"),e.getValue("target_z")];break;case ke.Cx.TypeRTTI.getTypeName():t.type="DirectionalLight",t.target=[e.getValue("target_x"),e.getValue("target_y"),e.getValue("target_z")];break;case ke.v6.TypeRTTI.getTypeName():t.type="HemisphereLight",t.groundColor=e.getValue("light_groundColor").getHex();break;case ke.mX.TypeRTTI.getTypeName():t.type="PointLight",t.distance=e.getValue("light_distance"),t.decay=e.getValue("light_decay");break;case ke.dG.TypeRTTI.getTypeName():t.type="AmbientLight";break;default:t.type=e.getType().getTypeName()}w.push(t)})),s.lights=w);var _=e._findProductNode(r);if(null===_)return c("Could not find product node");var O=r.getSceneManager().findNodesOfType(Me.L.TypeRTTI).map((function(e){return(0,De.D)(Ie.Q.getInstance().resolveBootstrapData(e.getValue("product_id")).pipe((0,Ne.q)(1)),(0,Ae.of)(e))}));(0,De.D)(O).subscribe((function(e){var r=[],l=e.map((function(e){return(0,De.D)(e[1].onConfigurableNodeReady.asObservable().pipe((0,Ve.P)()),(0,Ae.of)(e[0]),(0,Ae.of)(e[1]))}));(0,De.D)(l).subscribe(function(){var e=Ye(regeneratorRuntime.mark((function e(c){var l,f,p,d,h,y,m,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(c.map(function(){var e=Ye(regeneratorRuntime.mark((function e(t){var i,a,u,c,s,l,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Ge(t,3),a=i[0],i[1],u=i[2],c=u.getObjectUUID(),s=a.getObjectUUID(),e.next=5,a.resolveSceneOffsetManager();case 5:l=e.sent,f=l.getOffsets(),u.getObjectUUID()===_.getObjectUUID()&&((0,n.isNullOrUndefined)(o)||(c=o,s=o)),r.push({product_id:c,product:u,configurable_id:s,configurable:a,offsetGroups:f});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:l=[],f=[],p=[],d=[],h=qe(c),e.prev=7,m=regeneratorRuntime.mark((function e(){var t,o,c,s,h,m,v,g,w,_,O,T,R,S,E,P,x,j,C,k,M,D,A,I,N,V,U,F,B;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Ge(y.value,3),o=t[0],c=t[1],s=t[2],h=r.find((function(e){return e.product.getObjectUUID()===s.getObjectUUID()})),m=s.findParentOfType(Me.L.TypeRTTI),v=null,(0,n.isNullOrUndefined)(m)||(v=r.find((function(e){return e.product.getObjectUUID()===m.getObjectUUID()}))),w=(g=null===m)?h.configurable_id:h.product_id,_=Number(s.getValue("product_id")),null!==o){e.next=11;break}return b.qL.error("Failed to get configurable node"),e.abrupt("return",{v:void 0});case 11:if(O=Ue.FG.getItems(c.getMaterials()),T=Ue.FG.getItems(c.getMedia()),R={},O.forEach((function(e){R[e.id]=e})),S={},T.forEach((function(e){S[e.id]=e})),E=[],P=o.getBatches(),!(Array.isArray(P)&&P.length>0)){e.next=36;break}x=qe(P),e.prev=21,C=regeneratorRuntime.mark((function e(){var t,r,o,c,l,y,m,v,b,g,w,_,O,T,P,x,C,k,M,D,A,I,N,V,U,F,B,L;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=j.value,r=t.getOffsetNodes(),o=new THREE.Matrix4,r.forEach((function(e){var t=h.offsetGroups.findIndex((function(t){return t.id===e}));if(t>=0){var n=h.offsetGroups[t],r=new THREE.Vector3;Object.keys(n.levels).forEach((function(e){r.add(n.levels[e])}));var i=new THREE.Vector3,a=new THREE.Quaternion,u=new THREE.Vector3(1,1,1);n.matrix&&(new THREE.Matrix4).set(n.matrix[0],n.matrix[1],n.matrix[2],n.matrix[3],n.matrix[4],n.matrix[5],n.matrix[6],n.matrix[7],n.matrix[8],n.matrix[9],n.matrix[10],n.matrix[11],n.matrix[12],n.matrix[13],n.matrix[14],n.matrix[15]).decompose(i,a,u);var c=new THREE.Matrix4,s=(new THREE.Matrix4).makeTranslation(i.x,i.y,i.z);c.multiply(s);var l=(new THREE.Matrix4).makeRotationFromQuaternion(a.multiply(n.rotation));c.multiply(l);var f=(new THREE.Matrix4).makeScale(u.x,u.y,u.z);c.multiply(f);var p=(new THREE.Matrix4).makeTranslation(r.x,r.y,r.z);c.premultiply(p),o.multiply(c)}})),c=r.join("/"),l=c.length>0?c:"default_attachment",y=new THREE.Vector3,m=new THREE.Quaternion,v=new THREE.Vector3(1,1,1),o.decompose(y,m,v),b={id:l,name:l,visible:!0,matrix:o.toArray(),position:y.toArray(),quaternion:m.toArray(),rotation:(new THREE.Euler).setFromQuaternion(m).toVector3().toArray(),scale:v.toArray()},-1===d.findIndex((function(e){return e.id===l}))&&d.push(b),g=t.getMeshSource(),w=t.getMaterialId(),_=t.getMaterial(),e.next=17,Be.ResourceManagerService.getInstance().getManager(Be.ResourceManagerTypes.MaterialManager);case 17:return O=e.sent,T=t.getSharedKeyOverwriteMaterial()||s.getSceneObjectId(),e.next=21,O.resolveMaterialResourceById(w,void 0,T,void 0,s);case 21:if(P=e.sent,x={},C=R[w],k=void 0,(0,n.isNullOrUndefined)(C)){e.next=103;break}if(k=C.id,M=(0,n.isNullOrUndefined)(C.userdata)?void 0:C.userdata,D=(0,n.isNullOrUndefined)(M)||(0,n.isNullOrUndefined)(M.vray)?void 0:M.vray,A=function(e,t,n){if(!t)return e;var r=[];return t[n].toArray(r),255*r[0]<<16|255*r[1]<<8|255*r[2]},I=function(e,t,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;r.forEach((function(r){var i=!(0,n.isNullOrUndefined)(o)&&o.length>0,a=i?t[o][r]:t[r];if(!(0,n.isNullOrUndefined)(a)){var u=S[a];(0,n.isNullOrUndefined)(u)||(i?e[o][r]=u.lod0_url:e[r]=u.lod0_url)}}))},N=function(){var e=Ye(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.mMapOverwrite.forEach(function(){var e=Ye(regeneratorRuntime.mark((function e(n){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r[n.type]){e.next=2;break}return e.abrupt("return");case 2:if(!(n.textureId in S)){e.next=6;break}o=S[n.textureId],e.next=9;break;case 6:return e.next=8,Le.y.getInstance().resolveModel(n.textureId);case 8:o=e.sent;case 9:if(o){e.next=11;break}return e.abrupt("return");case 11:t[r[n.type]]=o.lod0_url;case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),!i||(0,n.isNullOrUndefined)(D)){e.next=47;break}x.id=C.id,x.name=D.name,x.type=D.type,(0,n.isNullOrUndefined)(D.base)||(x.base=D.base,I(x,D,["map","roughness_map","metalness_map","alpha_map","anisotropy_map"],"base")),(0,n.isNullOrUndefined)(D.reflection)||(x.reflection=D.reflection,I(x,D,["map","highlight_map","glossiness_map","fresnel_ior_map"],"reflection")),(0,n.isNullOrUndefined)(D.refraction)||(x.refraction=D.refraction,I(x,D,["map","glossiness_map","ior_map"],"refraction")),(0,n.isNullOrUndefined)(D.fog)||(x.fog=D.fog,I(x,D,["map"],"fog")),(0,n.isNullOrUndefined)(D.translucency)||(x.translucency=D.translucency,I(x,D,["filter_map"],"translucency")),(0,n.isNullOrUndefined)(D.self_illumination)||(x.self_illumination=D.self_illumination,I(x,D,["map"],"self_illumination")),(0,n.isNullOrUndefined)(D.normal)||(x.normal=D.normal,I(x,D,["map"],"normal")),(0,n.isNullOrUndefined)(D.bump)||(x.bump=D.bump,I(x,D,["map"],"bump")),(0,n.isNullOrUndefined)(D.displacement)||(x.displacement=D.displacement,I(x,D,["map"],"displacement")),e.next=102;break;case 47:if(x.id=C.id,x.physical=!1,x.name=C.name,x.type=C.type,x.alpha_test=C.alpha_test,x.blending=C.blending,x.depth_test=C.depth_test,x.depth_write=C.depth_write,x.fog=C.fog,x.lights=C.lights,x.opacity=C.opacity,x.premultiplied_alpha=C.premultiplied_alpha,x.shading=C.shading,x.side=C.side,x.transparent=C.transparent,x.ssrl=C.ssrl,!u.isBaseMaterial(C)){e.next=76;break}if(x.ao_map_intensity=C.ao_map_intensity,x.diffuse=A(C.color,_,"color"),x.light_map_intensity=C.light_map_intensity,x.texture_sx=C.texture_sx,x.texture_sy=C.texture_sy,x.refraction_ratio=C.refraction_ratio,x.wireframe=C.wireframe,x.wireframe_line=C.wireframe_line_width,I(x,C,["alpha_map","ao_map","env_map","light_map","map"]),!P){e.next=76;break}return e.next=76,N(x,P,(He(V={},Be.MaterialMapEnum.ALPHA,"alpha_map"),He(V,Be.MaterialMapEnum.AO,"ao_map"),He(V,Be.MaterialMapEnum.ENVIRONMENT,"env_map"),He(V,Be.MaterialMapEnum.LIGHTMAP,"light_map"),He(V,Be.MaterialMapEnum.DIFFUSE,"map"),V));case 76:if(!u.isStandardMaterial(C)){e.next=87;break}if(x.emissive=C.emissive,x.emissive_map_intensity=C.emissive_map_intensity,x.bump_scale=C.bump_scale,x.displacement_scale=C.displacement_scale,x.displacement_bias=C.displacement_bias,x.normal_scale=C.normal_scale,I(x,C,["emissive_map","bump_map","displacement_map","normal_map"]),!P){e.next=87;break}return e.next=87,N(x,P,(He(U={},Be.MaterialMapEnum.EMISSIVE,"emissive_map"),He(U,Be.MaterialMapEnum.BUMP,"bump_map"),He(U,Be.MaterialMapEnum.DISPLACEMENT,"displacement_map"),He(U,Be.MaterialMapEnum.NORMAL,"normal_map"),U));case 87:if(u.hasMaterialReflectivity(C)&&(x.reflectivity=C.reflectivity),!u.isMaterialStandardPhysical(C)){e.next=97;break}if(x.physical=!0,x.metalness=C.metalness,x.roughness=C.roughness,x.env_map_intensity=C.env_map_intensity,I(x,C,["metalness_map","roughness_map"]),!P){e.next=97;break}return e.next=97,N(x,P,(He(F={},Be.MaterialMapEnum.METALNESS,"metalness_map"),He(F,Be.MaterialMapEnum.ROUGHNESS,"roughness_map"),F));case 97:u.isMaterialBasicPhong(C)&&(x.physical=!1,x.combine=C.combine,I(x,C,["specular_map"])),u.isMaterialPhysical(C)&&(x.clear_coat=C.clear_coat,x.clear_coat_roughness=C.clear_coat_roughness),u.isMaterialPhong(C)&&(x.shininess=C.shininess,x.specular=C.specular),u.isMaterialExtended(C)&&(x.enable_fresnel_diff=C.enable_fresnel_diff,x.fresnel_diff_bias=C.fresnel_diff_bias,x.fresnel_diff_scale=C.fresnel_diff_scale,x.fresnel_diff_power=C.fresnel_diff_power,x.fresnel_diff_color_left=C.fresnel_diff_color_left,x.enable_fresnel_env=C.enable_fresnel_env,x.fresnel_env_bias=C.fresnel_env_bias,x.fresnel_env_scale=C.fresnel_env_scale,x.fresnel_env_power=C.fresnel_env_power),u.isMaterialPhongExt(C)&&(x.env_map_scale=C.env_map_scale);case 102:f.some((function(e){return!(0,n.isUndefined)(e.id)&&e.id===k}))||f.push(x);case 103:(0,n.isNullOrUndefined)(g)||p.some((function(e){return e.id===g}))||(B={id:g,data:a+g},p.push(B)),L="".concat(l,"_").concat(g,"_").concat(k),E.push({id:L,attachment_id:l,geometry_id:g,material_id:k});case 106:case"end":return e.stop()}}),e)})),x.s();case 24:if((j=x.n()).done){e.next=28;break}return e.delegateYield(C(),"t0",26);case 26:e.next=24;break;case 28:e.next=33;break;case 30:e.prev=30,e.t1=e.catch(21),x.e(e.t1);case 33:return e.prev=33,x.f(),e.finish(33);case 36:k="root_"+w,-1===d.findIndex((function(e){return e.id==k}))&&(M=g?o.getValue("position"):o.getParent().getValue("position"),D=g?o.getValue("rotation"):o.getParent().getValue("rotation"),A=(new THREE.Quaternion).setFromEuler(D),I=g?o.getValue("scale"):o.getParent().getValue("scale"),N=(new THREE.Matrix4).compose(M,A,I),V=N.toArray(),d.push({id:k,name:(0,n.isNullOrUndefined)(o.getValue("name"))?"attachment_"+k:o.getValue("name"),visible:!0,matrix:V,position:[M.x,M.y,M.z],quaternion:[A.x,A.y,A.z,A.w],rotation:[D.x,D.y,D.z],scale:[I.x,I.y,I.z]})),U=null,(0,n.isNullOrUndefined)(v)||(F=null==m.findParentOfType(Me.L.TypeRTTI),B=r.find((function(e){return e.product_id==v.product_id})),U=(0,n.isNullOrUndefined)(B)?null:F?B.configurable_id:B.product_id),l.push({id:w,catalogue_id:_,parent_id:U,data:E,attachment_id:k});case 41:case"end":return e.stop()}}),e,null,[[21,30,33,36]])})),h.s();case 10:if((y=h.n()).done){e.next=17;break}return e.delegateYield(m(),"t0",12);case 12:if("object"!==ze(v=e.t0)){e.next=15;break}return e.abrupt("return",v.v);case 15:e.next=10;break;case 17:e.next=22;break;case 19:e.prev=19,e.t1=e.catch(7),h.e(e.t1);case 22:return e.prev=22,h.f(),e.finish(22);case 25:return s.products=l,s.materials=f,s.geometries=p,s.attachments=d,e.abrupt("return",t(s));case 30:case"end":return e.stop()}}),e,null,[[7,19,22,25]])})));return function(t){return e.apply(this,arguments)}}(),(function(e){return b.qL.error("Failed to retrieve configurable nodes: ",e),c(e)}))}),(function(e){return b.qL.error("Failed to retrieve managers: ",e),c(e)}))}catch(e){return c(e)}})));case 3:case"end":return t.stop()}}),t)}))),function(e,t){return o.apply(this,arguments)})},{key:"_findProductNode",value:function(e,t){var r=null;if((0,n.isNullOrUndefined)(t))r=e.getSceneManager().getActiveProductNode();else{var o=e.getSceneManager().findNodesOfType(Me.L.TypeRTTI),i=null;Fe.F.isUUID(t)&&(i=t),o.every((function(e){return!(null!==i&&e.getObjectUUID()===i||null===i&&e.getSceneObjectId()==t)||(r=e,!1)}))}return r}},{key:"isBaseMaterial",value:function(e){return/(Standard|Physical|Basic|Phong)/i.test(e.type)}},{key:"isStandardMaterial",value:function(e){return/(Standard|Physical|Phong)/i.test(e.type)}},{key:"hasMaterialReflectivity",value:function(e){return/(Basic|Physical|Phong)/i.test(e.type)}},{key:"isMaterialBasicPhong",value:function(e){return/(Basic|Phong)/i.test(e.type)}},{key:"isMaterialStandardPhysical",value:function(e){return/(Standard|Physical)/i.test(e.type)}},{key:"isMaterialPhysical",value:function(e){return/(Physical)/i.test(e.type)}},{key:"isMaterialPhong",value:function(e){return/(Phong)/i.test(e.type)}},{key:"isMaterialExtended",value:function(e){return/(PhongExt|PhysicalExt)/i.test(e.type)}},{key:"isMaterialPhongExt",value:function(e){return/(PhongExt)/i.test(e.type)}}],r&&Ze(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),$e=__webpack_require__(51390),et=(__webpack_require__(27479),__webpack_require__(87714),__webpack_require__(82801),__webpack_require__(1174),__webpack_require__(60285),__webpack_require__(41637),__webpack_require__(4192)),tt=__webpack_require__(78842);function nt(e){return nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nt(e)}function rt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ot(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function it(e,t){return it=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},it(e,t)}function at(e,t){if(t&&("object"===nt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ut(e){return ut=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ut(e)}!function(e){e.BOTTOM_RIGHT="BOTTOM_RIGHT",e.BOTTOM_LEFT="BOTTOM_LEFT",e.TOP_LEFT="TOP_LEFT",e.TOP_RIGHT="TOP_RIGHT"}(Xe||(Xe={}));var ct=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&it(e,t)}(u,e);var t,r,o,i,a=(o=u,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ut(o);if(i){var n=ut(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return at(this,e)});function u(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return rt(this,u),(t=a.call(this)).onError=new m.xQ,t.onStateChange=new m.xQ,t.parent=null,t.children=[],t.mModuleSettings=null,t.mEditor=e,t.mSettings=t.mEditor.getSettings(),t.mValue=Object.assign({name:null,enabled:!0,position:Xe.BOTTOM_RIGHT,color:"transparent",hover:"rgba(0, 0, 0, 0.1)",image_source:"",padding:0,busy:!1,sharing:!1,arqr:!1,protect_mutation:!1,inverted:!1},n),t}return t=u,(r=[{key:"getType",value:function(){return u.TypeRTTI}},{key:"setValue",value:function(e,t){var r=this;switch(e){case"enabled":return this.mValue.enabled=t,this.onStateChange.next({item:this,name:"enabled",value:t}),!0;case"image_source":return this.mValue.image_source=t,!0;case"icon":return this.mValue.icon=t,!0;case"icon_inverted":return this.mValue.icon_inverted=t,!0;case"busy":return this.mValue.busy=t,this.onStateChange.next({item:this,name:"busy",value:t,message:"Loading AR...",icon:'\n                        <svg viewBox="0 0 48 48" width="48" height="48">\n                            <style>\n                                @keyframes XPVWebArLoading { to { stroke-dashoffset: 90; } }\n                            </style>\n                            <path d="M24.5 21.5L11.5 14.5L24.5 8.5L37.5 15.5L24.5 21.5L37.5 15.5V30.5L24.5 37.5V21.5V37.5L11.5 30.5V14.5L24.5 21.5Z" style="stroke:currentcolor;fill:none;stroke-width:2;stroke-dasharray:60 30;animation:XPVWebArLoading 2s linear infinite;stroke-linejoin:round;stroke-linecap:round;"/>\n                        </svg>\n                    '}),!0;case"arqr":return this.mValue.arqr=!(0,n.isNullOrUndefined)(t),et.W.loadScript("https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js").then((function(){var e=function(e){return encodeURI(btoa(e))},o=new window.URL(N.E.backendURL+"/product-ar");o.searchParams.append("android",e(t[0])),o.searchParams.append("ios",e(t[1]));var i=document.createElement("canvas");new QRious({element:i,size:240,value:o.toString()}),r.onStateChange.next({item:r,name:"arqr",value:!(0,n.isNullOrUndefined)(t),icon:i})})).catch((function(e){return b.qL.error(e)})),!0;case"position":return this.mValue.position=t,!0;case"sharing":return this.mValue.sharing=t,this.onStateChange.next({item:this,name:"sharing",value:t}),!0;case"inverted":return this.mValue.inverted=t,this.onStateChange.next({item:this,name:"inverted",value:t}),!0}return!1}},{key:"getValue",value:function(e){switch(e){case"name":case"enabled":case"image_source":case"icon":case"icon_inverted":case"busy":case"position":case"sharing":case"protect_mutation":case"inverted":return this.mValue[e]}return null}},{key:"getSetting",value:function(e){return this.mModuleSettings?this.mModuleSettings[e]?this.mModuleSettings[e]:this.mModuleSettings.settings&&this.mModuleSettings.settings[e]?this.mModuleSettings.settings[e]:null:null}},{key:"getEditor",value:function(){return this.mEditor}},{key:"getParent",value:function(){return this.parent}},{key:"getChildren",value:function(){return this.children}}])&&ot(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),u}(tt.L);ct.TypeRTTI=new w.r("ToolbarItemController",tt.L.TypeRTTI);var st=__webpack_require__(10288);function lt(e){return lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lt(e)}function ft(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pt(e,t){return pt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},pt(e,t)}function dt(e,t){if(t&&("object"===lt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ht(e){return ht=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ht(e)}var yt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pt(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ht(r);if(o){var n=ht(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return dt(this,e)});function a(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);var n=!1;return(t=i.call(this,e,{name:"web-ar",enabled:!0,icon:'\n                <svg viewBox="0 0 72 36" width="72" height="36">\n                    <path d="M21 17L10 11L21 5L32 11L21 17L32 11V24L21 31V17V31L10 24V11L21 17Z" style="stroke:currentcolor;fill:none;stroke-width:2;stroke-linejoin:round;stroke-linecap:round;"/>\n                    <path d="M40 24L44 13Q45 11 46 13L50 24M42 20H48M53 24V12H58A1 1 0 0 1 58 18H53H55Q58 18 60 21L62 24" style="stroke:currentcolor;stroke-width:2;stroke-linejoin:round;stroke-linecap:round;fill:none;"/>\n                </svg>\n            '})).mSettings.isModuleEnabled("webar")&&((0,st.Dt)()?n=!0:(0,st.gn)()?n=document.createElement("a").relList.supports("ar"):(0,st.nI)()&&(n=!0)),t.setValue("enabled",n),t}return t=a,(n=[{key:"getType",value:function(){return a.TypeRTTI}}])&&ft(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(ct);yt.TypeRTTI=new w.r("WebArToolbarItemController",ct.TypeRTTI);var mt=__webpack_require__(75306),vt=__webpack_require__(97748);function bt(e){return bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bt(e)}function gt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wt(e,t){return wt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},wt(e,t)}function _t(e,t){if(t&&("object"===bt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ot(e){return Ot=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ot(e)}var Tt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wt(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ot(r);if(o){var n=Ot(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return _t(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this)).event=e,n.data=t,n}return t=a,(n=[{key:"getType",value:function(){return a.TypeRTTI}}])&&gt(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(vt.v);Tt.TypeRTTI=new w.r("MessageToolbarItemEvent",vt.v.TypeRTTI);var Rt=__webpack_require__(46296);function St(e){return St="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},St(e)}function Et(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function Pt(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Et(i,r,o,a,u,"next",e)}function u(e){Et(i,r,o,a,u,"throw",e)}a(void 0)}))}}function xt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jt(){return jt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=Ct(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},jt.apply(this,arguments)}function Ct(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Dt(e)););return e}function kt(e,t){return kt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},kt(e,t)}function Mt(e,t){if(t&&("object"===St(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Dt(e){return Dt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Dt(e)}var At=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kt(e,t)}(s,e);var t,r,o,i,a,u,c=(a=s,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Dt(a);if(u){var n=Dt(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Mt(this,e)});function s(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),c.call(this,"toolbar-webar-component")}return t=s,r=[{key:"OnAttached",value:function(){var e=this;jt(Dt(s.prototype),"OnAttached",this).call(this),this.mController=this.getParentObject(),this.registerMessageHandler(Tt.TypeRTTI,(function(){var t=e.getParentObject();t.getValue("busy")||(t.setValue("busy",!0),e.action().then((function(e){t.setValue("busy",!1),Array.isArray(e)&&t.setValue("arqr",e)}),(function(n){b.qL.error(n),t.setValue("busy",!1),e.mController.onError.next("Could not load AR file.")})))}))}},{key:"OnDetached",value:function(){this.unregisterMessageHandler(Tt.TypeRTTI)}},{key:"isAttachable",value:function(e){return e.isDerivedTypeOf(yt.TypeRTTI)}},{key:"action",value:(i=Pt(regeneratorRuntime.mark((function e(){var t,r,o,i,a,u,c,s,l,f,p,d=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(0,st._v)(),r=(0,Rt.zd)()&&t===$e.S.iOS?window.open("","_blank"):null,b.qL.print("Try to retrieve AR file..."),o=this.mEditor.getSceneManager().findNodesOfType(Me.L.TypeRTTI),i=o.find((function(e){return null===e.getValue("parent_id")})),!(0,n.isNullOrUndefined)(i)){e.next=7;break}return e.abrupt("return");case 7:return a=i.getValue("product_id"),b.qL.print("AR file for product:",a),u=o.map(function(){var e=Pt(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",d.getHashFromProduct(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.t0=Fe.F,e.next=13,Promise.all(u);case 13:return e.t1=e.sent.join(""),c=e.t0.Md5.call(e.t0,e.t1),s=(0,st.nI)()||(0,st.gn)()?"usdz":"gltf",e.next=18,Je.exportEsd(this.mEditor,null,!1);case 18:return l=e.sent,e.next=21,je.requestNewArFile(a,c,l,s);case 21:if(f=e.sent,!(0,st.nI)()){e.next=26;break}return e.abrupt("return",f);case 26:p=je.resolveWebArFiles(f,s),this.openLink(p,t,r);case 28:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"getHashFromProduct",value:(o=Pt(regeneratorRuntime.mark((function e(t){var n,r,o,i,a,u,c,s,l,f,p,d,h,y,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.getComponent("attributeManager"),r=t.getComponent("catalogueMeta"),o=t.getComponent("materialGroupManager"),e.next=5,n.resolveAttributeManager().toPromise();case 5:return i=e.sent,e.next=8,r.resolveSettings().toPromise();case 8:return a=e.sent,e.next=11,o.resolveMaterialGroups().toPromise();case 11:return u=e.sent,c=t.getValue("product_id"),s=i.hashConfiguration(),l=u.buildQueryParams(!1),f=(0,st.tq)()?mt.i.Mobile:mt.i.Desktop,p=a.getSceneDeviceSettings(f),d=parseInt(p.compression,10),h=Object.keys(l).map((function(e){return"".concat(e,":").concat(l[e])})).join("/"),y="".concat(c,"/").concat(a.getGraphRevId(),"/").concat(a.getSceneRevId(),"/").concat(d,"/").concat(s,"/").concat(h,"/"),m=Fe.F.Md5(y),e.abrupt("return",m);case 22:case"end":return e.stop()}}),e)}))),function(e){return o.apply(this,arguments)})},{key:"openLink",value:function(e,t,n){var r=e,o="";if(t===$e.S.Android)b.qL.print("Opening AR file for Android."),o="".concat("intent://arvr.google.com/scene-viewer/1.1","?file=").concat(escape(r),"&mode=").concat("ar_preferred","&enable_vertical_placement=").concat("true","&resizable=").concat("true","#Intent;scheme=").concat("https",";package=").concat("com.google.android.googlequicksearchbox;action=android.intent.action.VIEW",";S.browser_fallback_url=").concat("https://developers.google.com/ar",";end;");else{if(t!==$e.S.iOS)return b.qL.print("Can not open AR file as device is unknown."),void(n&&n.close());b.qL.print("Opening AR file for iOS."),o=r}if(b.qL.print("Url to webar file: "+o),n)n.location.href=o;else{var i=document.createElement("a"),a=document.createElement("img");i.appendChild(a),i.href=o,i.style.display="none",t===$e.S.iOS&&(i.rel="ar"),document.body.appendChild(i),i.click(),i.remove()}}},{key:"getType",value:function(){return s.TypeRTTI}}],r&&xt(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),s}(Se);function It(e){return It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},It(e)}function Nt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vt(e,t){return Vt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Vt(e,t)}function Ut(e,t){if(t&&("object"===It(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ft(e){return Ft=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ft(e)}At.TypeRTTI=new w.r("WebArComponent",Se.TypeRTTI);var Bt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Vt(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ft(r);if(o){var n=Ft(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Ut(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e,{name:"fullscreen",enabled:!0,icon:'\n                <svg xmlns="http://www.w3.org/2000/svg" height="36" width="36" viewBox="0 0 48 48" style="stroke: currentColor; stroke-width: 0.5;">\n                    <path d="M10 38v-9.65h3V35h6.65v3Zm0-18.35V10h9.65v3H13v6.65ZM28.35 38v-3H35v-6.65h3V38ZM35 19.65V13h-6.65v-3H38v9.65Z"/>\n                </svg>\n            ',icon_inverted:'\n                <svg xmlns="http://www.w3.org/2000/svg" height="36" width="36" viewBox="0 0 48 48" style="stroke: currentColor; stroke-width: 0.5;">\n                    <path d="M16.65 38v-6.65H10v-3h9.65V38Zm11.7 0v-9.65H38v3h-6.65V38ZM10 19.65v-3h6.65V10h3v9.65Zm18.35 0V10h3v6.65H38v3Z"/>\n                </svg>\n            '})).mViewRenderCanvas=t,n.setValue("enabled",!(0,st.gn)()),n}return t=a,(n=[{key:"getType",value:function(){return a.TypeRTTI}},{key:"getViewRenderCanvas",value:function(){return this.mViewRenderCanvas}}])&&Nt(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(ct);function Lt(e){return Lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lt(e)}function Ht(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function zt(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Ht(i,r,o,a,u,"next",e)}function u(e){Ht(i,r,o,a,u,"throw",e)}a(void 0)}))}}function qt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Gt(){return Gt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=Wt(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Gt.apply(this,arguments)}function Wt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Yt(e)););return e}function Qt(e,t){return Qt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Qt(e,t)}function Kt(e,t){if(t&&("object"===Lt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Yt(e){return Yt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Yt(e)}Bt.TypeRTTI=new w.r("FullscreenToolbarItemController",ct.TypeRTTI);var Zt,Xt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Qt(e,t)}(l,e);var t,r,o,i,a,u,c,s=(u=l,c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Yt(u);if(c){var n=Yt(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Kt(this,e)});function l(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(e=s.call(this,"toolbar-fullscreen-component")).mIsFullscreen=!1,e}return t=l,r=[{key:"OnAttached",value:function(){var e=this;Gt(Yt(l.prototype),"OnAttached",this).call(this),this.mController=this.getParentObject(),this.registerMessageHandler(Tt.TypeRTTI,(function(){e.action().then((function(){}),(function(e){b.qL.error(e)}))})),this.mIsFullscreen=!1,document.addEventListener("fullscreenchange",this.onFullScreen.bind(this),!1),document.addEventListener("webkitfullscreenchange",this.onFullScreen.bind(this),!1),document.addEventListener("mozfullscreenchange",this.onFullScreen.bind(this),!1),document.addEventListener("MSFullscreenChange",this.onFullScreen.bind(this),!1)}},{key:"OnDetached",value:function(){document.removeEventListener("fullscreenchange",this.onFullScreen.bind(this)),document.removeEventListener("webkitfullscreenchange",this.onFullScreen.bind(this)),document.removeEventListener("mozfullscreenchange",this.onFullScreen.bind(this)),document.removeEventListener("MSFullscreenChange",this.onFullScreen.bind(this)),this.unregisterMessageHandler(Tt.TypeRTTI)}},{key:"isAttachable",value:function(e){return e.isDerivedTypeOf(Bt.TypeRTTI)}},{key:"action",value:(a=zt(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){return t.mIsFullscreen?t.closeFullscreen():t.openFullscreen(t.mController.getViewRenderCanvas()),e()})));case 1:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)})},{key:"openFullscreen",value:function(e){var t=this;this.requestFullscreen(e).then((function(){t.mIsFullscreen=!0,t.mEditor.dispatchEvent(v.G.WindowResized),t.mController.setValue("inverted",!0)}),(function(e){b.qL.error(e)}))}},{key:"closeFullscreen",value:function(){var e=this;this.exitFullscreen().then((function(){e.mIsFullscreen=!1,e.mEditor.dispatchEvent(v.G.WindowResized),e.mController.setValue("inverted",!1)}),(function(e){b.qL.error(e)}))}},{key:"onFullScreen",value:function(){this.mIsFullscreen=null!==document.fullscreenElement,this.mEditor.dispatchEvent(v.G.WindowResized)}},{key:"isFullscreenEnabled",value:function(){return document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled}},{key:"requestFullscreen",value:(i=zt(regeneratorRuntime.mark((function e(t){var r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,o){if(!r.isFullscreenEnabled())return o("Fullscreen api not available.");var i=null;t.requestFullscreen?i=t.requestFullscreen():"mozRequestFullScreen"in t?i=t.mozRequestFullScreen():"webkitRequestFullScreen"in t?i=t.webkitRequestFullScreen():"msRequestFullscreen"in t?i=t.msRequestFullscreen():"webkitEnterFullscreen"in t&&(i=t.webkitEnterFullscreen()),!(0,n.isNullOrUndefined)(i)&&i instanceof Promise?i.then((function(){e()}),(function(e){o(e)})):e()})));case 1:case"end":return e.stop()}}),e)}))),function(e){return i.apply(this,arguments)})},{key:"exitFullscreen",value:(o=zt(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){if(!t.isFullscreenEnabled())return r("Fullscreen api not available.");var o=null;document.exitFullscreen?o=document.exitFullscreen():"webkitExitFullscreen"in document?o=document.webkitExitFullscreen():"mozCancelFullScreen"in document?o=document.mozCancelFullScreen():"msExitFullscreen"in document&&(o=document.msExitFullscreen()),!(0,n.isNullOrUndefined)(o)&&o instanceof Promise?o.then((function(){e()}),(function(e){r(e)})):e()})));case 1:case"end":return e.stop()}}),e)}))),function(){return o.apply(this,arguments)})},{key:"getType",value:function(){return l.TypeRTTI}}],r&&qt(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(Se);function Jt(e){return Jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jt(e)}function $t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function en(e,t){return en=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},en(e,t)}function tn(e,t){if(t&&("object"===Jt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function nn(e){return nn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},nn(e)}Xt.TypeRTTI=new w.r("FullscreenComponent",Se.TypeRTTI),function(e){e.TOP_RIGHT="TOP_RIGHT",e.TOP_LEFT="TOP_LEFT",e.BOTTOM_LEFT="BOTTOM_LEFT",e.BOTTOM_RIGHT="BOTTOM_RIGHT"}(Zt||(Zt={}));var rn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&en(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=nn(r);if(o){var n=nn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return tn(this,e)});function a(e,t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e,{name:"social",enabled:!0,icon:'\n                <svg viewBox="0 0 36 36" width="36" height="36">\n                    <path d="M19 12A1 1 0 0 0 23 8A1 1 0 0 0 19 12ZM12 15A1 1 0 0 0 8 19A1 1 0 0 0 12 15ZM23 22A1 1 0 0 0 19 26A1 1 0 0 0 23 22ZM18 12L13 15M13 19L18 22" style="fill:none;stroke-linecap:square;stroke-width:2;stroke:currentcolor;"/>\n                </svg>\n            '})).mViewRenderCanvas=t,n.mModuleSettings=n.mSettings.getSubModuleSettings("social","GENERAL");var r=n.mSettings.isModuleEnabled("social")&&n.mModuleSettings.status;n.setValue("enabled",r);var o=n.mModuleSettings.settings&&n.mModuleSettings.settings.position||Zt.BOTTOM_RIGHT,u=Xe[o];return n.setValue("position",u),n}return t=a,(n=[{key:"getType",value:function(){return a.TypeRTTI}},{key:"getViewRenderCanvas",value:function(){return this.mViewRenderCanvas}}])&&$t(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(ct);function on(e){return on="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},on(e)}function an(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function un(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cn(){return cn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=sn(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},cn.apply(this,arguments)}function sn(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=pn(e)););return e}function ln(e,t){return ln=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ln(e,t)}function fn(e,t){if(t&&("object"===on(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function pn(e){return pn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},pn(e)}rn.TypeRTTI=new w.r("SocialSharingToolbarItemController",ct.TypeRTTI);var dn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ln(e,t)}(c,e);var t,n,r,o,i,a,u=(i=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=pn(i);if(a){var n=pn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return fn(this,e)});function c(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),u.call(this,"toolbar-social-sharing-component")}return t=c,n=[{key:"OnAttached",value:function(){var e=this;cn(pn(c.prototype),"OnAttached",this).call(this),this.mController=this.getParentObject(),this.registerMessageHandler(Tt.TypeRTTI,(function(){e.action().then((function(){}),(function(e){b.qL.error(e)}))}))}},{key:"OnDetached",value:function(){}},{key:"isAttachable",value:function(e){return e.isDerivedTypeOf(rn.TypeRTTI)}},{key:"action",value:(r=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){return e()})));case 1:case"end":return e.stop()}}),e)})),o=function(){var e=this,t=arguments;return new Promise((function(n,o){var i=r.apply(e,t);function a(e){an(i,n,o,a,u,"next",e)}function u(e){an(i,n,o,a,u,"throw",e)}a(void 0)}))},function(){return o.apply(this,arguments)})},{key:"getType",value:function(){return c.TypeRTTI}}],n&&un(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(Se);function hn(e){return hn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hn(e)}function yn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function mn(e,t){return mn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},mn(e,t)}function vn(e,t){if(t&&("object"===hn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function bn(e){return bn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},bn(e)}dn.TypeRTTI=new w.r("SocialSharingComponent",Se.TypeRTTI);var gn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mn(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=bn(r);if(o){var n=bn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return vn(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e,{enabled:!0,icon:'\n                <svg viewBox="-30 -30 215 215" width="36" height="36">\n                    <path d="M89.584,155.139V84.378h23.742l3.562-27.585H89.584V39.184c0-7.984,2.208-13.425,13.67-13.425l14.595-0.006V1.08C115.325,0.752,106.661,0,96.577,0C75.52,0,61.104,12.853,61.104,36.452v20.341H37.29v27.585h23.814v70.761H89.584z" style="fill:currentcolor;"/>\n                </svg>\n            '})).mViewRenderCanvas=t,n.mModuleSettings=n.mSettings.getSubModuleSettings("social","facebook"),n.setValue("enabled",!0===n.mModuleSettings.status),n}return t=a,(n=[{key:"getType",value:function(){return a.TypeRTTI}},{key:"getViewRenderCanvas",value:function(){return this.mViewRenderCanvas}}])&&yn(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(ct);function wn(e){return wn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wn(e)}function _n(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function On(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Tn(){return Tn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=Rn(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Tn.apply(this,arguments)}function Rn(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Pn(e)););return e}function Sn(e,t){return Sn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Sn(e,t)}function En(e,t){if(t&&("object"===wn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Pn(e){return Pn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Pn(e)}gn.TypeRTTI=new w.r("FacebookSocialSharingToolbarItemController",ct.TypeRTTI);var xn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Sn(e,t)}(c,e);var t,n,r,o,i,a,u=(i=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Pn(i);if(a){var n=Pn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return En(this,e)});function c(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),u.call(this,"toolbar-facebook-social-sharing-component")}return t=c,n=[{key:"OnAttached",value:function(){var e=this;Tn(Pn(c.prototype),"OnAttached",this).call(this),this.mController=this.getParentObject(),this.registerMessageHandler(Tt.TypeRTTI,(function(){e.mController.getValue("sharing")||e.action().then((function(){setTimeout((function(){e.mController.setValue("sharing",!1)}),2e3)}),(function(e){b.qL.error(e)}))}))}},{key:"OnDetached",value:function(){}},{key:"isAttachable",value:function(e){return e.isDerivedTypeOf(gn.TypeRTTI)}},{key:"action",value:(r=regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){return t.mController.setValue("sharing",t.mController.mModuleSettings),e()})));case 1:case"end":return e.stop()}}),e)})),o=function(){var e=this,t=arguments;return new Promise((function(n,o){var i=r.apply(e,t);function a(e){_n(i,n,o,a,u,"next",e)}function u(e){_n(i,n,o,a,u,"throw",e)}a(void 0)}))},function(){return o.apply(this,arguments)})},{key:"getType",value:function(){return c.TypeRTTI}}],n&&On(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(Se);function jn(e){return jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jn(e)}function Cn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kn(e,t){return kn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},kn(e,t)}function Mn(e,t){if(t&&("object"===jn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Dn(e){return Dn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Dn(e)}xn.TypeRTTI=new w.r("FacebookSocialSharingComponent",Se.TypeRTTI);var An=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kn(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Dn(r);if(o){var n=Dn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Mn(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e,{enabled:!0,icon:'\n                <svg viewBox="-103 -101 842 842" width="36" height="36">\n                    <path d="m544.386719 93.007812c-59.875-59.945312-139.503907-92.9726558-224.335938-93.007812-174.804687 0-317.070312 142.261719-317.140625 317.113281-.023437 55.894531 14.578125 110.457031 42.332032 158.550781l-44.992188 164.335938 168.121094-44.101562c46.324218 25.269531 98.476562 38.585937 151.550781 38.601562h.132813c174.785156 0 317.066406-142.273438 317.132812-317.132812.035156-84.742188-32.921875-164.417969-92.800781-224.359376zm-224.335938 487.933594h-.109375c-47.296875-.019531-93.683594-12.730468-134.160156-36.742187l-9.621094-5.714844-99.765625 26.171875 26.628907-97.269531-6.269532-9.972657c-26.386718-41.96875-40.320312-90.476562-40.296875-140.28125.054688-145.332031 118.304688-263.570312 263.699219-263.570312 70.40625.023438 136.589844 27.476562 186.355469 77.300781s77.15625 116.050781 77.132812 186.484375c-.0625 145.34375-118.304687 263.59375-263.59375 263.59375zm144.585938-197.417968c-7.921875-3.96875-46.882813-23.132813-54.148438-25.78125-7.257812-2.644532-12.546875-3.960938-17.824219 3.96875-5.285156 7.929687-20.46875 25.78125-25.09375 31.066406-4.625 5.289062-9.242187 5.953125-17.167968 1.984375-7.925782-3.964844-33.457032-12.335938-63.726563-39.332031-23.554687-21.011719-39.457031-46.960938-44.082031-54.890626-4.617188-7.9375-.039062-11.8125 3.476562-16.171874 8.578126-10.652344 17.167969-21.820313 19.808594-27.105469 2.644532-5.289063 1.320313-9.917969-.664062-13.882813-1.976563-3.964844-17.824219-42.96875-24.425782-58.839844-6.4375-15.445312-12.964843-13.359374-17.832031-13.601562-4.617187-.230469-9.902343-.277344-15.1875-.277344-5.28125 0-13.867187 1.980469-21.132812 9.917969-7.261719 7.933594-27.730469 27.101563-27.730469 66.105469s28.394531 76.683594 32.355469 81.972656c3.960937 5.289062 55.878906 85.328125 135.367187 119.648438 18.90625 8.171874 33.664063 13.042968 45.175782 16.695312 18.984374 6.03125 36.253906 5.179688 49.910156 3.140625 15.226562-2.277344 46.878906-19.171875 53.488281-37.679687 6.601563-18.511719 6.601563-34.375 4.617187-37.683594-1.976562-3.304688-7.261718-5.285156-15.183593-9.253906zm0 0" style="fill-rule:evenodd;fill:currentcolor;"/>\n                </svg>\n            '})).mViewRenderCanvas=t,n.mModuleSettings=n.mSettings.getSubModuleSettings("social","whatsapp"),n.setValue("enabled",!0===n.mModuleSettings.status),n}return t=a,(n=[{key:"getType",value:function(){return a.TypeRTTI}},{key:"getViewRenderCanvas",value:function(){return this.mViewRenderCanvas}}])&&Cn(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(ct);function In(e){return In="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},In(e)}function Nn(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function Vn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Un(){return Un="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=Fn(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},Un.apply(this,arguments)}function Fn(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Hn(e)););return e}function Bn(e,t){return Bn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Bn(e,t)}function Ln(e,t){if(t&&("object"===In(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Hn(e){return Hn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Hn(e)}An.TypeRTTI=new w.r("WhatsappSocialSharingToolbarItemController",ct.TypeRTTI);var zn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Bn(e,t)}(c,e);var t,n,r,o,i,a,u=(i=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Hn(i);if(a){var n=Hn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Ln(this,e)});function c(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),u.call(this,"toolbar-whatsapp-social-sharing-component")}return t=c,n=[{key:"OnAttached",value:function(){var e=this;Un(Hn(c.prototype),"OnAttached",this).call(this),this.mController=this.getParentObject(),this.registerMessageHandler(Tt.TypeRTTI,(function(){e.mController.getValue("sharing")||e.action().then((function(){setTimeout((function(){e.mController.setValue("sharing",!1)}),2e3)}),(function(e){b.qL.error(e)}))}))}},{key:"OnDetached",value:function(){}},{key:"isAttachable",value:function(e){return e.isDerivedTypeOf(An.TypeRTTI)}},{key:"action",value:(r=regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){return t.mController.setValue("sharing",t.mController.mModuleSettings),e()})));case 1:case"end":return e.stop()}}),e)})),o=function(){var e=this,t=arguments;return new Promise((function(n,o){var i=r.apply(e,t);function a(e){Nn(i,n,o,a,u,"next",e)}function u(e){Nn(i,n,o,a,u,"throw",e)}a(void 0)}))},function(){return o.apply(this,arguments)})},{key:"getType",value:function(){return c.TypeRTTI}}],n&&Vn(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),c}(Se);function qn(e){return qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qn(e)}function Gn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wn(e,t){return Wn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Wn(e,t)}function Qn(e,t){if(t&&("object"===qn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Kn(e){return Kn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Kn(e)}zn.TypeRTTI=new w.r("WhatsappSocialSharingComponent",Se.TypeRTTI);var Yn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Wn(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Kn(r);if(o){var n=Kn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Qn(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e,{name:"freemium",enabled:!0,position:Xe.BOTTOM_LEFT,icon:'\n                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="Laag_1" x="0px" y="0px" viewBox="0 0 722.8 354.3" style="enable-background:new 0 0 722.8 354.3;" xml:space="preserve">\n                    <style type="text/css">\n                        .st0{fill:#FF4B00;}\n                    </style>\n                    <g>\n                        <path class="st0" d="M161,74.7L72.2,126v102.5l88.8,51.3l88.8-51.3V126L161,74.7z M161,248.6l-24.4-14.1l24.4-14.1l24.4,14.1   L161,248.6z M222.7,186.5l-22.8,13.2v26.5l-8.4,4.8L164,215.1v-9.2l14.2-8.2v-7h-34.5v7l14.3,8.2v9.2L130.5,231l-8.4-4.8v-26.5   l-22.8-13.2v-44.9l38.9-22.4l22.9,13.2l22.8-13.2l38.9,22.4V186.5z"></path>\n                        <polygon class="st0" points="178.2,173.2 189.8,173.2 206,163.9 206,161.7 178.2,161.7  "></polygon>\n                        <polygon class="st0" points="116,163.9 132.1,173.2 143.7,173.2 143.7,161.7 116,161.7  "></polygon>\n                        <polygon points="359.7,168.4 359.7,183 309.7,183 309.7,214.1 368.1,214.1 368.1,228.5 292.6,228.5 292.6,126.1 366.7,126.1    366.7,140.6 309.7,140.6 309.7,168.4  "></polygon>\n                        <polygon points="392.7,155.3 409.4,181.1 409.6,181.1 426.3,155.3 443.3,155.3 418.7,191.1 446,228.5 428.5,228.5 409.6,201    409.4,201 390.7,228.5 373.1,228.5 400.5,191.1 375.7,155.3  "></polygon>\n                        <path d="M523.5,192c0,24.1-13.9,38.7-32.5,38.7c-11.5,0-18.6-5.4-22.5-10.9h-0.3v33.7H453v-98.1h15.2v8.6h0.3   c3.9-5.2,11-10.6,22.5-10.6C509.6,153.3,523.5,167.9,523.5,192 M508.3,192c0-14.3-7-26.4-20.2-26.4c-12.2,0-19.8,10-19.8,26.4   s7.6,26.4,19.8,26.4C501.3,218.4,508.3,206.4,508.3,192"></path>\n                        <path d="M533.3,135c0-5.2,4.3-7.9,8.5-7.9c4.5,0,8.6,2.7,8.6,7.9s-4.2,8-8.6,8C537.6,143,533.3,140.1,533.3,135 M549.3,228.6h-15   v-73.2h15V228.6z"></path>\n                        <polygon points="573.5,155.3 591.9,212.6 592.1,212.6 610.5,155.3 626.5,155.3 600.5,228.5 583.5,228.5 557.5,155.3  "></polygon>\n                        <path d="M633.6,135c0-5.2,4.3-7.9,8.5-7.9c4.4,0,8.6,2.7,8.6,7.9s-4.2,8-8.6,8C637.9,143,633.6,140.1,633.6,135 M649.6,228.6h-15   v-73.2h15V228.6z"></path>\n                    </g>\n                </svg>\n            ',protect_mutation:!0})).setValue("enabled",t.mSettings.isModuleEnabled("freemium")),t}return t=a,(n=[{key:"getType",value:function(){return a.TypeRTTI}}])&&Gn(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(ct);function Zn(e){return Zn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zn(e)}function Xn(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function Jn(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Xn(i,r,o,a,u,"next",e)}function u(e){Xn(i,r,o,a,u,"throw",e)}a(void 0)}))}}function $n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function er(){return er="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=tr(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},er.apply(this,arguments)}function tr(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=or(e)););return e}function nr(e,t){return nr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},nr(e,t)}function rr(e,t){if(t&&("object"===Zn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function or(e){return or=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},or(e)}Yn.TypeRTTI=new w.r("FreemiumToolbarItemController",ct.TypeRTTI);var ir=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nr(e,t)}(u,e);var t,n,r,o,i,a=(o=u,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=or(o);if(i){var n=or(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return rr(this,e)});function u(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),a.call(this,"toolbar-freemium-component")}return t=u,n=[{key:"OnAttached",value:function(){var e=this;er(or(u.prototype),"OnAttached",this).call(this),this.mController=this.getParentObject(),this.registerMessageHandler(Tt.TypeRTTI,Jn(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.action();case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),b.qL.error(t.t0);case 8:case"end":return t.stop()}}),t,null,[[0,5]])}))))}},{key:"OnDetached",value:function(){}},{key:"action",value:(r=Jn(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){return window.open("https://www.expivi.com/"),e()})));case 1:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},{key:"isAttachable",value:function(e){return e.isDerivedTypeOf(Yn.TypeRTTI)}},{key:"getType",value:function(){return u.TypeRTTI}}],n&&$n(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(Se);function ar(e,t,n){return ar=ur()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&cr(o,n.prototype),o},ar.apply(null,arguments)}function ur(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function cr(e,t){return cr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},cr(e,t)}function sr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}ir.TypeRTTI=new w.r("FreemiumToolbarComponent",Se.TypeRTTI);var lr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r;return t=e,r=[{key:"createObject",value:function(t,r){for(var o=this,i=arguments.length,a=new Array(i>2?i-2:0),u=2;u<i;u++)a[u-2]=arguments[u];var c=null;if(t in e.mFactories){var s=e.mFactories[t],l=(0,n.isUndefined)(s.view)?s:s.view,f=s.components||[],p=s.children||[];c=(0,n.isUndefined)(a)?new l(r):ar(l,[r].concat(a)),f.forEach((function(e){c.addComponent(new e)})),p.forEach((function(e){var t=o.createObject.apply(o,[e,r].concat(a));t.parent=c,c.children.push(t)}))}return c}}],r&&sr(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function fr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}lr.mFactories={web_ar:{view:yt,components:[At]},fullscreen:{view:Bt,components:[Xt]},social:{view:rn,components:[dn],children:["social_facebook","social_whatsapp"]},social_facebook:{view:gn,components:[xn]},social_whatsapp:{view:An,components:[zn]},freemium:{view:Yn,components:[ir]}};var pr=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mItems=[],this.mEditor=t,this.mViewRenderCanvas=n,this.mSettings=this.mEditor.getSettings(),this.mFactory=new lr}var t,n;return t=e,(n=[{key:"init",value:function(){this.mItems.push(this.mFactory.createObject("freemium",this.mEditor),this.mFactory.createObject("social",this.mEditor),this.mFactory.createObject("web_ar",this.mEditor),this.mFactory.createObject("fullscreen",this.mEditor,this.mViewRenderCanvas))}},{key:"dispose",value:function(){this.mItems.splice(0)}},{key:"getItems",value:function(){return this.mItems}}])&&fr(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function dr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var hr=function(){function e(t,n,r){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mItems={},this.mSubscriptions=[],this.mEnabled=!0,this.mViewContainer=t,this.mEditor=n,this.mToolbar=r,this.mToolbarContainer=document.createElement("div"),this.mToolbarContainer.classList.add("xpv__viewer_toolbar_container"),Object.keys(Xe).forEach((function(e){o.mItems[e]=[]})),this.mLoadingIcon=this.getLoadingIcon(),this.mArQrContainer=this.getArQrContainer(),this.mViewContainer.appendChild(this.mToolbarContainer),this.mViewContainer.appendChild(this.mLoadingIcon),this.mViewContainer.appendChild(this.mArQrContainer)}var t,n;return t=e,n=[{key:"init",value:function(){var e=this;this.mToolbar.getItems().filter((function(e){return!0===e.getValue("enabled")})).forEach((function(t){var n=t.getChildren();n.length>0?e.mToolbarContainer.appendChild(e.createGroup(t,n)):e.mToolbarContainer.appendChild(e.createToolbarElement(t))}))}},{key:"createToolbarElement",value:function(e,t){var n=this.createItemButton(e,t);return e.getValue("protect_mutation")&&this.setProtectMutation(e),n}},{key:"getLoadingIcon",value:function(){var e=document.createElement("div");return e.innerHTML='\n            <div id="xpv-toolbar-loader" hidden>\n                <div id="xpv-toolbar-loader-icon"></div>\n                <div id="xpv-toolbar-loader-message">Loading...</div>\n            </div>\n        ',e.firstElementChild}},{key:"getArQrContainer",value:function(){var e=document.createElement("div");e.innerHTML='\n            <div id="xpv-toolbar-ar-qr" hidden>\n                <div id="xpv-toolbar-ar-qr-code"></div>\n                <div id="xpv-toolbar-ar-qr-message">\n                    Scan the code with a compatible\n                    <br>\n                    Android/iOS device\n                </div>\n            </div>\n        ';var t=e.firstElementChild;return t.addEventListener("click",(function(){return t.hidden=!0})),t}},{key:"listenToStateChange",value:function(e){var t=this,n=e.onStateChange.subscribe((function(e){t.itemStateChange(e)}),(function(e){b.qL.error("Toolbar state failed: ",e)}));this.mSubscriptions.push(n)}},{key:"getButtonIcon",value:function(e){var t=e.getValue("icon");if(t){var n=document.createElement("div");n.innerHTML=t;var r=n.firstElementChild;return r.classList.add("xpv-toolbar-item-icon"),r}var o=e.getValue("image_source"),i=document.createElement("img");return i.src=o,i.alt="",i}},{key:"getButtonIconInverted",value:function(e){var t=e.getValue("icon_inverted");if(!t)return null;var n=document.createElement("div");n.innerHTML=t;var r=n.firstElementChild;return r.classList.add("xpv-toolbar-item-icon-inverted"),r}},{key:"createItemButton",value:function(e,t){var n=this;e.onError.subscribe((function(e){null!==e&&e.length>0&&alert(e)}),(function(){}));var r=document.createElement("button"),o=e.getValue("name");if(o&&(r.id="xpv-toolbar-item-".concat(o)),r.type="button",!t){var i=e.getValue("position"),a=this.getClassNameFromPosition(i);r.classList.add(a)}var u=this.getButtonIcon(e);r.appendChild(u);var c=this.getButtonIconInverted(e);return c&&r.appendChild(c),r.addEventListener("click",(function(t){n.mEnabled&&e.getValue("enabled")&&e.dispatchMessageToComponents(new Tt(t))})),this.listenToStateChange(e),r}},{key:"getClassNameFromPosition",value:function(e){switch(e){case"TOP_LEFT":return"top-left";case"TOP_RIGHT":return"top-right";case"BOTTOM_LEFT":return"bottom-left";default:return"bottom-right"}}},{key:"createGroup",value:function(e,t){var n=this,r=document.createElement("div");r.classList.add("xpv__viewer_toolbar_group_container");var o=document.createElement("div");o.classList.add("xpv__viewer_toolbar_group");var i=document.createElement("div"),a=this.createToolbarElement(e),u=e.getValue("position"),c=this.getClassNameFromPosition(u);r.classList.add(c);var s=!1,l=!1;return t.filter((function(e){return!0===e.getValue("enabled")})).forEach((function(t){var r=n.createToolbarElement(t,e);if("social"==t.getSetting("name")){var o=t.getSetting("scope");r.classList.add(o)}!0===t.getSetting("mobile")&&(r.classList.add("mobile-enabled"),s=!0),!0===t.getSetting("desktop")&&(r.classList.add("desktop-enabled"),l=!0),i.appendChild(r)})),s||(a.classList.add("mobile-disabled"),o.classList.add("mobile-disabled")),l||(a.classList.add("desktop-disabled"),o.classList.add("desktop-disabled")),"social"==e.getSetting("name")&&a.classList.add("expand_social_channels"),o.appendChild(i),r.appendChild(a),r.appendChild(o),a.addEventListener("click",(function(e){r.classList.toggle("open")})),r}},{key:"dispose",value:function(){for(var e in this.mItems)this.mItems[e].splice(0).forEach((function(e){e.item&&e.item.remove(),e.group&&e.group.remove()}));this.mSubscriptions.splice(0).forEach((function(e){e.unsubscribe()})),this.mViewContainer.removeChild(this.mToolbarContainer)}},{key:"enable",value:function(){this.mEnabled=!0,this.mToolbarContainer.hidden=!1}},{key:"disable",value:function(){this.mEnabled=!1,this.mToolbarContainer.hidden=!0}},{key:"itemStateChange",value:function(e){switch(e.name){case"busy":if(!0===e.value){var t=this.mLoadingIcon.querySelector("#xpv-toolbar-loader-icon"),n=this.mLoadingIcon.querySelector("#xpv-toolbar-loader-message"),r=e.message,o=void 0===r?"":r,i=e.icon,a=void 0===i?"":i;t.innerHTML=a,n.textContent=o,this.mLoadingIcon.hidden=!1}else this.mLoadingIcon.hidden=!0;break;case"sharing":e.value&&this.mEditor.dispatchEvent(v.G.Shared,e.value);break;case"arqr":if(!0===e.value){var u=this.mArQrContainer.querySelector("#xpv-toolbar-ar-qr-code");u&&e.icon&&e.icon instanceof HTMLElement&&(u.innerHTML="",u.append(e.icon)),this.mArQrContainer.hidden=!1,this.mEditor.dispatchEvent(v.G.QrWebAr,{enabled:e.value,icon:e.icon})}else this.mArQrContainer.hidden=!0;break;case"inverted":var c=this.mToolbarContainer.querySelector("#xpv-toolbar-item-".concat(e.item.getValue("name")));if(!c)return;c.classList.toggle("xpv-toolbar-item-inverted",e.value)}}},{key:"setProtectMutation",value:function(e){var t=this,n=e.getValue("name"),r=function(){var r=t.mToolbarContainer.querySelector("#xpv-toolbar-item-".concat(n));r&&r.remove(),t.mToolbarContainer.prepend(t.createToolbarElement(e))},o=new MutationObserver((function(e){e.forEach((function(e){if(e.target.closest("#xpv-toolbar-item-".concat(n)))return o.disconnect(),void r();e.removedNodes.forEach((function(e){"svg"!==e.tagName&&e.id!=="xpv-toolbar-item-".concat(n)||(o.disconnect(),r())}))}))}));o.observe(this.mToolbarContainer,{subtree:!0,childList:!0,attributes:!0})}}],n&&dr(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function yr(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function mr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var vr=function(){function e(t,n,r){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mCameraVisible=!0,this._subscriptions=new Array,this.mCameraButtonTop=800,this.mViewRenderSize=new THREE.Vector2(800,640),this.mBuildReady=!1,this.mShowLoader=!1,this.mKeepLoaderOnScreen=0,this.mBuildProgress=-1,this.mRenderStream=new m.xQ,this.mRenderRepeat=0,this.mLoadDisplayDelay=null,this.mInteractTimeout=-1,this.dropzone=null,this.windowResizeHandler=function(){!0===o.mRenderActive&&o.updateViewportSize()},this.buildStartedHandler=function(){o.mBuildProgress=-1,o.updateLoader()},this.buildProgressHandler=function(e){var t=e.getData(),n=Math.floor(95*t);isFinite(n)?o.mBuildProgress=n:-1===o.mBuildProgress&&(o.mBuildProgress=0),o.updateLoader()},this.buildReadyHandler=function(){o.mBuildReady=!0,o.updateLoader()},this.objectAddedHandler=function(e){var t=e.getData();!0===t.isObject3D&&t instanceof THREE.Camera&&o.syncCameras()},this.objectRemovedHandler=function(e){var t=e.getData();!0===t.isObject3D&&t instanceof THREE.Camera&&o.syncCameras()},this.mViewRenderCanvas=n,this.mEditor=t,this.mCameraVisible=r.cameraDropdownVisible,this.mClock=new THREE.Clock(!1);var i=fe.createElement("style");fe.setAttribute(i,"type","text/css"),fe.setHtml(i,"\n        .lds-ellipsis {\n          display: inline-block;\n          position: relative;\n          width: 64px;\n          height: 64px;\n        }\n        .lds-ellipsis div {\n          position: absolute;\n          top: 27px;\n          width: 11px;\n          height: 11px;\n          border-radius: 50%;\n          background: #ff6432;\n          animation-timing-function: cubic-bezier(0, 1, 1, 0);\n        }\n        .lds-ellipsis div:nth-child(1) {\n          left: 6px;\n          animation: lds-ellipsis1 0.6s infinite;\n        }\n        .lds-ellipsis div:nth-child(2) {\n          left: 6px;\n          animation: lds-ellipsis2 0.6s infinite;\n        }\n        .lds-ellipsis div:nth-child(3) {\n          left: 26px;\n          animation: lds-ellipsis2 0.6s infinite;\n        }\n        .lds-ellipsis div:nth-child(4) {\n          left: 45px;\n          animation: lds-ellipsis3 0.6s infinite;\n        }\n        @keyframes lds-ellipsis1 {\n          0% {\n            transform: scale(0);\n          }\n          100% {\n            transform: scale(1);\n          }\n        }\n        @keyframes lds-ellipsis3 {\n          0% {\n            transform: scale(1);\n          }\n          100% {\n            transform: scale(0);\n          }\n        }\n        @keyframes lds-ellipsis2 {\n          0% {\n            transform: translate(0, 0);\n          }\n          100% {\n            transform: translate(19px, 0);\n          }\n        }\n        "),document.getElementsByTagName("head")[0].appendChild(i),this.mLoadContainer=fe.createElement("div"),fe.setAttribute(this.mLoadContainer,"id","xpv__viewer_load_backdrop"),fe.setStyle(this.mLoadContainer,{width:"100%",height:"100%",flex:"1",position:"absolute",zIndex:"4",textAlign:"center",display:"flex",fontSize:"9px",backgroundColor:"rgba(255, 255, 254, 1.0)",alignItems:"center",justifyContent:"center"}),fe.append(this.mViewRenderCanvas,this.mLoadContainer);var a=fe.createElement("div");fe.setStyle(a,"width","20%"),fe.append(this.mLoadContainer,a);var u=fe.createElement("div");fe.setHtml(u,'<div class="lds-ellipsis"><div></div><div></div><div></div><div></div></div>'),fe.append(a,u),r.showProgress&&(this.mProgressContainer=fe.createElement("div"),fe.setAttribute(this.mProgressContainer,"id","xpv__viewer_progress_container"),fe.setStyle(this.mProgressContainer,"width","100%"),fe.append(a,this.mProgressContainer))}var t,r,o,i;return t=e,r=[{key:"init",value:function(){var e=this;this.mViewportRenderer=new u.g(this.mEditor,this),this.mViewportRenderer.addController(new s.x),this.mViewportRenderer.addController(new l.H),this.mViewportRenderer.addController(new f.N);var t=new se;this.mViewportRenderer.addController(t),this.isSubProductsRotationAllowed()?(t.DisableRotationAxis(Y.X|Y.Z),t.EnableRotation()):t.DisableRotation(),!0===window.expivi.isMobile?this.mViewportRenderer.addController(new P):this.mViewportRenderer.addController(new y.q),this.mViewportRenderer.initialize(),this.mCameras=new Array,this._subscriptions.push(this.mEditor.observeEvents(v.G.WindowResized).subscribe(this.windowResizeHandler),this.mEditor.observeEvents(v.G.NodeAdded).subscribe(this.objectAddedHandler),this.mEditor.observeEvents(v.G.NodeRemoved).subscribe(this.objectRemovedHandler),this.mEditor.observeEvents(v.G.BuildStarted).subscribe(this.buildStartedHandler),this.mEditor.observeEvents(v.G.BuildFinished).subscribe(this.buildReadyHandler),this.mEditor.observeEvents(v.G.BatchProgress).subscribe(this.buildProgressHandler),this.mEditor.observeEvents(v.G.RequestFrame).subscribe((function(){return e.mRenderRepeat=10})),this.mEditor.observeMessages(d.u.TypeRTTI).subscribe((function(t){return e.dispatchMessageToViewport(t)})),this.mEditor.observeMessages(pe.U.TypeRTTI).subscribe((function(t){return e.dispatchMessageToViewport(t)})));var n=this.mRenderStream.pipe((0,x.p)(16),(0,de.b)((function(){e.renderView()})),(0,he.b)(300)).subscribe((function(){e.renderEffects()}));this._subscriptions.push(n),this._viewInit(),this.mToolbar=new pr(this.mEditor,this.mViewRenderCanvas),this.mToolbar.init(),this.mToolbarView=new hr(this.mViewRenderCanvas,this.mEditor,this.mToolbar),this.mToolbarView.init()}},{key:"destroy",value:function(){this.mToolbar.dispose(),this.mToolbarView.dispose(),this.mViewportRenderer.dispose(),this.mRenderActive=!1,this.mClock.stop(),this._subscriptions.splice(0).forEach((function(e){return e.unsubscribe()})),this.mCameras=null,fe.off(this.mViewRenderCanvas,"mousedown"),fe.off(this.mViewRenderCanvas,"mouseup"),fe.off(this.mViewRenderCanvas,"mousemove"),fe.off(this.mViewRenderCanvas,"mouseleave"),fe.off(this.mViewRenderCanvas,"dblclick"),fe.off(this.mViewRenderCanvas,"touchstart"),fe.off(this.mViewRenderCanvas,"touchend"),fe.off(this.mViewRenderCanvas,"touchmove"),this.dropzone&&(this.dropzone.destroy(),this.dropzone=null)}},{key:"_viewInit",value:function(){var e=this;this.mViewRenderCanvas.appendChild(this.mEditor.getRenderer().domElement),this.mViewRenderCanvas.appendChild(this.mEditor.getUiRenderer().renderDom),fe.on(this.mViewRenderCanvas,"mousedown",(function(t){return e.handleViewMouseDown(t)})),fe.on(this.mViewRenderCanvas,"touchstart",(function(t){return e.handleViewMouseDown(t)})),fe.on(this.mViewRenderCanvas,"mouseup",(function(t){return e.handleViewMouseUp(t)})),fe.on(this.mViewRenderCanvas,"touchend",(function(t){return e.handleViewMouseUp(t)})),fe.on(this.mViewRenderCanvas,"mousemove",(function(t){return e.handleViewMouseMove(t)})),fe.on(this.mViewRenderCanvas,"touchmove",(function(t){return e.handleViewMouseMove(t)})),fe.on(this.mViewRenderCanvas,"dblclick",(function(t){return e.handleDoubleClick(t)})),fe.on(this.mViewRenderCanvas,"mouseleave",(function(t){return e.handleMouseLeave(t)})),this.dropzone=window.expivi.interact().dropzone({droppable:this.mViewRenderCanvas,ondropped:function(t){if(!(0,n.isNullOrUndefined)(t)){var r=t.originalSource;r&&(r.hasAttribute("data-product")||r.hasAttribute("data-model"))&&e.onItemDropped(t)}}}),this.mViewportRenderer.setViewContainer(this.mViewRenderCanvas),this.mViewportRenderer.dispatchMessage(new p.f),this.mEditor.getCamera().position.copy(new THREE.Vector3(2,3,0)),this.mClock.start(),this.mRenderActive=!0,this.animateView(),this.updateViewportSize()}},{key:"loaderVisible",value:function(e){this.mLightLoader=e,this.updateLoader()}},{key:"forcePushLoader",value:function(){this.mKeepLoaderOnScreen+=1,this.updateLoader()}},{key:"forcePopLoader",value:function(){this.mKeepLoaderOnScreen-=this.mKeepLoaderOnScreen>0?1:0,this.updateLoader()}},{key:"setLoaderVisible",value:function(e){this.mShowLoader=e,this.updateLoader()}},{key:"getViewportRenderer",value:function(){return this.mViewportRenderer}},{key:"interactWithViewer",value:function(){var e=this;clearTimeout(this.mInteractTimeout),this.mViewRenderCanvas.classList.add("interacted"),this.mInteractTimeout=setTimeout((function(){e.mViewRenderCanvas.classList.remove("interacted")}),250)}},{key:"handleViewMouseDown",value:function(e){this.interactWithViewer(),this.mViewportRenderer.mouseDown(e)}},{key:"handleViewMouseUp",value:function(e){this.interactWithViewer(),this.mViewportRenderer.mouseUp(e)}},{key:"handleViewMouseMove",value:function(e){this.interactWithViewer(),this.mViewportRenderer.mouseMove(e)}},{key:"handleMouseLeave",value:function(e){this.interactWithViewer(),this.mViewportRenderer.mouseLeave(e)}},{key:"handleDoubleClick",value:function(e){this.interactWithViewer(),this.mViewportRenderer.mouseDbClick(e)}},{key:"onItemDropped",value:function(e){try{var t=e.clientX||0,n=e.clientY||0,r=e.originalSource,o=r.dataset.product||void 0,i=r.dataset.model||void 0;this.mViewportRenderer.dropItem({position:new THREE.Vector2(t,n),dragData:{model_id:i,product_id:o,target:r,dropzone:e.currentTarget,types:["dragend","dropped"]}})}catch(e){b.qL.error("onItemDropped error: ",e)}}},{key:"onItemDragStart",value:function(e){try{var t=e.clientX||0,n=e.clientY||0,r=e.originalSource;this.mViewportRenderer.dragStart({position:new THREE.Vector2(t,n),dragData:{target:r,types:["dragstart"]}})}catch(e){b.qL.error("onItemDragStart error: ",e)}}},{key:"onItemDragMove",value:function(e){try{var t=e.clientX||0,n=e.clientY||0,r=e.originalSource;this.mViewportRenderer.dragMove({position:new THREE.Vector2(t,n),dragData:{target:r,types:["dragmove"]}})}catch(e){b.qL.error("onItemDragMove error: ",e)}}},{key:"onItemDragEnd",value:function(e){try{var t=e.clientX||0,n=e.clientY||0,r=e.originalSource;this.mViewportRenderer.dragEnd({position:new THREE.Vector2(t,n),dragData:{target:r,types:["dragend"]}})}catch(e){b.qL.error("onItemDragEnd error: ",e)}}},{key:"updateViewportSize",value:function(){var e=this,t=this.mViewRenderCanvas.offsetWidth,n=this.mViewRenderCanvas.offsetHeight;this.mEditor.getCamera().aspect=t/n,this.mEditor.getCamera().updateProjectionMatrix(),this.mEditor.getRenderer().setSize(t,n),this.mEditor.getUiRenderer().resize(t,n),this.mViewportRenderer.resize(t,n),setTimeout((function(){e.mCameraButtonTop=n-75,e.mViewRenderSize.set(t,n)}),0)}},{key:"updateLoader",value:function(){var e=this;this.mBuildReady&&0===this.mKeepLoaderOnScreen&&"transparent"!==fe.getStyle(this.mLoadContainer,"backgroundColor")&&setTimeout((function(){fe.setStyle(e.mLoadContainer,"backgroundColor","transparent")}),100),!this.mBuildReady||this.mShowLoader||this.mLightLoader||this.mKeepLoaderOnScreen>0?"none"===fe.getStyle(this.mLoadContainer,"display")?null===this.mLoadDisplayDelay&&(b.qL.print("show loader with delay"),this.mLoadDisplayDelay=setTimeout((function(){e._showLoader()}),300)):this._showLoader():(null!==this.mLoadDisplayDelay&&(clearTimeout(this.mLoadDisplayDelay),this.mLoadDisplayDelay=null),fe.setStyle(this.mLoadContainer,"display","none"))}},{key:"_showLoader",value:function(){if(fe.setStyle(this.mLoadContainer,"display","flex"),!(0,n.isNullOrUndefined)(this.mProgressContainer)){var e=this.mBuildProgress>0?this.mBuildProgress:0;!this.mBuildReady&&this.mBuildProgress<0||this.mBuildReady&&0===e?fe.setHtml(this.mProgressContainer,""):fe.setHtml(this.mProgressContainer,'<div style="margin: auto;width: 100%;height: 1px;color:#dba19a;">\n                                <div style="height: 100%;width: '.concat(e,'%;background: linear-gradient(to right, red , yellow)"></div>\n                                ').concat(e,"%\n                            </div>"))}}},{key:"syncCameras",value:function(){var e=this;this.mCameras=new Array,this.mEditor.getSceneManager().findNodesOfType(c.g.TypeRTTI).forEach((function(t){e.mCameras.push(t)}))}},{key:"dispatchMessageToViewport",value:function(e){b.qL.print("dispatch message to viewport renderer: ",this.mViewportRenderer,"message: ",e),(0,n.isNullOrUndefined)(this.mViewportRenderer)||this.mViewportRenderer.dispatchMessage(e)}},{key:"moveToCamera",value:function(e,t){this.mViewportRenderer.dispatchMessage(new d.u(e))}},{key:"moveCameraToPoint",value:function(e,t){this.mViewportRenderer.dispatchMessage(new h.G(e,t))}},{key:"renderCamera",value:(o=regeneratorRuntime.mark((function e(t,n){var r,o,i=this,a=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>2&&void 0!==a[2]?a[2]:"image/jpeg",o=a.length>3?a[3]:void 0,e.abrupt("return",new Promise((function(e,a){var u=new THREE.Vector3,s=new THREE.Euler,l=new THREE.Quaternion;i.mEditor.getCamera().getWorldPosition(u),i.mEditor.getCamera().getWorldQuaternion(l),s.setFromQuaternion(l);var f=!1;switch(t){case ye._.FIRST_POSITION:b.qL.print("rendering first",t);var p=i.mEditor.getSceneManager().findNodesOfType(c.g.TypeRTTI);p.length>0?i.mViewportRenderer.dispatchMessage(new d.u(p[0].getSceneObjectId(),!1)):i.mViewportRenderer.dispatchMessage(new me.j(ye._.FIT_OBJECT_FRONT,n,!1));break;case ye._.FIT_OBJECT_FRONT:case ye._.FIT_OBJECT_BACK:case ye._.FIT_OBJECT_LEFT:case ye._.FIT_OBJECT_RIGHT:case ye._.FIT_OBJECT_TOP:case ye._.FIT_OBJECT_BOTTOM:b.qL.print("rendering fit",t),i.mViewportRenderer.dispatchMessage(new me.j(t,n,!1));break;case ye._.CUSTOM_CAMERA_POSITION:var y=new THREE.Vector3(0,0,0),m=new THREE.Euler(0,0,0);if(y.copy(u),m.copy(s),o)if(Array.isArray(o.position)?y.fromArray(o.position):o.position&&y.set(Number(o.position.x)||0,Number(o.position.y)||0,Number(o.position.z)||0),o.direction){var v=new THREE.Vector3;Array.isArray(o.direction)?v.fromArray(o.direction):(v.copy(o.direction),v.set(Number(o.direction.x)||0,Number(o.direction.y)||0,Number(o.direction.z)||0));var g=(new THREE.Matrix4).lookAt(v,new THREE.Vector3(0,0,0),new THREE.Vector3(0,1,0));m.setFromRotationMatrix(g)}else if(o.quaternion){var w=new THREE.Quaternion;Array.isArray(o.quaternion)?w.fromArray(o.quaternion):w.set(Number(o.quaternion.x)||0,Number(o.quaternion.y)||0,Number(o.quaternion.z)||0,isNaN(o.quaternion.w)?1:Number(o.quaternion.w)),m.setFromQuaternion(w)}else if(o.rotation){var _=new THREE.Euler;Array.isArray(o.rotation)?_.fromArray(o.rotation):_.set(Number(o.rotation.x)||0,Number(o.rotation.y)||0,Number(o.rotation.z)||0,o.rotation.order||"XYZ"),m.copy(_)}b.qL.print("renderCamera CUSTOM_CAMERA_POSITION",y,m),i.mViewportRenderer.dispatchMessage(new h.G(y,m.toVector3(),h.H.PUSH_CONTROLLER,1,!0)),f=!0;break;default:b.qL.print("rendering default",t);var O=i.mEditor.getSceneManager().getActiveCameraId();ve.F.isNumeric(O)?i.mViewportRenderer.dispatchMessage(new d.u(O,!1)):i.mViewportRenderer.dispatchMessage(new me.j(ye._.FIT_OBJECT_FRONT,n,!1))}var T=function(){setTimeout((function(){i.renderView();var t=["image/jpeg","image/png","image/tiff"].find((function(e){return e===r}));void 0===t&&(t="image/jpeg");var n=i.mEditor.getRenderer().domElement.toDataURL(t);f&&i.mViewportRenderer.dispatchMessage(new h.G(u,s.toVector3(),h.H.POP_CONTROLLER,1,!0)),e(n)}),1)};i.mEditor.getSceneManager().buildScene().subscribe((function(){return T()}),(function(){return T()}))})));case 3:case"end":return e.stop()}}),e)})),i=function(){var e=this,t=arguments;return new Promise((function(n,r){var i=o.apply(e,t);function a(e){yr(i,n,r,a,u,"next",e)}function u(e){yr(i,n,r,a,u,"throw",e)}a(void 0)}))},function(e,t){return i.apply(this,arguments)})},{key:"animateView",value:function(){var e=this;window.requestAnimationFrame((function(t){if(e&&e.mRenderActive){var n=e.mClock.getDelta();e.mViewportRenderer.update(n),e.mRenderRepeat>0&&(e.mRenderRepeat-=1,e.mRenderStream.next()),e.animateView()}}))}},{key:"renderView",value:function(){this.mEditor.updateBeforeRender(),this.mViewportRenderer.draw(this.mEditor.getRenderer(),this.mEditor.getCamera(),this.mEditor.getScene()),this.mViewportRenderer.postDraw(this.mEditor.getRenderer(),this.mEditor.getCamera(),this.mEditor.getScene())}},{key:"renderEffects",value:function(){this.mEditor.getSceneHelpers().updateMatrixWorld(!0),this.mEditor.getScene().updateMatrixWorld(!0),this.mViewportRenderer.postEffects(this.mEditor.getRenderer(),this.mEditor.getCamera(),this.mEditor.getScene())}},{key:"isSubProductsRotationAllowed",value:function(){var e=this.mEditor.getSettings().getCatalogueMeta().allowSubProductRotation;return"boolean"!=typeof e||e}}],r&&mr(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),br=__webpack_require__(60216),gr=__webpack_require__(8438),wr=__webpack_require__(67988),_r=__webpack_require__(8614),Or=__webpack_require__(87974),Tr=__webpack_require__(83194),Rr=__webpack_require__(49575),Sr=__webpack_require__(27109),Er=__webpack_require__(39030),Pr=__webpack_require__(75736);function xr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var jr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mLoader=null,this.mLocales=null}var n,r,o;return n=e,o=[{key:"getInstance",value:function(){return null===this._instance&&(this._instance=new this),this._instance}}],(r=[{key:"getSupportedLocales",value:function(){var e=this;return new Promise((function(t,n){null!=e.mLocales?t(e.mLocales):e.sync().pipe((0,Ne.q)(1)).subscribe((function(){t(e.mLocales)}),(function(e){return n(e)}))}))}},{key:"resetCache",value:function(){return this.disposeLoader(),this}},{key:"disposeLoader",value:function(){null!==this.mLoader&&this.mLoader.error("Disposed"),this.mLoader=null}},{key:"sync",value:function(){var e=this;return null===this.mLoader&&(this.mLoader=new t.t(1),Ee.O.getInstance().get(N.E.apiUrl+"team/current").then((function(t){if(!t||200!==t.status)throw e.mLocales=null,"Api responded with status:"+t.status;try{var n=t.data.data.attributes.languages;e.mLocales=[],n.forEach((function(t){e.mLocales.push(t.code)})),null!==e.mLoader&&e.mLoader.next(e.mLocales)}catch(t){throw e.mLocales=null,t}})).catch((function(t){e.mLocales=null,null!==e.mLoader&&(e.mLoader.error("Failed resolve locale data"),e.mLoader=null)}))),this.mLoader}}])&&xr(n.prototype,r),o&&xr(n,o),Object.defineProperty(n,"prototype",{writable:!1}),e}();jr._instance=null;var Cr,kr=__webpack_require__(66008),Mr=__webpack_require__(19790);!function(e){e.REPLICA="REPLICA",e.ORIGINAL="ORIGINAL"}(Cr||(Cr={}));var Dr=__webpack_require__(73046);function Ar(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function Ir(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Ar(i,r,o,a,u,"next",e)}function u(e){Ar(i,r,o,a,u,"throw",e)}a(void 0)}))}}function Nr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}__webpack_require__(2707);var Vr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r,o,i;return t=e,n=[{key:"resolveProducts",value:(i=Ir(regeneratorRuntime.mark((function e(){var t,n,r,o,i,a,u,c,s=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:0,n=s.length>1&&void 0!==s[1]?s[1]:12,r=s.length>2&&void 0!==s[2]?s[2]:[],o=s.length>3?s[3]:void 0,i=s.length>4?s[4]:void 0,a={active:1,limit:n,cursor:t,include:r.join(",")},i&&(a.category=i),o&&(a.sort=o),e.next=10,Ee.O.getInstance().get("catalogue",{params:a});case 10:return u=e.sent,c=u.data,e.abrupt("return",Ue.FG.getItemsWithRelations(c));case 13:case"end":return e.stop()}}),e)}))),function(){return i.apply(this,arguments)})},{key:"resolveProduct",value:(o=Ir(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ee.O.getInstance().get("catalogue/".concat(t));case 2:return n=e.sent,r=n.data,e.abrupt("return",Ue.FG.getItem(r));case 5:case"end":return e.stop()}}),e)}))),function(e){return o.apply(this,arguments)})}],r=[{key:"getInstance",value:function(){return null===this._instance&&(this._instance=new this),this._instance}}],n&&Nr(t.prototype,n),r&&Nr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ur(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Fr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Vr._instance=null;var Br=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Ur(this,e),this.position=new THREE.Vector3,this.quaternion=new THREE.Quaternion,this.scale=new THREE.Vector3(1,1,1),Object.assign(this,t)}var t,n;return t=e,(n=[{key:"rotation",get:function(){return(new THREE.Euler).setFromQuaternion(this.quaternion)},set:function(e){this.quaternion.setFromEuler(e)}}])&&Fr(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Lr=__webpack_require__(97962),Hr=__webpack_require__(41766);function zr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qr(e,t,n){return t&&zr(e.prototype,t),n&&zr(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Gr=qr((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}));function Wr(e){return Wr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wr(e)}function Qr(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function Kr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Yr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Zr(e,t){return Zr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Zr(e,t)}function Xr(e,t){if(t&&("object"===Wr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Jr(e){return Jr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Jr(e)}var $r=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Zr(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Jr(r);if(o){var n=Jr(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Xr(this,e)});function a(){var e;return Kr(this,a),(e=i.apply(this,arguments)).mCache=new Map,e}return t=a,n=[{key:"get",value:function(){var e,t=(e=regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.mCache.has(t)){e.next=2;break}return e.abrupt("return",this.mCache.get(t));case 2:return e.next=4,Ee.O.getInstance().get("".concat(N.E.apiUrl,"attributes/").concat(t,"/gallery"));case 4:if(200===(n=e.sent).status&&n.data){e.next=7;break}throw new Error("Failed to retrieve results");case 7:return r=n.data,this.mCache.set(t,r),e.abrupt("return",r);case 10:case"end":return e.stop()}}),e,this)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Qr(i,r,o,a,u,"next",e)}function u(e){Qr(i,r,o,a,u,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}()}],n&&Yr(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(Gr);function eo(e){return eo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},eo(e)}function to(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function no(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ro(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function oo(e,t){return oo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},oo(e,t)}function io(e,t){if(t&&("object"===eo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ao(e){return ao=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ao(e)}var uo=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oo(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ao(r);if(o){var n=ao(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return io(this,e)});function a(){var e;return no(this,a),(e=i.apply(this,arguments)).mCache=new Map,e}return t=a,n=[{key:"get",value:function(){var e,t=(e=regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.mCache.has(t)){e.next=2;break}return e.abrupt("return",this.mCache.get(t));case 2:return e.next=4,Ee.O.getInstance().get("".concat(N.E.apiUrl,"media/").concat(t));case 4:if(200===(n=e.sent).status&&n.data){e.next=7;break}throw new Error("Failed to retrieve results");case 7:return r=n.data.data,this.mCache.set(t,r),e.abrupt("return",r);case 10:case"end":return e.stop()}}),e,this)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){to(i,r,o,a,u,"next",e)}function u(e){to(i,r,o,a,u,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}()}],n&&ro(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(Gr),co=__webpack_require__(9896);function so(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function lo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?so(Object(n),!0).forEach((function(t){fo(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):so(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function fo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function po(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=ho(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw i}}}}function ho(e,t){if(e){if("string"==typeof e)return yo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?yo(e,t):void 0}}function yo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function mo(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function vo(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){mo(i,r,o,a,u,"next",e)}function u(e){mo(i,r,o,a,u,"throw",e)}a(void 0)}))}}function bo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}__webpack_require__(49337),__webpack_require__(33321);var go=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mProductNode=t.getSceneManager().getActiveProductNode(),this.mCalculatorList=[],this.mExcludePriceZero=!0}var t,n,r,o;return t=e,n=[{key:"setExcludePriceZero",value:function(e){this.mExcludePriceZero=e}},{key:"get",value:function(){var e=vo(regeneratorRuntime.mark((function e(){var t,n,r,o,i,a,u,c,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Ee.O.getInstance(),n=t.getAcceptLanguage(),r=t.getCountry(),e.next=5,this._getCalculatorList();case 5:o={},i=0,a={},u=po(this.mCalculatorList),e.prev=9,u.s();case 11:if((c=u.n()).done){e.next=18;break}return s=c.value,e.next=15,this.getBreakDownFromCalculator(s,a,o);case 15:a=e.sent;case 16:e.next=11;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(9),u.e(e.t0);case 23:return e.prev=23,u.f(),e.finish(23);case 26:return i=this.addTotals(o,i),o=Object.assign(o,{total:i}),e.abrupt("return",lo(lo({locale:n,country:r},a),{},{total:o}));case 29:case"end":return e.stop()}}),e,this,[[9,20,23,26]])})));return function(){return e.apply(this,arguments)}}()},{key:"_getCalculatorList",value:(o=vo(regeneratorRuntime.mark((function e(){var t,n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.mProductNode,r=n.getComponent("priceManager"),e.next=4,r.requestPriceBreakDown();case 4:o=e.sent,(t=this.mCalculatorList).push.apply(t,function(e){if(Array.isArray(e))return yo(e)}(i=o.calculators)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(i)||ho(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),this.mConfigurableNode=o.configurableNode,this.mPricingData=o.pricingData;case 8:case"end":return e.stop()}var i}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"getBreakDownFromCalculator",value:(r=vo(regeneratorRuntime.mark((function e(t,n,r){var o,i,a,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={totals:{base:0},models:[],catalogue:this.mPricingData.catalogue},e.next=3,t.calculate(o,this.mPricingData,this.mProductNode,this.mConfigurableNode);case 3:if(null!=(i=e.sent).totals){e.next=6;break}return e.abrupt("return");case 6:return e.prev=6,e.next=9,t.breakDown(this.mProductNode,{excludePriceZero:this.mExcludePriceZero},this.mPricingData,this.mConfigurableNode);case 9:(a=e.sent)&&(n=lo(lo({},n),a)),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(6),b.qL.warn("Failed to get breakDown of aCalculator:",e.t0);case 16:return u=t.getBreakDownName(),r[u]=i.totals.base,e.abrupt("return",n);case 19:case"end":return e.stop()}}),e,this,[[6,13]])}))),function(e,t,n){return r.apply(this,arguments)})},{key:"addTotals",value:function(e,t){for(var n in e)t+=e[n];return t}}],n&&bo(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function wo(e){return wo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wo(e)}function _o(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function Oo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function To(e,t){return To=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},To(e,t)}function Ro(e,t){if(t&&("object"===wo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function So(e){return So=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},So(e)}var Eo=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&To(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=So(r);if(o){var n=So(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Ro(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this)).mEditor=e,t}return t=a,n=[{key:"setDiagnostic",value:function(e){return"price-breakdown"===e?this.mService=new go(this.mEditor):b.qL.error("Unknown diagnostic service."),this.mService}},{key:"get",value:function(){var e,t=(e=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this.mService){e.next=3;break}throw new Error("Diagnostic service not defined");case 3:return e.abrupt("return",this.mService.get());case 6:e.prev=6,e.t0=e.catch(0),b.qL.error(e.t0.message);case 9:case"end":return e.stop()}}),e,this,[[0,6]])})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){_o(i,r,o,a,u,"next",e)}function u(e){_o(i,r,o,a,u,"throw",e)}a(void 0)}))});return function(){return t.apply(this,arguments)}}()}],n&&Oo(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(Gr);function Po(e){return Po="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Po(e)}function xo(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return jo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jo(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw i}}}}function jo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Co(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function ko(e,t){return ko=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ko(e,t)}function Mo(e,t){if(t&&("object"===Po(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Do(e){return Do=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Do(e)}function Ao(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Io(e,t,n){return t&&Ao(e.prototype,t),n&&Ao(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function No(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Vo=Io((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;No(this,e),this.id=++e.sId,this.action=t,this.priority=n}));Vo.sId=0;var Uo=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ko(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Do(r);if(o){var n=Do(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Mo(this,e)});function a(){var e;return No(this,a),(e=i.call(this)).mHooks=new Map,e}return Io(a,[{key:"hasHook",value:function(e){return this.mHooks.has(e)}},{key:"registerAction",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;if(!t)throw new Error("Unable to register hook.");this.mHooks.has(e)||this.mHooks.set(e,[]);var r=this.mHooks.get(e)||[],o=new Vo(t,n);return r.push(o),this.mHooks.set(e,r),o.id}},{key:"unregisterAction",value:function(e){var t=this;this.mHooks.forEach((function(n,r){var o=n.findIndex((function(t){return t.id===e}));o>=0&&t.mHooks.get(r).splice(o,1)}))}},{key:"unregisterHook",value:function(e){this.mHooks.has(e)&&this.mHooks.delete(e)}},{key:"executeHook",value:(t=regeneratorRuntime.mark((function e(t,n){var r,o,i,a,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.mHooks.has(t)){e.next=2;break}return e.abrupt("return",n);case 2:(r=this.mHooks.get(t)).sort((function(e,t){return e.priority-t.priority})),o=n,e.prev=5,i=xo(r),e.prev=7,i.s();case 9:if((a=i.n()).done){e.next=16;break}return u=a.value,e.next=13,u.action(o);case 13:o=e.sent;case 14:e.next=9;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(7),i.e(e.t0);case 21:return e.prev=21,i.f(),e.finish(21);case 24:e.next=29;break;case 26:e.prev=26,e.t1=e.catch(5),b.qL.error("Unable to execute hook (".concat(t,"):"),e.t1);case 29:return e.abrupt("return",o);case 30:case"end":return e.stop()}}),e,this,[[5,26],[7,18,21,24]])})),n=function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(e){Co(i,r,o,a,u,"next",e)}function u(e){Co(i,r,o,a,u,"throw",e)}a(void 0)}))},function(e,t){return n.apply(this,arguments)})},{key:"get",value:function(e,t){throw new Error("Method not implemented.")}}],[{key:"getInstance",value:function(){return this.sInstance||(this.sInstance=new a),this.sInstance}}]),a}(Gr);function Fo(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function Bo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Lo=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r,o,i;return t=e,n=[{key:"resolveCategories",value:(o=regeneratorRuntime.mark((function e(){var t,n,r,o,i,a,u,c=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:0,n=c.length>1&&void 0!==c[1]?c[1]:12,r=c.length>2&&void 0!==c[2]?c[2]:[],o=c.length>3?c[3]:void 0,i={active:1,sort:o,limit:n,cursor:t,include:r.join(",")},e.next=7,Ee.O.getInstance().get("category",{params:i});case 7:return a=e.sent,u=a.data,e.abrupt("return",Ue.FG.getItems(u));case 10:case"end":return e.stop()}}),e)})),i=function(){var e=this,t=arguments;return new Promise((function(n,r){var i=o.apply(e,t);function a(e){Fo(i,n,r,a,u,"next",e)}function u(e){Fo(i,n,r,a,u,"throw",e)}a(void 0)}))},function(){return i.apply(this,arguments)})}],r=[{key:"getInstance",value:function(){return null===this._instance&&(this._instance=new this),this._instance}}],n&&Bo(t.prototype,n),r&&Bo(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ho(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function zo(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Ho(i,r,o,a,u,"next",e)}function u(e){Ho(i,r,o,a,u,"throw",e)}a(void 0)}))}}function qo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Go(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Lo._instance=null;var Wo,Qo=function(){function u(e,t){var o=this,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};qo(this,u),this.mEditorReady=!1,this.mEditInitHash=0,this.mViewInitialized=!1,this.mDefaultOptions={},this.mDefaultMaterials={},this.mDefaultApplied={},this._configurableNodeSubjects={},this.mBlockOptionBuild=!1,this.mContainerWidth=0,this.mContainerHeight=0,this.mContainerObserver=null,this.mRotationActive=!1,this.mRotatingObjects=[],this.mServices=new Map,this._subscriptions=new Array,this.loadConfiguredProduct=zo(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){if((0,n.isNullOrUndefined)(o.mConfiguredProductParam))return t("No reload request");if(!(0,n.isArray)(o.mConfiguredProductParam.configured_products)||0===o.mConfiguredProductParam.configured_products.length)return t("Empty configured list");o.mConfiguredProductParam.configured_products.forEach((function(e){null!==e.uuid&&void 0!==e.uuid||(e.uuid=Fe.F.uuidV4())}));var r=o.mConfiguredProductParam.configured_products[0];(0,n.isNullOrUndefined)(r.version)?t("Could not recognize configured product data type: "+JSON.stringify(o.mConfiguredProductParam)):(o.mConfiguredProducts=o.mConfiguredProductParam.configured_products.filter((function(e){return!(0,n.isNullOrUndefined)(e.version)})),(0,n.isNullOrUndefined)(o.mConfiguredProductParam.bundle_uuid)?o.mConfiguredProducts.length>0&&!(0,n.isNullOrUndefined)(o.mConfiguredProducts[0].bundle_uuid)&&(o.mBundleUUID=o.mConfiguredProducts[0].bundle_uuid):o.mBundleUUID=o.mConfiguredProductParam.bundle_uuid,e(!0))})));case 1:case"end":return e.stop()}}),e)}))),this.reconfigureProduct=zo(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){if((0,n.isNullOrUndefined)(o.mConfiguredProducts)||0===o.mConfiguredProducts.length)return t("Configuration list is empty");o.convertReplicas(),o._propagateEvent("progress_reconfigure",1),b.qL.print("load pre-configuration:",JSON.parse(JSON.stringify(o.mConfiguredProducts)));var r=1/o.mConfiguredProducts.length,a=o._buildHierarchyReconfigure(o.mConfiguredProducts);b.qL.print("load hierarchy:",JSON.parse(JSON.stringify(a)));var u={},c=new Array;a.length>0?function(){var e=new Array;e.push(a[0]);for(var t=0,i=function(){var i=e.pop();if(0===t){var a=o.mEditor.getSceneManager().getActiveProductNode();(0,n.isNullOrUndefined)(i.uuid)||a.setValue("object_uuid",i.uuid),u[i.uuid]=a.getValue("object_uuid"),(0,n.isNullOrUndefined)(i.temporary_uid)||a.setValue("temporary_uid",i.temporary_uid),c.push(zo(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){o.mEditor.getSceneManager().observeActiveBuild().subscribe((function(){return e(!0)}),(function(t){return e(!0)}))})));case 1:case"end":return e.stop()}}),e)})))),c.push(zo(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i,e.abrupt("return",new Promise((function(e,n){(new Er.ConfigurationSerializer).load(o.mEditor.getSceneManager().getActiveProductNode(),t,(function(e){o._propagateEvent("progress_reconfigure",Math.floor(100*e)*r)})).then((function(){return e(!0)}),(function(e){return n(e)}))})));case 2:case"end":return e.stop()}}),e)}))))}else{var s=o.mEditor.getSceneManager().createObject("product",null,i.catalogue_id,!0,i);s.setValue("name","Product id:".concat(i.catalogue_id)),(0,n.isNullOrUndefined)(i.uuid)||s.setValue("object_uuid",i.uuid),u[i.uuid]=s.getValue("object_uuid"),(0,n.isNullOrUndefined)(i.temporary_uid)||s.setValue("temporary_uid",i.temporary_uid),(0,n.isNullOrUndefined)(i.view_position)||3!==i.view_position.length||(s.setValue("position_x",i.view_position[0]),s.setValue("position_y",i.view_position[1]),s.setValue("position_z",i.view_position[2])),(0,n.isNullOrUndefined)(i.view_rotation)||3!==i.view_rotation.length||(s.setValue("rotation_x",i.view_rotation[0]),s.setValue("rotation_y",i.view_rotation[1]),s.setValue("rotation_z",i.view_rotation[2])),(0,n.isNullOrUndefined)(i.clipping_plane)||s.setValue("clipping_plane",i.clipping_plane),(0,n.isNullOrUndefined)(i.place_holder)||s.setValue("place_holder",i.place_holder),c.push(zo(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){var r=o._findProductNode(u[i.parent_uuid]),a=(0,n.isNullOrUndefined)(r)?void 0:r.getSceneObjectId(),c=i.view_id;o.mEditor.getSceneManager().addNode(s,c,a,!1).then((function(){e(!0)}),(function(){t()}))})));case 1:case"end":return e.stop()}}),e)})))),c.push(zo(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i,e.abrupt("return",new Promise((function(e,n){(new Er.ConfigurationSerializer).load(s,t,(function(e){o._propagateEvent("progress_reconfigure",Math.floor(100*e)*r)})).then((function(){return e(!0)}),(function(e){return n(e)}))})));case 2:case"end":return e.stop()}}),e)}))))}i.children.forEach((function(t){return e.push(t)})),t+=1};e.length>0;)i();c.push(zo(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){o.mEditor.getSceneManager().buildScene().subscribe((function(t){return e(t)}),(function(e){return t(e)}))})));case 1:case"end":return e.stop()}}),e)}))))}():t("Did not found the main product"),i.S.executeInOrder(c,(function(t,n){e(0===n.length)}))})));case 1:case"end":return e.stop()}}),e)}))),this.onWindowResized=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=o.mViewContainer.offsetWidth,n=o.mViewContainer.offsetHeight;if(!0===e||t!=o.mContainerWidth||n!=o.mContainerHeight){o.mContainerWidth=t,o.mContainerHeight=n,fe.setStyle(o.mViewWrapper,{width:"".concat(o.mContainerWidth,"px"),height:"".concat(o.mContainerHeight,"px")});var r={width:o.mContainerWidth,height:o.mContainerHeight};o.mEditor.dispatchEvent(v.G.WindowResized,r)}},this._onConfigurableReady=function(e){if(1===o.mEditInitHash){var t=e.findParentOfTypeName("ProductNode").getComponent("materialGroupManager");o._subscriptions.push(t.resolveMaterialGroups().subscribe((function(e){o._subscriptions.push(e.onMaterialVisibility.subscribe((function(e){return o._propagateEvent("materialvisibility",e)})))}))),e.resolveSceneOffsetManager().then((function(e){1===o.mEditInitHash?(o._subscriptions.push(e.onOffsetChanged.subscribe((function(e){return o._propagateEvent("offset",e)})),e.onOffsetVisibility.subscribe((function(e){return o._propagateEvent("offsetvisibility",e)}))),o.initializeCommunicationLayer(),o._propagateReady()):o._propagateReady("Viewer ElementDOM is removed.")}),(function(e){o._propagateReady(e)}))}else o._propagateReady("Viewer ElementDOM is removed.")},a.OE.getInstance().setToken(window.expivi.apiToken),a.OE.getInstance().setAcceptLanguage(c.language),a.OE.getInstance().setCountry(c.country),this.mOptions=Object.assign({cameraDropdownVisible:!1,show360Indicator:!0,showProgress:!0,blockDefaultTouch:!0},c),this.mProductId=Number(e),this.mTemporaryProductId=this.mOptions.temporaryProductId,this.mViewContainer=fe.selectDom(t),this.mViewLayout=fe.createElement("div"),this.mViewWrapper=fe.createElement("div"),this.mContainerWidth=this.mViewContainer.offsetWidth,this.mContainerHeight=this.mViewContainer.offsetHeight;var s=fe.createElement("style");fe.setAttribute(s,"type","text/css"),fe.setHtml(s,'\n            .interact-icon-360-container {\n                position: absolute;\n                width: 100px;\n                height: 58px;\n                background: rgba(38, 36, 36, 0.73);\n                display: none;\n                flex-direction: column;\n                align-items: center;\n                justify-content: center;\n                box-shadow: 1px 4px 4px 0px #5050505c;\n                color: white;\n                border-radius: 50px !important;\n                overflow: hidden;\n                padding: 0.5rem;\n                opacity: 0.9;\n                pointer-events: none;\n                justify-self: center;\n                align-self: center;\n                top: 50%;\n                left: 50%;\n                transform: translate(-50%, -50%);\n            }\n\n            .interact-icon-360-container .animation-wrapper {\n              width: 100%;\n              height: 100%;\n              position: relative;\n              display: flex;\n              justify-content: center;\n            }\n\n            .interact-icon-360-container .animation-wrapper img {\n              position: absolute !important;\n              top: 20px !important;\n            }\n\n            .interact-icon-360-container .animation-wrapper .hand-360 {\n                width: auto !important;\n                max-width: auto !important;\n                height: 38px !important;\n                z-index: 2  !important;\n                opacity: 0.95  !important;\n                background-color: transparent !important;\n                border-radius: 0 !important;\n                margin: 0 !important;\n                color: white !important;\n                padding: 0 !important;\n            }\n\n            .interact-icon-360-container .animation-wrapper .wobble-hor-bottom {\n                -webkit-animation: xpv-wobble-hor-bottom 2.8s ease-in-out infinite both;\n                        animation: xpv-wobble-hor-bottom 2.8s ease-in-out infinite both;\n            }\n\n            /* ----------------------------------------------\n             * Generated by Animista on 2019-6-17 13:26:58\n             * w: http://animista.net, t: @cssanimista\n             * ---------------------------------------------- */\n\n            /**\n             * ----------------------------------------\n             * animation wobble-hor-bottom\n             * ----------------------------------------\n             */\n            @-webkit-keyframes xpv-wobble-hor-bottom {\n              0%,\n              100% {\n                -webkit-transform: translateX(0%);\n                        transform: translateX(0%);\n                -webkit-transform-origin: 50% 50%;\n                        transform-origin: 50% 50%;\n              }\n              15% {\n                -webkit-transform: translateX(-30px) rotate(-6deg);\n                        transform: translateX(-30px) rotate(-6deg);\n              }\n              30% {\n                -webkit-transform: translateX(15px) rotate(6deg);\n                        transform: translateX(15px) rotate(6deg);\n              }\n              45% {\n                -webkit-transform: translateX(-15px) rotate(-3.6deg);\n                        transform: translateX(-15px) rotate(-3.6deg);\n              }\n              60% {\n                -webkit-transform: translateX(9px) rotate(2.4deg);\n                        transform: translateX(9px) rotate(2.4deg);\n              }\n              75% {\n                -webkit-transform: translateX(-6px) rotate(-1.2deg);\n                        transform: translateX(-6px) rotate(-1.2deg);\n              }\n            }\n            @keyframes xpv-wobble-hor-bottom {\n              0%,\n              100% {\n                -webkit-transform: translateX(0%);\n                        transform: translateX(0%);\n                -webkit-transform-origin: 50% 50%;\n                        transform-origin: 50% 50%;\n              }\n              15% {\n                -webkit-transform: translateX(-30px) rotate(-6deg);\n                        transform: translateX(-30px) rotate(-6deg);\n              }\n              30% {\n                -webkit-transform: translateX(15px) rotate(6deg);\n                        transform: translateX(15px) rotate(6deg);\n              }\n              45% {\n                -webkit-transform: translateX(-15px) rotate(-3.6deg);\n                        transform: translateX(-15px) rotate(-3.6deg);\n              }\n              60% {\n                -webkit-transform: translateX(9px) rotate(2.4deg);\n                        transform: translateX(9px) rotate(2.4deg);\n              }\n              75% {\n                -webkit-transform: translateX(-6px) rotate(-1.2deg);\n                        transform: translateX(-6px) rotate(-1.2deg);\n              }\n            }\n\n            .interact-icon-360-container .animation-wrapper .icon-360 {\n                height: auto !important;\n                width: 60% !important;\n                top: 0 !important;\n                background-color: transparent !important;\n                border-radius: 0 !important;\n                margin: 0 !important;\n                color: white !important;\n                padding: 0 !important;\n            }\n\n            .xpv__viewer_toolbar_container .mobile-enabled,\n            .xpv__viewer_toolbar_container .desktop-enabled {\n                display: none;\n            }\n\n            @media screen and (max-width: 768px){\n                .xpv__viewer_toolbar_container .mobile-disabled {\n                    display: none;\n                }\n                .xpv__viewer_toolbar_container .mobile-enabled {\n                    display: block;\n                }\n            }\n\n            @media screen and (min-width: 769px){\n                .xpv__viewer_toolbar_container .desktop-disabled {\n                    display: none;\n                }\n                .xpv__viewer_toolbar_container .desktop-enabled {\n                    display: block;\n                }\n            }\n\n            /*\n                The toolbar is one big flex container. It orders the elements like so:\n\n                 ______________________\n                | 1                  2 |\n                |                      |\n                |                      |\n                |          3           |\n                |      [::after]       |\n                |                      |\n                | 4                  5 |\n                |______________________|\n\n                The ::after element is there purely to force the flex-wrap. The elements\n                get positioned properly using the .top-left, .top-right, .bottom-left and\n                .bottom-right classes (exactly one of those is required).\n            */\n\n            .xpv__viewer_toolbar_container::after {\n                content: "";\n                order: 3;\n                display: block;\n                width: 100%;\n            }\n\n            .xpv__viewer_toolbar_container {\n                display: flex;\n                flex-flow: row wrap;\n                align-items: flex-end;\n                position: absolute;\n                top: 0;\n                left: 0;\n                width: 100%;\n                height: 100%;\n                pointer-events: none;\n                opacity: 0;\n                transition: opacity 1s 4.5s;\n            }\n\n            .xpv__viewer_toolbar_container > * {\n                pointer-events: all;\n            }\n\n            /*\n                Set the position for each corner\n            */\n\n            .xpv__viewer_toolbar_container .top-left {\n                order: 1;\n                align-self: flex-start;\n            }\n            .xpv__viewer_toolbar_container .top-right {\n                order: 2;\n                align-self: flex-start;\n            }\n            .xpv__viewer_toolbar_container .bottom-left {\n                order: 4;\n                align-self: flex-end;\n            }\n            .xpv__viewer_toolbar_container .bottom-right {\n                order: 5;\n                align-self: flex-end;\n            }\n\n            /*\n                Force the items to justify correctly,\n                i.e. force the right side to the right and the left side to the left\n            */\n\n            .xpv__viewer_toolbar_container .top-right { margin-left: auto; }\n            .xpv__viewer_toolbar_container .top-right ~ .top-right { margin-left: 6px; }\n\n            .xpv__viewer_toolbar_container .bottom-right { margin-left: auto; }\n            .xpv__viewer_toolbar_container .bottom-right ~ .bottom-right { margin-left: 6px; }\n\n            .xpv__viewer_toolbar_container button {\n                height: 48px;\n                padding: 6px;\n                margin: 6px;\n                position: relative;\n                color: inherit;\n                background-color: rgba(224, 224, 224, 0.4);\n                border-radius: 30px;\n                border: none;\n                outline: none;\n                cursor: pointer;\n                transition: .3s;\n            }\n\n            .xpv__viewer_toolbar_container button > svg,\n            .xpv__viewer_toolbar_container button > img {\n                height: 100%;\n            }\n\n            .xpv__viewer_toolbar_container button:hover,\n            .xpv__viewer_toolbar_container button:focus {\n                background-color: rgba(175, 175, 175, .4);\n            }\n\n            .xpv__viewer_toolbar_container button:active {\n                background-color: rgba(155, 155, 155, .5);\n            }\n\n            /*\n                Toolbar should appear when hovering the viewer\n            */\n\n            :hover ~ .xpv__viewer_toolbar_container,\n            .interacted > .xpv__viewer_toolbar_container,\n            .xpv__viewer_toolbar_container:hover {\n                opacity: 1;\n                transition: opacity 0s 0s;\n            }\n\n            .xpv__viewer_toolbar_container:focus-within {\n                opacity: 1;\n                transition: opacity 0s 0s;\n            }\n\n            .xpv__viewer_toolbar_group_container {\n                position: relative;\n            }\n\n            .xpv__viewer_toolbar_group_container:not(.open) .xpv__viewer_toolbar_group {\n                opacity: 0;\n                pointer-events: none;\n                transform: scale(0.9, .85);\n            }\n\n            .xpv__viewer_toolbar_group {\n                position: absolute;\n                top: 0;\n                background-color: rgb(238, 238, 238);\n                border-radius: 30px;\n                transition: .3s;\n            }\n\n            .xpv__viewer_toolbar_group > div {\n                display: flex;\n                flex-direction: row;\n            }\n\n            .xpv__viewer_toolbar_group::before {\n                content: "";\n                display: block;\n                width: 30px;\n                height: 30px;\n                position: absolute;\n                top: 50%;\n                transform: translateY(-50%) rotate(45deg);\n                background-color: inherit;\n            }\n\n            .xpv__viewer_toolbar_group_container.top-left .xpv__viewer_toolbar_group {\n                left: calc(100% + 12px);\n                transform-origin: -12px 50%;\n            }\n            .xpv__viewer_toolbar_group_container.top-right .xpv__viewer_toolbar_group {\n                right: calc(100% + 12px);\n                transform-origin: calc(100% + 12px) 50%;\n            }\n            .xpv__viewer_toolbar_group_container.bottom-left .xpv__viewer_toolbar_group,\n            .xpv__viewer_toolbar_group_container.bottom-right .xpv__viewer_toolbar_group {\n                top: auto;\n                bottom: calc(100% + 12px);\n                transform-origin: 50% calc(100% + 12px);\n            }\n            .xpv__viewer_toolbar_group_container.bottom-left .xpv__viewer_toolbar_group {\n                left: 0;\n            }\n            .xpv__viewer_toolbar_group_container.bottom-right .xpv__viewer_toolbar_group {\n                right: 0;\n            }\n\n            .xpv__viewer_toolbar_group_container.top-left .xpv__viewer_toolbar_group::before {\n                left: -2px;\n            }\n            .xpv__viewer_toolbar_group_container.top-right .xpv__viewer_toolbar_group::before {\n                right: -2px;\n            }\n\n            .xpv__viewer_toolbar_group_container.bottom-left .xpv__viewer_toolbar_group::before {\n                top: 75%;\n                left: 15px;\n            }\n            .xpv__viewer_toolbar_group_container.bottom-right .xpv__viewer_toolbar_group::before {\n                top: 75%;\n                right: 15px;\n            }\n\n            #xpv-toolbar-loader {\n                display: flex;\n                flex-direction: column;\n                align-items: center;\n                padding: 12px 18px;\n                position: absolute;\n                top: 50%;\n                left: 50%;\n                transform: translate(-50%, -50%);\n                color: white;\n                background-color: rgb(0, 0, 0, 0.4);\n                border-radius: 12px;\n                z-index: 2;\n            }\n\n            #xpv-toolbar-loader[hidden] { display: none; }\n\n            #xpv-toolbar-loader-icon { height: 60px; }\n            #xpv-toolbar-loader-icon > * { height: 100%; }\n\n            #xpv-toolbar-loader-message {\n                font: 20px / 1.5 Arial, sans-serif;\n            }\n\n            #xpv-toolbar-ar-qr {\n                display: flex;\n                flex-direction: column;\n                align-items: center;\n                justify-content: center;\n                padding: 18px;\n                position: absolute;\n                top: 0;\n                left: 0;\n                width: 100%;\n                height: 100%;\n                color: white;\n                background-color: rgb(0, 0, 0, 0.4);\n                cursor: pointer;\n                z-index: 2;\n            }\n\n            #xpv-toolbar-ar-qr[hidden] { display: none; }\n\n            #xpv-toolbar-ar-qr-code { margin-bottom: 8px; }\n            #xpv-toolbar-ar-qr-message {\n                text-align: center;\n                font: 20px / 1.3 Arial, sans-serif;\n            }\n\n            .xpv-toolbar-item-icon {\n                display: inline-block;\n            }\n            .xpv-toolbar-item-icon-inverted {\n                display: none;\n            }\n\n            .xpv-toolbar-item-inverted .xpv-toolbar-item-icon {\n                display: none;\n            }\n            .xpv-toolbar-item-inverted .xpv-toolbar-item-icon-inverted {\n                display: inline-block;\n            }\n        '),document.getElementsByTagName("head")[0].appendChild(s),fe.setStyle(this.mViewLayout,{overflow:"hidden",width:"100%",height:"auto","min-height":"100%",position:"relative"}),this.mViewContainer.appendChild(this.mViewLayout),fe.setStyle(this.mViewWrapper,{width:"".concat(this.mContainerWidth,"px"),height:"".concat(this.mContainerHeight,"px"),position:"absolute",left:"0",top:"0"}),this.mViewLayout.appendChild(this.mViewWrapper),this.mViewRenderWrapper=fe.createElement("div"),fe.setStyle(this.mViewRenderWrapper,{width:"100%",height:"100%",margin:"0",padding:"0",position:"relative"}),this.mViewWrapper.appendChild(this.mViewRenderWrapper),this.mViewSaveOverlay=fe.createElement("div"),fe.setStyle(this.mViewSaveOverlay,{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",flex:"1",margin:"0",padding:"0",display:"none"}),this.mViewWrapper.appendChild(this.mViewSaveOverlay),this.mOptions.show360Indicator&&(this.mView360Indicator=fe.createElement("div"),fe.setAttribute(this.mView360Indicator,"class","interact-icon-360-container"),fe.setHtml(this.mView360Indicator,'\n                <div class="animation-wrapper">\n                  <img class="icon-360" src="https://admin.expivi.net/assets/system/icons/360-arrow.png">\n                  <img class="hand-360 wobble-hor-bottom" src="https://admin.expivi.net/assets/system/icons/hand-pointer-icon.png" />\n                </div>\n            '),this.mViewWrapper.appendChild(this.mView360Indicator)),this.mDefaultOptions=this.mOptions.defaultOptions||{},this.mDefaultMaterials=this.mOptions.defaultMaterials||{},this.mDefaultApplied=this.mOptions.defaultApplied||{},this.mOptions.configuredProduct&&this.mOptions.configuredProduct.configured_products?this.mConfiguredProductParam=this.mOptions.configuredProduct:this.mConfiguredProductParam=void 0,b.qL.print("default options: ",this.mDefaultOptions,this.mDefaultMaterials,this.mDefaultApplied),this.mEditor=new r.M,!1===this.mOptions.blockDefaultTouch&&this.mEditor.enableState(Mr.D.UNBLOCK_DEFAULT_TOUCH),this.mViewerComponent=new vr(this.mEditor,this.mViewRenderWrapper,this.mOptions),this.preInitializeCommunicationLayer()}var s,l,f,p,d,h,y,m,g,w,_,O,T,R;return s=u,l=[{key:"init",value:(R=zo(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){i.S.completePromise(t._preloadDate()).then((function(){t.mEditorReady=!1,t.mEditInitHash=1;var i=window.MutationObserver||window.WebKitMutationObserver;(0,n.isNullOrUndefined)(i)||(t.mContainerObserver=new i(t.onWindowResized),t.mContainerObserver.observe(t.mViewContainer,{attributes:!0,childList:!1,characterData:!0,subtree:!1})),fe.on(t.mViewContainer,"mousedown",(function(e){return t.handleViewMouseDown(e)})),fe.on(t.mViewContainer,"touchstart",(function(e){return t.handleViewMouseDown(e)}));var a=new gr.i(o.t.getInstance(),(function(e){var r=t._isBundledConfiguration(t.mConfiguredProductParam),o=e.createObject("product",-1,t.mProductId,r);return(0,n.isNullOrUndefined)(t.mTemporaryProductId)||o.setValue("temporary_uid",t.mTemporaryProductId),o}),void 0);t.mEditor.initializeEditor(a,t.mProductId,!0,zo(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t._setupDefaults());case 1:case"end":return e.stop()}}),e)})))).then((function(){1===t.mEditInitHash?(t.mEditorReady=!0,t._subscriptions.push(t.mEditor.observeEvents(v.G.BuildFinished).subscribe((function(){t._propagateEvent("buildready")})),t.mEditor.observeEvents(v.G.BuildUpdated).subscribe((function(){return t._propagateEvent("buildupdated")})),t.mEditor.observeEvents(v.G.RequestFrame).subscribe((function(){return t._propagateEvent("frame")})),t.mEditor.observeEvents(v.G.ObjectSelected).subscribe((function(e){return t._propagateEvent("selected",e)})),t.mEditor.observeEvents(v.G.SceneObjectAttached).subscribe((function(e){return t._propagateEvent("attached",e)})),t.mEditor.observeEvents(v.G.SceneObjectDetached).subscribe((function(e){return t._propagateEvent("detached",e)})),t.mEditor.observeEvents(v.G.WindowResized).subscribe((function(){return t._propagateEvent("size")})),t.mEditor.observeEvents(v.G.ProductOptionChanged).pipe((0,de.b)((function(e){t._propagateEvent("attribute",e.getData())})),(0,kr.h)((function(){return!t.mBlockOptionBuild})),(0,de.b)((function(e){return e.getData().rebuild&&t.mEditor.deactivateEventType(v.G.RequestFrame),e})),(0,he.b)(100)).subscribe((function(e){t._updateOptions(e.getData())})),t.mEditor.observeEvents(v.G.ProductAttributeUpdated).subscribe((function(e){t._propagateEvent("attribute_update",e.getData())})),t.mEditor.observeEvents(v.G.ProductArticlesChanged).subscribe((function(e){t._propagateEvent("article_change",e.getData())})),t.mEditor.observeEvents(v.G.ProductMaterialChanged).subscribe((function(e){return t._propagateEvent("material",e.getData())})),t.mEditor.observeEvents(v.G.ZoomChanged).subscribe((function(e){return t._propagateEvent("zoom")})),t.mEditor.observeEvents(v.G.Warning).subscribe((function(e){return t._propagateEvent("alert",e.getData())})),t.mEditor.observeEvents(v.G.Shared).subscribe((function(e){return t._propagateEvent("shared",e.getData())})),t.mEditor.observeEvents(v.G.PlaySound).subscribe((function(e){return t.playSound(e)})),t.mEditor.observeMessages(Rr.Z.TypeRTTI).subscribe((function(e){return t.setOptionVisibility(e)})),t.mEditor.observeMessages(Sr.G.TypeRTTI).subscribe((function(e){return t.setPriceVisibility(e)})),t.mEditor.observeMessages(Dr.y.TypeRTTI).subscribe((function(e){t._propagateEvent("dropzone",{dropped:e.isDroppedInDropZone,data:e.data})})),t.mEditor.observeEvents(v.G.ProductAttributeModerated).subscribe((function(e){t._propagateEvent("attribute_moderated",e.getData())}))),t._resolveConfigurableNode().subscribe((function(e){b.qL.print("root configurable node ready: ",e),t._onConfigurableReady(e)})),t.mViewerComponent.init(),t.mViewInitialized=!0,(0,n.isNullOrUndefined)(t.mView360Indicator)||fe.setStyle(t.mView360Indicator,"display","flex"),e(t.mEditor)):r("App was destroyed before being initialized")}),(function(){})),window.addEventListener("resize",t.onWindowResized)}),(function(){}))})));case 1:case"end":return e.stop()}}),e)}))),function(){return R.apply(this,arguments)})},{key:"destroy",value:function(){var e=this;fe.off(this.mViewContainer,"mousedown"),fe.off(this.mViewContainer,"touchstart"),window.removeEventListener("resize",this.onWindowResized),null!==this.mContainerObserver&&this.mContainerObserver.disconnect(),this.mEditInitHash=0,this._subscriptions.splice(0).forEach((function(e){return e.unsubscribe()})),this.mEditor.destructEditor(),this.mEditorReady=!1,Ie.Q.getInstance().resetCache(),co.h.getInstance().resetCache(),Le.y.getInstance().resetCache(),o.t.getInstance().setDirty(),Object.keys(this._configurableNodeSubjects).forEach((function(t){e._configurableNodeSubjects[t].error("viewer destroyed")})),this._configurableNodeSubjects={},this.mViewerComponent.destroy(),this.mViewWrapper.parentNode.removeChild(this.mViewWrapper),this.mViewInitialized=!1}},{key:"_preloadDate",value:(T=zo(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){if((0,n.isNullOrUndefined)(t.mOptions.preset)||0===t.mOptions.preset.toString().length)return r();t._resolvePreset(t.mOptions.preset).then((function(n){t.mProductId=Number(n.catalogue_id);var r=n.configuration.configured_products.find((function(e){return e.catalogue_id===t.mProductId}));r&&(r.configuration.attributes=r.configuration.attributes.filter((function(e){return!e.excluded_autoload}))),t.mConfiguredProductParam=t.mConfiguredProductParam||n.configuration,e(!0)}),(function(e){return r(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(){return T.apply(this,arguments)})},{key:"_resolvePreset",value:(O=zo(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){a.OE.getInstance().get(a.E4.makeApiRoute("product_preset/find/"+t)).then((function(t){try{var r=Ue.FG.getItem(t.data);e(r)}catch(e){n(e)}}),(function(e){return n(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(e){return O.apply(this,arguments)})},{key:"handleViewMouseDown",value:function(e){var t=this,r=[];this.mRotatingObjects.forEach((function(e){e.stopOnInteraction&&r.push(e.id)}));for(var o=function(){var e=r.shift();t.mRotatingObjects.splice(t.mRotatingObjects.findIndex((function(t){return t.id==e})),1)};r.length>0;)o();(0,n.isNullOrUndefined)(this.mView360Indicator)||(this.mViewWrapper.removeChild(this.mView360Indicator),this.mView360Indicator=null)}},{key:"_isBundledConfiguration",value:function(e){return!(0,n.isNullOrUndefined)(e)&&(0,n.isArray)(e.configured_products)&&e.configured_products.length>1}},{key:"getEditor",value:function(){return this.mEditor}},{key:"getClientViewer",value:function(){return this.mViewerComponent}},{key:"_setupDefaults",value:(_=zo(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){b.qL.print("editor: ",t.mEditor,"scene manager: ",t.mEditor.getSceneManager()),t.mEditor.getSceneManager().getActiveProductNode().getComponent("attributeManager").resolveAttributeManager().subscribe(function(){var n=zo(regeneratorRuntime.mark((function n(r){var o,i,a;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=0,i=Object.keys(t.mDefaultOptions);case 1:if(!(o<i.length)){n.next=8;break}return a=i[o],n.next=5,r.setValue(parseInt(a,10),t.mDefaultOptions[a],{emitEvent:!1,rebuild:!1});case 5:o++,n.next=1;break;case 8:t.mEditor.getSceneManager().getActiveProductNode().getComponent("materialGroupManager").resolveMaterialGroups().subscribe((function(n){Object.keys(t.mDefaultApplied).forEach((function(e){n.applyActiveMaterial(parseInt(e,10),null,t.mDefaultApplied[e])})),e(!0)}),(function(t){e(!1)}));case 10:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),(function(t){e(!1)}))})));case 1:case"end":return e.stop()}}),e)}))),function(){return _.apply(this,arguments)})},{key:"onClientReady",value:(w=zo(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){t.mBlockOptionBuild=!0,t.mEditor.enableState("reconfigure"),t.mViewerComponent.forcePushLoader(),i.S.executeInOrder([t.loadConfiguredProduct,t.reconfigureProduct],(function(n,r){t.mViewerComponent.loaderVisible(!1),t.mBlockOptionBuild=!1,t.mEditor.disableState("reconfigure"),t._propagateEvent("fully_loaded"),t.mEditor.dispatchEvent(v.G.BuildFullyLoaded),t.mViewerComponent.forcePopLoader(),e(0===r.length)}))})));case 1:case"end":return e.stop()}}),e)}))),function(){return w.apply(this,arguments)})},{key:"convertReplicas",value:function(){var e=this;this.mConfiguredProducts=this.mConfiguredProducts.filter((function(t){if(t.replication_type==Cr.REPLICA){var n=e.mConfiguredProducts.find((function(e){return e.replication_type==Cr.ORIGINAL&&e.catalogue_id==t.catalogue_id&&t.original_uuid==e.uuid}));if(!n)return!1;t.attributes=JSON.parse(JSON.stringify(n.attributes||[])),t.articles=JSON.parse(JSON.stringify(n.articles||[])),t.price=JSON.parse(JSON.stringify(n.price||{base:0})),t.configuration=JSON.parse(JSON.stringify(n.configuration||{attributes:[],materials:{}}))}return!0}))}},{key:"_buildHierarchyReconfigure",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=e.filter((function(e){return e.parent_uuid===r||null===r&&(0,n.isNullOrUndefined)(e.parent_uuid)}));return o.forEach((function(n){n.children=t._buildHierarchyReconfigure(e,n.uuid)})),o}},{key:"optionsLoadingChange",value:function(e){this.mViewerComponent.loaderVisible(e)}},{key:"moveCameraToPoint",value:function(e){(0,n.isUndefined)(this.mViewerComponent)||this.mViewerComponent.moveCameraToPoint(e.origin,e.dir)}},{key:"registerPriceCalculator",value:function(e,t){this._findProductNode(t).getComponent("priceManager").registerPriceCalculator(e)}},{key:"requestPrice",value:(g=zo(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){n._requestPrice(t).then((function(t){e(t.totals.base)}),(function(e){return r(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(e){return g.apply(this,arguments)})},{key:"requestAllPrices",value:(m=zo(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){n._requestPrice(t).then((function(t){e(t.totals)}),(function(e){return r(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(e){return m.apply(this,arguments)})},{key:"requestSupportedLocales",value:(y=zo(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){jr.getInstance().getSupportedLocales().then((function(t){e(t)})).catch((function(e){t(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(){return y.apply(this,arguments)})},{key:"requestOffer",value:function(){}},{key:"_requestPrice",value:(h=zo(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._findProductNode(t),r=n.getComponent("priceManager"),b.qL.print("calculate price with manager: ",r),e.abrupt("return",r.requestPrice());case 4:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"_serializeConfigurations",value:(d=zo(regeneratorRuntime.mark((function e(t){var r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,o){var a=new Array,u=[];u.push({node:r.mEditor.getSceneManager().getRootNode(),parent_uuid:null,view_id:null}),r.mBundleUUID=(0,n.isNullOrUndefined)(r.mBundleUUID)?Fe.F.guid():r.mBundleUUID;for(var c=function(){var e=u.shift(),n=e.parent_uuid,o=e.view_id;e.node.isDerivedTypeOf(Me.L.TypeRTTI)?(a.push(zo(regeneratorRuntime.mark((function n(){var o,i,a,u,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=e.node.getSceneObjectId(),i=e.node.getObjectUUID(),a=e.parent_uuid,u=e.node.getValue("temporary_uid"),c=e.view_id,n.abrupt("return",r._saveConfiguration(o,i,a,c,r.mBundleUUID,u,t));case 6:case"end":return n.stop()}}),n)})))),n=e.node.getObjectUUID()):e.node.isDerivedTypeOf(ke.Re.TypeRTTI)&&(o=e.node.getViewId()),e.node.isDerivedTypeOf(wr.B.TypeRTTI)&&e.node.getChildren().forEach((function(e){return u.push({node:e,parent_uuid:n,view_id:o})}))};u.length>0;)c();i.S.executeInOrder(a,(function(t,n){n.length>0?o(n[0]):e(t)}),!0)})));case 1:case"end":return e.stop()}}),e)}))),function(e){return d.apply(this,arguments)})},{key:"_saveConfiguration",value:(p=zo(regeneratorRuntime.mark((function e(t,n,r,o,i,a,u){var c=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,s){c._requestPrice(t).then((function(l){var f=c._findProductNode(t);new Er.ConfigurationSerializer(u).save(f,l.models).then((function(t){t.uuid=n,t.parent_uuid=r,t.temporary_uid=a,t.bundle_uuid=i,t.view_id=o,t.view_position=[f.getValue("position_x"),f.getValue("position_y"),f.getValue("position_z")],t.view_rotation=[f.getValue("rotation_x"),f.getValue("rotation_y"),f.getValue("rotation_z")],t.price=l.totals,e(t)}),(function(e){s(e)}))}),(function(e){s(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(e,t,n,r,o,i,a){return p.apply(this,arguments)})},{key:"_updateOptions",value:function(e){var t=this;e.rebuild&&(this.optionsLoadingChange(!0),this._propagateEvent("loading_configuration",!0),b.qL.print("options request scene build"),this.mEditor.getSceneManager().buildScene().subscribe((function(){t.mEditor.activateEventType(v.G.RequestFrame),t.optionsLoadingChange(!1),t._propagateEvent("loading_configuration",!1),t.mEditor.dispatchEvent(v.G.RequestFrame)}),(function(e){t.mEditor.activateEventType(v.G.RequestFrame),t.optionsLoadingChange(!1),t._propagateEvent("loading_configuration",!1),t.mEditor.dispatchEvent(v.G.RequestFrame)})))}},{key:"_findProductNode",value:function(e){var t=null;if((0,n.isNullOrUndefined)(e))t=this.mEditor.getSceneManager().getActiveProductNode();else{var r=this.mEditor.getSceneManager().findNodesOfType(Me.L.TypeRTTI),o=null;Fe.F.isUUID("".concat(e))&&(o=e),r.every((function(n){return null!==o&&n.getObjectUUID()===o?(t=n,!1):null!==o||n.getSceneObjectId()!=e||(t=n,!1)}))}return t}},{key:"_resolveConfigurableNode",value:function(e){var r=this,o=this._findProductNode(e);if(null===o)return(0,n.isNullOrUndefined)(this._configurableNodeSubjects.error)&&(this._configurableNodeSubjects.error=new t.t(1),this._configurableNodeSubjects.error.next(null),this._configurableNodeSubjects.error.error("Product not found")),this._configurableNodeSubjects.error.pipe((0,Ve.P)());var i=o.getSceneObjectId();return(0,n.isNullOrUndefined)(this._configurableNodeSubjects[i])?((0,n.isNullOrUndefined)(this._configurableNodeSubjects[i])&&(this._configurableNodeSubjects[i]=new t.t(1),o.onConfigurableNodeReady.pipe((0,Ve.P)()).subscribe((function(e){return r._configurableNodeSubjects[i].next(e)}))),this._configurableNodeSubjects[i].pipe((0,Ve.P)())):this._configurableNodeSubjects[i].pipe((0,Ve.P)())}},{key:"handleRotations",value:function(){var e=this;if(this.mEditorReady){this.mRotationActive=!0;var t=[];this.mRotatingObjects.forEach((function(e){null===e.rotationY&&(e.rotationY=e.renderObject.rotation.y),e.degree+=200*e.speed,e.maxDegree>=0&&e.degree>e.maxDegree&&(e.degree=e.maxDegree,t.push(e.id)),e.renderObject.rotation.y=e.rotationY+THREE.Math.degToRad(e.degree)}));var r=this.getEditor().getRenderer().shadowMap;if((0,n.isNullOrUndefined)(r)||(r.needsUpdate=!0),this.getEditor().dispatchEvent(v.G.RequestFrame),t.forEach((function(t){var n=e.mRotatingObjects.findIndex((function(e){return e.id===t.id}));n>=0&&e.mRotatingObjects.splice(n,1)})),this.mRotatingObjects.length>0){var o=window.requestAnimationFrame||window.webkitRequestAnimationFrame;(0,n.isNullOrUndefined)(o)||setTimeout((function(){o((function(){return e.handleRotations()}))}),16)}else this.mRotationActive=!1}}},{key:"addPlayRotation",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:360,i=this._findProductNode(e);if(i&&i.hasRenderObject()){var a=this.mRotatingObjects.find((function(e){return e.id==i.getObjectId()}));if((0,n.isNullOrUndefined)(a)){var u=i.getRenderObject().get3DObject();this.mRotatingObjects.push({id:i.getObjectId(),renderObject:u,speed:.001*r,rotationY:null,stopOnInteraction:t,maxDegree:o,degree:0})}else a.speed=.001*r,a.stopOnInteraction=t,a.maxDegree=o;return this.mRotationActive||this.handleRotations(),i}return null}},{key:"preInitializeCommunicationLayer",value:function(){var e=this;window.expivi.getService=function(){var t=zo(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){switch(n){case"image_library":e.mServices.has(n)||e.mServices.set(n,new $r),t(e.mServices.get(n));break;case"media":e.mServices.has(n)||e.mServices.set(n,new uo),t(e.mServices.get(n));break;case"diagnostic":e.mServices.has(n)||e.mServices.set(n,new Eo(e.mEditor)),t(e.mServices.get(n));break;case"hooks":e.mServices.has(n)||e.mServices.set(n,Uo.getInstance()),t(e.mServices.get(n));break;default:r("Unknown service.")}})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}},{key:"initializeCommunicationLayer",value:function(){var t=this;window.expivi.managers.resolveMaterialGroups=function(){var e=zo(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){t._findProductNode(n).getComponent("materialGroupManager").resolveMaterialGroups().subscribe((function(t){e(t.getGroups())}),(function(e){r(e)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),window.expivi.managers.resolveMaterialGroupManager=function(){var e=zo(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){t._findProductNode(n).getComponent("materialGroupManager").resolveMaterialGroups().subscribe((function(t){e(t)}),(function(e){r(e)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),window.expivi.managers.resolveOffsetGroups=function(){var e=zo(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){t._resolveConfigurableNode(n).subscribe((function(t){if(null===t)return r("Failed to get configurable node");t.resolveSceneOffsetManager().then((function(t){e(t.getOffsets())}),(function(e){r(e)}))}),(function(e){return r(e)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),window.expivi.managers.resolveMaterials=function(){var e=zo(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var o=t._findProductNode(n);if(null===o)return r("Could not find product node");var i=o.getValue("product_id");Ie.Q.getInstance().resolveBootstrapData(i).pipe((0,Ne.q)(1)).subscribe((function(t){var n=Ue.FG.getItems(t.getMaterials()),r=[];n.forEach((function(e){r[e.id]=e})),e(r)}),(function(e){r(e)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),window.expivi.managers.resolveMaterialManager=function(){var e=zo(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var i=t._findProductNode(n);if(null===i)return r("Could not find product node");i.getRenderState().getResourceManager().getManager(o.O.MaterialManager).then((function(t){e(t)}),(function(e){r(e)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),window.expivi.managers.resolveTextures=function(){var e=zo(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var o=t._findProductNode(n);if(null===o)return r("Could not find product node");var i=o.getValue("product_id");Ie.Q.getInstance().resolveBootstrapData(i).pipe((0,Ne.q)(1)).subscribe((function(t){var n=Ue.FG.getItems(t.getMedia()),r=[];n.forEach((function(e){r[e.id]=e})),e(r)}),(function(e){r(e)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),window.expivi.resolveSvgElementBoundaries=function(){var e=zo(regeneratorRuntime.mark((function e(n,r,o){var i,a,u,c,s,l,f,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(i=t._findProductNode(o))){e.next=3;break}throw new Error("Could not find product node");case 3:if(a=i.getComponent("attributeManager")){e.next=6;break}throw new Error("Cound not find attribute manager");case 6:return e.next=8,a.resolveAttributeManager().toPromise();case 8:if(u=e.sent,c=u.getAttributeController(n)){e.next=12;break}throw new Error("Could not resolve attribute controller");case 12:if(c instanceof Lr.v){e.next=14;break}throw new Error("Attribute controller is not an SVG Canvas attribute controller");case 14:if(s=c.getValue()){e.next=17;break}throw new Error("Could not resolve attribute value");case 17:if("number"==typeof(l=s.media_id)){e.next=20;break}throw new Error("Could not resolve media id");case 20:return e.next=22,c.resolveSvgTextureController(l);case 22:return f=e.sent,e.next=25,f.getBoundaries(r);case 25:if(p=e.sent){e.next=28;break}throw new Error("Could not resolve boundary for element");case 28:return e.abrupt("return",p);case 29:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),window.expivi.getAttributeById=function(){var e=zo(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,window.expivi.getProductAttributes();case 5:return n=e.sent,e.abrupt("return",n.find((function(e){return e.id==t}))||null);case 9:return e.prev=9,e.t0=e.catch(2),e.abrupt("return",null);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}(),window.expivi.getMatgroupOptions=function(){var e=zo(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.expivi.getAttributeById(t);case 2:if((n=e.sent)&&"matgroup"==n.type){e.next=5;break}return e.abrupt("return",null);case 5:return e.abrupt("return",n.attribute_values[0].attribute_value_valuable.material_group.materials);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),window.expivi.getColorOptions=function(){var e=zo(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.expivi.getAttributeById(t);case 2:if((n=e.sent)&&"color"==n.type){e.next=5;break}return e.abrupt("return",null);case 5:return e.abrupt("return",n.attribute_values[0].attribute_value_valuable.colors);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),window.expivi.getQuestionOptions=function(){var e=zo(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.expivi.getAttributeById(t);case 2:if((n=e.sent)&&"question"==n.type){e.next=5;break}return e.abrupt("return",null);case 5:return e.abrupt("return",n.attribute_values);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),window.expivi.getProductAttributes=function(){var e=zo(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var o=t._findProductNode(n);if(null===o)return r("Could not find product node");o.getComponent("attributeManager").resolveAttributeManager().subscribe(function(){var t=zo(regeneratorRuntime.mark((function t(n){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.getAttributes(),!Uo.getInstance().hasHook("product-attributes")){t.next=5;break}return t.next=4,Uo.getInstance().executeHook("product-attributes",r);case 4:r=t.sent;case 5:e(r);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),(function(e){r(e)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),window.expivi.setProductAttribute=function(){var e=zo(regeneratorRuntime.mark((function e(n,r,o){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,i){var a=t._findProductNode(o);if(null===a)return i("Could not find product node");a.getComponent("attributeManager").resolveAttributeManager().subscribe(function(){var t=zo(regeneratorRuntime.mark((function t(o){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.setValue(n,r,{emitEvent:!0,rebuild:!0});case 2:e(o.getAttribute(n));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),(function(e){i(e)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),window.expivi.setProductAttributeNamed=function(){var e=zo(regeneratorRuntime.mark((function e(n,r,o){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,i){var a=t._findProductNode(o);if(null===a)return i("Could not find product node");a.getComponent("attributeManager").resolveAttributeManager().subscribe(function(){var t=zo(regeneratorRuntime.mark((function t(o){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.setValueByName(n,r,{emitEvent:!0,rebuild:!0});case 2:e(o.getValueByName(n));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),(function(e){i(e)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),window.expivi.setProductAttributeByKey=function(){var e=zo(regeneratorRuntime.mark((function e(n,r,o){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,i){var a=t._findProductNode(o);if(null===a)return i("Could not find product node");a.getComponent("attributeManager").resolveAttributeManager().subscribe((function(t){t.setValueByKey(n,r,{emitEvent:!0,rebuild:!0}),e(t.getValueByKey(n))}),(function(e){i(e)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),window.expivi.resetProductAttribute=function(){var e=zo(regeneratorRuntime.mark((function e(n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,o){var i=t._findProductNode(r);if(null===i)return o("Could not find product node");i.getComponent("attributeManager").resolveAttributeManager().subscribe((function(t){t.resetValue(n),e(t.getAttribute(n))}),(function(e){o(e)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),window.expivi.getActiveMaterial=function(){var e=zo(regeneratorRuntime.mark((function e(n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,o){t._findProductNode(r).getComponent("materialGroupManager").resolveMaterialGroups().subscribe((function(t){e(t.getActiveRefId(n))}),(function(e){o(e)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),window.expivi.setActiveMaterial=function(){var e=zo(regeneratorRuntime.mark((function e(n,r,o){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,i){t._findProductNode(o).getComponent("materialGroupManager").resolveMaterialGroups().subscribe((function(t){t.setActiveMaterial(n,r),e(t.getActiveRefId(n))}),(function(e){i(e)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),window.expivi.applyActiveMaterial=function(){var e=zo(regeneratorRuntime.mark((function e(n,r,o){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,i){t._findProductNode(o).getComponent("materialGroupManager").resolveMaterialGroups().subscribe((function(t){t.applyActiveMaterial(n,-1,r),e(t.getActiveRefId(n))}),(function(e){i(e)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),window.expivi.getScreenshot=function(){var e=zo(regeneratorRuntime.mark((function e(n,r,o,i,a){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.requestScreenshot(n,r,o,i,a));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r,o,i){return e.apply(this,arguments)}}(),window.expivi.registerPriceCalculator=function(){var e=zo(regeneratorRuntime.mark((function e(n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=n){e.next=4;break}return b.qL.error("Tried to register invalid price calculator, rejected"),e.abrupt("return");case 4:t.registerPriceCalculator(n,r);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),window.expivi.getPrice=function(){var e=zo(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){t.requestPrice(n).then((function(t){e(t)}),(function(e){r(e)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),window.expivi.getAllPrices=function(){var e=zo(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){t.requestAllPrices(n).then((function(t){e(t)}),(function(e){r(e)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),window.expivi.getSupportedLocales=zo(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){t.requestSupportedLocales().then((function(t){e(t)}),(function(e){n(e)}))})));case 1:case"end":return e.stop()}}),e)}))),window.expivi.setNodeProperty=function(){var e=zo(regeneratorRuntime.mark((function e(n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,o){try{var i=t.mEditor.getSceneManager().findNodesNamed(n);i.forEach((function(e){e.setValue(r.name,r.value)})),setTimeout((function(){t.mEditor.dispatchEvent(v.G.RequestFrame),e(i.length)}),0)}catch(e){o(e)}})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),window.expivi.getSceneObj=zo(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){try{t.mEditor.getSceneManager().getRootNode().dispatchMessage(new Tr.S(!1,Or.h.TypeRTTI)),t.mEditor.getSceneManager().getRootNode().dispatchMessage(new Tr.S(!1,_r.h.TypeRTTI));var r=(new THREE.OBJExporter).parse(t.mEditor.getScene());t.mEditor.getSceneManager().getRootNode().dispatchMessage(new Tr.S(!0,Or.h.TypeRTTI)),t.mEditor.getSceneManager().getRootNode().dispatchMessage(new Tr.S(!0,_r.h.TypeRTTI)),e(r)}catch(e){n(e)}})));case 1:case"end":return e.stop()}}),e)}))),window.expivi.getActiveCamera=zo(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){try{var r=t.mEditor.getSceneManager().findNodesOfType(c.g.TypeRTTI);if(0===r.length)return n("No cameras in scene");var o=r[0],i=t.mEditor.getSceneManager().getActiveCameraId();if(i)for(var a=0;a<r.length;a++)if(r[a].getSceneObjectId()===i){o=r[a];break}if(!o.hasRenderObject())return n("Camera node is not built.");e(o.getRenderObject().get3DObject())}catch(e){n(e)}})));case 1:case"end":return e.stop()}}),e)}))),window.expivi.changeCameraZoom=function(){var e=zo(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){try{var o=t.mEditor.getSceneManager().findNodesOfType(c.g.TypeRTTI);if(0===o.length)return r("No cameras in scene");var i=o[0],a=t.mEditor.getSceneManager().getActiveCameraId();if(a)for(var u=0;u<o.length;u++)if(o[u].getSceneObjectId()===a){i=o[u];break}var s=t.mEditor.getCamera(),l=i.getValue("target"),f=s.position.clone().sub(l).length(),p=i.getValue("min_zoom"),d=i.getValue("max_zoom"),h=-n,y=f+h;y>d?h+=d-y:y<p&&(h+=p-y);var m=new THREE.Vector3;s.getWorldDirection(m),s.position.copy(s.position.clone().addScaledVector(m.normalize(),-h)),t.mEditor.dispatchEvent(v.G.RequestFrame),e(h)}catch(e){r(e)}})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),window.expivi.saveConfiguration=zo(regeneratorRuntime.mark((function e(){var r,o,i,a,u,c=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=c.length>0&&void 0!==c[0]?c[0]:512,o=c.length>1&&void 0!==c[1]?c[1]:512,i=c.length>2&&void 0!==c[2]?c[2]:ye._.ACTIVE_CAMERA,a=c.length>3&&void 0!==c[3]?c[3]:"image/jpeg",u=c.length>4?c[4]:void 0,e.abrupt("return",new Promise((function(e,c){t.requestScreenshot(r,o,i,a,u).then((function(r){t._serializeConfigurations(u).then((function(o){(0,n.isArray)(o)&&o.length>0&&(o[0].thumbnail=r);var i={},a=o.map((function(e){var t=Fe.F.Md5(JSON.stringify(e.configuration)+"".concat(e.catalogue_id));return t in i?(delete e.configuration,delete e.attributes,delete e.articles,delete e.price,e.replication_type=Cr.REPLICA,e.original_uuid=i[t]):(e.replication_type=Cr.ORIGINAL,i[t]=e.uuid),e}));e({bundle_uuid:t.mBundleUUID,configured_products:a})}),(function(e){c(e)}))}),(function(e){c(e)}))})));case 6:case"end":return e.stop()}}),e)}))),window.expivi.loadConfiguration=function(){var e=zo(regeneratorRuntime.mark((function e(n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.mConfiguredProductParam=n,e.abrupt("return",new Promise((function(e,n){t.mEditor.enableState("reconfigure"),t.loadConfiguredProduct().then((function(){t.reconfigureProduct().then((function(){t.mEditor.disableState("reconfigure"),e(!0)}),(function(e){t.mEditor.disableState("reconfigure"),n(e)}))}),(function(e){t.mEditor.disableState("reconfigure"),n(e)}))})));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),window.expivi.loadPreset=function(){var e=zo(regeneratorRuntime.mark((function e(n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,o){var i=t._findProductNode(n);if(null===i)return o("scene node was not found");t._resolvePreset(r).then((function(n){if(!n.configuration)return o("preset not loaded");var r=i.getValue("product_id"),a=n.configuration.configured_products.find((function(e){return e.catalogue_id==r}));if(void 0===a)return o("preset doesn't container catalogue id");a.configuration.attributes=a.configuration.attributes.filter((function(e){return!e.excluded_autoload})),t.mEditor.enableState("reconfigure"),(new Er.ConfigurationSerializer).load(i,a,(function(e){t._propagateEvent("progress_reconfigure",Math.floor(100*e))})).then((function(){t.mEditor.disableState("reconfigure"),e(!0)}),(function(e){t.mEditor.disableState("reconfigure"),o(e)}))}),(function(e){return o(e)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),window.expivi.selectProductNode=function(){var e=zo(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,o){if((0,n.isNullOrUndefined)(r))t.mEditor.deselect(),e(null);else{var i=t._findProductNode(r);i&&i.hasRenderObject()?(t.mEditor.select(i.getRenderObject().get3DObject()),e(i)):o("Product node is missing render object.")}})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),window.expivi.autoRotateYAxis=function(){var e=zo(regeneratorRuntime.mark((function e(n){var r,o,i,a=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!(a.length>1&&void 0!==a[1])||a[1],o=a.length>2&&void 0!==a[2]?a[2]:1,i=a.length>3&&void 0!==a[3]?a[3]:360,e.abrupt("return",new Promise((function(e,a){var u=t.addPlayRotation(n,r,o,i);u?e(u):a("Product node is missing render object.")})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),window.expivi.deselect=zo(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.mEditor.deselect(),e(!0)})));case 1:case"end":return e.stop()}}),e)}))),window.expivi.deleteNode=function(){var e=zo(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var o=t._findProductNode(n);if(null===o)r("scene node was not found");else{if(t.mEditor.getSceneManager().isRootNode(o))return r("can not delete root node");t.mEditor.deselect(),t.mEditor.getSceneManager().deleteNode(o),e(o)}})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),window.expivi.resolveProductNodes=zo(regeneratorRuntime.mark((function e(){var r,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>0&&void 0!==o[0]&&o[0],e.abrupt("return",new Promise((function(e){var o=t.mEditor.getSceneManager().findNodesOfType(Me.L.TypeRTTI);if(r)return e(o);var i=[];o.forEach((function(e){var t=e.findParentOfType(ke.Re.TypeRTTI);((0,n.isNullOrUndefined)(t)||t.isViewVisible())&&i.push(e)})),e(i)})));case 2:case"end":return e.stop()}}),e)}))),window.expivi._dispatch=function(){var e=zo(regeneratorRuntime.mark((function e(n,r,o){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){try{var u=t._findProductNode(o);switch(n){case"client_ready":i.S.completePromise(t.onClientReady()).then((function(){e()}),(function(){}));break;case"question_changed":r&&r.option_id?(t.mEditor.dispatchEvent(v.G.ProductQuestionChanged,{question:r.option_id,visible:!0===r.visible,product_scene_id:u.getSceneObjectId()}),e()):a("Wrong payload format: "+JSON.stringify(r));break;case"render_frame":setTimeout((function(){t.mEditor.dispatchEvent(v.G.RequestFrame),e()}),0);break;case"transformMode":t.mEditor.dispatchEvent(v.G.TransformModeChanged,r),e();break;case"visibility":switch(r.type){case"lines":u.dispatchMessage(new Tr.S(r.visible,br.j.TypeRTTI));break;case"fire":u.dispatchMessage(new Tr.S(r.visible,Pr.x.TypeRTTI))}setTimeout((function(){t.mEditor.dispatchEvent(v.G.RequestFrame),e()}),0);break;case"drag":switch(r.type){case"start":t.mViewerComponent.onItemDragStart(r.event);break;case"moved":t.mViewerComponent.onItemDragMove(r.event);break;case"end":t.mViewerComponent.onItemDragEnd(r.event)}setTimeout((function(){t.mEditor.dispatchEvent(v.G.RequestFrame),e()}),0)}}catch(e){a(e)}})));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),window.expivi.getCatalogueProducts=function(){var e=zo(regeneratorRuntime.mark((function e(t,n,r,o){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Vr.getInstance().resolveProducts(t,n,["categories"],r,o));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r,o){return e.apply(this,arguments)}}(),window.expivi.getCatalogueProductById=function(){var e=zo(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Vr.getInstance().resolveProduct(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),window.expivi.usesCatalogueBrowser=function(){var e=zo(regeneratorRuntime.mark((function e(n){var r,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t._findProductNode(n),o=r.getComponent("catalogueMeta"),e.next=4,o.resolveSettings().toPromise();case 4:return i=e.sent,e.abrupt("return",i.getCatalogueMeta().catalogBrowser);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),window.expivi.getCameraTransform=zo(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Br({position:new THREE.Vector3,quaternion:new THREE.Quaternion,scale:new THREE.Vector3(1,1,1)}),(r=t.mEditor.getCamera())&&(r.updateMatrixWorld(!0),n.position.copy(r.position),n.quaternion.copy(r.quaternion),n.scale.copy(r.scale)),e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)}))),window.expivi.setCameraTransform=function(){var e=zo(regeneratorRuntime.mark((function e(n,r){var o,i,a,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n&&(o=t.mEditor.getCamera(),n.quaternion&&o.position.copy(new THREE.Vector3(n.position.x,n.position.y,n.position.z)),n.quaternion&&(i=new THREE.Quaternion(n.quaternion.x,n.quaternion.y,n.quaternion.z,n.quaternion.w),o.quaternion.copy(i)),n.scale&&o.scale.copy(new THREE.Vector3(n.scale.x,n.scale.y,n.scale.z))),r&&(a=new THREE.Vector3(r.x,r.y,r.z),(u=t.getClientViewer().getViewportRenderer().getComponent("controls"))&&u.isTypeName("ViewportControllerOrbitControls")&&u.updateTarget(a));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),window.expivi.addProduct=function(){var n=zo(regeneratorRuntime.mark((function n(r,o,i){var a,u,c,s,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=o.presetId,u=o.transform,c=null,!a){n.next=7;break}return n.next=5,t._resolvePreset(a);case 5:(s=n.sent)&&s.configuration&&(c=s.configuration.configured_products[0]);case 7:return i&&c&&(c=Object.assign(c,i)),(l=t.mEditor.getSceneManager().createObject("product",null,r,!0,c)).setValue("name","Product id:".concat(r)),l.setValue("position",new THREE.Vector3(u.position.x,u.position.y,u.position.z)),u.quaternion=u.quaternion||{x:0,y:0,z:0,w:1},l.setValue("quaternion",new THREE.Quaternion(u.quaternion.x,u.quaternion.y,u.quaternion.z,u.quaternion.w)),u.scale=u.scale||{x:1,y:1,z:1},l.setValue("scale",new THREE.Vector3(u.scale.x,u.scale.y,u.scale.z)),i&&i.clipping_plane&&l.setValue("clipping_plane",i.clipping_plane),i&&i.place_holder&&l.setValue("place_holder",i.place_holder),t.mEditor.execute(new e.AddObjectCommand(l)),n.abrupt("return",l.getObjectUUID());case 19:case"end":return n.stop()}}),n)})));return function(e,t,r){return n.apply(this,arguments)}}(),window.expivi.moveProduct=function(){var n=zo(regeneratorRuntime.mark((function n(r,o){var i,a,u;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=t._findProductNode(r)){n.next=3;break}return n.abrupt("return");case 3:a=new THREE.Quaternion(o.quaternion.x,o.quaternion.y,o.quaternion.z,o.quaternion.w),i.setValue("position",o.position),i.setValue("quaternion",a),i.setValue("scale",o.scale),u=i.getRenderObject().get3DObject(),t.mEditor.execute(new e.SetPositionCommand(u,new THREE.Vector3(o.position.x,o.position.y,o.position.z),u.position.clone())),t.mEditor.execute(new e.SetRotationCommand(u,(new THREE.Euler).setFromQuaternion(a),u.rotation.clone())),t.mEditor.dispatchEvent(v.G.TransformControlChanged,u);case 11:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}(),window.expivi.removeProduct=function(){var e=zo(regeneratorRuntime.mark((function e(n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t._findProductNode(n)){e.next=3;break}return e.abrupt("return");case 3:t.mEditor.getSceneManager().deleteNode(r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),window.expivi.getCategories=function(){var e=zo(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Lo.getInstance().resolveCategories(t,n,[],r));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()}},{key:"requestScreenshot",value:(f=zo(regeneratorRuntime.mark((function e(){var t,n,r,o,i,a,u,c,s=this,l=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=l.length>0&&void 0!==l[0]?l[0]:512,n=l.length>1&&void 0!==l[1]?l[1]:512,r=l.length>2&&void 0!==l[2]?l[2]:ye._.ACTIVE_CAMERA,o=l.length>3&&void 0!==l[3]?l[3]:"image/jpeg",i=l.length>4?l[4]:void 0,ve.F.isNumeric(t)&&ve.F.isNumeric(n)&&!(t*n<=0)){e.next=7;break}return e.abrupt("return",Promise.resolve(null));case 7:return this.mViewerComponent.renderView(),a=this.getEditor().getRenderer().domElement.toDataURL("image/jpeg"),(u=fe.createElement("img")).setAttribute("src",a),fe.setStyle(u,{width:"100%",webkitTransition:"opacity 1s ease-in-out",MozTransition:"opacity 1s ease-in-out",msTransition:"opacity 1s ease-in-out",OTransition:"opacity 1s ease-in-out",transition:"opacity 1s ease-in-out"}),fe.append(this.mViewSaveOverlay,u),fe.setStyle(this.mViewSaveOverlay,"display","block"),c=this.mViewRenderWrapper,fe.setStyle(c,{position:"absolute",left:"0",top:"0",width:"".concat(t,"px"),height:"".concat(n,"px")}),e.abrupt("return",new Promise((function(e,a){s._resolveConfigurableNode().subscribe((function(l){setTimeout((function(){s.mEditor.dispatchEvent(v.G.WindowResized,{width:t,height:n}),s.mViewerComponent.renderCamera(r,l,o,i).then((function(t){fe.setStyle(c,{position:"initial",width:"100%",height:"100%"}),fe.setStyle(u,"opacity","0"),setTimeout((function(){fe.setStyle(s.mViewSaveOverlay,"display","none"),s.mViewSaveOverlay.removeChild(u)}),1e3),setTimeout((function(){s.onWindowResized(!0),e(t)}),0)}),(function(e){fe.setStyle(c,{position:"initial",width:"100%",height:"100%"}),fe.setStyle(u,"opacity","0"),setTimeout((function(){fe.setStyle(s.mViewSaveOverlay,"display","none"),s.mViewSaveOverlay.removeChild(u)}),1e3),setTimeout((function(){s.onWindowResized(!0),a(e)}),0)}))}),32)}))})));case 17:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"setPriceVisibility",value:function(e){var t=e.item_id,n=e.visible;this._propagateEvent("material_price",{id:t,material_price:n})}},{key:"setOptionVisibility",value:function(e){this._propagateEvent("optionvisibility",e)}},{key:"playSound",value:function(e){var t=e.getData();t.url&&new Hr.Howl({src:[t.url],html5:!0}).play()}},{key:"_propagateEvent",value:function(e,t){window.expivi._events.onChange.next(Object.assign({name:e},null!=t?{payload:t}:{}))}},{key:"_propagateReady",value:function(e){window.expivi._events.onReady.next({error:!(0,n.isNullOrUndefined)(e),err:e})}}],l&&Go(s.prototype,l),Object.defineProperty(s,"prototype",{writable:!1}),u}();function Ko(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function Yo(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Ko(i,r,o,a,u,"next",e)}function u(e){Ko(i,r,o,a,u,"throw",e)}a(void 0)}))}}function Zo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}!function(e){e.V1_Ready="v1.ready"}(Wo||(Wo={}));var Xo=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.handleQuerystringOptions(),window.addEventListener("message",e.handleIncomingMessage),this.sendMessage(Wo.V1_Ready,void 0,!0)}var t,n,r,o,i;return t=e,n=[{key:"handleQuerystringOptions",value:function(){new window.URL(window.location.href).searchParams.getAll("handleQuerystringOptions").forEach((function(e){}))}},{key:"sendMessage",value:(i=Yo(regeneratorRuntime.mark((function t(n){var r,o,i=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:void 0,o=i.length>2&&void 0!==i[2]&&i[2],t.abrupt("return",new Promise((function(t,i){var a=e.generateMessage(n,r,o);e.addEventListener(n,(function(e){return a.uuid===e.uuid&&("finished"!==e.state?(i(e),!0):(t(e.payload),!0))})),window.parent.postMessage(a,"*")})));case 3:case"end":return t.stop()}}),t)}))),function(e){return i.apply(this,arguments)})},{key:"sendMessageToHost",value:(o=Yo(regeneratorRuntime.mark((function e(t){var n,r=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:void 0,e.abrupt("return",this.sendMessage(t,n));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})}],r=[{key:"handleIncomingMessage",value:function(t){if(t.data.xpv&&void 0!==t.data.type){var n=t.data.type,r=e.listeners[n];if(void 0!==r&&r.length>0)for(var o=r.length-1;o>=0;o--)r[o](t.data)&&e.listeners[n].splice(o,1)}}},{key:"addEventListener",value:function(t,n){void 0!==e.listeners[t]?e.listeners[t].push(n):e.listeners[t]=[n]}},{key:"generateMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{xpv:!0,type:e,state:n?"finished":"pending",payload:t,uuid:Fe.F.uuidV4()}}}],n&&Zo(t.prototype,n),r&&Zo(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Jo(e,t,n,r,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,o)}function $o(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Jo(i,r,o,a,u,"next",e)}function u(e){Jo(i,r,o,a,u,"throw",e)}a(void 0)}))}}function ei(){return ti.apply(this,arguments)}function ti(){return(ti=$o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){t("Resolved called before initialization.")})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ni(){return(ni=$o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){t("This function has been depricated.")})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ri(){return(ri=$o(regeneratorRuntime.mark((function e(t,n,r,o){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return window.expivi.apiToken=t,/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(navigator.userAgent.substr(0,4))?(void 0===window.isMobile&&(window.isMobile=!0),window.expivi.isMobile=!0):(void 0===window.isMobile&&(window.isMobile=!1),window.expivi.isMobile=!1),window.parent&&window.parent!==window&&(window.expivi._iFrameService=new Xo),window.expivi.viewer=new Qo(n,r,o),e.abrupt("return",window.expivi.viewer.init());case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Xo.listeners={},particleFire.install({THREE:THREE}),window.expivi=window.expivi||{apiToken:"",viewer:null,isMobile:!1},Object.assign(window.expivi,{_events:{onReady:new t.t(1),onChange:new m.xQ},_dispatch:ei,_create:function(e,t,n,r){return ri.apply(this,arguments)},_destroy:function(){null!==window.expivi&&null!==window.expivi.viewer&&(window.expivi.viewer.destroy(),window.expivi.viewer=null),window.expivi.apiToken="",window.expivi._events.onReady.unsubscribe(),window.expivi._events.onReady=new t.t(1),window.expivi._events.onChange.unsubscribe(),window.expivi._events.onChange=new m.xQ},managers:{resolveMaterialGroups:ei,resolveMaterialGroupManager:ei,resolveOffsetGroups:ei,resolveMaterials:ei,resolveTextures:ei,resolveMaterialManager:ei},resolveSvgElementBoundaries:ei,getAttributeById:ei,getMatgroupOptions:ei,getColorOptions:ei,getQuestionOptions:ei,getProductAttributes:ei,setProductAttribute:ei,setProductAttributeNamed:ei,setProductAttributeByKey:ei,resetProductAttribute:ei,getActiveMaterial:ei,setActiveMaterial:ei,applyActiveMaterial:ei,getScreenshot:ei,registerPriceCalculator:ei,getPrice:ei,getAllPrices:ei,getSupportedLocales:ei,setNodeProperty:ei,getSceneObj:ei,getActiveCamera:function(){return ni.apply(this,arguments)},changeCameraZoom:ei,saveConfiguration:ei,loadConfiguration:ei,loadPreset:ei,resolveProductNodes:ei,selectProductNode:ei,autoRotateYAxis:ei,deselect:ei,deleteNode:ei,usesCatalogueBrowser:ei,getCatalogueProducts:ei,getCatalogueProductById:ei,getCameraTransform:ei,setCameraTransform:ei,addProduct:ei,moveProduct:ei,removeProduct:ei,getService:ei,getCategories:ei})}()})();